<!doctype html>
<html
  lang="ko-kr"
  data-theme="claude">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1314&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8" />
<meta
  name="viewport"
  content="width=device-width, initial-scale=1, shrink-to-fit=no" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />

<title>MELODI: Exploring Memory Compression for Long Contexts | Jaehun&#39;s Blog</title>

<meta name="description" content="ë…¼ë¬¸ ë§í¬
Q : ì´ ë…¼ë¬¸ì„ ì•„ì£¼ ìì„¸í•˜ê²Œ ì½ê³  ë…¼ë¬¸ì˜ ê°•ì ê³¼ ë…ì°½ì ì¸ ì§€ì ì„ ì„¤ëª…í•´ì£¼ê³  í•µì‹¬ ì•Œê³ ë¦¬ì¦˜ì„ ì˜ˆì‹œ ì…ë ¥ì„ ë“¤ì–´ì„œ ì „ì²´ì ì¸ ê³¼ì •ì„ ì„¤ëª…í•´ì¤˜ ì¶”ê°€ì ìœ¼ë¡œ ë…¼ë¬¸ì˜ í•œê³„ì ì— ëŒ€í•´ì„œë„ ì•Œë ¤ì¤˜ ğŸ“Œ ê²°ë¡  ìš”ì•½ ë…¼ë¬¸ &ldquo;MELODI: Exploring Memory..." />
<meta name="keywords" content="ê°œë°œ, ì»´íŒŒì¼ëŸ¬, í”„ë¡œê·¸ë˜ë°, ì—ì„¸ì´" />
<meta name="author" content="" />
<meta name="language" content="ko-kr" />

<meta name="robots" content="index, follow" />
<link rel="canonical" href="http://192.168.1.11:1314/posts/MELODI-Exploring-Memory-Compression-for-Long-Contexts/" />



  <link rel="icon" type="image/svg+xml" href="/favicon.svg" />



<link rel="manifest" href="/site.webmanifest" />
<meta property="og:url" content="http://192.168.1.11:1314/posts/MELODI-Exploring-Memory-Compression-for-Long-Contexts/">
  <meta property="og:site_name" content="Jaehun&#39;s Blog">
  <meta property="og:title" content="MELODI: Exploring Memory Compression for Long Contexts">
  <meta property="og:description" content="ë…¼ë¬¸ ë§í¬
Q : ì´ ë…¼ë¬¸ì„ ì•„ì£¼ ìì„¸í•˜ê²Œ ì½ê³  ë…¼ë¬¸ì˜ ê°•ì ê³¼ ë…ì°½ì ì¸ ì§€ì ì„ ì„¤ëª…í•´ì£¼ê³  í•µì‹¬ ì•Œê³ ë¦¬ì¦˜ì„ ì˜ˆì‹œ ì…ë ¥ì„ ë“¤ì–´ì„œ ì „ì²´ì ì¸ ê³¼ì •ì„ ì„¤ëª…í•´ì¤˜ ì¶”ê°€ì ìœ¼ë¡œ ë…¼ë¬¸ì˜ í•œê³„ì ì— ëŒ€í•´ì„œë„ ì•Œë ¤ì¤˜ ğŸ“Œ ê²°ë¡  ìš”ì•½ ë…¼ë¬¸ â€œMELODI: Exploring Memory Compression for Long Contexts&#34;ëŠ” Transformerì˜ ê¸´ ë¬¸ë§¥ ì²˜ë¦¬ ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ ê³„ì¸µì  ë©”ëª¨ë¦¬ ì••ì¶•(hierarchical memory compression) êµ¬ì¡°ë¥¼ ì œì•ˆí•©ë‹ˆë‹¤. í•µì‹¬ì€ **ë‹¤ì¸µ ë°˜ë³µ ì••ì¶• ê¸°ë°˜ì˜ ë‹¨ê¸° ë©”ëª¨ë¦¬(SM)**ì™€ **ë‹¨ì¼ì¸µ ì¶”ê°€ ì••ì¶• ê¸°ë°˜ì˜ ì¥ê¸° ë©”ëª¨ë¦¬(LM)**ë¥¼ ì¡°í•©í•œ **â€œìƒŒë“œìœ„ì¹˜ êµ¬ì¡°â€**ë¥¼ ì‚¬ìš©í•˜ì—¬ ê¸´ ë¬¸ì„œë¥¼ ì§§ì€ ìœˆë„ìš°(ì˜ˆ: 512 tokens)ë¡œ íš¨ìœ¨ì ìœ¼ë¡œ ì²˜ë¦¬í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ì€ ê¸°ì¡´ Dense Memory ë°©ì‹ì¸ Memorizing Transformerë³´ë‹¤ ìµœëŒ€ 8ë°° ì ˆê°í•˜ë©´ì„œë„ ì„±ëŠ¥(PPL ê¸°ì¤€)ì€ ì˜¤íˆë ¤ í–¥ìƒë©ë‹ˆë‹¤.">
  <meta property="og:locale" content="ko_kr">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-05-12T00:00:00+00:00">
    <meta property="article:modified_time" content="2025-05-12T00:00:00+00:00">
    <meta property="og:image" content="http://192.168.1.11:1314/images/og-default.avif">


  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="http://192.168.1.11:1314/images/og-default.avif">
  <meta name="twitter:title" content="MELODI: Exploring Memory Compression for Long Contexts">
  <meta name="twitter:description" content="ë…¼ë¬¸ ë§í¬
Q : ì´ ë…¼ë¬¸ì„ ì•„ì£¼ ìì„¸í•˜ê²Œ ì½ê³  ë…¼ë¬¸ì˜ ê°•ì ê³¼ ë…ì°½ì ì¸ ì§€ì ì„ ì„¤ëª…í•´ì£¼ê³  í•µì‹¬ ì•Œê³ ë¦¬ì¦˜ì„ ì˜ˆì‹œ ì…ë ¥ì„ ë“¤ì–´ì„œ ì „ì²´ì ì¸ ê³¼ì •ì„ ì„¤ëª…í•´ì¤˜ ì¶”ê°€ì ìœ¼ë¡œ ë…¼ë¬¸ì˜ í•œê³„ì ì— ëŒ€í•´ì„œë„ ì•Œë ¤ì¤˜ ğŸ“Œ ê²°ë¡  ìš”ì•½ ë…¼ë¬¸ â€œMELODI: Exploring Memory Compression for Long Contexts&#34;ëŠ” Transformerì˜ ê¸´ ë¬¸ë§¥ ì²˜ë¦¬ ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ ê³„ì¸µì  ë©”ëª¨ë¦¬ ì••ì¶•(hierarchical memory compression) êµ¬ì¡°ë¥¼ ì œì•ˆí•©ë‹ˆë‹¤. í•µì‹¬ì€ **ë‹¤ì¸µ ë°˜ë³µ ì••ì¶• ê¸°ë°˜ì˜ ë‹¨ê¸° ë©”ëª¨ë¦¬(SM)**ì™€ **ë‹¨ì¼ì¸µ ì¶”ê°€ ì••ì¶• ê¸°ë°˜ì˜ ì¥ê¸° ë©”ëª¨ë¦¬(LM)**ë¥¼ ì¡°í•©í•œ **â€œìƒŒë“œìœ„ì¹˜ êµ¬ì¡°â€**ë¥¼ ì‚¬ìš©í•˜ì—¬ ê¸´ ë¬¸ì„œë¥¼ ì§§ì€ ìœˆë„ìš°(ì˜ˆ: 512 tokens)ë¡œ íš¨ìœ¨ì ìœ¼ë¡œ ì²˜ë¦¬í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ì€ ê¸°ì¡´ Dense Memory ë°©ì‹ì¸ Memorizing Transformerë³´ë‹¤ ìµœëŒ€ 8ë°° ì ˆê°í•˜ë©´ì„œë„ ì„±ëŠ¥(PPL ê¸°ì¤€)ì€ ì˜¤íˆë ¤ í–¥ìƒë©ë‹ˆë‹¤.">


  <meta itemprop="name" content="MELODI: Exploring Memory Compression for Long Contexts">
  <meta itemprop="description" content="ë…¼ë¬¸ ë§í¬
Q : ì´ ë…¼ë¬¸ì„ ì•„ì£¼ ìì„¸í•˜ê²Œ ì½ê³  ë…¼ë¬¸ì˜ ê°•ì ê³¼ ë…ì°½ì ì¸ ì§€ì ì„ ì„¤ëª…í•´ì£¼ê³  í•µì‹¬ ì•Œê³ ë¦¬ì¦˜ì„ ì˜ˆì‹œ ì…ë ¥ì„ ë“¤ì–´ì„œ ì „ì²´ì ì¸ ê³¼ì •ì„ ì„¤ëª…í•´ì¤˜ ì¶”ê°€ì ìœ¼ë¡œ ë…¼ë¬¸ì˜ í•œê³„ì ì— ëŒ€í•´ì„œë„ ì•Œë ¤ì¤˜ ğŸ“Œ ê²°ë¡  ìš”ì•½ ë…¼ë¬¸ â€œMELODI: Exploring Memory Compression for Long Contexts&#34;ëŠ” Transformerì˜ ê¸´ ë¬¸ë§¥ ì²˜ë¦¬ ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ ê³„ì¸µì  ë©”ëª¨ë¦¬ ì••ì¶•(hierarchical memory compression) êµ¬ì¡°ë¥¼ ì œì•ˆí•©ë‹ˆë‹¤. í•µì‹¬ì€ **ë‹¤ì¸µ ë°˜ë³µ ì••ì¶• ê¸°ë°˜ì˜ ë‹¨ê¸° ë©”ëª¨ë¦¬(SM)**ì™€ **ë‹¨ì¼ì¸µ ì¶”ê°€ ì••ì¶• ê¸°ë°˜ì˜ ì¥ê¸° ë©”ëª¨ë¦¬(LM)**ë¥¼ ì¡°í•©í•œ **â€œìƒŒë“œìœ„ì¹˜ êµ¬ì¡°â€**ë¥¼ ì‚¬ìš©í•˜ì—¬ ê¸´ ë¬¸ì„œë¥¼ ì§§ì€ ìœˆë„ìš°(ì˜ˆ: 512 tokens)ë¡œ íš¨ìœ¨ì ìœ¼ë¡œ ì²˜ë¦¬í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ì€ ê¸°ì¡´ Dense Memory ë°©ì‹ì¸ Memorizing Transformerë³´ë‹¤ ìµœëŒ€ 8ë°° ì ˆê°í•˜ë©´ì„œë„ ì„±ëŠ¥(PPL ê¸°ì¤€)ì€ ì˜¤íˆë ¤ í–¥ìƒë©ë‹ˆë‹¤.">
  <meta itemprop="datePublished" content="2025-05-12T00:00:00+00:00">
  <meta itemprop="dateModified" content="2025-05-12T00:00:00+00:00">
  <meta itemprop="wordCount" content="11743">
  <meta itemprop="image" content="http://192.168.1.11:1314/images/og-default.avif">
  <meta itemprop="keywords" content="Paper-Review,With-Gpt">







<script>
  window.HUGO_SEARCH_CONFIG = {
    searchIndexURL: "\"/index.json\""
  };
</script>


































<script>

  window.HUGO_GALLERY_CONFIG = {
    justified_gallery:  false ,
    lightbox:  false ,
    justified: "{}",
    lightbox_options: "{}"
  };
</script>




  
    <link rel="stylesheet" href="/css/compiled.css" />
  





  
    <link rel="stylesheet" href="/css/chroma.css" />
  












      <script src="/js/main.js"></script>



  <script src="/js/gumshoe.polyfills.min.js"></script>



        <script src="/js/toc.js" defer></script>



      <script src="/js/search.js" defer></script>



      <script src="/js/dock.js" defer></script>











  











    <script>
      
      (function() {
        const theme = localStorage.getItem('theme') || 'system';
        const colorScheme = localStorage.getItem('colorScheme') || 'claude';

        
        document.documentElement.setAttribute('data-theme', colorScheme);

        
        function applyTheme() {
          if (theme === 'dark' || (theme === 'system' && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
            document.documentElement.classList.add('dark');
          } else {
            document.documentElement.classList.remove('dark');
          }
        }

        applyTheme();

        
        if (theme === 'system') {
          window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', applyTheme);
        }
      })();
    </script>
  </head>

  <body class="bg-background text-foreground min-h-screen antialiased">
    
    
  <div
    id="reading-progress-container"
    class="reading-progress-container pointer-events-none fixed top-0 right-0 left-0 z-50 transition-opacity duration-300 ease-out"
    data-height="3"
    data-smooth-scroll="true"
    data-hide-on-complete="false">
    
    <div class="reading-progress-bg w-full"></div>

    
    <div
      id="reading-progress-bar"
      class="from-primary to-primary/80 reading-progress-bar 
        transition-all duration-150 ease-out
       absolute top-0 left-0 w-0 bg-gradient-to-r"></div>
  </div>

  <script>
    (function () {
      "use strict";

      const progressContainer = document.getElementById(
        "reading-progress-container",
      );
      const progressBar = document.getElementById("reading-progress-bar");

      if (!progressContainer || !progressBar) return;

      
      const config = {
        smoothScroll: progressContainer.dataset.smoothScroll === "true",
        hideOnComplete: progressContainer.dataset.hideOnComplete === "true",
      };

      let isVisible = true;
      let gumshoeInstance = null;

      
      function calculateProgress() {
        const scrollTop =
          window.pageYOffset || document.documentElement.scrollTop;
        const documentHeight = document.documentElement.scrollHeight;
        const windowHeight = window.innerHeight;
        const scrollableHeight = documentHeight - windowHeight;

        if (scrollableHeight <= 0) return 0;

        return Math.min(Math.max((scrollTop / scrollableHeight) * 100, 0), 100);
      }

      
      function updateProgress() {
        const progress = calculateProgress();
        progressBar.style.width = progress + "%";

        
        if (config.hideOnComplete && progress >= 99.5) {
          if (isVisible) {
            progressContainer.style.opacity = "0";
            isVisible = false;
          }
        } else if (!isVisible) {
          progressContainer.style.opacity = "1";
          isVisible = true;
        }
      }

      
      let ticking = false;
      function requestTick() {
        if (!ticking) {
          requestAnimationFrame(() => {
            updateProgress();
            ticking = false;
          });
          ticking = true;
        }
      }

      
      function init() {
        
        window.addEventListener("scroll", requestTick, { passive: true });
        window.addEventListener("resize", requestTick, { passive: true });
        document.addEventListener("visibilitychange", () => {
          if (!document.hidden) requestTick();
        });

        
        requestTick();

        
        window.addEventListener("beforeunload", () => {
          window.removeEventListener("scroll", requestTick);
          window.removeEventListener("resize", requestTick);
        });
      }

      
      if (document.readyState === "loading") {
        document.addEventListener("DOMContentLoaded", init);
      } else {
        init();
      }
    })();
  </script>

    <header class="sticky top-0 z-50 mx-auto max-w-4xl px-4 py-6">
  <div
    class="border-border bg-card/80 flex items-center rounded-xl border px-6 py-4 shadow-sm backdrop-blur-sm">
    
    <div class="hidden w-full items-center md:flex">
      
      <div class="flex items-center">
        
          
          <a
            href="/"
            class="bg-primary text-primary-foreground hover:bg-primary/90 flex h-10 w-10 items-center justify-center rounded-full text-lg font-bold transition-transform duration-200 hover:scale-105"
            aria-label="Jaehun&#39;s Blog">
            J
          </a>
        
      </div>

      
      <nav class="mx-8 flex flex-1 items-center justify-center">
        <div class="flex items-center space-x-1">
          
          
            
            
            
              
                
              
            
            
            <a
              href="/posts/"
              class="nav-link 
                text-muted-foreground hover:text-primary hover:bg-primary/10
               focus:ring-primary/20 relative flex items-center gap-2 rounded-lg px-4 py-2 text-sm font-medium transition-all duration-300 ease-out hover:-translate-y-0.5 hover:scale-105 focus:ring-2 focus:outline-none">
              
                
  <svg class="h-5 w-5"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="nav.posts">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 20H5a2 2 0 01-2-2V6a2 2 0 012-2h10a2 2 0 012 2v1m2 13a2 2 0 01-2-2V7m2 13a2 2 0 002-2V9a2 2 0 00-2-2h-2m-4-3H9M7 16h6M7 8h6v4H7V8z" />

</svg>
              
              <span
                >
                  ê²Œì‹œê¸€
                </span
              >
            </a>
          
            
            
            
              
                
              
            
            
            <a
              href="/categories/"
              class="nav-link 
                text-muted-foreground hover:text-primary hover:bg-primary/10
               focus:ring-primary/20 relative flex items-center gap-2 rounded-lg px-4 py-2 text-sm font-medium transition-all duration-300 ease-out hover:-translate-y-0.5 hover:scale-105 focus:ring-2 focus:outline-none">
              
                
  <svg class="h-5 w-5"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="nav.categories">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10" />

</svg>
              
              <span
                >
                  ì¹´í…Œê³ ë¦¬
                </span
              >
            </a>
          
            
            
            
              
                
              
            
            
            <a
              href="/tags/"
              class="nav-link 
                text-muted-foreground hover:text-primary hover:bg-primary/10
               focus:ring-primary/20 relative flex items-center gap-2 rounded-lg px-4 py-2 text-sm font-medium transition-all duration-300 ease-out hover:-translate-y-0.5 hover:scale-105 focus:ring-2 focus:outline-none">
              
                
  <svg class="h-5 w-5"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="nav.tags">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z" />

</svg>
              
              <span
                >
                  íƒœê·¸
                </span
              >
            </a>
          
            
            
            
              
                
              
            
            
            <a
              href="/archives/"
              class="nav-link 
                text-muted-foreground hover:text-primary hover:bg-primary/10
               focus:ring-primary/20 relative flex items-center gap-2 rounded-lg px-4 py-2 text-sm font-medium transition-all duration-300 ease-out hover:-translate-y-0.5 hover:scale-105 focus:ring-2 focus:outline-none">
              
                
  <svg class="h-5 w-5"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="nav.archives">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 8h14M5 8a2 2 0 110-4h14a2 2 0 110 4M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8m-9 4h4" />

</svg>
              
              <span
                >
                  ì•„ì¹´ì´ë¸Œ
                </span
              >
            </a>
          
        </div>
      </nav>

      
      <div class="flex items-center space-x-2">
        
        
<div class="relative">
  <button id="language-toggle"
    class="dropdown-toggle border-border bg-background text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex h-10 w-10 items-center justify-center rounded-lg border transition-all duration-300 ease-out hover:scale-105 focus:ring-2 focus:outline-none active:scale-95"
    data-dropdown-type="language"
    aria-label="ì–¸ì–´ ë³€ê²½"
    aria-expanded="false"
    aria-haspopup="true">
      
  <svg class="h-5 w-5 relative z-10"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="ì–¸ì–´ ë³€ê²½">
	<path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m5 8l6 6m-7 0l6-6l2-3M2 5h12M7 2h1m14 20l-5-10l-5 10m2-4h6" />
</svg></button>

  
  <div id="language-dropdown"
    class="dropdown-menu border-border bg-popover/95 absolute top-12 right-0 z-[60] hidden w-40 rounded-lg border p-1 shadow-lg backdrop-blur-sm transition-all duration-200 ease-out"
    data-dropdown-type="language"
    role="menu"
    aria-labelledby="language-toggle"><a href="/ko/" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none" role="menuitem" aria-current="true"><span class="font-medium">í•œêµ­ì–´</span></a><a href="/en/" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none" role="menuitem"><span class="font-medium">English</span></a></div>
</div>

        
        
<div class="relative">
  <button id="color-scheme-toggle"
    class="dropdown-toggle border-border bg-background text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex h-10 w-10 items-center justify-center rounded-lg border transition-all duration-300 ease-out hover:scale-105 focus:ring-2 focus:outline-none active:scale-95"
    data-dropdown-type="color-scheme"
    aria-label="í…Œë§ˆ ë³€ê²½"
    aria-expanded="false"
    aria-haspopup="true">
      
  <svg class="h-5 w-5 relative z-10"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="í…Œë§ˆ ë³€ê²½">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zM21 5a2 2 0 00-2-2h-4a2 2 0 00-2 2v6a2 2 0 002 2h4a2 2 0 002-2V5z" />

</svg></button>

  
  <div id="color-scheme-dropdown"
    class="dropdown-menu border-border bg-popover/95 absolute top-12 right-0 z-[60] hidden w-44 rounded-lg border p-1 shadow-lg backdrop-blur-sm transition-all duration-200 ease-out"
    data-dropdown-type="color-scheme"><button data-color-scheme="claude" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Default</span></button><button data-color-scheme="default" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>White</span></button><button data-color-scheme="bumblebee" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Bumblebee</span></button><button data-color-scheme="emerald" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Emerald</span></button><button data-color-scheme="nord" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Nord</span></button><button data-color-scheme="sunset" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Sunset</span></button><button data-color-scheme="abyss" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Abyss</span></button><button data-color-scheme="dracula" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Dracula</span></button><button data-color-scheme="amethyst" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Amethyst</span></button><button data-color-scheme="slate" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Slate</span></button><button data-color-scheme="twitter" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Twitter</span></button></div>
</div>

        
        
<div class="relative">
  <button id="theme-toggle"
    class="dropdown-toggle border-border bg-background text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex h-10 w-10 items-center justify-center rounded-lg border transition-all duration-300 ease-out hover:scale-105 focus:ring-2 focus:outline-none active:scale-95"
    data-dropdown-type="theme"
    aria-label="í…Œë§ˆ ë³€ê²½"
    aria-expanded="false"
    aria-haspopup="true">
      
      
  <svg class="h-5 w-5 sun-icon hidden relative z-10"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="ë¼ì´íŠ¸">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" />

</svg>
      
      
  <svg class="h-5 w-5 moon-icon hidden relative z-10"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="ë‹¤í¬">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" />

</svg>
      
      
  <svg class="h-5 w-5 system-icon hidden relative z-10"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="ì‹œìŠ¤í…œ">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />

</svg></button>

  
  <div id="theme-dropdown"
    class="dropdown-menu border-border bg-popover/95 absolute top-12 right-0 z-[60] hidden w-40 rounded-lg border p-1 shadow-lg backdrop-blur-sm transition-all duration-200 ease-out"
    data-dropdown-type="theme"><button data-theme="light" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none">
  <svg class="h-5 w-5 mr-3 h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="ë¼ì´íŠ¸">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" />

</svg><span>ë¼ì´íŠ¸</span></button><button data-theme="dark" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none">
  <svg class="h-5 w-5 mr-3 h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="ë‹¤í¬">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" />

</svg><span>ë‹¤í¬</span></button><button data-theme="system" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none">
  <svg class="h-5 w-5 mr-3 h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="ì‹œìŠ¤í…œ">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />

</svg><span>ì‹œìŠ¤í…œ</span></button></div>
</div>
      </div>
    </div>

    
    <div class="flex w-full items-center justify-between md:hidden">
      
      
<div class="relative">
  <button
    id="mobile-menu-toggle"
    class="dropdown-toggle border-border bg-background text-muted-foreground hover:bg-accent hover:text-foreground flex h-10 w-10 items-center justify-center rounded-lg border transition-colors duration-200"
    data-dropdown-type="mobile-menu"
    aria-label="ë©”ë‰´"
    aria-expanded="false"
    aria-haspopup="true">
    
  <svg class="h-5 w-5"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="ë©”ë‰´">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />

</svg>
  </button>

  
  <div
    id="mobile-menu"
    class="mobile-menu dropdown-menu border-border bg-popover/95 absolute top-12 left-0 z-[60] hidden w-80 max-w-[calc(100vw-2rem)] rounded-lg border p-1 shadow-lg backdrop-blur-sm transition-all duration-200 ease-out md:hidden"
    data-dropdown-type="mobile-menu"
    role="menu"
    aria-labelledby="mobile-menu-toggle">
    <nav class="flex flex-col">
      
      
        
        
        
          
            
          
        
        
        <a
          href="/posts/"
          class="nav-link 
            text-muted-foreground hover:text-primary hover:bg-primary/10
           focus:ring-primary/20 relative flex items-center gap-3 rounded-md px-4 py-3 text-sm font-medium transition-all duration-200 ease-out hover:translate-x-1 focus:ring-2 focus:outline-none"
          role="menuitem"
          >
          
            
  <svg class="h-5 w-5"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="nav.posts">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 20H5a2 2 0 01-2-2V6a2 2 0 012-2h10a2 2 0 012 2v1m2 13a2 2 0 01-2-2V7m2 13a2 2 0 002-2V9a2 2 0 00-2-2h-2m-4-3H9M7 16h6M7 8h6v4H7V8z" />

</svg>
          
          <span
            >
              ê²Œì‹œê¸€
            </span
          >
        </a>
      
        
        
        
          
            
          
        
        
        <a
          href="/categories/"
          class="nav-link 
            text-muted-foreground hover:text-primary hover:bg-primary/10
           focus:ring-primary/20 relative flex items-center gap-3 rounded-md px-4 py-3 text-sm font-medium transition-all duration-200 ease-out hover:translate-x-1 focus:ring-2 focus:outline-none"
          role="menuitem"
          >
          
            
  <svg class="h-5 w-5"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="nav.categories">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10" />

</svg>
          
          <span
            >
              ì¹´í…Œê³ ë¦¬
            </span
          >
        </a>
      
        
        
        
          
            
          
        
        
        <a
          href="/tags/"
          class="nav-link 
            text-muted-foreground hover:text-primary hover:bg-primary/10
           focus:ring-primary/20 relative flex items-center gap-3 rounded-md px-4 py-3 text-sm font-medium transition-all duration-200 ease-out hover:translate-x-1 focus:ring-2 focus:outline-none"
          role="menuitem"
          >
          
            
  <svg class="h-5 w-5"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="nav.tags">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z" />

</svg>
          
          <span
            >
              íƒœê·¸
            </span
          >
        </a>
      
        
        
        
          
            
          
        
        
        <a
          href="/archives/"
          class="nav-link 
            text-muted-foreground hover:text-primary hover:bg-primary/10
           focus:ring-primary/20 relative flex items-center gap-3 rounded-md px-4 py-3 text-sm font-medium transition-all duration-200 ease-out hover:translate-x-1 focus:ring-2 focus:outline-none"
          role="menuitem"
          >
          
            
  <svg class="h-5 w-5"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="nav.archives">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 8h14M5 8a2 2 0 110-4h14a2 2 0 110 4M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8m-9 4h4" />

</svg>
          
          <span
            >
              ì•„ì¹´ì´ë¸Œ
            </span
          >
        </a>
      
    </nav>
  </div>
</div>


      
      <div class="flex items-center space-x-2">
        
        
<div class="relative">
  <button id="language-toggle"
    class="dropdown-toggle border-border bg-background text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex h-10 w-10 items-center justify-center rounded-lg border transition-all duration-300 ease-out hover:scale-105 focus:ring-2 focus:outline-none active:scale-95"
    data-dropdown-type="language"
    aria-label="ì–¸ì–´ ë³€ê²½"
    aria-expanded="false"
    aria-haspopup="true">
      
  <svg class="h-5 w-5 relative z-10"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="ì–¸ì–´ ë³€ê²½">
	<path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m5 8l6 6m-7 0l6-6l2-3M2 5h12M7 2h1m14 20l-5-10l-5 10m2-4h6" />
</svg></button>

  
  <div id="language-dropdown"
    class="dropdown-menu border-border bg-popover/95 absolute top-12 right-0 z-[60] hidden w-40 rounded-lg border p-1 shadow-lg backdrop-blur-sm transition-all duration-200 ease-out"
    data-dropdown-type="language"
    role="menu"
    aria-labelledby="language-toggle"><a href="/ko/" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none" role="menuitem" aria-current="true"><span class="font-medium">í•œêµ­ì–´</span></a><a href="/en/" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none" role="menuitem"><span class="font-medium">English</span></a></div>
</div>

        
        
<div class="relative">
  <button id="color-scheme-toggle"
    class="dropdown-toggle border-border bg-background text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex h-10 w-10 items-center justify-center rounded-lg border transition-all duration-300 ease-out hover:scale-105 focus:ring-2 focus:outline-none active:scale-95"
    data-dropdown-type="color-scheme"
    aria-label="í…Œë§ˆ ë³€ê²½"
    aria-expanded="false"
    aria-haspopup="true">
      
  <svg class="h-5 w-5 relative z-10"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="í…Œë§ˆ ë³€ê²½">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zM21 5a2 2 0 00-2-2h-4a2 2 0 00-2 2v6a2 2 0 002 2h4a2 2 0 002-2V5z" />

</svg></button>

  
  <div id="color-scheme-dropdown"
    class="dropdown-menu border-border bg-popover/95 absolute top-12 right-0 z-[60] hidden w-44 rounded-lg border p-1 shadow-lg backdrop-blur-sm transition-all duration-200 ease-out"
    data-dropdown-type="color-scheme"><button data-color-scheme="claude" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Default</span></button><button data-color-scheme="default" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>White</span></button><button data-color-scheme="bumblebee" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Bumblebee</span></button><button data-color-scheme="emerald" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Emerald</span></button><button data-color-scheme="nord" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Nord</span></button><button data-color-scheme="sunset" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Sunset</span></button><button data-color-scheme="abyss" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Abyss</span></button><button data-color-scheme="dracula" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Dracula</span></button><button data-color-scheme="amethyst" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Amethyst</span></button><button data-color-scheme="slate" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Slate</span></button><button data-color-scheme="twitter" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Twitter</span></button></div>
</div>

        
        
<div class="relative">
  <button id="theme-toggle"
    class="dropdown-toggle border-border bg-background text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex h-10 w-10 items-center justify-center rounded-lg border transition-all duration-300 ease-out hover:scale-105 focus:ring-2 focus:outline-none active:scale-95"
    data-dropdown-type="theme"
    aria-label="í…Œë§ˆ ë³€ê²½"
    aria-expanded="false"
    aria-haspopup="true">
      
      
  <svg class="h-5 w-5 sun-icon hidden relative z-10"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="ë¼ì´íŠ¸">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" />

</svg>
      
      
  <svg class="h-5 w-5 moon-icon hidden relative z-10"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="ë‹¤í¬">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" />

</svg>
      
      
  <svg class="h-5 w-5 system-icon hidden relative z-10"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="ì‹œìŠ¤í…œ">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />

</svg></button>

  
  <div id="theme-dropdown"
    class="dropdown-menu border-border bg-popover/95 absolute top-12 right-0 z-[60] hidden w-40 rounded-lg border p-1 shadow-lg backdrop-blur-sm transition-all duration-200 ease-out"
    data-dropdown-type="theme"><button data-theme="light" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none">
  <svg class="h-5 w-5 mr-3 h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="ë¼ì´íŠ¸">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" />

</svg><span>ë¼ì´íŠ¸</span></button><button data-theme="dark" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none">
  <svg class="h-5 w-5 mr-3 h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="ë‹¤í¬">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" />

</svg><span>ë‹¤í¬</span></button><button data-theme="system" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none">
  <svg class="h-5 w-5 mr-3 h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="ì‹œìŠ¤í…œ">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />

</svg><span>ì‹œìŠ¤í…œ</span></button></div>
</div>
      </div>
    </div>
  </div>
</header>


    <main class="mx-auto max-w-4xl px-4 py-6">
      
  
  <nav
  class="breadcrumb mb-4 md:mb-6 py-1"
  aria-label="ê²½ë¡œ">
  <ol class="text-muted-foreground flex items-center space-x-1 md:space-x-2 text-sm overflow-x-auto whitespace-nowrap scrollbar-hide py-1">
    
    <li class="flex-shrink-0">
      <a
        href="/"
        class="text-muted-foreground hover:text-primary hover:bg-primary/10 flex items-center gap-0.5 md:gap-1 rounded-lg px-1 md:px-3 py-0.5 md:py-1.5 transition-all duration-200 ease-out hover:-translate-y-0.5 hover:scale-[1.02]">
        
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="í™ˆ">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m3 12 2-2m0 0 7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" />

</svg>
        <span class="max-w-[4rem] md:max-w-none truncate">í™ˆ</span>
      </a>
    </li>

    
    
      <li class="flex items-center gap-1 md:gap-2 min-w-0">
        <span class="text-muted-foreground/50 flex-shrink-0"
          >
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
</svg>
        </span>

        
          
          <div class="flex items-center gap-1 md:gap-2 min-w-0">
            
              
              <a
                href="/posts"
                class="text-muted-foreground hover:text-primary hover:bg-primary/10 flex items-center gap-0.5 md:gap-1 rounded-lg px-1 md:px-3 py-0.5 md:py-1.5 transition-all duration-200 ease-out hover:-translate-y-0.5 hover:scale-[1.02] flex-shrink-0">
                
                  
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 20H5a2 2 0 01-2-2V6a2 2 0 012-2h10a2 2 0 012 2v1m2 13a2 2 0 01-2-2V7m2 13a2 2 0 002-2V9a2 2 0 00-2-2h-2m-4-3H9M7 16h6M7 8h6v4H7V8z" />

</svg>
                  <span class="max-w-[3rem] md:max-w-none truncate">ê²Œì‹œê¸€</span>
                
              </a>
              <span class="text-muted-foreground/50 flex-shrink-0"
                >
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
</svg></span
              >
            
            
            <span class="text-foreground flex items-center gap-0.5 md:gap-1 font-medium min-w-0">
              
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
</svg>
              <span class="max-w-[8rem] md:max-w-[16rem] lg:max-w-none truncate">MELODI: Exploring Memory Compression for Long Contexts</span>
            </span>
          </div>
        
      </li>
    

  </ol>
</nav>



  


  
  <header class="mb-8">
    


<div class="post-meta">
  
  <h1 class="text-foreground mb-6 text-3xl leading-tight font-bold md:text-4xl">
    MELODI: Exploring Memory Compression for Long Contexts
  </h1>

  
  


  
  <div class="bg-card border-border flex flex-col gap-4 rounded-xl border p-6">
    
    <div
      class="text-muted-foreground flex flex-wrap items-center gap-4 text-sm">
      
      <div class="flex items-center gap-2">
        
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="ì‘ì„±ì¼"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
</svg>
        <time datetime="2025-05-12">
          2025ë…„ 05ì›” 12ì¼
        </time>
      </div>

      
      


      
      
        <div class="flex items-center gap-2">
          
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="ì½ëŠ” ì‹œê°„"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
</svg>
          <span
            >24 ë¶„</span
          >
        </div>
      


      
      
        <div class="flex items-center gap-2">
          
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="ë‹¨ì–´ ìˆ˜"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h7" />
</svg>
          <span>11743 ë‹¨ì–´</span>
        </div>
      

    </div>

    
    
      <div class="flex flex-wrap items-center gap-4">
        
        
          <div class="flex items-center gap-2">
            
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="ì¹´í…Œê³ ë¦¬"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z" />
</svg>
            <span class="text-muted-foreground mr-2 text-sm"
              >ì¹´í…Œê³ ë¦¬:</span
            >
            <div class="flex flex-wrap gap-2">
              
                <a
                  href="/categories/paper-review/"
                  class="bg-primary/10 text-primary hover:bg-primary/20 focus:ring-primary/20 inline-flex items-center rounded-full px-3 py-1 text-sm font-medium transition-all duration-200 ease-out hover:-translate-y-0.5 hover:scale-105 hover:shadow-md focus:ring-2 focus:outline-none">
                  paper-review
                </a>
              
                <a
                  href="/categories/with-gpt/"
                  class="bg-primary/10 text-primary hover:bg-primary/20 focus:ring-primary/20 inline-flex items-center rounded-full px-3 py-1 text-sm font-medium transition-all duration-200 ease-out hover:-translate-y-0.5 hover:scale-105 hover:shadow-md focus:ring-2 focus:outline-none">
                  with-gpt
                </a>
              
            </div>
          </div>
        


        
        

      </div>
    


    
    

  </div>
</div>

  </header>

  
  <article class="prose prose-neutral dark:prose-invert mb-12 max-w-none">
    <p><a href="https://arxiv.org/abs/2410.03156v1">ë…¼ë¬¸ ë§í¬</a></p>
<h1 id="q--ì´-ë…¼ë¬¸ì„-ì•„ì£¼-ìì„¸í•˜ê²Œ-ì½ê³ -ë…¼ë¬¸ì˜-ê°•ì ê³¼-ë…ì°½ì ì¸-ì§€ì ì„-ì„¤ëª…í•´ì£¼ê³ -í•µì‹¬-ì•Œê³ ë¦¬ì¦˜ì„-ì˜ˆì‹œ-ì…ë ¥ì„-ë“¤ì–´ì„œ-ì „ì²´ì ì¸-ê³¼ì •ì„-ì„¤ëª…í•´ì¤˜-ì¶”ê°€ì ìœ¼ë¡œ-ë…¼ë¬¸ì˜-í•œê³„ì ì—-ëŒ€í•´ì„œë„-ì•Œë ¤ì¤˜">Q : ì´ ë…¼ë¬¸ì„ ì•„ì£¼ ìì„¸í•˜ê²Œ ì½ê³  ë…¼ë¬¸ì˜ ê°•ì ê³¼ ë…ì°½ì ì¸ ì§€ì ì„ ì„¤ëª…í•´ì£¼ê³  í•µì‹¬ ì•Œê³ ë¦¬ì¦˜ì„ ì˜ˆì‹œ ì…ë ¥ì„ ë“¤ì–´ì„œ ì „ì²´ì ì¸ ê³¼ì •ì„ ì„¤ëª…í•´ì¤˜ ì¶”ê°€ì ìœ¼ë¡œ ë…¼ë¬¸ì˜ í•œê³„ì ì— ëŒ€í•´ì„œë„ ì•Œë ¤ì¤˜</h1>
<h3 id="-ê²°ë¡ -ìš”ì•½">ğŸ“Œ ê²°ë¡  ìš”ì•½</h3>
<p>ë…¼ë¬¸ &ldquo;MELODI: Exploring Memory Compression for Long Contexts&quot;ëŠ” Transformerì˜ ê¸´ ë¬¸ë§¥ ì²˜ë¦¬ ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ <strong>ê³„ì¸µì  ë©”ëª¨ë¦¬ ì••ì¶•(hierarchical memory compression)</strong> êµ¬ì¡°ë¥¼ ì œì•ˆí•©ë‹ˆë‹¤.
í•µì‹¬ì€ **ë‹¤ì¸µ ë°˜ë³µ ì••ì¶• ê¸°ë°˜ì˜ ë‹¨ê¸° ë©”ëª¨ë¦¬(SM)**ì™€ **ë‹¨ì¼ì¸µ ì¶”ê°€ ì••ì¶• ê¸°ë°˜ì˜ ì¥ê¸° ë©”ëª¨ë¦¬(LM)**ë¥¼ ì¡°í•©í•œ **â€œìƒŒë“œìœ„ì¹˜ êµ¬ì¡°â€**ë¥¼ ì‚¬ìš©í•˜ì—¬ ê¸´ ë¬¸ì„œë¥¼ ì§§ì€ ìœˆë„ìš°(ì˜ˆ: 512 tokens)ë¡œ íš¨ìœ¨ì ìœ¼ë¡œ ì²˜ë¦¬í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤.
ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ì€ ê¸°ì¡´ Dense Memory ë°©ì‹ì¸ Memorizing Transformerë³´ë‹¤ <strong>ìµœëŒ€ 8ë°° ì ˆê°</strong>í•˜ë©´ì„œë„ ì„±ëŠ¥(PPL ê¸°ì¤€)ì€ ì˜¤íˆë ¤ <strong>í–¥ìƒ</strong>ë©ë‹ˆë‹¤.</p>
<hr>
<h2 id="-melodiì˜-êµ¬ì¡°-ìš”ì•½">ğŸ” MELODIì˜ êµ¬ì¡° ìš”ì•½</h2>
<table>
  <thead>
      <tr>
          <th>êµ¬ì„± ìš”ì†Œ</th>
          <th>íŠ¹ì§•</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>Short-Term Memory</td>
          <td>- ìœˆë„ìš° ë‹¨ìœ„ë¡œ Recurrentí•˜ê²Œ ì •ë³´ë¥¼ ì••ì¶• <br> - Layerë¥¼ ë”°ë¼ ì •ë³´ë¥¼ ì „ë‹¬ (vertical)</td>
      </tr>
      <tr>
          <td>Long-Term Memory</td>
          <td>- Layer ì¤‘ê°„ ì§€ì ì—ì„œ ì¶”ê°€ ì••ì¶•í•˜ì—¬ ì €ì¥ <br> - ì‹œê°„ ìˆœì„œ ë”°ë¼ ì •ë³´ë¥¼ ì¶•ì  (horizontal)</td>
      </tr>
      <tr>
          <td>êµ¬ì¡°</td>
          <td>- [SM Ã— Mì¸µ] + [LM Ã— 1ì¸µ] + [SM Ã— (Nâˆ’Mâˆ’1)ì¸µ] ì˜ ìƒŒë“œìœ„ì¹˜ êµ¬ì¡° ì‚¬ìš©</td>
      </tr>
  </tbody>
</table>
<h3 id="ì˜ˆì‹œ-ì…ë ¥-íë¦„-ë‹¨ì¼-ìœˆë„ìš°-ê¸°ì¤€">ì˜ˆì‹œ ì…ë ¥ íë¦„ (ë‹¨ì¼ ìœˆë„ìš° ê¸°ì¤€)</h3>
<p>ì…ë ¥: <code>xâ‚–</code> (kë²ˆì§¸ context window, ì˜ˆ: 512 tokens)</p>
<ol>
<li>
<p><strong>SM Layer 1</strong></p>
<ul>
<li><code>zâ‚–â‚‹â‚</code> (ì´ì „ SM token)ê³¼ <code>xâ‚–</code>ì— causal attention</li>
<li>Transformer block â†’ <code>xâ‚– â†’ xâ‚–'</code>, summary token <code>uâ‚–'</code> ê³„ì‚°</li>
<li>Linear Mixer: <code>uâ‚– = Mâ†‘(xâ‚–', uâ‚–')</code>, <code>zâ‚– = Mâ†’(xâ‚–', uâ‚–')</code></li>
</ul>
</li>
<li>
<p><strong>&hellip; SM Layer M ë°˜ë³µ â†’ recurrent ì••ì¶• ì§„í–‰</strong></p>
</li>
<li>
<p><strong>LM Layer</strong> (ì¤‘ê°„ layer)</p>
<ul>
<li>ì§€ê¸ˆê¹Œì§€ ì €ì¥ëœ LM (<code>mâ‚:â‚–â‚‹â‚</code>)ì— cross-attention ìˆ˜í–‰</li>
<li>self-attentionê³¼ cross-attentionì€ gating Î±ë¡œ í•©ì„±</li>
<li>LM token <code>mâ‚–</code> ìƒì„± í›„ KV pair í˜•íƒœë¡œ ë©”ëª¨ë¦¬ì— append</li>
</ul>
</li>
<li>
<p>ì´í›„ Layer Nê¹Œì§€ ë‹¤ì‹œ SM ë°˜ë³µ ìˆ˜í–‰í•˜ì—¬ ìµœì¢… ì¶œë ¥</p>
</li>
</ol>
<hr>
<h2 id="-í•µì‹¬-ì•Œê³ ë¦¬ì¦˜-ì˜ˆì‹œ-ê¸°ë°˜-ì„¤ëª…">ğŸ§  í•µì‹¬ ì•Œê³ ë¦¬ì¦˜: ì˜ˆì‹œ ê¸°ë°˜ ì„¤ëª…</h2>
<p>ê°€ì •:</p>
<ul>
<li>context window ê¸¸ì´: 512 tokens</li>
<li>short-term memory: 128 tokens</li>
<li>long-term memory: 64 tokens, ìµœëŒ€ 128 window ì €ì¥</li>
</ul>
<div
  class="code-block-container border-border bg-card my-6 overflow-hidden rounded-xl border shadow-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:shadow-md">
  
  <div
    class="code-block-header bg-muted/30 border-border flex items-center justify-between border-b px-4 py-3">
    
    <div class="flex items-center gap-2">
      <div class="text-muted-foreground flex-shrink-0">
        
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4" />
</svg>
      </div>
      <span class="text-muted-foreground text-sm font-medium">
        TEXT
      </span>
    </div>

    
    <div class="flex items-center gap-2">
      <button
          class="collapse-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none"
          data-code-id="code-0"
          data-default-state="expanded"
          data-collapsed="false"
          data-auto-collapse-lines="30"
          data-auto-collapse-height="400"
          data-collapsed-height="120"
          title="ì ‘ê¸°"
          aria-label="ì ‘ê¸°">
          <span class="collapse-icon">
            
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z"/></svg>
          </span>
          <span class="collapse-text hidden sm:inline"
            >ì ‘ê¸°</span
          >
        </button>
      <button
        class="copy-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none"
        data-code-id="code-0"
        title="ë³µì‚¬"
        aria-label="ë³µì‚¬">
        <span class="copy-icon">
          
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
</svg>
        </span>
        <span class="copy-text hidden sm:inline"
          >ë³µì‚¬</span
        >
      </button>
    </div>
  </div>

  
  <div class="code-block-content relative" id="code-0">
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="ln"> 1</span><span class="cl">ì…ë ¥ ë¬¸ì¥ (k=3ë²ˆì§¸ ìœˆë„ìš°): &#34;In the middle of the night, he found a strange box.&#34;
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">==&gt; Layer 1ì—ì„œ:
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">  - ì´ì „ zâ‚‚ (128 token)ì™€ í˜„ì¬ context xâ‚ƒì— attention
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">  - context xâ‚ƒ â†’ xâ‚ƒâ€™ ê³„ì‚°
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">  - summary token uâ‚ƒâ€™ ìƒì„±
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">  - Linear Mixer Mâ†‘, Mâ†’ë¥¼ ê±°ì³:
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">      uâ‚ƒ = summary for ë‹¤ìŒ layer
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">      zâ‚ƒ = short-term memory token (â†’ window 4 ì…ë ¥ ì‹œ ì‚¬ìš©)
</span></span><span class="line"><span class="ln">10</span><span class="cl">
</span></span><span class="line"><span class="ln">11</span><span class="cl">==&gt; ì¤‘ê°„ LM Layer:
</span></span><span class="line"><span class="ln">12</span><span class="cl">  - í˜„ì¬ xâ‚ƒâ€™, uâ‚ƒì™€ mâ‚:â‚‚ (ì´ì „ê¹Œì§€ì˜ LM KV pair)ì— cross-attention
</span></span><span class="line"><span class="ln">13</span><span class="cl">  - ìƒˆë¡œìš´ long-term token mâ‚ƒ ìƒì„± í›„ long-term memoryì— append
</span></span><span class="line"><span class="ln">14</span><span class="cl">
</span></span><span class="line"><span class="ln">15</span><span class="cl">==&gt; ì´í›„ layerì—ì„œë„ zâ‚ƒ, uâ‚ƒ ì •ë³´ ì´ìš©í•˜ì—¬ inference ì´ì–´ê°</span></span></code></pre></div>
    
    <div
      class="collapse-overlay to-card/90 pointer-events-none absolute inset-0 bg-gradient-to-b from-transparent via-transparent opacity-0 transition-opacity duration-300">
      <div
        class="text-muted-foreground bg-card/80 border-border/50 hover:bg-primary/10 hover:text-primary hover:border-primary/30 absolute bottom-4 left-1/2 -translate-x-1/2 cursor-pointer rounded-full border px-3 py-1.5 text-xs backdrop-blur-sm transition-all duration-200">
        í´ë¦­í•˜ì—¬ ë” ë³´ê¸°
      </div>
    </div>
  </div>
</div>


<script>
(function() {
  const codeId = 'code-0';
  const copyBtn = document.querySelector('.copy-code-btn[data-code-id="' + codeId + '"]');
  const collapseBtn = document.querySelector('.collapse-code-btn[data-code-id="' + codeId + '"]');
  const codeContainer = document.getElementById(codeId);

  if (!codeContainer) return;

  
  if (copyBtn) {
    const copyIcon = copyBtn.querySelector('.copy-icon');
    const copyText = copyBtn.querySelector('.copy-text');

    copyBtn.addEventListener('click', async function() {
      try {
        
        let codeText = '';

        
        const codeTableCell = codeContainer.querySelector('.lntd:last-child code');
        if (codeTableCell) {
          codeText = codeTableCell.textContent || codeTableCell.innerText;
        } else {
          
          const codeElement = codeContainer.querySelector('code');
          if (codeElement) {
            
            const hasInlineLineNumbers = codeElement.querySelector('.ln');
            if (hasInlineLineNumbers) {
              
              const codeLines = codeElement.querySelectorAll('.cl');
              if (codeLines.length > 0) {
                codeText = Array.from(codeLines)
                  .map(line => {
                    const text = line.textContent || line.innerText;
                    
                    return text.replace(/\n+$/, '');
                  })
                  .join('\n')
                  .replace(/\n+$/, ''); 
              } else {
                
                const allText = codeElement.textContent || codeElement.innerText;
                codeText = allText.replace(/^\d+/gm, '').replace(/^\s+/gm, '');
              }
            } else {
              
              codeText = codeElement.textContent || codeElement.innerText;
            }
          } else {
            
            codeText = codeContainer.textContent || codeContainer.innerText;
          }
        }

        
        codeText = codeText.trim();

        
        await navigator.clipboard.writeText(codeText);

        
        copyIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M5 13l4 4L19 7\u0022 \/\u003e\n\u003c\/svg\u003e`;
        if (copyText) {
          copyText.textContent = 'ë³µì‚¬ë¨';
        }
        copyBtn.classList.add('text-green-600');

        
        setTimeout(() => {
          copyIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z\u0022 \/\u003e\n\u003c\/svg\u003e`;
          if (copyText) {
            copyText.textContent = 'ë³µì‚¬';
          }
          copyBtn.classList.remove('text-green-600');
        }, 2000);

      } catch (err) {
        console.error('å¤åˆ¶å¤±è´¥:', err);

        
        const range = document.createRange();
        const codeElement = codeContainer.querySelector('code') || codeContainer;
        range.selectNodeContents(codeElement);
        const selection = window.getSelection();
        selection.removeAllRanges();
        selection.addRange(range);

        
        if (copyText) {
          copyText.textContent = 'ì„ íƒë¨';
        }

        setTimeout(() => {
          if (copyText) {
            copyText.textContent = 'ë³µì‚¬';
          }
          selection.removeAllRanges();
        }, 2000);
      }
    });
  }

  
  if (collapseBtn) {
    const collapseIcon = collapseBtn.querySelector('.collapse-icon');
    const collapseText = collapseBtn.querySelector('.collapse-text');
    const collapseOverlay = codeContainer.querySelector('.collapse-overlay');

    
    let codeElement = codeContainer.querySelector('pre.chroma');
    if (!codeElement) {
      codeElement = codeContainer.querySelector('pre');
    }

    const defaultState = collapseBtn.dataset.defaultState || 'expanded';
    const isCollapsedAttr = collapseBtn.dataset.collapsed === 'true';
    const autoCollapseLines = parseInt(collapseBtn.dataset.autoCollapseLines) || 30;
    const autoCollapseHeight = parseInt(collapseBtn.dataset.autoCollapseHeight) || 400;
    const collapsedHeight = parseInt(collapseBtn.dataset.collapsedHeight) || 120;

    let isCollapsed = false;

    
    function initCollapse() {
      
      const shouldCollapse = isCollapsedAttr ||
                           defaultState === 'collapsed' ||
                           shouldAutoCollapse();

      if (shouldCollapse) {
        setCollapsed(true, false); 
      }
    }

    function shouldAutoCollapse() {
      
      if (codeElement) {
        const lines = codeElement.querySelectorAll('.line, .cl');
        const height = codeElement.offsetHeight;
        return lines.length > autoCollapseLines || height > autoCollapseHeight;
      }

      
      const containerHeight = codeContainer.offsetHeight;
      if (containerHeight > autoCollapseHeight) {
        return true;
      }

      
      const textContent = codeContainer.textContent || codeContainer.innerText || '';
      const estimatedLines = textContent.split('\n').length;
      return estimatedLines > autoCollapseLines;
    }

    function setCollapsed(collapsed, animate = true) {
      if (!collapseOverlay) return;

      isCollapsed = collapsed;

      if (collapsed) {
        
        codeContainer.style.maxHeight = collapsedHeight + 'px';
        codeContainer.style.overflow = 'hidden';
        collapseOverlay.style.opacity = '1';
        collapseOverlay.style.pointerEvents = 'auto';

        
        collapseIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M19 9l-7 7-7-7\u0022 \/\u003e\n\u003c\/svg\u003e`;
        if (collapseText) {
          collapseText.textContent = 'í¼ì¹˜ê¸°';
        }
        collapseBtn.title = 'í¼ì¹˜ê¸°';

      } else {
        
        codeContainer.style.maxHeight = '';
        codeContainer.style.overflow = '';
        collapseOverlay.style.opacity = '0';
        collapseOverlay.style.pointerEvents = 'none';

        
        collapseIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath fill=\u0022currentColor\u0022 d=\u0022M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z\u0022\/\u003e\u003c\/svg\u003e`;
        if (collapseText) {
          collapseText.textContent = 'ì ‘ê¸°';
        }
        collapseBtn.title = 'ì ‘ê¸°';
      }

      
      if (animate) {
        codeContainer.style.transition = 'max-height 0.3s ease-out';
        setTimeout(() => {
          codeContainer.style.transition = '';
        }, 300);
      }
    }

    function toggleCollapse() {
      setCollapsed(!isCollapsed, true);
    }

    
    collapseBtn.addEventListener('click', toggleCollapse);

    
    if (collapseOverlay) {
      collapseOverlay.addEventListener('click', () => {
        if (isCollapsed) {
          setCollapsed(false, true);
        }
      });
    }

    
    initCollapse();
  }
})();
</script>
<hr>
<h2 id="-ì„±ëŠ¥-ë¹„êµ-perplexity-ê¸°ì¤€">ğŸ“ˆ ì„±ëŠ¥ ë¹„êµ (Perplexity ê¸°ì¤€)</h2>
<table>
  <thead>
      <tr>
          <th>Model</th>
          <th>PG19 (T5 vocab)</th>
          <th>arXiv (Meena)</th>
          <th>Memory Usage</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>Transformer-XL</td>
          <td>11.41</td>
          <td>2.60</td>
          <td>13.6M</td>
      </tr>
      <tr>
          <td>Block Recurrent Transf.</td>
          <td>10.98</td>
          <td>2.26</td>
          <td>13.1M</td>
      </tr>
      <tr>
          <td>Memorizing Transf.</td>
          <td>10.62</td>
          <td>2.14</td>
          <td><strong>147.8M</strong></td>
      </tr>
      <tr>
          <td><strong>MELODI S128+L64</strong></td>
          <td><strong>10.44</strong></td>
          <td><strong>2.11</strong></td>
          <td><strong>18.5M</strong></td>
      </tr>
      <tr>
          <td><strong>MELODI S192+L96</strong></td>
          <td><strong>10.29</strong></td>
          <td><strong>2.09</strong></td>
          <td>27.8M</td>
      </tr>
  </tbody>
</table>
<p>ğŸ‘‰ <strong>Dense attention ì—†ì´ë„ ì„±ëŠ¥ì€ ë” ë†’ê³ , ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ì€ íšê¸°ì ìœ¼ë¡œ ì¤„ì„</strong></p>
<hr>
<h2 id="-ablationìœ¼ë¡œ-ë°í˜€ì§„-ì„¤ê³„ì˜-íš¨ê³¼">ğŸ§ª Ablationìœ¼ë¡œ ë°í˜€ì§„ ì„¤ê³„ì˜ íš¨ê³¼</h2>
<ul>
<li><strong>SMê³¼ LMì€ ìƒí˜¸ë³´ì™„ì </strong>: ë‘˜ ë‹¤ í‚¤ìš°ë©´ ì„±ëŠ¥ ìƒìŠ¹ (Fig. 4)</li>
<li><strong>Context window ì‘ê²Œ ì¤„ì—¬ë„ ì„±ëŠ¥ ìœ ì§€</strong>: LMì´ ì¥ê¸° ë¬¸ë§¥ì„ ë³´ì¡´í•¨ (Fig. 6)</li>
<li><strong>Summary branching</strong>: cross-window + cross-layer íë¦„ ë„ì… â†’ ì„±ëŠ¥ í–¥ìƒ (+0.3 PPL)</li>
<li><strong>LM ìœ„ì¹˜ëŠ” 5~11ì¸µ ì–´ë””ë“  ë¹„ìŠ·í•˜ê²Œ ë™ì‘</strong> â†’ ìœ ì—°í•œ êµ¬ì¡° ì„¤ê³„ ê°€ëŠ¥</li>
</ul>
<hr>
<h2 id="-ë…¼ë¬¸ì˜-ê°•ì ">ğŸ” ë…¼ë¬¸ì˜ ê°•ì </h2>
<table>
  <thead>
      <tr>
          <th>ê°•ì </th>
          <th>ì„¤ëª…</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>ë©”ëª¨ë¦¬ íš¨ìœ¨</strong></td>
          <td>Dense KV ì €ì¥ ëŒ€ì‹  ì••ì¶•ëœ tokenë§Œ ì €ì¥í•´ <strong>ìµœëŒ€ 8x ì ˆê°</strong></td>
      </tr>
      <tr>
          <td><strong>êµ¬ì¡° ì¼ë°˜ì„±</strong></td>
          <td>ê¸°ì¡´ Transformerì— ê±°ì˜ ì†ëŒ€ì§€ ì•Šê³  í™•ì¥ ê°€ëŠ¥</td>
      </tr>
      <tr>
          <td><strong>ì„±ëŠ¥ ìœ ì§€</strong></td>
          <td>ê¸°ì¡´ state-of-the-artë³´ë‹¤ ì¢‹ì€ perplexity</td>
      </tr>
      <tr>
          <td><strong>ë‹¨ê¸°-ì¥ê¸° ë©”ëª¨ë¦¬ ê²°í•©</strong></td>
          <td>LSTM ìŠ¤íƒ€ì¼ recurrent compression + ë‹¨ì¼ì¸µ summary ì €ì¥</td>
      </tr>
      <tr>
          <td><strong>ëª¨ë“ˆí™”</strong></td>
          <td>Token mixer, gating, memory branching ë“±ì˜ êµ¬ì¡°ê°€ ê¹”ë”íˆ ë¶„ë¦¬ë˜ì–´ ìˆìŒ</td>
      </tr>
  </tbody>
</table>
<hr>
<h2 id="-í•œê³„ì ">âŒ í•œê³„ì </h2>
<table>
  <thead>
      <tr>
          <th>í•œê³„</th>
          <th>ì„¤ëª…</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>ì‚¬ì „í•™ìŠµ ëª¨ë¸ ì ìš© X</strong></td>
          <td>MELODIëŠ” ì²˜ìŒë¶€í„° í•™ìŠµí•¨. ê¸°ì¡´ ì‚¬ì „í•™ìŠµ ëª¨ë¸ì— plug-in í•˜ëŠ” ë°©ì‹ì€ ì•„ì§ ì—†ìŒ</td>
      </tr>
      <tr>
          <td><strong>ì ìš© ë³µì¡ë„</strong></td>
          <td>Short-term summary token flow, token mixer ë“± êµ¬í˜„ ë³µì¡ì„±ì´ ë†’ìŒ</td>
      </tr>
      <tr>
          <td><strong>Memory queue ê³ ì •</strong></td>
          <td>LMì€ FIFO íì— KV pair ì €ì¥ â†’ í•™ìŠµ ì™¸ ê¸°ì–µ ìœ ì§€ í•„ìš” ì‹œ í•œê³„ ìˆìŒ</td>
      </tr>
      <tr>
          <td><strong>ì••ì¶• ì •ë³´ ì†ì‹¤ ê°€ëŠ¥ì„±</strong></td>
          <td>ì§€ë‚˜ì¹˜ê²Œ aggressiveí•œ ì••ì¶•ì€ ì •ë³´ ìœ ì‹¤ ìœ ë°œ ê°€ëŠ¥ (ablationì—ì„œ í™•ì¸ë¨)</td>
      </tr>
  </tbody>
</table>
<hr>
<h2 id="-ê²°ë¡ -ë°-í™œìš©-ì œì•ˆ">ğŸ“Œ ê²°ë¡  ë° í™œìš© ì œì•ˆ</h2>
<p>MELODIëŠ” long-context language modelingì—ì„œ <strong>íš¨ìœ¨ì„±ê³¼ ì„±ëŠ¥ì˜ ê· í˜•</strong>ì„ ë§¤ìš° ì˜ ë§ì¶˜ êµ¬ì¡°ì…ë‹ˆë‹¤. íŠ¹íˆ:</p>
<ul>
<li><strong>ë©”ëª¨ë¦¬ ì œí•œì´ ìˆëŠ” ë””ë°”ì´ìŠ¤ (e.g., ëª¨ë°”ì¼ inference, edge GPU)</strong></li>
<li><strong>ê¸´ ë¬¸ì„œë¥¼ chunk ë‹¨ìœ„ë¡œ ì²˜ë¦¬í•´ì•¼ í•˜ëŠ” task (e.g., RAG, summarization)</strong></li>
<li><strong>ì»¨í…ìŠ¤íŠ¸ window í™•ì¥ì´ ì–´ë ¤ìš´ ëª¨ë¸ íŒŒì¸íŠœë‹ ì‹œ, hierarchical memory ì¶”ê°€ êµ¬ì¡°</strong></li>
</ul>
<p>ë“±ì— ë§¤ìš° ì í•©í•©ë‹ˆë‹¤.</p>
<h1 id="q--gemmaì™€-ê°™ì€-ëª¨ë¸ì—ì„œ-ì‚¬ìš©í•˜ëŠ”-slice-window-attentionê³¼-ë¹„ìŠ·í•œ-ê°œë…ì¸ê±°ì•¼-ì–´ë–¤-ì°¨ì´ì ì´-ìˆëŠ”ì§€-ì•Œë ¤ì¤„-ìˆ˜-ìˆë‹ˆ-ê·¸ë¦¬ê³ -ì‹œê°ì ì¸-ë‹¤ì´ì–´ê·¸ë¨ë„-ë¶€íƒí•´">Q : gemmaì™€ ê°™ì€ ëª¨ë¸ì—ì„œ ì‚¬ìš©í•˜ëŠ” slice window attentionê³¼ ë¹„ìŠ·í•œ ê°œë…ì¸ê±°ì•¼? ì–´ë–¤ ì°¨ì´ì ì´ ìˆëŠ”ì§€ ì•Œë ¤ì¤„ ìˆ˜ ìˆë‹ˆ? ê·¸ë¦¬ê³  ì‹œê°ì ì¸ ë‹¤ì´ì–´ê·¸ë¨ë„ ë¶€íƒí•´</h1>
<p>MELODIëŠ” Gemma ë“±ì—ì„œ ì‚¬ìš©í•˜ëŠ” **Slice Window Attention (SWA)**ê³¼ ë¹„ìŠ·í•˜ê²Œ <strong>ì§§ì€ context window</strong>ë§Œì„ ì‚¬ìš©í•˜ì§€ë§Œ, í•µì‹¬ ì°¨ì´ì ì€ **&ldquo;ì–´ë–»ê²Œ ê³¼ê±° ì •ë³´ë¥¼ ì••ì¶•Â·ì¶•ì í•˜ëŠëƒ&rdquo;**ì— ìˆìŠµë‹ˆë‹¤.</p>
<hr>
<h2 id="-melodi-vs-slice-window-attention-ë¹„êµ">ğŸ” MELODI vs Slice Window Attention: ë¹„êµ</h2>
<table>
  <thead>
      <tr>
          <th>í•­ëª©</th>
          <th>MELODI</th>
          <th>Slice Window Attention (ì˜ˆ: Gemma)</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>í•µì‹¬ ê°œë…</strong></td>
          <td>ê³„ì¸µì  ë©”ëª¨ë¦¬ ì••ì¶• (SM+LM)</td>
          <td>sliding ë˜ëŠ” sliced attention window</td>
      </tr>
      <tr>
          <td><strong>ë¬¸ë§¥ ì—°ê²° ë°©ì‹</strong></td>
          <td>- ë‹¨ê¸°: recurrent compression <br> - ì¥ê¸°: middle-layerì—ì„œ ì••ì¶•ëœ KV ì €ì¥</td>
          <td>- ìµœê·¼ nê°œì˜ windowë§Œ sliding ì°¸ì¡°</td>
      </tr>
      <tr>
          <td><strong>ì¥ê¸° ì •ë³´ ìœ ì§€</strong></td>
          <td>âœ… long-term memory (128 windowê¹Œì§€)</td>
          <td>âŒ ê¸´ ê±°ë¦¬ ì •ë³´ëŠ” ìŠí˜€ì§</td>
      </tr>
      <tr>
          <td><strong>Attention ëŒ€ìƒ</strong></td>
          <td>SM: ì´ì „ memory (z) <br> LM: ì €ì¥ëœ KV pool (mâ‚:â‚–â‚‹â‚)</td>
          <td>í˜„ì¬ ë° ì¼ë¶€ ê³¼ê±° context tokens</td>
      </tr>
      <tr>
          <td><strong>êµ¬ì¡° ë³€ê²½ ì •ë„</strong></td>
          <td>transformer layerì— memory path ì‚½ì… (ë¯¸ì„¸ ë³€ê²½)</td>
          <td>attention maskë§Œ ì¡°ì •í•˜ì—¬ ê°„ë‹¨íˆ êµ¬í˜„ ê°€ëŠ¥</td>
      </tr>
      <tr>
          <td><strong>ì••ì¶• ì—¬ë¶€</strong></td>
          <td>âœ… context â†’ summary token â†’ KV pairë¡œ ì••ì¶•</td>
          <td>âŒ ì••ì¶• ì—†ìŒ, token ê·¸ëŒ€ë¡œ ì‚¬ìš©</td>
      </tr>
      <tr>
          <td><strong>ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰</strong></td>
          <td>ë‚®ìŒ (ì••ì¶•ëœ tokenë§Œ ì €ì¥)</td>
          <td>ì¤‘ê°„ (token ì§ì ‘ ì €ì¥)</td>
      </tr>
  </tbody>
</table>
<hr>
<h3 id="í•µì‹¬-ì°¨ì´">í•µì‹¬ ì°¨ì´</h3>
<ul>
<li><strong>SWA</strong>ëŠ” &ldquo;ìµœê·¼ í† í°ë§Œì„ ê¸°ì–µ&quot;í•˜ëŠ” <strong>ë¡œì»¬ context ì—°ê²° ë°©ì‹</strong></li>
<li><strong>MELODI</strong>ëŠ” &ldquo;ì •ë³´ ìš”ì•½ ë° ì¶•ì &quot;ì„ í†µí•´ <strong>ì „ì—­ context ì—°ê²° ìœ ì§€</strong></li>
</ul>
<p>ì¦‰, <strong>SWAëŠ” locality ê¸°ë°˜</strong>, MELODIëŠ” <strong>hierarchical memory abstraction ê¸°ë°˜</strong>ì…ë‹ˆë‹¤.</p>
<hr>
<p>ì•„ë˜ëŠ” ìš”ì²­í•˜ì‹  MELODI êµ¬ì¡°ì˜ ì‹œê°í™”ì…ë‹ˆë‹¤ (ìƒŒë“œìœ„ì¹˜ êµ¬ì¡°, SMê³¼ LMì˜ íë¦„ í¬í•¨):

<figure class="image-figure not-prose my-8" 
        data-lightbox-enabled="false"
        data-gallery-type="auto">
  <div class="image-container">
    
    <img
      src="/assets/images/img2025-05-12.png"
      alt=""
      
      loading="lazy"
      decoding="async"
      data-gallery-src="/assets/images/img2025-05-12.png"
      data-gallery-alt=""
      data-gallery-title="" /></div>

  </figure></p>
<p>ê±°ì˜ ë§ìŠµë‹ˆë‹¤. ê°œë…ì„ ì •ë¦¬í•˜ìë©´ ì•„ë˜ì™€ ê°™ì´ ì •ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<hr>
<h2 id="-í•µì‹¬-ì°¨ì´-ìš”ì•½-swa-vs-melodi">âœ… í•µì‹¬ ì°¨ì´ ìš”ì•½: SWA vs MELODI</h2>
<table>
  <thead>
      <tr>
          <th>í•­ëª©</th>
          <th>Slice Window Attention (SWA)</th>
          <th>MELODI</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>ì €ì¥ ë‹¨ìœ„</strong></td>
          <td>ğŸ”¹ <strong>token-level</strong> (ì›ë˜ì˜ token sequence ì¼ë¶€)</td>
          <td>ğŸ”¸ <strong>compressed embedding-level</strong> (context window ìš”ì•½ë³¸)</td>
      </tr>
      <tr>
          <td><strong>ì €ì¥ ëŒ€ìƒ</strong></td>
          <td>- ìµœê·¼ windowì˜ <strong>raw token</strong>ì„ ì§ì ‘ attention ëŒ€ìƒì— í¬í•¨ (ì˜ˆ: ìµœê·¼ 2~4ê°œ window)</td>
          <td>- ê° windowì—ì„œ ì••ì¶•ëœ <strong>summary token</strong> ë˜ëŠ” <strong>KV embedding</strong>ì„ ì €ì¥</td>
      </tr>
      <tr>
          <td><strong>ì •ë³´ í‘œí˜„</strong></td>
          <td>- ì •ë³´ ì†ì‹¤ ì—†ì´ <strong>ê·¸ëŒ€ë¡œ ì €ì¥</strong><br>- í•˜ì§€ë§Œ memory size â†‘â†‘</td>
          <td>- <strong>ì •ë³´ ìš”ì•½/ì••ì¶•</strong> í›„ ì €ì¥<br> - memory size â†“â†“</td>
      </tr>
      <tr>
          <td><strong>Memory êµ¬ì¡°</strong></td>
          <td>- Sliding ë°©ì‹ì˜ <strong>cache</strong></td>
          <td>- FIFO queue í˜•íƒœì˜ <strong>long-term memory</strong></td>
      </tr>
      <tr>
          <td><strong>Attention ë°©ì‹</strong></td>
          <td>- í˜„ì¬ tokenì´ ì§ì ‘ ì´ì „ tokenë“¤ê³¼ attention</td>
          <td>- í˜„ì¬ tokenì´ <strong>ìš”ì•½ëœ memory representation</strong>ì— attention</td>
      </tr>
  </tbody>
</table>
<hr>
<h3 id="ì˜ˆì‹œë¡œ-ì´í•´í•˜ê¸°">ì˜ˆì‹œë¡œ ì´í•´í•˜ê¸°</h3>
<ul>
<li>
<p><strong>SWA</strong>:</p>
<div
  class="code-block-container border-border bg-card my-6 overflow-hidden rounded-xl border shadow-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:shadow-md">
  
  <div
    class="code-block-header bg-muted/30 border-border flex items-center justify-between border-b px-4 py-3">
    
    <div class="flex items-center gap-2">
      <div class="text-muted-foreground flex-shrink-0">
        
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4" />
</svg>
      </div>
      <span class="text-muted-foreground text-sm font-medium">
        PLAINTEXT
      </span>
    </div>

    
    <div class="flex items-center gap-2">
      <button
          class="collapse-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none"
          data-code-id="code-1"
          data-default-state="expanded"
          data-collapsed="false"
          data-auto-collapse-lines="30"
          data-auto-collapse-height="400"
          data-collapsed-height="120"
          title="ì ‘ê¸°"
          aria-label="ì ‘ê¸°">
          <span class="collapse-icon">
            
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z"/></svg>
          </span>
          <span class="collapse-text hidden sm:inline"
            >ì ‘ê¸°</span
          >
        </button>
      <button
        class="copy-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none"
        data-code-id="code-1"
        title="ë³µì‚¬"
        aria-label="ë³µì‚¬">
        <span class="copy-icon">
          
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
</svg>
        </span>
        <span class="copy-text hidden sm:inline"
          >ë³µì‚¬</span
        >
      </button>
    </div>
  </div>

  
  <div class="code-block-content relative" id="code-1">
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">Windowâ‚– = [tâ‚–â‚‹â‚‚, tâ‚–â‚‹â‚, tâ‚–] ì¤‘ tâ‚–â‚‹â‚‚, tâ‚–â‚‹â‚ë„ ê·¸ëŒ€ë¡œ ì €ì¥ â†’ attention ëŒ€ìƒ</span></span></code></pre></div>
    
    <div
      class="collapse-overlay to-card/90 pointer-events-none absolute inset-0 bg-gradient-to-b from-transparent via-transparent opacity-0 transition-opacity duration-300">
      <div
        class="text-muted-foreground bg-card/80 border-border/50 hover:bg-primary/10 hover:text-primary hover:border-primary/30 absolute bottom-4 left-1/2 -translate-x-1/2 cursor-pointer rounded-full border px-3 py-1.5 text-xs backdrop-blur-sm transition-all duration-200">
        í´ë¦­í•˜ì—¬ ë” ë³´ê¸°
      </div>
    </div>
  </div>
</div>


<script>
(function() {
  const codeId = 'code-1';
  const copyBtn = document.querySelector('.copy-code-btn[data-code-id="' + codeId + '"]');
  const collapseBtn = document.querySelector('.collapse-code-btn[data-code-id="' + codeId + '"]');
  const codeContainer = document.getElementById(codeId);

  if (!codeContainer) return;

  
  if (copyBtn) {
    const copyIcon = copyBtn.querySelector('.copy-icon');
    const copyText = copyBtn.querySelector('.copy-text');

    copyBtn.addEventListener('click', async function() {
      try {
        
        let codeText = '';

        
        const codeTableCell = codeContainer.querySelector('.lntd:last-child code');
        if (codeTableCell) {
          codeText = codeTableCell.textContent || codeTableCell.innerText;
        } else {
          
          const codeElement = codeContainer.querySelector('code');
          if (codeElement) {
            
            const hasInlineLineNumbers = codeElement.querySelector('.ln');
            if (hasInlineLineNumbers) {
              
              const codeLines = codeElement.querySelectorAll('.cl');
              if (codeLines.length > 0) {
                codeText = Array.from(codeLines)
                  .map(line => {
                    const text = line.textContent || line.innerText;
                    
                    return text.replace(/\n+$/, '');
                  })
                  .join('\n')
                  .replace(/\n+$/, ''); 
              } else {
                
                const allText = codeElement.textContent || codeElement.innerText;
                codeText = allText.replace(/^\d+/gm, '').replace(/^\s+/gm, '');
              }
            } else {
              
              codeText = codeElement.textContent || codeElement.innerText;
            }
          } else {
            
            codeText = codeContainer.textContent || codeContainer.innerText;
          }
        }

        
        codeText = codeText.trim();

        
        await navigator.clipboard.writeText(codeText);

        
        copyIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M5 13l4 4L19 7\u0022 \/\u003e\n\u003c\/svg\u003e`;
        if (copyText) {
          copyText.textContent = 'ë³µì‚¬ë¨';
        }
        copyBtn.classList.add('text-green-600');

        
        setTimeout(() => {
          copyIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z\u0022 \/\u003e\n\u003c\/svg\u003e`;
          if (copyText) {
            copyText.textContent = 'ë³µì‚¬';
          }
          copyBtn.classList.remove('text-green-600');
        }, 2000);

      } catch (err) {
        console.error('å¤åˆ¶å¤±è´¥:', err);

        
        const range = document.createRange();
        const codeElement = codeContainer.querySelector('code') || codeContainer;
        range.selectNodeContents(codeElement);
        const selection = window.getSelection();
        selection.removeAllRanges();
        selection.addRange(range);

        
        if (copyText) {
          copyText.textContent = 'ì„ íƒë¨';
        }

        setTimeout(() => {
          if (copyText) {
            copyText.textContent = 'ë³µì‚¬';
          }
          selection.removeAllRanges();
        }, 2000);
      }
    });
  }

  
  if (collapseBtn) {
    const collapseIcon = collapseBtn.querySelector('.collapse-icon');
    const collapseText = collapseBtn.querySelector('.collapse-text');
    const collapseOverlay = codeContainer.querySelector('.collapse-overlay');

    
    let codeElement = codeContainer.querySelector('pre.chroma');
    if (!codeElement) {
      codeElement = codeContainer.querySelector('pre');
    }

    const defaultState = collapseBtn.dataset.defaultState || 'expanded';
    const isCollapsedAttr = collapseBtn.dataset.collapsed === 'true';
    const autoCollapseLines = parseInt(collapseBtn.dataset.autoCollapseLines) || 30;
    const autoCollapseHeight = parseInt(collapseBtn.dataset.autoCollapseHeight) || 400;
    const collapsedHeight = parseInt(collapseBtn.dataset.collapsedHeight) || 120;

    let isCollapsed = false;

    
    function initCollapse() {
      
      const shouldCollapse = isCollapsedAttr ||
                           defaultState === 'collapsed' ||
                           shouldAutoCollapse();

      if (shouldCollapse) {
        setCollapsed(true, false); 
      }
    }

    function shouldAutoCollapse() {
      
      if (codeElement) {
        const lines = codeElement.querySelectorAll('.line, .cl');
        const height = codeElement.offsetHeight;
        return lines.length > autoCollapseLines || height > autoCollapseHeight;
      }

      
      const containerHeight = codeContainer.offsetHeight;
      if (containerHeight > autoCollapseHeight) {
        return true;
      }

      
      const textContent = codeContainer.textContent || codeContainer.innerText || '';
      const estimatedLines = textContent.split('\n').length;
      return estimatedLines > autoCollapseLines;
    }

    function setCollapsed(collapsed, animate = true) {
      if (!collapseOverlay) return;

      isCollapsed = collapsed;

      if (collapsed) {
        
        codeContainer.style.maxHeight = collapsedHeight + 'px';
        codeContainer.style.overflow = 'hidden';
        collapseOverlay.style.opacity = '1';
        collapseOverlay.style.pointerEvents = 'auto';

        
        collapseIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M19 9l-7 7-7-7\u0022 \/\u003e\n\u003c\/svg\u003e`;
        if (collapseText) {
          collapseText.textContent = 'í¼ì¹˜ê¸°';
        }
        collapseBtn.title = 'í¼ì¹˜ê¸°';

      } else {
        
        codeContainer.style.maxHeight = '';
        codeContainer.style.overflow = '';
        collapseOverlay.style.opacity = '0';
        collapseOverlay.style.pointerEvents = 'none';

        
        collapseIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath fill=\u0022currentColor\u0022 d=\u0022M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z\u0022\/\u003e\u003c\/svg\u003e`;
        if (collapseText) {
          collapseText.textContent = 'ì ‘ê¸°';
        }
        collapseBtn.title = 'ì ‘ê¸°';
      }

      
      if (animate) {
        codeContainer.style.transition = 'max-height 0.3s ease-out';
        setTimeout(() => {
          codeContainer.style.transition = '';
        }, 300);
      }
    }

    function toggleCollapse() {
      setCollapsed(!isCollapsed, true);
    }

    
    collapseBtn.addEventListener('click', toggleCollapse);

    
    if (collapseOverlay) {
      collapseOverlay.addEventListener('click', () => {
        if (isCollapsed) {
          setCollapsed(false, true);
        }
      });
    }

    
    initCollapse();
  }
})();
</script>
</li>
<li>
<p><strong>MELODI</strong>:</p>
<div
  class="code-block-container border-border bg-card my-6 overflow-hidden rounded-xl border shadow-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:shadow-md">
  
  <div
    class="code-block-header bg-muted/30 border-border flex items-center justify-between border-b px-4 py-3">
    
    <div class="flex items-center gap-2">
      <div class="text-muted-foreground flex-shrink-0">
        
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4" />
</svg>
      </div>
      <span class="text-muted-foreground text-sm font-medium">
        PLAINTEXT
      </span>
    </div>

    
    <div class="flex items-center gap-2">
      <button
          class="collapse-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none"
          data-code-id="code-2"
          data-default-state="expanded"
          data-collapsed="false"
          data-auto-collapse-lines="30"
          data-auto-collapse-height="400"
          data-collapsed-height="120"
          title="ì ‘ê¸°"
          aria-label="ì ‘ê¸°">
          <span class="collapse-icon">
            
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z"/></svg>
          </span>
          <span class="collapse-text hidden sm:inline"
            >ì ‘ê¸°</span
          >
        </button>
      <button
        class="copy-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none"
        data-code-id="code-2"
        title="ë³µì‚¬"
        aria-label="ë³µì‚¬">
        <span class="copy-icon">
          
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
</svg>
        </span>
        <span class="copy-text hidden sm:inline"
          >ë³µì‚¬</span
        >
      </button>
    </div>
  </div>

  
  <div class="code-block-content relative" id="code-2">
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">Windowâ‚–â‚‹â‚ â†’ summary token â†’ linear mixer â†’ compressed KV â†’ ì €ì¥ë¨
</span></span><span class="line"><span class="ln">2</span><span class="cl">í˜„ì¬ windowëŠ” ì´ summary KVì—ë§Œ cross-attention</span></span></code></pre></div>
    
    <div
      class="collapse-overlay to-card/90 pointer-events-none absolute inset-0 bg-gradient-to-b from-transparent via-transparent opacity-0 transition-opacity duration-300">
      <div
        class="text-muted-foreground bg-card/80 border-border/50 hover:bg-primary/10 hover:text-primary hover:border-primary/30 absolute bottom-4 left-1/2 -translate-x-1/2 cursor-pointer rounded-full border px-3 py-1.5 text-xs backdrop-blur-sm transition-all duration-200">
        í´ë¦­í•˜ì—¬ ë” ë³´ê¸°
      </div>
    </div>
  </div>
</div>


<script>
(function() {
  const codeId = 'code-2';
  const copyBtn = document.querySelector('.copy-code-btn[data-code-id="' + codeId + '"]');
  const collapseBtn = document.querySelector('.collapse-code-btn[data-code-id="' + codeId + '"]');
  const codeContainer = document.getElementById(codeId);

  if (!codeContainer) return;

  
  if (copyBtn) {
    const copyIcon = copyBtn.querySelector('.copy-icon');
    const copyText = copyBtn.querySelector('.copy-text');

    copyBtn.addEventListener('click', async function() {
      try {
        
        let codeText = '';

        
        const codeTableCell = codeContainer.querySelector('.lntd:last-child code');
        if (codeTableCell) {
          codeText = codeTableCell.textContent || codeTableCell.innerText;
        } else {
          
          const codeElement = codeContainer.querySelector('code');
          if (codeElement) {
            
            const hasInlineLineNumbers = codeElement.querySelector('.ln');
            if (hasInlineLineNumbers) {
              
              const codeLines = codeElement.querySelectorAll('.cl');
              if (codeLines.length > 0) {
                codeText = Array.from(codeLines)
                  .map(line => {
                    const text = line.textContent || line.innerText;
                    
                    return text.replace(/\n+$/, '');
                  })
                  .join('\n')
                  .replace(/\n+$/, ''); 
              } else {
                
                const allText = codeElement.textContent || codeElement.innerText;
                codeText = allText.replace(/^\d+/gm, '').replace(/^\s+/gm, '');
              }
            } else {
              
              codeText = codeElement.textContent || codeElement.innerText;
            }
          } else {
            
            codeText = codeContainer.textContent || codeContainer.innerText;
          }
        }

        
        codeText = codeText.trim();

        
        await navigator.clipboard.writeText(codeText);

        
        copyIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M5 13l4 4L19 7\u0022 \/\u003e\n\u003c\/svg\u003e`;
        if (copyText) {
          copyText.textContent = 'ë³µì‚¬ë¨';
        }
        copyBtn.classList.add('text-green-600');

        
        setTimeout(() => {
          copyIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z\u0022 \/\u003e\n\u003c\/svg\u003e`;
          if (copyText) {
            copyText.textContent = 'ë³µì‚¬';
          }
          copyBtn.classList.remove('text-green-600');
        }, 2000);

      } catch (err) {
        console.error('å¤åˆ¶å¤±è´¥:', err);

        
        const range = document.createRange();
        const codeElement = codeContainer.querySelector('code') || codeContainer;
        range.selectNodeContents(codeElement);
        const selection = window.getSelection();
        selection.removeAllRanges();
        selection.addRange(range);

        
        if (copyText) {
          copyText.textContent = 'ì„ íƒë¨';
        }

        setTimeout(() => {
          if (copyText) {
            copyText.textContent = 'ë³µì‚¬';
          }
          selection.removeAllRanges();
        }, 2000);
      }
    });
  }

  
  if (collapseBtn) {
    const collapseIcon = collapseBtn.querySelector('.collapse-icon');
    const collapseText = collapseBtn.querySelector('.collapse-text');
    const collapseOverlay = codeContainer.querySelector('.collapse-overlay');

    
    let codeElement = codeContainer.querySelector('pre.chroma');
    if (!codeElement) {
      codeElement = codeContainer.querySelector('pre');
    }

    const defaultState = collapseBtn.dataset.defaultState || 'expanded';
    const isCollapsedAttr = collapseBtn.dataset.collapsed === 'true';
    const autoCollapseLines = parseInt(collapseBtn.dataset.autoCollapseLines) || 30;
    const autoCollapseHeight = parseInt(collapseBtn.dataset.autoCollapseHeight) || 400;
    const collapsedHeight = parseInt(collapseBtn.dataset.collapsedHeight) || 120;

    let isCollapsed = false;

    
    function initCollapse() {
      
      const shouldCollapse = isCollapsedAttr ||
                           defaultState === 'collapsed' ||
                           shouldAutoCollapse();

      if (shouldCollapse) {
        setCollapsed(true, false); 
      }
    }

    function shouldAutoCollapse() {
      
      if (codeElement) {
        const lines = codeElement.querySelectorAll('.line, .cl');
        const height = codeElement.offsetHeight;
        return lines.length > autoCollapseLines || height > autoCollapseHeight;
      }

      
      const containerHeight = codeContainer.offsetHeight;
      if (containerHeight > autoCollapseHeight) {
        return true;
      }

      
      const textContent = codeContainer.textContent || codeContainer.innerText || '';
      const estimatedLines = textContent.split('\n').length;
      return estimatedLines > autoCollapseLines;
    }

    function setCollapsed(collapsed, animate = true) {
      if (!collapseOverlay) return;

      isCollapsed = collapsed;

      if (collapsed) {
        
        codeContainer.style.maxHeight = collapsedHeight + 'px';
        codeContainer.style.overflow = 'hidden';
        collapseOverlay.style.opacity = '1';
        collapseOverlay.style.pointerEvents = 'auto';

        
        collapseIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M19 9l-7 7-7-7\u0022 \/\u003e\n\u003c\/svg\u003e`;
        if (collapseText) {
          collapseText.textContent = 'í¼ì¹˜ê¸°';
        }
        collapseBtn.title = 'í¼ì¹˜ê¸°';

      } else {
        
        codeContainer.style.maxHeight = '';
        codeContainer.style.overflow = '';
        collapseOverlay.style.opacity = '0';
        collapseOverlay.style.pointerEvents = 'none';

        
        collapseIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath fill=\u0022currentColor\u0022 d=\u0022M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z\u0022\/\u003e\u003c\/svg\u003e`;
        if (collapseText) {
          collapseText.textContent = 'ì ‘ê¸°';
        }
        collapseBtn.title = 'ì ‘ê¸°';
      }

      
      if (animate) {
        codeContainer.style.transition = 'max-height 0.3s ease-out';
        setTimeout(() => {
          codeContainer.style.transition = '';
        }, 300);
      }
    }

    function toggleCollapse() {
      setCollapsed(!isCollapsed, true);
    }

    
    collapseBtn.addEventListener('click', toggleCollapse);

    
    if (collapseOverlay) {
      collapseOverlay.addEventListener('click', () => {
        if (isCollapsed) {
          setCollapsed(false, true);
        }
      });
    }

    
    initCollapse();
  }
})();
</script>
</li>
</ul>
<hr>
<h3 id="ê²°ë¡ ">ê²°ë¡ </h3>

  <blockquote
    class="border-primary bg-muted/30 hover:bg-muted/40 my-6 rounded-r-lg border-l-4 py-4 pr-4 pl-6 italic transition-all duration-200 ease-out hover:translate-x-1">
    <div class="prose prose-sm max-w-none">
      <p>&ldquo;SWAëŠ” ê³¼ê±° <strong>raw tokenì„ ì§ì ‘ ì €ì¥</strong>í•´ì„œ ë³´ëŠ” ë°©ì‹ì´ê³ ,
MELODIëŠ” ê³¼ê±° <strong>contextë¥¼ ìš”ì•½í•œ ì••ì¶• embeddingì„ ì €ì¥</strong>í•´ì„œ ë³´ëŠ” ë°©ì‹ì´ë‹¤.&rdquo;</p>
    </div>
  </blockquote>

<p>ë”°ë¼ì„œ MELODIëŠ” memory usage ë©´ì—ì„œ í›¨ì”¬ íš¨ìœ¨ì ì´ë©°, <strong>ì¥ê¸° dependency ìœ ì§€ì— ë” ìœ ë¦¬</strong>í•©ë‹ˆë‹¤.</p>
<h1 id="q--ë…¼ë¬¸ì˜-í•µì‹¬ì•Œê³ ë¦¬ì¦˜ì„-ì˜ˆì‹œë¥¼-ë“¤ì–´-ì•„ì£¼-ìì„¸í•˜ê²Œ-ì„¤ëª…í•´ì£¼ê³ -ì •ë¦¬í•´-ì¤˜">Q : ë…¼ë¬¸ì˜ í•µì‹¬ì•Œê³ ë¦¬ì¦˜ì„ ì˜ˆì‹œë¥¼ ë“¤ì–´ ì•„ì£¼ ìì„¸í•˜ê²Œ ì„¤ëª…í•´ì£¼ê³  ì •ë¦¬í•´ ì¤˜</h1>
<p>ë…¼ë¬¸ <strong>MELODI</strong>ì˜ í•µì‹¬ ì•Œê³ ë¦¬ì¦˜ì€ ê¸´ ë¬¸ì„œë¥¼ <strong>ì§§ì€ context window</strong>ë¡œ ë‚˜ëˆ ì„œ ì²˜ë¦¬í•˜ë©´ì„œë„ <strong>ì´ì „ ë¬¸ë§¥ì˜ ì •ë³´ë¥¼ íš¨ê³¼ì ìœ¼ë¡œ ìš”ì•½Â·ë³´ì¡´</strong>í•˜ê¸° ìœ„í•œ <strong>ê³„ì¸µì  ë©”ëª¨ë¦¬ ì••ì¶•(Hierarchical Memory Compression)</strong> ê¸°ë²•ì…ë‹ˆë‹¤. ì•„ë˜ì— ì•Œê³ ë¦¬ì¦˜ì„ ì˜ˆì‹œ ì¤‘ì‹¬ìœ¼ë¡œ ë‹¨ê³„ë³„ë¡œ ì•„ì£¼ ìì„¸íˆ ì„¤ëª…ë“œë¦¬ê² ìŠµë‹ˆë‹¤.</p>
<hr>
<h2 id="-ì „ì²´-êµ¬ì¡°-ìš”ì•½">âœ… ì „ì²´ êµ¬ì¡° ìš”ì•½</h2>
<p>ì…ë ¥ ì‹œí€€ìŠ¤ <code>X = [xâ‚, ..., x_T]</code>ëŠ” <code>512 tokens</code> ë‹¨ìœ„ì˜ context window <code>xâ‚–</code>ë¡œ ë‚˜ë‰©ë‹ˆë‹¤. ê° windowëŠ” ë‹¤ìŒ ë‘ ê°€ì§€ memory êµ¬ì¡°ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤:</p>
<ol>
<li>
<p><strong>Short-Term Memory (STM)</strong>:</p>
<ul>
<li>ê° window ë‚´ì—ì„œ layerë³„ë¡œ <strong>recurrent compression</strong></li>
<li>ì˜ˆ: 512 tokens â†’ 128 tokens</li>
<li>window ê°„ <strong>zâ‚– (ì••ì¶•ëœ ë©”ëª¨ë¦¬)</strong> ì „ë‹¬</li>
</ul>
</li>
<li>
<p><strong>Long-Term Memory (LTM)</strong>:</p>
<ul>
<li>íŠ¹ì • ì¤‘ê°„ layerì—ì„œ <strong>64ê°œ ì„ë² ë”©</strong>ìœ¼ë¡œ window ì „ì²´ë¥¼ ìš”ì•½</li>
<li>ì´ì „ windowì˜ ìš”ì•½ê°’ë“¤ì„ <strong>FIFO queue</strong>ë¡œ ì €ì¥</li>
<li>ì´ ë©”ëª¨ë¦¬ì— ëŒ€í•´ <strong>cross-attention</strong> ìˆ˜í–‰</li>
</ul>
</li>
</ol>
<hr>
<h2 id="-ì˜ˆì‹œ-ì „ì²´-ì•Œê³ ë¦¬ì¦˜-ë™ì‘-íë¦„">ğŸ§ª ì˜ˆì‹œ: ì „ì²´ ì•Œê³ ë¦¬ì¦˜ ë™ì‘ íë¦„</h2>
<h3 id="ê°€ì •">ê°€ì •</h3>
<ul>
<li>context window ê¸¸ì´: 512 tokens</li>
<li>short-term memory token ìˆ˜ S = 128</li>
<li>long-term memory token ìˆ˜ L = 64</li>
<li>window index: <code>k = 3</code> (ì„¸ ë²ˆì§¸ context window ì²˜ë¦¬ ì¤‘)</li>
</ul>
<hr>
<h3 id="-step-1-input-ì¤€ë¹„">â–¶ï¸ Step 1: Input ì¤€ë¹„</h3>
<p><strong>ì…ë ¥</strong></p>
<div
  class="code-block-container border-border bg-card my-6 overflow-hidden rounded-xl border shadow-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:shadow-md">
  
  <div
    class="code-block-header bg-muted/30 border-border flex items-center justify-between border-b px-4 py-3">
    
    <div class="flex items-center gap-2">
      <div class="text-muted-foreground flex-shrink-0">
        
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4" />
</svg>
      </div>
      <span class="text-muted-foreground text-sm font-medium">
        TEXT
      </span>
    </div>

    
    <div class="flex items-center gap-2">
      <button
          class="collapse-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none"
          data-code-id="code-3"
          data-default-state="expanded"
          data-collapsed="false"
          data-auto-collapse-lines="30"
          data-auto-collapse-height="400"
          data-collapsed-height="120"
          title="ì ‘ê¸°"
          aria-label="ì ‘ê¸°">
          <span class="collapse-icon">
            
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z"/></svg>
          </span>
          <span class="collapse-text hidden sm:inline"
            >ì ‘ê¸°</span
          >
        </button>
      <button
        class="copy-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none"
        data-code-id="code-3"
        title="ë³µì‚¬"
        aria-label="ë³µì‚¬">
        <span class="copy-icon">
          
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
</svg>
        </span>
        <span class="copy-text hidden sm:inline"
          >ë³µì‚¬</span
        >
      </button>
    </div>
  </div>

  
  <div class="code-block-content relative" id="code-3">
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="ln">1</span><span class="cl">xâ‚ƒ = [tokenâ‚, tokenâ‚‚, ..., tokenâ‚…â‚â‚‚]</span></span></code></pre></div>
    
    <div
      class="collapse-overlay to-card/90 pointer-events-none absolute inset-0 bg-gradient-to-b from-transparent via-transparent opacity-0 transition-opacity duration-300">
      <div
        class="text-muted-foreground bg-card/80 border-border/50 hover:bg-primary/10 hover:text-primary hover:border-primary/30 absolute bottom-4 left-1/2 -translate-x-1/2 cursor-pointer rounded-full border px-3 py-1.5 text-xs backdrop-blur-sm transition-all duration-200">
        í´ë¦­í•˜ì—¬ ë” ë³´ê¸°
      </div>
    </div>
  </div>
</div>


<script>
(function() {
  const codeId = 'code-3';
  const copyBtn = document.querySelector('.copy-code-btn[data-code-id="' + codeId + '"]');
  const collapseBtn = document.querySelector('.collapse-code-btn[data-code-id="' + codeId + '"]');
  const codeContainer = document.getElementById(codeId);

  if (!codeContainer) return;

  
  if (copyBtn) {
    const copyIcon = copyBtn.querySelector('.copy-icon');
    const copyText = copyBtn.querySelector('.copy-text');

    copyBtn.addEventListener('click', async function() {
      try {
        
        let codeText = '';

        
        const codeTableCell = codeContainer.querySelector('.lntd:last-child code');
        if (codeTableCell) {
          codeText = codeTableCell.textContent || codeTableCell.innerText;
        } else {
          
          const codeElement = codeContainer.querySelector('code');
          if (codeElement) {
            
            const hasInlineLineNumbers = codeElement.querySelector('.ln');
            if (hasInlineLineNumbers) {
              
              const codeLines = codeElement.querySelectorAll('.cl');
              if (codeLines.length > 0) {
                codeText = Array.from(codeLines)
                  .map(line => {
                    const text = line.textContent || line.innerText;
                    
                    return text.replace(/\n+$/, '');
                  })
                  .join('\n')
                  .replace(/\n+$/, ''); 
              } else {
                
                const allText = codeElement.textContent || codeElement.innerText;
                codeText = allText.replace(/^\d+/gm, '').replace(/^\s+/gm, '');
              }
            } else {
              
              codeText = codeElement.textContent || codeElement.innerText;
            }
          } else {
            
            codeText = codeContainer.textContent || codeContainer.innerText;
          }
        }

        
        codeText = codeText.trim();

        
        await navigator.clipboard.writeText(codeText);

        
        copyIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M5 13l4 4L19 7\u0022 \/\u003e\n\u003c\/svg\u003e`;
        if (copyText) {
          copyText.textContent = 'ë³µì‚¬ë¨';
        }
        copyBtn.classList.add('text-green-600');

        
        setTimeout(() => {
          copyIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z\u0022 \/\u003e\n\u003c\/svg\u003e`;
          if (copyText) {
            copyText.textContent = 'ë³µì‚¬';
          }
          copyBtn.classList.remove('text-green-600');
        }, 2000);

      } catch (err) {
        console.error('å¤åˆ¶å¤±è´¥:', err);

        
        const range = document.createRange();
        const codeElement = codeContainer.querySelector('code') || codeContainer;
        range.selectNodeContents(codeElement);
        const selection = window.getSelection();
        selection.removeAllRanges();
        selection.addRange(range);

        
        if (copyText) {
          copyText.textContent = 'ì„ íƒë¨';
        }

        setTimeout(() => {
          if (copyText) {
            copyText.textContent = 'ë³µì‚¬';
          }
          selection.removeAllRanges();
        }, 2000);
      }
    });
  }

  
  if (collapseBtn) {
    const collapseIcon = collapseBtn.querySelector('.collapse-icon');
    const collapseText = collapseBtn.querySelector('.collapse-text');
    const collapseOverlay = codeContainer.querySelector('.collapse-overlay');

    
    let codeElement = codeContainer.querySelector('pre.chroma');
    if (!codeElement) {
      codeElement = codeContainer.querySelector('pre');
    }

    const defaultState = collapseBtn.dataset.defaultState || 'expanded';
    const isCollapsedAttr = collapseBtn.dataset.collapsed === 'true';
    const autoCollapseLines = parseInt(collapseBtn.dataset.autoCollapseLines) || 30;
    const autoCollapseHeight = parseInt(collapseBtn.dataset.autoCollapseHeight) || 400;
    const collapsedHeight = parseInt(collapseBtn.dataset.collapsedHeight) || 120;

    let isCollapsed = false;

    
    function initCollapse() {
      
      const shouldCollapse = isCollapsedAttr ||
                           defaultState === 'collapsed' ||
                           shouldAutoCollapse();

      if (shouldCollapse) {
        setCollapsed(true, false); 
      }
    }

    function shouldAutoCollapse() {
      
      if (codeElement) {
        const lines = codeElement.querySelectorAll('.line, .cl');
        const height = codeElement.offsetHeight;
        return lines.length > autoCollapseLines || height > autoCollapseHeight;
      }

      
      const containerHeight = codeContainer.offsetHeight;
      if (containerHeight > autoCollapseHeight) {
        return true;
      }

      
      const textContent = codeContainer.textContent || codeContainer.innerText || '';
      const estimatedLines = textContent.split('\n').length;
      return estimatedLines > autoCollapseLines;
    }

    function setCollapsed(collapsed, animate = true) {
      if (!collapseOverlay) return;

      isCollapsed = collapsed;

      if (collapsed) {
        
        codeContainer.style.maxHeight = collapsedHeight + 'px';
        codeContainer.style.overflow = 'hidden';
        collapseOverlay.style.opacity = '1';
        collapseOverlay.style.pointerEvents = 'auto';

        
        collapseIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M19 9l-7 7-7-7\u0022 \/\u003e\n\u003c\/svg\u003e`;
        if (collapseText) {
          collapseText.textContent = 'í¼ì¹˜ê¸°';
        }
        collapseBtn.title = 'í¼ì¹˜ê¸°';

      } else {
        
        codeContainer.style.maxHeight = '';
        codeContainer.style.overflow = '';
        collapseOverlay.style.opacity = '0';
        collapseOverlay.style.pointerEvents = 'none';

        
        collapseIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath fill=\u0022currentColor\u0022 d=\u0022M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z\u0022\/\u003e\u003c\/svg\u003e`;
        if (collapseText) {
          collapseText.textContent = 'ì ‘ê¸°';
        }
        collapseBtn.title = 'ì ‘ê¸°';
      }

      
      if (animate) {
        codeContainer.style.transition = 'max-height 0.3s ease-out';
        setTimeout(() => {
          codeContainer.style.transition = '';
        }, 300);
      }
    }

    function toggleCollapse() {
      setCollapsed(!isCollapsed, true);
    }

    
    collapseBtn.addEventListener('click', toggleCollapse);

    
    if (collapseOverlay) {
      collapseOverlay.addEventListener('click', () => {
        if (isCollapsed) {
          setCollapsed(false, true);
        }
      });
    }

    
    initCollapse();
  }
})();
</script>
<p><strong>ì´ì „ memory</strong></p>
<ul>
<li><code>zâ‚‚</code>: ì´ì „ windowì˜ short-term memory (128 vectors)</li>
<li><code>mâ‚:â‚‚</code>: ì´ì „ ë‘ windowì˜ long-term memory (64Ã—2 = 128 KV pair)</li>
</ul>
<hr>
<h3 id="-step-2-short-term-memory-ì²˜ë¦¬-mê°œì˜-layer-ë°˜ë³µ">â–¶ï¸ Step 2: Short-Term Memory ì²˜ë¦¬ (Mê°œì˜ layer ë°˜ë³µ)</h3>
<p>ê° short-term layerì—ì„œ:</p>
<ol>
<li><code>zâ‚‚</code>ì™€ í˜„ì¬ token <code>xâ‚ƒ</code>ì— ëŒ€í•´ <strong>causal attention</strong></li>
<li>context token â†’ transformer â†’ <code>xâ‚ƒâ€²</code>ë¡œ ì—…ë°ì´íŠ¸</li>
<li>summary token <code>uâ‚ƒ</code> ìƒì„± (128 tokens)</li>
<li>summary tokenê³¼ context tokenì„ í†µí•´ <strong>ë‹¤ìŒ windowìš© memory token <code>zâ‚ƒ</code> ìƒì„±</strong></li>
</ol>
<p>ğŸ’¡ ìˆ˜ì‹ ì •ë¦¬:</p>
<div
  class="code-block-container border-border bg-card my-6 overflow-hidden rounded-xl border shadow-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:shadow-md">
  
  <div
    class="code-block-header bg-muted/30 border-border flex items-center justify-between border-b px-4 py-3">
    
    <div class="flex items-center gap-2">
      <div class="text-muted-foreground flex-shrink-0">
        
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4" />
</svg>
      </div>
      <span class="text-muted-foreground text-sm font-medium">
        MATH
      </span>
    </div>

    
    <div class="flex items-center gap-2">
      <button
          class="collapse-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none"
          data-code-id="code-4"
          data-default-state="expanded"
          data-collapsed="false"
          data-auto-collapse-lines="30"
          data-auto-collapse-height="400"
          data-collapsed-height="120"
          title="ì ‘ê¸°"
          aria-label="ì ‘ê¸°">
          <span class="collapse-icon">
            
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z"/></svg>
          </span>
          <span class="collapse-text hidden sm:inline"
            >ì ‘ê¸°</span
          >
        </button>
      <button
        class="copy-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none"
        data-code-id="code-4"
        title="ë³µì‚¬"
        aria-label="ë³µì‚¬">
        <span class="copy-icon">
          
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
</svg>
        </span>
        <span class="copy-text hidden sm:inline"
          >ë³µì‚¬</span
        >
      </button>
    </div>
  </div>

  
  <div class="code-block-content relative" id="code-4">
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">xâ‚ƒâ€² = T(xâ‚ƒ | zâ‚‚)  
</span></span><span class="line"><span class="ln">2</span><span class="cl">uÌ‚â‚ƒ = T(uâ‚‚ | xâ‚ƒ, zâ‚‚)  
</span></span><span class="line"><span class="ln">3</span><span class="cl">zâ‚ƒ = Mâ†’(xâ‚ƒâ€², uÌ‚â‚ƒ)  
</span></span><span class="line"><span class="ln">4</span><span class="cl">uâ‚ƒ = Mâ†‘(xâ‚ƒâ€², uÌ‚â‚ƒ)</span></span></code></pre></div>
    
    <div
      class="collapse-overlay to-card/90 pointer-events-none absolute inset-0 bg-gradient-to-b from-transparent via-transparent opacity-0 transition-opacity duration-300">
      <div
        class="text-muted-foreground bg-card/80 border-border/50 hover:bg-primary/10 hover:text-primary hover:border-primary/30 absolute bottom-4 left-1/2 -translate-x-1/2 cursor-pointer rounded-full border px-3 py-1.5 text-xs backdrop-blur-sm transition-all duration-200">
        í´ë¦­í•˜ì—¬ ë” ë³´ê¸°
      </div>
    </div>
  </div>
</div>


<script>
(function() {
  const codeId = 'code-4';
  const copyBtn = document.querySelector('.copy-code-btn[data-code-id="' + codeId + '"]');
  const collapseBtn = document.querySelector('.collapse-code-btn[data-code-id="' + codeId + '"]');
  const codeContainer = document.getElementById(codeId);

  if (!codeContainer) return;

  
  if (copyBtn) {
    const copyIcon = copyBtn.querySelector('.copy-icon');
    const copyText = copyBtn.querySelector('.copy-text');

    copyBtn.addEventListener('click', async function() {
      try {
        
        let codeText = '';

        
        const codeTableCell = codeContainer.querySelector('.lntd:last-child code');
        if (codeTableCell) {
          codeText = codeTableCell.textContent || codeTableCell.innerText;
        } else {
          
          const codeElement = codeContainer.querySelector('code');
          if (codeElement) {
            
            const hasInlineLineNumbers = codeElement.querySelector('.ln');
            if (hasInlineLineNumbers) {
              
              const codeLines = codeElement.querySelectorAll('.cl');
              if (codeLines.length > 0) {
                codeText = Array.from(codeLines)
                  .map(line => {
                    const text = line.textContent || line.innerText;
                    
                    return text.replace(/\n+$/, '');
                  })
                  .join('\n')
                  .replace(/\n+$/, ''); 
              } else {
                
                const allText = codeElement.textContent || codeElement.innerText;
                codeText = allText.replace(/^\d+/gm, '').replace(/^\s+/gm, '');
              }
            } else {
              
              codeText = codeElement.textContent || codeElement.innerText;
            }
          } else {
            
            codeText = codeContainer.textContent || codeContainer.innerText;
          }
        }

        
        codeText = codeText.trim();

        
        await navigator.clipboard.writeText(codeText);

        
        copyIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M5 13l4 4L19 7\u0022 \/\u003e\n\u003c\/svg\u003e`;
        if (copyText) {
          copyText.textContent = 'ë³µì‚¬ë¨';
        }
        copyBtn.classList.add('text-green-600');

        
        setTimeout(() => {
          copyIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z\u0022 \/\u003e\n\u003c\/svg\u003e`;
          if (copyText) {
            copyText.textContent = 'ë³µì‚¬';
          }
          copyBtn.classList.remove('text-green-600');
        }, 2000);

      } catch (err) {
        console.error('å¤åˆ¶å¤±è´¥:', err);

        
        const range = document.createRange();
        const codeElement = codeContainer.querySelector('code') || codeContainer;
        range.selectNodeContents(codeElement);
        const selection = window.getSelection();
        selection.removeAllRanges();
        selection.addRange(range);

        
        if (copyText) {
          copyText.textContent = 'ì„ íƒë¨';
        }

        setTimeout(() => {
          if (copyText) {
            copyText.textContent = 'ë³µì‚¬';
          }
          selection.removeAllRanges();
        }, 2000);
      }
    });
  }

  
  if (collapseBtn) {
    const collapseIcon = collapseBtn.querySelector('.collapse-icon');
    const collapseText = collapseBtn.querySelector('.collapse-text');
    const collapseOverlay = codeContainer.querySelector('.collapse-overlay');

    
    let codeElement = codeContainer.querySelector('pre.chroma');
    if (!codeElement) {
      codeElement = codeContainer.querySelector('pre');
    }

    const defaultState = collapseBtn.dataset.defaultState || 'expanded';
    const isCollapsedAttr = collapseBtn.dataset.collapsed === 'true';
    const autoCollapseLines = parseInt(collapseBtn.dataset.autoCollapseLines) || 30;
    const autoCollapseHeight = parseInt(collapseBtn.dataset.autoCollapseHeight) || 400;
    const collapsedHeight = parseInt(collapseBtn.dataset.collapsedHeight) || 120;

    let isCollapsed = false;

    
    function initCollapse() {
      
      const shouldCollapse = isCollapsedAttr ||
                           defaultState === 'collapsed' ||
                           shouldAutoCollapse();

      if (shouldCollapse) {
        setCollapsed(true, false); 
      }
    }

    function shouldAutoCollapse() {
      
      if (codeElement) {
        const lines = codeElement.querySelectorAll('.line, .cl');
        const height = codeElement.offsetHeight;
        return lines.length > autoCollapseLines || height > autoCollapseHeight;
      }

      
      const containerHeight = codeContainer.offsetHeight;
      if (containerHeight > autoCollapseHeight) {
        return true;
      }

      
      const textContent = codeContainer.textContent || codeContainer.innerText || '';
      const estimatedLines = textContent.split('\n').length;
      return estimatedLines > autoCollapseLines;
    }

    function setCollapsed(collapsed, animate = true) {
      if (!collapseOverlay) return;

      isCollapsed = collapsed;

      if (collapsed) {
        
        codeContainer.style.maxHeight = collapsedHeight + 'px';
        codeContainer.style.overflow = 'hidden';
        collapseOverlay.style.opacity = '1';
        collapseOverlay.style.pointerEvents = 'auto';

        
        collapseIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M19 9l-7 7-7-7\u0022 \/\u003e\n\u003c\/svg\u003e`;
        if (collapseText) {
          collapseText.textContent = 'í¼ì¹˜ê¸°';
        }
        collapseBtn.title = 'í¼ì¹˜ê¸°';

      } else {
        
        codeContainer.style.maxHeight = '';
        codeContainer.style.overflow = '';
        collapseOverlay.style.opacity = '0';
        collapseOverlay.style.pointerEvents = 'none';

        
        collapseIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath fill=\u0022currentColor\u0022 d=\u0022M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z\u0022\/\u003e\u003c\/svg\u003e`;
        if (collapseText) {
          collapseText.textContent = 'ì ‘ê¸°';
        }
        collapseBtn.title = 'ì ‘ê¸°';
      }

      
      if (animate) {
        codeContainer.style.transition = 'max-height 0.3s ease-out';
        setTimeout(() => {
          codeContainer.style.transition = '';
        }, 300);
      }
    }

    function toggleCollapse() {
      setCollapsed(!isCollapsed, true);
    }

    
    collapseBtn.addEventListener('click', toggleCollapse);

    
    if (collapseOverlay) {
      collapseOverlay.addEventListener('click', () => {
        if (isCollapsed) {
          setCollapsed(false, true);
        }
      });
    }

    
    initCollapse();
  }
})();
</script>
<hr>
<h3 id="-step-3-long-term-memory-ì²˜ë¦¬-ë‹¨ì¼-middle-layerì—ì„œë§Œ">â–¶ï¸ Step 3: Long-Term Memory ì²˜ë¦¬ (ë‹¨ì¼ middle layerì—ì„œë§Œ)</h3>
<ul>
<li>xâ‚ƒâ€², uâ‚ƒê°€ ì´ì „ LTM (mâ‚:â‚‚)ì— ëŒ€í•´ <strong>cross-attention</strong> ìˆ˜í–‰</li>
<li>ê²°ê³¼ë¥¼ self-attention ê²°ê³¼ì™€ <strong>gating</strong>í•˜ì—¬ ì¡°í•©:</li>
</ul>
<div
  class="code-block-container border-border bg-card my-6 overflow-hidden rounded-xl border shadow-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:shadow-md">
  
  <div
    class="code-block-header bg-muted/30 border-border flex items-center justify-between border-b px-4 py-3">
    
    <div class="flex items-center gap-2">
      <div class="text-muted-foreground flex-shrink-0">
        
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4" />
</svg>
      </div>
      <span class="text-muted-foreground text-sm font-medium">
        MATH
      </span>
    </div>

    
    <div class="flex items-center gap-2">
      <button
          class="collapse-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none"
          data-code-id="code-5"
          data-default-state="expanded"
          data-collapsed="false"
          data-auto-collapse-lines="30"
          data-auto-collapse-height="400"
          data-collapsed-height="120"
          title="ì ‘ê¸°"
          aria-label="ì ‘ê¸°">
          <span class="collapse-icon">
            
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z"/></svg>
          </span>
          <span class="collapse-text hidden sm:inline"
            >ì ‘ê¸°</span
          >
        </button>
      <button
        class="copy-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none"
        data-code-id="code-5"
        title="ë³µì‚¬"
        aria-label="ë³µì‚¬">
        <span class="copy-icon">
          
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
</svg>
        </span>
        <span class="copy-text hidden sm:inline"
          >ë³µì‚¬</span
        >
      </button>
    </div>
  </div>

  
  <div class="code-block-content relative" id="code-5">
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">A = Î± â‹… A_cross + (1 âˆ’ Î±) â‹… A_self</span></span></code></pre></div>
    
    <div
      class="collapse-overlay to-card/90 pointer-events-none absolute inset-0 bg-gradient-to-b from-transparent via-transparent opacity-0 transition-opacity duration-300">
      <div
        class="text-muted-foreground bg-card/80 border-border/50 hover:bg-primary/10 hover:text-primary hover:border-primary/30 absolute bottom-4 left-1/2 -translate-x-1/2 cursor-pointer rounded-full border px-3 py-1.5 text-xs backdrop-blur-sm transition-all duration-200">
        í´ë¦­í•˜ì—¬ ë” ë³´ê¸°
      </div>
    </div>
  </div>
</div>


<script>
(function() {
  const codeId = 'code-5';
  const copyBtn = document.querySelector('.copy-code-btn[data-code-id="' + codeId + '"]');
  const collapseBtn = document.querySelector('.collapse-code-btn[data-code-id="' + codeId + '"]');
  const codeContainer = document.getElementById(codeId);

  if (!codeContainer) return;

  
  if (copyBtn) {
    const copyIcon = copyBtn.querySelector('.copy-icon');
    const copyText = copyBtn.querySelector('.copy-text');

    copyBtn.addEventListener('click', async function() {
      try {
        
        let codeText = '';

        
        const codeTableCell = codeContainer.querySelector('.lntd:last-child code');
        if (codeTableCell) {
          codeText = codeTableCell.textContent || codeTableCell.innerText;
        } else {
          
          const codeElement = codeContainer.querySelector('code');
          if (codeElement) {
            
            const hasInlineLineNumbers = codeElement.querySelector('.ln');
            if (hasInlineLineNumbers) {
              
              const codeLines = codeElement.querySelectorAll('.cl');
              if (codeLines.length > 0) {
                codeText = Array.from(codeLines)
                  .map(line => {
                    const text = line.textContent || line.innerText;
                    
                    return text.replace(/\n+$/, '');
                  })
                  .join('\n')
                  .replace(/\n+$/, ''); 
              } else {
                
                const allText = codeElement.textContent || codeElement.innerText;
                codeText = allText.replace(/^\d+/gm, '').replace(/^\s+/gm, '');
              }
            } else {
              
              codeText = codeElement.textContent || codeElement.innerText;
            }
          } else {
            
            codeText = codeContainer.textContent || codeContainer.innerText;
          }
        }

        
        codeText = codeText.trim();

        
        await navigator.clipboard.writeText(codeText);

        
        copyIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M5 13l4 4L19 7\u0022 \/\u003e\n\u003c\/svg\u003e`;
        if (copyText) {
          copyText.textContent = 'ë³µì‚¬ë¨';
        }
        copyBtn.classList.add('text-green-600');

        
        setTimeout(() => {
          copyIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z\u0022 \/\u003e\n\u003c\/svg\u003e`;
          if (copyText) {
            copyText.textContent = 'ë³µì‚¬';
          }
          copyBtn.classList.remove('text-green-600');
        }, 2000);

      } catch (err) {
        console.error('å¤åˆ¶å¤±è´¥:', err);

        
        const range = document.createRange();
        const codeElement = codeContainer.querySelector('code') || codeContainer;
        range.selectNodeContents(codeElement);
        const selection = window.getSelection();
        selection.removeAllRanges();
        selection.addRange(range);

        
        if (copyText) {
          copyText.textContent = 'ì„ íƒë¨';
        }

        setTimeout(() => {
          if (copyText) {
            copyText.textContent = 'ë³µì‚¬';
          }
          selection.removeAllRanges();
        }, 2000);
      }
    });
  }

  
  if (collapseBtn) {
    const collapseIcon = collapseBtn.querySelector('.collapse-icon');
    const collapseText = collapseBtn.querySelector('.collapse-text');
    const collapseOverlay = codeContainer.querySelector('.collapse-overlay');

    
    let codeElement = codeContainer.querySelector('pre.chroma');
    if (!codeElement) {
      codeElement = codeContainer.querySelector('pre');
    }

    const defaultState = collapseBtn.dataset.defaultState || 'expanded';
    const isCollapsedAttr = collapseBtn.dataset.collapsed === 'true';
    const autoCollapseLines = parseInt(collapseBtn.dataset.autoCollapseLines) || 30;
    const autoCollapseHeight = parseInt(collapseBtn.dataset.autoCollapseHeight) || 400;
    const collapsedHeight = parseInt(collapseBtn.dataset.collapsedHeight) || 120;

    let isCollapsed = false;

    
    function initCollapse() {
      
      const shouldCollapse = isCollapsedAttr ||
                           defaultState === 'collapsed' ||
                           shouldAutoCollapse();

      if (shouldCollapse) {
        setCollapsed(true, false); 
      }
    }

    function shouldAutoCollapse() {
      
      if (codeElement) {
        const lines = codeElement.querySelectorAll('.line, .cl');
        const height = codeElement.offsetHeight;
        return lines.length > autoCollapseLines || height > autoCollapseHeight;
      }

      
      const containerHeight = codeContainer.offsetHeight;
      if (containerHeight > autoCollapseHeight) {
        return true;
      }

      
      const textContent = codeContainer.textContent || codeContainer.innerText || '';
      const estimatedLines = textContent.split('\n').length;
      return estimatedLines > autoCollapseLines;
    }

    function setCollapsed(collapsed, animate = true) {
      if (!collapseOverlay) return;

      isCollapsed = collapsed;

      if (collapsed) {
        
        codeContainer.style.maxHeight = collapsedHeight + 'px';
        codeContainer.style.overflow = 'hidden';
        collapseOverlay.style.opacity = '1';
        collapseOverlay.style.pointerEvents = 'auto';

        
        collapseIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M19 9l-7 7-7-7\u0022 \/\u003e\n\u003c\/svg\u003e`;
        if (collapseText) {
          collapseText.textContent = 'í¼ì¹˜ê¸°';
        }
        collapseBtn.title = 'í¼ì¹˜ê¸°';

      } else {
        
        codeContainer.style.maxHeight = '';
        codeContainer.style.overflow = '';
        collapseOverlay.style.opacity = '0';
        collapseOverlay.style.pointerEvents = 'none';

        
        collapseIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath fill=\u0022currentColor\u0022 d=\u0022M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z\u0022\/\u003e\u003c\/svg\u003e`;
        if (collapseText) {
          collapseText.textContent = 'ì ‘ê¸°';
        }
        collapseBtn.title = 'ì ‘ê¸°';
      }

      
      if (animate) {
        codeContainer.style.transition = 'max-height 0.3s ease-out';
        setTimeout(() => {
          codeContainer.style.transition = '';
        }, 300);
      }
    }

    function toggleCollapse() {
      setCollapsed(!isCollapsed, true);
    }

    
    collapseBtn.addEventListener('click', toggleCollapse);

    
    if (collapseOverlay) {
      collapseOverlay.addEventListener('click', () => {
        if (isCollapsed) {
          setCollapsed(false, true);
        }
      });
    }

    
    initCollapse();
  }
})();
</script>
<ul>
<li>ì´ ê²°ê³¼ë¥¼ <code>L = 64</code>ê°œì˜ vectorë¡œ <strong>ì¶”ê°€ ì••ì¶•</strong></li>
<li>ì••ì¶•ëœ vectorë¥¼ KVë¡œ ë³€í™˜í•˜ì—¬ <code>mâ‚ƒ</code>ë¡œ long-term memoryì— ì¶”ê°€</li>
</ul>
<hr>
<h3 id="-step-4-output-ì „ë‹¬">â–¶ï¸ Step 4: Output ì „ë‹¬</h3>
<ul>
<li>ìœ„ ê³¼ì •ì„ í†µí•´ ë‹¤ìŒ windowì—ì„œëŠ” <code>zâ‚ƒ</code>, <code>mâ‚:â‚ƒ</code>ë¥¼ ì‚¬ìš©</li>
<li>í•´ë‹¹ window ë‚´ layerëŠ” <code>uâ‚ƒ</code>ì™€ <code>xâ‚ƒâ€²</code>ë¥¼ ë‹¤ìŒ layerë¡œ ë„˜ê¹€</li>
</ul>
<hr>
<h2 id="-ì „ì²´-ë°˜ë³µ">ğŸ” ì „ì²´ ë°˜ë³µ</h2>
<p>ì´ ê³¼ì •ì„ ê° windowë§ˆë‹¤ ë°˜ë³µí•˜ë©° ê¸´ ë¬¸ë§¥ì„ ì´ì–´ê°€ê³ , í•„ìš”í•œ ë¬¸ë§¥ì€:</p>
<ul>
<li><strong>ì§ì „ short memory</strong> <code>zâ‚–â‚‹â‚</code></li>
<li><strong>ì¥ê¸° ìš”ì•½ ë©”ëª¨ë¦¬</strong> <code>mâ‚:â‚–â‚‹â‚</code></li>
</ul>
<p>ë¥¼ í†µí•´ <strong>ì „ë°©í–¥ìœ¼ë¡œ contextë¥¼ ì—°ê²°</strong>í•©ë‹ˆë‹¤.</p>
<hr>
<h2 id="-ì •ë¦¬-ì•Œê³ ë¦¬ì¦˜-íë¦„ë„">ğŸ“Š ì •ë¦¬: ì•Œê³ ë¦¬ì¦˜ íë¦„ë„</h2>
<table>
  <thead>
      <tr>
          <th>ë‹¨ê³„</th>
          <th>ë™ì‘</th>
          <th>ì…ë ¥</th>
          <th>ì¶œë ¥</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>â‘ </td>
          <td>Short-term attention</td>
          <td><code>xâ‚–</code>, <code>zâ‚–â‚‹â‚</code></td>
          <td><code>xâ‚–â€²</code>, <code>uâ‚–</code></td>
      </tr>
      <tr>
          <td>â‘¡</td>
          <td>Summary compression</td>
          <td><code>xâ‚–â€²</code>, <code>uâ‚–</code></td>
          <td><code>zâ‚–</code> (ë‹¤ìŒ windowìš©)</td>
      </tr>
      <tr>
          <td>â‘¢</td>
          <td>Long-term memory attention</td>
          <td><code>xâ‚–â€²</code>, <code>uâ‚–</code>, <code>mâ‚:â‚–â‚‹â‚</code></td>
          <td><code>Aâ‚–</code> (gated attention result)</td>
      </tr>
      <tr>
          <td>â‘£</td>
          <td>Long-term token ìƒì„±</td>
          <td><code>Aâ‚–</code> â†’ linear mixer</td>
          <td><code>mâ‚–</code> (KV í˜•íƒœ ì €ì¥)</td>
      </tr>
      <tr>
          <td>â‘¤</td>
          <td>Forwarding</td>
          <td><code>xâ‚–â€²</code>, <code>uâ‚–</code>, <code>zâ‚–</code>, <code>mâ‚:â‚–</code></td>
          <td>ë‹¤ìŒ window ì²˜ë¦¬ì— ì‚¬ìš©</td>
      </tr>
  </tbody>
</table>
<hr>
<h2 id="-ì£¼ìš”-íŠ¹ì„±">ğŸ§  ì£¼ìš” íŠ¹ì„±</h2>
<ul>
<li>ğŸ’¾ <strong>Memory-efficient</strong>: long memoryëŠ” KVë§Œ ì €ì¥</li>
<li>ğŸ”„ <strong>Recurrent compression</strong>: LSTM ìŠ¤íƒ€ì¼ ì •ë³´ë¥¼ ìš”ì•½</li>
<li>â›“ï¸ <strong>Global context retention</strong>: ì „ì²´ window history ë³´ì¡´ ê°€ëŠ¥</li>
</ul>
<h1 id="q--ì´-ë…¼ë¬¸ì—ì„œ-ì œì‹œí•œ-ê²°ê³¼ë¥¼-ìì„¸í•˜ê²Œ-ë³´ê³ -ë‹¤ë¥¸-ë°©ë²•ë¡ ì—-ë¹„í•˜ì—¬-íŠ¹ì¶œë‚œ-ì ê³¼-ë…¼ë¬¸ì—ì„œ-ì œê¸°í•˜ëŠ”-ì–´ë– í•œ-ë°©ë²•ì´-ì´ëŸ¬í•œ-ê²°ê³¼ë¥¼-ë„ì¶œí•˜ê²Œ-ë˜ì—ˆëŠ”ì§€-ë…¼ë¬¸ì—ì„œ-ì œì‹œí•˜ëŠ”-ì´ìœ ì™€-ë„ˆì˜-ìƒê°ì„-ì•Œë ¤ì¤˜">Q : ì´ ë…¼ë¬¸ì—ì„œ ì œì‹œí•œ ê²°ê³¼ë¥¼ ìì„¸í•˜ê²Œ ë³´ê³  ë‹¤ë¥¸ ë°©ë²•ë¡ ì— ë¹„í•˜ì—¬ íŠ¹ì¶œë‚œ ì ê³¼ ë…¼ë¬¸ì—ì„œ ì œê¸°í•˜ëŠ” ì–´ë– í•œ ë°©ë²•ì´ ì´ëŸ¬í•œ ê²°ê³¼ë¥¼ ë„ì¶œí•˜ê²Œ ë˜ì—ˆëŠ”ì§€ ë…¼ë¬¸ì—ì„œ ì œì‹œí•˜ëŠ” ì´ìœ ì™€ ë„ˆì˜ ìƒê°ì„ ì•Œë ¤ì¤˜</h1>
<p>ì¢‹ìŠµë‹ˆë‹¤. ì•„ë˜ì— ë…¼ë¬¸ MELODIê°€ ì œì‹œí•œ <strong>ì‹¤í—˜ ê²°ê³¼ ë¶„ì„</strong>, <strong>ê¸°ì¡´ ë°©ë²•ë¡ ê³¼ì˜ ë¹„êµ</strong>, ê·¸ë¦¬ê³  <strong>ê·¸ ê²°ê³¼ë¥¼ ë„ì¶œí•œ ì„¤ê³„ ìš”ì¸ê³¼ í•„ìì˜ ê²¬í•´</strong>ë¥¼ <strong>ìˆ˜ì¹˜ ê¸°ë°˜</strong>ìœ¼ë¡œ ì •ë¦¬í•´ ë“œë¦¬ê² ìŠµë‹ˆë‹¤.</p>
<hr>
<h2 id="-1-ì‹¤í—˜-ê²°ê³¼-ì •ë¦¬-perplexity-ê¸°ì¤€-ì„±ëŠ¥-ë¹„êµ">âœ… 1. ì‹¤í—˜ ê²°ê³¼ ì •ë¦¬ (Perplexity ê¸°ì¤€ ì„±ëŠ¥ ë¹„êµ)</h2>
<table>
  <thead>
      <tr>
          <th>ëª¨ë¸</th>
          <th>PG19 (T5 vocab)</th>
          <th>arXiv (Meena)</th>
          <th>C4(4K+)</th>
          <th>ì´ ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰</th>
          <th>ì¥ê¸° ë©”ëª¨ë¦¬</th>
          <th>ë‹¨ê¸° ë©”ëª¨ë¦¬</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>Transformer XL</td>
          <td>11.41</td>
          <td>2.60</td>
          <td>18.22</td>
          <td>13.6M</td>
          <td>âŒ ì—†ìŒ</td>
          <td>13.6M</td>
      </tr>
      <tr>
          <td>Block Recurrent Transf.</td>
          <td>10.98</td>
          <td>2.26</td>
          <td>17.82</td>
          <td>13.1M</td>
          <td>âŒ ì—†ìŒ</td>
          <td>13.1M</td>
      </tr>
      <tr>
          <td>Memorizing Transformer</td>
          <td>10.62</td>
          <td>2.14</td>
          <td>17.37</td>
          <td><strong>147.8M</strong></td>
          <td>134.2M</td>
          <td>13.6M</td>
      </tr>
      <tr>
          <td>MELODI (S192+L96)</td>
          <td><strong>10.29</strong></td>
          <td><strong>2.09</strong></td>
          <td><strong>17.25</strong></td>
          <td><strong>27.8M</strong></td>
          <td>25.2M</td>
          <td>2.6M</td>
      </tr>
  </tbody>
</table>
<p>ğŸ“Œ <strong>í•µì‹¬ ì„±ê³¼ ìš”ì•½</strong>:</p>
<ul>
<li>Memorizing Transformerë³´ë‹¤ ì„±ëŠ¥ <strong>í–¥ìƒ</strong> (PG19: â†“0.33 PPL)</li>
<li><strong>Memory ì‚¬ìš©ëŸ‰ 5.3ë°° ê°ì†Œ</strong></li>
<li>Transformer-XL ëŒ€ë¹„ ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ â†“ <strong>19%</strong>, ì„±ëŠ¥ì€ â†‘</li>
</ul>
<hr>
<h2 id="-2-ê¸°ì¡´-ë°©ë²•ë¡ -ëŒ€ë¹„-melodiì˜-íŠ¹ì¶œë‚œ-ì ">âœ… 2. ê¸°ì¡´ ë°©ë²•ë¡  ëŒ€ë¹„ MELODIì˜ íŠ¹ì¶œë‚œ ì </h2>
<table>
  <thead>
      <tr>
          <th>í•­ëª©</th>
          <th>Memorizing Transformer (MT)</th>
          <th>MELODI</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>KV ì €ì¥ ë°©ì‹</strong></td>
          <td>context token ì „ì²´ KV ì €ì¥ (dense)</td>
          <td>context windowë¥¼ ì••ì¶•í•œ <strong>low-dim KV ì €ì¥</strong></td>
      </tr>
      <tr>
          <td><strong>ë‹¨ê¸° ë©”ëª¨ë¦¬</strong></td>
          <td>ì—†ìŒ or top-layer LSTMì ìš©</td>
          <td>ì „ì¸µì— ê±¸ì¹œ <strong>multi-layer recurrent compression</strong></td>
      </tr>
      <tr>
          <td><strong>ë©”ëª¨ë¦¬ ìš©ëŸ‰</strong></td>
          <td>64K token KV ì €ì¥</td>
          <td>64 compressed KV / window Ã— 128 windows</td>
      </tr>
      <tr>
          <td><strong>ì„±ëŠ¥ íš¨ìœ¨ tradeoff</strong></td>
          <td>long-term memory í¬ë©´ ì„±ëŠ¥ ì¦ê°€ â†’ but ë©”ëª¨ë¦¬ ê¸‰ì¦</td>
          <td>ì‘ì€ memory footprintë¡œë„ ì„±ëŠ¥ ìœ ì§€</td>
      </tr>
      <tr>
          <td><strong>ë©”ëª¨ë¦¬ êµ¬ì¡° í†µí•©</strong></td>
          <td>ë‹¨ì¼ layerë§Œ ì‚¬ìš©</td>
          <td><strong>SM + LMì˜ ê³„ì¸µ êµ¬ì¡° ì„¤ê³„</strong></td>
      </tr>
      <tr>
          <td><strong>ìš”ì•½ í† í° ì‚¬ìš©</strong></td>
          <td>X</td>
          <td>summary tokenìœ¼ë¡œ SM-ê°„ ì—°ê²° ê°•í™”</td>
      </tr>
  </tbody>
</table>
<hr>
<h2 id="-3-ë…¼ë¬¸ì´-ì„¤ëª…í•˜ëŠ”-ì„±ëŠ¥-í–¥ìƒì˜-ì´ìœ ">âœ… 3. ë…¼ë¬¸ì´ ì„¤ëª…í•˜ëŠ” ì„±ëŠ¥ í–¥ìƒì˜ ì´ìœ </h2>
<p>ë…¼ë¬¸ì€ ì•„ë˜ ì„¸ ê°€ì§€ë¥¼ ì„±ëŠ¥ í–¥ìƒì˜ <strong>í•µì‹¬ ì´ìœ </strong>ë¡œ ì œì‹œí•©ë‹ˆë‹¤.</p>
<h3 id="-ê³„ì¸µì -ë©”ëª¨ë¦¬-êµ¬ì¡°-hierarchical-compression">â‘  ê³„ì¸µì  ë©”ëª¨ë¦¬ êµ¬ì¡° (hierarchical compression)</h3>
<ul>
<li><strong>SM</strong>: window ë‚´ë¶€ ì •ë³´ë¥¼ ì—¬ëŸ¬ ì¸µì„ í†µí•´ ì••ì¶• â†’ <code>512 â†’ 128 tokens</code></li>
<li><strong>LM</strong>: window ì „ì²´ë¥¼ ìš”ì•½í•˜ì—¬ ë‹¨ì¼ layerì—ì„œ <code>â†’ 64 tokens</code></li>
<li>â‡’ ìš”ì•½ ì†ì‹¤ì„ <strong>ê³„ì¸µì ìœ¼ë¡œ ë³´ì™„</strong>, ë‹¨ì¼ ë°©ì‹ë³´ë‹¤ ì •ë³´ ë³´ì¡´ ìš°ìˆ˜</li>
</ul>

  <blockquote
    class="border-primary bg-muted/30 hover:bg-muted/40 my-6 rounded-r-lg border-l-4 py-4 pr-4 pl-6 italic transition-all duration-200 ease-out hover:translate-x-1">
    <div class="prose prose-sm max-w-none">
      <p>ğŸ“Œ Ablationì—ì„œ í™•ì¸ë¨: SM ë˜ëŠ” LMë§Œ ì‚¬ìš© ì‹œ PPL â†‘, ë‘˜ í•¨ê»˜ ì“¸ ë•Œ ê°€ì¥ ë‚®ìŒ</p>
    </div>
  </blockquote>

<hr>
<h3 id="-summary-branching-ë‹¨ê¸°-ê¸°ì–µì˜-layer-ê°„-ì „íŒŒ-ê°•í™”">â‘¡ Summary branching (ë‹¨ê¸° ê¸°ì–µì˜ layer ê°„ ì „íŒŒ ê°•í™”)</h3>
<ul>
<li>summary tokenì„ ë‹¤ìŒ layerë¿ ì•„ë‹ˆë¼ <strong>ë‹¤ìŒ windowì—ë„ ì „ë‹¬</strong></li>
<li>â‡’ memory ê°„ <strong>cross-layer / cross-window ì •ë³´ íë¦„</strong> í˜•ì„±</li>
<li>â‡’ PPL ì•½ <strong>0.3 ê°ì†Œ íš¨ê³¼</strong></li>
</ul>

  <blockquote
    class="border-primary bg-muted/30 hover:bg-muted/40 my-6 rounded-r-lg border-l-4 py-4 pr-4 pl-6 italic transition-all duration-200 ease-out hover:translate-x-1">
    <div class="prose prose-sm max-w-none">
      <p>ë…¼ë¬¸ Table 4:</p>
<div
  class="code-block-container border-border bg-card my-6 overflow-hidden rounded-xl border shadow-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:shadow-md">
  
  <div
    class="code-block-header bg-muted/30 border-border flex items-center justify-between border-b px-4 py-3">
    
    <div class="flex items-center gap-2">
      <div class="text-muted-foreground flex-shrink-0">
        
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4" />
</svg>
      </div>
      <span class="text-muted-foreground text-sm font-medium">
        PLAINTEXT
      </span>
    </div>

    
    <div class="flex items-center gap-2">
      <button
          class="collapse-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none"
          data-code-id="code-6"
          data-default-state="expanded"
          data-collapsed="false"
          data-auto-collapse-lines="30"
          data-auto-collapse-height="400"
          data-collapsed-height="120"
          title="ì ‘ê¸°"
          aria-label="ì ‘ê¸°">
          <span class="collapse-icon">
            
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z"/></svg>
          </span>
          <span class="collapse-text hidden sm:inline"
            >ì ‘ê¸°</span
          >
        </button>
      <button
        class="copy-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none"
        data-code-id="code-6"
        title="ë³µì‚¬"
        aria-label="ë³µì‚¬">
        <span class="copy-icon">
          
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
</svg>
        </span>
        <span class="copy-text hidden sm:inline"
          >ë³µì‚¬</span
        >
      </button>
    </div>
  </div>

  
  <div class="code-block-content relative" id="code-6">
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">w/o branching: 11.24
</span></span><span class="line"><span class="ln">2</span><span class="cl">w/ branching:  10.95</span></span></code></pre></div>
    
    <div
      class="collapse-overlay to-card/90 pointer-events-none absolute inset-0 bg-gradient-to-b from-transparent via-transparent opacity-0 transition-opacity duration-300">
      <div
        class="text-muted-foreground bg-card/80 border-border/50 hover:bg-primary/10 hover:text-primary hover:border-primary/30 absolute bottom-4 left-1/2 -translate-x-1/2 cursor-pointer rounded-full border px-3 py-1.5 text-xs backdrop-blur-sm transition-all duration-200">
        í´ë¦­í•˜ì—¬ ë” ë³´ê¸°
      </div>
    </div>
  </div>
</div>


<script>
(function() {
  const codeId = 'code-6';
  const copyBtn = document.querySelector('.copy-code-btn[data-code-id="' + codeId + '"]');
  const collapseBtn = document.querySelector('.collapse-code-btn[data-code-id="' + codeId + '"]');
  const codeContainer = document.getElementById(codeId);

  if (!codeContainer) return;

  
  if (copyBtn) {
    const copyIcon = copyBtn.querySelector('.copy-icon');
    const copyText = copyBtn.querySelector('.copy-text');

    copyBtn.addEventListener('click', async function() {
      try {
        
        let codeText = '';

        
        const codeTableCell = codeContainer.querySelector('.lntd:last-child code');
        if (codeTableCell) {
          codeText = codeTableCell.textContent || codeTableCell.innerText;
        } else {
          
          const codeElement = codeContainer.querySelector('code');
          if (codeElement) {
            
            const hasInlineLineNumbers = codeElement.querySelector('.ln');
            if (hasInlineLineNumbers) {
              
              const codeLines = codeElement.querySelectorAll('.cl');
              if (codeLines.length > 0) {
                codeText = Array.from(codeLines)
                  .map(line => {
                    const text = line.textContent || line.innerText;
                    
                    return text.replace(/\n+$/, '');
                  })
                  .join('\n')
                  .replace(/\n+$/, ''); 
              } else {
                
                const allText = codeElement.textContent || codeElement.innerText;
                codeText = allText.replace(/^\d+/gm, '').replace(/^\s+/gm, '');
              }
            } else {
              
              codeText = codeElement.textContent || codeElement.innerText;
            }
          } else {
            
            codeText = codeContainer.textContent || codeContainer.innerText;
          }
        }

        
        codeText = codeText.trim();

        
        await navigator.clipboard.writeText(codeText);

        
        copyIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M5 13l4 4L19 7\u0022 \/\u003e\n\u003c\/svg\u003e`;
        if (copyText) {
          copyText.textContent = 'ë³µì‚¬ë¨';
        }
        copyBtn.classList.add('text-green-600');

        
        setTimeout(() => {
          copyIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z\u0022 \/\u003e\n\u003c\/svg\u003e`;
          if (copyText) {
            copyText.textContent = 'ë³µì‚¬';
          }
          copyBtn.classList.remove('text-green-600');
        }, 2000);

      } catch (err) {
        console.error('å¤åˆ¶å¤±è´¥:', err);

        
        const range = document.createRange();
        const codeElement = codeContainer.querySelector('code') || codeContainer;
        range.selectNodeContents(codeElement);
        const selection = window.getSelection();
        selection.removeAllRanges();
        selection.addRange(range);

        
        if (copyText) {
          copyText.textContent = 'ì„ íƒë¨';
        }

        setTimeout(() => {
          if (copyText) {
            copyText.textContent = 'ë³µì‚¬';
          }
          selection.removeAllRanges();
        }, 2000);
      }
    });
  }

  
  if (collapseBtn) {
    const collapseIcon = collapseBtn.querySelector('.collapse-icon');
    const collapseText = collapseBtn.querySelector('.collapse-text');
    const collapseOverlay = codeContainer.querySelector('.collapse-overlay');

    
    let codeElement = codeContainer.querySelector('pre.chroma');
    if (!codeElement) {
      codeElement = codeContainer.querySelector('pre');
    }

    const defaultState = collapseBtn.dataset.defaultState || 'expanded';
    const isCollapsedAttr = collapseBtn.dataset.collapsed === 'true';
    const autoCollapseLines = parseInt(collapseBtn.dataset.autoCollapseLines) || 30;
    const autoCollapseHeight = parseInt(collapseBtn.dataset.autoCollapseHeight) || 400;
    const collapsedHeight = parseInt(collapseBtn.dataset.collapsedHeight) || 120;

    let isCollapsed = false;

    
    function initCollapse() {
      
      const shouldCollapse = isCollapsedAttr ||
                           defaultState === 'collapsed' ||
                           shouldAutoCollapse();

      if (shouldCollapse) {
        setCollapsed(true, false); 
      }
    }

    function shouldAutoCollapse() {
      
      if (codeElement) {
        const lines = codeElement.querySelectorAll('.line, .cl');
        const height = codeElement.offsetHeight;
        return lines.length > autoCollapseLines || height > autoCollapseHeight;
      }

      
      const containerHeight = codeContainer.offsetHeight;
      if (containerHeight > autoCollapseHeight) {
        return true;
      }

      
      const textContent = codeContainer.textContent || codeContainer.innerText || '';
      const estimatedLines = textContent.split('\n').length;
      return estimatedLines > autoCollapseLines;
    }

    function setCollapsed(collapsed, animate = true) {
      if (!collapseOverlay) return;

      isCollapsed = collapsed;

      if (collapsed) {
        
        codeContainer.style.maxHeight = collapsedHeight + 'px';
        codeContainer.style.overflow = 'hidden';
        collapseOverlay.style.opacity = '1';
        collapseOverlay.style.pointerEvents = 'auto';

        
        collapseIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M19 9l-7 7-7-7\u0022 \/\u003e\n\u003c\/svg\u003e`;
        if (collapseText) {
          collapseText.textContent = 'í¼ì¹˜ê¸°';
        }
        collapseBtn.title = 'í¼ì¹˜ê¸°';

      } else {
        
        codeContainer.style.maxHeight = '';
        codeContainer.style.overflow = '';
        collapseOverlay.style.opacity = '0';
        collapseOverlay.style.pointerEvents = 'none';

        
        collapseIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath fill=\u0022currentColor\u0022 d=\u0022M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z\u0022\/\u003e\u003c\/svg\u003e`;
        if (collapseText) {
          collapseText.textContent = 'ì ‘ê¸°';
        }
        collapseBtn.title = 'ì ‘ê¸°';
      }

      
      if (animate) {
        codeContainer.style.transition = 'max-height 0.3s ease-out';
        setTimeout(() => {
          codeContainer.style.transition = '';
        }, 300);
      }
    }

    function toggleCollapse() {
      setCollapsed(!isCollapsed, true);
    }

    
    collapseBtn.addEventListener('click', toggleCollapse);

    
    if (collapseOverlay) {
      collapseOverlay.addEventListener('click', () => {
        if (isCollapsed) {
          setCollapsed(false, true);
        }
      });
    }

    
    initCollapse();
  }
})();
</script>
    </div>
  </blockquote>

<hr>
<h3 id="-gated-cross-attention-in-lm">â‘¢ Gated cross-attention in LM</h3>
<ul>
<li>LM layerì—ì„œ self-attnê³¼ cross-attn (long-term memory)ì„ <strong>ê°€ì¤‘ ì¡°í•©</strong></li>
<li><code>A = Î±â‹…A_cross + (1âˆ’Î±)â‹…A_self</code></li>
<li>â‡’ ì¥ê¸° ê¸°ì–µì— ê³¼ë„í•˜ê²Œ ì˜ì¡´í•˜ì§€ ì•Šë„ë¡ ì¡°ì • ê°€ëŠ¥</li>
<li>í•™ìŠµ ì¤‘ ê° headë§ˆë‹¤ <strong>Î± í•™ìŠµ ê°€ëŠ¥</strong></li>
</ul>
<hr>
<h2 id="-ë‚´-ê²¬í•´-ë°-í‰ê°€">ğŸ¤– ë‚´ ê²¬í•´ ë° í‰ê°€</h2>
<ol>
<li>
<p><strong>ì´ë¡ ì  ì™„ì„±ë„</strong>
MELODIëŠ” ê¸°ì¡´ ë°©ì‹ë“¤ë³´ë‹¤ <strong>Transformer ì•„í‚¤í…ì²˜ì™€ ìì—°ìŠ¤ëŸ½ê²Œ í†µí•©</strong>ë˜ë©°, êµ¬ì¡°ì  ë³€ê²½ì´ ìµœì†Œí™”ë˜ë©´ì„œë„ ì¥ë‹¨ê¸° ì •ë³´ë¥¼ ëª¨ë‘ í¬ê´„í•œë‹¤ëŠ” ì ì—ì„œ <strong>ì´ë¡ ì  ì™„ì„±ë„ê°€ ë†’ë‹¤</strong>ê³  í‰ê°€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
</li>
<li>
<p><strong>ì••ì¶• ë°©ì‹ì˜ ì‹¤íš¨ì„±</strong>
Summary token ê¸°ë°˜ì˜ ì••ì¶• ë°©ì‹ì€ ì •ë³´ë¥¼ ì™„ì „íˆ ìœ ì§€í•˜ì§€ ëª»í•  ìˆ˜ ìˆìŒì—ë„, ê³„ì¸µì  ë°˜ë³µ êµ¬ì¡°ì™€ summary branchingì„ í†µí•´ ì´ë¥¼ ê·¹ë³µí•œ ê²ƒì´ <strong>íš¨ìœ¨ì„±ê³¼ ì„±ëŠ¥ ê°„ ê· í˜•ì„ ì˜ ë§ì¶˜ ì„¤ê³„</strong>ë¼ê³  ë´…ë‹ˆë‹¤.</p>
</li>
<li>
<p><strong>í˜„ì‹¤ì  ìœ ìš©ì„±</strong>
Memory sizeë¥¼ 8ë°° ì¤„ì´ë©´ì„œë„ MTë³´ë‹¤ ë” ì¢‹ì€ ì„±ëŠ¥ì„ ë³´ì¸ë‹¤ëŠ” ì ì€ <strong>ëª¨ë°”ì¼Â·ì—ì§€ ë””ë°”ì´ìŠ¤ë‚˜ ì €ìì› í™˜ê²½ì—ì„œ ë§¤ìš° í° ì¥ì </strong>ì…ë‹ˆë‹¤. íŠ¹íˆ context windowë¥¼ ì¤„ì´ë©´ì„œë„ ì„±ëŠ¥ ìœ ì§€ ê°€ëŠ¥ì„±ë„ ë†’ìŠµë‹ˆë‹¤.</p>
</li>
</ol>
<hr>
<h2 id="-ê²°ë¡ ">ğŸ“Œ ê²°ë¡ </h2>

  <blockquote
    class="border-primary bg-muted/30 hover:bg-muted/40 my-6 rounded-r-lg border-l-4 py-4 pr-4 pl-6 italic transition-all duration-200 ease-out hover:translate-x-1">
    <div class="prose prose-sm max-w-none">
      <p>MELODIì˜ ê°•ì ì€ ë‹¨ìˆœíˆ ë©”ëª¨ë¦¬ë¥¼ ì¤„ì´ëŠ” ê²ƒì´ ì•„ë‹ˆë¼, <strong>ì¥ë‹¨ê¸° ë¬¸ë§¥ ì •ë³´ë¥¼ ì••ì¶•í•˜ê³  ì „ë‹¬í•˜ëŠ” ë°©ì‹ ìì²´ë¥¼ ìµœì í™”</strong>í–ˆë‹¤ëŠ” ì ì…ë‹ˆë‹¤.
ì´ëŠ” ì´ì „ ë°©ë²•ë“¤ì´ <strong>ë©”ëª¨ë¦¬ë¥¼ ëŠ˜ë¦¬ë©´ ì„±ëŠ¥ì´ ì¢‹ì•„ì§„ë‹¤</strong>ëŠ” ë°©í–¥ì„±ì„ ê°€ì¡Œë˜ ê²ƒê³¼ëŠ” ë‹¤ë¥¸, <strong>ì••ì¶•Â·ìš”ì•½ ê¸°ë°˜ì˜ ìƒˆë¡œìš´ ë©”ëª¨ë¦¬ ì„¤ê³„ íŒ¨ëŸ¬ë‹¤ì„</strong>ì„ ì œì‹œí•œ ê²ƒì´ë¼ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
    </div>
  </blockquote>

<p>í•„ìš”í•˜ì‹œë‹¤ë©´ ì´ ì‹¤í—˜ ê²°ê³¼ë¥¼ ì‹œê°í™”í•œ í‘œë‚˜ ê·¸ë˜í”„ë„ ì œì‘í•´ ë“œë¦´ ìˆ˜ ìˆì–´ìš”. ì›í•˜ì‹œë‚˜ìš”?</p>
<h1 id="q--ì´-ë…¼ë¬¸ì—ì„œ-ì œì‹œëœ-ë°©ë²•ì„-ì‹¤ì œë¡œ-ì‚¬ìš©í•˜ë ¤ë©´-ê¸°ì¡´-ë°©ë²•ì—ì„œ-ì–´ë– í•œ-êµ¬í˜„ì´-ì¶”ê°€ì ìœ¼ë¡œ-í•„ìš”í•˜ê³ -ì´ëŸ¬í•œ-êµ¬í˜„ì—-ì†Œëª¨ë˜ëŠ”-ê³µìˆ˜-ë°-ì—°ì‚°ì—-í•„ìš”í•œ-ì»´í“¨íŒ…-ìì›ì˜-í¬ê¸°ì—-ëŒ€í•´ì„œ-ê³„ì‚°í•´ì¤„-ìˆ˜-ìˆê² ë‹ˆ">Q : ì´ ë…¼ë¬¸ì—ì„œ ì œì‹œëœ ë°©ë²•ì„ ì‹¤ì œë¡œ ì‚¬ìš©í•˜ë ¤ë©´ ê¸°ì¡´ ë°©ë²•ì—ì„œ ì–´ë– í•œ êµ¬í˜„ì´ ì¶”ê°€ì ìœ¼ë¡œ í•„ìš”í•˜ê³  ì´ëŸ¬í•œ êµ¬í˜„ì— ì†Œëª¨ë˜ëŠ” ê³µìˆ˜ ë° ì—°ì‚°ì— í•„ìš”í•œ ì»´í“¨íŒ… ìì›ì˜ í¬ê¸°ì— ëŒ€í•´ì„œ ê³„ì‚°í•´ì¤„ ìˆ˜ ìˆê² ë‹ˆ?</h1>
<p>ì¢‹ìŠµë‹ˆë‹¤. ì•„ë˜ì— ë…¼ë¬¸ MELODIì˜ êµ¬ì¡°ë¥¼ <strong>ê¸°ì¡´ Transformer (ì˜ˆ: GPT, LLAMA ë“±)</strong> ìœ„ì— ì˜¬ë¦°ë‹¤ê³  ê°€ì •í•  ë•Œ, ì‹¤ì œ êµ¬í˜„ì— í•„ìš”í•œ <strong>êµ¬ì¡°ì  ë³€ê²½</strong>, <strong>ì—°ì‚°ëŸ‰ ì¦ê°€</strong>, <strong>íŒŒë¼ë¯¸í„° ìˆ˜ ì¦ê°€</strong>, ê·¸ë¦¬ê³  <strong>ë©”ëª¨ë¦¬/ì—°ì‚° ê³µìˆ˜</strong>ë¥¼ <strong>ì •ëŸ‰ì ìœ¼ë¡œ ê³„ì‚°</strong>í•˜ì—¬ ë¶„ì„í•˜ê² ìŠµë‹ˆë‹¤.</p>
<hr>
<h2 id="-1-ê¸°ì¡´-transformer-ëŒ€ë¹„-melodiì˜-êµ¬í˜„-ë³€ê²½ì‚¬í•­">âœ… 1. ê¸°ì¡´ Transformer ëŒ€ë¹„ MELODIì˜ êµ¬í˜„ ë³€ê²½ì‚¬í•­</h2>
<table>
  <thead>
      <tr>
          <th>ë³€ê²½ í•­ëª©</th>
          <th>ì„¤ëª…</th>
          <th>êµ¬í˜„ ë‚œì´ë„</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>Short-Term Memory (STM)</strong></td>
          <td>- ê° layerë§ˆë‹¤ <code>summary token</code>, <code>token mixer</code> ì¶”ê°€<br>- <code>zâ‚–â‚‹â‚</code>ë¥¼ ë°›ì•„ì„œ attentionì— í¬í•¨</td>
          <td>ì¤‘</td>
      </tr>
      <tr>
          <td><strong>Summary Branching</strong></td>
          <td>- ê° layerì—ì„œ summary â†’ ë‹¤ìŒ windowë¡œ ì „ë‹¬ ê²½ë¡œ ì¶”ê°€</td>
          <td>ì¤‘</td>
      </tr>
      <tr>
          <td><strong>Long-Term Memory (LTM)</strong></td>
          <td>- íŠ¹ì • ì¤‘ê°„ layerì—ì„œ context window ì••ì¶• í›„ KV ì €ì¥<br>- ë‹¤ìŒ windowì—ì„œ cross-attention ìˆ˜í–‰</td>
          <td>ì¤‘~ìƒ</td>
      </tr>
      <tr>
          <td><strong>Cross-Attn Gating</strong></td>
          <td>- self-attn, cross-attn ê²°ê³¼ë¥¼ Î±ë¡œ ì¡°í•© (Î±: í•™ìŠµ ê°€ëŠ¥ scalar per head)</td>
          <td>ë‚®ìŒ</td>
      </tr>
      <tr>
          <td><strong>KV ë©”ëª¨ë¦¬ ì €ì¥ êµ¬ì¡°</strong></td>
          <td>- FIFO queue í˜•íƒœë¡œ ì••ì¶•ëœ KV ì €ì¥ ë° ì°¸ì¡°</td>
          <td>ì¤‘</td>
      </tr>
      <tr>
          <td><strong>Position Embedding ë³€ê²½</strong></td>
          <td>- zâ‚–, uâ‚–ì—ë„ ìœ„ì¹˜ ì„ë² ë”© ì ìš© í•„ìš”</td>
          <td>ë‚®ìŒ</td>
      </tr>
  </tbody>
</table>
<p>ğŸ“Œ <strong>ìš”ì•½</strong>: ê¸°ì¡´ Transformerì˜ êµ¬ì¡°ë¥¼ ìœ ì§€í•˜ë©´ì„œ <strong>ì•½ê°„ì˜ ëª¨ë“ˆ ì‚½ì… ë° routing êµ¬í˜„</strong>ì´ í•„ìš”í•œ ìˆ˜ì¤€. GPTë‚˜ LLAMA ê³„ì—´ì—ì„œë„ ì¶©ë¶„íˆ í™•ì¥ ê°€ëŠ¥í•¨.</p>
<hr>
<h2 id="-2-ì—°ì‚°ëŸ‰-ë°-íŒŒë¼ë¯¸í„°-ì¦ê°€ëŸ‰-ìˆ˜ì¹˜-ê¸°ë°˜">âœ… 2. ì—°ì‚°ëŸ‰ ë° íŒŒë¼ë¯¸í„° ì¦ê°€ëŸ‰ (ìˆ˜ì¹˜ ê¸°ë°˜)</h2>
<h3 id="ê¸°ì¤€">ê¸°ì¤€:</h3>
<ul>
<li>Transformer depth = 13</li>
<li>Embedding dim = 1024</li>
<li>Context window = 512 tokens</li>
<li>Short-term token ìˆ˜ <code>S = 128</code></li>
<li>Summary token ìˆ˜ <code>U = 128</code></li>
<li>Long-term token ìˆ˜ <code>L = 64</code></li>
<li>Long-term memory depth <code>Q = 128</code> windows</li>
</ul>
<hr>
<h3 id="-a-ì¶”ê°€ë˜ëŠ”-íŒŒë¼ë¯¸í„°-ìˆ˜-ì´ëŸ‰ì€-transformer-í•˜ë‚˜ë‹¹--100m-ìˆ˜ì¤€">ğŸ§  [A] ì¶”ê°€ë˜ëŠ” íŒŒë¼ë¯¸í„° ìˆ˜ (ì´ëŸ‰ì€ transformer í•˜ë‚˜ë‹¹ â‰ˆ 100M ìˆ˜ì¤€)</h3>
<h4 id="1-linear-token-mixer-2ê°œ-per-stm-layer">1. <strong>Linear token mixer (2ê°œ per STM layer)</strong></h4>
<p>ê° layerë§ˆë‹¤:</p>
<div
  class="code-block-container border-border bg-card my-6 overflow-hidden rounded-xl border shadow-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:shadow-md">
  
  <div
    class="code-block-header bg-muted/30 border-border flex items-center justify-between border-b px-4 py-3">
    
    <div class="flex items-center gap-2">
      <div class="text-muted-foreground flex-shrink-0">
        
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4" />
</svg>
      </div>
      <span class="text-muted-foreground text-sm font-medium">
        PLAINTEXT
      </span>
    </div>

    
    <div class="flex items-center gap-2">
      <button
          class="collapse-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none"
          data-code-id="code-7"
          data-default-state="expanded"
          data-collapsed="false"
          data-auto-collapse-lines="30"
          data-auto-collapse-height="400"
          data-collapsed-height="120"
          title="ì ‘ê¸°"
          aria-label="ì ‘ê¸°">
          <span class="collapse-icon">
            
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z"/></svg>
          </span>
          <span class="collapse-text hidden sm:inline"
            >ì ‘ê¸°</span
          >
        </button>
      <button
        class="copy-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none"
        data-code-id="code-7"
        title="ë³µì‚¬"
        aria-label="ë³µì‚¬">
        <span class="copy-icon">
          
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
</svg>
        </span>
        <span class="copy-text hidden sm:inline"
          >ë³µì‚¬</span
        >
      </button>
    </div>
  </div>

  
  <div class="code-block-content relative" id="code-7">
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="ln">1</span><span class="cl">Input: (W + U) x d = (512 + 128) x 1024  
</span></span><span class="line"><span class="ln">2</span><span class="cl">Output: S = 128 tokens â†’ Weight: (640 Ã— 128) x 2 mixers
</span></span><span class="line"><span class="ln">3</span><span class="cl">ì´ = 164,864 params/layer</span></span></code></pre></div>
    
    <div
      class="collapse-overlay to-card/90 pointer-events-none absolute inset-0 bg-gradient-to-b from-transparent via-transparent opacity-0 transition-opacity duration-300">
      <div
        class="text-muted-foreground bg-card/80 border-border/50 hover:bg-primary/10 hover:text-primary hover:border-primary/30 absolute bottom-4 left-1/2 -translate-x-1/2 cursor-pointer rounded-full border px-3 py-1.5 text-xs backdrop-blur-sm transition-all duration-200">
        í´ë¦­í•˜ì—¬ ë” ë³´ê¸°
      </div>
    </div>
  </div>
</div>


<script>
(function() {
  const codeId = 'code-7';
  const copyBtn = document.querySelector('.copy-code-btn[data-code-id="' + codeId + '"]');
  const collapseBtn = document.querySelector('.collapse-code-btn[data-code-id="' + codeId + '"]');
  const codeContainer = document.getElementById(codeId);

  if (!codeContainer) return;

  
  if (copyBtn) {
    const copyIcon = copyBtn.querySelector('.copy-icon');
    const copyText = copyBtn.querySelector('.copy-text');

    copyBtn.addEventListener('click', async function() {
      try {
        
        let codeText = '';

        
        const codeTableCell = codeContainer.querySelector('.lntd:last-child code');
        if (codeTableCell) {
          codeText = codeTableCell.textContent || codeTableCell.innerText;
        } else {
          
          const codeElement = codeContainer.querySelector('code');
          if (codeElement) {
            
            const hasInlineLineNumbers = codeElement.querySelector('.ln');
            if (hasInlineLineNumbers) {
              
              const codeLines = codeElement.querySelectorAll('.cl');
              if (codeLines.length > 0) {
                codeText = Array.from(codeLines)
                  .map(line => {
                    const text = line.textContent || line.innerText;
                    
                    return text.replace(/\n+$/, '');
                  })
                  .join('\n')
                  .replace(/\n+$/, ''); 
              } else {
                
                const allText = codeElement.textContent || codeElement.innerText;
                codeText = allText.replace(/^\d+/gm, '').replace(/^\s+/gm, '');
              }
            } else {
              
              codeText = codeElement.textContent || codeElement.innerText;
            }
          } else {
            
            codeText = codeContainer.textContent || codeContainer.innerText;
          }
        }

        
        codeText = codeText.trim();

        
        await navigator.clipboard.writeText(codeText);

        
        copyIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M5 13l4 4L19 7\u0022 \/\u003e\n\u003c\/svg\u003e`;
        if (copyText) {
          copyText.textContent = 'ë³µì‚¬ë¨';
        }
        copyBtn.classList.add('text-green-600');

        
        setTimeout(() => {
          copyIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z\u0022 \/\u003e\n\u003c\/svg\u003e`;
          if (copyText) {
            copyText.textContent = 'ë³µì‚¬';
          }
          copyBtn.classList.remove('text-green-600');
        }, 2000);

      } catch (err) {
        console.error('å¤åˆ¶å¤±è´¥:', err);

        
        const range = document.createRange();
        const codeElement = codeContainer.querySelector('code') || codeContainer;
        range.selectNodeContents(codeElement);
        const selection = window.getSelection();
        selection.removeAllRanges();
        selection.addRange(range);

        
        if (copyText) {
          copyText.textContent = 'ì„ íƒë¨';
        }

        setTimeout(() => {
          if (copyText) {
            copyText.textContent = 'ë³µì‚¬';
          }
          selection.removeAllRanges();
        }, 2000);
      }
    });
  }

  
  if (collapseBtn) {
    const collapseIcon = collapseBtn.querySelector('.collapse-icon');
    const collapseText = collapseBtn.querySelector('.collapse-text');
    const collapseOverlay = codeContainer.querySelector('.collapse-overlay');

    
    let codeElement = codeContainer.querySelector('pre.chroma');
    if (!codeElement) {
      codeElement = codeContainer.querySelector('pre');
    }

    const defaultState = collapseBtn.dataset.defaultState || 'expanded';
    const isCollapsedAttr = collapseBtn.dataset.collapsed === 'true';
    const autoCollapseLines = parseInt(collapseBtn.dataset.autoCollapseLines) || 30;
    const autoCollapseHeight = parseInt(collapseBtn.dataset.autoCollapseHeight) || 400;
    const collapsedHeight = parseInt(collapseBtn.dataset.collapsedHeight) || 120;

    let isCollapsed = false;

    
    function initCollapse() {
      
      const shouldCollapse = isCollapsedAttr ||
                           defaultState === 'collapsed' ||
                           shouldAutoCollapse();

      if (shouldCollapse) {
        setCollapsed(true, false); 
      }
    }

    function shouldAutoCollapse() {
      
      if (codeElement) {
        const lines = codeElement.querySelectorAll('.line, .cl');
        const height = codeElement.offsetHeight;
        return lines.length > autoCollapseLines || height > autoCollapseHeight;
      }

      
      const containerHeight = codeContainer.offsetHeight;
      if (containerHeight > autoCollapseHeight) {
        return true;
      }

      
      const textContent = codeContainer.textContent || codeContainer.innerText || '';
      const estimatedLines = textContent.split('\n').length;
      return estimatedLines > autoCollapseLines;
    }

    function setCollapsed(collapsed, animate = true) {
      if (!collapseOverlay) return;

      isCollapsed = collapsed;

      if (collapsed) {
        
        codeContainer.style.maxHeight = collapsedHeight + 'px';
        codeContainer.style.overflow = 'hidden';
        collapseOverlay.style.opacity = '1';
        collapseOverlay.style.pointerEvents = 'auto';

        
        collapseIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M19 9l-7 7-7-7\u0022 \/\u003e\n\u003c\/svg\u003e`;
        if (collapseText) {
          collapseText.textContent = 'í¼ì¹˜ê¸°';
        }
        collapseBtn.title = 'í¼ì¹˜ê¸°';

      } else {
        
        codeContainer.style.maxHeight = '';
        codeContainer.style.overflow = '';
        collapseOverlay.style.opacity = '0';
        collapseOverlay.style.pointerEvents = 'none';

        
        collapseIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath fill=\u0022currentColor\u0022 d=\u0022M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z\u0022\/\u003e\u003c\/svg\u003e`;
        if (collapseText) {
          collapseText.textContent = 'ì ‘ê¸°';
        }
        collapseBtn.title = 'ì ‘ê¸°';
      }

      
      if (animate) {
        codeContainer.style.transition = 'max-height 0.3s ease-out';
        setTimeout(() => {
          codeContainer.style.transition = '';
        }, 300);
      }
    }

    function toggleCollapse() {
      setCollapsed(!isCollapsed, true);
    }

    
    collapseBtn.addEventListener('click', toggleCollapse);

    
    if (collapseOverlay) {
      collapseOverlay.addEventListener('click', () => {
        if (isCollapsed) {
          setCollapsed(false, true);
        }
      });
    }

    
    initCollapse();
  }
})();
</script>
<p>â†’ 6 STM layer ìˆë‹¤ê³  í•˜ë©´:</p>
<div
  class="code-block-container border-border bg-card my-6 overflow-hidden rounded-xl border shadow-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:shadow-md">
  
  <div
    class="code-block-header bg-muted/30 border-border flex items-center justify-between border-b px-4 py-3">
    
    <div class="flex items-center gap-2">
      <div class="text-muted-foreground flex-shrink-0">
        
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4" />
</svg>
      </div>
      <span class="text-muted-foreground text-sm font-medium">
        PLAINTEXT
      </span>
    </div>

    
    <div class="flex items-center gap-2">
      <button
          class="collapse-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none"
          data-code-id="code-8"
          data-default-state="expanded"
          data-collapsed="false"
          data-auto-collapse-lines="30"
          data-auto-collapse-height="400"
          data-collapsed-height="120"
          title="ì ‘ê¸°"
          aria-label="ì ‘ê¸°">
          <span class="collapse-icon">
            
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z"/></svg>
          </span>
          <span class="collapse-text hidden sm:inline"
            >ì ‘ê¸°</span
          >
        </button>
      <button
        class="copy-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none"
        data-code-id="code-8"
        title="ë³µì‚¬"
        aria-label="ë³µì‚¬">
        <span class="copy-icon">
          
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
</svg>
        </span>
        <span class="copy-text hidden sm:inline"
          >ë³µì‚¬</span
        >
      </button>
    </div>
  </div>

  
  <div class="code-block-content relative" id="code-8">
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="ln">1</span><span class="cl">ì´ = 165K Ã— 6 = **~1M params**</span></span></code></pre></div>
    
    <div
      class="collapse-overlay to-card/90 pointer-events-none absolute inset-0 bg-gradient-to-b from-transparent via-transparent opacity-0 transition-opacity duration-300">
      <div
        class="text-muted-foreground bg-card/80 border-border/50 hover:bg-primary/10 hover:text-primary hover:border-primary/30 absolute bottom-4 left-1/2 -translate-x-1/2 cursor-pointer rounded-full border px-3 py-1.5 text-xs backdrop-blur-sm transition-all duration-200">
        í´ë¦­í•˜ì—¬ ë” ë³´ê¸°
      </div>
    </div>
  </div>
</div>


<script>
(function() {
  const codeId = 'code-8';
  const copyBtn = document.querySelector('.copy-code-btn[data-code-id="' + codeId + '"]');
  const collapseBtn = document.querySelector('.collapse-code-btn[data-code-id="' + codeId + '"]');
  const codeContainer = document.getElementById(codeId);

  if (!codeContainer) return;

  
  if (copyBtn) {
    const copyIcon = copyBtn.querySelector('.copy-icon');
    const copyText = copyBtn.querySelector('.copy-text');

    copyBtn.addEventListener('click', async function() {
      try {
        
        let codeText = '';

        
        const codeTableCell = codeContainer.querySelector('.lntd:last-child code');
        if (codeTableCell) {
          codeText = codeTableCell.textContent || codeTableCell.innerText;
        } else {
          
          const codeElement = codeContainer.querySelector('code');
          if (codeElement) {
            
            const hasInlineLineNumbers = codeElement.querySelector('.ln');
            if (hasInlineLineNumbers) {
              
              const codeLines = codeElement.querySelectorAll('.cl');
              if (codeLines.length > 0) {
                codeText = Array.from(codeLines)
                  .map(line => {
                    const text = line.textContent || line.innerText;
                    
                    return text.replace(/\n+$/, '');
                  })
                  .join('\n')
                  .replace(/\n+$/, ''); 
              } else {
                
                const allText = codeElement.textContent || codeElement.innerText;
                codeText = allText.replace(/^\d+/gm, '').replace(/^\s+/gm, '');
              }
            } else {
              
              codeText = codeElement.textContent || codeElement.innerText;
            }
          } else {
            
            codeText = codeContainer.textContent || codeContainer.innerText;
          }
        }

        
        codeText = codeText.trim();

        
        await navigator.clipboard.writeText(codeText);

        
        copyIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M5 13l4 4L19 7\u0022 \/\u003e\n\u003c\/svg\u003e`;
        if (copyText) {
          copyText.textContent = 'ë³µì‚¬ë¨';
        }
        copyBtn.classList.add('text-green-600');

        
        setTimeout(() => {
          copyIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z\u0022 \/\u003e\n\u003c\/svg\u003e`;
          if (copyText) {
            copyText.textContent = 'ë³µì‚¬';
          }
          copyBtn.classList.remove('text-green-600');
        }, 2000);

      } catch (err) {
        console.error('å¤åˆ¶å¤±è´¥:', err);

        
        const range = document.createRange();
        const codeElement = codeContainer.querySelector('code') || codeContainer;
        range.selectNodeContents(codeElement);
        const selection = window.getSelection();
        selection.removeAllRanges();
        selection.addRange(range);

        
        if (copyText) {
          copyText.textContent = 'ì„ íƒë¨';
        }

        setTimeout(() => {
          if (copyText) {
            copyText.textContent = 'ë³µì‚¬';
          }
          selection.removeAllRanges();
        }, 2000);
      }
    });
  }

  
  if (collapseBtn) {
    const collapseIcon = collapseBtn.querySelector('.collapse-icon');
    const collapseText = collapseBtn.querySelector('.collapse-text');
    const collapseOverlay = codeContainer.querySelector('.collapse-overlay');

    
    let codeElement = codeContainer.querySelector('pre.chroma');
    if (!codeElement) {
      codeElement = codeContainer.querySelector('pre');
    }

    const defaultState = collapseBtn.dataset.defaultState || 'expanded';
    const isCollapsedAttr = collapseBtn.dataset.collapsed === 'true';
    const autoCollapseLines = parseInt(collapseBtn.dataset.autoCollapseLines) || 30;
    const autoCollapseHeight = parseInt(collapseBtn.dataset.autoCollapseHeight) || 400;
    const collapsedHeight = parseInt(collapseBtn.dataset.collapsedHeight) || 120;

    let isCollapsed = false;

    
    function initCollapse() {
      
      const shouldCollapse = isCollapsedAttr ||
                           defaultState === 'collapsed' ||
                           shouldAutoCollapse();

      if (shouldCollapse) {
        setCollapsed(true, false); 
      }
    }

    function shouldAutoCollapse() {
      
      if (codeElement) {
        const lines = codeElement.querySelectorAll('.line, .cl');
        const height = codeElement.offsetHeight;
        return lines.length > autoCollapseLines || height > autoCollapseHeight;
      }

      
      const containerHeight = codeContainer.offsetHeight;
      if (containerHeight > autoCollapseHeight) {
        return true;
      }

      
      const textContent = codeContainer.textContent || codeContainer.innerText || '';
      const estimatedLines = textContent.split('\n').length;
      return estimatedLines > autoCollapseLines;
    }

    function setCollapsed(collapsed, animate = true) {
      if (!collapseOverlay) return;

      isCollapsed = collapsed;

      if (collapsed) {
        
        codeContainer.style.maxHeight = collapsedHeight + 'px';
        codeContainer.style.overflow = 'hidden';
        collapseOverlay.style.opacity = '1';
        collapseOverlay.style.pointerEvents = 'auto';

        
        collapseIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M19 9l-7 7-7-7\u0022 \/\u003e\n\u003c\/svg\u003e`;
        if (collapseText) {
          collapseText.textContent = 'í¼ì¹˜ê¸°';
        }
        collapseBtn.title = 'í¼ì¹˜ê¸°';

      } else {
        
        codeContainer.style.maxHeight = '';
        codeContainer.style.overflow = '';
        collapseOverlay.style.opacity = '0';
        collapseOverlay.style.pointerEvents = 'none';

        
        collapseIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath fill=\u0022currentColor\u0022 d=\u0022M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z\u0022\/\u003e\u003c\/svg\u003e`;
        if (collapseText) {
          collapseText.textContent = 'ì ‘ê¸°';
        }
        collapseBtn.title = 'ì ‘ê¸°';
      }

      
      if (animate) {
        codeContainer.style.transition = 'max-height 0.3s ease-out';
        setTimeout(() => {
          codeContainer.style.transition = '';
        }, 300);
      }
    }

    function toggleCollapse() {
      setCollapsed(!isCollapsed, true);
    }

    
    collapseBtn.addEventListener('click', toggleCollapse);

    
    if (collapseOverlay) {
      collapseOverlay.addEventListener('click', () => {
        if (isCollapsed) {
          setCollapsed(false, true);
        }
      });
    }

    
    initCollapse();
  }
})();
</script>
<h4 id="2-gating-scalar-Î±-per-head">2. <strong>Gating scalar (Î± per head)</strong></h4>
<p>ì˜ˆ: 8 heads â†’ Î± 8ê°œ (í•™ìŠµ ê°€ëŠ¥ scalar)
â†’ ë¬´ì‹œ ê°€ëŠ¥í•œ ìˆ˜ì¤€ (8 Ã— N layer â‰ˆ ìˆ˜ë°±)</p>
<p>ğŸ“Œ <strong>ê²°ë¡ </strong>: ì „ì²´ì ìœ¼ë¡œ <strong>ì•½ 1% ë¯¸ë§Œì˜ íŒŒë¼ë¯¸í„° ì¦ê°€</strong>ë¡œ ì œí•œë¨</p>
<hr>
<h3 id="-b-ì—°ì‚°ëŸ‰-flops-ì¦ê°€">âš™ï¸ [B] ì—°ì‚°ëŸ‰ (FLOPs) ì¦ê°€</h3>
<h4 id="1-ì¶”ê°€-attention-ì…ë ¥-ìˆ˜-ì¦ê°€-stm">1. <strong>ì¶”ê°€ attention ì…ë ¥ ìˆ˜ ì¦ê°€</strong> (STM)</h4>
<p>ê¸°ì¡´:</p>
<div
  class="code-block-container border-border bg-card my-6 overflow-hidden rounded-xl border shadow-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:shadow-md">
  
  <div
    class="code-block-header bg-muted/30 border-border flex items-center justify-between border-b px-4 py-3">
    
    <div class="flex items-center gap-2">
      <div class="text-muted-foreground flex-shrink-0">
        
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4" />
</svg>
      </div>
      <span class="text-muted-foreground text-sm font-medium">
        PLAINTEXT
      </span>
    </div>

    
    <div class="flex items-center gap-2">
      <button
          class="collapse-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none"
          data-code-id="code-9"
          data-default-state="expanded"
          data-collapsed="false"
          data-auto-collapse-lines="30"
          data-auto-collapse-height="400"
          data-collapsed-height="120"
          title="ì ‘ê¸°"
          aria-label="ì ‘ê¸°">
          <span class="collapse-icon">
            
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z"/></svg>
          </span>
          <span class="collapse-text hidden sm:inline"
            >ì ‘ê¸°</span
          >
        </button>
      <button
        class="copy-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none"
        data-code-id="code-9"
        title="ë³µì‚¬"
        aria-label="ë³µì‚¬">
        <span class="copy-icon">
          
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
</svg>
        </span>
        <span class="copy-text hidden sm:inline"
          >ë³µì‚¬</span
        >
      </button>
    </div>
  </div>

  
  <div class="code-block-content relative" id="code-9">
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">Attention over 512 tokens (self-attn)
</span></span><span class="line"><span class="ln">2</span><span class="cl">â†’ QK: (512Ã—1024) Ã— (512Ã—1024) = O(512Â²Ã—d)</span></span></code></pre></div>
    
    <div
      class="collapse-overlay to-card/90 pointer-events-none absolute inset-0 bg-gradient-to-b from-transparent via-transparent opacity-0 transition-opacity duration-300">
      <div
        class="text-muted-foreground bg-card/80 border-border/50 hover:bg-primary/10 hover:text-primary hover:border-primary/30 absolute bottom-4 left-1/2 -translate-x-1/2 cursor-pointer rounded-full border px-3 py-1.5 text-xs backdrop-blur-sm transition-all duration-200">
        í´ë¦­í•˜ì—¬ ë” ë³´ê¸°
      </div>
    </div>
  </div>
</div>


<script>
(function() {
  const codeId = 'code-9';
  const copyBtn = document.querySelector('.copy-code-btn[data-code-id="' + codeId + '"]');
  const collapseBtn = document.querySelector('.collapse-code-btn[data-code-id="' + codeId + '"]');
  const codeContainer = document.getElementById(codeId);

  if (!codeContainer) return;

  
  if (copyBtn) {
    const copyIcon = copyBtn.querySelector('.copy-icon');
    const copyText = copyBtn.querySelector('.copy-text');

    copyBtn.addEventListener('click', async function() {
      try {
        
        let codeText = '';

        
        const codeTableCell = codeContainer.querySelector('.lntd:last-child code');
        if (codeTableCell) {
          codeText = codeTableCell.textContent || codeTableCell.innerText;
        } else {
          
          const codeElement = codeContainer.querySelector('code');
          if (codeElement) {
            
            const hasInlineLineNumbers = codeElement.querySelector('.ln');
            if (hasInlineLineNumbers) {
              
              const codeLines = codeElement.querySelectorAll('.cl');
              if (codeLines.length > 0) {
                codeText = Array.from(codeLines)
                  .map(line => {
                    const text = line.textContent || line.innerText;
                    
                    return text.replace(/\n+$/, '');
                  })
                  .join('\n')
                  .replace(/\n+$/, ''); 
              } else {
                
                const allText = codeElement.textContent || codeElement.innerText;
                codeText = allText.replace(/^\d+/gm, '').replace(/^\s+/gm, '');
              }
            } else {
              
              codeText = codeElement.textContent || codeElement.innerText;
            }
          } else {
            
            codeText = codeContainer.textContent || codeContainer.innerText;
          }
        }

        
        codeText = codeText.trim();

        
        await navigator.clipboard.writeText(codeText);

        
        copyIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M5 13l4 4L19 7\u0022 \/\u003e\n\u003c\/svg\u003e`;
        if (copyText) {
          copyText.textContent = 'ë³µì‚¬ë¨';
        }
        copyBtn.classList.add('text-green-600');

        
        setTimeout(() => {
          copyIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z\u0022 \/\u003e\n\u003c\/svg\u003e`;
          if (copyText) {
            copyText.textContent = 'ë³µì‚¬';
          }
          copyBtn.classList.remove('text-green-600');
        }, 2000);

      } catch (err) {
        console.error('å¤åˆ¶å¤±è´¥:', err);

        
        const range = document.createRange();
        const codeElement = codeContainer.querySelector('code') || codeContainer;
        range.selectNodeContents(codeElement);
        const selection = window.getSelection();
        selection.removeAllRanges();
        selection.addRange(range);

        
        if (copyText) {
          copyText.textContent = 'ì„ íƒë¨';
        }

        setTimeout(() => {
          if (copyText) {
            copyText.textContent = 'ë³µì‚¬';
          }
          selection.removeAllRanges();
        }, 2000);
      }
    });
  }

  
  if (collapseBtn) {
    const collapseIcon = collapseBtn.querySelector('.collapse-icon');
    const collapseText = collapseBtn.querySelector('.collapse-text');
    const collapseOverlay = codeContainer.querySelector('.collapse-overlay');

    
    let codeElement = codeContainer.querySelector('pre.chroma');
    if (!codeElement) {
      codeElement = codeContainer.querySelector('pre');
    }

    const defaultState = collapseBtn.dataset.defaultState || 'expanded';
    const isCollapsedAttr = collapseBtn.dataset.collapsed === 'true';
    const autoCollapseLines = parseInt(collapseBtn.dataset.autoCollapseLines) || 30;
    const autoCollapseHeight = parseInt(collapseBtn.dataset.autoCollapseHeight) || 400;
    const collapsedHeight = parseInt(collapseBtn.dataset.collapsedHeight) || 120;

    let isCollapsed = false;

    
    function initCollapse() {
      
      const shouldCollapse = isCollapsedAttr ||
                           defaultState === 'collapsed' ||
                           shouldAutoCollapse();

      if (shouldCollapse) {
        setCollapsed(true, false); 
      }
    }

    function shouldAutoCollapse() {
      
      if (codeElement) {
        const lines = codeElement.querySelectorAll('.line, .cl');
        const height = codeElement.offsetHeight;
        return lines.length > autoCollapseLines || height > autoCollapseHeight;
      }

      
      const containerHeight = codeContainer.offsetHeight;
      if (containerHeight > autoCollapseHeight) {
        return true;
      }

      
      const textContent = codeContainer.textContent || codeContainer.innerText || '';
      const estimatedLines = textContent.split('\n').length;
      return estimatedLines > autoCollapseLines;
    }

    function setCollapsed(collapsed, animate = true) {
      if (!collapseOverlay) return;

      isCollapsed = collapsed;

      if (collapsed) {
        
        codeContainer.style.maxHeight = collapsedHeight + 'px';
        codeContainer.style.overflow = 'hidden';
        collapseOverlay.style.opacity = '1';
        collapseOverlay.style.pointerEvents = 'auto';

        
        collapseIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M19 9l-7 7-7-7\u0022 \/\u003e\n\u003c\/svg\u003e`;
        if (collapseText) {
          collapseText.textContent = 'í¼ì¹˜ê¸°';
        }
        collapseBtn.title = 'í¼ì¹˜ê¸°';

      } else {
        
        codeContainer.style.maxHeight = '';
        codeContainer.style.overflow = '';
        collapseOverlay.style.opacity = '0';
        collapseOverlay.style.pointerEvents = 'none';

        
        collapseIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath fill=\u0022currentColor\u0022 d=\u0022M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z\u0022\/\u003e\u003c\/svg\u003e`;
        if (collapseText) {
          collapseText.textContent = 'ì ‘ê¸°';
        }
        collapseBtn.title = 'ì ‘ê¸°';
      }

      
      if (animate) {
        codeContainer.style.transition = 'max-height 0.3s ease-out';
        setTimeout(() => {
          codeContainer.style.transition = '';
        }, 300);
      }
    }

    function toggleCollapse() {
      setCollapsed(!isCollapsed, true);
    }

    
    collapseBtn.addEventListener('click', toggleCollapse);

    
    if (collapseOverlay) {
      collapseOverlay.addEventListener('click', () => {
        if (isCollapsed) {
          setCollapsed(false, true);
        }
      });
    }

    
    initCollapse();
  }
})();
</script>
<p>MELODI (STM):</p>
<div
  class="code-block-container border-border bg-card my-6 overflow-hidden rounded-xl border shadow-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:shadow-md">
  
  <div
    class="code-block-header bg-muted/30 border-border flex items-center justify-between border-b px-4 py-3">
    
    <div class="flex items-center gap-2">
      <div class="text-muted-foreground flex-shrink-0">
        
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4" />
</svg>
      </div>
      <span class="text-muted-foreground text-sm font-medium">
        PLAINTEXT
      </span>
    </div>

    
    <div class="flex items-center gap-2">
      <button
          class="collapse-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none"
          data-code-id="code-10"
          data-default-state="expanded"
          data-collapsed="false"
          data-auto-collapse-lines="30"
          data-auto-collapse-height="400"
          data-collapsed-height="120"
          title="ì ‘ê¸°"
          aria-label="ì ‘ê¸°">
          <span class="collapse-icon">
            
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z"/></svg>
          </span>
          <span class="collapse-text hidden sm:inline"
            >ì ‘ê¸°</span
          >
        </button>
      <button
        class="copy-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none"
        data-code-id="code-10"
        title="ë³µì‚¬"
        aria-label="ë³µì‚¬">
        <span class="copy-icon">
          
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
</svg>
        </span>
        <span class="copy-text hidden sm:inline"
          >ë³µì‚¬</span
        >
      </button>
    </div>
  </div>

  
  <div class="code-block-content relative" id="code-10">
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">Attention over [512 + 128] tokens = 640
</span></span><span class="line"><span class="ln">2</span><span class="cl">â†’ O(640Â² Ã— d) = ì•½ 56% ì¦ê°€</span></span></code></pre></div>
    
    <div
      class="collapse-overlay to-card/90 pointer-events-none absolute inset-0 bg-gradient-to-b from-transparent via-transparent opacity-0 transition-opacity duration-300">
      <div
        class="text-muted-foreground bg-card/80 border-border/50 hover:bg-primary/10 hover:text-primary hover:border-primary/30 absolute bottom-4 left-1/2 -translate-x-1/2 cursor-pointer rounded-full border px-3 py-1.5 text-xs backdrop-blur-sm transition-all duration-200">
        í´ë¦­í•˜ì—¬ ë” ë³´ê¸°
      </div>
    </div>
  </div>
</div>


<script>
(function() {
  const codeId = 'code-10';
  const copyBtn = document.querySelector('.copy-code-btn[data-code-id="' + codeId + '"]');
  const collapseBtn = document.querySelector('.collapse-code-btn[data-code-id="' + codeId + '"]');
  const codeContainer = document.getElementById(codeId);

  if (!codeContainer) return;

  
  if (copyBtn) {
    const copyIcon = copyBtn.querySelector('.copy-icon');
    const copyText = copyBtn.querySelector('.copy-text');

    copyBtn.addEventListener('click', async function() {
      try {
        
        let codeText = '';

        
        const codeTableCell = codeContainer.querySelector('.lntd:last-child code');
        if (codeTableCell) {
          codeText = codeTableCell.textContent || codeTableCell.innerText;
        } else {
          
          const codeElement = codeContainer.querySelector('code');
          if (codeElement) {
            
            const hasInlineLineNumbers = codeElement.querySelector('.ln');
            if (hasInlineLineNumbers) {
              
              const codeLines = codeElement.querySelectorAll('.cl');
              if (codeLines.length > 0) {
                codeText = Array.from(codeLines)
                  .map(line => {
                    const text = line.textContent || line.innerText;
                    
                    return text.replace(/\n+$/, '');
                  })
                  .join('\n')
                  .replace(/\n+$/, ''); 
              } else {
                
                const allText = codeElement.textContent || codeElement.innerText;
                codeText = allText.replace(/^\d+/gm, '').replace(/^\s+/gm, '');
              }
            } else {
              
              codeText = codeElement.textContent || codeElement.innerText;
            }
          } else {
            
            codeText = codeContainer.textContent || codeContainer.innerText;
          }
        }

        
        codeText = codeText.trim();

        
        await navigator.clipboard.writeText(codeText);

        
        copyIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M5 13l4 4L19 7\u0022 \/\u003e\n\u003c\/svg\u003e`;
        if (copyText) {
          copyText.textContent = 'ë³µì‚¬ë¨';
        }
        copyBtn.classList.add('text-green-600');

        
        setTimeout(() => {
          copyIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z\u0022 \/\u003e\n\u003c\/svg\u003e`;
          if (copyText) {
            copyText.textContent = 'ë³µì‚¬';
          }
          copyBtn.classList.remove('text-green-600');
        }, 2000);

      } catch (err) {
        console.error('å¤åˆ¶å¤±è´¥:', err);

        
        const range = document.createRange();
        const codeElement = codeContainer.querySelector('code') || codeContainer;
        range.selectNodeContents(codeElement);
        const selection = window.getSelection();
        selection.removeAllRanges();
        selection.addRange(range);

        
        if (copyText) {
          copyText.textContent = 'ì„ íƒë¨';
        }

        setTimeout(() => {
          if (copyText) {
            copyText.textContent = 'ë³µì‚¬';
          }
          selection.removeAllRanges();
        }, 2000);
      }
    });
  }

  
  if (collapseBtn) {
    const collapseIcon = collapseBtn.querySelector('.collapse-icon');
    const collapseText = collapseBtn.querySelector('.collapse-text');
    const collapseOverlay = codeContainer.querySelector('.collapse-overlay');

    
    let codeElement = codeContainer.querySelector('pre.chroma');
    if (!codeElement) {
      codeElement = codeContainer.querySelector('pre');
    }

    const defaultState = collapseBtn.dataset.defaultState || 'expanded';
    const isCollapsedAttr = collapseBtn.dataset.collapsed === 'true';
    const autoCollapseLines = parseInt(collapseBtn.dataset.autoCollapseLines) || 30;
    const autoCollapseHeight = parseInt(collapseBtn.dataset.autoCollapseHeight) || 400;
    const collapsedHeight = parseInt(collapseBtn.dataset.collapsedHeight) || 120;

    let isCollapsed = false;

    
    function initCollapse() {
      
      const shouldCollapse = isCollapsedAttr ||
                           defaultState === 'collapsed' ||
                           shouldAutoCollapse();

      if (shouldCollapse) {
        setCollapsed(true, false); 
      }
    }

    function shouldAutoCollapse() {
      
      if (codeElement) {
        const lines = codeElement.querySelectorAll('.line, .cl');
        const height = codeElement.offsetHeight;
        return lines.length > autoCollapseLines || height > autoCollapseHeight;
      }

      
      const containerHeight = codeContainer.offsetHeight;
      if (containerHeight > autoCollapseHeight) {
        return true;
      }

      
      const textContent = codeContainer.textContent || codeContainer.innerText || '';
      const estimatedLines = textContent.split('\n').length;
      return estimatedLines > autoCollapseLines;
    }

    function setCollapsed(collapsed, animate = true) {
      if (!collapseOverlay) return;

      isCollapsed = collapsed;

      if (collapsed) {
        
        codeContainer.style.maxHeight = collapsedHeight + 'px';
        codeContainer.style.overflow = 'hidden';
        collapseOverlay.style.opacity = '1';
        collapseOverlay.style.pointerEvents = 'auto';

        
        collapseIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M19 9l-7 7-7-7\u0022 \/\u003e\n\u003c\/svg\u003e`;
        if (collapseText) {
          collapseText.textContent = 'í¼ì¹˜ê¸°';
        }
        collapseBtn.title = 'í¼ì¹˜ê¸°';

      } else {
        
        codeContainer.style.maxHeight = '';
        codeContainer.style.overflow = '';
        collapseOverlay.style.opacity = '0';
        collapseOverlay.style.pointerEvents = 'none';

        
        collapseIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath fill=\u0022currentColor\u0022 d=\u0022M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z\u0022\/\u003e\u003c\/svg\u003e`;
        if (collapseText) {
          collapseText.textContent = 'ì ‘ê¸°';
        }
        collapseBtn.title = 'ì ‘ê¸°';
      }

      
      if (animate) {
        codeContainer.style.transition = 'max-height 0.3s ease-out';
        setTimeout(() => {
          codeContainer.style.transition = '';
        }, 300);
      }
    }

    function toggleCollapse() {
      setCollapsed(!isCollapsed, true);
    }

    
    collapseBtn.addEventListener('click', toggleCollapse);

    
    if (collapseOverlay) {
      collapseOverlay.addEventListener('click', () => {
        if (isCollapsed) {
          setCollapsed(false, true);
        }
      });
    }

    
    initCollapse();
  }
})();
</script>
<h4 id="2-ltm-cross-attention">2. <strong>LTM cross-attention</strong></h4>
<ul>
<li>
<p>í•œ layerì—ì„œ 512 tokensê°€ 128Ã—64ê°œì˜ memory KVì™€ cross-attn ìˆ˜í–‰</p>
</li>
<li>
<p>long memory ì´ í¬ê¸°:</p>
<div
  class="code-block-container border-border bg-card my-6 overflow-hidden rounded-xl border shadow-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:shadow-md">
  
  <div
    class="code-block-header bg-muted/30 border-border flex items-center justify-between border-b px-4 py-3">
    
    <div class="flex items-center gap-2">
      <div class="text-muted-foreground flex-shrink-0">
        
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4" />
</svg>
      </div>
      <span class="text-muted-foreground text-sm font-medium">
        PLAINTEXT
      </span>
    </div>

    
    <div class="flex items-center gap-2">
      <button
          class="collapse-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none"
          data-code-id="code-11"
          data-default-state="expanded"
          data-collapsed="false"
          data-auto-collapse-lines="30"
          data-auto-collapse-height="400"
          data-collapsed-height="120"
          title="ì ‘ê¸°"
          aria-label="ì ‘ê¸°">
          <span class="collapse-icon">
            
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z"/></svg>
          </span>
          <span class="collapse-text hidden sm:inline"
            >ì ‘ê¸°</span
          >
        </button>
      <button
        class="copy-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none"
        data-code-id="code-11"
        title="ë³µì‚¬"
        aria-label="ë³µì‚¬">
        <span class="copy-icon">
          
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
</svg>
        </span>
        <span class="copy-text hidden sm:inline"
          >ë³µì‚¬</span
        >
      </button>
    </div>
  </div>

  
  <div class="code-block-content relative" id="code-11">
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">64 tokens Ã— 128 windows = 8192 tokens
</span></span><span class="line"><span class="ln">2</span><span class="cl">â†’ attention: 512 Ã— 8192 Ã— d = O(4M Ã— d)</span></span></code></pre></div>
    
    <div
      class="collapse-overlay to-card/90 pointer-events-none absolute inset-0 bg-gradient-to-b from-transparent via-transparent opacity-0 transition-opacity duration-300">
      <div
        class="text-muted-foreground bg-card/80 border-border/50 hover:bg-primary/10 hover:text-primary hover:border-primary/30 absolute bottom-4 left-1/2 -translate-x-1/2 cursor-pointer rounded-full border px-3 py-1.5 text-xs backdrop-blur-sm transition-all duration-200">
        í´ë¦­í•˜ì—¬ ë” ë³´ê¸°
      </div>
    </div>
  </div>
</div>


<script>
(function() {
  const codeId = 'code-11';
  const copyBtn = document.querySelector('.copy-code-btn[data-code-id="' + codeId + '"]');
  const collapseBtn = document.querySelector('.collapse-code-btn[data-code-id="' + codeId + '"]');
  const codeContainer = document.getElementById(codeId);

  if (!codeContainer) return;

  
  if (copyBtn) {
    const copyIcon = copyBtn.querySelector('.copy-icon');
    const copyText = copyBtn.querySelector('.copy-text');

    copyBtn.addEventListener('click', async function() {
      try {
        
        let codeText = '';

        
        const codeTableCell = codeContainer.querySelector('.lntd:last-child code');
        if (codeTableCell) {
          codeText = codeTableCell.textContent || codeTableCell.innerText;
        } else {
          
          const codeElement = codeContainer.querySelector('code');
          if (codeElement) {
            
            const hasInlineLineNumbers = codeElement.querySelector('.ln');
            if (hasInlineLineNumbers) {
              
              const codeLines = codeElement.querySelectorAll('.cl');
              if (codeLines.length > 0) {
                codeText = Array.from(codeLines)
                  .map(line => {
                    const text = line.textContent || line.innerText;
                    
                    return text.replace(/\n+$/, '');
                  })
                  .join('\n')
                  .replace(/\n+$/, ''); 
              } else {
                
                const allText = codeElement.textContent || codeElement.innerText;
                codeText = allText.replace(/^\d+/gm, '').replace(/^\s+/gm, '');
              }
            } else {
              
              codeText = codeElement.textContent || codeElement.innerText;
            }
          } else {
            
            codeText = codeContainer.textContent || codeContainer.innerText;
          }
        }

        
        codeText = codeText.trim();

        
        await navigator.clipboard.writeText(codeText);

        
        copyIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M5 13l4 4L19 7\u0022 \/\u003e\n\u003c\/svg\u003e`;
        if (copyText) {
          copyText.textContent = 'ë³µì‚¬ë¨';
        }
        copyBtn.classList.add('text-green-600');

        
        setTimeout(() => {
          copyIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z\u0022 \/\u003e\n\u003c\/svg\u003e`;
          if (copyText) {
            copyText.textContent = 'ë³µì‚¬';
          }
          copyBtn.classList.remove('text-green-600');
        }, 2000);

      } catch (err) {
        console.error('å¤åˆ¶å¤±è´¥:', err);

        
        const range = document.createRange();
        const codeElement = codeContainer.querySelector('code') || codeContainer;
        range.selectNodeContents(codeElement);
        const selection = window.getSelection();
        selection.removeAllRanges();
        selection.addRange(range);

        
        if (copyText) {
          copyText.textContent = 'ì„ íƒë¨';
        }

        setTimeout(() => {
          if (copyText) {
            copyText.textContent = 'ë³µì‚¬';
          }
          selection.removeAllRanges();
        }, 2000);
      }
    });
  }

  
  if (collapseBtn) {
    const collapseIcon = collapseBtn.querySelector('.collapse-icon');
    const collapseText = collapseBtn.querySelector('.collapse-text');
    const collapseOverlay = codeContainer.querySelector('.collapse-overlay');

    
    let codeElement = codeContainer.querySelector('pre.chroma');
    if (!codeElement) {
      codeElement = codeContainer.querySelector('pre');
    }

    const defaultState = collapseBtn.dataset.defaultState || 'expanded';
    const isCollapsedAttr = collapseBtn.dataset.collapsed === 'true';
    const autoCollapseLines = parseInt(collapseBtn.dataset.autoCollapseLines) || 30;
    const autoCollapseHeight = parseInt(collapseBtn.dataset.autoCollapseHeight) || 400;
    const collapsedHeight = parseInt(collapseBtn.dataset.collapsedHeight) || 120;

    let isCollapsed = false;

    
    function initCollapse() {
      
      const shouldCollapse = isCollapsedAttr ||
                           defaultState === 'collapsed' ||
                           shouldAutoCollapse();

      if (shouldCollapse) {
        setCollapsed(true, false); 
      }
    }

    function shouldAutoCollapse() {
      
      if (codeElement) {
        const lines = codeElement.querySelectorAll('.line, .cl');
        const height = codeElement.offsetHeight;
        return lines.length > autoCollapseLines || height > autoCollapseHeight;
      }

      
      const containerHeight = codeContainer.offsetHeight;
      if (containerHeight > autoCollapseHeight) {
        return true;
      }

      
      const textContent = codeContainer.textContent || codeContainer.innerText || '';
      const estimatedLines = textContent.split('\n').length;
      return estimatedLines > autoCollapseLines;
    }

    function setCollapsed(collapsed, animate = true) {
      if (!collapseOverlay) return;

      isCollapsed = collapsed;

      if (collapsed) {
        
        codeContainer.style.maxHeight = collapsedHeight + 'px';
        codeContainer.style.overflow = 'hidden';
        collapseOverlay.style.opacity = '1';
        collapseOverlay.style.pointerEvents = 'auto';

        
        collapseIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M19 9l-7 7-7-7\u0022 \/\u003e\n\u003c\/svg\u003e`;
        if (collapseText) {
          collapseText.textContent = 'í¼ì¹˜ê¸°';
        }
        collapseBtn.title = 'í¼ì¹˜ê¸°';

      } else {
        
        codeContainer.style.maxHeight = '';
        codeContainer.style.overflow = '';
        collapseOverlay.style.opacity = '0';
        collapseOverlay.style.pointerEvents = 'none';

        
        collapseIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath fill=\u0022currentColor\u0022 d=\u0022M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z\u0022\/\u003e\u003c\/svg\u003e`;
        if (collapseText) {
          collapseText.textContent = 'ì ‘ê¸°';
        }
        collapseBtn.title = 'ì ‘ê¸°';
      }

      
      if (animate) {
        codeContainer.style.transition = 'max-height 0.3s ease-out';
        setTimeout(() => {
          codeContainer.style.transition = '';
        }, 300);
      }
    }

    function toggleCollapse() {
      setCollapsed(!isCollapsed, true);
    }

    
    collapseBtn.addEventListener('click', toggleCollapse);

    
    if (collapseOverlay) {
      collapseOverlay.addEventListener('click', () => {
        if (isCollapsed) {
          setCollapsed(false, true);
        }
      });
    }

    
    initCollapse();
  }
})();
</script>
</li>
</ul>
<p>ì´ëŠ” self-attnì˜ 512Â² = 0.25M ë³´ë‹¤ <strong>~16ë°° í¬ì§€ë§Œ</strong>,
<strong>ë‹¨ 1ê°œ layerì—ì„œë§Œ ìˆ˜í–‰</strong> â†’ ì „ì²´ ì—°ì‚°ì—ì„œ ë³´ë©´ <strong>ì•½ 10~15% ì¦ê°€</strong></p>
<p>ğŸ“Œ <strong>ì´ FLOPs ì¦ê°€ëŸ‰ ì¶”ì •</strong>:</p>
<ul>
<li>ì „ì²´ ëª¨ë¸ ê¸°ì¤€ ì•½ <strong>30% ë‚´ì™¸ ì—°ì‚°ëŸ‰ ì¦ê°€</strong></li>
</ul>
<hr>
<h2 id="-3-ë©”ëª¨ë¦¬-ì‚¬ìš©ëŸ‰">ğŸ’¾ 3. ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰</h2>
<table>
  <thead>
      <tr>
          <th>í•­ëª©</th>
          <th>ê¸°ì¡´ Transformer</th>
          <th>MELODI</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>ë‹¨ê¸° ë©”ëª¨ë¦¬ (zâ‚–)</td>
          <td>ì—†ìŒ</td>
          <td>128 tokens/layer Ã— 13 = <strong>1.6M float</strong></td>
      </tr>
      <tr>
          <td>ì¥ê¸° ë©”ëª¨ë¦¬ (mâ‚:â‚–)</td>
          <td>ì—†ìŒ</td>
          <td>64 tokens Ã— 2 (KV) Ã— 128 windows = <strong>16.8M float</strong></td>
      </tr>
      <tr>
          <td>í•©ê³„</td>
          <td>-</td>
          <td>ì•½ <strong>18.4M float = ~73.6MB (FP32)</strong></td>
      </tr>
  </tbody>
</table>
<p>FP16 ì‚¬ìš© ì‹œ <strong>~36.8MB ìˆ˜ì¤€</strong></p>
<hr>
<h2 id="-4-êµ¬í˜„-ê³µìˆ˜-ì—”ì§€ë‹ˆì–´ë§-ê´€ì ">ğŸ‘·â€â™€ï¸ 4. êµ¬í˜„ ê³µìˆ˜ (ì—”ì§€ë‹ˆì–´ë§ ê´€ì )</h2>
<table>
  <thead>
      <tr>
          <th>êµ¬ì„±</th>
          <th>ì˜ˆìƒ ì‘ì—…</th>
          <th>ë‚œì´ë„</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>STM token mixer</td>
          <td>Linear layer ì¶”ê°€ ë° branching logic êµ¬í˜„</td>
          <td>ì¤‘</td>
      </tr>
      <tr>
          <td>Summary token flow</td>
          <td>layer ê°„ routing + next windowë¡œ ë³µì‚¬</td>
          <td>ì¤‘</td>
      </tr>
      <tr>
          <td>LM queue</td>
          <td>FIFO ë©”ëª¨ë¦¬ ê´€ë¦¬ êµ¬ì¡°, KV indexing ê´€ë¦¬</td>
          <td>ì¤‘~ìƒ</td>
      </tr>
      <tr>
          <td>Cross-attn with gating</td>
          <td>multihead attention ëª¨ë“ˆ ìˆ˜ì •</td>
          <td>ë‚®ìŒ</td>
      </tr>
      <tr>
          <td>í¬ì§€ì…˜ ì„ë² ë”© í™•ì¥</td>
          <td>relative pos embed ì¶”ê°€</td>
          <td>ë‚®ìŒ</td>
      </tr>
  </tbody>
</table>
<p>ì´ ê³µìˆ˜:</p>
<ul>
<li><strong>ê¸°ì¡´ GPT-style ì½”ë“œ ê¸°ë°˜ì´ë¼ë©´ ì•½ 1<del>2ì£¼ ê°œë°œ ì¸ë ¥ 1</del>2ëª… ì •ë„</strong></li>
<li>Flax/PyTorch ëª¨ë‘ êµ¬í˜„ ê°€ëŠ¥, JAX ì½”ë“œë¡œë„ ì´ë¯¸ ì¡´ì¬í•¨ (ë…¼ë¬¸ì€ Flax ì‚¬ìš©)</li>
</ul>
<hr>
<h2 id="-ê²°ë¡ -ìš”ì•½-1">âœ… ê²°ë¡  ìš”ì•½</h2>
<table>
  <thead>
      <tr>
          <th>í•­ëª©</th>
          <th>ìˆ˜ì¹˜ ë˜ëŠ” í‰ê°€</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>íŒŒë¼ë¯¸í„° ì¦ê°€</td>
          <td>ì•½ <strong>1%</strong> (token mixer ë“±)</td>
      </tr>
      <tr>
          <td>FLOPs ì¦ê°€</td>
          <td>ì•½ <strong>30% ì´ë‚´</strong></td>
      </tr>
      <tr>
          <td>ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰</td>
          <td>ì•½ <strong>70MB (FP32 ê¸°ì¤€)</strong></td>
      </tr>
      <tr>
          <td>êµ¬í˜„ ê³µìˆ˜</td>
          <td>ì—”ì§€ë‹ˆì–´ 1<del>2ì¸ ê¸°ì¤€ **1</del>2ì£¼ ìˆ˜ì¤€**</td>
      </tr>
      <tr>
          <td>ì ìš© ê°€ëŠ¥ì„±</td>
          <td>ê¸°ì¡´ GPT, LLAMA ë“± transformer ê³„ì—´ì— ì‰½ê²Œ í™•ì¥ ê°€ëŠ¥</td>
      </tr>
  </tbody>
</table>
<hr>

  <blockquote
    class="border-primary bg-muted/30 hover:bg-muted/40 my-6 rounded-r-lg border-l-4 py-4 pr-4 pl-6 italic transition-all duration-200 ease-out hover:translate-x-1">
    <div class="prose prose-sm max-w-none">
      <p>MELODIëŠ” <strong>íŒŒë¼ë¯¸í„° ìˆ˜ ì¦ê°€ë¥¼ ê±°ì˜ ì¼ìœ¼í‚¤ì§€ ì•Šìœ¼ë©´ì„œ</strong>, ë©”ëª¨ë¦¬ì™€ ì—°ì‚°ì˜ ì‚¬ìš© íš¨ìœ¨ì„ ê°œì„ í•˜ê³ , <strong>long-context capability</strong>ë¥¼ ë§¤ìš° íš¨ê³¼ì ìœ¼ë¡œ ê°•í™”í•  ìˆ˜ ìˆëŠ” ì‹¤ìš©ì ì´ê³  í™•ì¥ ê°€ëŠ¥í•œ êµ¬ì¡°ì…ë‹ˆë‹¤.</p>
    </div>
  </blockquote>

<h1 id="q--ê°-ì»´í¼ë„ŒíŠ¸ë³„ë¡œ-pytorch-style-ëª¨ë“ˆ-êµ¬í˜„ì„-ë§Œë“¤ì–´ì¤„-ìˆ˜-ìˆê² ë‹ˆ">Q : ê° ì»´í¼ë„ŒíŠ¸ë³„ë¡œ PyTorch-style ëª¨ë“ˆ êµ¬í˜„ì„ ë§Œë“¤ì–´ì¤„ ìˆ˜ ìˆê² ë‹ˆ?</h1>
<div
  class="code-block-container border-border bg-card my-6 overflow-hidden rounded-xl border shadow-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:shadow-md">
  
  <div
    class="code-block-header bg-muted/30 border-border flex items-center justify-between border-b px-4 py-3">
    
    <div class="flex items-center gap-2">
      <div class="text-muted-foreground flex-shrink-0">
        
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4" />
</svg>
      </div>
      <span class="text-muted-foreground text-sm font-medium">
        PLAINTEXT
      </span>
    </div>

    
    <div class="flex items-center gap-2">
      <button
          class="collapse-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none"
          data-code-id="code-12"
          data-default-state="expanded"
          data-collapsed="false"
          data-auto-collapse-lines="30"
          data-auto-collapse-height="400"
          data-collapsed-height="120"
          title="ì ‘ê¸°"
          aria-label="ì ‘ê¸°">
          <span class="collapse-icon">
            
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z"/></svg>
          </span>
          <span class="collapse-text hidden sm:inline"
            >ì ‘ê¸°</span
          >
        </button>
      <button
        class="copy-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none"
        data-code-id="code-12"
        title="ë³µì‚¬"
        aria-label="ë³µì‚¬">
        <span class="copy-icon">
          
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
</svg>
        </span>
        <span class="copy-text hidden sm:inline"
          >ë³µì‚¬</span
        >
      </button>
    </div>
  </div>

  
  <div class="code-block-content relative" id="code-12">
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="ln">  1</span><span class="cl"><span class="c1"># MELODI í•µì‹¬ ì»´í¬ë„ŒíŠ¸ PyTorch-style ëª¨ë“ˆ êµ¬í˜„</span>
</span></span><span class="line"><span class="ln">  2</span><span class="cl"><span class="n">import</span> <span class="n">torch</span>
</span></span><span class="line"><span class="ln">  3</span><span class="cl"><span class="n">import</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span> <span class="n">as</span> <span class="n">nn</span>
</span></span><span class="line"><span class="ln">  4</span><span class="cl"><span class="n">import</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">functional</span> <span class="n">as</span> <span class="n">F</span>
</span></span><span class="line"><span class="ln">  5</span><span class="cl"><span class="n">from</span> <span class="n">typing</span> <span class="n">import</span> <span class="n">Optional</span>
</span></span><span class="line"><span class="ln">  6</span><span class="cl">
</span></span><span class="line"><span class="ln">  7</span><span class="cl"><span class="c1"># -----------------------------</span>
</span></span><span class="line"><span class="ln">  8</span><span class="cl"><span class="c1"># 1. Summary Token Mixer (Mâ†‘ and Mâ†’)</span>
</span></span><span class="line"><span class="ln">  9</span><span class="cl"><span class="c1"># -----------------------------</span>
</span></span><span class="line"><span class="ln"> 10</span><span class="cl"><span class="k">class</span> <span class="n">LinearTokenMixer</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
</span></span><span class="line"><span class="ln"> 11</span><span class="cl">    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_tokens</span><span class="p">:</span> <span class="ne">int</span><span class="p">,</span> <span class="n">output_tokens</span><span class="p">:</span> <span class="ne">int</span><span class="p">,</span> <span class="n">dim</span><span class="p">:</span> <span class="ne">int</span><span class="p">):</span>
</span></span><span class="line"><span class="ln"> 12</span><span class="cl">        <span class="n">super</span><span class="p">()</span><span class="o">.</span><span class="n">__init__</span><span class="p">()</span>
</span></span><span class="line"><span class="ln"> 13</span><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">mixer</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">input_tokens</span><span class="p">,</span> <span class="n">output_tokens</span><span class="p">,</span> <span class="n">bias</span><span class="o">=</span><span class="n">False</span><span class="p">)</span>
</span></span><span class="line"><span class="ln"> 14</span><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">proj</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">dim</span><span class="p">,</span> <span class="n">dim</span><span class="p">)</span>  <span class="c1"># to map channel-wise</span>
</span></span><span class="line"><span class="ln"> 15</span><span class="cl">
</span></span><span class="line"><span class="ln"> 16</span><span class="cl">    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>  <span class="c1"># x: [B, T, D]</span>
</span></span><span class="line"><span class="ln"> 17</span><span class="cl">        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>  <span class="c1"># [B, D, T]</span>
</span></span><span class="line"><span class="ln"> 18</span><span class="cl">        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mixer</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>      <span class="c1"># [B, D, T&#39;]</span>
</span></span><span class="line"><span class="ln"> 19</span><span class="cl">        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>  <span class="c1"># [B, T&#39;, D]</span>
</span></span><span class="line"><span class="ln"> 20</span><span class="cl">        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">proj</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="ln"> 21</span><span class="cl">
</span></span><span class="line"><span class="ln"> 22</span><span class="cl"><span class="c1"># -----------------------------</span>
</span></span><span class="line"><span class="ln"> 23</span><span class="cl"><span class="c1"># 2. Gated Cross-Attention Layer</span>
</span></span><span class="line"><span class="ln"> 24</span><span class="cl"><span class="c1"># -----------------------------</span>
</span></span><span class="line"><span class="ln"> 25</span><span class="cl"><span class="k">class</span> <span class="n">GatedCrossAttention</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
</span></span><span class="line"><span class="ln"> 26</span><span class="cl">    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dim</span><span class="p">,</span> <span class="n">num_heads</span><span class="p">):</span>
</span></span><span class="line"><span class="ln"> 27</span><span class="cl">        <span class="n">super</span><span class="p">()</span><span class="o">.</span><span class="n">__init__</span><span class="p">()</span>
</span></span><span class="line"><span class="ln"> 28</span><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">self_attn</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">MultiheadAttention</span><span class="p">(</span><span class="n">dim</span><span class="p">,</span> <span class="n">num_heads</span><span class="p">,</span> <span class="n">batch_first</span><span class="o">=</span><span class="n">True</span><span class="p">)</span>
</span></span><span class="line"><span class="ln"> 29</span><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">cross_attn</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">MultiheadAttention</span><span class="p">(</span><span class="n">dim</span><span class="p">,</span> <span class="n">num_heads</span><span class="p">,</span> <span class="n">batch_first</span><span class="o">=</span><span class="n">True</span><span class="p">)</span>
</span></span><span class="line"><span class="ln"> 30</span><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">num_heads</span><span class="p">))</span>
</span></span><span class="line"><span class="ln"> 31</span><span class="cl">
</span></span><span class="line"><span class="ln"> 32</span><span class="cl">    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">long_mem_kv</span><span class="p">):</span>
</span></span><span class="line"><span class="ln"> 33</span><span class="cl">        <span class="n">self_out</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">self_attn</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="ln"> 34</span><span class="cl">        <span class="n">cross_out</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cross_attn</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">long_mem_kv</span><span class="p">,</span> <span class="n">long_mem_kv</span><span class="p">)</span>
</span></span><span class="line"><span class="ln"> 35</span><span class="cl">        <span class="n">alpha</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="ln"> 36</span><span class="cl">        <span class="n">out</span> <span class="o">=</span> <span class="n">alpha</span> <span class="o">*</span> <span class="n">cross_out</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">alpha</span><span class="p">)</span> <span class="o">*</span> <span class="n">self_out</span>
</span></span><span class="line"><span class="ln"> 37</span><span class="cl">        <span class="k">return</span> <span class="n">out</span>
</span></span><span class="line"><span class="ln"> 38</span><span class="cl">
</span></span><span class="line"><span class="ln"> 39</span><span class="cl"><span class="c1"># -----------------------------</span>
</span></span><span class="line"><span class="ln"> 40</span><span class="cl"><span class="c1"># 3. Short-Term Memory Layer</span>
</span></span><span class="line"><span class="ln"> 41</span><span class="cl"><span class="c1"># -----------------------------</span>
</span></span><span class="line"><span class="ln"> 42</span><span class="cl"><span class="k">class</span> <span class="n">ShortTermLayer</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
</span></span><span class="line"><span class="ln"> 43</span><span class="cl">    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dim</span><span class="p">,</span> <span class="n">num_heads</span><span class="p">,</span> <span class="n">token_count</span><span class="o">=</span><span class="mi">512</span><span class="p">,</span> <span class="n">summary_count</span><span class="o">=</span><span class="mi">128</span><span class="p">):</span>
</span></span><span class="line"><span class="ln"> 44</span><span class="cl">        <span class="n">super</span><span class="p">()</span><span class="o">.</span><span class="n">__init__</span><span class="p">()</span>
</span></span><span class="line"><span class="ln"> 45</span><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">attn</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">MultiheadAttention</span><span class="p">(</span><span class="n">dim</span><span class="p">,</span> <span class="n">num_heads</span><span class="p">,</span> <span class="n">batch_first</span><span class="o">=</span><span class="n">True</span><span class="p">)</span>
</span></span><span class="line"><span class="ln"> 46</span><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">ffn</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span>
</span></span><span class="line"><span class="ln"> 47</span><span class="cl">            <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">dim</span><span class="p">,</span> <span class="n">dim</span> <span class="o">*</span> <span class="mi">4</span><span class="p">),</span>
</span></span><span class="line"><span class="ln"> 48</span><span class="cl">            <span class="n">nn</span><span class="o">.</span><span class="n">GELU</span><span class="p">(),</span>
</span></span><span class="line"><span class="ln"> 49</span><span class="cl">            <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">dim</span> <span class="o">*</span> <span class="mi">4</span><span class="p">,</span> <span class="n">dim</span><span class="p">)</span>
</span></span><span class="line"><span class="ln"> 50</span><span class="cl">        <span class="p">)</span>
</span></span><span class="line"><span class="ln"> 51</span><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">token_mixer_up</span> <span class="o">=</span> <span class="n">LinearTokenMixer</span><span class="p">(</span><span class="n">token_count</span> <span class="o">+</span> <span class="n">summary_count</span><span class="p">,</span> <span class="n">summary_count</span><span class="p">,</span> <span class="n">dim</span><span class="p">)</span>
</span></span><span class="line"><span class="ln"> 52</span><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">token_mixer_right</span> <span class="o">=</span> <span class="n">LinearTokenMixer</span><span class="p">(</span><span class="n">token_count</span> <span class="o">+</span> <span class="n">summary_count</span><span class="p">,</span> <span class="n">summary_count</span><span class="p">,</span> <span class="n">dim</span><span class="p">)</span>
</span></span><span class="line"><span class="ln"> 53</span><span class="cl">
</span></span><span class="line"><span class="ln"> 54</span><span class="cl">    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">prev_memory</span><span class="p">):</span>
</span></span><span class="line"><span class="ln"> 55</span><span class="cl">        <span class="n">input_seq</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">([</span><span class="n">prev_memory</span><span class="p">,</span> <span class="n">x</span><span class="p">],</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="ln"> 56</span><span class="cl">        <span class="n">x_out</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">attn</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">input_seq</span><span class="p">,</span> <span class="n">input_seq</span><span class="p">)</span>
</span></span><span class="line"><span class="ln"> 57</span><span class="cl">        <span class="n">x_out</span> <span class="o">=</span> <span class="n">x_out</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">ffn</span><span class="p">(</span><span class="n">x_out</span><span class="p">)</span>
</span></span><span class="line"><span class="ln"> 58</span><span class="cl">        <span class="n">combined</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">([</span><span class="n">x_out</span><span class="p">,</span> <span class="n">summary</span><span class="p">],</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="ln"> 59</span><span class="cl">        <span class="n">new_summary</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">token_mixer_up</span><span class="p">(</span><span class="n">combined</span><span class="p">)</span>
</span></span><span class="line"><span class="ln"> 60</span><span class="cl">        <span class="n">new_memory</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">token_mixer_right</span><span class="p">(</span><span class="n">combined</span><span class="p">)</span>
</span></span><span class="line"><span class="ln"> 61</span><span class="cl">        <span class="k">return</span> <span class="n">x_out</span><span class="p">,</span> <span class="n">new_summary</span><span class="p">,</span> <span class="n">new_memory</span>
</span></span><span class="line"><span class="ln"> 62</span><span class="cl">
</span></span><span class="line"><span class="ln"> 63</span><span class="cl"><span class="c1"># -----------------------------</span>
</span></span><span class="line"><span class="ln"> 64</span><span class="cl"><span class="c1"># 4. Long-Term Memory Update Layer</span>
</span></span><span class="line"><span class="ln"> 65</span><span class="cl"><span class="c1"># -----------------------------</span>
</span></span><span class="line"><span class="ln"> 66</span><span class="cl"><span class="k">class</span> <span class="n">LongTermMemoryLayer</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
</span></span><span class="line"><span class="ln"> 67</span><span class="cl">    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dim</span><span class="p">,</span> <span class="n">num_heads</span><span class="p">,</span> <span class="n">token_count</span><span class="o">=</span><span class="mi">512</span><span class="p">,</span> <span class="n">summary_count</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span> <span class="n">long_tokens</span><span class="o">=</span><span class="mi">64</span><span class="p">):</span>
</span></span><span class="line"><span class="ln"> 68</span><span class="cl">        <span class="n">super</span><span class="p">()</span><span class="o">.</span><span class="n">__init__</span><span class="p">()</span>
</span></span><span class="line"><span class="ln"> 69</span><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">cross_attn</span> <span class="o">=</span> <span class="n">GatedCrossAttention</span><span class="p">(</span><span class="n">dim</span><span class="p">,</span> <span class="n">num_heads</span><span class="p">)</span>
</span></span><span class="line"><span class="ln"> 70</span><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">token_mixer_long</span> <span class="o">=</span> <span class="n">LinearTokenMixer</span><span class="p">(</span><span class="n">token_count</span> <span class="o">+</span> <span class="n">summary_count</span><span class="p">,</span> <span class="n">long_tokens</span><span class="p">,</span> <span class="n">dim</span><span class="p">)</span>
</span></span><span class="line"><span class="ln"> 71</span><span class="cl">
</span></span><span class="line"><span class="ln"> 72</span><span class="cl">    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">long_mem</span><span class="p">):</span>
</span></span><span class="line"><span class="ln"> 73</span><span class="cl">        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cross_attn</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">long_mem</span><span class="p">)</span>
</span></span><span class="line"><span class="ln"> 74</span><span class="cl">        <span class="n">combined</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">summary</span><span class="p">],</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="ln"> 75</span><span class="cl">        <span class="n">long_tokens</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">token_mixer_long</span><span class="p">(</span><span class="n">combined</span><span class="p">)</span>
</span></span><span class="line"><span class="ln"> 76</span><span class="cl">        <span class="k">return</span> <span class="n">x</span><span class="p">,</span> <span class="n">long_tokens</span>
</span></span><span class="line"><span class="ln"> 77</span><span class="cl">
</span></span><span class="line"><span class="ln"> 78</span><span class="cl"><span class="c1"># -----------------------------</span>
</span></span><span class="line"><span class="ln"> 79</span><span class="cl"><span class="c1"># 5. FIFO-based Long-Term Memory Bank</span>
</span></span><span class="line"><span class="ln"> 80</span><span class="cl"><span class="c1"># -----------------------------</span>
</span></span><span class="line"><span class="ln"> 81</span><span class="cl"><span class="k">class</span> <span class="n">LongTermMemoryBank</span><span class="p">:</span>
</span></span><span class="line"><span class="ln"> 82</span><span class="cl">    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">max_windows</span><span class="p">:</span> <span class="ne">int</span><span class="p">):</span>
</span></span><span class="line"><span class="ln"> 83</span><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">max_windows</span> <span class="o">=</span> <span class="n">max_windows</span>
</span></span><span class="line"><span class="ln"> 84</span><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">bank</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="ln"> 85</span><span class="cl">
</span></span><span class="line"><span class="ln"> 86</span><span class="cl">    <span class="k">def</span> <span class="nf">append</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kv</span><span class="p">):</span>
</span></span><span class="line"><span class="ln"> 87</span><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">bank</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">kv</span><span class="p">)</span>
</span></span><span class="line"><span class="ln"> 88</span><span class="cl">        <span class="k">if</span> <span class="n">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bank</span><span class="p">)</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_windows</span><span class="p">:</span>
</span></span><span class="line"><span class="ln"> 89</span><span class="cl">            <span class="bp">self</span><span class="o">.</span><span class="n">bank</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="ln"> 90</span><span class="cl">
</span></span><span class="line"><span class="ln"> 91</span><span class="cl">    <span class="k">def</span> <span class="nf">get_memory</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="ln"> 92</span><span class="cl">        <span class="k">if</span> <span class="n">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bank</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="ln"> 93</span><span class="cl">            <span class="k">return</span> <span class="n">None</span>
</span></span><span class="line"><span class="ln"> 94</span><span class="cl">        <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bank</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="ln"> 95</span><span class="cl">
</span></span><span class="line"><span class="ln"> 96</span><span class="cl"><span class="c1"># -----------------------------</span>
</span></span><span class="line"><span class="ln"> 97</span><span class="cl"><span class="c1"># 6. ì „ì²´ MELODI ë¸”ë¡ ë° Inference ë£¨í”„</span>
</span></span><span class="line"><span class="ln"> 98</span><span class="cl"><span class="c1"># -----------------------------</span>
</span></span><span class="line"><span class="ln"> 99</span><span class="cl"><span class="k">class</span> <span class="n">MELODIBlock</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
</span></span><span class="line"><span class="ln">100</span><span class="cl">    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1024</span><span class="p">,</span> <span class="n">num_heads</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">num_layers</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span> <span class="n">sm_layers</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">10</span><span class="p">],</span> <span class="n">lm_layer</span><span class="o">=</span><span class="mi">7</span><span class="p">):</span>
</span></span><span class="line"><span class="ln">101</span><span class="cl">        <span class="n">super</span><span class="p">()</span><span class="o">.</span><span class="n">__init__</span><span class="p">()</span>
</span></span><span class="line"><span class="ln">102</span><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">dim</span> <span class="o">=</span> <span class="n">dim</span>
</span></span><span class="line"><span class="ln">103</span><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">num_layers</span> <span class="o">=</span> <span class="n">num_layers</span>
</span></span><span class="line"><span class="ln">104</span><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">sm_layers</span> <span class="o">=</span> <span class="n">sm_layers</span>
</span></span><span class="line"><span class="ln">105</span><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">lm_layer</span> <span class="o">=</span> <span class="n">lm_layer</span>
</span></span><span class="line"><span class="ln">106</span><span class="cl">
</span></span><span class="line"><span class="ln">107</span><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">layers</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">ModuleList</span><span class="p">()</span>
</span></span><span class="line"><span class="ln">108</span><span class="cl">        <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_layers</span><span class="p">):</span>
</span></span><span class="line"><span class="ln">109</span><span class="cl">            <span class="k">if</span> <span class="n">l</span> <span class="o">==</span> <span class="n">lm_layer</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">110</span><span class="cl">                <span class="bp">self</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">LongTermMemoryLayer</span><span class="p">(</span><span class="n">dim</span><span class="p">,</span> <span class="n">num_heads</span><span class="p">))</span>
</span></span><span class="line"><span class="ln">111</span><span class="cl">            <span class="k">elif</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">sm_layers</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">112</span><span class="cl">                <span class="bp">self</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ShortTermLayer</span><span class="p">(</span><span class="n">dim</span><span class="p">,</span> <span class="n">num_heads</span><span class="p">))</span>
</span></span><span class="line"><span class="ln">113</span><span class="cl">            <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">114</span><span class="cl">                <span class="bp">self</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">TransformerEncoderLayer</span><span class="p">(</span><span class="n">d_model</span><span class="o">=</span><span class="n">dim</span><span class="p">,</span> <span class="n">nhead</span><span class="o">=</span><span class="n">num_heads</span><span class="p">,</span> <span class="n">batch_first</span><span class="o">=</span><span class="n">True</span><span class="p">))</span>
</span></span><span class="line"><span class="ln">115</span><span class="cl">
</span></span><span class="line"><span class="ln">116</span><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">memory_bank</span> <span class="o">=</span> <span class="n">LongTermMemoryBank</span><span class="p">(</span><span class="n">max_windows</span><span class="o">=</span><span class="mi">128</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">117</span><span class="cl">
</span></span><span class="line"><span class="ln">118</span><span class="cl">    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x_seq_list</span><span class="p">):</span>
</span></span><span class="line"><span class="ln">119</span><span class="cl">        <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="ln">120</span><span class="cl"><span class="s2">        x_seq_list: List of [B, T, D] segments, one per context window
</span></span></span><span class="line"><span class="ln">121</span><span class="cl"><span class="s2">        &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="ln">122</span><span class="cl">        <span class="n">z_prev</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">x_seq_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">128</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dim</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">x_seq_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>  <span class="c1"># STM ì´ˆê¸°ê°’</span>
</span></span><span class="line"><span class="ln">123</span><span class="cl">        <span class="n">u_prev</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">z_prev</span><span class="p">)</span>  <span class="c1"># Summary token ì´ˆê¸°ê°’</span>
</span></span><span class="line"><span class="ln">124</span><span class="cl">        <span class="n">out_all</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="ln">125</span><span class="cl">
</span></span><span class="line"><span class="ln">126</span><span class="cl">        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">x_seq_list</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">127</span><span class="cl">            <span class="k">for</span> <span class="n">l</span><span class="p">,</span> <span class="n">layer</span> <span class="ow">in</span> <span class="n">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">layers</span><span class="p">):</span>
</span></span><span class="line"><span class="ln">128</span><span class="cl">                <span class="k">if</span> <span class="n">isinstance</span><span class="p">(</span><span class="n">layer</span><span class="p">,</span> <span class="n">ShortTermLayer</span><span class="p">):</span>
</span></span><span class="line"><span class="ln">129</span><span class="cl">                    <span class="n">x</span><span class="p">,</span> <span class="n">u_prev</span><span class="p">,</span> <span class="n">z_prev</span> <span class="o">=</span> <span class="n">layer</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">u_prev</span><span class="p">,</span> <span class="n">z_prev</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">130</span><span class="cl">                <span class="k">elif</span> <span class="n">isinstance</span><span class="p">(</span><span class="n">layer</span><span class="p">,</span> <span class="n">LongTermMemoryLayer</span><span class="p">):</span>
</span></span><span class="line"><span class="ln">131</span><span class="cl">                    <span class="n">long_mem</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">memory_bank</span><span class="o">.</span><span class="n">get_memory</span><span class="p">()</span>
</span></span><span class="line"><span class="ln">132</span><span class="cl">                    <span class="n">x</span><span class="p">,</span> <span class="n">long_token</span> <span class="o">=</span> <span class="n">layer</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">u_prev</span><span class="p">,</span> <span class="n">long_mem</span> <span class="k">if</span> <span class="n">long_mem</span> <span class="n">is</span> <span class="ow">not</span> <span class="n">None</span> <span class="k">else</span> <span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">133</span><span class="cl">                    <span class="bp">self</span><span class="o">.</span><span class="n">memory_bank</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">long_token</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">134</span><span class="cl">                <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">135</span><span class="cl">                    <span class="n">x</span> <span class="o">=</span> <span class="n">layer</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">136</span><span class="cl">            <span class="n">out_all</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">137</span><span class="cl">
</span></span><span class="line"><span class="ln">138</span><span class="cl">        <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">(</span><span class="n">out_all</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># ì „ì²´ output concat</span></span></span></code></pre></div>
    
    <div
      class="collapse-overlay to-card/90 pointer-events-none absolute inset-0 bg-gradient-to-b from-transparent via-transparent opacity-0 transition-opacity duration-300">
      <div
        class="text-muted-foreground bg-card/80 border-border/50 hover:bg-primary/10 hover:text-primary hover:border-primary/30 absolute bottom-4 left-1/2 -translate-x-1/2 cursor-pointer rounded-full border px-3 py-1.5 text-xs backdrop-blur-sm transition-all duration-200">
        í´ë¦­í•˜ì—¬ ë” ë³´ê¸°
      </div>
    </div>
  </div>
</div>


<script>
(function() {
  const codeId = 'code-12';
  const copyBtn = document.querySelector('.copy-code-btn[data-code-id="' + codeId + '"]');
  const collapseBtn = document.querySelector('.collapse-code-btn[data-code-id="' + codeId + '"]');
  const codeContainer = document.getElementById(codeId);

  if (!codeContainer) return;

  
  if (copyBtn) {
    const copyIcon = copyBtn.querySelector('.copy-icon');
    const copyText = copyBtn.querySelector('.copy-text');

    copyBtn.addEventListener('click', async function() {
      try {
        
        let codeText = '';

        
        const codeTableCell = codeContainer.querySelector('.lntd:last-child code');
        if (codeTableCell) {
          codeText = codeTableCell.textContent || codeTableCell.innerText;
        } else {
          
          const codeElement = codeContainer.querySelector('code');
          if (codeElement) {
            
            const hasInlineLineNumbers = codeElement.querySelector('.ln');
            if (hasInlineLineNumbers) {
              
              const codeLines = codeElement.querySelectorAll('.cl');
              if (codeLines.length > 0) {
                codeText = Array.from(codeLines)
                  .map(line => {
                    const text = line.textContent || line.innerText;
                    
                    return text.replace(/\n+$/, '');
                  })
                  .join('\n')
                  .replace(/\n+$/, ''); 
              } else {
                
                const allText = codeElement.textContent || codeElement.innerText;
                codeText = allText.replace(/^\d+/gm, '').replace(/^\s+/gm, '');
              }
            } else {
              
              codeText = codeElement.textContent || codeElement.innerText;
            }
          } else {
            
            codeText = codeContainer.textContent || codeContainer.innerText;
          }
        }

        
        codeText = codeText.trim();

        
        await navigator.clipboard.writeText(codeText);

        
        copyIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M5 13l4 4L19 7\u0022 \/\u003e\n\u003c\/svg\u003e`;
        if (copyText) {
          copyText.textContent = 'ë³µì‚¬ë¨';
        }
        copyBtn.classList.add('text-green-600');

        
        setTimeout(() => {
          copyIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z\u0022 \/\u003e\n\u003c\/svg\u003e`;
          if (copyText) {
            copyText.textContent = 'ë³µì‚¬';
          }
          copyBtn.classList.remove('text-green-600');
        }, 2000);

      } catch (err) {
        console.error('å¤åˆ¶å¤±è´¥:', err);

        
        const range = document.createRange();
        const codeElement = codeContainer.querySelector('code') || codeContainer;
        range.selectNodeContents(codeElement);
        const selection = window.getSelection();
        selection.removeAllRanges();
        selection.addRange(range);

        
        if (copyText) {
          copyText.textContent = 'ì„ íƒë¨';
        }

        setTimeout(() => {
          if (copyText) {
            copyText.textContent = 'ë³µì‚¬';
          }
          selection.removeAllRanges();
        }, 2000);
      }
    });
  }

  
  if (collapseBtn) {
    const collapseIcon = collapseBtn.querySelector('.collapse-icon');
    const collapseText = collapseBtn.querySelector('.collapse-text');
    const collapseOverlay = codeContainer.querySelector('.collapse-overlay');

    
    let codeElement = codeContainer.querySelector('pre.chroma');
    if (!codeElement) {
      codeElement = codeContainer.querySelector('pre');
    }

    const defaultState = collapseBtn.dataset.defaultState || 'expanded';
    const isCollapsedAttr = collapseBtn.dataset.collapsed === 'true';
    const autoCollapseLines = parseInt(collapseBtn.dataset.autoCollapseLines) || 30;
    const autoCollapseHeight = parseInt(collapseBtn.dataset.autoCollapseHeight) || 400;
    const collapsedHeight = parseInt(collapseBtn.dataset.collapsedHeight) || 120;

    let isCollapsed = false;

    
    function initCollapse() {
      
      const shouldCollapse = isCollapsedAttr ||
                           defaultState === 'collapsed' ||
                           shouldAutoCollapse();

      if (shouldCollapse) {
        setCollapsed(true, false); 
      }
    }

    function shouldAutoCollapse() {
      
      if (codeElement) {
        const lines = codeElement.querySelectorAll('.line, .cl');
        const height = codeElement.offsetHeight;
        return lines.length > autoCollapseLines || height > autoCollapseHeight;
      }

      
      const containerHeight = codeContainer.offsetHeight;
      if (containerHeight > autoCollapseHeight) {
        return true;
      }

      
      const textContent = codeContainer.textContent || codeContainer.innerText || '';
      const estimatedLines = textContent.split('\n').length;
      return estimatedLines > autoCollapseLines;
    }

    function setCollapsed(collapsed, animate = true) {
      if (!collapseOverlay) return;

      isCollapsed = collapsed;

      if (collapsed) {
        
        codeContainer.style.maxHeight = collapsedHeight + 'px';
        codeContainer.style.overflow = 'hidden';
        collapseOverlay.style.opacity = '1';
        collapseOverlay.style.pointerEvents = 'auto';

        
        collapseIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M19 9l-7 7-7-7\u0022 \/\u003e\n\u003c\/svg\u003e`;
        if (collapseText) {
          collapseText.textContent = 'í¼ì¹˜ê¸°';
        }
        collapseBtn.title = 'í¼ì¹˜ê¸°';

      } else {
        
        codeContainer.style.maxHeight = '';
        codeContainer.style.overflow = '';
        collapseOverlay.style.opacity = '0';
        collapseOverlay.style.pointerEvents = 'none';

        
        collapseIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath fill=\u0022currentColor\u0022 d=\u0022M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z\u0022\/\u003e\u003c\/svg\u003e`;
        if (collapseText) {
          collapseText.textContent = 'ì ‘ê¸°';
        }
        collapseBtn.title = 'ì ‘ê¸°';
      }

      
      if (animate) {
        codeContainer.style.transition = 'max-height 0.3s ease-out';
        setTimeout(() => {
          codeContainer.style.transition = '';
        }, 300);
      }
    }

    function toggleCollapse() {
      setCollapsed(!isCollapsed, true);
    }

    
    collapseBtn.addEventListener('click', toggleCollapse);

    
    if (collapseOverlay) {
      collapseOverlay.addEventListener('click', () => {
        if (isCollapsed) {
          setCollapsed(false, true);
        }
      });
    }

    
    initCollapse();
  }
})();
</script>
<h1 id="q--ì´-ë…¼ë¬¸ì˜-ì…ë ¥ë°ì´í„°ì™€-ì¶”ë¡ -ê³¼ì •ì—-ëŒ€í•´ì„œ-ì˜ˆì‹œë¥¼-ë“¤ì–´-ì•„ì£¼-ìì„¸í•˜ê²Œ-ì„¤ëª…í•´-ì£¼ê² ë‹ˆ-ì¶”ê°€ì ìœ¼ë¡œ-ëª¨ë¸ì•„í‚¤í…ì²˜ì˜-êµ¬ì„±-ë°-ëª¨ë¸ì„-êµ¬ì„±í•˜ëŠ”-ì—°ì‚°ê³¼-ë©”ëª¨ë¦¬-ìš”êµ¬ëŸ‰-ì»´í“¨íŒ…-ìš”êµ¬ëŸ‰-ëŒ€í•´ì„œë„-ì„¤ëª…í•´ì¤˜">Q : ì´ ë…¼ë¬¸ì˜ ì…ë ¥ë°ì´í„°ì™€ ì¶”ë¡  ê³¼ì •ì— ëŒ€í•´ì„œ ì˜ˆì‹œë¥¼ ë“¤ì–´ ì•„ì£¼ ìì„¸í•˜ê²Œ ì„¤ëª…í•´ ì£¼ê² ë‹ˆ? ì¶”ê°€ì ìœ¼ë¡œ ëª¨ë¸ì•„í‚¤í…ì²˜ì˜ êµ¬ì„± ë° ëª¨ë¸ì„ êµ¬ì„±í•˜ëŠ” ì—°ì‚°ê³¼ ë©”ëª¨ë¦¬ ìš”êµ¬ëŸ‰ ì»´í“¨íŒ… ìš”êµ¬ëŸ‰ ëŒ€í•´ì„œë„ ì„¤ëª…í•´ì¤˜</h1>
<p>ì•„ì£¼ ì¢‹ìŠµë‹ˆë‹¤. ì§€ê¸ˆê¹Œì§€ ì •ì˜ëœ MELODI ì•„í‚¤í…ì²˜ë¥¼ ë°”íƒ•ìœ¼ë¡œ, ì´ êµ¬ì¡°ê°€ <strong>ì…ë ¥ ë°ì´í„°ë¥¼ ì–´ë–»ê²Œ ì²˜ë¦¬í•˜ê³ </strong>, <strong>ì¶”ë¡ ì´ ì–´ë–»ê²Œ ë™ì‘í•˜ë©°</strong>, <strong>ì—°ì‚°ëŸ‰/ë©”ëª¨ë¦¬ ìš”êµ¬ê°€ ì–´ë–¤ì§€</strong>ë¥¼ êµ¬ì²´ì ì¸ ì˜ˆì‹œë¥¼ ë“¤ì–´ ì„¤ëª…í•˜ê² ìŠµë‹ˆë‹¤.</p>
<hr>
<h2 id="-ì…ë ¥-ë°ì´í„°-ì˜ˆì‹œ-ë°-ì „ì²˜ë¦¬">âœ… ì…ë ¥ ë°ì´í„° ì˜ˆì‹œ ë° ì „ì²˜ë¦¬</h2>
<h3 id="ì…ë ¥-ì˜ˆì‹œ-ê¸´-ë¬¸ì„œ">ì…ë ¥ ì˜ˆì‹œ (ê¸´ ë¬¸ì„œ)</h3>
<div
  class="code-block-container border-border bg-card my-6 overflow-hidden rounded-xl border shadow-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:shadow-md">
  
  <div
    class="code-block-header bg-muted/30 border-border flex items-center justify-between border-b px-4 py-3">
    
    <div class="flex items-center gap-2">
      <div class="text-muted-foreground flex-shrink-0">
        
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4" />
</svg>
      </div>
      <span class="text-muted-foreground text-sm font-medium">
        TEXT
      </span>
    </div>

    
    <div class="flex items-center gap-2">
      <button
          class="collapse-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none"
          data-code-id="code-13"
          data-default-state="expanded"
          data-collapsed="false"
          data-auto-collapse-lines="30"
          data-auto-collapse-height="400"
          data-collapsed-height="120"
          title="ì ‘ê¸°"
          aria-label="ì ‘ê¸°">
          <span class="collapse-icon">
            
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z"/></svg>
          </span>
          <span class="collapse-text hidden sm:inline"
            >ì ‘ê¸°</span
          >
        </button>
      <button
        class="copy-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none"
        data-code-id="code-13"
        title="ë³µì‚¬"
        aria-label="ë³µì‚¬">
        <span class="copy-icon">
          
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
</svg>
        </span>
        <span class="copy-text hidden sm:inline"
          >ë³µì‚¬</span
        >
      </button>
    </div>
  </div>

  
  <div class="code-block-content relative" id="code-13">
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="ln">1</span><span class="cl">&#34;In the middle of the night, he found a strange box hidden beneath the floorboards. ...&#34;
</span></span><span class="line"><span class="ln">2</span><span class="cl">â†’ ê¸¸ì´: 8,192 tokens (ì˜ˆ: ê¸´ ì†Œì„¤)</span></span></code></pre></div>
    
    <div
      class="collapse-overlay to-card/90 pointer-events-none absolute inset-0 bg-gradient-to-b from-transparent via-transparent opacity-0 transition-opacity duration-300">
      <div
        class="text-muted-foreground bg-card/80 border-border/50 hover:bg-primary/10 hover:text-primary hover:border-primary/30 absolute bottom-4 left-1/2 -translate-x-1/2 cursor-pointer rounded-full border px-3 py-1.5 text-xs backdrop-blur-sm transition-all duration-200">
        í´ë¦­í•˜ì—¬ ë” ë³´ê¸°
      </div>
    </div>
  </div>
</div>


<script>
(function() {
  const codeId = 'code-13';
  const copyBtn = document.querySelector('.copy-code-btn[data-code-id="' + codeId + '"]');
  const collapseBtn = document.querySelector('.collapse-code-btn[data-code-id="' + codeId + '"]');
  const codeContainer = document.getElementById(codeId);

  if (!codeContainer) return;

  
  if (copyBtn) {
    const copyIcon = copyBtn.querySelector('.copy-icon');
    const copyText = copyBtn.querySelector('.copy-text');

    copyBtn.addEventListener('click', async function() {
      try {
        
        let codeText = '';

        
        const codeTableCell = codeContainer.querySelector('.lntd:last-child code');
        if (codeTableCell) {
          codeText = codeTableCell.textContent || codeTableCell.innerText;
        } else {
          
          const codeElement = codeContainer.querySelector('code');
          if (codeElement) {
            
            const hasInlineLineNumbers = codeElement.querySelector('.ln');
            if (hasInlineLineNumbers) {
              
              const codeLines = codeElement.querySelectorAll('.cl');
              if (codeLines.length > 0) {
                codeText = Array.from(codeLines)
                  .map(line => {
                    const text = line.textContent || line.innerText;
                    
                    return text.replace(/\n+$/, '');
                  })
                  .join('\n')
                  .replace(/\n+$/, ''); 
              } else {
                
                const allText = codeElement.textContent || codeElement.innerText;
                codeText = allText.replace(/^\d+/gm, '').replace(/^\s+/gm, '');
              }
            } else {
              
              codeText = codeElement.textContent || codeElement.innerText;
            }
          } else {
            
            codeText = codeContainer.textContent || codeContainer.innerText;
          }
        }

        
        codeText = codeText.trim();

        
        await navigator.clipboard.writeText(codeText);

        
        copyIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M5 13l4 4L19 7\u0022 \/\u003e\n\u003c\/svg\u003e`;
        if (copyText) {
          copyText.textContent = 'ë³µì‚¬ë¨';
        }
        copyBtn.classList.add('text-green-600');

        
        setTimeout(() => {
          copyIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z\u0022 \/\u003e\n\u003c\/svg\u003e`;
          if (copyText) {
            copyText.textContent = 'ë³µì‚¬';
          }
          copyBtn.classList.remove('text-green-600');
        }, 2000);

      } catch (err) {
        console.error('å¤åˆ¶å¤±è´¥:', err);

        
        const range = document.createRange();
        const codeElement = codeContainer.querySelector('code') || codeContainer;
        range.selectNodeContents(codeElement);
        const selection = window.getSelection();
        selection.removeAllRanges();
        selection.addRange(range);

        
        if (copyText) {
          copyText.textContent = 'ì„ íƒë¨';
        }

        setTimeout(() => {
          if (copyText) {
            copyText.textContent = 'ë³µì‚¬';
          }
          selection.removeAllRanges();
        }, 2000);
      }
    });
  }

  
  if (collapseBtn) {
    const collapseIcon = collapseBtn.querySelector('.collapse-icon');
    const collapseText = collapseBtn.querySelector('.collapse-text');
    const collapseOverlay = codeContainer.querySelector('.collapse-overlay');

    
    let codeElement = codeContainer.querySelector('pre.chroma');
    if (!codeElement) {
      codeElement = codeContainer.querySelector('pre');
    }

    const defaultState = collapseBtn.dataset.defaultState || 'expanded';
    const isCollapsedAttr = collapseBtn.dataset.collapsed === 'true';
    const autoCollapseLines = parseInt(collapseBtn.dataset.autoCollapseLines) || 30;
    const autoCollapseHeight = parseInt(collapseBtn.dataset.autoCollapseHeight) || 400;
    const collapsedHeight = parseInt(collapseBtn.dataset.collapsedHeight) || 120;

    let isCollapsed = false;

    
    function initCollapse() {
      
      const shouldCollapse = isCollapsedAttr ||
                           defaultState === 'collapsed' ||
                           shouldAutoCollapse();

      if (shouldCollapse) {
        setCollapsed(true, false); 
      }
    }

    function shouldAutoCollapse() {
      
      if (codeElement) {
        const lines = codeElement.querySelectorAll('.line, .cl');
        const height = codeElement.offsetHeight;
        return lines.length > autoCollapseLines || height > autoCollapseHeight;
      }

      
      const containerHeight = codeContainer.offsetHeight;
      if (containerHeight > autoCollapseHeight) {
        return true;
      }

      
      const textContent = codeContainer.textContent || codeContainer.innerText || '';
      const estimatedLines = textContent.split('\n').length;
      return estimatedLines > autoCollapseLines;
    }

    function setCollapsed(collapsed, animate = true) {
      if (!collapseOverlay) return;

      isCollapsed = collapsed;

      if (collapsed) {
        
        codeContainer.style.maxHeight = collapsedHeight + 'px';
        codeContainer.style.overflow = 'hidden';
        collapseOverlay.style.opacity = '1';
        collapseOverlay.style.pointerEvents = 'auto';

        
        collapseIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M19 9l-7 7-7-7\u0022 \/\u003e\n\u003c\/svg\u003e`;
        if (collapseText) {
          collapseText.textContent = 'í¼ì¹˜ê¸°';
        }
        collapseBtn.title = 'í¼ì¹˜ê¸°';

      } else {
        
        codeContainer.style.maxHeight = '';
        codeContainer.style.overflow = '';
        collapseOverlay.style.opacity = '0';
        collapseOverlay.style.pointerEvents = 'none';

        
        collapseIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath fill=\u0022currentColor\u0022 d=\u0022M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z\u0022\/\u003e\u003c\/svg\u003e`;
        if (collapseText) {
          collapseText.textContent = 'ì ‘ê¸°';
        }
        collapseBtn.title = 'ì ‘ê¸°';
      }

      
      if (animate) {
        codeContainer.style.transition = 'max-height 0.3s ease-out';
        setTimeout(() => {
          codeContainer.style.transition = '';
        }, 300);
      }
    }

    function toggleCollapse() {
      setCollapsed(!isCollapsed, true);
    }

    
    collapseBtn.addEventListener('click', toggleCollapse);

    
    if (collapseOverlay) {
      collapseOverlay.addEventListener('click', () => {
        if (isCollapsed) {
          setCollapsed(false, true);
        }
      });
    }

    
    initCollapse();
  }
})();
</script>
<h3 id="ì „ì²˜ë¦¬">ì „ì²˜ë¦¬</h3>
<div
  class="code-block-container border-border bg-card my-6 overflow-hidden rounded-xl border shadow-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:shadow-md">
  
  <div
    class="code-block-header bg-muted/30 border-border flex items-center justify-between border-b px-4 py-3">
    
    <div class="flex items-center gap-2">
      <div class="text-muted-foreground flex-shrink-0">
        
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4" />
</svg>
      </div>
      <span class="text-muted-foreground text-sm font-medium">
        PYTHON
      </span>
    </div>

    
    <div class="flex items-center gap-2">
      <button
          class="collapse-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none"
          data-code-id="code-14"
          data-default-state="expanded"
          data-collapsed="false"
          data-auto-collapse-lines="30"
          data-auto-collapse-height="400"
          data-collapsed-height="120"
          title="ì ‘ê¸°"
          aria-label="ì ‘ê¸°">
          <span class="collapse-icon">
            
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z"/></svg>
          </span>
          <span class="collapse-text hidden sm:inline"
            >ì ‘ê¸°</span
          >
        </button>
      <button
        class="copy-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none"
        data-code-id="code-14"
        title="ë³µì‚¬"
        aria-label="ë³µì‚¬">
        <span class="copy-icon">
          
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
</svg>
        </span>
        <span class="copy-text hidden sm:inline"
          >ë³µì‚¬</span
        >
      </button>
    </div>
  </div>

  
  <div class="code-block-content relative" id="code-14">
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="ln">1</span><span class="cl"><span class="c1"># Assume tokenized to shape [B, 8192]</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="c1"># Split into 512-token windows â†’ 16ê°œ window</span>
</span></span><span class="line"><span class="ln">3</span><span class="cl"><span class="n">x_windows</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">input_tensor</span><span class="p">,</span> <span class="mi">512</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># ê° window: [B, 512, D]</span></span></span></code></pre></div>
    
    <div
      class="collapse-overlay to-card/90 pointer-events-none absolute inset-0 bg-gradient-to-b from-transparent via-transparent opacity-0 transition-opacity duration-300">
      <div
        class="text-muted-foreground bg-card/80 border-border/50 hover:bg-primary/10 hover:text-primary hover:border-primary/30 absolute bottom-4 left-1/2 -translate-x-1/2 cursor-pointer rounded-full border px-3 py-1.5 text-xs backdrop-blur-sm transition-all duration-200">
        í´ë¦­í•˜ì—¬ ë” ë³´ê¸°
      </div>
    </div>
  </div>
</div>


<script>
(function() {
  const codeId = 'code-14';
  const copyBtn = document.querySelector('.copy-code-btn[data-code-id="' + codeId + '"]');
  const collapseBtn = document.querySelector('.collapse-code-btn[data-code-id="' + codeId + '"]');
  const codeContainer = document.getElementById(codeId);

  if (!codeContainer) return;

  
  if (copyBtn) {
    const copyIcon = copyBtn.querySelector('.copy-icon');
    const copyText = copyBtn.querySelector('.copy-text');

    copyBtn.addEventListener('click', async function() {
      try {
        
        let codeText = '';

        
        const codeTableCell = codeContainer.querySelector('.lntd:last-child code');
        if (codeTableCell) {
          codeText = codeTableCell.textContent || codeTableCell.innerText;
        } else {
          
          const codeElement = codeContainer.querySelector('code');
          if (codeElement) {
            
            const hasInlineLineNumbers = codeElement.querySelector('.ln');
            if (hasInlineLineNumbers) {
              
              const codeLines = codeElement.querySelectorAll('.cl');
              if (codeLines.length > 0) {
                codeText = Array.from(codeLines)
                  .map(line => {
                    const text = line.textContent || line.innerText;
                    
                    return text.replace(/\n+$/, '');
                  })
                  .join('\n')
                  .replace(/\n+$/, ''); 
              } else {
                
                const allText = codeElement.textContent || codeElement.innerText;
                codeText = allText.replace(/^\d+/gm, '').replace(/^\s+/gm, '');
              }
            } else {
              
              codeText = codeElement.textContent || codeElement.innerText;
            }
          } else {
            
            codeText = codeContainer.textContent || codeContainer.innerText;
          }
        }

        
        codeText = codeText.trim();

        
        await navigator.clipboard.writeText(codeText);

        
        copyIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M5 13l4 4L19 7\u0022 \/\u003e\n\u003c\/svg\u003e`;
        if (copyText) {
          copyText.textContent = 'ë³µì‚¬ë¨';
        }
        copyBtn.classList.add('text-green-600');

        
        setTimeout(() => {
          copyIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z\u0022 \/\u003e\n\u003c\/svg\u003e`;
          if (copyText) {
            copyText.textContent = 'ë³µì‚¬';
          }
          copyBtn.classList.remove('text-green-600');
        }, 2000);

      } catch (err) {
        console.error('å¤åˆ¶å¤±è´¥:', err);

        
        const range = document.createRange();
        const codeElement = codeContainer.querySelector('code') || codeContainer;
        range.selectNodeContents(codeElement);
        const selection = window.getSelection();
        selection.removeAllRanges();
        selection.addRange(range);

        
        if (copyText) {
          copyText.textContent = 'ì„ íƒë¨';
        }

        setTimeout(() => {
          if (copyText) {
            copyText.textContent = 'ë³µì‚¬';
          }
          selection.removeAllRanges();
        }, 2000);
      }
    });
  }

  
  if (collapseBtn) {
    const collapseIcon = collapseBtn.querySelector('.collapse-icon');
    const collapseText = collapseBtn.querySelector('.collapse-text');
    const collapseOverlay = codeContainer.querySelector('.collapse-overlay');

    
    let codeElement = codeContainer.querySelector('pre.chroma');
    if (!codeElement) {
      codeElement = codeContainer.querySelector('pre');
    }

    const defaultState = collapseBtn.dataset.defaultState || 'expanded';
    const isCollapsedAttr = collapseBtn.dataset.collapsed === 'true';
    const autoCollapseLines = parseInt(collapseBtn.dataset.autoCollapseLines) || 30;
    const autoCollapseHeight = parseInt(collapseBtn.dataset.autoCollapseHeight) || 400;
    const collapsedHeight = parseInt(collapseBtn.dataset.collapsedHeight) || 120;

    let isCollapsed = false;

    
    function initCollapse() {
      
      const shouldCollapse = isCollapsedAttr ||
                           defaultState === 'collapsed' ||
                           shouldAutoCollapse();

      if (shouldCollapse) {
        setCollapsed(true, false); 
      }
    }

    function shouldAutoCollapse() {
      
      if (codeElement) {
        const lines = codeElement.querySelectorAll('.line, .cl');
        const height = codeElement.offsetHeight;
        return lines.length > autoCollapseLines || height > autoCollapseHeight;
      }

      
      const containerHeight = codeContainer.offsetHeight;
      if (containerHeight > autoCollapseHeight) {
        return true;
      }

      
      const textContent = codeContainer.textContent || codeContainer.innerText || '';
      const estimatedLines = textContent.split('\n').length;
      return estimatedLines > autoCollapseLines;
    }

    function setCollapsed(collapsed, animate = true) {
      if (!collapseOverlay) return;

      isCollapsed = collapsed;

      if (collapsed) {
        
        codeContainer.style.maxHeight = collapsedHeight + 'px';
        codeContainer.style.overflow = 'hidden';
        collapseOverlay.style.opacity = '1';
        collapseOverlay.style.pointerEvents = 'auto';

        
        collapseIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M19 9l-7 7-7-7\u0022 \/\u003e\n\u003c\/svg\u003e`;
        if (collapseText) {
          collapseText.textContent = 'í¼ì¹˜ê¸°';
        }
        collapseBtn.title = 'í¼ì¹˜ê¸°';

      } else {
        
        codeContainer.style.maxHeight = '';
        codeContainer.style.overflow = '';
        collapseOverlay.style.opacity = '0';
        collapseOverlay.style.pointerEvents = 'none';

        
        collapseIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath fill=\u0022currentColor\u0022 d=\u0022M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z\u0022\/\u003e\u003c\/svg\u003e`;
        if (collapseText) {
          collapseText.textContent = 'ì ‘ê¸°';
        }
        collapseBtn.title = 'ì ‘ê¸°';
      }

      
      if (animate) {
        codeContainer.style.transition = 'max-height 0.3s ease-out';
        setTimeout(() => {
          codeContainer.style.transition = '';
        }, 300);
      }
    }

    function toggleCollapse() {
      setCollapsed(!isCollapsed, true);
    }

    
    collapseBtn.addEventListener('click', toggleCollapse);

    
    if (collapseOverlay) {
      collapseOverlay.addEventListener('click', () => {
        if (isCollapsed) {
          setCollapsed(false, true);
        }
      });
    }

    
    initCollapse();
  }
})();
</script>
<p>ì´ <code>x_windows</code>ëŠ” <code>MELODIBlock</code>ì— ì „ë‹¬ë©ë‹ˆë‹¤.</p>
<hr>
<h2 id="-ì¶”ë¡ -íë¦„-forward-logic-ì˜ˆì‹œ">ğŸ§  ì¶”ë¡  íë¦„ (forward logic ì˜ˆì‹œ)</h2>
<div
  class="code-block-container border-border bg-card my-6 overflow-hidden rounded-xl border shadow-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:shadow-md">
  
  <div
    class="code-block-header bg-muted/30 border-border flex items-center justify-between border-b px-4 py-3">
    
    <div class="flex items-center gap-2">
      <div class="text-muted-foreground flex-shrink-0">
        
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4" />
</svg>
      </div>
      <span class="text-muted-foreground text-sm font-medium">
        PYTHON
      </span>
    </div>

    
    <div class="flex items-center gap-2">
      <button
          class="collapse-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none"
          data-code-id="code-15"
          data-default-state="expanded"
          data-collapsed="false"
          data-auto-collapse-lines="30"
          data-auto-collapse-height="400"
          data-collapsed-height="120"
          title="ì ‘ê¸°"
          aria-label="ì ‘ê¸°">
          <span class="collapse-icon">
            
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z"/></svg>
          </span>
          <span class="collapse-text hidden sm:inline"
            >ì ‘ê¸°</span
          >
        </button>
      <button
        class="copy-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none"
        data-code-id="code-15"
        title="ë³µì‚¬"
        aria-label="ë³µì‚¬">
        <span class="copy-icon">
          
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
</svg>
        </span>
        <span class="copy-text hidden sm:inline"
          >ë³µì‚¬</span
        >
      </button>
    </div>
  </div>

  
  <div class="code-block-content relative" id="code-15">
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="ln">1</span><span class="cl"><span class="n">melodi</span> <span class="o">=</span> <span class="n">MELODIBlock</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">1024</span><span class="p">,</span> <span class="n">num_heads</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="n">output</span> <span class="o">=</span> <span class="n">melodi</span><span class="p">(</span><span class="n">x_seq_list</span><span class="o">=</span><span class="n">x_windows</span><span class="p">)</span></span></span></code></pre></div>
    
    <div
      class="collapse-overlay to-card/90 pointer-events-none absolute inset-0 bg-gradient-to-b from-transparent via-transparent opacity-0 transition-opacity duration-300">
      <div
        class="text-muted-foreground bg-card/80 border-border/50 hover:bg-primary/10 hover:text-primary hover:border-primary/30 absolute bottom-4 left-1/2 -translate-x-1/2 cursor-pointer rounded-full border px-3 py-1.5 text-xs backdrop-blur-sm transition-all duration-200">
        í´ë¦­í•˜ì—¬ ë” ë³´ê¸°
      </div>
    </div>
  </div>
</div>


<script>
(function() {
  const codeId = 'code-15';
  const copyBtn = document.querySelector('.copy-code-btn[data-code-id="' + codeId + '"]');
  const collapseBtn = document.querySelector('.collapse-code-btn[data-code-id="' + codeId + '"]');
  const codeContainer = document.getElementById(codeId);

  if (!codeContainer) return;

  
  if (copyBtn) {
    const copyIcon = copyBtn.querySelector('.copy-icon');
    const copyText = copyBtn.querySelector('.copy-text');

    copyBtn.addEventListener('click', async function() {
      try {
        
        let codeText = '';

        
        const codeTableCell = codeContainer.querySelector('.lntd:last-child code');
        if (codeTableCell) {
          codeText = codeTableCell.textContent || codeTableCell.innerText;
        } else {
          
          const codeElement = codeContainer.querySelector('code');
          if (codeElement) {
            
            const hasInlineLineNumbers = codeElement.querySelector('.ln');
            if (hasInlineLineNumbers) {
              
              const codeLines = codeElement.querySelectorAll('.cl');
              if (codeLines.length > 0) {
                codeText = Array.from(codeLines)
                  .map(line => {
                    const text = line.textContent || line.innerText;
                    
                    return text.replace(/\n+$/, '');
                  })
                  .join('\n')
                  .replace(/\n+$/, ''); 
              } else {
                
                const allText = codeElement.textContent || codeElement.innerText;
                codeText = allText.replace(/^\d+/gm, '').replace(/^\s+/gm, '');
              }
            } else {
              
              codeText = codeElement.textContent || codeElement.innerText;
            }
          } else {
            
            codeText = codeContainer.textContent || codeContainer.innerText;
          }
        }

        
        codeText = codeText.trim();

        
        await navigator.clipboard.writeText(codeText);

        
        copyIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M5 13l4 4L19 7\u0022 \/\u003e\n\u003c\/svg\u003e`;
        if (copyText) {
          copyText.textContent = 'ë³µì‚¬ë¨';
        }
        copyBtn.classList.add('text-green-600');

        
        setTimeout(() => {
          copyIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z\u0022 \/\u003e\n\u003c\/svg\u003e`;
          if (copyText) {
            copyText.textContent = 'ë³µì‚¬';
          }
          copyBtn.classList.remove('text-green-600');
        }, 2000);

      } catch (err) {
        console.error('å¤åˆ¶å¤±è´¥:', err);

        
        const range = document.createRange();
        const codeElement = codeContainer.querySelector('code') || codeContainer;
        range.selectNodeContents(codeElement);
        const selection = window.getSelection();
        selection.removeAllRanges();
        selection.addRange(range);

        
        if (copyText) {
          copyText.textContent = 'ì„ íƒë¨';
        }

        setTimeout(() => {
          if (copyText) {
            copyText.textContent = 'ë³µì‚¬';
          }
          selection.removeAllRanges();
        }, 2000);
      }
    });
  }

  
  if (collapseBtn) {
    const collapseIcon = collapseBtn.querySelector('.collapse-icon');
    const collapseText = collapseBtn.querySelector('.collapse-text');
    const collapseOverlay = codeContainer.querySelector('.collapse-overlay');

    
    let codeElement = codeContainer.querySelector('pre.chroma');
    if (!codeElement) {
      codeElement = codeContainer.querySelector('pre');
    }

    const defaultState = collapseBtn.dataset.defaultState || 'expanded';
    const isCollapsedAttr = collapseBtn.dataset.collapsed === 'true';
    const autoCollapseLines = parseInt(collapseBtn.dataset.autoCollapseLines) || 30;
    const autoCollapseHeight = parseInt(collapseBtn.dataset.autoCollapseHeight) || 400;
    const collapsedHeight = parseInt(collapseBtn.dataset.collapsedHeight) || 120;

    let isCollapsed = false;

    
    function initCollapse() {
      
      const shouldCollapse = isCollapsedAttr ||
                           defaultState === 'collapsed' ||
                           shouldAutoCollapse();

      if (shouldCollapse) {
        setCollapsed(true, false); 
      }
    }

    function shouldAutoCollapse() {
      
      if (codeElement) {
        const lines = codeElement.querySelectorAll('.line, .cl');
        const height = codeElement.offsetHeight;
        return lines.length > autoCollapseLines || height > autoCollapseHeight;
      }

      
      const containerHeight = codeContainer.offsetHeight;
      if (containerHeight > autoCollapseHeight) {
        return true;
      }

      
      const textContent = codeContainer.textContent || codeContainer.innerText || '';
      const estimatedLines = textContent.split('\n').length;
      return estimatedLines > autoCollapseLines;
    }

    function setCollapsed(collapsed, animate = true) {
      if (!collapseOverlay) return;

      isCollapsed = collapsed;

      if (collapsed) {
        
        codeContainer.style.maxHeight = collapsedHeight + 'px';
        codeContainer.style.overflow = 'hidden';
        collapseOverlay.style.opacity = '1';
        collapseOverlay.style.pointerEvents = 'auto';

        
        collapseIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M19 9l-7 7-7-7\u0022 \/\u003e\n\u003c\/svg\u003e`;
        if (collapseText) {
          collapseText.textContent = 'í¼ì¹˜ê¸°';
        }
        collapseBtn.title = 'í¼ì¹˜ê¸°';

      } else {
        
        codeContainer.style.maxHeight = '';
        codeContainer.style.overflow = '';
        collapseOverlay.style.opacity = '0';
        collapseOverlay.style.pointerEvents = 'none';

        
        collapseIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath fill=\u0022currentColor\u0022 d=\u0022M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z\u0022\/\u003e\u003c\/svg\u003e`;
        if (collapseText) {
          collapseText.textContent = 'ì ‘ê¸°';
        }
        collapseBtn.title = 'ì ‘ê¸°';
      }

      
      if (animate) {
        codeContainer.style.transition = 'max-height 0.3s ease-out';
        setTimeout(() => {
          codeContainer.style.transition = '';
        }, 300);
      }
    }

    function toggleCollapse() {
      setCollapsed(!isCollapsed, true);
    }

    
    collapseBtn.addEventListener('click', toggleCollapse);

    
    if (collapseOverlay) {
      collapseOverlay.addEventListener('click', () => {
        if (isCollapsed) {
          setCollapsed(false, true);
        }
      });
    }

    
    initCollapse();
  }
})();
</script>
<h3 id="ë‚´ë¶€-ì²˜ë¦¬-ìˆœì„œ">ë‚´ë¶€ ì²˜ë¦¬ ìˆœì„œ</h3>
<ol>
<li>
<p><code>ShortTermLayer</code>ëŠ” ê° windowë§ˆë‹¤ 512-tokenì„ ì²˜ë¦¬í•˜ë©´ì„œ</p>
<ul>
<li>ì´ì „ windowì—ì„œ ì „ë‹¬ë°›ì€ <code>z_{k-1}</code> memory ì‚¬ìš©</li>
<li>summary tokenì„ ë§Œë“¤ì–´ ë‹¤ìŒ layer/ë‹¤ìŒ windowë¡œ ì „ë‹¬</li>
</ul>
</li>
<li>
<p><code>LongTermMemoryLayer</code> (ì˜ˆ: 7ë²ˆì§¸ layer)ì—ì„œëŠ”</p>
<ul>
<li>ì§€ê¸ˆê¹Œì§€ ì €ì¥ëœ long-term memory (<code>mâ‚:â‚–â‚‹â‚</code>)ì— ëŒ€í•´ cross-attention ìˆ˜í–‰</li>
<li>window ì „ì²´ë¥¼ ì••ì¶•í•´ì„œ 64ê°œ long-token ìƒì„± â†’ ë©”ëª¨ë¦¬ bankì— ì¶”ê°€</li>
</ul>
</li>
<li>
<p>ë§ˆì§€ë§‰ê¹Œì§€ ì²˜ë¦¬ëœ <code>x_k</code>ëŠ” ì¶œë ¥ìœ¼ë¡œ ì‚¬ìš©ë¨</p>
</li>
</ol>
<hr>
<h2 id="-ëª¨ë¸-ì•„í‚¤í…ì²˜-êµ¬ì„±">ğŸ—ï¸ ëª¨ë¸ ì•„í‚¤í…ì²˜ êµ¬ì„±</h2>
<table>
  <thead>
      <tr>
          <th>êµ¬ì„± ìš”ì†Œ</th>
          <th>ìˆ˜ì¹˜ (ê¸°ì¤€ config)</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>ì´ layers</td>
          <td>13</td>
      </tr>
      <tr>
          <td>ShortTermLayer</td>
          <td>8 (e.g., layer 0<del>3, 5</del>6, 8, 10)</td>
      </tr>
      <tr>
          <td>LongTermLayer</td>
          <td>1 (ì˜ˆ: layer 7)</td>
      </tr>
      <tr>
          <td>dim (hidden size)</td>
          <td>1024</td>
      </tr>
      <tr>
          <td>attention heads</td>
          <td>8</td>
      </tr>
      <tr>
          <td>context window size</td>
          <td>512 tokens</td>
      </tr>
      <tr>
          <td>summary token ìˆ˜</td>
          <td>128</td>
      </tr>
      <tr>
          <td>long token ìˆ˜</td>
          <td>64</td>
      </tr>
      <tr>
          <td>long mem depth</td>
          <td>128 windows</td>
      </tr>
  </tbody>
</table>
<hr>
<h2 id="-ë©”ëª¨ë¦¬-ìš”êµ¬ëŸ‰-ê³„ì‚°">ğŸ’¾ ë©”ëª¨ë¦¬ ìš”êµ¬ëŸ‰ ê³„ì‚°</h2>
<h3 id="1-short-term-memory">1. Short-Term Memory</h3>
<ul>
<li>zâ‚–: 128 tokens/layer Ã— 8 layers Ã— 1024 dim = <strong>1,048,576 float</strong></li>
<li>= 4.0MB (FP32) or 2.0MB (FP16)</li>
</ul>
<h3 id="2-long-term-memory">2. Long-Term Memory</h3>
<ul>
<li>64 tokens Ã— 2 (KV) Ã— 1024 dim Ã— 128 windows = <strong>16,777,216 float</strong></li>
<li>= 64.0MB (FP32) or 32.0MB (FP16)</li>
</ul>
<h3 id="3-inputactivation-buffer-xâ‚–-16-windows">3. Input/Activation buffer (xâ‚–: 16 windows)</h3>
<ul>
<li>512 Ã— 16 Ã— 1024 = 8,388,608 float = <strong>32MB</strong> (FP32)</li>
</ul>
<p>ğŸ“Œ <strong>ì´ ë©”ëª¨ë¦¬</strong> (FP16 ê¸°ì¤€, ì¶”ë¡  ì‹œ):</p>
<div
  class="code-block-container border-border bg-card my-6 overflow-hidden rounded-xl border shadow-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:shadow-md">
  
  <div
    class="code-block-header bg-muted/30 border-border flex items-center justify-between border-b px-4 py-3">
    
    <div class="flex items-center gap-2">
      <div class="text-muted-foreground flex-shrink-0">
        
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4" />
</svg>
      </div>
      <span class="text-muted-foreground text-sm font-medium">
        PLAINTEXT
      </span>
    </div>

    
    <div class="flex items-center gap-2">
      <button
          class="collapse-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none"
          data-code-id="code-16"
          data-default-state="expanded"
          data-collapsed="false"
          data-auto-collapse-lines="30"
          data-auto-collapse-height="400"
          data-collapsed-height="120"
          title="ì ‘ê¸°"
          aria-label="ì ‘ê¸°">
          <span class="collapse-icon">
            
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z"/></svg>
          </span>
          <span class="collapse-text hidden sm:inline"
            >ì ‘ê¸°</span
          >
        </button>
      <button
        class="copy-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none"
        data-code-id="code-16"
        title="ë³µì‚¬"
        aria-label="ë³µì‚¬">
        <span class="copy-icon">
          
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
</svg>
        </span>
        <span class="copy-text hidden sm:inline"
          >ë³µì‚¬</span
        >
      </button>
    </div>
  </div>

  
  <div class="code-block-content relative" id="code-16">
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">â‰ˆ 2MB (STM) + 32MB (LTM) + 16MB (x buffer) = **50MB ìˆ˜ì¤€**</span></span></code></pre></div>
    
    <div
      class="collapse-overlay to-card/90 pointer-events-none absolute inset-0 bg-gradient-to-b from-transparent via-transparent opacity-0 transition-opacity duration-300">
      <div
        class="text-muted-foreground bg-card/80 border-border/50 hover:bg-primary/10 hover:text-primary hover:border-primary/30 absolute bottom-4 left-1/2 -translate-x-1/2 cursor-pointer rounded-full border px-3 py-1.5 text-xs backdrop-blur-sm transition-all duration-200">
        í´ë¦­í•˜ì—¬ ë” ë³´ê¸°
      </div>
    </div>
  </div>
</div>


<script>
(function() {
  const codeId = 'code-16';
  const copyBtn = document.querySelector('.copy-code-btn[data-code-id="' + codeId + '"]');
  const collapseBtn = document.querySelector('.collapse-code-btn[data-code-id="' + codeId + '"]');
  const codeContainer = document.getElementById(codeId);

  if (!codeContainer) return;

  
  if (copyBtn) {
    const copyIcon = copyBtn.querySelector('.copy-icon');
    const copyText = copyBtn.querySelector('.copy-text');

    copyBtn.addEventListener('click', async function() {
      try {
        
        let codeText = '';

        
        const codeTableCell = codeContainer.querySelector('.lntd:last-child code');
        if (codeTableCell) {
          codeText = codeTableCell.textContent || codeTableCell.innerText;
        } else {
          
          const codeElement = codeContainer.querySelector('code');
          if (codeElement) {
            
            const hasInlineLineNumbers = codeElement.querySelector('.ln');
            if (hasInlineLineNumbers) {
              
              const codeLines = codeElement.querySelectorAll('.cl');
              if (codeLines.length > 0) {
                codeText = Array.from(codeLines)
                  .map(line => {
                    const text = line.textContent || line.innerText;
                    
                    return text.replace(/\n+$/, '');
                  })
                  .join('\n')
                  .replace(/\n+$/, ''); 
              } else {
                
                const allText = codeElement.textContent || codeElement.innerText;
                codeText = allText.replace(/^\d+/gm, '').replace(/^\s+/gm, '');
              }
            } else {
              
              codeText = codeElement.textContent || codeElement.innerText;
            }
          } else {
            
            codeText = codeContainer.textContent || codeContainer.innerText;
          }
        }

        
        codeText = codeText.trim();

        
        await navigator.clipboard.writeText(codeText);

        
        copyIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M5 13l4 4L19 7\u0022 \/\u003e\n\u003c\/svg\u003e`;
        if (copyText) {
          copyText.textContent = 'ë³µì‚¬ë¨';
        }
        copyBtn.classList.add('text-green-600');

        
        setTimeout(() => {
          copyIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z\u0022 \/\u003e\n\u003c\/svg\u003e`;
          if (copyText) {
            copyText.textContent = 'ë³µì‚¬';
          }
          copyBtn.classList.remove('text-green-600');
        }, 2000);

      } catch (err) {
        console.error('å¤åˆ¶å¤±è´¥:', err);

        
        const range = document.createRange();
        const codeElement = codeContainer.querySelector('code') || codeContainer;
        range.selectNodeContents(codeElement);
        const selection = window.getSelection();
        selection.removeAllRanges();
        selection.addRange(range);

        
        if (copyText) {
          copyText.textContent = 'ì„ íƒë¨';
        }

        setTimeout(() => {
          if (copyText) {
            copyText.textContent = 'ë³µì‚¬';
          }
          selection.removeAllRanges();
        }, 2000);
      }
    });
  }

  
  if (collapseBtn) {
    const collapseIcon = collapseBtn.querySelector('.collapse-icon');
    const collapseText = collapseBtn.querySelector('.collapse-text');
    const collapseOverlay = codeContainer.querySelector('.collapse-overlay');

    
    let codeElement = codeContainer.querySelector('pre.chroma');
    if (!codeElement) {
      codeElement = codeContainer.querySelector('pre');
    }

    const defaultState = collapseBtn.dataset.defaultState || 'expanded';
    const isCollapsedAttr = collapseBtn.dataset.collapsed === 'true';
    const autoCollapseLines = parseInt(collapseBtn.dataset.autoCollapseLines) || 30;
    const autoCollapseHeight = parseInt(collapseBtn.dataset.autoCollapseHeight) || 400;
    const collapsedHeight = parseInt(collapseBtn.dataset.collapsedHeight) || 120;

    let isCollapsed = false;

    
    function initCollapse() {
      
      const shouldCollapse = isCollapsedAttr ||
                           defaultState === 'collapsed' ||
                           shouldAutoCollapse();

      if (shouldCollapse) {
        setCollapsed(true, false); 
      }
    }

    function shouldAutoCollapse() {
      
      if (codeElement) {
        const lines = codeElement.querySelectorAll('.line, .cl');
        const height = codeElement.offsetHeight;
        return lines.length > autoCollapseLines || height > autoCollapseHeight;
      }

      
      const containerHeight = codeContainer.offsetHeight;
      if (containerHeight > autoCollapseHeight) {
        return true;
      }

      
      const textContent = codeContainer.textContent || codeContainer.innerText || '';
      const estimatedLines = textContent.split('\n').length;
      return estimatedLines > autoCollapseLines;
    }

    function setCollapsed(collapsed, animate = true) {
      if (!collapseOverlay) return;

      isCollapsed = collapsed;

      if (collapsed) {
        
        codeContainer.style.maxHeight = collapsedHeight + 'px';
        codeContainer.style.overflow = 'hidden';
        collapseOverlay.style.opacity = '1';
        collapseOverlay.style.pointerEvents = 'auto';

        
        collapseIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M19 9l-7 7-7-7\u0022 \/\u003e\n\u003c\/svg\u003e`;
        if (collapseText) {
          collapseText.textContent = 'í¼ì¹˜ê¸°';
        }
        collapseBtn.title = 'í¼ì¹˜ê¸°';

      } else {
        
        codeContainer.style.maxHeight = '';
        codeContainer.style.overflow = '';
        collapseOverlay.style.opacity = '0';
        collapseOverlay.style.pointerEvents = 'none';

        
        collapseIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath fill=\u0022currentColor\u0022 d=\u0022M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z\u0022\/\u003e\u003c\/svg\u003e`;
        if (collapseText) {
          collapseText.textContent = 'ì ‘ê¸°';
        }
        collapseBtn.title = 'ì ‘ê¸°';
      }

      
      if (animate) {
        codeContainer.style.transition = 'max-height 0.3s ease-out';
        setTimeout(() => {
          codeContainer.style.transition = '';
        }, 300);
      }
    }

    function toggleCollapse() {
      setCollapsed(!isCollapsed, true);
    }

    
    collapseBtn.addEventListener('click', toggleCollapse);

    
    if (collapseOverlay) {
      collapseOverlay.addEventListener('click', () => {
        if (isCollapsed) {
          setCollapsed(false, true);
        }
      });
    }

    
    initCollapse();
  }
})();
</script>
<hr>
<h2 id="-ì—°ì‚°ëŸ‰-flops-ê¸°ì¤€-ë‹¨ì¼-window-ì²˜ë¦¬-ê¸°ì¤€">âš™ï¸ ì—°ì‚°ëŸ‰ (FLOPs ê¸°ì¤€, ë‹¨ì¼ window ì²˜ë¦¬ ê¸°ì¤€)</h2>
<h3 id="1-shorttermlayer--8-layers">1. ShortTermLayer Ã— 8 layers</h3>
<ul>
<li>Self-attn: O((512+128)Â² Ã— 1024) â‰ˆ 0.4G FLOPs/layer</li>
<li>FFN: 512 Ã— 1024 Ã— 4 Ã— 1024 Ã— 2 â‰ˆ 4.2G FLOPs/layer</li>
<li>TokenMixer: 2 Ã— 640 Ã— 128 Ã— 1024 â‰ˆ 0.17G FLOPs/layer</li>
</ul>
<p>â†’ ì´ â‰ˆ <strong>~4.7G Ã— 8 = 37.6 GFLOPs</strong></p>
<h3 id="2-longtermlayer-1-layer">2. LongTermLayer (1 layer)</h3>
<ul>
<li>cross-attn: 512 Ã— 8192 Ã— 1024 â‰ˆ 4.3G FLOPs</li>
<li>token mixer (LTM): â‰ˆ 0.08G FLOPs</li>
</ul>
<p>â†’ ì´ â‰ˆ <strong>~4.4 GFLOPs</strong></p>
<p>ğŸ“Œ <strong>ì´ ì¶”ë¡  ì—°ì‚°ëŸ‰ â‰ˆ 42 GFLOPs / window</strong>
â†’ 16ê°œ window â†’ â‰ˆ <strong>670 GFLOPs</strong> (long-context ì¶”ë¡  ê¸°ì¤€)</p>
<hr>
<h2 id="-ìš”ì•½-ì •ë¦¬">âœ… ìš”ì•½ ì •ë¦¬</h2>
<table>
  <thead>
      <tr>
          <th>í•­ëª©</th>
          <th>ìˆ˜ì¹˜ / ì„¤ëª…</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>ì…ë ¥ êµ¬ì¡°</td>
          <td>[B, 8192, 1024] â†’ 16 window ë¶„í• </td>
      </tr>
      <tr>
          <td>ì—°ì‚° êµ¬ì„±</td>
          <td>13-layer Transformer (SM + LM í˜¼í•©)</td>
      </tr>
      <tr>
          <td>ë©”ëª¨ë¦¬ ìš”êµ¬ëŸ‰ (FP16)</td>
          <td>ì•½ <strong>50MB</strong></td>
      </tr>
      <tr>
          <td>ì—°ì‚°ëŸ‰ (ì¶”ë¡  ì „ì²´)</td>
          <td>ì•½ <strong>670 GFLOPs</strong></td>
      </tr>
      <tr>
          <td>íŠ¹ì§•</td>
          <td>- SMìœ¼ë¡œ layer ê°„ ì •ë³´ íë¦„<br>- LMìœ¼ë¡œ window ê°„ ì •ë³´ ì••ì¶• ì „ë‹¬<br>- ë†’ì€ ì„±ëŠ¥ ëŒ€ë¹„ ì ì€ ë©”ëª¨ë¦¬</td>
      </tr>
  </tbody>
</table>
<h1 id="q--ì´-ë…¼ë¬¸ì˜-í•œê³„ë¥¼-ê·¹ë³µí•˜ê¸°-ìœ„í•œ-ë°©ë²•ìœ¼ë¡œ-ì–´ë–¤-ì—°êµ¬íë¦„ì´-ìˆëŠ”ì§€-ì •ë¦¬í•´ì„œ-ìì„¸í•˜ê²Œ-ì„¤ëª…í•´-ì¤˜">Q : ì´ ë…¼ë¬¸ì˜ í•œê³„ë¥¼ ê·¹ë³µí•˜ê¸° ìœ„í•œ ë°©ë²•ìœ¼ë¡œ ì–´ë–¤ ì—°êµ¬íë¦„ì´ ìˆëŠ”ì§€ ì •ë¦¬í•´ì„œ ìì„¸í•˜ê²Œ ì„¤ëª…í•´ ì¤˜</h1>
<p>MELODIëŠ” ë›°ì–´ë‚œ íš¨ìœ¨ê³¼ ì„±ëŠ¥ì„ ë³´ì—¬ì£¼ëŠ” êµ¬ì¡°ì´ì§€ë§Œ, ë…¼ë¬¸ì—ì„œë„ ì¼ë¶€ <strong>í•œê³„ì </strong>ì„ ëª…ì‹œí•˜ê³  ìˆìŠµë‹ˆë‹¤. ì—¬ê¸°ì— ê¸°ë°˜í•˜ì—¬, í•´ë‹¹ í•œê³„ë¥¼ ê·¹ë³µí•˜ê¸° ìœ„í•œ <strong>ì—°êµ¬ íë¦„ ë° ì•„ì´ë””ì–´</strong>ë¥¼ ë‹¤ìŒê³¼ ê°™ì´ ì •ë¦¬í•´ ë“œë¦¬ê² ìŠµë‹ˆë‹¤:</p>
<hr>
<h2 id="-melodiì˜-í•µì‹¬-í•œê³„">âœ… MELODIì˜ í•µì‹¬ í•œê³„</h2>
<table>
  <thead>
      <tr>
          <th>êµ¬ë¶„</th>
          <th>ì„¤ëª…</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>1. Pretrained ëª¨ë¸ ì ìš© ë¶ˆê°€</td>
          <td>MELODIëŠ” í•™ìŠµì„ <strong>ì²˜ìŒë¶€í„°</strong> ì§„í–‰í•´ì•¼ í•˜ë©°, ê¸°ì¡´ ì‚¬ì „í•™ìŠµ ëª¨ë¸(GPT ë“±)ì— ì§ì ‘ ì ìš©ì´ ì–´ë µë‹¤.</td>
      </tr>
      <tr>
          <td>2. Fixed compression ratio</td>
          <td>SM/LMì—ì„œ ì‚¬ìš©í•˜ëŠ” token ìˆ˜ê°€ ê³ ì •ë˜ì–´ ìˆì–´, ë‹¤ì–‘í•œ ë¬¸ì„œ ê¸¸ì´ë‚˜ ë„ë©”ì¸ì— <strong>ìœ ì—°í•˜ê²Œ ëŒ€ì‘í•˜ì§€ ëª»í•¨</strong>.</td>
      </tr>
      <tr>
          <td>3. ì •ë³´ ì†ì‹¤ ê°€ëŠ¥ì„±</td>
          <td>ìš”ì•½ ê¸°ë°˜ ë©”ëª¨ë¦¬ëŠ” ì••ì¶• ê³¼ì •ì—ì„œ <strong>ì¤‘ìš” ì •ë³´ë¥¼ ëˆ„ë½</strong>í•  ìœ„í—˜ì´ ìˆë‹¤.</td>
      </tr>
      <tr>
          <td>4. ìˆœì°¨ ì¶”ë¡  êµ¬ì¡°</td>
          <td>window ê°„ ìˆœì°¨ì  ì¶”ë¡ ì´ í•„ìš”í•´, <strong>parallelismì´ ì œí•œ</strong>ëœë‹¤.</td>
      </tr>
  </tbody>
</table>
<hr>
<h2 id="-í•œê³„-ê·¹ë³µì„-ìœ„í•œ-ì—°êµ¬-íë¦„">ğŸ” í•œê³„ ê·¹ë³µì„ ìœ„í•œ ì—°êµ¬ íë¦„</h2>
<h3 id="1--pretrained-ëª¨ë¸ì—-melodi-memory-ì‚½ì…">1. ğŸ”„ Pretrained ëª¨ë¸ì— MELODI memory ì‚½ì…</h3>
<ul>
<li>
<p><strong>ì—°êµ¬ íë¦„</strong>: ê¸°ì¡´ ì‚¬ì „í•™ìŠµëœ ëª¨ë¸(GPT, LLaMA)ì— MELODI-style memory moduleì„ ì‚½ì…í•˜ëŠ” ë°©ì‹ (plug-and-play)</p>
</li>
<li>
<p><strong>ë°©ë²•</strong>: LoRA, Adapter, QLoRA ë“±ê³¼ ê²°í•©í•´ fine-tuning</p>
</li>
<li>
<p><strong>ì˜ˆì‹œ</strong>:</p>
<ul>
<li>ğŸ”¸Memory-Augmented Fine-tuning</li>
<li>ğŸ”¸Adapter with Memory Bank</li>
<li>ğŸ”¸Flash-Memory Injection (streamable memory)</li>
</ul>
</li>
</ul>
<p>â¡ï¸ <strong>ì ìš©ì„± ê°•í™” + íŒŒë¼ë¯¸í„° íš¨ìœ¨ì„± í™•ë³´</strong></p>
<hr>
<h3 id="2--adaptive-compression-memory-ì••ì¶•-ì ì‘í™”">2. ğŸ§  Adaptive Compression Memory (ì••ì¶• ì ì‘í™”)</h3>
<ul>
<li>
<p><strong>ì—°êµ¬ íë¦„</strong>: token importance scoreë¥¼ ê¸°ë°˜ìœ¼ë¡œ <strong>ìš”ì•½ ë¹„ìœ¨ì„ ë™ì ìœ¼ë¡œ ì¡°ì ˆ</strong></p>
</li>
<li>
<p><strong>ê´€ë ¨ ì—°êµ¬</strong>:</p>
<ul>
<li>ğŸ”¸AutoCompressor (Chevalier et al. 2023): attention-based token compression</li>
<li>ğŸ”¸ICAE (2024): adaptive context encoder with LoRA</li>
</ul>
</li>
<li>
<p><strong>ê°€ëŠ¥í•œ í™•ì¥</strong>:</p>
<ul>
<li>ì •ë³´ëŸ‰ ë§ì€ windowëŠ” ë” ë§ì€ long-token í• ë‹¹</li>
<li>summary token ìˆ˜ë¥¼ layer depthë‚˜ attention entropyì— ë”°ë¼ ë³€ê²½</li>
</ul>
</li>
</ul>
<p>â¡ï¸ <strong>ì •ë³´ ì†ì‹¤ ìµœì†Œí™” + ê³ íš¨ìœ¨ ìš”ì•½</strong></p>
<hr>
<h3 id="3--recursive-memory-compression">3. ğŸ” Recursive Memory Compression</h3>
<ul>
<li>
<p><strong>ê°œë…</strong>: LMì„ ë‹¨ì¼ì¸µì´ ì•„ë‹Œ ë‹¤ì¸µìœ¼ë¡œ êµ¬ì„±í•˜ê³ , ì˜¤ë˜ëœ memoryëŠ” <strong>ì¬ì••ì¶• (recompress)</strong> â†’ compact KV ìœ ì§€</p>
</li>
<li>
<p><strong>ì˜ê°</strong>: Compressive Transformer (Rae et al. 2019)</p>
</li>
<li>
<p><strong>ì ìš© ë°©ë²•</strong>:</p>
<ul>
<li>ì¼ì • window ì´ìƒ ì˜¤ë˜ëœ memory â†’ ë‹¤ì‹œ í•œ ë²ˆ token mixerì— ì…ë ¥í•˜ì—¬ ì¬ìš”ì•½</li>
<li>ê¸°ì¡´ FIFO â†’ multi-tier cache êµ¬ì¡°</li>
</ul>
</li>
</ul>
<p>â¡ï¸ <strong>long-context ìœ ì§€ ëŠ¥ë ¥ í–¥ìƒ + memory í­ì¦ ì–µì œ</strong></p>
<hr>
<h3 id="4--ë¹„ìˆœì°¨ì -memory-ì ‘ê·¼-ì§€ì›">4. âš¡ ë¹„ìˆœì°¨ì  memory ì ‘ê·¼ ì§€ì›</h3>
<ul>
<li>
<p><strong>ë¬¸ì œ</strong>: MELODIëŠ” window ìˆœì°¨ ì²˜ë¦¬ â†’ parallelization ì–´ë ¤ì›€</p>
</li>
<li>
<p><strong>í•´ê²° ë°©í–¥</strong>:</p>
<ul>
<li>long-term memoryëŠ” read-only + cross-attnë§Œ ìˆ˜í–‰í•˜ë„ë¡ ë§Œë“¤ë©´ ì—¬ëŸ¬ windowì—ì„œ ë³‘ë ¬ ì ‘ê·¼ ê°€ëŠ¥</li>
<li>memory indexingì„ positional RoPE ê¸°ë°˜ìœ¼ë¡œ ì •ê·œí™”í•˜ì—¬ ë¹„ìˆœì°¨ windowì—ë„ ëŒ€ì‘ ê°€ëŠ¥</li>
</ul>
</li>
</ul>
<p>â¡ï¸ <strong>ë©€í‹°-GPU ë˜ëŠ” ë¶„ì‚° ì¶”ë¡  íš¨ìœ¨ ê·¹ëŒ€í™”</strong></p>
<hr>
<h3 id="5--multi-modal-í™•ì¥">5. ğŸŒ Multi-modal í™•ì¥</h3>
<ul>
<li>
<p><strong>ë™ê¸°</strong>: MELODI êµ¬ì¡°ëŠ” modality-independent (ì••ì¶•/ë©”ëª¨ë¦¬ ë°©ì‹ì€ text ì™¸ì—ë„ ì ìš© ê°€ëŠ¥)</p>
</li>
<li>
<p><strong>ì ìš© ê°€ëŠ¥ ì˜ì—­</strong>:</p>
<ul>
<li>ì˜ìƒ/ìŒì„±ì˜ temporal compression</li>
<li>multi-modal summary token (ì˜ˆ: vision-text)</li>
</ul>
</li>
</ul>
<p>â¡ï¸ <strong>GEMINI-style ëª¨ë¸ì—ì„œ íš¨ìœ¨ì  long-memory êµ¬ì„± ê°€ëŠ¥</strong></p>
<hr>
<h2 id="-ì¢…í•©-ì •ë¦¬-ì—°êµ¬-ë°©í–¥-ë§¤í•‘">ğŸ§© ì¢…í•© ì •ë¦¬: ì—°êµ¬ ë°©í–¥ ë§¤í•‘</h2>
<table>
  <thead>
      <tr>
          <th>í•œê³„</th>
          <th>ê·¹ë³µ ì—°êµ¬ íë¦„</th>
          <th>ëŒ€í‘œ ì•„ì´ë””ì–´</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>Pretrained ë¶ˆê°€</td>
          <td>Memory-finetune, LoRA</td>
          <td>memory-injection</td>
      </tr>
      <tr>
          <td>ê³ ì • ì••ì¶•ë¹„</td>
          <td>Adaptive compression</td>
          <td>token importance â†’ compression ratio</td>
      </tr>
      <tr>
          <td>ì •ë³´ ì†ì‹¤</td>
          <td>Multi-pass summarization</td>
          <td>ì¬ìš”ì•½ / ì •ë³´ ì„ íƒ</td>
      </tr>
      <tr>
          <td>ìˆœì°¨ì  êµ¬ì¡°</td>
          <td>Memory-as-Cache ë°©ì‹</td>
          <td>long-memory ë³‘ë ¬ ì ‘ê·¼</td>
      </tr>
      <tr>
          <td>ë„ë©”ì¸ ê³ ì •</td>
          <td>Multi-modal í™•ì¥</td>
          <td>ìš”ì•½ ë°©ì‹ ì¼ë°˜í™”</td>
      </tr>
  </tbody>
</table>
<h1 id="q--melodiì˜-short-term-memoryì™€-long-term-memoryëŠ”-ê°ê°-ì–´ë–¤-ë°©ì‹ìœ¼ë¡œ-ì •ë³´ë¥¼-ì••ì¶•í•˜ê³ -ì „ë‹¬í•˜ë©°-ì´-êµ¬ì¡°ê°€-ê¸°ì¡´-memory-augmented-transformerë“¤ê³¼-ë¹„êµí•´-ì–´ë–¤-ì´ì ì„-ì œê³µí•˜ëŠ”ê°€">Q : MELODIì˜ short-term memoryì™€ long-term memoryëŠ” ê°ê° ì–´ë–¤ ë°©ì‹ìœ¼ë¡œ ì •ë³´ë¥¼ ì••ì¶•í•˜ê³  ì „ë‹¬í•˜ë©°, ì´ êµ¬ì¡°ê°€ ê¸°ì¡´ memory-augmented transformerë“¤ê³¼ ë¹„êµí•´ ì–´ë–¤ ì´ì ì„ ì œê³µí•˜ëŠ”ê°€?</h1>
<p>ì•„ì£¼ ì¢‹ì€ ì§ˆë¬¸ì…ë‹ˆë‹¤. ì•„ë˜ì— MELODIì˜ <strong>short-term memory (STM)</strong>, **long-term memory (LTM)**ê°€ <strong>ì–´ë–»ê²Œ ì •ë³´ë¥¼ ì••ì¶•í•˜ê³  ì „ë‹¬í•˜ëŠ”ì§€</strong> ê·¸ë¦¬ê³  ê¸°ì¡´ memory-augmented transformerì™€ì˜ ë¹„êµë¥¼ ì •ë¦¬í•´ë“œë¦½ë‹ˆë‹¤.</p>
<hr>
<h2 id="-melodiì˜-memory-êµ¬ì¡°ì™€-ë™ì‘-ë°©ì‹">âœ… MELODIì˜ Memory êµ¬ì¡°ì™€ ë™ì‘ ë°©ì‹</h2>
<h3 id="1-short-term-memory-stm-layer-wise-recurrent-compression">1. Short-Term Memory (STM): Layer-wise recurrent compression</h3>
<ul>
<li>
<p><strong>ëª©ì </strong>: í˜„ì¬ window ë‚´ ì •ë³´ + ì´ì „ window ìš”ì•½ ì •ë³´ë¥¼ ì²˜ë¦¬</p>
</li>
<li>
<p><strong>êµ¬í˜„ ë°©ì‹</strong>:</p>
<ul>
<li>
<p>ê° context window <code>xâ‚–</code>ë¥¼ ì—¬ëŸ¬ ShortTermLayerì— í†µê³¼ì‹œí‚¤ë©° ë°˜ë³µ ì••ì¶•</p>
</li>
<li>
<p>ê° layerì—ì„œëŠ”:</p>
<ul>
<li>context token <code>xâ‚–</code>, summary token <code>uâ‚–</code>, ì´ì „ memory token <code>zâ‚–â‚‹â‚</code>ì„ ì…ë ¥ìœ¼ë¡œ ì‚¬ìš©</li>
<li>attention + FFN í›„, <code>xâ‚–â€²</code> ìƒì„±</li>
<li>summary tokenê³¼ í•¨ê»˜ linear token mixerë¥¼ í†µí•´ ë‹¤ìŒ layerìš© <code>uâ‚–</code>, ë‹¤ìŒ windowìš© <code>zâ‚–</code> ìƒì„±</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>ì •ë³´ íë¦„</strong>:</p>
<ul>
<li>layer ê°„: <code>uâ‚–</code> (summary token)</li>
<li>window ê°„: <code>zâ‚–</code> (compressed STM token)</li>
</ul>
</li>
</ul>
<p>ğŸ‘‰ ì´ êµ¬ì¡°ëŠ” Transformer ë‚´ë¶€ì— LSTMì²˜ëŸ¼ <strong>layer-recurrent íë¦„</strong>ì„ ë§Œë“ ë‹¤ê³  ë³¼ ìˆ˜ ìˆìŒ</p>
<hr>
<h3 id="2-long-term-memory-ltm-mid-layer-compression--fifo-stacking">2. Long-Term Memory (LTM): Mid-layer compression + FIFO stacking</h3>
<ul>
<li>
<p><strong>ëª©ì </strong>: ê³¼ê±° ì—¬ëŸ¬ windowì˜ ì „ì²´ ìš”ì•½ ì •ë³´ë¥¼ ì¥ê¸°ì ìœ¼ë¡œ ìœ ì§€</p>
</li>
<li>
<p><strong>êµ¬í˜„ ë°©ì‹</strong>:</p>
<ul>
<li>ì¤‘ê°„ layer (ì˜ˆ: 7ì¸µ)ì—ì„œ, í˜„ì¬ <code>xâ‚–</code>, <code>uâ‚–</code>ë¥¼ long-term memoryì™€ <strong>cross-attention</strong></li>
<li>self-attnê³¼ cross-attnì„ <code>Î±</code> gatingìœ¼ë¡œ í•©ì„±</li>
<li>ì´ì–´ì„œ token mixerë¥¼ í†µí•´ 512-token windowë¥¼ 64ê°œ long-tokenìœ¼ë¡œ <strong>ì••ì¶•</strong></li>
<li>ì´ KVìŒì„ <code>mâ‚–</code>ë¡œ ì €ì¥, memory queue (<code>mâ‚:â‚–</code>)ì— append</li>
</ul>
</li>
</ul>
<p>ğŸ‘‰ ì •ë³´ëŠ” <strong>KV í˜•íƒœë¡œ ì €ì¥</strong>ë˜ë©°, ë‹¤ìŒ window ì²˜ë¦¬ ì‹œ cross-attention ëŒ€ìƒì´ ë¨</p>
<hr>
<h2 id="-ê¸°ì¡´-memory-augmented-ëª¨ë¸ê³¼ì˜-ë¹„êµ">ğŸ“Š ê¸°ì¡´ memory-augmented ëª¨ë¸ê³¼ì˜ ë¹„êµ</h2>
<table>
  <thead>
      <tr>
          <th>í•­ëª©</th>
          <th>Memorizing Transformer</th>
          <th>MELODI</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>memory ì €ì¥ ë°©ì‹</td>
          <td>ë‹¨ì¼ layerì—ì„œ ëª¨ë“  tokenì˜ KV ì €ì¥</td>
          <td>ì¤‘ê°„ layerì—ì„œ <strong>ì••ì¶•ëœ</strong> KV ì €ì¥</td>
      </tr>
      <tr>
          <td>ë‹¨ê¸° ë¬¸ë§¥ ìœ ì§€</td>
          <td>ì—†ìŒ (ì§ì ‘ token attention)</td>
          <td>STM ì‚¬ìš©ìœ¼ë¡œ <strong>ì—°ì†ì„± ë³´ì¡´</strong></td>
      </tr>
      <tr>
          <td>memory ìš©ëŸ‰</td>
          <td>ë§¤ìš° í¼ (dense KV ì €ì¥)</td>
          <td>8~10ë°° ì ìŒ (64-token ìˆ˜ì¤€)</td>
      </tr>
      <tr>
          <td>ì •ë³´ íë¦„</td>
          <td>ë‹¨ì¼ ë°©í–¥ (context â†’ memory)</td>
          <td><strong>ê³„ì¸µì </strong> íë¦„ (SM + LM)</td>
      </tr>
      <tr>
          <td>attention ë°©ì‹</td>
          <td>cross-attn (top-k ë˜ëŠ” dense)</td>
          <td><strong>gated</strong> self + cross-attn</td>
      </tr>
      <tr>
          <td>ìš”ì•½ ë°©ì‹</td>
          <td>ì—†ìŒ (raw token ì €ì¥)</td>
          <td>token mixer ê¸°ë°˜ <strong>ìš”ì•½/ì••ì¶•</strong></td>
      </tr>
  </tbody>
</table>
<hr>
<h2 id="-melodiì˜-êµ¬ì¡°ì -ì´ì -ìš”ì•½">ğŸ¯ MELODIì˜ êµ¬ì¡°ì  ì´ì  ìš”ì•½</h2>
<ol>
<li>
<p><strong>ë©”ëª¨ë¦¬ íš¨ìœ¨ì„±</strong>
ì••ì¶•ëœ memory token (e.g., 64ê°œ)ë§Œ ì €ì¥ â†’ MT ëŒ€ë¹„ ìµœëŒ€ <strong>8ë°° ê°ì†Œ</strong></p>
</li>
<li>
<p><strong>ì¥ë‹¨ê¸° ë¬¸ë§¥ ê²°í•©</strong>
STM: ì§ì „ windowì™€ smoothí•œ ì—°ê²°
LTM: ì „ì²´ history ìš”ì•½ ì €ì¥ â†’ <strong>local + global ë¬¸ë§¥ ëª¨ë‘ ë³´ì¡´</strong></p>
</li>
<li>
<p><strong>ì—°ì‚° ìµœì í™”</strong>
cross-attnì€ ë‹¨ 1 layerì—ì„œë§Œ ìˆ˜í–‰, top-k pruning ì—†ì´ë„ ë‚®ì€ cost</p>
</li>
<li>
<p><strong>í•™ìŠµëœ memory ì œì–´ (gating)</strong>
self vs. cross attentionì„ Î±ë¡œ ì¡°ì ˆ â†’ <strong>ë©”ëª¨ë¦¬ ì˜ì¡´ë„ í•™ìŠµ ê°€ëŠ¥</strong></p>
</li>
</ol>
<hr>

  <blockquote
    class="border-primary bg-muted/30 hover:bg-muted/40 my-6 rounded-r-lg border-l-4 py-4 pr-4 pl-6 italic transition-all duration-200 ease-out hover:translate-x-1">
    <div class="prose prose-sm max-w-none">
      <p>ê²°ë¡ ì ìœ¼ë¡œ, MELODIëŠ” ê¸°ì¡´ memory transformerë“¤ì˜ <strong>memory í­ì¦ ë¬¸ì œ</strong>ë¥¼ í•´ê²°í•˜ë©´ì„œë„, <strong>ì •ë³´ ë³´ì¡´ê³¼ ì¶”ë¡  ì„±ëŠ¥ì„ ì–‘ë¦½</strong>í•œ ê³„ì¸µì  ë©”ëª¨ë¦¬ êµ¬ì¡°ë¥¼ ì„¤ê³„í•œ ê²ƒì´ ê°€ì¥ í° ê°•ì ì…ë‹ˆë‹¤.</p>
    </div>
  </blockquote>

<p>ë” ê¶ê¸ˆí•˜ì‹  ì  ìˆìœ¼ì‹¤ê¹Œìš”? ë˜ëŠ” ì´ êµ¬ì¡°ë¥¼ í™œìš©í•œ downstream task ì ìš© ë°©ì‹ì´ ê¶ê¸ˆí•˜ì‹ ê°€ìš”?</p>
<h1 id="q--ë…¼ë¬¸ì—ì„œ-ì œì•ˆí•˜ëŠ”-hierarchical-memory-compression-ë°©ì‹ì´-long-context-language-modelingì˜-ì„±ëŠ¥-í–¥ìƒì—-ì–´ë–¤-ê¸°ì—¬ë¥¼-í–ˆëŠ”ì§€-ablation-ê²°ê³¼ë¥¼-í†µí•´-ì–´ë–»ê²Œ-ê²€ì¦ë˜ì—ˆëŠ”ê°€">Q : ë…¼ë¬¸ì—ì„œ ì œì•ˆí•˜ëŠ” hierarchical memory compression ë°©ì‹ì´ long-context language modelingì˜ ì„±ëŠ¥ í–¥ìƒì— ì–´ë–¤ ê¸°ì—¬ë¥¼ í–ˆëŠ”ì§€, ablation ê²°ê³¼ë¥¼ í†µí•´ ì–´ë–»ê²Œ ê²€ì¦ë˜ì—ˆëŠ”ê°€?</h1>
<p>ë…¼ë¬¸ì—ì„œ ì œì•ˆí•˜ëŠ” <strong>Hierarchical Memory Compression</strong>ì€ MELODIì˜ í•µì‹¬ ê¸°ì—¬ë¡œ, **short-term memory (STM)**ê³¼ **long-term memory (LTM)**ë¥¼ ê³„ì¸µì ìœ¼ë¡œ ê²°í•©í•¨ìœ¼ë¡œì¨ <strong>long-context language modeling</strong>ì˜ ì„±ëŠ¥ì„ ë†’ì˜€ìŠµë‹ˆë‹¤. ì´ êµ¬ì¡°ê°€ ì‹¤ì œë¡œ ì–´ë–»ê²Œ ì„±ëŠ¥ í–¥ìƒì— ê¸°ì—¬í–ˆëŠ”ì§€ëŠ” <strong>Ablation Study</strong>ë¥¼ í†µí•´ ëª…í™•íˆ ê²€ì¦ë˜ì—ˆìŠµë‹ˆë‹¤.</p>
<p>ì•„ë˜ì— êµ¬ì¡°ì  ì´í•´ì™€ ablation ê²°ê³¼ ê¸°ë°˜ì˜ ë¶„ì„ì„ ì •ë¦¬í•´ë“œë¦½ë‹ˆë‹¤.</p>
<hr>
<h2 id="-hierarchical-memory-compressionì´ë€">âœ… Hierarchical Memory Compressionì´ë€?</h2>
<ol>
<li>
<p><strong>Short-Term Memory (STM)</strong>:</p>
<ul>
<li>context window ë‚´ ì •ë³´ë¥¼ ì—¬ëŸ¬ layerë¥¼ í†µí•´ ë°˜ë³µì ìœ¼ë¡œ ì••ì¶•</li>
<li>ì´ì „ windowì˜ memory token <code>z_{k-1}</code>ì™€ summary token <code>u_{k-1}</code> í™œìš©</li>
<li><strong>ë¡œì»¬ ë¬¸ë§¥ ìœ ì§€</strong>ì— íš¨ê³¼ì </li>
</ul>
</li>
<li>
<p><strong>Long-Term Memory (LTM)</strong>:</p>
<ul>
<li>í•œ ì¤‘ê°„ layerì—ì„œ context window ì „ì²´ë¥¼ ìš”ì•½ â†’ 64ê°œ tokenìœ¼ë¡œ ì••ì¶•</li>
<li>ê³¼ê±° windowë“¤ì˜ ì••ì¶•ëœ KVë¥¼ FIFO queueì— ì €ì¥</li>
<li><strong>ì „ì—­ ë¬¸ë§¥ ìœ ì§€</strong>ì— íš¨ê³¼ì </li>
</ul>
</li>
<li>
<p><strong>ìš”ì•½</strong>:
â†’ <strong>STMì€ ìµœê·¼ ë¬¸ë§¥ì„ ì„¸ë°€í•˜ê²Œ ë³´ì¡´</strong>, <strong>LTMì€ ë¨¼ ê³¼ê±°ë¥¼ ìš”ì•½í•´ ê¸°ì–µ</strong>
â†’ ì´ ë‘˜ì„ ê³„ì¸µì ìœ¼ë¡œ ê²°í•©í•˜ì—¬ <strong>short+long dependency ë™ì‹œ ì²˜ë¦¬</strong></p>
</li>
</ol>
<hr>
<h2 id="-ablation-ì‹¤í—˜ìœ¼ë¡œ-í™•ì¸ëœ-ê¸°ì—¬">ğŸ§ª Ablation ì‹¤í—˜ìœ¼ë¡œ í™•ì¸ëœ ê¸°ì—¬</h2>
<h3 id="1-stm--ltm-ì¡°í•©ì˜-ì„±ëŠ¥-í–¥ìƒ-fig-4">1. STM + LTM ì¡°í•©ì˜ ì„±ëŠ¥ í–¥ìƒ (Fig. 4)</h3>
<ul>
<li>
<p>ì‹¤í—˜ ì„¤ì •: PG-19 (T5 vocab) ê¸°ì¤€</p>
</li>
<li>
<p>ì¡°ê±´:</p>
<ul>
<li>ë‹¤ì–‘í•œ short memory (<code>S</code>)</li>
<li>ë‹¤ì–‘í•œ long memory (<code>L</code>) í¬ê¸°</li>
<li>ì´ perplexity ë¹„êµ</li>
</ul>
</li>
</ul>
<p><strong>ê²°ê³¼ ìš”ì•½:</strong></p>
<table>
  <thead>
      <tr>
          <th>êµ¬ì¡°</th>
          <th>Perplexity (PG-19)</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>STM only (S192+L0)</td>
          <td>11.0+ (ë†’ìŒ)</td>
      </tr>
      <tr>
          <td>LTM only (S0+L64)</td>
          <td>11.2+ (ë†’ìŒ)</td>
      </tr>
      <tr>
          <td>STM + LTM (S128+L64)</td>
          <td><strong>10.44</strong> (ìµœì €)</td>
      </tr>
  </tbody>
</table>
<p>â¡ï¸ <strong>STMê³¼ LTMì€ ìƒí˜¸ë³´ì™„ì ì´ë©°, ë‘˜ì„ í•¨ê»˜ ì¨ì•¼ ì„±ëŠ¥ ìµœì í™”</strong></p>
<hr>
<h3 id="2-ltm-coverageê°€-ì„±ëŠ¥ì—-ë¯¸ì¹˜ëŠ”-ì˜í–¥-fig-5">2. LTM coverageê°€ ì„±ëŠ¥ì— ë¯¸ì¹˜ëŠ” ì˜í–¥ (Fig. 5)</h3>
<ul>
<li>ê³ ì •ëœ L = 64 long-token, S = 128 short-token</li>
<li>LTMì´ ì»¤ë²„í•˜ëŠ” window ìˆ˜: 2 â†’ 128ê¹Œì§€ ì‹¤í—˜</li>
</ul>
<p><strong>ê²°ê³¼ ìš”ì•½:</strong></p>
<ul>
<li>2~4 windowë§Œ í¬í•¨í•œ LTMì€ <strong>ì„±ëŠ¥ ê±°ì˜ ë³€í™” ì—†ìŒ</strong></li>
<li>32 window ì´ìƒ í¬í•¨í•œ ê²½ìš°ë¶€í„° <strong>PPL ê¸‰ê²©íˆ ê°œì„ </strong></li>
<li>128 window ì´ìƒì—ì„œëŠ” <strong>ì„±ëŠ¥ ê°œì„  ì •ì²´</strong></li>
</ul>
<p>â¡ï¸ <strong>STMì€ ìµœê·¼ ëª‡ windowê¹Œì§€ë§Œ íš¨ê³¼ì </strong>, <strong>ë©€ì–´ì§„ ë¬¸ë§¥ì€ LTMì´ í•„ìš”</strong></p>
<hr>
<h3 id="3-summary-branching-ê¸°ë²•ì˜-ì˜í–¥-table-4">3. Summary Branching ê¸°ë²•ì˜ ì˜í–¥ (Table 4)</h3>
<table>
  <thead>
      <tr>
          <th>êµ¬ì¡°</th>
          <th>PPL (ST only)</th>
          <th>PPL (ST+LT)</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>without branching</td>
          <td>11.68</td>
          <td>11.24</td>
      </tr>
      <tr>
          <td>with branching</td>
          <td><strong>11.39</strong></td>
          <td><strong>10.95</strong></td>
      </tr>
  </tbody>
</table>
<p>â¡ï¸ <strong>layer ê°„ summary token íë¦„</strong>ì„ ê°•í™”í•œ ê²ƒì´ ì„±ëŠ¥ í–¥ìƒì— ì§ì ‘ ê¸°ì—¬í•¨ì„ ë³´ì—¬ì¤Œ</p>
<hr>
<h2 id="-ì •ë¦¬-ì„±ëŠ¥-í–¥ìƒì—-ê¸°ì—¬í•œ-í•µì‹¬-í¬ì¸íŠ¸">ğŸ“Œ ì •ë¦¬: ì„±ëŠ¥ í–¥ìƒì— ê¸°ì—¬í•œ í•µì‹¬ í¬ì¸íŠ¸</h2>
<table>
  <thead>
      <tr>
          <th>ê¸°ë²•</th>
          <th>ê¸°ì—¬</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>STM (multi-layer compression)</td>
          <td>ìµœê·¼ ë¬¸ë§¥ ì •ë³´ ì„¸ë°€í•˜ê²Œ ìœ ì§€ â†’ short-range dependency ê°•í™”</td>
      </tr>
      <tr>
          <td>LTM (window-level compression)</td>
          <td>ì˜¤ë˜ëœ ë¬¸ë§¥ì„ ê°„ê²°í•˜ê²Œ ë³´ì¡´ â†’ long-range dependency ìœ ì§€</td>
      </tr>
      <tr>
          <td>Summary token + branching</td>
          <td>ì •ë³´ íë¦„ ê°œì„  â†’ ì••ì¶• íš¨ìœ¨ ë° ê³„ì¸µê°„ ì •ë³´ ì „ë‹¬ë ¥ ì¦ê°€</td>
      </tr>
      <tr>
          <td>Gated cross-attn</td>
          <td>LTM ì˜ì¡´ë„ ì¡°ì ˆ ê°€ëŠ¥ â†’ ì ì ˆí•œ memory usage í•™ìŠµ ê°€ëŠ¥</td>
      </tr>
  </tbody>
</table>
<hr>
<h2 id="-ê²°ë¡ -1">ğŸ¯ ê²°ë¡ </h2>

  <blockquote
    class="border-primary bg-muted/30 hover:bg-muted/40 my-6 rounded-r-lg border-l-4 py-4 pr-4 pl-6 italic transition-all duration-200 ease-out hover:translate-x-1">
    <div class="prose prose-sm max-w-none">
      <p>Ablation ê²°ê³¼ëŠ” MELODIì˜ hierarchical memory êµ¬ì¡°ê°€ ë‹¨ìˆœ memory stacking ë°©ì‹ë³´ë‹¤ í›¨ì”¬ íš¨ìœ¨ì ì´ë©°, <strong>STMê³¼ LTMì˜ ê³„ì¸µì  ê²°í•©ì´ long-context ì´í•´ ëŠ¥ë ¥ í–¥ìƒì— í•µì‹¬ì ì¸ ê¸°ì—¬ë¥¼ í•œë‹¤ëŠ” ê²ƒ</strong>ì„ ì‹¤ì¦ì ìœ¼ë¡œ ë³´ì—¬ì¤ë‹ˆë‹¤.</p>
    </div>
  </blockquote>

<h1 id="q--melodi-êµ¬ì¡°ê°€-ê°–ëŠ”-í•œê³„ì˜ˆ-pretrained-ëª¨ë¸-ì ìš©-ì–´ë ¤ì›€-ìˆœì°¨ì -ì²˜ë¦¬-ë“±ëŠ”-ì‹¤ì œ-ì‘ìš©ì—ì„œ-ì–´ë–¤-ì œì•½ì„-ë§Œë“¤ë©°-ì´ë¥¼-ë³´ì™„í•˜ê¸°-ìœ„í•œ-ê¸°ìˆ ì -í™•ì¥-ê°€ëŠ¥ì„±ì€-ì–´ë–¤-ê²ƒì´-ìˆì„ê¹Œ">Q : MELODI êµ¬ì¡°ê°€ ê°–ëŠ” í•œê³„(ì˜ˆ: pretrained ëª¨ë¸ ì ìš© ì–´ë ¤ì›€, ìˆœì°¨ì  ì²˜ë¦¬ ë“±)ëŠ” ì‹¤ì œ ì‘ìš©ì—ì„œ ì–´ë–¤ ì œì•½ì„ ë§Œë“¤ë©°, ì´ë¥¼ ë³´ì™„í•˜ê¸° ìœ„í•œ ê¸°ìˆ ì  í™•ì¥ ê°€ëŠ¥ì„±ì€ ì–´ë–¤ ê²ƒì´ ìˆì„ê¹Œ?</h1>
<p>MELODIëŠ” íš¨ìœ¨ì ì´ê³  ê°•ë ¥í•œ long-context ì²˜ë¦¬ ëŠ¥ë ¥ì„ ë³´ì—¬ì£¼ì§€ë§Œ, ëª‡ ê°€ì§€ êµ¬ì¡°ì  í•œê³„ê°€ ì‹¤ì œ ì‘ìš©ì— ì œì•½ì„ ì¤„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì•„ë˜ì— MELODIì˜ <strong>êµ¬ì¡°ì  í•œê³„</strong>, <strong>ì‘ìš©ìƒì˜ ì œì•½</strong>, ê·¸ë¦¬ê³  ì´ë¥¼ ë³´ì™„í•  ìˆ˜ ìˆëŠ” <strong>ê¸°ìˆ ì  í™•ì¥ ê°€ëŠ¥ì„±</strong>ì„ ì •ë¦¬í•´ë“œë¦½ë‹ˆë‹¤.</p>
<hr>
<h2 id="-melodi-êµ¬ì¡°ì˜-ì£¼ìš”-í•œê³„ì™€-ì‹¤ì œ-ì œì•½">âœ… MELODI êµ¬ì¡°ì˜ ì£¼ìš” í•œê³„ì™€ ì‹¤ì œ ì œì•½</h2>
<h3 id="1-ì‚¬ì „í•™ìŠµpretrained-ëª¨ë¸-ì ìš©-ì–´ë ¤ì›€">1. ì‚¬ì „í•™ìŠµ(pretrained) ëª¨ë¸ ì ìš© ì–´ë ¤ì›€</h3>
<ul>
<li>
<p><strong>ë¬¸ì œ</strong>: MELODIëŠ” Transformer êµ¬ì¡°ë¥¼ ë°”ê¾¼ êµ¬ì¡°ì´ê¸° ë•Œë¬¸ì— ê¸°ì¡´ GPT, LLaMA ë“±ì˜ pretrained weightë¥¼ ì§ì ‘ ì‚¬ìš©í•  ìˆ˜ ì—†ìŒ</p>
</li>
<li>
<p><strong>ì‹¤ì œ ì œì•½</strong>:</p>
<ul>
<li>ê¸°ì¡´ ëŒ€ê·œëª¨ ì‚¬ì „í•™ìŠµ ìì›ì„ í™œìš©í•  ìˆ˜ ì—†ì–´ <strong>from scratch training í•„ìš”</strong></li>
<li>ë¹„ìš©, ë°ì´í„° í™•ë³´, ì„±ëŠ¥ ì¬í˜„ ì¸¡ë©´ì—ì„œ <strong>í˜„ì‹¤ì ì¸ ì¥ë²½ ì¡´ì¬</strong></li>
</ul>
</li>
</ul>
<hr>
<h3 id="2-ìˆœì°¨ì -ì²˜ë¦¬-window-by-window">2. ìˆœì°¨ì  ì²˜ë¦¬ (window-by-window)</h3>
<ul>
<li>
<p><strong>ë¬¸ì œ</strong>: context windowë¥¼ ìˆœì„œëŒ€ë¡œ ì²˜ë¦¬í•˜ë©´ì„œ memoryë¥¼ ê°±ì‹ í•˜ëŠ” êµ¬ì¡° â†’ ë³‘ë ¬ì„± ì œí•œ</p>
</li>
<li>
<p><strong>ì‹¤ì œ ì œì•½</strong>:</p>
<ul>
<li>batch-level parallelism ë¶ˆê°€ â†’ <strong>ì¶”ë¡  latency ì¦ê°€</strong></li>
<li>GPU ë‹¤ì¤‘ì²˜ë¦¬ë‚˜ ë¶„ì‚°ì¶”ë¡ ì— ë¶ˆë¦¬ â†’ <strong>inference throughput ë‚®ìŒ</strong></li>
</ul>
</li>
</ul>
<hr>
<h3 id="3-ë©”ëª¨ë¦¬-ì••ì¶•ì˜-ì •ë³´-ì†ì‹¤-ê°€ëŠ¥ì„±">3. ë©”ëª¨ë¦¬ ì••ì¶•ì˜ ì •ë³´ ì†ì‹¤ ê°€ëŠ¥ì„±</h3>
<ul>
<li>
<p><strong>ë¬¸ì œ</strong>: long-term memoryëŠ” summary tokenì„ í†µí•´ ì••ì¶• ì €ì¥</p>
<ul>
<li>â†’ ëª¨ë“  ì¤‘ìš”í•œ ì •ë³´ê°€ ë³´ì¡´ëœë‹¤ëŠ” ë³´ì¥ì€ ì—†ìŒ</li>
</ul>
</li>
<li>
<p><strong>ì‹¤ì œ ì œì•½</strong>:</p>
<ul>
<li>ì¼ë¶€ downstream task (ì˜ˆ: QA, reasoning)ì—ì„œëŠ” <strong>ì¹˜ëª…ì  ì •ë³´ ìœ ì‹¤</strong> ê°€ëŠ¥</li>
<li>íŠ¹ì • windowì˜ í•µì‹¬ ë‚´ìš©ì´ ì¶”ë¡  ì‹œ ëˆ„ë½ë  ìœ„í—˜</li>
</ul>
</li>
</ul>
<hr>
<h2 id="-ê¸°ìˆ ì -í™•ì¥-ê°€ëŠ¥ì„±-ë°-ë³´ì™„-ë°©ì•ˆ">ğŸ”§ ê¸°ìˆ ì  í™•ì¥ ê°€ëŠ¥ì„± ë° ë³´ì™„ ë°©ì•ˆ</h2>
<h3 id="1-pretrained-ëª¨ë¸ê³¼ì˜-í˜¸í™˜ì„-ìœ„í•œ-adapter-based-ì‚½ì…">1. <strong>Pretrained ëª¨ë¸ê³¼ì˜ í˜¸í™˜ì„ ìœ„í•œ Adapter-based ì‚½ì…</strong></h3>
<ul>
<li>
<p><strong>ì ‘ê·¼ë²•</strong>: ê¸°ì¡´ GPT ë“±ì˜ ì‚¬ì „í•™ìŠµ ëª¨ë¸ì— MELODI memory blockì„ LoRA, Adapter í˜•íƒœë¡œ ì‚½ì…</p>
</li>
<li>
<p><strong>ì˜ˆì‹œ ì•„ì´ë””ì–´</strong>:</p>
<ul>
<li><code>MELODI-Attention</code> â†’ ê¸°ì¡´ self-attn í›„ cross-attn to memory ì¶”ê°€</li>
<li>ê¸°ì¡´ weight freezing + memory blockë§Œ í•™ìŠµ</li>
</ul>
</li>
<li>
<p><strong>ì¥ì </strong>:</p>
<ul>
<li>ì‚¬ì „í•™ìŠµ weight í™œìš© ê°€ëŠ¥</li>
<li>few-shot tuning ê°€ëŠ¥</li>
</ul>
</li>
</ul>
<hr>
<h3 id="2-ë¹„ìˆœì°¨ì -memory-ì ‘ê·¼-êµ¬ì¡°ë¡œ-parallelism-í™•ë³´">2. <strong>ë¹„ìˆœì°¨ì  memory ì ‘ê·¼ êµ¬ì¡°ë¡œ parallelism í™•ë³´</strong></h3>
<ul>
<li>
<p><strong>ì ‘ê·¼ë²•</strong>:</p>
<ul>
<li>Long-term memoryë¥¼ KV cacheì²˜ëŸ¼ read-only êµ¬ì¡°ë¡œ êµ¬ì„±</li>
<li>ì—¬ëŸ¬ windowë¥¼ ë³‘ë ¬ì ìœ¼ë¡œ long memoryì— cross-attn ìˆ˜í–‰ ê°€ëŠ¥í•˜ê²Œ ë³€ê²½</li>
</ul>
</li>
<li>
<p><strong>ì˜ˆì‹œ</strong>:</p>
<ul>
<li>â€œFlashMemory-styleâ€ ì ‘ê·¼</li>
<li>Routing indexì™€ positional RoPE ë³´ì • í™œìš©</li>
</ul>
</li>
<li>
<p><strong>ì¥ì </strong>:</p>
<ul>
<li>window ê°„ ë³‘ë ¬ ì²˜ë¦¬ ê°€ëŠ¥ â†’ GPU íš¨ìœ¨ ê°œì„ </li>
</ul>
</li>
</ul>
<hr>
<h3 id="3-ì •ë³´-ì†ì‹¤-ìµœì†Œí™”ë¥¼-ìœ„í•œ-adaptive-memory-compression">3. <strong>ì •ë³´ ì†ì‹¤ ìµœì†Œí™”ë¥¼ ìœ„í•œ Adaptive Memory Compression</strong></h3>
<ul>
<li>
<p><strong>ì ‘ê·¼ë²•</strong>:</p>
<ul>
<li>token importance ê¸°ë°˜ìœ¼ë¡œ summary token ë¹„ìœ¨ì„ ë™ì ìœ¼ë¡œ ì¡°ì •</li>
<li>ë˜ëŠ” retrieval ê¸°ë°˜ memory reinforcement (RAG hybrid)</li>
</ul>
</li>
<li>
<p><strong>ê¸°ìˆ  íë¦„ ì˜ˆì‹œ</strong>:</p>
<ul>
<li>AutoCompressor (Chevalier et al. 2023)</li>
<li>Gisting (Mu et al. 2024)</li>
</ul>
</li>
<li>
<p><strong>ì¥ì </strong>:</p>
<ul>
<li>ì••ì¶• ì†ì‹¤ì„ ìµœì†Œí™” â†’ ê³ ì • summary token êµ¬ì¡°ë³´ë‹¤ ì •ë°€</li>
</ul>
</li>
</ul>
<hr>
<h3 id="4-memory-ì¬í™œìš©-êµ¬ì¡°-ì¶”ê°€-compressive-memory">4. <strong>Memory ì¬í™œìš© êµ¬ì¡° ì¶”ê°€ (Compressive Memory)</strong></h3>
<ul>
<li>
<p><strong>ì ‘ê·¼ë²•</strong>:</p>
<ul>
<li>ì˜¤ë˜ëœ long-term memoryë¥¼ ì¬ìš”ì•½í•˜ì—¬ compactí•˜ê²Œ ë³´ê´€</li>
<li>Compressive Transformerì™€ ìœ ì‚¬í•œ multi-tier memory stack êµ¬ì„±</li>
</ul>
</li>
<li>
<p><strong>ì¥ì </strong>:</p>
<ul>
<li>memory ìš©ëŸ‰ ì œí•œ ê·¹ë³µ + ì •ë³´ ìœ ì§€</li>
</ul>
</li>
</ul>
<hr>
<h3 id="5-multi-modal-í™•ì¥ì„±-í™•ë³´">5. <strong>Multi-modal í™•ì¥ì„± í™•ë³´</strong></h3>
<ul>
<li>
<p><strong>ì ‘ê·¼ë²•</strong>:</p>
<ul>
<li>MELODIì˜ memory blockì„ vision/audio encoder ë’¤ì— ì—°ê²°</li>
<li>multi-modal tokenë„ memory tokenì²˜ëŸ¼ ì²˜ë¦¬</li>
</ul>
</li>
<li>
<p><strong>ì¥ì </strong>:</p>
<ul>
<li>Gemini, Flamingo ë“± multi-modal long context ëª¨ë¸ë¡œ í™•ì¥ ê°€ëŠ¥</li>
</ul>
</li>
</ul>
<hr>
<h2 id="-ê²°ë¡ -ìš”ì•½-2">ğŸ“Œ ê²°ë¡  ìš”ì•½</h2>
<table>
  <thead>
      <tr>
          <th>í•œê³„</th>
          <th>ì‘ìš© ì œì•½</th>
          <th>ë³´ì™„ ë°©ì•ˆ</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>pretrained ì ìš© ì–´ë ¤ì›€</td>
          <td>ê¸°ì¡´ weight ì¬ì‚¬ìš© ë¶ˆê°€</td>
          <td>memory block â†’ adapter/LoRAí™”</td>
      </tr>
      <tr>
          <td>ìˆœì°¨ ì²˜ë¦¬ êµ¬ì¡°</td>
          <td>GPU ë³‘ë ¬ì„± ì €í•˜</td>
          <td>LTMì„ read-only cross-attnìœ¼ë¡œ êµ¬ì¡°í™”</td>
      </tr>
      <tr>
          <td>memory ì •ë³´ ì†ì‹¤</td>
          <td>ì¶”ë¡  ì •ë³´ ìœ ì‹¤ ê°€ëŠ¥ì„±</td>
          <td>token ì¤‘ìš”ë„ ê¸°ë°˜ adaptive compression</td>
      </tr>
      <tr>
          <td>memory í­ì¦</td>
          <td>ê¸´ ë¬¸ì„œì—ì„œ ë©”ëª¨ë¦¬ í•œê³„</td>
          <td>compressive memory or hybrid routing</td>
      </tr>
      <tr>
          <td>modality í•œì •</td>
          <td>text ì „ìš© êµ¬ì¡°</td>
          <td>multi-modal memory í™•ì¥ ê°€ëŠ¥</td>
      </tr>
  </tbody>
</table>

  </article>

  
  
  <div class="post-license bg-muted/30 border-border mb-8 rounded-xl border p-6">
    <div class="flex items-start gap-4">
      <div
        class="bg-primary/10 flex h-12 w-12 flex-shrink-0 items-center justify-center rounded-lg">
        
  <svg class="h-6 w-6"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="ë¼ì´ì„ ìŠ¤"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z" />
</svg>
      </div>

      <div class="flex-1">
        <h3 class="text-foreground mb-2 text-lg font-semibold">
          ë¼ì´ì„ ìŠ¤
        </h3>

        <div class="text-muted-foreground space-y-2 text-sm">
          
          <p>
            <strong>ì €ì‘ì:</strong>
            ë¥˜ì¬í›ˆ
          </p>
          

          <p>
            <strong>ë§í¬:</strong>
            <a
              href="http://192.168.1.11:1314/posts/MELODI-Exploring-Memory-Compression-for-Long-Contexts/"
              class="text-primary hover:text-primary/80 transition-colors duration-200">
              http://192.168.1.11:1314/posts/MELODI-Exploring-Memory-Compression-for-Long-Contexts/
            </a>
          </p>

          <p>
            <strong>ë¼ì´ì„ ìŠ¤:</strong>
            <a
              href="https://creativecommons.org/licenses/by-nc-sa/4.0/"
              target="_blank"
              rel="noopener noreferrer"
              class="text-primary hover:text-primary/80 transition-colors duration-200">
              CC BY-NC-SA 4.0
            </a>
          </p>

          <p class="text-xs">
            ì´ ì €ì‘ë¬¼ì€ í¬ë¦¬ì—ì´í‹°ë¸Œ ì»¤ë¨¼ì¦ˆ ì €ì‘ìí‘œì‹œ-ë¹„ì˜ë¦¬-ë™ì¼ì¡°ê±´ë³€ê²½í—ˆë½ 4.0 êµ­ì œ ë¼ì´ì„ ìŠ¤ì— ë”°ë¼ ì´ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì¶œì²˜ë¥¼ í‘œì‹œí•˜ê³ , ë¹„ì˜ë¦¬ ëª©ì ìœ¼ë¡œë§Œ ì‚¬ìš©í•˜ë©°, ë™ì¼í•œ ë¼ì´ì„ ìŠ¤ë¥¼ ìœ ì§€í•´ì•¼ í•©ë‹ˆë‹¤.
          </p>
        </div>
      </div>
    </div>
  </div>


  
  





  <nav
    class="post-navigation mb-12"
    aria-label="ê²Œì‹œê¸€ ë„¤ë¹„ê²Œì´ì…˜">
    <div class="grid grid-cols-1 gap-4 md:grid-cols-2">
      
      <div class="nav-item">
        
          <a
            href="/posts/Seesaw-High-throughput-LLM-Inference-via-Model-Re-sharding/"
            class="group bg-card border-border hover:bg-primary/5 hover:border-primary/20 focus:ring-primary/20 flex min-h-[140px] flex-col justify-between rounded-xl border p-6 transition-all duration-300 ease-out hover:-translate-y-1 hover:scale-[1.02] hover:shadow-lg focus:ring-2 focus:outline-none">
            <div>
              <div class="mb-3 flex items-center gap-3">
                
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
</svg>
                <span class="text-muted-foreground text-sm font-medium">
                  ì´ì „
                </span>
              </div>

              <h3
                class="text-foreground group-hover:text-primary mb-3 line-clamp-2 text-lg leading-tight font-semibold transition-colors duration-200">
                Seesaw: High-throughput LLM Inference via Model Re-sharding
              </h3>
            </div>

            <div
              class="text-muted-foreground mt-auto flex items-center gap-2 text-xs">
              
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
</svg>
              <time datetime="2025-05-12">
                05æœˆ12æ—¥
              </time>
            </div>
          </a>
        
      </div>

      
      <div class="nav-item">
        
          <a
            href="/posts/Gemma-3-Technical-Report/"
            class="group bg-card border-border hover:bg-primary/5 hover:border-primary/20 focus:ring-primary/20 flex min-h-[140px] flex-col justify-between rounded-xl border p-6 transition-all duration-300 ease-out hover:-translate-y-1 hover:scale-[1.02] hover:shadow-lg focus:ring-2 focus:outline-none">
            <div>
              <div class="mb-3 flex items-center justify-end gap-3">
                <span class="text-muted-foreground text-sm font-medium">
                  ë‹¤ìŒ
                </span>
                
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
</svg>
              </div>

              <h3
                class="text-foreground group-hover:text-primary mb-3 line-clamp-2 text-right text-lg leading-tight font-semibold transition-colors duration-200">
                Gemma 3 Technical Report
              </h3>
            </div>

            <div
              class="text-muted-foreground mt-auto flex items-center justify-end gap-2 text-xs">
              <time datetime="2025-05-12">
                05æœˆ12æ—¥
              </time>
              
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
</svg>
            </div>
          </a>
        
      </div>
    </div>
  </nav>




  
  










  
  


    </main>

    <footer class="mx-auto max-w-4xl px-4 py-8">
  <div class="px-6 py-6">
    
    
      <nav class="mb-6">
        <div class="flex flex-wrap items-center justify-center gap-1">
          
            
            
            
            <a
              href="/index.xml"
              
              class="nav-link hover:text-primary hover:bg-primary/10 text-muted-foreground flex items-center gap-2 rounded-lg px-4 py-2 text-sm font-medium transition-all duration-300 hover:scale-105">
              
                
  <svg class="h-5 w-5"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="RSS Feed">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 5c7.18 0 13 5.82 13 13M6 11a7 7 0 017 7m-6 0a1 1 0 11-2 0 1 1 0 012 0z" />

</svg>
              
              <span
                >
                  RSS Feed
                </span
              >
            </a>
          
        </div>
      </nav>
    


    
    
      <div class="border-border mb-6 border-t"></div>
    


    
    <div class="flex flex-col items-center justify-between gap-4 md:flex-row">
      
      <div class="text-muted-foreground text-sm">
        <p>
          &copy; 2025 Jaehun&#39;s Blog.
          ëª¨ë“  ê¶Œë¦¬ ë³´ìœ .
        </p>
      </div>

      
      
        <div class="flex items-center gap-3">
          
            <a
              href="https://github.com/ryujaehun"
              
                target="_blank" rel="noopener noreferrer"
              
              class="text-muted-foreground hover:text-primary focus:ring-primary/20 rounded-lg p-1 transition-all duration-300 ease-out hover:scale-110 focus:ring-2 focus:outline-none"
              title="GitHub"
              aria-label="GitHub">
              
                
  <svg class="h-6 w-6"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="GitHub"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"><path d="M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5c.08-1.25-.27-2.48-1-3.5c.28-1.15.28-2.35 0-3.5c0 0-1 0-3 1.5c-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.4 5.4 0 0 0 4 9c0 3.5 3 5.5 6 5.5c-.39.49-.68 1.05-.85 1.65S8.93 17.38 9 18v4"/><path d="M9 18c-4.51 2-5-2-7-2"/></g></svg>
              
            </a>
          
            <a
              href="https://www.linkedin.com/in/jaehunryu/"
              
                target="_blank" rel="noopener noreferrer"
              
              class="text-muted-foreground hover:text-primary focus:ring-primary/20 rounded-lg p-1 transition-all duration-300 ease-out hover:scale-110 focus:ring-2 focus:outline-none"
              title="Linkedin"
              aria-label="Linkedin">
              
                
  <svg class="h-6 w-6"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="Linkedin"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"><path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2a2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6M2 9h4v12H2z"/><circle cx="4" cy="4" r="2"/></g></svg>
              
            </a>
          
            <a
              href="mailto:jaehunryu@icloud.com"
              
              class="text-muted-foreground hover:text-primary focus:ring-primary/20 rounded-lg p-1 transition-all duration-300 ease-out hover:scale-110 focus:ring-2 focus:outline-none"
              title="Email"
              aria-label="Email">
              
                
  <svg class="h-6 w-6"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="Email">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />

</svg>
              
            </a>
          
        </div>
      

    </div>
  </div>
</footer>


    
    



<div
  id="dock"
  class="pointer-events-none fixed bottom-4 left-1/2 z-[9999] w-fit -translate-x-1/2 translate-y-24 opacity-0 transition-all duration-300 ease-out sm:right-0 sm:left-0 sm:mx-auto sm:translate-x-0"
  role="toolbar"
  aria-label="ë°”ë¡œê°€ê¸° ë„êµ¬ ëª¨ìŒ">
  <nav
    class="border-border bg-card/80 scrollbar-hide xs:px-3 xs:py-2 mx-auto flex max-w-[calc(100vw-2rem)] min-w-fit items-center justify-center overflow-x-auto rounded-2xl border px-4 py-3 shadow-lg backdrop-blur-sm sm:px-4 sm:py-3">
    
    
      <button
        id="dock-back"
        class="text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 xs:px-2 xs:py-1.5 flex flex-shrink-0 items-center gap-2 rounded-lg px-3 py-2 text-sm font-medium transition-all duration-300 ease-out hover:-translate-y-0.5 hover:scale-105 focus:ring-2 focus:outline-none sm:px-3 sm:py-2"
        title="ë’¤ë¡œ"
        aria-label="ë’¤ë¡œ">
        
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24">
  <path d="m12 19-7-7 7-7"/>
  <path d="M19 12H5"/>

</svg>
        <span class="hidden sm:inline"
          >ë’¤ë¡œ</span
        >
      </button>

      
      <div class="bg-border xs:mx-1 mx-2 h-6 w-px sm:mx-2"></div>
    


    
    
      <button
        id="dock-toc"
        class="text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 xs:px-2 xs:py-1.5 flex flex-shrink-0 items-center gap-2 rounded-lg px-3 py-2 text-sm font-medium transition-all duration-300 ease-out hover:-translate-y-0.5 hover:scale-105 focus:ring-2 focus:outline-none sm:px-3 sm:py-2"
        title="ëª©ì°¨"
        aria-label="ëª©ì°¨">
        
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24">
  <line x1="8" x2="21" y1="6" y2="6"/>
  <line x1="8" x2="21" y1="12" y2="12"/>
  <line x1="8" x2="21" y1="18" y2="18"/>
  <line x1="3" x2="3.01" y1="6" y2="6"/>
  <line x1="3" x2="3.01" y1="12" y2="12"/>
  <line x1="3" x2="3.01" y1="18" y2="18"/>

</svg>
        <span class="hidden sm:inline"
          >ëª©ì°¨</span
        >
      </button>

      
      <div class="bg-border xs:mx-1 mx-2 h-6 w-px sm:mx-2"></div>
    


    
    <button
      id="dock-search"
      class="text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 xs:px-3 xs:py-1.5 flex flex-shrink-0 items-center gap-2 rounded-lg px-4 py-2 text-sm font-medium transition-all duration-300 ease-out hover:-translate-y-0.5 hover:scale-105 focus:ring-2 focus:outline-none sm:px-4 sm:py-2"
      title="ê²€ìƒ‰"
      aria-label="ê²€ìƒ‰">
      
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m21 21-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />

</svg>
      <span class="hidden md:inline"
        >ê²€ìƒ‰</span
      >
    </button>

    
    <div class="bg-border xs:mx-1 mx-2 h-6 w-px sm:mx-2"></div>

    
    
    


    
    <button
      id="dock-top"
      class="text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 xs:px-2 xs:py-1.5 flex flex-shrink-0 items-center gap-2 rounded-lg px-3 py-2 text-sm font-medium transition-all duration-300 ease-out hover:-translate-y-0.5 hover:scale-105 focus:ring-2 focus:outline-none sm:px-3 sm:py-2"
      title="ë§¨ ìœ„ë¡œ"
      aria-label="ë§¨ ìœ„ë¡œ">
      
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24">
  <path d="m18 15-6-6-6 6"/>

</svg>
      <span class="hidden sm:inline"
        >ë§¨ ìœ„ë¡œ</span
      >
    </button>
  </nav>
</div>


    
      



<div
  id="toc-overlay"
  class="pointer-events-none fixed inset-0 z-40 bg-black/50 opacity-0 backdrop-blur-sm transition-all duration-300"
  role="dialog"
  aria-modal="true"
  aria-labelledby="toc-title"></div>


<div
  id="toc-card"
  class="pointer-events-none fixed inset-4 z-50 flex w-auto scale-95 items-center justify-center opacity-0 transition-all duration-300 sm:inset-auto sm:top-1/2 sm:left-1/2 sm:block sm:w-full sm:max-w-md sm:-translate-x-1/2 sm:-translate-y-1/2"
  role="dialog"
  aria-modal="true"
  aria-labelledby="toc-title">
  <div
    class="bg-card border-border w-full max-w-sm overflow-hidden rounded-xl border shadow-xl sm:max-w-md">
    
    <div
      class="border-border bg-muted/30 flex items-center justify-between border-b p-4">
      <div class="flex items-center gap-3">
        
  <svg class="h-5 w-5"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24">
  <line x1="8" x2="21" y1="6" y2="6"/>
  <line x1="8" x2="21" y1="12" y2="12"/>
  <line x1="8" x2="21" y1="18" y2="18"/>
  <line x1="3" x2="3.01" y1="6" y2="6"/>
  <line x1="3" x2="3.01" y1="12" y2="12"/>
  <line x1="3" x2="3.01" y1="18" y2="18"/>

</svg>
        <h2 id="toc-title" class="text-foreground text-lg font-semibold">
          ëª©ì°¨
        </h2>
      </div>

      
      <button
        id="toc-close"
        class="text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 rounded-lg p-2 transition-all duration-200 ease-out hover:-translate-y-0.5 hover:scale-105 focus:ring-2 focus:outline-none"
        title="ë‹«ê¸°"
        aria-label="ë‹«ê¸°">
        
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />

</svg>
      </button>
    </div>

    
    <div class="max-h-96 overflow-y-auto p-4">
      <nav
        id="toc-nav"
        class="toc-scrollbar"
        aria-label="ê¸€ ëª©ì°¨">
          
          <div id="toc-content">
            <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#-ê²°ë¡ -ìš”ì•½">ğŸ“Œ ê²°ë¡  ìš”ì•½</a></li>
      </ul>
    </li>
    <li><a href="#-melodiì˜-êµ¬ì¡°-ìš”ì•½">ğŸ” MELODIì˜ êµ¬ì¡° ìš”ì•½</a>
      <ul>
        <li><a href="#ì˜ˆì‹œ-ì…ë ¥-íë¦„-ë‹¨ì¼-ìœˆë„ìš°-ê¸°ì¤€">ì˜ˆì‹œ ì…ë ¥ íë¦„ (ë‹¨ì¼ ìœˆë„ìš° ê¸°ì¤€)</a></li>
      </ul>
    </li>
    <li><a href="#-í•µì‹¬-ì•Œê³ ë¦¬ì¦˜-ì˜ˆì‹œ-ê¸°ë°˜-ì„¤ëª…">ğŸ§  í•µì‹¬ ì•Œê³ ë¦¬ì¦˜: ì˜ˆì‹œ ê¸°ë°˜ ì„¤ëª…</a></li>
    <li><a href="#-ì„±ëŠ¥-ë¹„êµ-perplexity-ê¸°ì¤€">ğŸ“ˆ ì„±ëŠ¥ ë¹„êµ (Perplexity ê¸°ì¤€)</a></li>
    <li><a href="#-ablationìœ¼ë¡œ-ë°í˜€ì§„-ì„¤ê³„ì˜-íš¨ê³¼">ğŸ§ª Ablationìœ¼ë¡œ ë°í˜€ì§„ ì„¤ê³„ì˜ íš¨ê³¼</a></li>
    <li><a href="#-ë…¼ë¬¸ì˜-ê°•ì ">ğŸ” ë…¼ë¬¸ì˜ ê°•ì </a></li>
    <li><a href="#-í•œê³„ì ">âŒ í•œê³„ì </a></li>
    <li><a href="#-ê²°ë¡ -ë°-í™œìš©-ì œì•ˆ">ğŸ“Œ ê²°ë¡  ë° í™œìš© ì œì•ˆ</a></li>
  </ul>

  <ul>
    <li><a href="#-melodi-vs-slice-window-attention-ë¹„êµ">ğŸ” MELODI vs Slice Window Attention: ë¹„êµ</a>
      <ul>
        <li><a href="#í•µì‹¬-ì°¨ì´">í•µì‹¬ ì°¨ì´</a></li>
      </ul>
    </li>
    <li><a href="#-í•µì‹¬-ì°¨ì´-ìš”ì•½-swa-vs-melodi">âœ… í•µì‹¬ ì°¨ì´ ìš”ì•½: SWA vs MELODI</a>
      <ul>
        <li><a href="#ì˜ˆì‹œë¡œ-ì´í•´í•˜ê¸°">ì˜ˆì‹œë¡œ ì´í•´í•˜ê¸°</a></li>
        <li><a href="#ê²°ë¡ ">ê²°ë¡ </a></li>
      </ul>
    </li>
  </ul>

  <ul>
    <li><a href="#-ì „ì²´-êµ¬ì¡°-ìš”ì•½">âœ… ì „ì²´ êµ¬ì¡° ìš”ì•½</a></li>
    <li><a href="#-ì˜ˆì‹œ-ì „ì²´-ì•Œê³ ë¦¬ì¦˜-ë™ì‘-íë¦„">ğŸ§ª ì˜ˆì‹œ: ì „ì²´ ì•Œê³ ë¦¬ì¦˜ ë™ì‘ íë¦„</a>
      <ul>
        <li><a href="#ê°€ì •">ê°€ì •</a></li>
        <li><a href="#-step-1-input-ì¤€ë¹„">â–¶ï¸ Step 1: Input ì¤€ë¹„</a></li>
        <li><a href="#-step-2-short-term-memory-ì²˜ë¦¬-mê°œì˜-layer-ë°˜ë³µ">â–¶ï¸ Step 2: Short-Term Memory ì²˜ë¦¬ (Mê°œì˜ layer ë°˜ë³µ)</a></li>
        <li><a href="#-step-3-long-term-memory-ì²˜ë¦¬-ë‹¨ì¼-middle-layerì—ì„œë§Œ">â–¶ï¸ Step 3: Long-Term Memory ì²˜ë¦¬ (ë‹¨ì¼ middle layerì—ì„œë§Œ)</a></li>
        <li><a href="#-step-4-output-ì „ë‹¬">â–¶ï¸ Step 4: Output ì „ë‹¬</a></li>
      </ul>
    </li>
    <li><a href="#-ì „ì²´-ë°˜ë³µ">ğŸ” ì „ì²´ ë°˜ë³µ</a></li>
    <li><a href="#-ì •ë¦¬-ì•Œê³ ë¦¬ì¦˜-íë¦„ë„">ğŸ“Š ì •ë¦¬: ì•Œê³ ë¦¬ì¦˜ íë¦„ë„</a></li>
    <li><a href="#-ì£¼ìš”-íŠ¹ì„±">ğŸ§  ì£¼ìš” íŠ¹ì„±</a></li>
  </ul>

  <ul>
    <li><a href="#-1-ì‹¤í—˜-ê²°ê³¼-ì •ë¦¬-perplexity-ê¸°ì¤€-ì„±ëŠ¥-ë¹„êµ">âœ… 1. ì‹¤í—˜ ê²°ê³¼ ì •ë¦¬ (Perplexity ê¸°ì¤€ ì„±ëŠ¥ ë¹„êµ)</a></li>
    <li><a href="#-2-ê¸°ì¡´-ë°©ë²•ë¡ -ëŒ€ë¹„-melodiì˜-íŠ¹ì¶œë‚œ-ì ">âœ… 2. ê¸°ì¡´ ë°©ë²•ë¡  ëŒ€ë¹„ MELODIì˜ íŠ¹ì¶œë‚œ ì </a></li>
    <li><a href="#-3-ë…¼ë¬¸ì´-ì„¤ëª…í•˜ëŠ”-ì„±ëŠ¥-í–¥ìƒì˜-ì´ìœ ">âœ… 3. ë…¼ë¬¸ì´ ì„¤ëª…í•˜ëŠ” ì„±ëŠ¥ í–¥ìƒì˜ ì´ìœ </a>
      <ul>
        <li><a href="#-ê³„ì¸µì -ë©”ëª¨ë¦¬-êµ¬ì¡°-hierarchical-compression">â‘  ê³„ì¸µì  ë©”ëª¨ë¦¬ êµ¬ì¡° (hierarchical compression)</a></li>
        <li><a href="#-summary-branching-ë‹¨ê¸°-ê¸°ì–µì˜-layer-ê°„-ì „íŒŒ-ê°•í™”">â‘¡ Summary branching (ë‹¨ê¸° ê¸°ì–µì˜ layer ê°„ ì „íŒŒ ê°•í™”)</a></li>
        <li><a href="#-gated-cross-attention-in-lm">â‘¢ Gated cross-attention in LM</a></li>
      </ul>
    </li>
    <li><a href="#-ë‚´-ê²¬í•´-ë°-í‰ê°€">ğŸ¤– ë‚´ ê²¬í•´ ë° í‰ê°€</a></li>
    <li><a href="#-ê²°ë¡ ">ğŸ“Œ ê²°ë¡ </a></li>
  </ul>

  <ul>
    <li><a href="#-1-ê¸°ì¡´-transformer-ëŒ€ë¹„-melodiì˜-êµ¬í˜„-ë³€ê²½ì‚¬í•­">âœ… 1. ê¸°ì¡´ Transformer ëŒ€ë¹„ MELODIì˜ êµ¬í˜„ ë³€ê²½ì‚¬í•­</a></li>
    <li><a href="#-2-ì—°ì‚°ëŸ‰-ë°-íŒŒë¼ë¯¸í„°-ì¦ê°€ëŸ‰-ìˆ˜ì¹˜-ê¸°ë°˜">âœ… 2. ì—°ì‚°ëŸ‰ ë° íŒŒë¼ë¯¸í„° ì¦ê°€ëŸ‰ (ìˆ˜ì¹˜ ê¸°ë°˜)</a>
      <ul>
        <li><a href="#ê¸°ì¤€">ê¸°ì¤€:</a></li>
        <li><a href="#-a-ì¶”ê°€ë˜ëŠ”-íŒŒë¼ë¯¸í„°-ìˆ˜-ì´ëŸ‰ì€-transformer-í•˜ë‚˜ë‹¹--100m-ìˆ˜ì¤€">ğŸ§  [A] ì¶”ê°€ë˜ëŠ” íŒŒë¼ë¯¸í„° ìˆ˜ (ì´ëŸ‰ì€ transformer í•˜ë‚˜ë‹¹ â‰ˆ 100M ìˆ˜ì¤€)</a>
          <ul>
            <li><a href="#1-linear-token-mixer-2ê°œ-per-stm-layer">1. <strong>Linear token mixer (2ê°œ per STM layer)</strong></a></li>
            <li><a href="#2-gating-scalar-Î±-per-head">2. <strong>Gating scalar (Î± per head)</strong></a></li>
          </ul>
        </li>
        <li><a href="#-b-ì—°ì‚°ëŸ‰-flops-ì¦ê°€">âš™ï¸ [B] ì—°ì‚°ëŸ‰ (FLOPs) ì¦ê°€</a>
          <ul>
            <li><a href="#1-ì¶”ê°€-attention-ì…ë ¥-ìˆ˜-ì¦ê°€-stm">1. <strong>ì¶”ê°€ attention ì…ë ¥ ìˆ˜ ì¦ê°€</strong> (STM)</a></li>
            <li><a href="#2-ltm-cross-attention">2. <strong>LTM cross-attention</strong></a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#-3-ë©”ëª¨ë¦¬-ì‚¬ìš©ëŸ‰">ğŸ’¾ 3. ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰</a></li>
    <li><a href="#-4-êµ¬í˜„-ê³µìˆ˜-ì—”ì§€ë‹ˆì–´ë§-ê´€ì ">ğŸ‘·â€â™€ï¸ 4. êµ¬í˜„ ê³µìˆ˜ (ì—”ì§€ë‹ˆì–´ë§ ê´€ì )</a></li>
    <li><a href="#-ê²°ë¡ -ìš”ì•½-1">âœ… ê²°ë¡  ìš”ì•½</a></li>
  </ul>

  <ul>
    <li><a href="#-ì…ë ¥-ë°ì´í„°-ì˜ˆì‹œ-ë°-ì „ì²˜ë¦¬">âœ… ì…ë ¥ ë°ì´í„° ì˜ˆì‹œ ë° ì „ì²˜ë¦¬</a>
      <ul>
        <li><a href="#ì…ë ¥-ì˜ˆì‹œ-ê¸´-ë¬¸ì„œ">ì…ë ¥ ì˜ˆì‹œ (ê¸´ ë¬¸ì„œ)</a></li>
        <li><a href="#ì „ì²˜ë¦¬">ì „ì²˜ë¦¬</a></li>
      </ul>
    </li>
    <li><a href="#-ì¶”ë¡ -íë¦„-forward-logic-ì˜ˆì‹œ">ğŸ§  ì¶”ë¡  íë¦„ (forward logic ì˜ˆì‹œ)</a>
      <ul>
        <li><a href="#ë‚´ë¶€-ì²˜ë¦¬-ìˆœì„œ">ë‚´ë¶€ ì²˜ë¦¬ ìˆœì„œ</a></li>
      </ul>
    </li>
    <li><a href="#-ëª¨ë¸-ì•„í‚¤í…ì²˜-êµ¬ì„±">ğŸ—ï¸ ëª¨ë¸ ì•„í‚¤í…ì²˜ êµ¬ì„±</a></li>
    <li><a href="#-ë©”ëª¨ë¦¬-ìš”êµ¬ëŸ‰-ê³„ì‚°">ğŸ’¾ ë©”ëª¨ë¦¬ ìš”êµ¬ëŸ‰ ê³„ì‚°</a>
      <ul>
        <li><a href="#1-short-term-memory">1. Short-Term Memory</a></li>
        <li><a href="#2-long-term-memory">2. Long-Term Memory</a></li>
        <li><a href="#3-inputactivation-buffer-xâ‚–-16-windows">3. Input/Activation buffer (xâ‚–: 16 windows)</a></li>
      </ul>
    </li>
    <li><a href="#-ì—°ì‚°ëŸ‰-flops-ê¸°ì¤€-ë‹¨ì¼-window-ì²˜ë¦¬-ê¸°ì¤€">âš™ï¸ ì—°ì‚°ëŸ‰ (FLOPs ê¸°ì¤€, ë‹¨ì¼ window ì²˜ë¦¬ ê¸°ì¤€)</a>
      <ul>
        <li><a href="#1-shorttermlayer--8-layers">1. ShortTermLayer Ã— 8 layers</a></li>
        <li><a href="#2-longtermlayer-1-layer">2. LongTermLayer (1 layer)</a></li>
      </ul>
    </li>
    <li><a href="#-ìš”ì•½-ì •ë¦¬">âœ… ìš”ì•½ ì •ë¦¬</a></li>
  </ul>

  <ul>
    <li><a href="#-melodiì˜-í•µì‹¬-í•œê³„">âœ… MELODIì˜ í•µì‹¬ í•œê³„</a></li>
    <li><a href="#-í•œê³„-ê·¹ë³µì„-ìœ„í•œ-ì—°êµ¬-íë¦„">ğŸ” í•œê³„ ê·¹ë³µì„ ìœ„í•œ ì—°êµ¬ íë¦„</a>
      <ul>
        <li><a href="#1--pretrained-ëª¨ë¸ì—-melodi-memory-ì‚½ì…">1. ğŸ”„ Pretrained ëª¨ë¸ì— MELODI memory ì‚½ì…</a></li>
        <li><a href="#2--adaptive-compression-memory-ì••ì¶•-ì ì‘í™”">2. ğŸ§  Adaptive Compression Memory (ì••ì¶• ì ì‘í™”)</a></li>
        <li><a href="#3--recursive-memory-compression">3. ğŸ” Recursive Memory Compression</a></li>
        <li><a href="#4--ë¹„ìˆœì°¨ì -memory-ì ‘ê·¼-ì§€ì›">4. âš¡ ë¹„ìˆœì°¨ì  memory ì ‘ê·¼ ì§€ì›</a></li>
        <li><a href="#5--multi-modal-í™•ì¥">5. ğŸŒ Multi-modal í™•ì¥</a></li>
      </ul>
    </li>
    <li><a href="#-ì¢…í•©-ì •ë¦¬-ì—°êµ¬-ë°©í–¥-ë§¤í•‘">ğŸ§© ì¢…í•© ì •ë¦¬: ì—°êµ¬ ë°©í–¥ ë§¤í•‘</a></li>
  </ul>

  <ul>
    <li><a href="#-melodiì˜-memory-êµ¬ì¡°ì™€-ë™ì‘-ë°©ì‹">âœ… MELODIì˜ Memory êµ¬ì¡°ì™€ ë™ì‘ ë°©ì‹</a>
      <ul>
        <li><a href="#1-short-term-memory-stm-layer-wise-recurrent-compression">1. Short-Term Memory (STM): Layer-wise recurrent compression</a></li>
        <li><a href="#2-long-term-memory-ltm-mid-layer-compression--fifo-stacking">2. Long-Term Memory (LTM): Mid-layer compression + FIFO stacking</a></li>
      </ul>
    </li>
    <li><a href="#-ê¸°ì¡´-memory-augmented-ëª¨ë¸ê³¼ì˜-ë¹„êµ">ğŸ“Š ê¸°ì¡´ memory-augmented ëª¨ë¸ê³¼ì˜ ë¹„êµ</a></li>
    <li><a href="#-melodiì˜-êµ¬ì¡°ì -ì´ì -ìš”ì•½">ğŸ¯ MELODIì˜ êµ¬ì¡°ì  ì´ì  ìš”ì•½</a></li>
  </ul>

  <ul>
    <li><a href="#-hierarchical-memory-compressionì´ë€">âœ… Hierarchical Memory Compressionì´ë€?</a></li>
    <li><a href="#-ablation-ì‹¤í—˜ìœ¼ë¡œ-í™•ì¸ëœ-ê¸°ì—¬">ğŸ§ª Ablation ì‹¤í—˜ìœ¼ë¡œ í™•ì¸ëœ ê¸°ì—¬</a>
      <ul>
        <li><a href="#1-stm--ltm-ì¡°í•©ì˜-ì„±ëŠ¥-í–¥ìƒ-fig-4">1. STM + LTM ì¡°í•©ì˜ ì„±ëŠ¥ í–¥ìƒ (Fig. 4)</a></li>
        <li><a href="#2-ltm-coverageê°€-ì„±ëŠ¥ì—-ë¯¸ì¹˜ëŠ”-ì˜í–¥-fig-5">2. LTM coverageê°€ ì„±ëŠ¥ì— ë¯¸ì¹˜ëŠ” ì˜í–¥ (Fig. 5)</a></li>
        <li><a href="#3-summary-branching-ê¸°ë²•ì˜-ì˜í–¥-table-4">3. Summary Branching ê¸°ë²•ì˜ ì˜í–¥ (Table 4)</a></li>
      </ul>
    </li>
    <li><a href="#-ì •ë¦¬-ì„±ëŠ¥-í–¥ìƒì—-ê¸°ì—¬í•œ-í•µì‹¬-í¬ì¸íŠ¸">ğŸ“Œ ì •ë¦¬: ì„±ëŠ¥ í–¥ìƒì— ê¸°ì—¬í•œ í•µì‹¬ í¬ì¸íŠ¸</a></li>
    <li><a href="#-ê²°ë¡ -1">ğŸ¯ ê²°ë¡ </a></li>
  </ul>

  <ul>
    <li><a href="#-melodi-êµ¬ì¡°ì˜-ì£¼ìš”-í•œê³„ì™€-ì‹¤ì œ-ì œì•½">âœ… MELODI êµ¬ì¡°ì˜ ì£¼ìš” í•œê³„ì™€ ì‹¤ì œ ì œì•½</a>
      <ul>
        <li><a href="#1-ì‚¬ì „í•™ìŠµpretrained-ëª¨ë¸-ì ìš©-ì–´ë ¤ì›€">1. ì‚¬ì „í•™ìŠµ(pretrained) ëª¨ë¸ ì ìš© ì–´ë ¤ì›€</a></li>
        <li><a href="#2-ìˆœì°¨ì -ì²˜ë¦¬-window-by-window">2. ìˆœì°¨ì  ì²˜ë¦¬ (window-by-window)</a></li>
        <li><a href="#3-ë©”ëª¨ë¦¬-ì••ì¶•ì˜-ì •ë³´-ì†ì‹¤-ê°€ëŠ¥ì„±">3. ë©”ëª¨ë¦¬ ì••ì¶•ì˜ ì •ë³´ ì†ì‹¤ ê°€ëŠ¥ì„±</a></li>
      </ul>
    </li>
    <li><a href="#-ê¸°ìˆ ì -í™•ì¥-ê°€ëŠ¥ì„±-ë°-ë³´ì™„-ë°©ì•ˆ">ğŸ”§ ê¸°ìˆ ì  í™•ì¥ ê°€ëŠ¥ì„± ë° ë³´ì™„ ë°©ì•ˆ</a>
      <ul>
        <li><a href="#1-pretrained-ëª¨ë¸ê³¼ì˜-í˜¸í™˜ì„-ìœ„í•œ-adapter-based-ì‚½ì…">1. <strong>Pretrained ëª¨ë¸ê³¼ì˜ í˜¸í™˜ì„ ìœ„í•œ Adapter-based ì‚½ì…</strong></a></li>
        <li><a href="#2-ë¹„ìˆœì°¨ì -memory-ì ‘ê·¼-êµ¬ì¡°ë¡œ-parallelism-í™•ë³´">2. <strong>ë¹„ìˆœì°¨ì  memory ì ‘ê·¼ êµ¬ì¡°ë¡œ parallelism í™•ë³´</strong></a></li>
        <li><a href="#3-ì •ë³´-ì†ì‹¤-ìµœì†Œí™”ë¥¼-ìœ„í•œ-adaptive-memory-compression">3. <strong>ì •ë³´ ì†ì‹¤ ìµœì†Œí™”ë¥¼ ìœ„í•œ Adaptive Memory Compression</strong></a></li>
        <li><a href="#4-memory-ì¬í™œìš©-êµ¬ì¡°-ì¶”ê°€-compressive-memory">4. <strong>Memory ì¬í™œìš© êµ¬ì¡° ì¶”ê°€ (Compressive Memory)</strong></a></li>
        <li><a href="#5-multi-modal-í™•ì¥ì„±-í™•ë³´">5. <strong>Multi-modal í™•ì¥ì„± í™•ë³´</strong></a></li>
      </ul>
    </li>
    <li><a href="#-ê²°ë¡ -ìš”ì•½-2">ğŸ“Œ ê²°ë¡  ìš”ì•½</a></li>
  </ul>
</nav>
          </div>
      </nav>
    </div>

    
    <div class="border-border bg-muted/20 border-t px-4 py-3">
      <div class="text-muted-foreground text-center text-xs">
        <span>ì œëª©ì„ í´ë¦­í•˜ë©´ í•´ë‹¹ ìœ„ì¹˜ë¡œ ì´ë™í•©ë‹ˆë‹¤</span>
      </div>
    </div>
  </div>
</div>

    


  <link
    rel="stylesheet"
    href="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.css"
    integrity="sha384-5TcZemv2l/9On385z///+d7MSYlvIEw9FuZTIdZ14vJLqWphw7e7ZPuOiCHJcFCP"
    crossorigin="anonymous" />
  <script
    defer
    src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.js"
    integrity="sha384-cMkvdD8LoxVzGF/RPUKAcvmm49FQ0oxwDF3BGKtDXcEc+T1b2N+teh/OJfpU0jr6"
    crossorigin="anonymous"></script>
  <script
    defer
    src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/contrib/auto-render.min.js"
    integrity="sha384-hCXGrW6PitJEwbkoStFjeJxv+fSOOQKOPbJxSfM6G5sWZjAyWhXiTIIAmQqnlLlh"
    crossorigin="anonymous"></script>

<script>
    
    function initKaTeX() {
        if (typeof renderMathInElement === 'undefined') {
            setTimeout(initKaTeX, 100);
            return;
        }

        var delimiters = [{"display":true,"left":"$$","right":"$$"},{"display":false,"left":"$","right":"$"}];

        renderMathInElement(document.body, {
            delimiters: delimiters,
            throwOnError: false,
            errorColor: '#cc0000',
            fleqn: false,
            leqno: false,
            trust: false
        });
    }

    
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', initKaTeX);
    } else {
        initKaTeX();
    }
</script>
    



    
    
<div
  id="search-overlay"
  class="pointer-events-none fixed inset-0 z-40 bg-black/50 opacity-0 transition-opacity duration-300"></div>


<div
  id="search-modal"
  class="bg-card border-border pointer-events-none fixed top-1/2 left-1/2 z-50 max-h-[80vh] w-full max-w-2xl -translate-x-1/2 -translate-y-1/2 scale-95 transform overflow-hidden rounded-xl border opacity-0 shadow-xl transition-all duration-300">
  
  <div class="border-border flex items-center gap-3 border-b p-4">
    
    <div class="text-muted-foreground h-5 w-5 flex-shrink-0">
      
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m21 21-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />

</svg>
    </div>

    
    <div class="relative flex-1">
      
      <button
        id="search-clear"
        class="text-muted-foreground hover:text-foreground hover:bg-muted/50 pointer-events-none absolute top-1/2 left-0 z-10 h-5 w-5 -translate-y-1/2 rounded opacity-0 transition-all duration-200"
        title="ì§€ìš°ê¸°"
        aria-label="ì§€ìš°ê¸°">
        
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />

</svg>
      </button>

      
      <input
        id="search-input"
        type="text"
        placeholder="ê²Œì‹œê¸€ ê²€ìƒ‰..."
        class="text-foreground placeholder:text-muted-foreground w-full border-none bg-transparent pl-8 text-lg outline-none"
        autocomplete="off"
        spellcheck="false" />
    </div>

    
    <button
      id="search-close"
      class="text-muted-foreground hover:text-foreground hover:bg-muted/50 flex h-6 w-6 items-center justify-center rounded-md p-0.5 transition-all duration-200"
      title="ë‹«ê¸°"
      aria-label="ë‹«ê¸°">
      
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />

</svg>
    </button>
  </div>

  
  <div id="search-results" class="max-h-96 overflow-y-auto">
    
    <div
      id="search-empty"
      class="flex flex-col items-center justify-center py-12 text-center">
      <div
        class="bg-muted/50 mb-4 flex h-16 w-16 items-center justify-center rounded-full">
        
  <svg class="h-6 w-6"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m21 21-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />

</svg>
      </div>
      <h3 class="text-foreground mb-2 text-lg font-semibold">
        ê²€ìƒ‰ ì‹œì‘
      </h3>
      <p class="text-muted-foreground text-sm">
        ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•˜ì„¸ìš”
      </p>
    </div>

    
    <div
      id="search-loading"
      class="flex hidden items-center justify-center py-8">
      <div
        class="mr-3 h-6 w-6 animate-spin rounded-full border-2 border-current border-t-transparent"></div>
      <span class="text-muted-foreground"
        >ê²€ìƒ‰ ì¤‘...</span
      >
    </div>

    
    <div
      id="search-no-results"
      class="flex hidden flex-col items-center justify-center py-12 text-center">
      <div
        class="bg-muted/50 mb-4 flex h-16 w-16 items-center justify-center rounded-full">
        
  <svg class="h-6 w-6"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h7" />
</svg>
      </div>
      <h3 class="text-foreground mb-2 text-lg font-semibold">
        ê²€ìƒ‰ ê²°ê³¼ ì—†ìŒ
      </h3>
      <p class="text-muted-foreground text-sm">
        ë‹¤ë¥¸ ê²€ìƒ‰ì–´ë¡œ ì‹œë„í•´ë³´ì„¸ìš”
      </p>
    </div>

    
    <div id="search-results-list" class="hidden">
      
      <div
        id="search-stats"
        class="text-muted-foreground border-border border-b px-4 py-3 text-sm"
        data-template="%dê°œì˜ ê²°ê³¼ ì°¾ìŒ">
      </div>

      
      <div id="search-items" class="divide-border divide-y">
        
      </div>
    </div>
  </div>

  
  <div class="border-border bg-muted/20 border-t px-4 py-3">
    <div
      class="text-muted-foreground flex items-center justify-between text-xs">
      <div class="flex items-center gap-2 md:gap-4">
        <div class="flex items-center gap-1">
          <kbd
            class="bg-muted border-border rounded border px-1.5 py-0.5 text-xs"
            >â†‘â†“</kbd
          >
          <span class="hidden sm:inline"
            >ì´ë™</span
          >
        </div>
        <div class="flex items-center gap-1">
          <kbd
            class="bg-muted border-border rounded border px-1.5 py-0.5 text-xs"
            >â†µ</kbd
          >
          <span class="hidden sm:inline"
            >ì„ íƒ</span
          >
        </div>
        <div class="flex items-center gap-1">
          <kbd
            class="bg-muted border-border rounded border px-1.5 py-0.5 text-xs"
            >ESC</kbd
          >
          <span class="hidden sm:inline"
            >ë‹«ê¸°</span
          >
        </div>
      </div>
      <div class="search-hint-desktop flex items-center gap-1">
        <kbd class="bg-muted border-border rounded border px-1.5 py-0.5 text-xs"
          >âŒ˜K</kbd
        >
        <span>ë‹¨ì¶•í‚¤</span>
      </div>
    </div>
  </div>
</div>

  </body>
</html>
