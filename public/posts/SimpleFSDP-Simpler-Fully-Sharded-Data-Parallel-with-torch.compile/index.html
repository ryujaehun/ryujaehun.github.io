<!doctype html>
<html
  lang="ko-kr"
  data-theme="claude">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1314&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8" />
<meta
  name="viewport"
  content="width=device-width, initial-scale=1, shrink-to-fit=no" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />

<title>SimpleFSDP: Simpler Fully Sharded Data Parallel with torch.compile | Jaehun&#39;s Blog</title>

<meta name="description" content="논문 링크
Q : 이 논문을 아주 자세하게 읽고 논문의 강점과 독창적인 지점을 설명해주고 핵심 알고리즘을 예시 입력을 들어서 전체적인 과정을 설명해줘 추가적으로 논문의 한계점에 대해서도 알려줘 \
논문의 요약 및 강점 논문의 제목:
SimpleFSDP: Simpler..." />
<meta name="keywords" content="개발, 컴파일러, 프로그래밍, 에세이" />
<meta name="author" content="" />
<meta name="language" content="ko-kr" />

<meta name="robots" content="index, follow" />
<link rel="canonical" href="http://192.168.1.11:1314/posts/SimpleFSDP-Simpler-Fully-Sharded-Data-Parallel-with-torch.compile/" />



  <link rel="icon" type="image/svg+xml" href="/favicon.svg" />



<link rel="manifest" href="/site.webmanifest" />
<meta property="og:url" content="http://192.168.1.11:1314/posts/SimpleFSDP-Simpler-Fully-Sharded-Data-Parallel-with-torch.compile/">
  <meta property="og:site_name" content="Jaehun&#39;s Blog">
  <meta property="og:title" content="SimpleFSDP: Simpler Fully Sharded Data Parallel with torch.compile">
  <meta property="og:description" content="논문 링크
Q : 이 논문을 아주 자세하게 읽고 논문의 강점과 독창적인 지점을 설명해주고 핵심 알고리즘을 예시 입력을 들어서 전체적인 과정을 설명해줘 추가적으로 논문의 한계점에 대해서도 알려줘 \">
  <meta property="og:locale" content="ko_kr">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-12-23T00:00:00+00:00">
    <meta property="article:modified_time" content="2024-12-23T00:00:00+00:00">
    <meta property="og:image" content="http://192.168.1.11:1314/images/og-default.avif">


  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="http://192.168.1.11:1314/images/og-default.avif">
  <meta name="twitter:title" content="SimpleFSDP: Simpler Fully Sharded Data Parallel with torch.compile">
  <meta name="twitter:description" content="논문 링크
Q : 이 논문을 아주 자세하게 읽고 논문의 강점과 독창적인 지점을 설명해주고 핵심 알고리즘을 예시 입력을 들어서 전체적인 과정을 설명해줘 추가적으로 논문의 한계점에 대해서도 알려줘 \">


  <meta itemprop="name" content="SimpleFSDP: Simpler Fully Sharded Data Parallel with torch.compile">
  <meta itemprop="description" content="논문 링크
Q : 이 논문을 아주 자세하게 읽고 논문의 강점과 독창적인 지점을 설명해주고 핵심 알고리즘을 예시 입력을 들어서 전체적인 과정을 설명해줘 추가적으로 논문의 한계점에 대해서도 알려줘 \">
  <meta itemprop="datePublished" content="2024-12-23T00:00:00+00:00">
  <meta itemprop="dateModified" content="2024-12-23T00:00:00+00:00">
  <meta itemprop="wordCount" content="10761">
  <meta itemprop="image" content="http://192.168.1.11:1314/images/og-default.avif">
  <meta itemprop="keywords" content="Paper-Review,With-Gpt">







<script>
  window.HUGO_SEARCH_CONFIG = {
    searchIndexURL: "\"/index.json\""
  };
</script>


































<script>

  window.HUGO_GALLERY_CONFIG = {
    justified_gallery:  false ,
    lightbox:  false ,
    justified: "{}",
    lightbox_options: "{}"
  };
</script>




  
    <link rel="stylesheet" href="/css/compiled.css" />
  





  
    <link rel="stylesheet" href="/css/chroma.css" />
  












      <script src="/js/main.js"></script>



  <script src="/js/gumshoe.polyfills.min.js"></script>



        <script src="/js/toc.js" defer></script>



      <script src="/js/search.js" defer></script>



      <script src="/js/dock.js" defer></script>











  











    <script>
      
      (function() {
        const theme = localStorage.getItem('theme') || 'system';
        const colorScheme = localStorage.getItem('colorScheme') || 'claude';

        
        document.documentElement.setAttribute('data-theme', colorScheme);

        
        function applyTheme() {
          if (theme === 'dark' || (theme === 'system' && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
            document.documentElement.classList.add('dark');
          } else {
            document.documentElement.classList.remove('dark');
          }
        }

        applyTheme();

        
        if (theme === 'system') {
          window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', applyTheme);
        }
      })();
    </script>
  </head>

  <body class="bg-background text-foreground min-h-screen antialiased">
    
    
  <div
    id="reading-progress-container"
    class="reading-progress-container pointer-events-none fixed top-0 right-0 left-0 z-50 transition-opacity duration-300 ease-out"
    data-height="3"
    data-smooth-scroll="true"
    data-hide-on-complete="false">
    
    <div class="reading-progress-bg w-full"></div>

    
    <div
      id="reading-progress-bar"
      class="from-primary to-primary/80 reading-progress-bar 
        transition-all duration-150 ease-out
       absolute top-0 left-0 w-0 bg-gradient-to-r"></div>
  </div>

  <script>
    (function () {
      "use strict";

      const progressContainer = document.getElementById(
        "reading-progress-container",
      );
      const progressBar = document.getElementById("reading-progress-bar");

      if (!progressContainer || !progressBar) return;

      
      const config = {
        smoothScroll: progressContainer.dataset.smoothScroll === "true",
        hideOnComplete: progressContainer.dataset.hideOnComplete === "true",
      };

      let isVisible = true;
      let gumshoeInstance = null;

      
      function calculateProgress() {
        const scrollTop =
          window.pageYOffset || document.documentElement.scrollTop;
        const documentHeight = document.documentElement.scrollHeight;
        const windowHeight = window.innerHeight;
        const scrollableHeight = documentHeight - windowHeight;

        if (scrollableHeight <= 0) return 0;

        return Math.min(Math.max((scrollTop / scrollableHeight) * 100, 0), 100);
      }

      
      function updateProgress() {
        const progress = calculateProgress();
        progressBar.style.width = progress + "%";

        
        if (config.hideOnComplete && progress >= 99.5) {
          if (isVisible) {
            progressContainer.style.opacity = "0";
            isVisible = false;
          }
        } else if (!isVisible) {
          progressContainer.style.opacity = "1";
          isVisible = true;
        }
      }

      
      let ticking = false;
      function requestTick() {
        if (!ticking) {
          requestAnimationFrame(() => {
            updateProgress();
            ticking = false;
          });
          ticking = true;
        }
      }

      
      function init() {
        
        window.addEventListener("scroll", requestTick, { passive: true });
        window.addEventListener("resize", requestTick, { passive: true });
        document.addEventListener("visibilitychange", () => {
          if (!document.hidden) requestTick();
        });

        
        requestTick();

        
        window.addEventListener("beforeunload", () => {
          window.removeEventListener("scroll", requestTick);
          window.removeEventListener("resize", requestTick);
        });
      }

      
      if (document.readyState === "loading") {
        document.addEventListener("DOMContentLoaded", init);
      } else {
        init();
      }
    })();
  </script>

    <header class="sticky top-0 z-50 mx-auto max-w-4xl px-4 py-6">
  <div
    class="border-border bg-card/80 flex items-center rounded-xl border px-6 py-4 shadow-sm backdrop-blur-sm">
    
    <div class="hidden w-full items-center md:flex">
      
      <div class="flex items-center">
        
          
          <a
            href="/"
            class="bg-primary text-primary-foreground hover:bg-primary/90 flex h-10 w-10 items-center justify-center rounded-full text-lg font-bold transition-transform duration-200 hover:scale-105"
            aria-label="Jaehun&#39;s Blog">
            J
          </a>
        
      </div>

      
      <nav class="mx-8 flex flex-1 items-center justify-center">
        <div class="flex items-center space-x-1">
          
          
            
            
            
              
                
              
            
            
            <a
              href="/posts/"
              class="nav-link 
                text-muted-foreground hover:text-primary hover:bg-primary/10
               focus:ring-primary/20 relative flex items-center gap-2 rounded-lg px-4 py-2 text-sm font-medium transition-all duration-300 ease-out hover:-translate-y-0.5 hover:scale-105 focus:ring-2 focus:outline-none">
              
                
  <svg class="h-5 w-5"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="nav.posts">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 20H5a2 2 0 01-2-2V6a2 2 0 012-2h10a2 2 0 012 2v1m2 13a2 2 0 01-2-2V7m2 13a2 2 0 002-2V9a2 2 0 00-2-2h-2m-4-3H9M7 16h6M7 8h6v4H7V8z" />

</svg>
              
              <span
                >
                  게시글
                </span
              >
            </a>
          
            
            
            
              
                
              
            
            
            <a
              href="/categories/"
              class="nav-link 
                text-muted-foreground hover:text-primary hover:bg-primary/10
               focus:ring-primary/20 relative flex items-center gap-2 rounded-lg px-4 py-2 text-sm font-medium transition-all duration-300 ease-out hover:-translate-y-0.5 hover:scale-105 focus:ring-2 focus:outline-none">
              
                
  <svg class="h-5 w-5"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="nav.categories">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10" />

</svg>
              
              <span
                >
                  카테고리
                </span
              >
            </a>
          
            
            
            
              
                
              
            
            
            <a
              href="/tags/"
              class="nav-link 
                text-muted-foreground hover:text-primary hover:bg-primary/10
               focus:ring-primary/20 relative flex items-center gap-2 rounded-lg px-4 py-2 text-sm font-medium transition-all duration-300 ease-out hover:-translate-y-0.5 hover:scale-105 focus:ring-2 focus:outline-none">
              
                
  <svg class="h-5 w-5"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="nav.tags">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z" />

</svg>
              
              <span
                >
                  태그
                </span
              >
            </a>
          
            
            
            
              
                
              
            
            
            <a
              href="/archives/"
              class="nav-link 
                text-muted-foreground hover:text-primary hover:bg-primary/10
               focus:ring-primary/20 relative flex items-center gap-2 rounded-lg px-4 py-2 text-sm font-medium transition-all duration-300 ease-out hover:-translate-y-0.5 hover:scale-105 focus:ring-2 focus:outline-none">
              
                
  <svg class="h-5 w-5"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="nav.archives">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 8h14M5 8a2 2 0 110-4h14a2 2 0 110 4M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8m-9 4h4" />

</svg>
              
              <span
                >
                  아카이브
                </span
              >
            </a>
          
        </div>
      </nav>

      
      <div class="flex items-center space-x-2">
        
        
<div class="relative">
  <button id="language-toggle"
    class="dropdown-toggle border-border bg-background text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex h-10 w-10 items-center justify-center rounded-lg border transition-all duration-300 ease-out hover:scale-105 focus:ring-2 focus:outline-none active:scale-95"
    data-dropdown-type="language"
    aria-label="언어 변경"
    aria-expanded="false"
    aria-haspopup="true">
      
  <svg class="h-5 w-5 relative z-10"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="언어 변경">
	<path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m5 8l6 6m-7 0l6-6l2-3M2 5h12M7 2h1m14 20l-5-10l-5 10m2-4h6" />
</svg></button>

  
  <div id="language-dropdown"
    class="dropdown-menu border-border bg-popover/95 absolute top-12 right-0 z-[60] hidden w-40 rounded-lg border p-1 shadow-lg backdrop-blur-sm transition-all duration-200 ease-out"
    data-dropdown-type="language"
    role="menu"
    aria-labelledby="language-toggle"><a href="/ko/" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none" role="menuitem" aria-current="true"><span class="font-medium">한국어</span></a><a href="/en/" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none" role="menuitem"><span class="font-medium">English</span></a></div>
</div>

        
        
<div class="relative">
  <button id="color-scheme-toggle"
    class="dropdown-toggle border-border bg-background text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex h-10 w-10 items-center justify-center rounded-lg border transition-all duration-300 ease-out hover:scale-105 focus:ring-2 focus:outline-none active:scale-95"
    data-dropdown-type="color-scheme"
    aria-label="테마 변경"
    aria-expanded="false"
    aria-haspopup="true">
      
  <svg class="h-5 w-5 relative z-10"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="테마 변경">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zM21 5a2 2 0 00-2-2h-4a2 2 0 00-2 2v6a2 2 0 002 2h4a2 2 0 002-2V5z" />

</svg></button>

  
  <div id="color-scheme-dropdown"
    class="dropdown-menu border-border bg-popover/95 absolute top-12 right-0 z-[60] hidden w-44 rounded-lg border p-1 shadow-lg backdrop-blur-sm transition-all duration-200 ease-out"
    data-dropdown-type="color-scheme"><button data-color-scheme="claude" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Default</span></button><button data-color-scheme="default" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>White</span></button><button data-color-scheme="bumblebee" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Bumblebee</span></button><button data-color-scheme="emerald" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Emerald</span></button><button data-color-scheme="nord" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Nord</span></button><button data-color-scheme="sunset" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Sunset</span></button><button data-color-scheme="abyss" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Abyss</span></button><button data-color-scheme="dracula" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Dracula</span></button><button data-color-scheme="amethyst" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Amethyst</span></button><button data-color-scheme="slate" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Slate</span></button><button data-color-scheme="twitter" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Twitter</span></button></div>
</div>

        
        
<div class="relative">
  <button id="theme-toggle"
    class="dropdown-toggle border-border bg-background text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex h-10 w-10 items-center justify-center rounded-lg border transition-all duration-300 ease-out hover:scale-105 focus:ring-2 focus:outline-none active:scale-95"
    data-dropdown-type="theme"
    aria-label="테마 변경"
    aria-expanded="false"
    aria-haspopup="true">
      
      
  <svg class="h-5 w-5 sun-icon hidden relative z-10"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="라이트">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" />

</svg>
      
      
  <svg class="h-5 w-5 moon-icon hidden relative z-10"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="다크">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" />

</svg>
      
      
  <svg class="h-5 w-5 system-icon hidden relative z-10"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="시스템">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />

</svg></button>

  
  <div id="theme-dropdown"
    class="dropdown-menu border-border bg-popover/95 absolute top-12 right-0 z-[60] hidden w-40 rounded-lg border p-1 shadow-lg backdrop-blur-sm transition-all duration-200 ease-out"
    data-dropdown-type="theme"><button data-theme="light" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none">
  <svg class="h-5 w-5 mr-3 h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="라이트">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" />

</svg><span>라이트</span></button><button data-theme="dark" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none">
  <svg class="h-5 w-5 mr-3 h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="다크">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" />

</svg><span>다크</span></button><button data-theme="system" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none">
  <svg class="h-5 w-5 mr-3 h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="시스템">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />

</svg><span>시스템</span></button></div>
</div>
      </div>
    </div>

    
    <div class="flex w-full items-center justify-between md:hidden">
      
      
<div class="relative">
  <button
    id="mobile-menu-toggle"
    class="dropdown-toggle border-border bg-background text-muted-foreground hover:bg-accent hover:text-foreground flex h-10 w-10 items-center justify-center rounded-lg border transition-colors duration-200"
    data-dropdown-type="mobile-menu"
    aria-label="메뉴"
    aria-expanded="false"
    aria-haspopup="true">
    
  <svg class="h-5 w-5"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="메뉴">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />

</svg>
  </button>

  
  <div
    id="mobile-menu"
    class="mobile-menu dropdown-menu border-border bg-popover/95 absolute top-12 left-0 z-[60] hidden w-80 max-w-[calc(100vw-2rem)] rounded-lg border p-1 shadow-lg backdrop-blur-sm transition-all duration-200 ease-out md:hidden"
    data-dropdown-type="mobile-menu"
    role="menu"
    aria-labelledby="mobile-menu-toggle">
    <nav class="flex flex-col">
      
      
        
        
        
          
            
          
        
        
        <a
          href="/posts/"
          class="nav-link 
            text-muted-foreground hover:text-primary hover:bg-primary/10
           focus:ring-primary/20 relative flex items-center gap-3 rounded-md px-4 py-3 text-sm font-medium transition-all duration-200 ease-out hover:translate-x-1 focus:ring-2 focus:outline-none"
          role="menuitem"
          >
          
            
  <svg class="h-5 w-5"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="nav.posts">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 20H5a2 2 0 01-2-2V6a2 2 0 012-2h10a2 2 0 012 2v1m2 13a2 2 0 01-2-2V7m2 13a2 2 0 002-2V9a2 2 0 00-2-2h-2m-4-3H9M7 16h6M7 8h6v4H7V8z" />

</svg>
          
          <span
            >
              게시글
            </span
          >
        </a>
      
        
        
        
          
            
          
        
        
        <a
          href="/categories/"
          class="nav-link 
            text-muted-foreground hover:text-primary hover:bg-primary/10
           focus:ring-primary/20 relative flex items-center gap-3 rounded-md px-4 py-3 text-sm font-medium transition-all duration-200 ease-out hover:translate-x-1 focus:ring-2 focus:outline-none"
          role="menuitem"
          >
          
            
  <svg class="h-5 w-5"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="nav.categories">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10" />

</svg>
          
          <span
            >
              카테고리
            </span
          >
        </a>
      
        
        
        
          
            
          
        
        
        <a
          href="/tags/"
          class="nav-link 
            text-muted-foreground hover:text-primary hover:bg-primary/10
           focus:ring-primary/20 relative flex items-center gap-3 rounded-md px-4 py-3 text-sm font-medium transition-all duration-200 ease-out hover:translate-x-1 focus:ring-2 focus:outline-none"
          role="menuitem"
          >
          
            
  <svg class="h-5 w-5"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="nav.tags">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z" />

</svg>
          
          <span
            >
              태그
            </span
          >
        </a>
      
        
        
        
          
            
          
        
        
        <a
          href="/archives/"
          class="nav-link 
            text-muted-foreground hover:text-primary hover:bg-primary/10
           focus:ring-primary/20 relative flex items-center gap-3 rounded-md px-4 py-3 text-sm font-medium transition-all duration-200 ease-out hover:translate-x-1 focus:ring-2 focus:outline-none"
          role="menuitem"
          >
          
            
  <svg class="h-5 w-5"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="nav.archives">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 8h14M5 8a2 2 0 110-4h14a2 2 0 110 4M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8m-9 4h4" />

</svg>
          
          <span
            >
              아카이브
            </span
          >
        </a>
      
    </nav>
  </div>
</div>


      
      <div class="flex items-center space-x-2">
        
        
<div class="relative">
  <button id="language-toggle"
    class="dropdown-toggle border-border bg-background text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex h-10 w-10 items-center justify-center rounded-lg border transition-all duration-300 ease-out hover:scale-105 focus:ring-2 focus:outline-none active:scale-95"
    data-dropdown-type="language"
    aria-label="언어 변경"
    aria-expanded="false"
    aria-haspopup="true">
      
  <svg class="h-5 w-5 relative z-10"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="언어 변경">
	<path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m5 8l6 6m-7 0l6-6l2-3M2 5h12M7 2h1m14 20l-5-10l-5 10m2-4h6" />
</svg></button>

  
  <div id="language-dropdown"
    class="dropdown-menu border-border bg-popover/95 absolute top-12 right-0 z-[60] hidden w-40 rounded-lg border p-1 shadow-lg backdrop-blur-sm transition-all duration-200 ease-out"
    data-dropdown-type="language"
    role="menu"
    aria-labelledby="language-toggle"><a href="/ko/" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none" role="menuitem" aria-current="true"><span class="font-medium">한국어</span></a><a href="/en/" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none" role="menuitem"><span class="font-medium">English</span></a></div>
</div>

        
        
<div class="relative">
  <button id="color-scheme-toggle"
    class="dropdown-toggle border-border bg-background text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex h-10 w-10 items-center justify-center rounded-lg border transition-all duration-300 ease-out hover:scale-105 focus:ring-2 focus:outline-none active:scale-95"
    data-dropdown-type="color-scheme"
    aria-label="테마 변경"
    aria-expanded="false"
    aria-haspopup="true">
      
  <svg class="h-5 w-5 relative z-10"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="테마 변경">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zM21 5a2 2 0 00-2-2h-4a2 2 0 00-2 2v6a2 2 0 002 2h4a2 2 0 002-2V5z" />

</svg></button>

  
  <div id="color-scheme-dropdown"
    class="dropdown-menu border-border bg-popover/95 absolute top-12 right-0 z-[60] hidden w-44 rounded-lg border p-1 shadow-lg backdrop-blur-sm transition-all duration-200 ease-out"
    data-dropdown-type="color-scheme"><button data-color-scheme="claude" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Default</span></button><button data-color-scheme="default" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>White</span></button><button data-color-scheme="bumblebee" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Bumblebee</span></button><button data-color-scheme="emerald" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Emerald</span></button><button data-color-scheme="nord" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Nord</span></button><button data-color-scheme="sunset" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Sunset</span></button><button data-color-scheme="abyss" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Abyss</span></button><button data-color-scheme="dracula" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Dracula</span></button><button data-color-scheme="amethyst" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Amethyst</span></button><button data-color-scheme="slate" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Slate</span></button><button data-color-scheme="twitter" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Twitter</span></button></div>
</div>

        
        
<div class="relative">
  <button id="theme-toggle"
    class="dropdown-toggle border-border bg-background text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex h-10 w-10 items-center justify-center rounded-lg border transition-all duration-300 ease-out hover:scale-105 focus:ring-2 focus:outline-none active:scale-95"
    data-dropdown-type="theme"
    aria-label="테마 변경"
    aria-expanded="false"
    aria-haspopup="true">
      
      
  <svg class="h-5 w-5 sun-icon hidden relative z-10"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="라이트">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" />

</svg>
      
      
  <svg class="h-5 w-5 moon-icon hidden relative z-10"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="다크">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" />

</svg>
      
      
  <svg class="h-5 w-5 system-icon hidden relative z-10"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="시스템">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />

</svg></button>

  
  <div id="theme-dropdown"
    class="dropdown-menu border-border bg-popover/95 absolute top-12 right-0 z-[60] hidden w-40 rounded-lg border p-1 shadow-lg backdrop-blur-sm transition-all duration-200 ease-out"
    data-dropdown-type="theme"><button data-theme="light" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none">
  <svg class="h-5 w-5 mr-3 h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="라이트">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" />

</svg><span>라이트</span></button><button data-theme="dark" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none">
  <svg class="h-5 w-5 mr-3 h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="다크">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" />

</svg><span>다크</span></button><button data-theme="system" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none">
  <svg class="h-5 w-5 mr-3 h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="시스템">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />

</svg><span>시스템</span></button></div>
</div>
      </div>
    </div>
  </div>
</header>


    <main class="mx-auto max-w-4xl px-4 py-6">
      
  
  <nav
  class="breadcrumb mb-4 md:mb-6 py-1"
  aria-label="경로">
  <ol class="text-muted-foreground flex items-center space-x-1 md:space-x-2 text-sm overflow-x-auto whitespace-nowrap scrollbar-hide py-1">
    
    <li class="flex-shrink-0">
      <a
        href="/"
        class="text-muted-foreground hover:text-primary hover:bg-primary/10 flex items-center gap-0.5 md:gap-1 rounded-lg px-1 md:px-3 py-0.5 md:py-1.5 transition-all duration-200 ease-out hover:-translate-y-0.5 hover:scale-[1.02]">
        
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="홈">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m3 12 2-2m0 0 7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" />

</svg>
        <span class="max-w-[4rem] md:max-w-none truncate">홈</span>
      </a>
    </li>

    
    
      <li class="flex items-center gap-1 md:gap-2 min-w-0">
        <span class="text-muted-foreground/50 flex-shrink-0"
          >
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
</svg>
        </span>

        
          
          <div class="flex items-center gap-1 md:gap-2 min-w-0">
            
              
              <a
                href="/posts"
                class="text-muted-foreground hover:text-primary hover:bg-primary/10 flex items-center gap-0.5 md:gap-1 rounded-lg px-1 md:px-3 py-0.5 md:py-1.5 transition-all duration-200 ease-out hover:-translate-y-0.5 hover:scale-[1.02] flex-shrink-0">
                
                  
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 20H5a2 2 0 01-2-2V6a2 2 0 012-2h10a2 2 0 012 2v1m2 13a2 2 0 01-2-2V7m2 13a2 2 0 002-2V9a2 2 0 00-2-2h-2m-4-3H9M7 16h6M7 8h6v4H7V8z" />

</svg>
                  <span class="max-w-[3rem] md:max-w-none truncate">게시글</span>
                
              </a>
              <span class="text-muted-foreground/50 flex-shrink-0"
                >
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
</svg></span
              >
            
            
            <span class="text-foreground flex items-center gap-0.5 md:gap-1 font-medium min-w-0">
              
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
</svg>
              <span class="max-w-[8rem] md:max-w-[16rem] lg:max-w-none truncate">SimpleFSDP: Simpler Fully Sharded Data Parallel with torch.compile</span>
            </span>
          </div>
        
      </li>
    

  </ol>
</nav>



  


  
  <header class="mb-8">
    


<div class="post-meta">
  
  <h1 class="text-foreground mb-6 text-3xl leading-tight font-bold md:text-4xl">
    SimpleFSDP: Simpler Fully Sharded Data Parallel with torch.compile
  </h1>

  
  


  
  <div class="bg-card border-border flex flex-col gap-4 rounded-xl border p-6">
    
    <div
      class="text-muted-foreground flex flex-wrap items-center gap-4 text-sm">
      
      <div class="flex items-center gap-2">
        
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="작성일"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
</svg>
        <time datetime="2024-12-23">
          2024년 12월 23일
        </time>
      </div>

      
      


      
      
        <div class="flex items-center gap-2">
          
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="읽는 시간"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
</svg>
          <span
            >22 분</span
          >
        </div>
      


      
      
        <div class="flex items-center gap-2">
          
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="단어 수"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h7" />
</svg>
          <span>10761 단어</span>
        </div>
      

    </div>

    
    
      <div class="flex flex-wrap items-center gap-4">
        
        
          <div class="flex items-center gap-2">
            
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="카테고리"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z" />
</svg>
            <span class="text-muted-foreground mr-2 text-sm"
              >카테고리:</span
            >
            <div class="flex flex-wrap gap-2">
              
                <a
                  href="/categories/paper-review/"
                  class="bg-primary/10 text-primary hover:bg-primary/20 focus:ring-primary/20 inline-flex items-center rounded-full px-3 py-1 text-sm font-medium transition-all duration-200 ease-out hover:-translate-y-0.5 hover:scale-105 hover:shadow-md focus:ring-2 focus:outline-none">
                  paper-review
                </a>
              
                <a
                  href="/categories/with-gpt/"
                  class="bg-primary/10 text-primary hover:bg-primary/20 focus:ring-primary/20 inline-flex items-center rounded-full px-3 py-1 text-sm font-medium transition-all duration-200 ease-out hover:-translate-y-0.5 hover:scale-105 hover:shadow-md focus:ring-2 focus:outline-none">
                  with-gpt
                </a>
              
            </div>
          </div>
        


        
        

      </div>
    


    
    

  </div>
</div>

  </header>

  
  <article class="prose prose-neutral dark:prose-invert mb-12 max-w-none">
    <p><a href="https://arxiv.org/abs/2411.00284v2">논문 링크</a></p>
<h1 id="q--이-논문을-아주-자세하게-읽고-논문의-강점과-독창적인-지점을-설명해주고-핵심-알고리즘을-예시-입력을-들어서-전체적인-과정을-설명해줘-추가적으로-논문의-한계점에-대해서도-알려줘">Q : 이 논문을 아주 자세하게 읽고 논문의 강점과 독창적인 지점을 설명해주고 핵심 알고리즘을 예시 입력을 들어서 전체적인 과정을 설명해줘 추가적으로 논문의 한계점에 대해서도 알려줘</h1>
<p>\</p>
<h3 id="논문의-요약-및-강점">논문의 요약 및 강점</h3>
<p><strong>논문의 제목:</strong><br>
SimpleFSDP: Simpler Fully Sharded Data Parallel with torch.compile</p>
<p><strong>핵심 요약:</strong><br>
SimpleFSDP는 PyTorch-native compiler 기반의 Fully Sharded Data Parallel (FSDP) 프레임워크로, 대규모 모델 분산 학습에서 메모리 사용량을 최대 28.54% 줄이고 학습 처리량을 최대 68.67% 개선했습니다. 이 방법은 PyTorch의 기존 프리미티브를 활용하여 통합 구현되었으며, 새롭게 추가된 <strong>IR 노드 버킷화</strong> 및 <strong>재정렬</strong>을 통해 계산과 통신의 오버랩을 최적화합니다.</p>
<p><strong>강점 및 독창적인 기여:</strong></p>
<ol>
<li><strong>간결성:</strong> 기존 코드베이스를 크게 변경하지 않고 사용 가능하며, PyTorch의 <code>torch.compile</code>로 통합된 풀 그래프를 추적합니다.</li>
<li><strong>구성 가능성:</strong> 텐서 병렬(Tensor Parallel), 파이프라인 병렬(Pipeline Parallel), 혼합 정밀도 학습(Mixed Precision Training)과 같은 최신 기술들과 원활히 통합 가능.</li>
<li><strong>성능:</strong> IR 노드 버킷화와 재정렬 최적화를 통해 높은 학습 효율을 달성.</li>
<li><strong>디버그 가능성:</strong> PyTorch 이거 모드(Eager Mode)에서 디버깅 기능을 유지하면서도 성능 향상.</li>
</ol>
<hr>
<h3 id="핵심-알고리즘-설명">핵심 알고리즘 설명</h3>
<h4 id="simplefsdp의-주요-과정"><strong>SimpleFSDP의 주요 과정:</strong></h4>
<ol>
<li>
<p><strong>모델 초기화 및 파라미터 샤딩</strong></p>
<ul>
<li>모델의 파라미터, 그래디언트, 옵티마 상태를 샤딩하여 GPU 간 분산.</li>
<li>파라미터는 PyTorch의 DTensor API를 사용해 샤드됨.</li>
</ul>
</li>
<li>
<p><strong>IR 노드 최적화</strong></p>
<ul>
<li><strong>버킷화(Bucketing):</strong> 다수의 통신 노드를 하나의 버킷으로 병합해 통신 빈도를 줄임.</li>
<li><strong>재정렬(Reordering):</strong> 통신을 계산과 병렬적으로 수행하도록 재배치.</li>
</ul>
</li>
<li>
<p><strong>자동 래핑(Auto-Wrapping):</strong></p>
<ul>
<li>사용자가 설정할 필요 없이, IR 노드를 자동으로 최적화하여 성능 향상.</li>
</ul>
</li>
</ol>
<hr>
<h4 id="예시-입력과-과정-설명"><strong>예시 입력과 과정 설명</strong></h4>
<h5 id="예시-단순-모델-학습">예시: 단순 모델 학습</h5>
<p><strong>입력:</strong><br>
Llama 3.1 모델, GPU 64개 사용, 배치 크기 16.</p>
<ol>
<li>
<p><strong>파라미터 샤딩:</strong><br>
각 GPU에 샤딩된 모델 파라미터를 분배.<br>
예) 파라미터 ( W )가 총 4개라면, GPU 1에는 ( W_1 ), GPU 2에는 ( W_2 )가 저장.</p>
</li>
<li>
<p><strong>버킷화 예시:</strong></p>
<ul>
<li>원래 통신 순서: AG1 → AG2 → AG3</li>
<li>버킷화 후: AG1+AG2 → AG3 (한 번에 처리).</li>
</ul>
</li>
<li>
<p><strong>재정렬:</strong><br>
계산 ( C1 )과 통신 AG1을 병렬로 수행하여 대기 시간을 줄임.</p>
</li>
<li>
<p><strong>자동 래핑:</strong><br>
사용자는 코드에서 직접 정의하지 않아도, SimpleFSDP가 IR 노드를 최적화하여 통신과 계산을 오버랩.</p>
</li>
</ol>
<h5 id="결과">결과:</h5>
<ul>
<li>메모리 사용량 감소: 약 11.61%</li>
<li>처리량 증가: 약 28.26%</li>
</ul>
<hr>
<h3 id="한계점">한계점</h3>
<ol>
<li>
<p><strong>자동 래핑의 비효율성:</strong><br>
특정 상황에서 메모리 사용량이 증가하거나 성능이 감소할 수 있음. 예를 들어, 70B 모델의 경우 약 10.61GiB 메모리 오버헤드가 발생.</p>
</li>
<li>
<p><strong>네트워크 모델링 한계:</strong><br>
현재 통신 시간 추정은 단순히 데이터 크기에 의존하며, 네트워크 토폴로지와 같은 요인은 고려되지 않음.</p>
</li>
<li>
<p><strong>비추적 가능한 코드:</strong><br>
데이터 의존적 제어 흐름이 포함된 코드는 풀 그래프 트레이싱을 방해할 수 있음.</p>
</li>
</ol>
<hr>
<h3 id="결론-및-미래-연구">결론 및 미래 연구</h3>
<p><strong>SimpleFSDP의 의의:</strong></p>
<ul>
<li>분산 학습에서 간결성과 성능을 모두 잡으면서도 PyTorch 생태계에 최적화된 혁신적인 접근 방식을 제시.</li>
<li>추후 연구로, 네트워크 토폴로지 기반 최적화 및 보다 정교한 자동 래핑 알고리즘 개발이 제안됨.</li>
</ul>
<p>이 논문은 대규모 모델의 분산 학습에서 최신 기술을 도입하며, 학계와 산업계 모두에 중요한 기여를 했습니다.</p>
<h1 id="q--논문의-핵심알고리즘을-예시를-들어-아주-자세하게-설명해주고-정리해-줘">Q : 논문의 핵심알고리즘을 예시를 들어 아주 자세하게 설명해주고 정리해 줘</h1>
<h3 id="simplefsdp의-핵심-알고리즘">SimpleFSDP의 핵심 알고리즘</h3>
<p>SimpleFSDP는 대규모 모델의 Fully Sharded Data Parallel (FSDP) 학습을 최적화하기 위해 <strong>버킷화(Bucketing)</strong> 및 **재정렬(Reordering)**을 활용합니다. 아래는 핵심 알고리즘의 과정과 예시를 들어 상세히 설명합니다.</p>
<hr>
<h3 id="1-파라미터-샤딩-및-통신-연산">1. <strong>파라미터 샤딩 및 통신 연산</strong></h3>
<h4 id="과정">과정:</h4>
<ul>
<li><strong>모델 파라미터 샤딩</strong>: 모델의 파라미터는 각 GPU에 균등하게 분배됩니다.
<ul>
<li>예를 들어, 파라미터 ( W )가 4개이고 GPU가 4개라면, GPU1은 ( W_1 ), GPU2는 ( W_2 ), &hellip; 로 샤딩됩니다.</li>
</ul>
</li>
<li><strong>통신 연산</strong>: 각 GPU는 필요한 계산을 위해 다른 GPU로부터 일부 데이터를 수집해야 합니다. 이를 위해 <strong>All-Gather</strong> 및 <strong>Reduce-Scatter</strong> 연산이 수행됩니다.</li>
</ul>
<hr>
<h3 id="2-ir-노드-버킷화bucketing">2. <strong>IR 노드 버킷화(Bucketing)</strong></h3>
<h4 id="목표">목표:</h4>
<p>통신 연산(All-Gather 및 Reduce-Scatter)의 개수를 줄이고, 병렬성을 극대화하여 계산 속도를 향상.</p>
<h4 id="구현">구현:</h4>
<ul>
<li><strong>버킷화</strong>는 여러 개의 All-Gather/Reduce-Scatter 연산을 하나로 묶습니다.</li>
<li><strong>큰 버퍼</strong>를 생성하여 데이터 전송을 한 번에 처리.</li>
</ul>
<h4 id="예시">예시:</h4>
<ul>
<li><strong>Before Bucketing</strong>:
<ul>
<li>GPU1: All-Gather ( W_1 )</li>
<li>GPU2: All-Gather ( W_2 )</li>
<li>GPU3: All-Gather ( W_3 )</li>
</ul>
</li>
<li><strong>After Bucketing</strong>:
<ul>
<li>GPU1~3: All-Gather ( [W_1, W_2, W_3] ) (한 번의 통신으로 처리).</li>
</ul>
</li>
</ul>
<hr>
<h3 id="3-ir-노드-재정렬reordering">3. <strong>IR 노드 재정렬(Reordering)</strong></h3>
<h4 id="목표-1">목표:</h4>
<p>통신 연산과 계산 연산이 서로 대기하지 않도록 병렬 수행.</p>
<h4 id="구현-1">구현:</h4>
<ul>
<li>**계산 연산(C1, C2)**과 통신 연산(All-Gather 및 Reduce-Scatter)을 <strong>CUDA 스트림</strong> 상에서 병렬 수행.</li>
<li><strong>선행 통신 작업</strong>이 후속 계산 작업과 겹치도록 조정.</li>
</ul>
<h4 id="예시-1">예시:</h4>
<ol>
<li><strong>원래 순서</strong>:
<ul>
<li>C1 → All-Gather → Wait → C2</li>
</ul>
</li>
<li><strong>재정렬 후</strong>:
<ul>
<li>All-Gather → C1 (병렬) → Wait → C2</li>
</ul>
</li>
</ol>
<p>이렇게 하면 계산(C1) 중에 통신이 완료되므로 전체 처리 속도가 빨라집니다.</p>
<hr>
<h3 id="4-자동-래핑auto-wrapping">4. <strong>자동 래핑(Auto-Wrapping)</strong></h3>
<h4 id="목표-2">목표:</h4>
<p>수작업 없이 사용자가 정의하지 않아도, IR 노드 버킷화 및 재정렬을 자동으로 최적화.</p>
<h4 id="구현-2">구현:</h4>
<ul>
<li><strong>그리디 알고리즘</strong>을 사용하여 통신 노드를 병합하고 계산 노드와 병렬로 수행.</li>
<li><strong>메모리 제약</strong>을 초과하지 않는 선에서 최적화 수행.</li>
</ul>
<h4 id="예시-2">예시:</h4>
<ul>
<li>GPU에 필요한 파라미터 ( W_1, W_2, W_3 )가 있다면, Auto-Wrapping은 다음을 수행:
<ol>
<li>( W_1 )와 ( W_2 )를 하나의 버킷으로 묶음.</li>
<li>( W_3 )는 다른 버킷으로 처리.</li>
<li>각 버킷은 계산 ( C1, C2 )와 병렬 수행.</li>
</ol>
</li>
</ul>
<hr>
<h3 id="전체-과정-요약">전체 과정 요약</h3>
<table>
  <thead>
      <tr>
          <th>단계</th>
          <th>입력 데이터</th>
          <th>처리 방식</th>
          <th>결과</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>샤딩</strong></td>
          <td>모델 파라미터 ( W )</td>
          <td>각 GPU로 균등 분배</td>
          <td>GPU1: ( W_1 ), GPU2: ( W_2 )</td>
      </tr>
      <tr>
          <td><strong>버킷화</strong></td>
          <td>All-Gather/Reduce-Scatter</td>
          <td>연산 병합 및 통신 빈도 감소</td>
          <td>통신 연산 수 감소</td>
      </tr>
      <tr>
          <td><strong>재정렬</strong></td>
          <td>IR 노드</td>
          <td>계산과 통신이 병렬 수행되도록 최적화</td>
          <td>대기 시간 단축</td>
      </tr>
      <tr>
          <td><strong>자동 래핑</strong></td>
          <td>모델 전체</td>
          <td>최적 래핑을 자동 생성</td>
          <td>사용자 입력 없이 최적화</td>
      </tr>
  </tbody>
</table>
<hr>
<h3 id="알고리즘의-효과">알고리즘의 효과</h3>
<ol>
<li><strong>메모리 절약:</strong> 버킷화와 재정렬을 통해 불필요한 중복 데이터를 최소화.</li>
<li><strong>처리량 증가:</strong> 통신과 계산의 병렬화를 극대화.</li>
<li><strong>자동화:</strong> 사용자의 개입 없이 최적화된 모델 래핑 제공.</li>
</ol>
<hr>
<h3 id="결과-1">결과</h3>
<p>Llama 3.1 70B 모델에서:</p>
<ul>
<li>메모리 사용량: 약 11.61% 감소.</li>
<li>처리량: 약 28.26% 증가.</li>
</ul>
<p>이 알고리즘은 대규모 모델 학습에서 높은 효율성과 확장성을 제공하며, 분산 학습의 주요 문제를 해결합니다.</p>
<h1 id="q--이-논문에서-제시한-결과를-자세하게-보고-다른-방법론에-비하여-특출난-점과-논문에서-제기하는-어떠한-방법이-이러한-결과를-도출하게-되었는지-논문에서-제시하는-이유와-너의-생각을-알려줘">Q : 이 논문에서 제시한 결과를 자세하게 보고 다른 방법론에 비하여 특출난 점과 논문에서 제기하는 어떠한 방법이 이러한 결과를 도출하게 되었는지 논문에서 제시하는 이유와 너의 생각을 알려줘</h1>
<h3 id="논문에서-제시한-결과와-특출난-점">논문에서 제시한 결과와 특출난 점</h3>
<hr>
<h4 id="제시된-주요-결과"><strong>제시된 주요 결과</strong></h4>
<ol>
<li>
<p><strong>성능 지표:</strong></p>
<ul>
<li><strong>메모리 절감:</strong> 최대 <strong>28.54%</strong> 절감 (Llama 3.1 405B 모델, FSDP2-Eager와 비교).</li>
<li><strong>처리량 증가:</strong> 최대 <strong>68.67%</strong> 증가 (405B 모델, FSDP2-Eager와 비교).</li>
</ul>
</li>
<li>
<p><strong>모델 크기에 따른 성능 변화:</strong></p>
<ul>
<li><strong>8B 모델 (FSDP):</strong>
<ul>
<li>메모리: 27.72% 절감.</li>
<li>처리량: 7.49% 증가.</li>
</ul>
</li>
<li><strong>70B 모델 (FSDP + Tensor Parallel + Pipeline Parallel):</strong>
<ul>
<li>메모리: 11.61% 절감.</li>
<li>처리량: 28.26% 증가.</li>
</ul>
</li>
<li><strong>405B 모델 (FSDP + Tensor Parallel + Pipeline Parallel):</strong>
<ul>
<li>메모리: 16.26% 절감.</li>
<li>처리량: 68.67% 증가.</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>자동 래핑 성능:</strong></p>
<ul>
<li>8B 모델에서 수동 래핑 대비 약 <strong>7.34%</strong> 추가 처리량 증가.</li>
<li>70B 모델에서 **약간의 메모리 오버헤드 발생 (10.61GiB)**에도 처리량 증가.</li>
</ul>
</li>
</ol>
<hr>
<h4 id="다른-방법론-대비-특출난-점"><strong>다른 방법론 대비 특출난 점</strong></h4>
<table>
  <thead>
      <tr>
          <th><strong>방법론</strong></th>
          <th><strong>메모리 절감</strong></th>
          <th><strong>처리량 증가</strong></th>
          <th><strong>특징</strong></th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>FSDP2-Eager</strong></td>
          <td>낮음</td>
          <td>낮음</td>
          <td>파라미터 샤딩만 지원, 통신 최적화 미흡.</td>
      </tr>
      <tr>
          <td><strong>FSDP2-Compile</strong></td>
          <td>중간</td>
          <td>중간</td>
          <td>계산 모듈만 컴파일, 통신 최적화 부족.</td>
      </tr>
      <tr>
          <td><strong>SimpleFSDP</strong></td>
          <td>최고</td>
          <td>최고</td>
          <td>통신과 계산의 전체 그래프 추적, IR 버킷화 및 재정렬 제공.</td>
      </tr>
  </tbody>
</table>
<hr>
<h3 id="논문에서-제시하는-결과의-이유">논문에서 제시하는 결과의 이유</h3>
<h4 id="1-ir-노드-버킷화bucketing"><strong>1. IR 노드 버킷화(Bucketing)</strong></h4>
<ul>
<li><strong>제안된 방식:</strong>
<ul>
<li>통신 연산(All-Gather, Reduce-Scatter)을 병합하여 통신 빈도를 줄임.</li>
<li>버킷화된 통신은 더 큰 데이터 덩어리를 한 번에 전송.</li>
</ul>
</li>
<li><strong>효과:</strong> 통신 대기 시간(Base Latency)이 감소하여 GPU 리소스 활용이 극대화됨.</li>
</ul>
<h4 id="2-ir-노드-재정렬reordering"><strong>2. IR 노드 재정렬(Reordering)</strong></h4>
<ul>
<li><strong>제안된 방식:</strong>
<ul>
<li>통신과 계산 연산이 병렬로 수행될 수 있도록 CUDA 스트림 재배치.</li>
<li>계산 작업 도중 통신을 미리 실행하여 전체 처리 시간 단축.</li>
</ul>
</li>
<li><strong>효과:</strong> 통신과 계산 간 병렬성 증가로 처리량 대폭 개선.</li>
</ul>
<h4 id="3-자동-래핑auto-wrapping"><strong>3. 자동 래핑(Auto-Wrapping)</strong></h4>
<ul>
<li><strong>제안된 방식:</strong>
<ul>
<li>수작업 없이 IR 노드를 병합하고 재정렬하는 최적화.</li>
<li>메모리 제한을 초과하지 않는 범위에서 그리디 알고리즘으로 최적화 수행.</li>
</ul>
</li>
<li><strong>효과:</strong> 사용자 개입 없이 최적화 수행, 대규모 모델에서도 성능 유지.</li>
</ul>
<hr>
<h3 id="논문에서-제시된-이유에-대한-내-의견"><strong>논문에서 제시된 이유에 대한 내 의견</strong></h3>
<h4 id="왜-이런-결과가-나왔는가"><strong>왜 이런 결과가 나왔는가?</strong></h4>
<ol>
<li>
<p><strong>통합적 접근 방식:</strong></p>
<ul>
<li>기존 방법론(FSDP2)은 계산 모듈만 컴파일하거나 통신을 수동으로 최적화.</li>
<li>SimpleFSDP는 통신과 계산의 <strong>풀 그래프</strong>를 추적하고 최적화, 더욱 정교한 결과를 냄.</li>
</ul>
</li>
<li>
<p><strong>IR 노드 기반 최적화의 효율성:</strong></p>
<ul>
<li>IR 노드 버킷화는 GPU 간 통신 오버헤드를 줄이면서 병렬성을 높임.</li>
<li>IR 노드 재정렬은 통신 대기 시간을 계산 시간과 겹치게 만들어 효율성을 극대화.</li>
</ul>
</li>
<li>
<p><strong>PyTorch-native 구현:</strong></p>
<ul>
<li>PyTorch의 <code>torch.compile</code>과 DTensor API를 활용하여 기존 코드와 통합성이 뛰어남.</li>
<li>기존 FSDP 방식보다 간단하면서도 강력한 성능 향상을 제공.</li>
</ul>
</li>
</ol>
<h4 id="비판적-관점에서의-평가"><strong>비판적 관점에서의 평가</strong></h4>
<ul>
<li>
<p><strong>장점:</strong></p>
<ul>
<li>통신 최적화와 계산의 동시 최적화라는 <strong>이중적 접근</strong>이 실제 학습 성능에 매우 긍정적 영향을 미침.</li>
<li>FSDP와 PyTorch-native 생태계의 강점을 최대한 활용.</li>
</ul>
</li>
<li>
<p><strong>한계:</strong></p>
<ul>
<li>Auto-Wrapping은 여전히 특정 시나리오에서 메모리 오버헤드를 발생시킴.</li>
<li>통신 시간 추정이 네트워크 토폴로지 등의 복잡한 요소를 반영하지 못해 최적 솔루션에서 벗어날 가능성 있음.</li>
</ul>
</li>
</ul>
<hr>
<h3 id="결론">결론</h3>
<p>SimpleFSDP는 대규모 모델 학습에 필요한 성능과 메모리 효율을 혁신적으로 개선한 방법론으로, IR 노드 최적화와 PyTorch-native 통합이 핵심 성공 요인입니다.<br>
다만, 자동 래핑의 한계와 통신 시간 추정의 정확성을 보완하면 더욱 강력한 방법론이 될 것입니다.</p>
<h1 id="q--이-논문의-입력데이터와-추론-과정에-대해서-예시를-들어-아주-자세하게-설명해-주겠니-추가적으로-모델아키텍처의-구성-및-모델을-구성하는-연산과-메모리-요구량-컴퓨팅-요구량-대해서도-설명해줘">Q : 이 논문의 입력데이터와 추론 과정에 대해서 예시를 들어 아주 자세하게 설명해 주겠니? 추가적으로 모델아키텍처의 구성 및 모델을 구성하는 연산과 메모리 요구량 컴퓨팅 요구량 대해서도 설명해줘</h1>
<h3 id="논문의-입력-데이터-및-추론-과정">논문의 입력 데이터 및 추론 과정</h3>
<hr>
<h4 id="입력-데이터"><strong>입력 데이터</strong></h4>
<ul>
<li>
<p><strong>학습 데이터:</strong><br>
C4 데이터셋 (Common Crawl 기반 텍스트 데이터셋).</p>
<ul>
<li>대규모 자연어 모델 학습에 적합.</li>
<li>Llama 3.1 모델 시리즈(8B, 70B, 405B)를 대상으로 학습.</li>
</ul>
</li>
<li>
<p><strong>예시 입력 데이터:</strong><br>
문장 텍스트, 예:</p>
<div
  class="code-block-container border-border bg-card my-6 overflow-hidden rounded-xl border shadow-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:shadow-md">
  
  <div
    class="code-block-header bg-muted/30 border-border flex items-center justify-between border-b px-4 py-3">
    
    <div class="flex items-center gap-2">
      <div class="text-muted-foreground flex-shrink-0">
        
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4" />
</svg>
      </div>
      <span class="text-muted-foreground text-sm font-medium">
        PLAINTEXT
      </span>
    </div>

    
    <div class="flex items-center gap-2">
      <button
          class="collapse-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none"
          data-code-id="code-0"
          data-default-state="expanded"
          data-collapsed="false"
          data-auto-collapse-lines="30"
          data-auto-collapse-height="400"
          data-collapsed-height="120"
          title="접기"
          aria-label="접기">
          <span class="collapse-icon">
            
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z"/></svg>
          </span>
          <span class="collapse-text hidden sm:inline"
            >접기</span
          >
        </button>
      <button
        class="copy-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none"
        data-code-id="code-0"
        title="복사"
        aria-label="복사">
        <span class="copy-icon">
          
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
</svg>
        </span>
        <span class="copy-text hidden sm:inline"
          >복사</span
        >
      </button>
    </div>
  </div>

  
  <div class="code-block-content relative" id="code-0">
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">&#34;The quick brown fox jumps over the lazy dog.&#34;</span></span></code></pre></div>
    
    <div
      class="collapse-overlay to-card/90 pointer-events-none absolute inset-0 bg-gradient-to-b from-transparent via-transparent opacity-0 transition-opacity duration-300">
      <div
        class="text-muted-foreground bg-card/80 border-border/50 hover:bg-primary/10 hover:text-primary hover:border-primary/30 absolute bottom-4 left-1/2 -translate-x-1/2 cursor-pointer rounded-full border px-3 py-1.5 text-xs backdrop-blur-sm transition-all duration-200">
        클릭하여 더 보기
      </div>
    </div>
  </div>
</div>


<script>
(function() {
  const codeId = 'code-0';
  const copyBtn = document.querySelector('.copy-code-btn[data-code-id="' + codeId + '"]');
  const collapseBtn = document.querySelector('.collapse-code-btn[data-code-id="' + codeId + '"]');
  const codeContainer = document.getElementById(codeId);

  if (!codeContainer) return;

  
  if (copyBtn) {
    const copyIcon = copyBtn.querySelector('.copy-icon');
    const copyText = copyBtn.querySelector('.copy-text');

    copyBtn.addEventListener('click', async function() {
      try {
        
        let codeText = '';

        
        const codeTableCell = codeContainer.querySelector('.lntd:last-child code');
        if (codeTableCell) {
          codeText = codeTableCell.textContent || codeTableCell.innerText;
        } else {
          
          const codeElement = codeContainer.querySelector('code');
          if (codeElement) {
            
            const hasInlineLineNumbers = codeElement.querySelector('.ln');
            if (hasInlineLineNumbers) {
              
              const codeLines = codeElement.querySelectorAll('.cl');
              if (codeLines.length > 0) {
                codeText = Array.from(codeLines)
                  .map(line => {
                    const text = line.textContent || line.innerText;
                    
                    return text.replace(/\n+$/, '');
                  })
                  .join('\n')
                  .replace(/\n+$/, ''); 
              } else {
                
                const allText = codeElement.textContent || codeElement.innerText;
                codeText = allText.replace(/^\d+/gm, '').replace(/^\s+/gm, '');
              }
            } else {
              
              codeText = codeElement.textContent || codeElement.innerText;
            }
          } else {
            
            codeText = codeContainer.textContent || codeContainer.innerText;
          }
        }

        
        codeText = codeText.trim();

        
        await navigator.clipboard.writeText(codeText);

        
        copyIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M5 13l4 4L19 7\u0022 \/\u003e\n\u003c\/svg\u003e`;
        if (copyText) {
          copyText.textContent = '복사됨';
        }
        copyBtn.classList.add('text-green-600');

        
        setTimeout(() => {
          copyIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z\u0022 \/\u003e\n\u003c\/svg\u003e`;
          if (copyText) {
            copyText.textContent = '복사';
          }
          copyBtn.classList.remove('text-green-600');
        }, 2000);

      } catch (err) {
        console.error('复制失败:', err);

        
        const range = document.createRange();
        const codeElement = codeContainer.querySelector('code') || codeContainer;
        range.selectNodeContents(codeElement);
        const selection = window.getSelection();
        selection.removeAllRanges();
        selection.addRange(range);

        
        if (copyText) {
          copyText.textContent = '선택됨';
        }

        setTimeout(() => {
          if (copyText) {
            copyText.textContent = '복사';
          }
          selection.removeAllRanges();
        }, 2000);
      }
    });
  }

  
  if (collapseBtn) {
    const collapseIcon = collapseBtn.querySelector('.collapse-icon');
    const collapseText = collapseBtn.querySelector('.collapse-text');
    const collapseOverlay = codeContainer.querySelector('.collapse-overlay');

    
    let codeElement = codeContainer.querySelector('pre.chroma');
    if (!codeElement) {
      codeElement = codeContainer.querySelector('pre');
    }

    const defaultState = collapseBtn.dataset.defaultState || 'expanded';
    const isCollapsedAttr = collapseBtn.dataset.collapsed === 'true';
    const autoCollapseLines = parseInt(collapseBtn.dataset.autoCollapseLines) || 30;
    const autoCollapseHeight = parseInt(collapseBtn.dataset.autoCollapseHeight) || 400;
    const collapsedHeight = parseInt(collapseBtn.dataset.collapsedHeight) || 120;

    let isCollapsed = false;

    
    function initCollapse() {
      
      const shouldCollapse = isCollapsedAttr ||
                           defaultState === 'collapsed' ||
                           shouldAutoCollapse();

      if (shouldCollapse) {
        setCollapsed(true, false); 
      }
    }

    function shouldAutoCollapse() {
      
      if (codeElement) {
        const lines = codeElement.querySelectorAll('.line, .cl');
        const height = codeElement.offsetHeight;
        return lines.length > autoCollapseLines || height > autoCollapseHeight;
      }

      
      const containerHeight = codeContainer.offsetHeight;
      if (containerHeight > autoCollapseHeight) {
        return true;
      }

      
      const textContent = codeContainer.textContent || codeContainer.innerText || '';
      const estimatedLines = textContent.split('\n').length;
      return estimatedLines > autoCollapseLines;
    }

    function setCollapsed(collapsed, animate = true) {
      if (!collapseOverlay) return;

      isCollapsed = collapsed;

      if (collapsed) {
        
        codeContainer.style.maxHeight = collapsedHeight + 'px';
        codeContainer.style.overflow = 'hidden';
        collapseOverlay.style.opacity = '1';
        collapseOverlay.style.pointerEvents = 'auto';

        
        collapseIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M19 9l-7 7-7-7\u0022 \/\u003e\n\u003c\/svg\u003e`;
        if (collapseText) {
          collapseText.textContent = '펼치기';
        }
        collapseBtn.title = '펼치기';

      } else {
        
        codeContainer.style.maxHeight = '';
        codeContainer.style.overflow = '';
        collapseOverlay.style.opacity = '0';
        collapseOverlay.style.pointerEvents = 'none';

        
        collapseIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath fill=\u0022currentColor\u0022 d=\u0022M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z\u0022\/\u003e\u003c\/svg\u003e`;
        if (collapseText) {
          collapseText.textContent = '접기';
        }
        collapseBtn.title = '접기';
      }

      
      if (animate) {
        codeContainer.style.transition = 'max-height 0.3s ease-out';
        setTimeout(() => {
          codeContainer.style.transition = '';
        }, 300);
      }
    }

    function toggleCollapse() {
      setCollapsed(!isCollapsed, true);
    }

    
    collapseBtn.addEventListener('click', toggleCollapse);

    
    if (collapseOverlay) {
      collapseOverlay.addEventListener('click', () => {
        if (isCollapsed) {
          setCollapsed(false, true);
        }
      });
    }

    
    initCollapse();
  }
})();
</script>
</li>
</ul>
<hr>
<h4 id="추론-과정"><strong>추론 과정</strong></h4>
<p>SimpleFSDP는 대규모 모델의 분산 추론에서 메모리와 통신 요구량을 줄이고 처리량을 증가시키기 위해 다음 과정을 수행합니다:</p>
<ol>
<li>
<p><strong>입력 텍스트 처리:</strong></p>
<ul>
<li>입력 문장은 토큰화하여 정수 시퀀스로 변환:
<div
  class="code-block-container border-border bg-card my-6 overflow-hidden rounded-xl border shadow-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:shadow-md">
  
  <div
    class="code-block-header bg-muted/30 border-border flex items-center justify-between border-b px-4 py-3">
    
    <div class="flex items-center gap-2">
      <div class="text-muted-foreground flex-shrink-0">
        
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4" />
</svg>
      </div>
      <span class="text-muted-foreground text-sm font-medium">
        PLAINTEXT
      </span>
    </div>

    
    <div class="flex items-center gap-2">
      <button
          class="collapse-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none"
          data-code-id="code-1"
          data-default-state="expanded"
          data-collapsed="false"
          data-auto-collapse-lines="30"
          data-auto-collapse-height="400"
          data-collapsed-height="120"
          title="접기"
          aria-label="접기">
          <span class="collapse-icon">
            
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z"/></svg>
          </span>
          <span class="collapse-text hidden sm:inline"
            >접기</span
          >
        </button>
      <button
        class="copy-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none"
        data-code-id="code-1"
        title="복사"
        aria-label="복사">
        <span class="copy-icon">
          
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
</svg>
        </span>
        <span class="copy-text hidden sm:inline"
          >복사</span
        >
      </button>
    </div>
  </div>

  
  <div class="code-block-content relative" id="code-1">
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">[101, 2005, 2147, 3126, 5409, 2027, 3980, 1996, 3265, 3899, 102]</span></span></code></pre></div>
    
    <div
      class="collapse-overlay to-card/90 pointer-events-none absolute inset-0 bg-gradient-to-b from-transparent via-transparent opacity-0 transition-opacity duration-300">
      <div
        class="text-muted-foreground bg-card/80 border-border/50 hover:bg-primary/10 hover:text-primary hover:border-primary/30 absolute bottom-4 left-1/2 -translate-x-1/2 cursor-pointer rounded-full border px-3 py-1.5 text-xs backdrop-blur-sm transition-all duration-200">
        클릭하여 더 보기
      </div>
    </div>
  </div>
</div>


<script>
(function() {
  const codeId = 'code-1';
  const copyBtn = document.querySelector('.copy-code-btn[data-code-id="' + codeId + '"]');
  const collapseBtn = document.querySelector('.collapse-code-btn[data-code-id="' + codeId + '"]');
  const codeContainer = document.getElementById(codeId);

  if (!codeContainer) return;

  
  if (copyBtn) {
    const copyIcon = copyBtn.querySelector('.copy-icon');
    const copyText = copyBtn.querySelector('.copy-text');

    copyBtn.addEventListener('click', async function() {
      try {
        
        let codeText = '';

        
        const codeTableCell = codeContainer.querySelector('.lntd:last-child code');
        if (codeTableCell) {
          codeText = codeTableCell.textContent || codeTableCell.innerText;
        } else {
          
          const codeElement = codeContainer.querySelector('code');
          if (codeElement) {
            
            const hasInlineLineNumbers = codeElement.querySelector('.ln');
            if (hasInlineLineNumbers) {
              
              const codeLines = codeElement.querySelectorAll('.cl');
              if (codeLines.length > 0) {
                codeText = Array.from(codeLines)
                  .map(line => {
                    const text = line.textContent || line.innerText;
                    
                    return text.replace(/\n+$/, '');
                  })
                  .join('\n')
                  .replace(/\n+$/, ''); 
              } else {
                
                const allText = codeElement.textContent || codeElement.innerText;
                codeText = allText.replace(/^\d+/gm, '').replace(/^\s+/gm, '');
              }
            } else {
              
              codeText = codeElement.textContent || codeElement.innerText;
            }
          } else {
            
            codeText = codeContainer.textContent || codeContainer.innerText;
          }
        }

        
        codeText = codeText.trim();

        
        await navigator.clipboard.writeText(codeText);

        
        copyIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M5 13l4 4L19 7\u0022 \/\u003e\n\u003c\/svg\u003e`;
        if (copyText) {
          copyText.textContent = '복사됨';
        }
        copyBtn.classList.add('text-green-600');

        
        setTimeout(() => {
          copyIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z\u0022 \/\u003e\n\u003c\/svg\u003e`;
          if (copyText) {
            copyText.textContent = '복사';
          }
          copyBtn.classList.remove('text-green-600');
        }, 2000);

      } catch (err) {
        console.error('复制失败:', err);

        
        const range = document.createRange();
        const codeElement = codeContainer.querySelector('code') || codeContainer;
        range.selectNodeContents(codeElement);
        const selection = window.getSelection();
        selection.removeAllRanges();
        selection.addRange(range);

        
        if (copyText) {
          copyText.textContent = '선택됨';
        }

        setTimeout(() => {
          if (copyText) {
            copyText.textContent = '복사';
          }
          selection.removeAllRanges();
        }, 2000);
      }
    });
  }

  
  if (collapseBtn) {
    const collapseIcon = collapseBtn.querySelector('.collapse-icon');
    const collapseText = collapseBtn.querySelector('.collapse-text');
    const collapseOverlay = codeContainer.querySelector('.collapse-overlay');

    
    let codeElement = codeContainer.querySelector('pre.chroma');
    if (!codeElement) {
      codeElement = codeContainer.querySelector('pre');
    }

    const defaultState = collapseBtn.dataset.defaultState || 'expanded';
    const isCollapsedAttr = collapseBtn.dataset.collapsed === 'true';
    const autoCollapseLines = parseInt(collapseBtn.dataset.autoCollapseLines) || 30;
    const autoCollapseHeight = parseInt(collapseBtn.dataset.autoCollapseHeight) || 400;
    const collapsedHeight = parseInt(collapseBtn.dataset.collapsedHeight) || 120;

    let isCollapsed = false;

    
    function initCollapse() {
      
      const shouldCollapse = isCollapsedAttr ||
                           defaultState === 'collapsed' ||
                           shouldAutoCollapse();

      if (shouldCollapse) {
        setCollapsed(true, false); 
      }
    }

    function shouldAutoCollapse() {
      
      if (codeElement) {
        const lines = codeElement.querySelectorAll('.line, .cl');
        const height = codeElement.offsetHeight;
        return lines.length > autoCollapseLines || height > autoCollapseHeight;
      }

      
      const containerHeight = codeContainer.offsetHeight;
      if (containerHeight > autoCollapseHeight) {
        return true;
      }

      
      const textContent = codeContainer.textContent || codeContainer.innerText || '';
      const estimatedLines = textContent.split('\n').length;
      return estimatedLines > autoCollapseLines;
    }

    function setCollapsed(collapsed, animate = true) {
      if (!collapseOverlay) return;

      isCollapsed = collapsed;

      if (collapsed) {
        
        codeContainer.style.maxHeight = collapsedHeight + 'px';
        codeContainer.style.overflow = 'hidden';
        collapseOverlay.style.opacity = '1';
        collapseOverlay.style.pointerEvents = 'auto';

        
        collapseIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M19 9l-7 7-7-7\u0022 \/\u003e\n\u003c\/svg\u003e`;
        if (collapseText) {
          collapseText.textContent = '펼치기';
        }
        collapseBtn.title = '펼치기';

      } else {
        
        codeContainer.style.maxHeight = '';
        codeContainer.style.overflow = '';
        collapseOverlay.style.opacity = '0';
        collapseOverlay.style.pointerEvents = 'none';

        
        collapseIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath fill=\u0022currentColor\u0022 d=\u0022M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z\u0022\/\u003e\u003c\/svg\u003e`;
        if (collapseText) {
          collapseText.textContent = '접기';
        }
        collapseBtn.title = '접기';
      }

      
      if (animate) {
        codeContainer.style.transition = 'max-height 0.3s ease-out';
        setTimeout(() => {
          codeContainer.style.transition = '';
        }, 300);
      }
    }

    function toggleCollapse() {
      setCollapsed(!isCollapsed, true);
    }

    
    collapseBtn.addEventListener('click', toggleCollapse);

    
    if (collapseOverlay) {
      collapseOverlay.addEventListener('click', () => {
        if (isCollapsed) {
          setCollapsed(false, true);
        }
      });
    }

    
    initCollapse();
  }
})();
</script>
</li>
<li>각 정수는 임베딩 레이어에서 실수 벡터로 매핑.</li>
</ul>
</li>
<li>
<p><strong>파라미터 샤딩:</strong></p>
<ul>
<li>모델의 파라미터를 각 GPU에 샤딩:
<ul>
<li>예를 들어, ( W )가 4개라면, GPU1은 ( W_1 ), GPU2는 ( W_2 )만 보유.</li>
</ul>
</li>
<li>샤딩된 파라미터는 All-Gather 연산을 통해 필요한 계산 시에만 통합.</li>
</ul>
</li>
<li>
<p><strong>계산 및 통신 연산:</strong></p>
<ul>
<li><strong>Self-Attention 연산:</strong>
<ul>
<li>쿼리, 키, 값 벡터를 생성.</li>
<li>( Q \cdot K^T ) 연산 후 소프트맥스.</li>
<li>최종 출력은 ( \text{Softmax}(Q \cdot K^T) \cdot V ).</li>
</ul>
</li>
<li><strong>통신 연산:</strong>
<ul>
<li>각 GPU는 필요한 텐서를 All-Gather로 모으고, 계산 후 Reduce-Scatter로 결과를 분배.</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>출력 생성:</strong></p>
<ul>
<li>최종 히든 상태는 출력 레이어에서 디코딩하여 텍스트 토큰 생성.</li>
<li>예:
<div
  class="code-block-container border-border bg-card my-6 overflow-hidden rounded-xl border shadow-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:shadow-md">
  
  <div
    class="code-block-header bg-muted/30 border-border flex items-center justify-between border-b px-4 py-3">
    
    <div class="flex items-center gap-2">
      <div class="text-muted-foreground flex-shrink-0">
        
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4" />
</svg>
      </div>
      <span class="text-muted-foreground text-sm font-medium">
        PLAINTEXT
      </span>
    </div>

    
    <div class="flex items-center gap-2">
      <button
          class="collapse-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none"
          data-code-id="code-2"
          data-default-state="expanded"
          data-collapsed="false"
          data-auto-collapse-lines="30"
          data-auto-collapse-height="400"
          data-collapsed-height="120"
          title="접기"
          aria-label="접기">
          <span class="collapse-icon">
            
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z"/></svg>
          </span>
          <span class="collapse-text hidden sm:inline"
            >접기</span
          >
        </button>
      <button
        class="copy-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none"
        data-code-id="code-2"
        title="복사"
        aria-label="복사">
        <span class="copy-icon">
          
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
</svg>
        </span>
        <span class="copy-text hidden sm:inline"
          >복사</span
        >
      </button>
    </div>
  </div>

  
  <div class="code-block-content relative" id="code-2">
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">&#34;A quick response.&#34;</span></span></code></pre></div>
    
    <div
      class="collapse-overlay to-card/90 pointer-events-none absolute inset-0 bg-gradient-to-b from-transparent via-transparent opacity-0 transition-opacity duration-300">
      <div
        class="text-muted-foreground bg-card/80 border-border/50 hover:bg-primary/10 hover:text-primary hover:border-primary/30 absolute bottom-4 left-1/2 -translate-x-1/2 cursor-pointer rounded-full border px-3 py-1.5 text-xs backdrop-blur-sm transition-all duration-200">
        클릭하여 더 보기
      </div>
    </div>
  </div>
</div>


<script>
(function() {
  const codeId = 'code-2';
  const copyBtn = document.querySelector('.copy-code-btn[data-code-id="' + codeId + '"]');
  const collapseBtn = document.querySelector('.collapse-code-btn[data-code-id="' + codeId + '"]');
  const codeContainer = document.getElementById(codeId);

  if (!codeContainer) return;

  
  if (copyBtn) {
    const copyIcon = copyBtn.querySelector('.copy-icon');
    const copyText = copyBtn.querySelector('.copy-text');

    copyBtn.addEventListener('click', async function() {
      try {
        
        let codeText = '';

        
        const codeTableCell = codeContainer.querySelector('.lntd:last-child code');
        if (codeTableCell) {
          codeText = codeTableCell.textContent || codeTableCell.innerText;
        } else {
          
          const codeElement = codeContainer.querySelector('code');
          if (codeElement) {
            
            const hasInlineLineNumbers = codeElement.querySelector('.ln');
            if (hasInlineLineNumbers) {
              
              const codeLines = codeElement.querySelectorAll('.cl');
              if (codeLines.length > 0) {
                codeText = Array.from(codeLines)
                  .map(line => {
                    const text = line.textContent || line.innerText;
                    
                    return text.replace(/\n+$/, '');
                  })
                  .join('\n')
                  .replace(/\n+$/, ''); 
              } else {
                
                const allText = codeElement.textContent || codeElement.innerText;
                codeText = allText.replace(/^\d+/gm, '').replace(/^\s+/gm, '');
              }
            } else {
              
              codeText = codeElement.textContent || codeElement.innerText;
            }
          } else {
            
            codeText = codeContainer.textContent || codeContainer.innerText;
          }
        }

        
        codeText = codeText.trim();

        
        await navigator.clipboard.writeText(codeText);

        
        copyIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M5 13l4 4L19 7\u0022 \/\u003e\n\u003c\/svg\u003e`;
        if (copyText) {
          copyText.textContent = '복사됨';
        }
        copyBtn.classList.add('text-green-600');

        
        setTimeout(() => {
          copyIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z\u0022 \/\u003e\n\u003c\/svg\u003e`;
          if (copyText) {
            copyText.textContent = '복사';
          }
          copyBtn.classList.remove('text-green-600');
        }, 2000);

      } catch (err) {
        console.error('复制失败:', err);

        
        const range = document.createRange();
        const codeElement = codeContainer.querySelector('code') || codeContainer;
        range.selectNodeContents(codeElement);
        const selection = window.getSelection();
        selection.removeAllRanges();
        selection.addRange(range);

        
        if (copyText) {
          copyText.textContent = '선택됨';
        }

        setTimeout(() => {
          if (copyText) {
            copyText.textContent = '복사';
          }
          selection.removeAllRanges();
        }, 2000);
      }
    });
  }

  
  if (collapseBtn) {
    const collapseIcon = collapseBtn.querySelector('.collapse-icon');
    const collapseText = collapseBtn.querySelector('.collapse-text');
    const collapseOverlay = codeContainer.querySelector('.collapse-overlay');

    
    let codeElement = codeContainer.querySelector('pre.chroma');
    if (!codeElement) {
      codeElement = codeContainer.querySelector('pre');
    }

    const defaultState = collapseBtn.dataset.defaultState || 'expanded';
    const isCollapsedAttr = collapseBtn.dataset.collapsed === 'true';
    const autoCollapseLines = parseInt(collapseBtn.dataset.autoCollapseLines) || 30;
    const autoCollapseHeight = parseInt(collapseBtn.dataset.autoCollapseHeight) || 400;
    const collapsedHeight = parseInt(collapseBtn.dataset.collapsedHeight) || 120;

    let isCollapsed = false;

    
    function initCollapse() {
      
      const shouldCollapse = isCollapsedAttr ||
                           defaultState === 'collapsed' ||
                           shouldAutoCollapse();

      if (shouldCollapse) {
        setCollapsed(true, false); 
      }
    }

    function shouldAutoCollapse() {
      
      if (codeElement) {
        const lines = codeElement.querySelectorAll('.line, .cl');
        const height = codeElement.offsetHeight;
        return lines.length > autoCollapseLines || height > autoCollapseHeight;
      }

      
      const containerHeight = codeContainer.offsetHeight;
      if (containerHeight > autoCollapseHeight) {
        return true;
      }

      
      const textContent = codeContainer.textContent || codeContainer.innerText || '';
      const estimatedLines = textContent.split('\n').length;
      return estimatedLines > autoCollapseLines;
    }

    function setCollapsed(collapsed, animate = true) {
      if (!collapseOverlay) return;

      isCollapsed = collapsed;

      if (collapsed) {
        
        codeContainer.style.maxHeight = collapsedHeight + 'px';
        codeContainer.style.overflow = 'hidden';
        collapseOverlay.style.opacity = '1';
        collapseOverlay.style.pointerEvents = 'auto';

        
        collapseIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M19 9l-7 7-7-7\u0022 \/\u003e\n\u003c\/svg\u003e`;
        if (collapseText) {
          collapseText.textContent = '펼치기';
        }
        collapseBtn.title = '펼치기';

      } else {
        
        codeContainer.style.maxHeight = '';
        codeContainer.style.overflow = '';
        collapseOverlay.style.opacity = '0';
        collapseOverlay.style.pointerEvents = 'none';

        
        collapseIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath fill=\u0022currentColor\u0022 d=\u0022M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z\u0022\/\u003e\u003c\/svg\u003e`;
        if (collapseText) {
          collapseText.textContent = '접기';
        }
        collapseBtn.title = '접기';
      }

      
      if (animate) {
        codeContainer.style.transition = 'max-height 0.3s ease-out';
        setTimeout(() => {
          codeContainer.style.transition = '';
        }, 300);
      }
    }

    function toggleCollapse() {
      setCollapsed(!isCollapsed, true);
    }

    
    collapseBtn.addEventListener('click', toggleCollapse);

    
    if (collapseOverlay) {
      collapseOverlay.addEventListener('click', () => {
        if (isCollapsed) {
          setCollapsed(false, true);
        }
      });
    }

    
    initCollapse();
  }
})();
</script>
</li>
</ul>
</li>
</ol>
<hr>
<h3 id="모델-아키텍처-구성">모델 아키텍처 구성</h3>
<h4 id="1-llama-31-모델-구조"><strong>1. Llama 3.1 모델 구조</strong></h4>
<ul>
<li><strong>층 구성:</strong>
<ul>
<li><strong>Transformer Encoder Layers:</strong>
<ul>
<li>쿼리/키/값 생성 및 Self-Attention 연산.</li>
<li>피드포워드 네트워크 (FFN): 활성화 함수와 선형 변환으로 구성.</li>
</ul>
</li>
<li><strong>임베딩 레이어:</strong><br>
입력 토큰을 고차원 벡터로 변환.</li>
<li><strong>출력 레이어:</strong><br>
디코더가 최종 출력 확률 분포를 생성.</li>
</ul>
</li>
</ul>
<table>
  <thead>
      <tr>
          <th><strong>모델 크기</strong></th>
          <th><strong>층 수</strong></th>
          <th><strong>모델 차원</strong></th>
          <th><strong>FFN 차원</strong></th>
          <th><strong>헤드 수</strong></th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>8B</td>
          <td>32</td>
          <td>4,096</td>
          <td>14,336</td>
          <td>32</td>
      </tr>
      <tr>
          <td>70B</td>
          <td>80</td>
          <td>8,192</td>
          <td>28,672</td>
          <td>64</td>
      </tr>
      <tr>
          <td>405B</td>
          <td>126</td>
          <td>16,384</td>
          <td>53,248</td>
          <td>128</td>
      </tr>
  </tbody>
</table>
<hr>
<h3 id="모델-연산-및-자원-요구량">모델 연산 및 자원 요구량</h3>
<h4 id="1-주요-연산"><strong>1. 주요 연산</strong></h4>
<ol>
<li>
<p><strong>Self-Attention 연산:</strong></p>
<ul>
<li><strong>복잡도:</strong> ( O(n^2 \cdot d) ),<br>
( n ): 입력 시퀀스 길이, ( d ): 모델 차원.</li>
<li>예: Llama 70B, ( n = 1024 ), ( d = 8192 ):
( 1024^2 \cdot 8192 = 8.59 \times 10^{10} ) FLOPs.</li>
</ul>
</li>
<li>
<p><strong>피드포워드 네트워크 (FFN):</strong></p>
<ul>
<li><strong>복잡도:</strong> ( O(n \cdot d \cdot d_\text{ff}) ),<br>
( d_\text{ff} ): FFN 차원.</li>
<li>예: ( n = 1024 ), ( d = 8192 ), ( d_\text{ff} = 28,672 ):
( 1024 \cdot 8192 \cdot 28,672 = 2.40 \times 10^{11} ) FLOPs.</li>
</ul>
</li>
</ol>
<hr>
<h4 id="2-메모리-요구량"><strong>2. 메모리 요구량</strong></h4>
<ul>
<li><strong>파라미터 저장:</strong>
<ul>
<li>모델 크기에 비례:
<ul>
<li>Llama 70B: ( 70 \times 10^9 ) 파라미터 × 4바이트(FP32) = <strong>280GB</strong>.</li>
</ul>
</li>
</ul>
</li>
<li><strong>중간 활성화 값:</strong>
<ul>
<li>Self-Attention과 FFN 연산 중 생성.</li>
<li>Llama 70B의 경우, ( n = 1024 ), ( d = 8192 ):<br>
( 1024 \cdot 8192 \cdot 4 \text{바이트} = 32MB) (단일 GPU).</li>
</ul>
</li>
</ul>
<h4 id="3-컴퓨팅-요구량"><strong>3. 컴퓨팅 요구량</strong></h4>
<ul>
<li><strong>GPU 요구량:</strong>
<ul>
<li>Llama 70B 기준, 64개 GPU 필요.</li>
<li>1 GPU당 11 TFLOPs/s 이상 요구.</li>
</ul>
</li>
</ul>
<h4 id="ir-노드-최적화로-인한-요구량-감소"><strong>IR 노드 최적화로 인한 요구량 감소</strong></h4>
<ul>
<li>버킷화 및 재정렬은 중간 활성화 값과 통신 데이터를 효율적으로 관리하여 메모리와 연산 요구량을 줄임.</li>
</ul>
<hr>
<h3 id="정리">정리</h3>
<p>SimpleFSDP는 입력 텍스트 처리부터 대규모 모델 추론에 필요한 연산 및 메모리 요구량을 최적화하기 위해 설계되었습니다. 모델의 대규모 연산을 분산 처리하는 과정에서 버킷화와 재정렬 최적화가 특히 큰 효과를 발휘하며, 이는 메모리와 계산 자원의 요구량을 줄이고 처리 속도를 높이는 데 기여합니다.</p>
<h1 id="q--이-논문의-한계를-극복하기-위한-방법으로-어떤-연구흐름이-있는지-정리해서-자세하게-설명해-줘">Q : 이 논문의 한계를 극복하기 위한 방법으로 어떤 연구흐름이 있는지 정리해서 자세하게 설명해 줘</h1>
<h3 id="논문의-한계-및-이를-극복하기-위한-연구-흐름">논문의 한계 및 이를 극복하기 위한 연구 흐름</h3>
<hr>
<h3 id="1-논문의-주요-한계"><strong>1. 논문의 주요 한계</strong></h3>
<h4 id="11-자동-래핑auto-wrapping의-비효율성"><strong>1.1 자동 래핑(Auto-Wrapping)의 비효율성</strong></h4>
<ul>
<li>SimpleFSDP는 통신과 계산의 최적화를 위해 자동 래핑(Auto-Wrapping)을 사용하지만, 특정 상황에서 비효율적일 수 있음.</li>
<li><strong>문제점:</strong>
<ul>
<li>메모리와 처리량 간의 균형을 제대로 맞추지 못함.</li>
<li>예: 70B 모델에서 메모리 오버헤드(10.61GiB) 발생.</li>
</ul>
</li>
</ul>
<h4 id="12-통신-시간-추정의-한계"><strong>1.2 통신 시간 추정의 한계</strong></h4>
<ul>
<li>현재 통신 시간 추정은 데이터 크기(전송량)에만 의존.</li>
<li><strong>문제점:</strong>
<ul>
<li>네트워크 토폴로지, GPU 간 연결 대역폭, 병렬 통신 경합 등의 요인을 고려하지 않음.</li>
<li>통신 시간 추정의 부정확성으로 최적화의 비효율 발생.</li>
</ul>
</li>
</ul>
<h4 id="13-데이터-종속적-코드-처리"><strong>1.3 데이터 종속적 코드 처리</strong></h4>
<ul>
<li>SimpleFSDP는 PyTorch의 <code>torch.compile</code>을 사용하지만, 데이터 의존적 제어 흐름이 있는 코드는 풀 그래프를 추적하지 못함.</li>
<li><strong>문제점:</strong>
<ul>
<li>그래프가 여러 서브그래프로 분리되어 최적화 기회가 감소.</li>
</ul>
</li>
</ul>
<h4 id="14-대규모-분산-환경의-병목"><strong>1.4 대규모 분산 환경의 병목</strong></h4>
<ul>
<li>다수의 GPU 노드에서 발생하는 통신 병목은 완전히 해결되지 않음.</li>
<li><strong>문제점:</strong>
<ul>
<li>멀티노드 환경에서 통신과 계산의 동기화가 부족.</li>
</ul>
</li>
</ul>
<hr>
<h3 id="2-한계를-극복하기-위한-연구-흐름"><strong>2. 한계를 극복하기 위한 연구 흐름</strong></h3>
<h4 id="21-자동-래핑의-개선"><strong>2.1 자동 래핑의 개선</strong></h4>
<p><strong>목표:</strong> 메모리 효율성과 처리량 간의 균형을 향상.</p>
<ol>
<li>
<p><strong>강화 학습 기반 최적화:</strong></p>
<ul>
<li>강화 학습(RL)을 통해 IR 노드의 래핑 및 재정렬을 학습.</li>
<li>메모리 제약과 처리량 목표를 만족하는 최적의 래핑 전략을 생성.</li>
</ul>
</li>
<li>
<p><strong>통합 래핑 알고리즘:</strong></p>
<ul>
<li>메모리, 처리량, 통신 시간을 동시에 고려하는 다목적 최적화 알고리즘 도입.</li>
<li>예: NSGA-II 같은 다목적 진화 알고리즘.</li>
</ul>
</li>
<li>
<p><strong>동적 래핑:</strong></p>
<ul>
<li>학습 과정에서 실시간으로 래핑 전략을 조정.</li>
<li>예: GPU 사용량이나 통신 대기 시간이 특정 임계값에 도달하면 자동 재구성.</li>
</ul>
</li>
</ol>
<hr>
<h4 id="22-통신-시간-추정의-개선"><strong>2.2 통신 시간 추정의 개선</strong></h4>
<p><strong>목표:</strong> 통신 시간 추정 정확성을 높여 최적화 효율성을 개선.</p>
<ol>
<li>
<p><strong>네트워크 토폴로지 고려:</strong></p>
<ul>
<li>GPU 간 연결 대역폭과 NVLink/NIC 구조를 모델링하여 통신 시간 추정에 반영.</li>
<li>예: NVIDIA NCCL 라이브러리에서 제공하는 네트워크 프로파일링 데이터 활용.</li>
</ul>
</li>
<li>
<p><strong>통신 경합 모델링:</strong></p>
<ul>
<li>GPU 간 동시 통신의 경합을 고려.</li>
<li>예: 다수의 All-Gather 연산이 경합할 경우, 병렬 수행 효율성 감소를 반영.</li>
</ul>
</li>
<li>
<p><strong>머신 러닝 기반 추정:</strong></p>
<ul>
<li>통신 로그 데이터를 기반으로 통신 시간을 학습하고 추정.</li>
<li>예: 그래프 신경망(GNN)을 사용하여 통신 연산의 상호작용과 병목 예측.</li>
</ul>
</li>
</ol>
<hr>
<h4 id="23-데이터-종속적-코드-지원"><strong>2.3 데이터 종속적 코드 지원</strong></h4>
<p><strong>목표:</strong> 데이터 의존적 제어 흐름이 포함된 코드의 그래프 추적 가능성을 향상.</p>
<ol>
<li>
<p><strong>제어 흐름 인라인 확장:</strong></p>
<ul>
<li>데이터 의존적 분기문을 그래프 내에서 명시적으로 표현.</li>
<li>예: TorchDynamo의 데이터 흐름 추적을 확장.</li>
</ul>
</li>
<li>
<p><strong>조건부 그래프 최적화:</strong></p>
<ul>
<li>데이터 의존성에 따라 다른 최적화를 적용.</li>
<li>예: 조건문별로 별도의 최적화 그래프 생성.</li>
</ul>
</li>
<li>
<p><strong>Mixed-Mode Compilation:</strong></p>
<ul>
<li>추적 불가능한 부분은 이거 모드(Eager Mode)로 처리하고, 나머지 부분은 컴파일.</li>
</ul>
</li>
</ol>
<hr>
<h4 id="24-대규모-분산-환경-최적화"><strong>2.4 대규모 분산 환경 최적화</strong></h4>
<p><strong>목표:</strong> 멀티노드 환경에서 통신 병목과 계산 병렬화를 개선.</p>
<ol>
<li>
<p><strong>비동기 통신 최적화:</strong></p>
<ul>
<li>통신 연산을 완전히 비동기로 수행.</li>
<li>예: NCCL의 비동기 API를 활용하여 통신과 계산의 중첩 증가.</li>
</ul>
</li>
<li>
<p><strong>파이프라인 통신 스케줄링:</strong></p>
<ul>
<li>통신과 계산을 노드 간 파이프라인 방식으로 스케줄링.</li>
<li>예: GPipe와 유사한 방식으로 파라미터 전송을 분할.</li>
</ul>
</li>
<li>
<p><strong>호모지니어스(Homogeneous) 스케줄링:</strong></p>
<ul>
<li>각 GPU 노드의 작업 분배를 균일하게 조정.</li>
<li>예: GPU 간 로드 밸런싱 알고리즘 도입.</li>
</ul>
</li>
</ol>
<hr>
<h3 id="3-결론"><strong>3. 결론</strong></h3>
<p>SimpleFSDP의 한계는 주로 자동화 최적화와 통신 모델링의 부족에서 비롯되며, 이를 극복하기 위해 다음과 같은 연구 흐름이 유망합니다:</p>
<ol>
<li><strong>자동 래핑 최적화:</strong> 강화 학습 및 다목적 알고리즘을 활용한 래핑 전략 개선.</li>
<li><strong>통신 시간 추정 모델링:</strong> 네트워크 토폴로지와 경합을 반영한 ML 기반 추정.</li>
<li><strong>데이터 종속 코드 처리:</strong> 혼합 모드 컴파일 및 조건부 최적화 지원.</li>
<li><strong>대규모 분산 최적화:</strong> 비동기 통신 및 파이프라인 스케줄링 강화.</li>
</ol>
<p>이러한 연구 흐름은 SimpleFSDP가 대규모 모델 학습에서 더욱 강력한 성능을 발휘하도록 기여할 것입니다.</p>
<h1 id="q--simplefsdp에서-ir-노드의-버킷화bucketing와-재정렬reordering-과정이-기존-fsdp-대비-어떤-구조적-이점을-제공하며-실제-학습에서-통신과-계산의-병렬화를-어떻게-개선하는가">Q : SimpleFSDP에서 IR 노드의 버킷화(Bucketing)와 재정렬(Reordering) 과정이 기존 FSDP 대비 어떤 구조적 이점을 제공하며, 실제 학습에서 통신과 계산의 병렬화를 어떻게 개선하는가?</h1>
<h3 id="simplefsdp의-ir-노드-버킷화bucketing와-재정렬reordering의-구조적-이점-및-개선점">SimpleFSDP의 IR 노드 **버킷화(Bucketing)**와 <strong>재정렬(Reordering)의 구조적 이점 및 개선점</strong></h3>
<hr>
<h3 id="1-기존-fsdp의-구조적-한계"><strong>1. 기존 FSDP의 구조적 한계</strong></h3>
<p>기존 FSDP(특히 PyTorch의 FSDP2)는 각 파라미터에 대해 통신(All-Gather)과 계산(Forward/Backward Pass)을 독립적으로 처리:</p>
<ol>
<li><strong>통신 연산 빈도 증가:</strong>
<ul>
<li>파라미터별로 All-Gather와 Reduce-Scatter가 수행되어 통신이 자주 발생.</li>
</ul>
</li>
<li><strong>통신과 계산의 병렬성 부족:</strong>
<ul>
<li>통신 연산이 완료될 때까지 계산 연산이 대기.</li>
<li>CUDA 스트림에서 통신과 계산이 명확히 분리되어 비효율적.</li>
</ul>
</li>
</ol>
<hr>
<h3 id="2-simplefsdp의-버킷화bucketing와-재정렬reordering의-구조적-이점"><strong>2. SimpleFSDP의 버킷화(Bucketing)와 재정렬(Reordering)의 구조적 이점</strong></h3>
<h4 id="21-버킷화bucketing의-구조적-이점"><strong>2.1 버킷화(Bucketing)의 구조적 이점</strong></h4>
<ol>
<li>
<p><strong>연산 병합:</strong></p>
<ul>
<li>여러 IR 노드(All-Gather 및 Reduce-Scatter)를 하나의 버킷으로 묶어 한 번의 통신 연산으로 처리.</li>
<li>통신의 고정 오버헤드(Base Latency)를 줄임.</li>
</ul>
</li>
<li>
<p><strong>큰 데이터 덩어리 전송:</strong></p>
<ul>
<li>개별 파라미터 대신 병합된 데이터를 한 번에 전송하여 네트워크 대역폭 활용도 극대화.</li>
</ul>
</li>
<li>
<p><strong>샘플 사례:</strong></p>
<ul>
<li>기존 방식: GPU1이 (W_1), GPU2가 (W_2)에 대해 독립적으로 All-Gather 수행.</li>
<li>버킷화 방식: ( [W_1, W_2] )를 하나의 버킷으로 병합해 단일 All-Gather 수행.</li>
</ul>
</li>
<li>
<p><strong>결과:</strong> 통신 빈도가 줄어들고 각 통신 연산의 효율성이 증가.</p>
</li>
</ol>
<hr>
<h4 id="22-재정렬reordering의-구조적-이점"><strong>2.2 재정렬(Reordering)의 구조적 이점</strong></h4>
<ol>
<li>
<p><strong>통신과 계산의 병렬화:</strong></p>
<ul>
<li>통신(All-Gather, Reduce-Scatter)을 CUDA 스트림에서 계산 연산과 겹치도록 재배치.</li>
<li>계산 도중 통신을 미리 수행하여 대기 시간 감소.</li>
</ul>
</li>
<li>
<p><strong>선행 통신 작업 배치:</strong></p>
<ul>
<li>다음 계산 단계에 필요한 파라미터를 미리 All-Gather하여 현재 계산 단계와 병렬 수행.</li>
</ul>
</li>
<li>
<p><strong>샘플 사례:</strong></p>
<ul>
<li>기존 방식: (C1 \to All-Gather \to Wait \to C2).</li>
<li>재정렬 방식: (All-Gather \to C1) (병렬) ( \to Wait \to C2).</li>
</ul>
</li>
<li>
<p><strong>결과:</strong> CUDA 스트림 상에서 통신과 계산이 병렬적으로 처리되어 GPU 활용률 증가.</p>
</li>
</ol>
<hr>
<h3 id="3-실제-학습에서-통신과-계산-병렬화의-개선점"><strong>3. 실제 학습에서 통신과 계산 병렬화의 개선점</strong></h3>
<h4 id="31-통신-오버헤드-감소"><strong>3.1 통신 오버헤드 감소</strong></h4>
<ul>
<li>기존 방식에서는 각 파라미터마다 통신 오버헤드가 발생.</li>
<li>버킷화로 인해 고정 오버헤드(Base Latency)가 병합되어 전체 통신 시간이 감소.</li>
</ul>
<h4 id="32-gpu-사용률-향상"><strong>3.2 GPU 사용률 향상</strong></h4>
<ul>
<li>재정렬로 통신과 계산이 병렬적으로 수행되면서 GPU 대기 시간이 감소.</li>
<li>전체 학습 처리량(Throughput)이 증가.</li>
</ul>
<h4 id="33-메모리-관리-최적화"><strong>3.3 메모리 관리 최적화</strong></h4>
<ul>
<li>버킷화와 재정렬은 중간 활성화 데이터와 통신 데이터를 적시에 해제하거나 로드할 수 있도록 관리:
<ul>
<li>메모리 사용량 감소.</li>
<li>통신과 계산의 효율적 자원 할당.</li>
</ul>
</li>
</ul>
<hr>
<h3 id="4-실제-성능-향상"><strong>4. 실제 성능 향상</strong></h3>
<h4 id="실험-결과-llama-31-시리즈"><strong>실험 결과 (Llama 3.1 시리즈)</strong></h4>
<table>
  <thead>
      <tr>
          <th><strong>모델</strong></th>
          <th><strong>버킷화 &amp; 재정렬 적용 전</strong></th>
          <th><strong>버킷화 &amp; 재정렬 적용 후</strong></th>
          <th><strong>개선율</strong></th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>8B</strong></td>
          <td>처리량: 2.2M TPS</td>
          <td>처리량: 2.4M TPS</td>
          <td>+7.49% 처리량 증가</td>
      </tr>
      <tr>
          <td><strong>70B</strong></td>
          <td>메모리: 40.8 GiB</td>
          <td>메모리: 36.1 GiB</td>
          <td>-11.61% 메모리 절감</td>
      </tr>
      <tr>
          <td><strong>405B</strong></td>
          <td>처리량: 4.8M TPS</td>
          <td>처리량: 8.1M TPS</td>
          <td>+68.67% 처리량 증가</td>
      </tr>
  </tbody>
</table>
<hr>
<h3 id="5-한계-및-발전-가능성"><strong>5. 한계 및 발전 가능성</strong></h3>
<ol>
<li>
<p><strong>통신 경합 문제:</strong></p>
<ul>
<li>다수의 GPU 노드가 병렬로 통신을 수행할 때 경합 발생 가능.</li>
<li>해결 방향: 네트워크 토폴로지와 GPU 통신 대역폭을 모델링한 최적화 연구 필요.</li>
</ul>
</li>
<li>
<p><strong>자동화 한계:</strong></p>
<ul>
<li>Auto-Wrapping은 현재 그리디 알고리즘에 의존, 글로벌 최적화 부족.</li>
<li>해결 방향: 강화 학습 기반 또는 다목적 최적화 알고리즘 도입.</li>
</ul>
</li>
<li>
<p><strong>메모리 사용량 최적화:</strong></p>
<ul>
<li>일부 상황에서 재정렬이 메모리 오버헤드를 유발.</li>
<li>해결 방향: 동적 메모리 관리 및 실시간 리밸런싱 도입.</li>
</ul>
</li>
</ol>
<hr>
<h3 id="결론-1"><strong>결론</strong></h3>
<p>SimpleFSDP의 버킷화와 재정렬은 기존 FSDP 대비 통신 연산의 빈도를 줄이고 계산과 병렬화하여 GPU 활용 효율을 극대화합니다. 이를 통해 처리량(Throughput)과 메모리 사용량 모두에서 눈에 띄는 개선을 이끌어냈으며, 대규모 모델 학습에서의 분산 시스템 최적화를 선도하는 중요한 기여를 했습니다.</p>
<h1 id="q--자동-래핑auto-wrapping-알고리즘의-설계에서-메모리-사용량과-처리량-간의-균형을-맞추기-위한-최적화-방식이-어떤-기준과-조건에-기반하여-작동하며-이를-개선하기-위해-추가적인-접근법이-필요할-가능성은-무엇인가">Q : 자동 래핑(Auto-Wrapping) 알고리즘의 설계에서 메모리 사용량과 처리량 간의 균형을 맞추기 위한 최적화 방식이 어떤 기준과 조건에 기반하여 작동하며, 이를 개선하기 위해 추가적인 접근법이 필요할 가능성은 무엇인가?</h1>
<h3 id="자동-래핑auto-wrapping-알고리즘의-설계와-최적화-방식">자동 래핑(Auto-Wrapping) 알고리즘의 설계와 최적화 방식</h3>
<hr>
<h3 id="1-자동-래핑auto-wrapping의-목적"><strong>1. 자동 래핑(Auto-Wrapping)의 목적</strong></h3>
<p>SimpleFSDP의 자동 래핑은 IR 노드의 버킷화와 재정렬을 자동으로 처리하여, 수작업 없이 메모리 사용량과 처리량 간의 최적 균형을 찾는 것을 목표로 합니다. 이를 통해 대규모 모델 학습의 복잡성을 줄이고 성능을 최적화합니다.</p>
<hr>
<h3 id="2-알고리즘의-작동-기준-및-조건"><strong>2. 알고리즘의 작동 기준 및 조건</strong></h3>
<h4 id="21-주요-입력-변수"><strong>2.1 주요 입력 변수</strong></h4>
<ul>
<li><strong>통신 시간 (( T_\text{AG}, T_\text{RS} ))</strong>: All-Gather 및 Reduce-Scatter 연산에 필요한 예상 시간.</li>
<li><strong>계산 시간 (( T_c ))</strong>: 각 계산 노드의 실행 시간.</li>
<li><strong>메모리 사용량 (( M_c ))</strong>: 계산 및 통신에 필요한 메모리 사용량.</li>
<li><strong>메모리 제한 (( M_\text{max} ))</strong>: 각 GPU의 가용 메모리.</li>
</ul>
<h4 id="22-최적화-조건"><strong>2.2 최적화 조건</strong></h4>
<ol>
<li>
<p><strong>시간 제약(Time Constraint):</strong></p>
<ul>
<li>통신 시간(( T_\text{AG} ))과 계산 시간(( T_c ))이 겹칠 수 있어야 함:
[
T_\text{AG} + T_\text{RS} \leq T_c
]</li>
</ul>
</li>
<li>
<p><strong>메모리 제약(Memory Constraint):</strong></p>
<ul>
<li>통신 및 계산에 필요한 메모리 사용량이 가용 메모리를 초과하지 않아야 함:
[
M_c + M_{c(i)} \leq M_\text{max}
]</li>
</ul>
</li>
</ol>
<h4 id="23-알고리즘의-동작"><strong>2.3 알고리즘의 동작</strong></h4>
<ul>
<li>
<p><strong>버킷화 결정:</strong></p>
<ul>
<li>IR 노드(All-Gather, Reduce-Scatter)를 메모리 제약과 시간 제약 조건 하에서 병합.</li>
<li>조건을 만족하지 못하면 새 버킷을 생성.</li>
</ul>
</li>
<li>
<p><strong>재정렬(Reordering):</strong></p>
<ul>
<li>병합된 IR 노드가 계산 노드와 병렬로 수행될 수 있도록 CUDA 스트림 재배치.</li>
</ul>
</li>
<li>
<p><strong>그리디 알고리즘 사용:</strong></p>
<ul>
<li>현재 상태에서 메모리 제약과 시간 제약을 만족하는 가장 최적의 버킷화/재정렬을 선택.</li>
<li>글로벌 최적화 대신 로컬 최적화를 반복적으로 수행.</li>
</ul>
</li>
</ul>
<hr>
<h3 id="3-메모리와-처리량-균형의-어려움"><strong>3. 메모리와 처리량 균형의 어려움</strong></h3>
<h4 id="31-균형-조정의-한계"><strong>3.1 균형 조정의 한계</strong></h4>
<ol>
<li>
<p><strong>그리디 알고리즘의 제약:</strong></p>
<ul>
<li>로컬 최적화에만 의존하므로 글로벌 최적화에 도달하지 못할 가능성.</li>
<li>예: 메모리 효율성을 극대화하려다 처리량이 감소하거나 반대의 상황 발생.</li>
</ul>
</li>
<li>
<p><strong>모델 크기에 따른 비선형적 메모리 사용량:</strong></p>
<ul>
<li>대규모 모델(예: Llama 3.1 70B, 405B)의 경우, 중간 활성화 값 및 통신 데이터가 비선형적으로 증가.</li>
</ul>
</li>
<li>
<p><strong>통신 경합 및 네트워크 병목:</strong></p>
<ul>
<li>멀티노드 환경에서 통신 경합이 발생하면 처리량 저하.</li>
</ul>
</li>
</ol>
<h4 id="32-실제-사례"><strong>3.2 실제 사례</strong></h4>
<ul>
<li><strong>70B 모델:</strong> 자동 래핑에서 메모리 오버헤드(10.61 GiB)가 발생.<br>
이는 메모리 제한 조건을 완화한 결과 처리량이 증가했으나, 균형 유지 실패를 보여줌.</li>
</ul>
<hr>
<h3 id="4-추가적인-접근법"><strong>4. 추가적인 접근법</strong></h3>
<h4 id="41-강화-학습-기반-최적화"><strong>4.1 강화 학습 기반 최적화</strong></h4>
<ul>
<li><strong>방식:</strong> 강화 학습(RL) 알고리즘으로 메모리와 처리량의 균형을 학습.</li>
<li><strong>장점:</strong> 글로벌 최적화를 목표로 설정 가능.</li>
<li><strong>적용:</strong> RL 에이전트가 메모리와 처리량의 보상 함수(reward function)를 기반으로 IR 노드 래핑 전략을 학습.</li>
</ul>
<h4 id="42-다목적-최적화-알고리즘"><strong>4.2 다목적 최적화 알고리즘</strong></h4>
<ul>
<li><strong>예:</strong> NSGA-II (Non-dominated Sorting Genetic Algorithm II)</li>
<li><strong>장점:</strong> 메모리 사용량 최소화와 처리량 최대화를 동시에 고려.</li>
<li><strong>적용:</strong> IR 노드의 래핑과 재정렬을 유전 알고리즘 방식으로 최적화.</li>
</ul>
<h4 id="43-동적-메모리-관리"><strong>4.3 동적 메모리 관리</strong></h4>
<ul>
<li><strong>방식:</strong> 학습 중 실시간으로 메모리 사용량을 모니터링하고 필요 시 IR 노드 병합/분할.</li>
<li><strong>장점:</strong> 메모리와 처리량 간의 균형을 동적으로 유지.</li>
</ul>
<h4 id="44-네트워크-토폴로지-모델링"><strong>4.4 네트워크 토폴로지 모델링</strong></h4>
<ul>
<li><strong>방식:</strong> 네트워크 병목과 경합을 포함한 통신 시간 예측 모델 도입.</li>
<li><strong>장점:</strong> 다수 GPU 환경에서 처리량 최적화 가능.</li>
</ul>
<hr>
<h3 id="5-결론"><strong>5. 결론</strong></h3>
<p>자동 래핑은 SimpleFSDP의 효율성을 높이는 중요한 구성 요소지만, 메모리와 처리량 간의 균형 조정에 제한이 있습니다. 이를 개선하기 위해 강화 학습 기반 최적화, 다목적 최적화 알고리즘, 동적 메모리 관리, 네트워크 토폴로지 모델링과 같은 접근법이 필요하며, 이러한 개선은 대규모 분산 학습의 성능을 더욱 향상시킬 것입니다.</p>
<h1 id="q--simplefsdp가-pytorch-native-통합-방식을-사용하여-다른-최신-분산-학습-기술tensor-parallel-pipeline-parallel-등과의-호환성을-유지하는-구체적인-방법은-무엇이며-이-과정에서-발생할-수-있는-병목-현상은-어떻게-해결되었는가">Q : SimpleFSDP가 PyTorch-native 통합 방식을 사용하여 다른 최신 분산 학습 기술(Tensor Parallel, Pipeline Parallel 등)과의 호환성을 유지하는 구체적인 방법은 무엇이며, 이 과정에서 발생할 수 있는 병목 현상은 어떻게 해결되었는가?</h1>
<h3 id="simplefsdp의-pytorch-native-통합-및-최신-분산-학습-기술과의-호환성">SimpleFSDP의 PyTorch-native 통합 및 최신 분산 학습 기술과의 호환성</h3>
<hr>
<h3 id="1-simplefsdp의-pytorch-native-통합-방식"><strong>1. SimpleFSDP의 PyTorch-native 통합 방식</strong></h3>
<p>SimpleFSDP는 PyTorch의 기존 프리미티브(Primitive)를 활용하여 설계되었으며, 이를 통해 Tensor Parallel, Pipeline Parallel 등 최신 분산 학습 기술과 자연스럽게 통합됩니다.</p>
<h4 id="11-주요-pytorch-프리미티브"><strong>1.1 주요 PyTorch 프리미티브</strong></h4>
<ol>
<li>
<p><strong>DTensor API:</strong></p>
<ul>
<li>데이터 분산 및 통신 관리.</li>
<li>모델 파라미터를 다양한 병렬화 방식(Tensor Parallel, Data Parallel 등)으로 샤딩 가능.</li>
</ul>
</li>
<li>
<p><strong>Parametrization 모듈:</strong></p>
<ul>
<li>파라미터를 샤딩하거나 통합(All-Gather)하는 작업을 자동화.</li>
<li>통신과 계산을 동일한 방식으로 처리하여 추적 가능.</li>
</ul>
</li>
<li>
<p><strong>Selective Activation Checkpointing:</strong></p>
<ul>
<li>특정 통신/계산 연산에서 활성화를 선택적으로 저장 및 해제.</li>
<li>메모리 사용량 감소.</li>
</ul>
</li>
<li>
<p><strong>TorchInductor 컴파일러:</strong></p>
<ul>
<li>통신 및 계산 연산의 IR 노드를 추적하여 최적화.</li>
</ul>
</li>
</ol>
<hr>
<h3 id="2-최신-분산-학습-기술과의-호환성"><strong>2. 최신 분산 학습 기술과의 호환성</strong></h3>
<h4 id="21-tensor-parallel"><strong>2.1 Tensor Parallel</strong></h4>
<ul>
<li><strong>구현 방식:</strong>
<ul>
<li>DTensor를 활용하여 각 레이어의 파라미터를 Tensor Parallel 서브그룹으로 분할.</li>
<li>계산 단계에서는 All-Gather를 통해 필요한 데이터를 통합.</li>
</ul>
</li>
<li><strong>특징:</strong>
<ul>
<li>SimpleFSDP는 Tensor Parallel 연산에 필요한 통신(All-Gather 및 Reduce-Scatter)을 IR 노드로 추적하여 최적화.</li>
</ul>
</li>
<li><strong>결과:</strong>
<ul>
<li>데이터 분산 및 샤딩 작업이 병렬로 수행됨.</li>
<li>Tensor Parallel과의 호환성을 유지하며 처리량 최적화.</li>
</ul>
</li>
</ul>
<h4 id="22-pipeline-parallel"><strong>2.2 Pipeline Parallel</strong></h4>
<ul>
<li><strong>구현 방식:</strong>
<ul>
<li>모델을 여러 서브모듈로 분할하여 GPU 간 파이프라인 실행.</li>
<li>SimpleFSDP는 각 파이프라인 단계에서 통신과 계산의 IR 노드를 추적.</li>
</ul>
</li>
<li><strong>특징:</strong>
<ul>
<li>파라미터를 각 파이프라인 단계로 제한하여 메모리 사용량 감소.</li>
<li>통신과 계산의 순차적 병목을 최소화.</li>
</ul>
</li>
<li><strong>결과:</strong>
<ul>
<li>Pipeline Parallel의 데이터 흐름과 자연스럽게 결합.</li>
</ul>
</li>
</ul>
<h4 id="23-혼합-정밀도-학습mixed-precision-training"><strong>2.3 혼합 정밀도 학습(Mixed Precision Training)</strong></h4>
<ul>
<li><strong>구현 방식:</strong>
<ul>
<li>DTensor API를 사용하여 모델 파라미터를 16비트(float16)로 변환.</li>
<li>그래디언트 업데이트 시에는 32비트(float32)로 변환.</li>
</ul>
</li>
<li><strong>특징:</strong>
<ul>
<li>단일 IR 그래프에서 메모리 효율성과 학습 안정성을 모두 제공.</li>
</ul>
</li>
</ul>
<h4 id="24-meta-initialization"><strong>2.4 Meta Initialization</strong></h4>
<ul>
<li><strong>구현 방식:</strong>
<ul>
<li>초기화 시 파라미터를 Meta 디바이스(추상 디바이스)에 로드.</li>
<li>실제 GPU/CPU에 로드하기 전에 모델 구조를 분석.</li>
</ul>
</li>
<li><strong>특징:</strong>
<ul>
<li>모델 초기화 속도 증가 및 메모리 절약.</li>
</ul>
</li>
</ul>
<hr>
<h3 id="3-병목-현상-및-해결-방법"><strong>3. 병목 현상 및 해결 방법</strong></h3>
<h4 id="31-병목-현상"><strong>3.1 병목 현상</strong></h4>
<ol>
<li>
<p><strong>통신 병목:</strong></p>
<ul>
<li>Tensor Parallel 및 Pipeline Parallel 환경에서 GPU 간 통신 시간이 증가.</li>
<li>멀티노드 환경에서는 네트워크 대역폭 경합 발생.</li>
</ul>
</li>
<li>
<p><strong>계산과 통신의 비효율적 병렬화:</strong></p>
<ul>
<li>계산 작업이 통신 완료를 대기하는 경우 처리량 감소.</li>
</ul>
</li>
<li>
<p><strong>메모리 사용량 증가:</strong></p>
<ul>
<li>통신 데이터와 계산 데이터가 동시에 메모리를 차지할 때 메모리 오버헤드 발생.</li>
</ul>
</li>
</ol>
<hr>
<h4 id="32-해결-방법"><strong>3.2 해결 방법</strong></h4>
<ol>
<li>
<p><strong>통신 병목 해결:</strong></p>
<ul>
<li><strong>버킷화(Bucketing):</strong> 다수의 All-Gather 및 Reduce-Scatter 연산을 병합하여 통신 빈도 감소.</li>
<li><strong>비동기 통신:</strong> 통신 연산을 비동기로 수행하여 계산과 겹치도록 최적화.</li>
</ul>
</li>
<li>
<p><strong>계산과 통신 병렬화:</strong></p>
<ul>
<li><strong>재정렬(Reordering):</strong> 통신 작업을 계산 작업과 병렬로 수행하도록 CUDA 스트림 조정.</li>
<li><strong>선행 통신(Prefetching):</strong> 다음 계산 단계에 필요한 데이터를 미리 All-Gather.</li>
</ul>
</li>
<li>
<p><strong>메모리 사용량 최적화:</strong></p>
<ul>
<li><strong>Selective Activation Checkpointing:</strong> 특정 활성화 값만 저장하여 메모리 절약.</li>
<li><strong>동적 메모리 관리:</strong> 학습 과정에서 메모리 사용량을 실시간 조정.</li>
</ul>
</li>
</ol>
<hr>
<h3 id="4-실제-성능-개선"><strong>4. 실제 성능 개선</strong></h3>
<ul>
<li>Llama 3.1 모델에서 Tensor Parallel 및 Pipeline Parallel과 결합 시:
<ul>
<li><strong>8B 모델:</strong> 처리량 29.35% 증가.</li>
<li><strong>70B 모델:</strong> 메모리 사용량 11.61% 감소.</li>
<li><strong>405B 모델:</strong> 처리량 68.67% 증가.</li>
</ul>
</li>
</ul>
<hr>
<h3 id="5-결론-1"><strong>5. 결론</strong></h3>
<p>SimpleFSDP는 PyTorch-native 통합 방식을 통해 Tensor Parallel, Pipeline Parallel 등 최신 분산 학습 기술과 완벽히 호환되며, IR 노드 추적 및 최적화를 활용하여 통신과 계산의 병렬화를 극대화합니다. 이 과정에서 발생하는 병목 현상은 버킷화, 재정렬, 비동기 통신, 동적 메모리 관리 등을 통해 효과적으로 해결되었으며, 대규모 모델 학습의 성능을 크게 개선하였습니다.</p>

  </article>

  
  
  <div class="post-license bg-muted/30 border-border mb-8 rounded-xl border p-6">
    <div class="flex items-start gap-4">
      <div
        class="bg-primary/10 flex h-12 w-12 flex-shrink-0 items-center justify-center rounded-lg">
        
  <svg class="h-6 w-6"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="라이선스"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z" />
</svg>
      </div>

      <div class="flex-1">
        <h3 class="text-foreground mb-2 text-lg font-semibold">
          라이선스
        </h3>

        <div class="text-muted-foreground space-y-2 text-sm">
          
          <p>
            <strong>저작자:</strong>
            류재훈
          </p>
          

          <p>
            <strong>링크:</strong>
            <a
              href="http://192.168.1.11:1314/posts/SimpleFSDP-Simpler-Fully-Sharded-Data-Parallel-with-torch.compile/"
              class="text-primary hover:text-primary/80 transition-colors duration-200">
              http://192.168.1.11:1314/posts/SimpleFSDP-Simpler-Fully-Sharded-Data-Parallel-with-torch.compile/
            </a>
          </p>

          <p>
            <strong>라이선스:</strong>
            <a
              href="https://creativecommons.org/licenses/by-nc-sa/4.0/"
              target="_blank"
              rel="noopener noreferrer"
              class="text-primary hover:text-primary/80 transition-colors duration-200">
              CC BY-NC-SA 4.0
            </a>
          </p>

          <p class="text-xs">
            이 저작물은 크리에이티브 커먼즈 저작자표시-비영리-동일조건변경허락 4.0 국제 라이선스에 따라 이용할 수 있습니다. 출처를 표시하고, 비영리 목적으로만 사용하며, 동일한 라이선스를 유지해야 합니다.
          </p>
        </div>
      </div>
    </div>
  </div>


  
  





  <nav
    class="post-navigation mb-12"
    aria-label="게시글 네비게이션">
    <div class="grid grid-cols-1 gap-4 md:grid-cols-2">
      
      <div class="nav-item">
        
          <a
            href="/posts/ClusterKV-Manipulating-LLM-KV-Cache-in-Semantic-Space-for-Recallable-Compression/"
            class="group bg-card border-border hover:bg-primary/5 hover:border-primary/20 focus:ring-primary/20 flex min-h-[140px] flex-col justify-between rounded-xl border p-6 transition-all duration-300 ease-out hover:-translate-y-1 hover:scale-[1.02] hover:shadow-lg focus:ring-2 focus:outline-none">
            <div>
              <div class="mb-3 flex items-center gap-3">
                
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
</svg>
                <span class="text-muted-foreground text-sm font-medium">
                  이전
                </span>
              </div>

              <h3
                class="text-foreground group-hover:text-primary mb-3 line-clamp-2 text-lg leading-tight font-semibold transition-colors duration-200">
                ClusterKV: Manipulating LLM KV Cache in Semantic Space for Recallable Compression
              </h3>
            </div>

            <div
              class="text-muted-foreground mt-auto flex items-center gap-2 text-xs">
              
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
</svg>
              <time datetime="2024-12-20">
                12月20日
              </time>
            </div>
          </a>
        
      </div>

      
      <div class="nav-item">
        
          <a
            href="/posts/FastAttention-Extend-FlashAttention2-to-NPUs-and-Low-resource-GPUs/"
            class="group bg-card border-border hover:bg-primary/5 hover:border-primary/20 focus:ring-primary/20 flex min-h-[140px] flex-col justify-between rounded-xl border p-6 transition-all duration-300 ease-out hover:-translate-y-1 hover:scale-[1.02] hover:shadow-lg focus:ring-2 focus:outline-none">
            <div>
              <div class="mb-3 flex items-center justify-end gap-3">
                <span class="text-muted-foreground text-sm font-medium">
                  다음
                </span>
                
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
</svg>
              </div>

              <h3
                class="text-foreground group-hover:text-primary mb-3 line-clamp-2 text-right text-lg leading-tight font-semibold transition-colors duration-200">
                FastAttention: Extend FlashAttention2 to NPUs and Low-resource GPUs
              </h3>
            </div>

            <div
              class="text-muted-foreground mt-auto flex items-center justify-end gap-2 text-xs">
              <time datetime="2024-12-23">
                12月23日
              </time>
              
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
</svg>
            </div>
          </a>
        
      </div>
    </div>
  </nav>




  
  










  
  


    </main>

    <footer class="mx-auto max-w-4xl px-4 py-8">
  <div class="px-6 py-6">
    
    
      <nav class="mb-6">
        <div class="flex flex-wrap items-center justify-center gap-1">
          
            
            
            
            <a
              href="/index.xml"
              
              class="nav-link hover:text-primary hover:bg-primary/10 text-muted-foreground flex items-center gap-2 rounded-lg px-4 py-2 text-sm font-medium transition-all duration-300 hover:scale-105">
              
                
  <svg class="h-5 w-5"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="RSS Feed">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 5c7.18 0 13 5.82 13 13M6 11a7 7 0 017 7m-6 0a1 1 0 11-2 0 1 1 0 012 0z" />

</svg>
              
              <span
                >
                  RSS Feed
                </span
              >
            </a>
          
        </div>
      </nav>
    


    
    
      <div class="border-border mb-6 border-t"></div>
    


    
    <div class="flex flex-col items-center justify-between gap-4 md:flex-row">
      
      <div class="text-muted-foreground text-sm">
        <p>
          &copy; 2025 Jaehun&#39;s Blog.
          모든 권리 보유.
        </p>
      </div>

      
      
        <div class="flex items-center gap-3">
          
            <a
              href="https://github.com/ryujaehun"
              
                target="_blank" rel="noopener noreferrer"
              
              class="text-muted-foreground hover:text-primary focus:ring-primary/20 rounded-lg p-1 transition-all duration-300 ease-out hover:scale-110 focus:ring-2 focus:outline-none"
              title="GitHub"
              aria-label="GitHub">
              
                
  <svg class="h-6 w-6"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="GitHub"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"><path d="M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5c.08-1.25-.27-2.48-1-3.5c.28-1.15.28-2.35 0-3.5c0 0-1 0-3 1.5c-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.4 5.4 0 0 0 4 9c0 3.5 3 5.5 6 5.5c-.39.49-.68 1.05-.85 1.65S8.93 17.38 9 18v4"/><path d="M9 18c-4.51 2-5-2-7-2"/></g></svg>
              
            </a>
          
            <a
              href="https://www.linkedin.com/in/jaehunryu/"
              
                target="_blank" rel="noopener noreferrer"
              
              class="text-muted-foreground hover:text-primary focus:ring-primary/20 rounded-lg p-1 transition-all duration-300 ease-out hover:scale-110 focus:ring-2 focus:outline-none"
              title="Linkedin"
              aria-label="Linkedin">
              
                
  <svg class="h-6 w-6"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="Linkedin"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"><path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2a2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6M2 9h4v12H2z"/><circle cx="4" cy="4" r="2"/></g></svg>
              
            </a>
          
            <a
              href="mailto:jaehunryu@icloud.com"
              
              class="text-muted-foreground hover:text-primary focus:ring-primary/20 rounded-lg p-1 transition-all duration-300 ease-out hover:scale-110 focus:ring-2 focus:outline-none"
              title="Email"
              aria-label="Email">
              
                
  <svg class="h-6 w-6"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="Email">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />

</svg>
              
            </a>
          
        </div>
      

    </div>
  </div>
</footer>


    
    



<div
  id="dock"
  class="pointer-events-none fixed bottom-4 left-1/2 z-[9999] w-fit -translate-x-1/2 translate-y-24 opacity-0 transition-all duration-300 ease-out sm:right-0 sm:left-0 sm:mx-auto sm:translate-x-0"
  role="toolbar"
  aria-label="바로가기 도구 모음">
  <nav
    class="border-border bg-card/80 scrollbar-hide xs:px-3 xs:py-2 mx-auto flex max-w-[calc(100vw-2rem)] min-w-fit items-center justify-center overflow-x-auto rounded-2xl border px-4 py-3 shadow-lg backdrop-blur-sm sm:px-4 sm:py-3">
    
    
      <button
        id="dock-back"
        class="text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 xs:px-2 xs:py-1.5 flex flex-shrink-0 items-center gap-2 rounded-lg px-3 py-2 text-sm font-medium transition-all duration-300 ease-out hover:-translate-y-0.5 hover:scale-105 focus:ring-2 focus:outline-none sm:px-3 sm:py-2"
        title="뒤로"
        aria-label="뒤로">
        
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24">
  <path d="m12 19-7-7 7-7"/>
  <path d="M19 12H5"/>

</svg>
        <span class="hidden sm:inline"
          >뒤로</span
        >
      </button>

      
      <div class="bg-border xs:mx-1 mx-2 h-6 w-px sm:mx-2"></div>
    


    
    
      <button
        id="dock-toc"
        class="text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 xs:px-2 xs:py-1.5 flex flex-shrink-0 items-center gap-2 rounded-lg px-3 py-2 text-sm font-medium transition-all duration-300 ease-out hover:-translate-y-0.5 hover:scale-105 focus:ring-2 focus:outline-none sm:px-3 sm:py-2"
        title="목차"
        aria-label="목차">
        
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24">
  <line x1="8" x2="21" y1="6" y2="6"/>
  <line x1="8" x2="21" y1="12" y2="12"/>
  <line x1="8" x2="21" y1="18" y2="18"/>
  <line x1="3" x2="3.01" y1="6" y2="6"/>
  <line x1="3" x2="3.01" y1="12" y2="12"/>
  <line x1="3" x2="3.01" y1="18" y2="18"/>

</svg>
        <span class="hidden sm:inline"
          >목차</span
        >
      </button>

      
      <div class="bg-border xs:mx-1 mx-2 h-6 w-px sm:mx-2"></div>
    


    
    <button
      id="dock-search"
      class="text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 xs:px-3 xs:py-1.5 flex flex-shrink-0 items-center gap-2 rounded-lg px-4 py-2 text-sm font-medium transition-all duration-300 ease-out hover:-translate-y-0.5 hover:scale-105 focus:ring-2 focus:outline-none sm:px-4 sm:py-2"
      title="검색"
      aria-label="검색">
      
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m21 21-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />

</svg>
      <span class="hidden md:inline"
        >검색</span
      >
    </button>

    
    <div class="bg-border xs:mx-1 mx-2 h-6 w-px sm:mx-2"></div>

    
    
    


    
    <button
      id="dock-top"
      class="text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 xs:px-2 xs:py-1.5 flex flex-shrink-0 items-center gap-2 rounded-lg px-3 py-2 text-sm font-medium transition-all duration-300 ease-out hover:-translate-y-0.5 hover:scale-105 focus:ring-2 focus:outline-none sm:px-3 sm:py-2"
      title="맨 위로"
      aria-label="맨 위로">
      
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24">
  <path d="m18 15-6-6-6 6"/>

</svg>
      <span class="hidden sm:inline"
        >맨 위로</span
      >
    </button>
  </nav>
</div>


    
      



<div
  id="toc-overlay"
  class="pointer-events-none fixed inset-0 z-40 bg-black/50 opacity-0 backdrop-blur-sm transition-all duration-300"
  role="dialog"
  aria-modal="true"
  aria-labelledby="toc-title"></div>


<div
  id="toc-card"
  class="pointer-events-none fixed inset-4 z-50 flex w-auto scale-95 items-center justify-center opacity-0 transition-all duration-300 sm:inset-auto sm:top-1/2 sm:left-1/2 sm:block sm:w-full sm:max-w-md sm:-translate-x-1/2 sm:-translate-y-1/2"
  role="dialog"
  aria-modal="true"
  aria-labelledby="toc-title">
  <div
    class="bg-card border-border w-full max-w-sm overflow-hidden rounded-xl border shadow-xl sm:max-w-md">
    
    <div
      class="border-border bg-muted/30 flex items-center justify-between border-b p-4">
      <div class="flex items-center gap-3">
        
  <svg class="h-5 w-5"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24">
  <line x1="8" x2="21" y1="6" y2="6"/>
  <line x1="8" x2="21" y1="12" y2="12"/>
  <line x1="8" x2="21" y1="18" y2="18"/>
  <line x1="3" x2="3.01" y1="6" y2="6"/>
  <line x1="3" x2="3.01" y1="12" y2="12"/>
  <line x1="3" x2="3.01" y1="18" y2="18"/>

</svg>
        <h2 id="toc-title" class="text-foreground text-lg font-semibold">
          목차
        </h2>
      </div>

      
      <button
        id="toc-close"
        class="text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 rounded-lg p-2 transition-all duration-200 ease-out hover:-translate-y-0.5 hover:scale-105 focus:ring-2 focus:outline-none"
        title="닫기"
        aria-label="닫기">
        
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />

</svg>
      </button>
    </div>

    
    <div class="max-h-96 overflow-y-auto p-4">
      <nav
        id="toc-nav"
        class="toc-scrollbar"
        aria-label="글 목차">
          
          <div id="toc-content">
            <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#논문의-요약-및-강점">논문의 요약 및 강점</a></li>
        <li><a href="#핵심-알고리즘-설명">핵심 알고리즘 설명</a>
          <ul>
            <li><a href="#simplefsdp의-주요-과정"><strong>SimpleFSDP의 주요 과정:</strong></a></li>
            <li><a href="#예시-입력과-과정-설명"><strong>예시 입력과 과정 설명</strong></a></li>
          </ul>
        </li>
        <li><a href="#한계점">한계점</a></li>
        <li><a href="#결론-및-미래-연구">결론 및 미래 연구</a></li>
      </ul>
    </li>
  </ul>

  <ul>
    <li>
      <ul>
        <li><a href="#simplefsdp의-핵심-알고리즘">SimpleFSDP의 핵심 알고리즘</a></li>
        <li><a href="#1-파라미터-샤딩-및-통신-연산">1. <strong>파라미터 샤딩 및 통신 연산</strong></a>
          <ul>
            <li><a href="#과정">과정:</a></li>
          </ul>
        </li>
        <li><a href="#2-ir-노드-버킷화bucketing">2. <strong>IR 노드 버킷화(Bucketing)</strong></a>
          <ul>
            <li><a href="#목표">목표:</a></li>
            <li><a href="#구현">구현:</a></li>
            <li><a href="#예시">예시:</a></li>
          </ul>
        </li>
        <li><a href="#3-ir-노드-재정렬reordering">3. <strong>IR 노드 재정렬(Reordering)</strong></a>
          <ul>
            <li><a href="#목표-1">목표:</a></li>
            <li><a href="#구현-1">구현:</a></li>
            <li><a href="#예시-1">예시:</a></li>
          </ul>
        </li>
        <li><a href="#4-자동-래핑auto-wrapping">4. <strong>자동 래핑(Auto-Wrapping)</strong></a>
          <ul>
            <li><a href="#목표-2">목표:</a></li>
            <li><a href="#구현-2">구현:</a></li>
            <li><a href="#예시-2">예시:</a></li>
          </ul>
        </li>
        <li><a href="#전체-과정-요약">전체 과정 요약</a></li>
        <li><a href="#알고리즘의-효과">알고리즘의 효과</a></li>
        <li><a href="#결과-1">결과</a></li>
      </ul>
    </li>
  </ul>

  <ul>
    <li>
      <ul>
        <li><a href="#논문에서-제시한-결과와-특출난-점">논문에서 제시한 결과와 특출난 점</a>
          <ul>
            <li><a href="#제시된-주요-결과"><strong>제시된 주요 결과</strong></a></li>
            <li><a href="#다른-방법론-대비-특출난-점"><strong>다른 방법론 대비 특출난 점</strong></a></li>
          </ul>
        </li>
        <li><a href="#논문에서-제시하는-결과의-이유">논문에서 제시하는 결과의 이유</a>
          <ul>
            <li><a href="#1-ir-노드-버킷화bucketing"><strong>1. IR 노드 버킷화(Bucketing)</strong></a></li>
            <li><a href="#2-ir-노드-재정렬reordering"><strong>2. IR 노드 재정렬(Reordering)</strong></a></li>
            <li><a href="#3-자동-래핑auto-wrapping"><strong>3. 자동 래핑(Auto-Wrapping)</strong></a></li>
          </ul>
        </li>
        <li><a href="#논문에서-제시된-이유에-대한-내-의견"><strong>논문에서 제시된 이유에 대한 내 의견</strong></a>
          <ul>
            <li><a href="#왜-이런-결과가-나왔는가"><strong>왜 이런 결과가 나왔는가?</strong></a></li>
            <li><a href="#비판적-관점에서의-평가"><strong>비판적 관점에서의 평가</strong></a></li>
          </ul>
        </li>
        <li><a href="#결론">결론</a></li>
      </ul>
    </li>
  </ul>

  <ul>
    <li>
      <ul>
        <li><a href="#논문의-입력-데이터-및-추론-과정">논문의 입력 데이터 및 추론 과정</a>
          <ul>
            <li><a href="#입력-데이터"><strong>입력 데이터</strong></a></li>
            <li><a href="#추론-과정"><strong>추론 과정</strong></a></li>
          </ul>
        </li>
        <li><a href="#모델-아키텍처-구성">모델 아키텍처 구성</a>
          <ul>
            <li><a href="#1-llama-31-모델-구조"><strong>1. Llama 3.1 모델 구조</strong></a></li>
          </ul>
        </li>
        <li><a href="#모델-연산-및-자원-요구량">모델 연산 및 자원 요구량</a>
          <ul>
            <li><a href="#1-주요-연산"><strong>1. 주요 연산</strong></a></li>
            <li><a href="#2-메모리-요구량"><strong>2. 메모리 요구량</strong></a></li>
            <li><a href="#3-컴퓨팅-요구량"><strong>3. 컴퓨팅 요구량</strong></a></li>
            <li><a href="#ir-노드-최적화로-인한-요구량-감소"><strong>IR 노드 최적화로 인한 요구량 감소</strong></a></li>
          </ul>
        </li>
        <li><a href="#정리">정리</a></li>
      </ul>
    </li>
  </ul>

  <ul>
    <li>
      <ul>
        <li><a href="#논문의-한계-및-이를-극복하기-위한-연구-흐름">논문의 한계 및 이를 극복하기 위한 연구 흐름</a></li>
        <li><a href="#1-논문의-주요-한계"><strong>1. 논문의 주요 한계</strong></a>
          <ul>
            <li><a href="#11-자동-래핑auto-wrapping의-비효율성"><strong>1.1 자동 래핑(Auto-Wrapping)의 비효율성</strong></a></li>
            <li><a href="#12-통신-시간-추정의-한계"><strong>1.2 통신 시간 추정의 한계</strong></a></li>
            <li><a href="#13-데이터-종속적-코드-처리"><strong>1.3 데이터 종속적 코드 처리</strong></a></li>
            <li><a href="#14-대규모-분산-환경의-병목"><strong>1.4 대규모 분산 환경의 병목</strong></a></li>
          </ul>
        </li>
        <li><a href="#2-한계를-극복하기-위한-연구-흐름"><strong>2. 한계를 극복하기 위한 연구 흐름</strong></a>
          <ul>
            <li><a href="#21-자동-래핑의-개선"><strong>2.1 자동 래핑의 개선</strong></a></li>
            <li><a href="#22-통신-시간-추정의-개선"><strong>2.2 통신 시간 추정의 개선</strong></a></li>
            <li><a href="#23-데이터-종속적-코드-지원"><strong>2.3 데이터 종속적 코드 지원</strong></a></li>
            <li><a href="#24-대규모-분산-환경-최적화"><strong>2.4 대규모 분산 환경 최적화</strong></a></li>
          </ul>
        </li>
        <li><a href="#3-결론"><strong>3. 결론</strong></a></li>
      </ul>
    </li>
  </ul>

  <ul>
    <li>
      <ul>
        <li><a href="#simplefsdp의-ir-노드-버킷화bucketing와-재정렬reordering의-구조적-이점-및-개선점">SimpleFSDP의 IR 노드 **버킷화(Bucketing)**와 <strong>재정렬(Reordering)의 구조적 이점 및 개선점</strong></a></li>
        <li><a href="#1-기존-fsdp의-구조적-한계"><strong>1. 기존 FSDP의 구조적 한계</strong></a></li>
        <li><a href="#2-simplefsdp의-버킷화bucketing와-재정렬reordering의-구조적-이점"><strong>2. SimpleFSDP의 버킷화(Bucketing)와 재정렬(Reordering)의 구조적 이점</strong></a>
          <ul>
            <li><a href="#21-버킷화bucketing의-구조적-이점"><strong>2.1 버킷화(Bucketing)의 구조적 이점</strong></a></li>
            <li><a href="#22-재정렬reordering의-구조적-이점"><strong>2.2 재정렬(Reordering)의 구조적 이점</strong></a></li>
          </ul>
        </li>
        <li><a href="#3-실제-학습에서-통신과-계산-병렬화의-개선점"><strong>3. 실제 학습에서 통신과 계산 병렬화의 개선점</strong></a>
          <ul>
            <li><a href="#31-통신-오버헤드-감소"><strong>3.1 통신 오버헤드 감소</strong></a></li>
            <li><a href="#32-gpu-사용률-향상"><strong>3.2 GPU 사용률 향상</strong></a></li>
            <li><a href="#33-메모리-관리-최적화"><strong>3.3 메모리 관리 최적화</strong></a></li>
          </ul>
        </li>
        <li><a href="#4-실제-성능-향상"><strong>4. 실제 성능 향상</strong></a>
          <ul>
            <li><a href="#실험-결과-llama-31-시리즈"><strong>실험 결과 (Llama 3.1 시리즈)</strong></a></li>
          </ul>
        </li>
        <li><a href="#5-한계-및-발전-가능성"><strong>5. 한계 및 발전 가능성</strong></a></li>
        <li><a href="#결론-1"><strong>결론</strong></a></li>
      </ul>
    </li>
  </ul>

  <ul>
    <li>
      <ul>
        <li><a href="#자동-래핑auto-wrapping-알고리즘의-설계와-최적화-방식">자동 래핑(Auto-Wrapping) 알고리즘의 설계와 최적화 방식</a></li>
        <li><a href="#1-자동-래핑auto-wrapping의-목적"><strong>1. 자동 래핑(Auto-Wrapping)의 목적</strong></a></li>
        <li><a href="#2-알고리즘의-작동-기준-및-조건"><strong>2. 알고리즘의 작동 기준 및 조건</strong></a>
          <ul>
            <li><a href="#21-주요-입력-변수"><strong>2.1 주요 입력 변수</strong></a></li>
            <li><a href="#22-최적화-조건"><strong>2.2 최적화 조건</strong></a></li>
            <li><a href="#23-알고리즘의-동작"><strong>2.3 알고리즘의 동작</strong></a></li>
          </ul>
        </li>
        <li><a href="#3-메모리와-처리량-균형의-어려움"><strong>3. 메모리와 처리량 균형의 어려움</strong></a>
          <ul>
            <li><a href="#31-균형-조정의-한계"><strong>3.1 균형 조정의 한계</strong></a></li>
            <li><a href="#32-실제-사례"><strong>3.2 실제 사례</strong></a></li>
          </ul>
        </li>
        <li><a href="#4-추가적인-접근법"><strong>4. 추가적인 접근법</strong></a>
          <ul>
            <li><a href="#41-강화-학습-기반-최적화"><strong>4.1 강화 학습 기반 최적화</strong></a></li>
            <li><a href="#42-다목적-최적화-알고리즘"><strong>4.2 다목적 최적화 알고리즘</strong></a></li>
            <li><a href="#43-동적-메모리-관리"><strong>4.3 동적 메모리 관리</strong></a></li>
            <li><a href="#44-네트워크-토폴로지-모델링"><strong>4.4 네트워크 토폴로지 모델링</strong></a></li>
          </ul>
        </li>
        <li><a href="#5-결론"><strong>5. 결론</strong></a></li>
      </ul>
    </li>
  </ul>

  <ul>
    <li>
      <ul>
        <li><a href="#simplefsdp의-pytorch-native-통합-및-최신-분산-학습-기술과의-호환성">SimpleFSDP의 PyTorch-native 통합 및 최신 분산 학습 기술과의 호환성</a></li>
        <li><a href="#1-simplefsdp의-pytorch-native-통합-방식"><strong>1. SimpleFSDP의 PyTorch-native 통합 방식</strong></a>
          <ul>
            <li><a href="#11-주요-pytorch-프리미티브"><strong>1.1 주요 PyTorch 프리미티브</strong></a></li>
          </ul>
        </li>
        <li><a href="#2-최신-분산-학습-기술과의-호환성"><strong>2. 최신 분산 학습 기술과의 호환성</strong></a>
          <ul>
            <li><a href="#21-tensor-parallel"><strong>2.1 Tensor Parallel</strong></a></li>
            <li><a href="#22-pipeline-parallel"><strong>2.2 Pipeline Parallel</strong></a></li>
            <li><a href="#23-혼합-정밀도-학습mixed-precision-training"><strong>2.3 혼합 정밀도 학습(Mixed Precision Training)</strong></a></li>
            <li><a href="#24-meta-initialization"><strong>2.4 Meta Initialization</strong></a></li>
          </ul>
        </li>
        <li><a href="#3-병목-현상-및-해결-방법"><strong>3. 병목 현상 및 해결 방법</strong></a>
          <ul>
            <li><a href="#31-병목-현상"><strong>3.1 병목 현상</strong></a></li>
            <li><a href="#32-해결-방법"><strong>3.2 해결 방법</strong></a></li>
          </ul>
        </li>
        <li><a href="#4-실제-성능-개선"><strong>4. 실제 성능 개선</strong></a></li>
        <li><a href="#5-결론-1"><strong>5. 결론</strong></a></li>
      </ul>
    </li>
  </ul>
</nav>
          </div>
      </nav>
    </div>

    
    <div class="border-border bg-muted/20 border-t px-4 py-3">
      <div class="text-muted-foreground text-center text-xs">
        <span>제목을 클릭하면 해당 위치로 이동합니다</span>
      </div>
    </div>
  </div>
</div>

    


  <link
    rel="stylesheet"
    href="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.css"
    integrity="sha384-5TcZemv2l/9On385z///+d7MSYlvIEw9FuZTIdZ14vJLqWphw7e7ZPuOiCHJcFCP"
    crossorigin="anonymous" />
  <script
    defer
    src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.js"
    integrity="sha384-cMkvdD8LoxVzGF/RPUKAcvmm49FQ0oxwDF3BGKtDXcEc+T1b2N+teh/OJfpU0jr6"
    crossorigin="anonymous"></script>
  <script
    defer
    src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/contrib/auto-render.min.js"
    integrity="sha384-hCXGrW6PitJEwbkoStFjeJxv+fSOOQKOPbJxSfM6G5sWZjAyWhXiTIIAmQqnlLlh"
    crossorigin="anonymous"></script>

<script>
    
    function initKaTeX() {
        if (typeof renderMathInElement === 'undefined') {
            setTimeout(initKaTeX, 100);
            return;
        }

        var delimiters = [{"display":true,"left":"$$","right":"$$"},{"display":false,"left":"$","right":"$"}];

        renderMathInElement(document.body, {
            delimiters: delimiters,
            throwOnError: false,
            errorColor: '#cc0000',
            fleqn: false,
            leqno: false,
            trust: false
        });
    }

    
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', initKaTeX);
    } else {
        initKaTeX();
    }
</script>
    



    
    
<div
  id="search-overlay"
  class="pointer-events-none fixed inset-0 z-40 bg-black/50 opacity-0 transition-opacity duration-300"></div>


<div
  id="search-modal"
  class="bg-card border-border pointer-events-none fixed top-1/2 left-1/2 z-50 max-h-[80vh] w-full max-w-2xl -translate-x-1/2 -translate-y-1/2 scale-95 transform overflow-hidden rounded-xl border opacity-0 shadow-xl transition-all duration-300">
  
  <div class="border-border flex items-center gap-3 border-b p-4">
    
    <div class="text-muted-foreground h-5 w-5 flex-shrink-0">
      
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m21 21-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />

</svg>
    </div>

    
    <div class="relative flex-1">
      
      <button
        id="search-clear"
        class="text-muted-foreground hover:text-foreground hover:bg-muted/50 pointer-events-none absolute top-1/2 left-0 z-10 h-5 w-5 -translate-y-1/2 rounded opacity-0 transition-all duration-200"
        title="지우기"
        aria-label="지우기">
        
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />

</svg>
      </button>

      
      <input
        id="search-input"
        type="text"
        placeholder="게시글 검색..."
        class="text-foreground placeholder:text-muted-foreground w-full border-none bg-transparent pl-8 text-lg outline-none"
        autocomplete="off"
        spellcheck="false" />
    </div>

    
    <button
      id="search-close"
      class="text-muted-foreground hover:text-foreground hover:bg-muted/50 flex h-6 w-6 items-center justify-center rounded-md p-0.5 transition-all duration-200"
      title="닫기"
      aria-label="닫기">
      
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />

</svg>
    </button>
  </div>

  
  <div id="search-results" class="max-h-96 overflow-y-auto">
    
    <div
      id="search-empty"
      class="flex flex-col items-center justify-center py-12 text-center">
      <div
        class="bg-muted/50 mb-4 flex h-16 w-16 items-center justify-center rounded-full">
        
  <svg class="h-6 w-6"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m21 21-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />

</svg>
      </div>
      <h3 class="text-foreground mb-2 text-lg font-semibold">
        검색 시작
      </h3>
      <p class="text-muted-foreground text-sm">
        검색어를 입력하세요
      </p>
    </div>

    
    <div
      id="search-loading"
      class="flex hidden items-center justify-center py-8">
      <div
        class="mr-3 h-6 w-6 animate-spin rounded-full border-2 border-current border-t-transparent"></div>
      <span class="text-muted-foreground"
        >검색 중...</span
      >
    </div>

    
    <div
      id="search-no-results"
      class="flex hidden flex-col items-center justify-center py-12 text-center">
      <div
        class="bg-muted/50 mb-4 flex h-16 w-16 items-center justify-center rounded-full">
        
  <svg class="h-6 w-6"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h7" />
</svg>
      </div>
      <h3 class="text-foreground mb-2 text-lg font-semibold">
        검색 결과 없음
      </h3>
      <p class="text-muted-foreground text-sm">
        다른 검색어로 시도해보세요
      </p>
    </div>

    
    <div id="search-results-list" class="hidden">
      
      <div
        id="search-stats"
        class="text-muted-foreground border-border border-b px-4 py-3 text-sm"
        data-template="%d개의 결과 찾음">
      </div>

      
      <div id="search-items" class="divide-border divide-y">
        
      </div>
    </div>
  </div>

  
  <div class="border-border bg-muted/20 border-t px-4 py-3">
    <div
      class="text-muted-foreground flex items-center justify-between text-xs">
      <div class="flex items-center gap-2 md:gap-4">
        <div class="flex items-center gap-1">
          <kbd
            class="bg-muted border-border rounded border px-1.5 py-0.5 text-xs"
            >↑↓</kbd
          >
          <span class="hidden sm:inline"
            >이동</span
          >
        </div>
        <div class="flex items-center gap-1">
          <kbd
            class="bg-muted border-border rounded border px-1.5 py-0.5 text-xs"
            >↵</kbd
          >
          <span class="hidden sm:inline"
            >선택</span
          >
        </div>
        <div class="flex items-center gap-1">
          <kbd
            class="bg-muted border-border rounded border px-1.5 py-0.5 text-xs"
            >ESC</kbd
          >
          <span class="hidden sm:inline"
            >닫기</span
          >
        </div>
      </div>
      <div class="search-hint-desktop flex items-center gap-1">
        <kbd class="bg-muted border-border rounded border px-1.5 py-0.5 text-xs"
          >⌘K</kbd
        >
        <span>단축키</span>
      </div>
    </div>
  </div>
</div>

  </body>
</html>
