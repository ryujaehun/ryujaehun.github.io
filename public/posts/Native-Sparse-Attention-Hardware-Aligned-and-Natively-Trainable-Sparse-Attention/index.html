<!doctype html>
<html
  lang="ko-kr"
  data-theme="claude">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1314&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8" />
<meta
  name="viewport"
  content="width=device-width, initial-scale=1, shrink-to-fit=no" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />

<title>Native Sparse Attention: Hardware-Aligned and Natively Trainable Sparse Attention | Jaehun&#39;s Blog</title>

<meta name="description" content="논문 링크
Native Sparse Attention (NSA) — 64 k 토큰도 11× 빠르게, 정확도는 그대로 한 줄 요약 (TL;DR) NSA는 ‘압축 → 선택 → 슬라이딩’ 3 분기 희소 어텐션과 GQA/MQA-친화 커널을 결합해 64 k 컨텍스트에서 디코딩 ..." />
<meta name="keywords" content="2502.11089v2, Sparse Attention, Long Context, Transformer Optimization, Efficient LLM, GPU Acceleration, FlashAttention, Memory Efficiency, Inference Speedup, Trainable Sparsity, Triton Kernel, Deep Learning, Language Models, DeepSeek" />
<meta name="author" content="" />
<meta name="language" content="ko-kr" />

<meta name="robots" content="index, follow" />
<link rel="canonical" href="http://192.168.1.11:1314/posts/Native-Sparse-Attention-Hardware-Aligned-and-Natively-Trainable-Sparse-Attention/" />



  <link rel="icon" type="image/svg+xml" href="/favicon.svg" />



<link rel="manifest" href="/site.webmanifest" />
<meta property="og:url" content="http://192.168.1.11:1314/posts/Native-Sparse-Attention-Hardware-Aligned-and-Natively-Trainable-Sparse-Attention/">
  <meta property="og:site_name" content="Jaehun&#39;s Blog">
  <meta property="og:title" content="Native Sparse Attention: Hardware-Aligned and Natively Trainable Sparse Attention">
  <meta property="og:description" content="논문 링크
Native Sparse Attention (NSA) — 64 k 토큰도 11× 빠르게, 정확도는 그대로 한 줄 요약 (TL;DR) NSA는 ‘압축 → 선택 → 슬라이딩’ 3 분기 희소 어텐션과 GQA/MQA-친화 커널을 결합해 64 k 컨텍스트에서 디코딩 속도를 11.6 배, 학습 속도를 최대 9 배 높이면서도 Full-Attention보다 평균 성능을 향상시킨다.">
  <meta property="og:locale" content="ko_kr">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-07-07T00:00:00+00:00">
    <meta property="article:modified_time" content="2025-07-07T00:00:00+00:00">
    <meta property="article:tag" content="2502.11089v2">
    <meta property="article:tag" content="Sparse Attention">
    <meta property="article:tag" content="Long Context">
    <meta property="article:tag" content="Transformer Optimization">
    <meta property="article:tag" content="Efficient LLM">
    <meta property="article:tag" content="GPU Acceleration">
    <meta property="og:image" content="http://192.168.1.11:1314/images/og-default.avif">


  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="http://192.168.1.11:1314/images/og-default.avif">
  <meta name="twitter:title" content="Native Sparse Attention: Hardware-Aligned and Natively Trainable Sparse Attention">
  <meta name="twitter:description" content="논문 링크
Native Sparse Attention (NSA) — 64 k 토큰도 11× 빠르게, 정확도는 그대로 한 줄 요약 (TL;DR) NSA는 ‘압축 → 선택 → 슬라이딩’ 3 분기 희소 어텐션과 GQA/MQA-친화 커널을 결합해 64 k 컨텍스트에서 디코딩 속도를 11.6 배, 학습 속도를 최대 9 배 높이면서도 Full-Attention보다 평균 성능을 향상시킨다.">


  <meta itemprop="name" content="Native Sparse Attention: Hardware-Aligned and Natively Trainable Sparse Attention">
  <meta itemprop="description" content="논문 링크
Native Sparse Attention (NSA) — 64 k 토큰도 11× 빠르게, 정확도는 그대로 한 줄 요약 (TL;DR) NSA는 ‘압축 → 선택 → 슬라이딩’ 3 분기 희소 어텐션과 GQA/MQA-친화 커널을 결합해 64 k 컨텍스트에서 디코딩 속도를 11.6 배, 학습 속도를 최대 9 배 높이면서도 Full-Attention보다 평균 성능을 향상시킨다.">
  <meta itemprop="datePublished" content="2025-07-07T00:00:00+00:00">
  <meta itemprop="dateModified" content="2025-07-07T00:00:00+00:00">
  <meta itemprop="wordCount" content="15065">
  <meta itemprop="image" content="http://192.168.1.11:1314/images/og-default.avif">
  <meta itemprop="keywords" content="2502.11089v2,Sparse Attention,Long Context,Transformer Optimization,Efficient LLM,GPU Acceleration,FlashAttention,Memory Efficiency,Inference Speedup,Trainable Sparsity,Triton Kernel,Deep Learning,Language Models,DeepSeek">







<script>
  window.HUGO_SEARCH_CONFIG = {
    searchIndexURL: "\"/index.json\""
  };
</script>


































<script>

  window.HUGO_GALLERY_CONFIG = {
    justified_gallery:  false ,
    lightbox:  false ,
    justified: "{}",
    lightbox_options: "{}"
  };
</script>




  
    <link rel="stylesheet" href="/css/compiled.css" />
  





  
    <link rel="stylesheet" href="/css/chroma.css" />
  












      <script src="/js/main.js"></script>



  <script src="/js/gumshoe.polyfills.min.js"></script>



        <script src="/js/toc.js" defer></script>



      <script src="/js/search.js" defer></script>



      <script src="/js/dock.js" defer></script>











  











    <script>
      
      (function() {
        const theme = localStorage.getItem('theme') || 'system';
        const colorScheme = localStorage.getItem('colorScheme') || 'claude';

        
        document.documentElement.setAttribute('data-theme', colorScheme);

        
        function applyTheme() {
          if (theme === 'dark' || (theme === 'system' && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
            document.documentElement.classList.add('dark');
          } else {
            document.documentElement.classList.remove('dark');
          }
        }

        applyTheme();

        
        if (theme === 'system') {
          window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', applyTheme);
        }
      })();
    </script>
  </head>

  <body class="bg-background text-foreground min-h-screen antialiased">
    
    
  <div
    id="reading-progress-container"
    class="reading-progress-container pointer-events-none fixed top-0 right-0 left-0 z-50 transition-opacity duration-300 ease-out"
    data-height="3"
    data-smooth-scroll="true"
    data-hide-on-complete="false">
    
    <div class="reading-progress-bg w-full"></div>

    
    <div
      id="reading-progress-bar"
      class="from-primary to-primary/80 reading-progress-bar 
        transition-all duration-150 ease-out
       absolute top-0 left-0 w-0 bg-gradient-to-r"></div>
  </div>

  <script>
    (function () {
      "use strict";

      const progressContainer = document.getElementById(
        "reading-progress-container",
      );
      const progressBar = document.getElementById("reading-progress-bar");

      if (!progressContainer || !progressBar) return;

      
      const config = {
        smoothScroll: progressContainer.dataset.smoothScroll === "true",
        hideOnComplete: progressContainer.dataset.hideOnComplete === "true",
      };

      let isVisible = true;
      let gumshoeInstance = null;

      
      function calculateProgress() {
        const scrollTop =
          window.pageYOffset || document.documentElement.scrollTop;
        const documentHeight = document.documentElement.scrollHeight;
        const windowHeight = window.innerHeight;
        const scrollableHeight = documentHeight - windowHeight;

        if (scrollableHeight <= 0) return 0;

        return Math.min(Math.max((scrollTop / scrollableHeight) * 100, 0), 100);
      }

      
      function updateProgress() {
        const progress = calculateProgress();
        progressBar.style.width = progress + "%";

        
        if (config.hideOnComplete && progress >= 99.5) {
          if (isVisible) {
            progressContainer.style.opacity = "0";
            isVisible = false;
          }
        } else if (!isVisible) {
          progressContainer.style.opacity = "1";
          isVisible = true;
        }
      }

      
      let ticking = false;
      function requestTick() {
        if (!ticking) {
          requestAnimationFrame(() => {
            updateProgress();
            ticking = false;
          });
          ticking = true;
        }
      }

      
      function init() {
        
        window.addEventListener("scroll", requestTick, { passive: true });
        window.addEventListener("resize", requestTick, { passive: true });
        document.addEventListener("visibilitychange", () => {
          if (!document.hidden) requestTick();
        });

        
        requestTick();

        
        window.addEventListener("beforeunload", () => {
          window.removeEventListener("scroll", requestTick);
          window.removeEventListener("resize", requestTick);
        });
      }

      
      if (document.readyState === "loading") {
        document.addEventListener("DOMContentLoaded", init);
      } else {
        init();
      }
    })();
  </script>

    <header class="sticky top-0 z-50 mx-auto max-w-4xl px-4 py-6">
  <div
    class="border-border bg-card/80 flex items-center rounded-xl border px-6 py-4 shadow-sm backdrop-blur-sm">
    
    <div class="hidden w-full items-center md:flex">
      
      <div class="flex items-center">
        
          
          <a
            href="/"
            class="bg-primary text-primary-foreground hover:bg-primary/90 flex h-10 w-10 items-center justify-center rounded-full text-lg font-bold transition-transform duration-200 hover:scale-105"
            aria-label="Jaehun&#39;s Blog">
            J
          </a>
        
      </div>

      
      <nav class="mx-8 flex flex-1 items-center justify-center">
        <div class="flex items-center space-x-1">
          
          
            
            
            
              
                
              
            
            
            <a
              href="/posts/"
              class="nav-link 
                text-muted-foreground hover:text-primary hover:bg-primary/10
               focus:ring-primary/20 relative flex items-center gap-2 rounded-lg px-4 py-2 text-sm font-medium transition-all duration-300 ease-out hover:-translate-y-0.5 hover:scale-105 focus:ring-2 focus:outline-none">
              
                
  <svg class="h-5 w-5"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="nav.posts">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 20H5a2 2 0 01-2-2V6a2 2 0 012-2h10a2 2 0 012 2v1m2 13a2 2 0 01-2-2V7m2 13a2 2 0 002-2V9a2 2 0 00-2-2h-2m-4-3H9M7 16h6M7 8h6v4H7V8z" />

</svg>
              
              <span
                >
                  게시글
                </span
              >
            </a>
          
            
            
            
              
                
              
            
            
            <a
              href="/categories/"
              class="nav-link 
                text-muted-foreground hover:text-primary hover:bg-primary/10
               focus:ring-primary/20 relative flex items-center gap-2 rounded-lg px-4 py-2 text-sm font-medium transition-all duration-300 ease-out hover:-translate-y-0.5 hover:scale-105 focus:ring-2 focus:outline-none">
              
                
  <svg class="h-5 w-5"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="nav.categories">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10" />

</svg>
              
              <span
                >
                  카테고리
                </span
              >
            </a>
          
            
            
            
              
                
              
            
            
            <a
              href="/tags/"
              class="nav-link 
                text-muted-foreground hover:text-primary hover:bg-primary/10
               focus:ring-primary/20 relative flex items-center gap-2 rounded-lg px-4 py-2 text-sm font-medium transition-all duration-300 ease-out hover:-translate-y-0.5 hover:scale-105 focus:ring-2 focus:outline-none">
              
                
  <svg class="h-5 w-5"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="nav.tags">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z" />

</svg>
              
              <span
                >
                  태그
                </span
              >
            </a>
          
            
            
            
              
                
              
            
            
            <a
              href="/archives/"
              class="nav-link 
                text-muted-foreground hover:text-primary hover:bg-primary/10
               focus:ring-primary/20 relative flex items-center gap-2 rounded-lg px-4 py-2 text-sm font-medium transition-all duration-300 ease-out hover:-translate-y-0.5 hover:scale-105 focus:ring-2 focus:outline-none">
              
                
  <svg class="h-5 w-5"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="nav.archives">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 8h14M5 8a2 2 0 110-4h14a2 2 0 110 4M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8m-9 4h4" />

</svg>
              
              <span
                >
                  아카이브
                </span
              >
            </a>
          
        </div>
      </nav>

      
      <div class="flex items-center space-x-2">
        
        
<div class="relative">
  <button id="language-toggle"
    class="dropdown-toggle border-border bg-background text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex h-10 w-10 items-center justify-center rounded-lg border transition-all duration-300 ease-out hover:scale-105 focus:ring-2 focus:outline-none active:scale-95"
    data-dropdown-type="language"
    aria-label="언어 변경"
    aria-expanded="false"
    aria-haspopup="true">
      
  <svg class="h-5 w-5 relative z-10"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="언어 변경">
	<path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m5 8l6 6m-7 0l6-6l2-3M2 5h12M7 2h1m14 20l-5-10l-5 10m2-4h6" />
</svg></button>

  
  <div id="language-dropdown"
    class="dropdown-menu border-border bg-popover/95 absolute top-12 right-0 z-[60] hidden w-40 rounded-lg border p-1 shadow-lg backdrop-blur-sm transition-all duration-200 ease-out"
    data-dropdown-type="language"
    role="menu"
    aria-labelledby="language-toggle"><a href="/ko/" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none" role="menuitem" aria-current="true"><span class="font-medium">한국어</span></a><a href="/en/" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none" role="menuitem"><span class="font-medium">English</span></a></div>
</div>

        
        
<div class="relative">
  <button id="color-scheme-toggle"
    class="dropdown-toggle border-border bg-background text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex h-10 w-10 items-center justify-center rounded-lg border transition-all duration-300 ease-out hover:scale-105 focus:ring-2 focus:outline-none active:scale-95"
    data-dropdown-type="color-scheme"
    aria-label="테마 변경"
    aria-expanded="false"
    aria-haspopup="true">
      
  <svg class="h-5 w-5 relative z-10"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="테마 변경">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zM21 5a2 2 0 00-2-2h-4a2 2 0 00-2 2v6a2 2 0 002 2h4a2 2 0 002-2V5z" />

</svg></button>

  
  <div id="color-scheme-dropdown"
    class="dropdown-menu border-border bg-popover/95 absolute top-12 right-0 z-[60] hidden w-44 rounded-lg border p-1 shadow-lg backdrop-blur-sm transition-all duration-200 ease-out"
    data-dropdown-type="color-scheme"><button data-color-scheme="claude" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Default</span></button><button data-color-scheme="default" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>White</span></button><button data-color-scheme="bumblebee" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Bumblebee</span></button><button data-color-scheme="emerald" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Emerald</span></button><button data-color-scheme="nord" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Nord</span></button><button data-color-scheme="sunset" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Sunset</span></button><button data-color-scheme="abyss" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Abyss</span></button><button data-color-scheme="dracula" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Dracula</span></button><button data-color-scheme="amethyst" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Amethyst</span></button><button data-color-scheme="slate" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Slate</span></button><button data-color-scheme="twitter" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Twitter</span></button></div>
</div>

        
        
<div class="relative">
  <button id="theme-toggle"
    class="dropdown-toggle border-border bg-background text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex h-10 w-10 items-center justify-center rounded-lg border transition-all duration-300 ease-out hover:scale-105 focus:ring-2 focus:outline-none active:scale-95"
    data-dropdown-type="theme"
    aria-label="테마 변경"
    aria-expanded="false"
    aria-haspopup="true">
      
      
  <svg class="h-5 w-5 sun-icon hidden relative z-10"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="라이트">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" />

</svg>
      
      
  <svg class="h-5 w-5 moon-icon hidden relative z-10"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="다크">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" />

</svg>
      
      
  <svg class="h-5 w-5 system-icon hidden relative z-10"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="시스템">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />

</svg></button>

  
  <div id="theme-dropdown"
    class="dropdown-menu border-border bg-popover/95 absolute top-12 right-0 z-[60] hidden w-40 rounded-lg border p-1 shadow-lg backdrop-blur-sm transition-all duration-200 ease-out"
    data-dropdown-type="theme"><button data-theme="light" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none">
  <svg class="h-5 w-5 mr-3 h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="라이트">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" />

</svg><span>라이트</span></button><button data-theme="dark" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none">
  <svg class="h-5 w-5 mr-3 h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="다크">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" />

</svg><span>다크</span></button><button data-theme="system" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none">
  <svg class="h-5 w-5 mr-3 h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="시스템">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />

</svg><span>시스템</span></button></div>
</div>
      </div>
    </div>

    
    <div class="flex w-full items-center justify-between md:hidden">
      
      
<div class="relative">
  <button
    id="mobile-menu-toggle"
    class="dropdown-toggle border-border bg-background text-muted-foreground hover:bg-accent hover:text-foreground flex h-10 w-10 items-center justify-center rounded-lg border transition-colors duration-200"
    data-dropdown-type="mobile-menu"
    aria-label="메뉴"
    aria-expanded="false"
    aria-haspopup="true">
    
  <svg class="h-5 w-5"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="메뉴">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />

</svg>
  </button>

  
  <div
    id="mobile-menu"
    class="mobile-menu dropdown-menu border-border bg-popover/95 absolute top-12 left-0 z-[60] hidden w-80 max-w-[calc(100vw-2rem)] rounded-lg border p-1 shadow-lg backdrop-blur-sm transition-all duration-200 ease-out md:hidden"
    data-dropdown-type="mobile-menu"
    role="menu"
    aria-labelledby="mobile-menu-toggle">
    <nav class="flex flex-col">
      
      
        
        
        
          
            
          
        
        
        <a
          href="/posts/"
          class="nav-link 
            text-muted-foreground hover:text-primary hover:bg-primary/10
           focus:ring-primary/20 relative flex items-center gap-3 rounded-md px-4 py-3 text-sm font-medium transition-all duration-200 ease-out hover:translate-x-1 focus:ring-2 focus:outline-none"
          role="menuitem"
          >
          
            
  <svg class="h-5 w-5"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="nav.posts">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 20H5a2 2 0 01-2-2V6a2 2 0 012-2h10a2 2 0 012 2v1m2 13a2 2 0 01-2-2V7m2 13a2 2 0 002-2V9a2 2 0 00-2-2h-2m-4-3H9M7 16h6M7 8h6v4H7V8z" />

</svg>
          
          <span
            >
              게시글
            </span
          >
        </a>
      
        
        
        
          
            
          
        
        
        <a
          href="/categories/"
          class="nav-link 
            text-muted-foreground hover:text-primary hover:bg-primary/10
           focus:ring-primary/20 relative flex items-center gap-3 rounded-md px-4 py-3 text-sm font-medium transition-all duration-200 ease-out hover:translate-x-1 focus:ring-2 focus:outline-none"
          role="menuitem"
          >
          
            
  <svg class="h-5 w-5"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="nav.categories">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10" />

</svg>
          
          <span
            >
              카테고리
            </span
          >
        </a>
      
        
        
        
          
            
          
        
        
        <a
          href="/tags/"
          class="nav-link 
            text-muted-foreground hover:text-primary hover:bg-primary/10
           focus:ring-primary/20 relative flex items-center gap-3 rounded-md px-4 py-3 text-sm font-medium transition-all duration-200 ease-out hover:translate-x-1 focus:ring-2 focus:outline-none"
          role="menuitem"
          >
          
            
  <svg class="h-5 w-5"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="nav.tags">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z" />

</svg>
          
          <span
            >
              태그
            </span
          >
        </a>
      
        
        
        
          
            
          
        
        
        <a
          href="/archives/"
          class="nav-link 
            text-muted-foreground hover:text-primary hover:bg-primary/10
           focus:ring-primary/20 relative flex items-center gap-3 rounded-md px-4 py-3 text-sm font-medium transition-all duration-200 ease-out hover:translate-x-1 focus:ring-2 focus:outline-none"
          role="menuitem"
          >
          
            
  <svg class="h-5 w-5"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="nav.archives">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 8h14M5 8a2 2 0 110-4h14a2 2 0 110 4M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8m-9 4h4" />

</svg>
          
          <span
            >
              아카이브
            </span
          >
        </a>
      
    </nav>
  </div>
</div>


      
      <div class="flex items-center space-x-2">
        
        
<div class="relative">
  <button id="language-toggle"
    class="dropdown-toggle border-border bg-background text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex h-10 w-10 items-center justify-center rounded-lg border transition-all duration-300 ease-out hover:scale-105 focus:ring-2 focus:outline-none active:scale-95"
    data-dropdown-type="language"
    aria-label="언어 변경"
    aria-expanded="false"
    aria-haspopup="true">
      
  <svg class="h-5 w-5 relative z-10"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="언어 변경">
	<path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m5 8l6 6m-7 0l6-6l2-3M2 5h12M7 2h1m14 20l-5-10l-5 10m2-4h6" />
</svg></button>

  
  <div id="language-dropdown"
    class="dropdown-menu border-border bg-popover/95 absolute top-12 right-0 z-[60] hidden w-40 rounded-lg border p-1 shadow-lg backdrop-blur-sm transition-all duration-200 ease-out"
    data-dropdown-type="language"
    role="menu"
    aria-labelledby="language-toggle"><a href="/ko/" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none" role="menuitem" aria-current="true"><span class="font-medium">한국어</span></a><a href="/en/" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none" role="menuitem"><span class="font-medium">English</span></a></div>
</div>

        
        
<div class="relative">
  <button id="color-scheme-toggle"
    class="dropdown-toggle border-border bg-background text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex h-10 w-10 items-center justify-center rounded-lg border transition-all duration-300 ease-out hover:scale-105 focus:ring-2 focus:outline-none active:scale-95"
    data-dropdown-type="color-scheme"
    aria-label="테마 변경"
    aria-expanded="false"
    aria-haspopup="true">
      
  <svg class="h-5 w-5 relative z-10"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="테마 변경">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zM21 5a2 2 0 00-2-2h-4a2 2 0 00-2 2v6a2 2 0 002 2h4a2 2 0 002-2V5z" />

</svg></button>

  
  <div id="color-scheme-dropdown"
    class="dropdown-menu border-border bg-popover/95 absolute top-12 right-0 z-[60] hidden w-44 rounded-lg border p-1 shadow-lg backdrop-blur-sm transition-all duration-200 ease-out"
    data-dropdown-type="color-scheme"><button data-color-scheme="claude" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Default</span></button><button data-color-scheme="default" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>White</span></button><button data-color-scheme="bumblebee" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Bumblebee</span></button><button data-color-scheme="emerald" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Emerald</span></button><button data-color-scheme="nord" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Nord</span></button><button data-color-scheme="sunset" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Sunset</span></button><button data-color-scheme="abyss" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Abyss</span></button><button data-color-scheme="dracula" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Dracula</span></button><button data-color-scheme="amethyst" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Amethyst</span></button><button data-color-scheme="slate" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Slate</span></button><button data-color-scheme="twitter" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Twitter</span></button></div>
</div>

        
        
<div class="relative">
  <button id="theme-toggle"
    class="dropdown-toggle border-border bg-background text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex h-10 w-10 items-center justify-center rounded-lg border transition-all duration-300 ease-out hover:scale-105 focus:ring-2 focus:outline-none active:scale-95"
    data-dropdown-type="theme"
    aria-label="테마 변경"
    aria-expanded="false"
    aria-haspopup="true">
      
      
  <svg class="h-5 w-5 sun-icon hidden relative z-10"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="라이트">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" />

</svg>
      
      
  <svg class="h-5 w-5 moon-icon hidden relative z-10"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="다크">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" />

</svg>
      
      
  <svg class="h-5 w-5 system-icon hidden relative z-10"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="시스템">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />

</svg></button>

  
  <div id="theme-dropdown"
    class="dropdown-menu border-border bg-popover/95 absolute top-12 right-0 z-[60] hidden w-40 rounded-lg border p-1 shadow-lg backdrop-blur-sm transition-all duration-200 ease-out"
    data-dropdown-type="theme"><button data-theme="light" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none">
  <svg class="h-5 w-5 mr-3 h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="라이트">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" />

</svg><span>라이트</span></button><button data-theme="dark" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none">
  <svg class="h-5 w-5 mr-3 h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="다크">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" />

</svg><span>다크</span></button><button data-theme="system" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none">
  <svg class="h-5 w-5 mr-3 h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="시스템">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />

</svg><span>시스템</span></button></div>
</div>
      </div>
    </div>
  </div>
</header>


    <main class="mx-auto max-w-4xl px-4 py-6">
      
  
  <nav
  class="breadcrumb mb-4 md:mb-6 py-1"
  aria-label="경로">
  <ol class="text-muted-foreground flex items-center space-x-1 md:space-x-2 text-sm overflow-x-auto whitespace-nowrap scrollbar-hide py-1">
    
    <li class="flex-shrink-0">
      <a
        href="/"
        class="text-muted-foreground hover:text-primary hover:bg-primary/10 flex items-center gap-0.5 md:gap-1 rounded-lg px-1 md:px-3 py-0.5 md:py-1.5 transition-all duration-200 ease-out hover:-translate-y-0.5 hover:scale-[1.02]">
        
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="홈">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m3 12 2-2m0 0 7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" />

</svg>
        <span class="max-w-[4rem] md:max-w-none truncate">홈</span>
      </a>
    </li>

    
    
      <li class="flex items-center gap-1 md:gap-2 min-w-0">
        <span class="text-muted-foreground/50 flex-shrink-0"
          >
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
</svg>
        </span>

        
          
          <div class="flex items-center gap-1 md:gap-2 min-w-0">
            
              
              <a
                href="/posts"
                class="text-muted-foreground hover:text-primary hover:bg-primary/10 flex items-center gap-0.5 md:gap-1 rounded-lg px-1 md:px-3 py-0.5 md:py-1.5 transition-all duration-200 ease-out hover:-translate-y-0.5 hover:scale-[1.02] flex-shrink-0">
                
                  
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 20H5a2 2 0 01-2-2V6a2 2 0 012-2h10a2 2 0 012 2v1m2 13a2 2 0 01-2-2V7m2 13a2 2 0 002-2V9a2 2 0 00-2-2h-2m-4-3H9M7 16h6M7 8h6v4H7V8z" />

</svg>
                  <span class="max-w-[3rem] md:max-w-none truncate">게시글</span>
                
              </a>
              <span class="text-muted-foreground/50 flex-shrink-0"
                >
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
</svg></span
              >
            
            
            <span class="text-foreground flex items-center gap-0.5 md:gap-1 font-medium min-w-0">
              
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
</svg>
              <span class="max-w-[8rem] md:max-w-[16rem] lg:max-w-none truncate">Native Sparse Attention: Hardware-Aligned and Natively Trainable Sparse Attention</span>
            </span>
          </div>
        
      </li>
    

  </ol>
</nav>



  


  
  <header class="mb-8">
    


<div class="post-meta">
  
  <h1 class="text-foreground mb-6 text-3xl leading-tight font-bold md:text-4xl">
    Native Sparse Attention: Hardware-Aligned and Natively Trainable Sparse Attention
  </h1>

  
  


  
  <div class="bg-card border-border flex flex-col gap-4 rounded-xl border p-6">
    
    <div
      class="text-muted-foreground flex flex-wrap items-center gap-4 text-sm">
      
      <div class="flex items-center gap-2">
        
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="작성일"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
</svg>
        <time datetime="2025-07-07">
          2025년 07월 07일
        </time>
      </div>

      
      


      
      
        <div class="flex items-center gap-2">
          
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="읽는 시간"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
</svg>
          <span
            >31 분</span
          >
        </div>
      


      
      
        <div class="flex items-center gap-2">
          
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="단어 수"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h7" />
</svg>
          <span>15065 단어</span>
        </div>
      

    </div>

    
    
      <div class="flex flex-wrap items-center gap-4">
        
        
          <div class="flex items-center gap-2">
            
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="카테고리"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z" />
</svg>
            <span class="text-muted-foreground mr-2 text-sm"
              >카테고리:</span
            >
            <div class="flex flex-wrap gap-2">
              
                <a
                  href="/categories/paper-review/"
                  class="bg-primary/10 text-primary hover:bg-primary/20 focus:ring-primary/20 inline-flex items-center rounded-full px-3 py-1 text-sm font-medium transition-all duration-200 ease-out hover:-translate-y-0.5 hover:scale-105 hover:shadow-md focus:ring-2 focus:outline-none">
                  paper-review
                </a>
              
                <a
                  href="/categories/with-gpt/"
                  class="bg-primary/10 text-primary hover:bg-primary/20 focus:ring-primary/20 inline-flex items-center rounded-full px-3 py-1 text-sm font-medium transition-all duration-200 ease-out hover:-translate-y-0.5 hover:scale-105 hover:shadow-md focus:ring-2 focus:outline-none">
                  with-gpt
                </a>
              
            </div>
          </div>
        


        
        
          <div class="flex items-center gap-2">
            
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="태그">
	<g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2">
		<path d="M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z" />
		<circle cx="7.5" cy="7.5" r=".5" fill="currentColor" />
	</g>
</svg>
            <span class="text-muted-foreground mr-2 text-sm"
              >태그:</span
            >
            <div class="flex flex-wrap gap-2">
              
                <a
                  href="/tags/2502.11089v2/"
                  class="bg-muted/50 text-muted-foreground hover:bg-primary/10 hover:text-primary focus:ring-primary/20 inline-flex items-center rounded px-2 py-1 text-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:scale-105 focus:ring-2 focus:outline-none">
                  #2502.11089v2
                </a>
              
                <a
                  href="/tags/Sparse-Attention/"
                  class="bg-muted/50 text-muted-foreground hover:bg-primary/10 hover:text-primary focus:ring-primary/20 inline-flex items-center rounded px-2 py-1 text-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:scale-105 focus:ring-2 focus:outline-none">
                  #Sparse Attention
                </a>
              
                <a
                  href="/tags/Long-Context/"
                  class="bg-muted/50 text-muted-foreground hover:bg-primary/10 hover:text-primary focus:ring-primary/20 inline-flex items-center rounded px-2 py-1 text-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:scale-105 focus:ring-2 focus:outline-none">
                  #Long Context
                </a>
              
                <a
                  href="/tags/Transformer-Optimization/"
                  class="bg-muted/50 text-muted-foreground hover:bg-primary/10 hover:text-primary focus:ring-primary/20 inline-flex items-center rounded px-2 py-1 text-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:scale-105 focus:ring-2 focus:outline-none">
                  #Transformer Optimization
                </a>
              
                <a
                  href="/tags/Efficient-LLM/"
                  class="bg-muted/50 text-muted-foreground hover:bg-primary/10 hover:text-primary focus:ring-primary/20 inline-flex items-center rounded px-2 py-1 text-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:scale-105 focus:ring-2 focus:outline-none">
                  #Efficient LLM
                </a>
              
                <a
                  href="/tags/GPU-Acceleration/"
                  class="bg-muted/50 text-muted-foreground hover:bg-primary/10 hover:text-primary focus:ring-primary/20 inline-flex items-center rounded px-2 py-1 text-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:scale-105 focus:ring-2 focus:outline-none">
                  #GPU Acceleration
                </a>
              
                <a
                  href="/tags/FlashAttention/"
                  class="bg-muted/50 text-muted-foreground hover:bg-primary/10 hover:text-primary focus:ring-primary/20 inline-flex items-center rounded px-2 py-1 text-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:scale-105 focus:ring-2 focus:outline-none">
                  #FlashAttention
                </a>
              
                <a
                  href="/tags/Memory-Efficiency/"
                  class="bg-muted/50 text-muted-foreground hover:bg-primary/10 hover:text-primary focus:ring-primary/20 inline-flex items-center rounded px-2 py-1 text-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:scale-105 focus:ring-2 focus:outline-none">
                  #Memory Efficiency
                </a>
              
                <a
                  href="/tags/Inference-Speedup/"
                  class="bg-muted/50 text-muted-foreground hover:bg-primary/10 hover:text-primary focus:ring-primary/20 inline-flex items-center rounded px-2 py-1 text-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:scale-105 focus:ring-2 focus:outline-none">
                  #Inference Speedup
                </a>
              
                <a
                  href="/tags/Trainable-Sparsity/"
                  class="bg-muted/50 text-muted-foreground hover:bg-primary/10 hover:text-primary focus:ring-primary/20 inline-flex items-center rounded px-2 py-1 text-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:scale-105 focus:ring-2 focus:outline-none">
                  #Trainable Sparsity
                </a>
              
                <a
                  href="/tags/Triton-Kernel/"
                  class="bg-muted/50 text-muted-foreground hover:bg-primary/10 hover:text-primary focus:ring-primary/20 inline-flex items-center rounded px-2 py-1 text-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:scale-105 focus:ring-2 focus:outline-none">
                  #Triton Kernel
                </a>
              
                <a
                  href="/tags/Deep-Learning/"
                  class="bg-muted/50 text-muted-foreground hover:bg-primary/10 hover:text-primary focus:ring-primary/20 inline-flex items-center rounded px-2 py-1 text-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:scale-105 focus:ring-2 focus:outline-none">
                  #Deep Learning
                </a>
              
                <a
                  href="/tags/Language-Models/"
                  class="bg-muted/50 text-muted-foreground hover:bg-primary/10 hover:text-primary focus:ring-primary/20 inline-flex items-center rounded px-2 py-1 text-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:scale-105 focus:ring-2 focus:outline-none">
                  #Language Models
                </a>
              
                <a
                  href="/tags/DeepSeek/"
                  class="bg-muted/50 text-muted-foreground hover:bg-primary/10 hover:text-primary focus:ring-primary/20 inline-flex items-center rounded px-2 py-1 text-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:scale-105 focus:ring-2 focus:outline-none">
                  #DeepSeek
                </a>
              
            </div>
          </div>
        

      </div>
    


    
    

  </div>
</div>

  </header>

  
  <article class="prose prose-neutral dark:prose-invert mb-12 max-w-none">
    <p><a href="https://arxiv.org/abs/2502.11089v2">논문 링크</a></p>
<h1 id="native-sparse-attention-nsa--64-k-토큰도-11-빠르게-정확도는-그대로">Native Sparse Attention (NSA) — 64 k 토큰도 11× 빠르게, 정확도는 그대로</h1>
<h2 id="한-줄-요약-tldr">한 줄 요약 (TL;DR)</h2>
<p><strong>NSA는 ‘압축 → 선택 → 슬라이딩’ 3 분기 희소 어텐션과 GQA/MQA-친화 커널을 결합해 64 k 컨텍스트에서 디코딩 속도를 11.6 배, 학습 속도를 최대 9 배 높이면서도 Full-Attention보다 평균 성능을 향상시킨다.</strong></p>
<hr>
<h2 id="핵심-아이디어">핵심 아이디어</h2>
<ol>
<li><strong>블록-연속 Top-<em>n</em> 선택</strong>으로 희소 패턴을 만들되, 모든 KV가 메모리상 연속이도록 강제해 GPU Tensor Core를 100 % 활용한다.</li>
<li><strong>Compression + Selection + Sliding Window</strong>의 3-분기 설계로 전역·국소 정보를 동적으로 믹스한다.</li>
<li>선택 과정 전체를 <strong>미분 가능</strong>하게 유지해 사전학습·미세조정·RLHF까지 동일 커널을 사용한다.</li>
</ol>
<hr>
<h2 id="배경-그들이-해결한-문제">배경: 그들이 해결한 문제</h2>
<p><em>현장의 딜레마</em></p>
<ul>
<li>
<p><strong>긴 문맥(≥ 32 k)</strong> 에서 Full Attention은 $O(L^{2})$ 복잡도로 <strong>속도·메모리 병목</strong>을 만든다.</p>
</li>
<li>
<p>기존 희소 어텐션은 FLOPs는 줄였지만</p>
<ul>
<li>실제 속도 이득이 작거나</li>
<li>인퍼런스 전용(학습 불가)이고</li>
<li>GQA/MQA 구조와 충돌해 <strong>메모리 대역폭</strong>을 오히려 키웠다.</li>
</ul>
</li>
</ul>
<hr>
<h2 id="새로운-접근법-natively-sparse-attention-nsa">새로운 접근법: <em>Natively Sparse Attention</em> (NSA)</h2>
<table>
  <thead>
      <tr>
          <th>핵심 구성</th>
          <th>설명</th>
          <th></th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>계층적 희소성</strong></td>
          <td>Compression (l = 32) → Selection (top-16 블록, l′ = 64) → Sliding (w = 512)</td>
          <td></td>
      </tr>
      <tr>
          <td><strong>블록 Top-<em>n</em> 공식</strong></td>
          <td>(\displaystyle I_t={,i;</td>
          <td>;\mathrm{rank}(p^{\prime}_{t}[i])\le n}) — 선택된 블록은 연속 메모리 유지</td>
      </tr>
      <tr>
          <td><strong>GQA/MQA-정렬 Triton 커널</strong></td>
          <td>16 헤드가 KV를 공유, 그룹 단위로 연속 블록을 불러와 Tensor Core에 바로 투입</td>
          <td></td>
      </tr>
      <tr>
          <td><strong>RoPE + Intra-block PosEnc</strong></td>
          <td>백본은 Llama-계열(30 layer, 64 head), RoPE를 유지하고 압축 분기 내부에는 블록 상대 위치 인코딩 추가</td>
          <td></td>
      </tr>
  </tbody>
</table>
<hr>
<h2 id="작동-원리-구체적인-예시로-살펴보기">작동 원리: 구체적인 예시로 살펴보기</h2>

  <blockquote
    class="border-primary bg-muted/30 hover:bg-muted/40 my-6 rounded-r-lg border-l-4 py-4 pr-4 pl-6 italic transition-all duration-200 ease-out hover:translate-x-1">
    <div class="prose prose-sm max-w-none">
      <p>길이 9 토큰, 블록 3, 창 2로 축소한 <em>toy</em> 예시</p>
    </div>
  </blockquote>

<table>
  <thead>
      <tr>
          <th>단계</th>
          <th>입력의 변화</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>① Compression</strong></td>
          <td><code>[a b c]</code>, <code>[d e f]</code>, <code>[g h i]</code> 세 블록의 평균 키·값 생성</td>
      </tr>
      <tr>
          <td><strong>② Scoring</strong></td>
          <td>쿼리 <code>q_i</code> ↔ 압축 KV 점곱 → 블록 중요도 $p_\text{cmp}$</td>
      </tr>
      <tr>
          <td><strong>③ Score Propagation</strong></td>
          <td>블록 점수를 토큰 단위로 전파해 $p_\text{slc}$ 계산</td>
      </tr>
      <tr>
          <td><strong>④ Top-2 선택</strong></td>
          <td>$p_\text{slc}$ 상위 2 블록(<code>d–i</code>)만 유지 ⇒ <strong>연속 KV</strong></td>
      </tr>
      <tr>
          <td><strong>⑤ Sliding Window</strong></td>
          <td>직전 2 토큰(<code>g h</code>)을 추가로 확보</td>
      </tr>
      <tr>
          <td><strong>⑥ 3-분기 어텐션</strong></td>
          <td><code>cmp</code> · <code>slc</code> · <code>win</code> 각각 FlashAttention-2로 계산 후 게이트로 가중합</td>
      </tr>
      <tr>
          <td><strong>⑦ GQA 커널</strong></td>
          <td>16 헤드×4 그룹이 공유 KV를 연속 로드 → Tensor Core 처리</td>
      </tr>
  </tbody>
</table>
<p>덕분에 희소성·미분 가능성·하드웨어 최적화가 ‘한 몸’으로 묶인다.</p>
<hr>
<h2 id="성능-검증-주요-결과">성능 검증: 주요 결과</h2>
<h3 id="1-64-k-토큰-실측-속도--메모리">1. 64 k 토큰 실측 속도 · 메모리</h3>
<table>
  <thead>
      <tr>
          <th>지표</th>
          <th>Full Attn</th>
          <th><strong>NSA</strong></th>
          <th>배속</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>Forward latency</td>
          <td>900 ms</td>
          <td><strong>100 ms</strong></td>
          <td><strong>9.0×</strong></td>
      </tr>
      <tr>
          <td>Backward latency</td>
          <td>2 500 ms</td>
          <td><strong>420 ms</strong></td>
          <td><strong>6.0×</strong></td>
      </tr>
      <tr>
          <td>Decode latency/step</td>
          <td>560 ms</td>
          <td><strong>48 ms</strong></td>
          <td><strong>11.6×</strong></td>
      </tr>
      <tr>
          <td>KV 로드량(tok-eq.)</td>
          <td>65 536</td>
          <td><strong>5 632</strong></td>
          <td><strong>11.6×↓</strong></td>
      </tr>
  </tbody>
</table>
<h3 id="2-품질-지표">2. 품질 지표</h3>
<table>
  <thead>
      <tr>
          <th>벤치마크</th>
          <th>Full</th>
          <th><strong>NSA</strong></th>
          <th>Δ</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>LongBench 평균</td>
          <td>0.437</td>
          <td><strong>0.469</strong></td>
          <td>+0.032</td>
      </tr>
      <tr>
          <td>Needle-in-Haystack 64 k</td>
          <td>0.00</td>
          <td><strong>1.00</strong></td>
          <td>+1.00</td>
      </tr>
      <tr>
          <td>AIME-24 (8 k / 16 k)</td>
          <td>0.046 / 0.092</td>
          <td><strong>0.121 / 0.146</strong></td>
          <td>+0.075 / +0.054</td>
      </tr>
      <tr>
          <td>9종 일반 벤치 평균</td>
          <td>0.443</td>
          <td><strong>0.456</strong></td>
          <td>+0.013</td>
      </tr>
  </tbody>
</table>
<h3 id="3-베이스라인-비교-64-k">3. 베이스라인 비교 (64 k)</h3>
<table>
  <thead>
      <tr>
          <th>모델</th>
          <th>속도(×)</th>
          <th>LongBench Δ</th>
          <th>특이점</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>Quest</td>
          <td>7.1</td>
          <td>−0.006</td>
          <td>Decode 전용, GQA 미호환</td>
      </tr>
      <tr>
          <td>H2O</td>
          <td>4.3</td>
          <td>−0.012</td>
          <td>KV eviction, 추론 전용</td>
      </tr>
      <tr>
          <td>RetNet</td>
          <td>0.9</td>
          <td>+0.011</td>
          <td>선형 Recurrence, 속도↓</td>
      </tr>
      <tr>
          <td><strong>NSA</strong></td>
          <td><strong>11.6</strong></td>
          <td><strong>+0.032</strong></td>
          <td>3-단계 모두 가속, 정확도↑</td>
      </tr>
  </tbody>
</table>
<hr>
<h2 id="우리의-관점-강점-한계-그리고-이-연구가-중요한-이유">우리의 관점: 강점, 한계, 그리고 이 연구가 중요한 이유</h2>
<h3 id="강점">강점</h3>
<ol>
<li><strong>속도·메모리·정확도 3 마리 토끼</strong> — 희소 어텐션의 고질적 딜레마를 해소.</li>
<li><strong>엔드-투-엔드 학습 가능</strong> — 별도 인덱싱·보조 loss 없이 사전학습부터 RLHF까지 동일 연산.</li>
<li><strong>GQA/MQA 완전 호환</strong> — 최신 공유-KV 구조에서 실제 대역폭도 절감.</li>
</ol>
<h3 id="한계">한계</h3>
<ul>
<li><strong>짧은 컨텍스트(≤ 2 k)</strong> 에선 희소 준비 오버헤드로 이득이 작다.</li>
<li><strong>코딩·수학 문제</strong>처럼 세밀 정보가 중요한 태스크에선 Dense 모델 대비 개선폭이 미미.</li>
<li>Triton + CUDA Tensor Core에 강하게 묶여 있어 <strong>TPU·모바일 NPU</strong> 이식이 쉽지 않다.</li>
</ul>
<h3 id="왜-중요한가">왜 중요한가?</h3>

  <blockquote
    class="border-primary bg-muted/30 hover:bg-muted/40 my-6 rounded-r-lg border-l-4 py-4 pr-4 pl-6 italic transition-all duration-200 ease-out hover:translate-x-1">
    <div class="prose prose-sm max-w-none">
      <p>LLM 서비스가 “64 k+ 컨텍스트”를 일상적으로 요구하는 시대, <strong>NSA는 동일 GPU 예산으로 더 긴 문맥·더 많은 동시 세션을 가능하게 하는 실질적 해법</strong>을 제시한다. 이론적 FLOPs 절감이 아닌 <strong>실측 지연 시간</strong>으로 증명했다는 점이 산업계에 즉시 가치를 준다.</p>
    </div>
  </blockquote>

<hr>
<h2 id="다음-단계는-앞으로의-길">다음 단계는?: 앞으로의 길</h2>
<ol>
<li><strong>동적 블록 크기 · 창 크기 자동 튜닝</strong> — 태스크·길이별로 압축률을 학습적으로 조절.</li>
<li><strong>커널 이식성 확대</strong> — Triton 코드를 OpenCL/Metal·TPU-XLA 백엔드로 재작성.</li>
<li><strong>Retrieval-aided NSA</strong> — 절감된 FLOPs/메모리를 외부 지식 검색과 결합해 장문 QA 성능 극대화.</li>
<li><strong>Suffix-heavy 최적화</strong> — 긴 접미부 디코딩에서 Sliding Window 분기의 비용을 추가로 줄이는 H2O-style evict 통합.</li>
<li><strong>멀티모달 확장</strong> — 영상·음성처럼 길지만 정보 밀도가 낮은 시퀀스에 NSA 패턴을 적용해 연산 효율을 극대화.</li>
</ol>
<hr>
<p>NSA는 “<strong>하드웨어-정렬 희소성</strong>”이라는 간단하면서도 강력한 아이디어로 장문 LLM의 병목을 뚫었다. 완전한 해결책은 아니지만, <strong>‘속도도, 정확도도 포기하지 않는’</strong> 희소 어텐션의 실제 가능성을 처음으로 입증했다는 점에서 한 세대 앞선 레퍼런스로 기억될 것이다.</p>
<hr>
<h3 id="토글을-클릭하면-논문에-대한-자세한-llm-질의응답-내용을-확인할-수-있습니다">토글을 클릭하면 논문에 대한 자세한 LLM 질의응답 내용을 확인할 수 있습니다.</h3>
<details markdown="block">
<summary>▶️<strong>클릭하여 펼치기</strong></summary>
<h1 id="프롬프트-111-연구의-공백">프롬프트 1.1.1 (연구의 공백)</h1>
<div
  class="code-block-container border-border bg-card my-6 overflow-hidden rounded-xl border shadow-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:shadow-md">
  
  <div
    class="code-block-header bg-muted/30 border-border flex items-center justify-between border-b px-4 py-3">
    
    <div class="flex items-center gap-2">
      <div class="text-muted-foreground flex-shrink-0">
        
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4" />
</svg>
      </div>
      <span class="text-muted-foreground text-sm font-medium">
        PLAINTEXT
      </span>
    </div>

    
    <div class="flex items-center gap-2">
      <button
          class="collapse-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none"
          data-code-id="code-0"
          data-default-state="expanded"
          data-collapsed="false"
          data-auto-collapse-lines="30"
          data-auto-collapse-height="400"
          data-collapsed-height="120"
          title="접기"
          aria-label="접기">
          <span class="collapse-icon">
            
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z"/></svg>
          </span>
          <span class="collapse-text hidden sm:inline"
            >접기</span
          >
        </button>
      <button
        class="copy-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none"
        data-code-id="code-0"
        title="복사"
        aria-label="복사">
        <span class="copy-icon">
          
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
</svg>
        </span>
        <span class="copy-text hidden sm:inline"
          >복사</span
        >
      </button>
    </div>
  </div>

  
  <div class="code-block-content relative" id="code-0">
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">&#34;논문의 &#39;Introduction&#39;과 &#39;Related Work&#39; 섹션을 분석하여, 이 연구가 명시적으로 해결하고자 하는 핵심적인 연구 공백(research gap), 기존 연구의 결정적 한계, 또는 미해결 질문이 무엇인지 설명해 줘. 저자들이 설명하는, 이 논문 출판 시점의 &#39;최신 기술(state of the art)&#39;은 어떤 상태였는지 요약해 줘.&#34;</span></span></code></pre></div>
    
    <div
      class="collapse-overlay to-card/90 pointer-events-none absolute inset-0 bg-gradient-to-b from-transparent via-transparent opacity-0 transition-opacity duration-300">
      <div
        class="text-muted-foreground bg-card/80 border-border/50 hover:bg-primary/10 hover:text-primary hover:border-primary/30 absolute bottom-4 left-1/2 -translate-x-1/2 cursor-pointer rounded-full border px-3 py-1.5 text-xs backdrop-blur-sm transition-all duration-200">
        클릭하여 더 보기
      </div>
    </div>
  </div>
</div>


<script>
(function() {
  const codeId = 'code-0';
  const copyBtn = document.querySelector('.copy-code-btn[data-code-id="' + codeId + '"]');
  const collapseBtn = document.querySelector('.collapse-code-btn[data-code-id="' + codeId + '"]');
  const codeContainer = document.getElementById(codeId);

  if (!codeContainer) return;

  
  if (copyBtn) {
    const copyIcon = copyBtn.querySelector('.copy-icon');
    const copyText = copyBtn.querySelector('.copy-text');

    copyBtn.addEventListener('click', async function() {
      try {
        
        let codeText = '';

        
        const codeTableCell = codeContainer.querySelector('.lntd:last-child code');
        if (codeTableCell) {
          codeText = codeTableCell.textContent || codeTableCell.innerText;
        } else {
          
          const codeElement = codeContainer.querySelector('code');
          if (codeElement) {
            
            const hasInlineLineNumbers = codeElement.querySelector('.ln');
            if (hasInlineLineNumbers) {
              
              const codeLines = codeElement.querySelectorAll('.cl');
              if (codeLines.length > 0) {
                codeText = Array.from(codeLines)
                  .map(line => {
                    const text = line.textContent || line.innerText;
                    
                    return text.replace(/\n+$/, '');
                  })
                  .join('\n')
                  .replace(/\n+$/, ''); 
              } else {
                
                const allText = codeElement.textContent || codeElement.innerText;
                codeText = allText.replace(/^\d+/gm, '').replace(/^\s+/gm, '');
              }
            } else {
              
              codeText = codeElement.textContent || codeElement.innerText;
            }
          } else {
            
            codeText = codeContainer.textContent || codeContainer.innerText;
          }
        }

        
        codeText = codeText.trim();

        
        await navigator.clipboard.writeText(codeText);

        
        copyIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M5 13l4 4L19 7\u0022 \/\u003e\n\u003c\/svg\u003e`;
        if (copyText) {
          copyText.textContent = '복사됨';
        }
        copyBtn.classList.add('text-green-600');

        
        setTimeout(() => {
          copyIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z\u0022 \/\u003e\n\u003c\/svg\u003e`;
          if (copyText) {
            copyText.textContent = '복사';
          }
          copyBtn.classList.remove('text-green-600');
        }, 2000);

      } catch (err) {
        console.error('复制失败:', err);

        
        const range = document.createRange();
        const codeElement = codeContainer.querySelector('code') || codeContainer;
        range.selectNodeContents(codeElement);
        const selection = window.getSelection();
        selection.removeAllRanges();
        selection.addRange(range);

        
        if (copyText) {
          copyText.textContent = '선택됨';
        }

        setTimeout(() => {
          if (copyText) {
            copyText.textContent = '복사';
          }
          selection.removeAllRanges();
        }, 2000);
      }
    });
  }

  
  if (collapseBtn) {
    const collapseIcon = collapseBtn.querySelector('.collapse-icon');
    const collapseText = collapseBtn.querySelector('.collapse-text');
    const collapseOverlay = codeContainer.querySelector('.collapse-overlay');

    
    let codeElement = codeContainer.querySelector('pre.chroma');
    if (!codeElement) {
      codeElement = codeContainer.querySelector('pre');
    }

    const defaultState = collapseBtn.dataset.defaultState || 'expanded';
    const isCollapsedAttr = collapseBtn.dataset.collapsed === 'true';
    const autoCollapseLines = parseInt(collapseBtn.dataset.autoCollapseLines) || 30;
    const autoCollapseHeight = parseInt(collapseBtn.dataset.autoCollapseHeight) || 400;
    const collapsedHeight = parseInt(collapseBtn.dataset.collapsedHeight) || 120;

    let isCollapsed = false;

    
    function initCollapse() {
      
      const shouldCollapse = isCollapsedAttr ||
                           defaultState === 'collapsed' ||
                           shouldAutoCollapse();

      if (shouldCollapse) {
        setCollapsed(true, false); 
      }
    }

    function shouldAutoCollapse() {
      
      if (codeElement) {
        const lines = codeElement.querySelectorAll('.line, .cl');
        const height = codeElement.offsetHeight;
        return lines.length > autoCollapseLines || height > autoCollapseHeight;
      }

      
      const containerHeight = codeContainer.offsetHeight;
      if (containerHeight > autoCollapseHeight) {
        return true;
      }

      
      const textContent = codeContainer.textContent || codeContainer.innerText || '';
      const estimatedLines = textContent.split('\n').length;
      return estimatedLines > autoCollapseLines;
    }

    function setCollapsed(collapsed, animate = true) {
      if (!collapseOverlay) return;

      isCollapsed = collapsed;

      if (collapsed) {
        
        codeContainer.style.maxHeight = collapsedHeight + 'px';
        codeContainer.style.overflow = 'hidden';
        collapseOverlay.style.opacity = '1';
        collapseOverlay.style.pointerEvents = 'auto';

        
        collapseIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M19 9l-7 7-7-7\u0022 \/\u003e\n\u003c\/svg\u003e`;
        if (collapseText) {
          collapseText.textContent = '펼치기';
        }
        collapseBtn.title = '펼치기';

      } else {
        
        codeContainer.style.maxHeight = '';
        codeContainer.style.overflow = '';
        collapseOverlay.style.opacity = '0';
        collapseOverlay.style.pointerEvents = 'none';

        
        collapseIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath fill=\u0022currentColor\u0022 d=\u0022M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z\u0022\/\u003e\u003c\/svg\u003e`;
        if (collapseText) {
          collapseText.textContent = '접기';
        }
        collapseBtn.title = '접기';
      }

      
      if (animate) {
        codeContainer.style.transition = 'max-height 0.3s ease-out';
        setTimeout(() => {
          codeContainer.style.transition = '';
        }, 300);
      }
    }

    function toggleCollapse() {
      setCollapsed(!isCollapsed, true);
    }

    
    collapseBtn.addEventListener('click', toggleCollapse);

    
    if (collapseOverlay) {
      collapseOverlay.addEventListener('click', () => {
        if (isCollapsed) {
          setCollapsed(false, true);
        }
      });
    }

    
    initCollapse();
  }
})();
</script>
<h3 id="한눈에-보는-결론--왜-nsa가-필요한가">한눈에 보는 결론 — 왜 <strong>NSA</strong>가 필요한가?</h3>
<ul>
<li><strong>연산 병목</strong>: 64 k 토큰 디코딩에서 <strong>주의력(Attention)</strong> 계산만으로 총 지연의 **70 – 80 %**를 차지한다는 분석이 제시됨.</li>
<li><strong>이론-현실 괴리</strong>: 기존 희소(attention) 기법들은 연산량은 줄였지만 <strong>실제 속도 향상</strong>은 이론 대비 현저히 낮았다.</li>
<li><strong>훈련 부재</strong>: 대부분 <strong>추론(inference) 전용</strong>이라 사전학습 경로와 불일치·성능 저하를 초래하고, 긴 문장 학습 비용을 줄이지 못한다.</li>
<li><strong>HW 비호환</strong>: GQA·MQA 같은 최신 구조에서 <strong>메모리 접근량</strong>을 오히려 늘려 GPU 대역폭 병목을 유발한다.</li>
</ul>
<hr>
<h2 id="1-연구-공백-research-gap">1. 연구 공백 (Research Gap)</h2>
<table>
  <thead>
      <tr>
          <th>구분</th>
          <th>기존 접근</th>
          <th>결정적 한계</th>
          <th>남은 질문</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>연산 효율</strong></td>
          <td>KV-cache 제거·블록 선택·해싱 등 다양한 희소화 전략</td>
          <td>이론적 계산량 ↘ vs. 실제 지연 ↘ 미미 (prefill·decode 단계별 최적화 부재)</td>
          <td>하드웨어 대역폭·스케줄 제약을 고려해 <strong>전 단계</strong>에서 실측 속도를 높이려면?</td>
      </tr>
      <tr>
          <td><strong>아키텍처 호환</strong></td>
          <td>Head별 독립 선택(Quest 등)</td>
          <td>GQA/MQA에서 선택 영역 합집합이 커져 <strong>메모리 이동량</strong> 증가</td>
          <td>최신 공유-KV 구조와 <strong>모순 없이</strong> 희소화를 적용할 방법은?</td>
      </tr>
      <tr>
          <td><strong>학습 가능 희소성</strong></td>
          <td>사전학습 후 <em>post-hoc</em> 희소, 혹은 비연속 선택 연산</td>
          <td>비미분(Discrete) 요소·비연속 메모리 접근 → 역전파·FlashAttention 최적화 불가</td>
          <td><strong>엔드투엔드 학습</strong> 가능한 연산자로 장-문맥 모델을 효율적으로 사전학습할 수 있을까?</td>
      </tr>
      <tr>
          <td><strong>속도 편중</strong></td>
          <td>Prefill 전용(MInference)·Decode 전용(H2O) 등 <strong>단계 특화</strong></td>
          <td>최소 한 단계는 여전히 Full Attention 수준 비용 → 전체 파이프라인 가속 실패</td>
          <td><strong>Prefill·Decode·Backward</strong> 모두 가속하는 균형 잡힌 설계가 가능한가?</td>
      </tr>
  </tbody>
</table>
<hr>
<h2 id="2-최신-기술state-of-the-art-요약">2. 최신 기술(State of the Art) 요약</h2>
<ol>
<li>
<p><strong>롱 컨텍스트 LLM</strong></p>
<ul>
<li>OpenAI <em>o-series</em>, DeepSeek-R1, Gemini 1.5 Pro 등은 최대 <strong>100 k</strong> 이상의 토큰을 다루지만, 핵심 연산은 여전히 <strong>Full Attention</strong> 기반이라 길이 제곱(𝑂(L²)) 복잡도를 안고 있음.</li>
</ul>
</li>
<li>
<p><strong>희소 Attention 계열</strong></p>
<table>
  <thead>
      <tr>
          <th>전략</th>
          <th>대표 예</th>
          <th>특징</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>KV-Cache Eviction</td>
          <td>H2O, SnapKV</td>
          <td>디코딩 단계에서 “덜 중요한” 토큰 제거</td>
      </tr>
      <tr>
          <td>블록-단위 선택</td>
          <td>Quest, SeerAttention</td>
          <td>쿼리·키 유사도 기반 top-n 블록 유지</td>
      </tr>
      <tr>
          <td>샘플링·해싱·클러스터링</td>
          <td>HashAttention, ClusterKV</td>
          <td>토큰 서브셋 생성으로 연산량 감소</td>
      </tr>
      <tr>
          <td>고정 패턴</td>
          <td>Longformer, SlidingWindow</td>
          <td>슬라이딩 창·글로벌 토큰 미리 지정</td>
      </tr>
  </tbody>
</table>
<p>그러나 이들 대부분은 <strong>하나 이상의</strong> 다음 문제를 공유한다.</p>
<ul>
<li><strong>단계 한정</strong> 가속(phase-restricted)</li>
<li>GQA/MQA 비호환으로 인한 <strong>메모리 병목</strong></li>
<li><strong>비미분/비블록</strong> 선택으로 학습·FlashAttention 최적화 미지원</li>
</ul>
</li>
<li>
<p><strong>하드웨어 인지형 최적화</strong>
FlashAttention-2 등은 연산 강도(arithmetic intensity)를 높여 GPU Tensor Core를 활용하지만, <strong>희소 패턴</strong>과 결합할 때는 블록 불연속성 때문에 성능을 잃는다.</p>
</li>
</ol>
<hr>
<h2 id="3-정리">3. 정리</h2>
<ul>
<li>
<p><strong>핵심 공백</strong>: <em>“하드웨어 친화적이고, 학습 단계까지 아우르며, 현대 LLM 아키텍처와 충돌하지 않는 희소 Attention”</em></p>
</li>
<li>
<p><strong>미해결 질문</strong>:</p>
<ol>
<li>블록-연속 메모리 접근을 유지하면서도 토큰 선택의 <strong>동적 적응성</strong>을 확보할 수 있는가?</li>
<li>Prefill·Decode·Backprop <strong>전 구간</strong>에서 실측 속도를 10× 이상 끌어올릴 수 있는가?</li>
</ol>
</li>
<li>
<p><strong>NSA의 제안 방향</strong>: 계층적(압축 + 선택 + 슬라이딩) 희소 설계와 <strong>Tensor Core 균형</strong> 커널로 위 공백을 해소한다고 주장. 이로써 64 k 문맥에서 디코딩 <strong>11.6×</strong>, 학습 <strong>최대 9×</strong> 가속을 달성했다고 보고한다.</p>
</li>
</ul>
<h1 id="프롬프트-112-핵심-가설">프롬프트 1.1.2 (핵심 가설)</h1>
<div
  class="code-block-container border-border bg-card my-6 overflow-hidden rounded-xl border shadow-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:shadow-md">
  
  <div
    class="code-block-header bg-muted/30 border-border flex items-center justify-between border-b px-4 py-3">
    
    <div class="flex items-center gap-2">
      <div class="text-muted-foreground flex-shrink-0">
        
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4" />
</svg>
      </div>
      <span class="text-muted-foreground text-sm font-medium">
        PLAINTEXT
      </span>
    </div>

    
    <div class="flex items-center gap-2">
      <button
          class="collapse-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none"
          data-code-id="code-1"
          data-default-state="expanded"
          data-collapsed="false"
          data-auto-collapse-lines="30"
          data-auto-collapse-height="400"
          data-collapsed-height="120"
          title="접기"
          aria-label="접기">
          <span class="collapse-icon">
            
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z"/></svg>
          </span>
          <span class="collapse-text hidden sm:inline"
            >접기</span
          >
        </button>
      <button
        class="copy-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none"
        data-code-id="code-1"
        title="복사"
        aria-label="복사">
        <span class="copy-icon">
          
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
</svg>
        </span>
        <span class="copy-text hidden sm:inline"
          >복사</span
        >
      </button>
    </div>
  </div>

  
  <div class="code-block-content relative" id="code-1">
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">&#34;이 논문의 중심 가설(central hypothesis) 또는 핵심 주장은 무엇인가? &#39;저자들은 [제안 기법]을 사용함으로써 [기존 한계점]을 극복하는 [구체적 결과]를 달성할 수 있다고 가정한다&#39;와 같은 형식으로, 명확하고 간결한 한 문장으로 서술해 줘.&#34;</span></span></code></pre></div>
    
    <div
      class="collapse-overlay to-card/90 pointer-events-none absolute inset-0 bg-gradient-to-b from-transparent via-transparent opacity-0 transition-opacity duration-300">
      <div
        class="text-muted-foreground bg-card/80 border-border/50 hover:bg-primary/10 hover:text-primary hover:border-primary/30 absolute bottom-4 left-1/2 -translate-x-1/2 cursor-pointer rounded-full border px-3 py-1.5 text-xs backdrop-blur-sm transition-all duration-200">
        클릭하여 더 보기
      </div>
    </div>
  </div>
</div>


<script>
(function() {
  const codeId = 'code-1';
  const copyBtn = document.querySelector('.copy-code-btn[data-code-id="' + codeId + '"]');
  const collapseBtn = document.querySelector('.collapse-code-btn[data-code-id="' + codeId + '"]');
  const codeContainer = document.getElementById(codeId);

  if (!codeContainer) return;

  
  if (copyBtn) {
    const copyIcon = copyBtn.querySelector('.copy-icon');
    const copyText = copyBtn.querySelector('.copy-text');

    copyBtn.addEventListener('click', async function() {
      try {
        
        let codeText = '';

        
        const codeTableCell = codeContainer.querySelector('.lntd:last-child code');
        if (codeTableCell) {
          codeText = codeTableCell.textContent || codeTableCell.innerText;
        } else {
          
          const codeElement = codeContainer.querySelector('code');
          if (codeElement) {
            
            const hasInlineLineNumbers = codeElement.querySelector('.ln');
            if (hasInlineLineNumbers) {
              
              const codeLines = codeElement.querySelectorAll('.cl');
              if (codeLines.length > 0) {
                codeText = Array.from(codeLines)
                  .map(line => {
                    const text = line.textContent || line.innerText;
                    
                    return text.replace(/\n+$/, '');
                  })
                  .join('\n')
                  .replace(/\n+$/, ''); 
              } else {
                
                const allText = codeElement.textContent || codeElement.innerText;
                codeText = allText.replace(/^\d+/gm, '').replace(/^\s+/gm, '');
              }
            } else {
              
              codeText = codeElement.textContent || codeElement.innerText;
            }
          } else {
            
            codeText = codeContainer.textContent || codeContainer.innerText;
          }
        }

        
        codeText = codeText.trim();

        
        await navigator.clipboard.writeText(codeText);

        
        copyIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M5 13l4 4L19 7\u0022 \/\u003e\n\u003c\/svg\u003e`;
        if (copyText) {
          copyText.textContent = '복사됨';
        }
        copyBtn.classList.add('text-green-600');

        
        setTimeout(() => {
          copyIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z\u0022 \/\u003e\n\u003c\/svg\u003e`;
          if (copyText) {
            copyText.textContent = '복사';
          }
          copyBtn.classList.remove('text-green-600');
        }, 2000);

      } catch (err) {
        console.error('复制失败:', err);

        
        const range = document.createRange();
        const codeElement = codeContainer.querySelector('code') || codeContainer;
        range.selectNodeContents(codeElement);
        const selection = window.getSelection();
        selection.removeAllRanges();
        selection.addRange(range);

        
        if (copyText) {
          copyText.textContent = '선택됨';
        }

        setTimeout(() => {
          if (copyText) {
            copyText.textContent = '복사';
          }
          selection.removeAllRanges();
        }, 2000);
      }
    });
  }

  
  if (collapseBtn) {
    const collapseIcon = collapseBtn.querySelector('.collapse-icon');
    const collapseText = collapseBtn.querySelector('.collapse-text');
    const collapseOverlay = codeContainer.querySelector('.collapse-overlay');

    
    let codeElement = codeContainer.querySelector('pre.chroma');
    if (!codeElement) {
      codeElement = codeContainer.querySelector('pre');
    }

    const defaultState = collapseBtn.dataset.defaultState || 'expanded';
    const isCollapsedAttr = collapseBtn.dataset.collapsed === 'true';
    const autoCollapseLines = parseInt(collapseBtn.dataset.autoCollapseLines) || 30;
    const autoCollapseHeight = parseInt(collapseBtn.dataset.autoCollapseHeight) || 400;
    const collapsedHeight = parseInt(collapseBtn.dataset.collapsedHeight) || 120;

    let isCollapsed = false;

    
    function initCollapse() {
      
      const shouldCollapse = isCollapsedAttr ||
                           defaultState === 'collapsed' ||
                           shouldAutoCollapse();

      if (shouldCollapse) {
        setCollapsed(true, false); 
      }
    }

    function shouldAutoCollapse() {
      
      if (codeElement) {
        const lines = codeElement.querySelectorAll('.line, .cl');
        const height = codeElement.offsetHeight;
        return lines.length > autoCollapseLines || height > autoCollapseHeight;
      }

      
      const containerHeight = codeContainer.offsetHeight;
      if (containerHeight > autoCollapseHeight) {
        return true;
      }

      
      const textContent = codeContainer.textContent || codeContainer.innerText || '';
      const estimatedLines = textContent.split('\n').length;
      return estimatedLines > autoCollapseLines;
    }

    function setCollapsed(collapsed, animate = true) {
      if (!collapseOverlay) return;

      isCollapsed = collapsed;

      if (collapsed) {
        
        codeContainer.style.maxHeight = collapsedHeight + 'px';
        codeContainer.style.overflow = 'hidden';
        collapseOverlay.style.opacity = '1';
        collapseOverlay.style.pointerEvents = 'auto';

        
        collapseIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M19 9l-7 7-7-7\u0022 \/\u003e\n\u003c\/svg\u003e`;
        if (collapseText) {
          collapseText.textContent = '펼치기';
        }
        collapseBtn.title = '펼치기';

      } else {
        
        codeContainer.style.maxHeight = '';
        codeContainer.style.overflow = '';
        collapseOverlay.style.opacity = '0';
        collapseOverlay.style.pointerEvents = 'none';

        
        collapseIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath fill=\u0022currentColor\u0022 d=\u0022M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z\u0022\/\u003e\u003c\/svg\u003e`;
        if (collapseText) {
          collapseText.textContent = '접기';
        }
        collapseBtn.title = '접기';
      }

      
      if (animate) {
        codeContainer.style.transition = 'max-height 0.3s ease-out';
        setTimeout(() => {
          codeContainer.style.transition = '';
        }, 300);
      }
    }

    function toggleCollapse() {
      setCollapsed(!isCollapsed, true);
    }

    
    collapseBtn.addEventListener('click', toggleCollapse);

    
    if (collapseOverlay) {
      collapseOverlay.addEventListener('click', () => {
        if (isCollapsed) {
          setCollapsed(false, true);
        }
      });
    }

    
    initCollapse();
  }
})();
</script>
<p>저자들은 <strong>Natively Sparse Attention (NSA)</strong> 기법을 사용함으로써 Full Attention 기반 장문맥 모델의 연산·메모리 병목을 해소하고, 64 k 토큰에서 <strong>디코딩 11.6×·전방향 9.0×·역전파 6.0×</strong> 가속과 동시에 기존 모델과 동등하거나 더 우수한 정확도를 달성할 수 있다고 가정한다.</p>
<h1 id="프롬프트-121-독창성-식별">프롬프트 1.2.1 (독창성 식별)</h1>
<div
  class="code-block-container border-border bg-card my-6 overflow-hidden rounded-xl border shadow-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:shadow-md">
  
  <div
    class="code-block-header bg-muted/30 border-border flex items-center justify-between border-b px-4 py-3">
    
    <div class="flex items-center gap-2">
      <div class="text-muted-foreground flex-shrink-0">
        
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4" />
</svg>
      </div>
      <span class="text-muted-foreground text-sm font-medium">
        PLAINTEXT
      </span>
    </div>

    
    <div class="flex items-center gap-2">
      <button
          class="collapse-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none"
          data-code-id="code-2"
          data-default-state="expanded"
          data-collapsed="false"
          data-auto-collapse-lines="30"
          data-auto-collapse-height="400"
          data-collapsed-height="120"
          title="접기"
          aria-label="접기">
          <span class="collapse-icon">
            
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z"/></svg>
          </span>
          <span class="collapse-text hidden sm:inline"
            >접기</span
          >
        </button>
      <button
        class="copy-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none"
        data-code-id="code-2"
        title="복사"
        aria-label="복사">
        <span class="copy-icon">
          
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
</svg>
        </span>
        <span class="copy-text hidden sm:inline"
          >복사</span
        >
      </button>
    </div>
  </div>

  
  <div class="code-block-content relative" id="code-2">
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl"> &#34;논문 전체를 바탕으로, 가장 중요하고 독창적인 기여(contribution) 1~3가지를 구별되는 항목으로 나열해 줘. 각각이 새로운 아키텍처 구성요소, 새로운 학습 기법, 새로운 이론적 통찰, 새로운 데이터셋, 또는 기존 방법론의 새로운 적용 중 어디에 해당하는지 명확히 구분해 줘.&#34;</span></span></code></pre></div>
    
    <div
      class="collapse-overlay to-card/90 pointer-events-none absolute inset-0 bg-gradient-to-b from-transparent via-transparent opacity-0 transition-opacity duration-300">
      <div
        class="text-muted-foreground bg-card/80 border-border/50 hover:bg-primary/10 hover:text-primary hover:border-primary/30 absolute bottom-4 left-1/2 -translate-x-1/2 cursor-pointer rounded-full border px-3 py-1.5 text-xs backdrop-blur-sm transition-all duration-200">
        클릭하여 더 보기
      </div>
    </div>
  </div>
</div>


<script>
(function() {
  const codeId = 'code-2';
  const copyBtn = document.querySelector('.copy-code-btn[data-code-id="' + codeId + '"]');
  const collapseBtn = document.querySelector('.collapse-code-btn[data-code-id="' + codeId + '"]');
  const codeContainer = document.getElementById(codeId);

  if (!codeContainer) return;

  
  if (copyBtn) {
    const copyIcon = copyBtn.querySelector('.copy-icon');
    const copyText = copyBtn.querySelector('.copy-text');

    copyBtn.addEventListener('click', async function() {
      try {
        
        let codeText = '';

        
        const codeTableCell = codeContainer.querySelector('.lntd:last-child code');
        if (codeTableCell) {
          codeText = codeTableCell.textContent || codeTableCell.innerText;
        } else {
          
          const codeElement = codeContainer.querySelector('code');
          if (codeElement) {
            
            const hasInlineLineNumbers = codeElement.querySelector('.ln');
            if (hasInlineLineNumbers) {
              
              const codeLines = codeElement.querySelectorAll('.cl');
              if (codeLines.length > 0) {
                codeText = Array.from(codeLines)
                  .map(line => {
                    const text = line.textContent || line.innerText;
                    
                    return text.replace(/\n+$/, '');
                  })
                  .join('\n')
                  .replace(/\n+$/, ''); 
              } else {
                
                const allText = codeElement.textContent || codeElement.innerText;
                codeText = allText.replace(/^\d+/gm, '').replace(/^\s+/gm, '');
              }
            } else {
              
              codeText = codeElement.textContent || codeElement.innerText;
            }
          } else {
            
            codeText = codeContainer.textContent || codeContainer.innerText;
          }
        }

        
        codeText = codeText.trim();

        
        await navigator.clipboard.writeText(codeText);

        
        copyIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M5 13l4 4L19 7\u0022 \/\u003e\n\u003c\/svg\u003e`;
        if (copyText) {
          copyText.textContent = '복사됨';
        }
        copyBtn.classList.add('text-green-600');

        
        setTimeout(() => {
          copyIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z\u0022 \/\u003e\n\u003c\/svg\u003e`;
          if (copyText) {
            copyText.textContent = '복사';
          }
          copyBtn.classList.remove('text-green-600');
        }, 2000);

      } catch (err) {
        console.error('复制失败:', err);

        
        const range = document.createRange();
        const codeElement = codeContainer.querySelector('code') || codeContainer;
        range.selectNodeContents(codeElement);
        const selection = window.getSelection();
        selection.removeAllRanges();
        selection.addRange(range);

        
        if (copyText) {
          copyText.textContent = '선택됨';
        }

        setTimeout(() => {
          if (copyText) {
            copyText.textContent = '복사';
          }
          selection.removeAllRanges();
        }, 2000);
      }
    });
  }

  
  if (collapseBtn) {
    const collapseIcon = collapseBtn.querySelector('.collapse-icon');
    const collapseText = collapseBtn.querySelector('.collapse-text');
    const collapseOverlay = codeContainer.querySelector('.collapse-overlay');

    
    let codeElement = codeContainer.querySelector('pre.chroma');
    if (!codeElement) {
      codeElement = codeContainer.querySelector('pre');
    }

    const defaultState = collapseBtn.dataset.defaultState || 'expanded';
    const isCollapsedAttr = collapseBtn.dataset.collapsed === 'true';
    const autoCollapseLines = parseInt(collapseBtn.dataset.autoCollapseLines) || 30;
    const autoCollapseHeight = parseInt(collapseBtn.dataset.autoCollapseHeight) || 400;
    const collapsedHeight = parseInt(collapseBtn.dataset.collapsedHeight) || 120;

    let isCollapsed = false;

    
    function initCollapse() {
      
      const shouldCollapse = isCollapsedAttr ||
                           defaultState === 'collapsed' ||
                           shouldAutoCollapse();

      if (shouldCollapse) {
        setCollapsed(true, false); 
      }
    }

    function shouldAutoCollapse() {
      
      if (codeElement) {
        const lines = codeElement.querySelectorAll('.line, .cl');
        const height = codeElement.offsetHeight;
        return lines.length > autoCollapseLines || height > autoCollapseHeight;
      }

      
      const containerHeight = codeContainer.offsetHeight;
      if (containerHeight > autoCollapseHeight) {
        return true;
      }

      
      const textContent = codeContainer.textContent || codeContainer.innerText || '';
      const estimatedLines = textContent.split('\n').length;
      return estimatedLines > autoCollapseLines;
    }

    function setCollapsed(collapsed, animate = true) {
      if (!collapseOverlay) return;

      isCollapsed = collapsed;

      if (collapsed) {
        
        codeContainer.style.maxHeight = collapsedHeight + 'px';
        codeContainer.style.overflow = 'hidden';
        collapseOverlay.style.opacity = '1';
        collapseOverlay.style.pointerEvents = 'auto';

        
        collapseIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M19 9l-7 7-7-7\u0022 \/\u003e\n\u003c\/svg\u003e`;
        if (collapseText) {
          collapseText.textContent = '펼치기';
        }
        collapseBtn.title = '펼치기';

      } else {
        
        codeContainer.style.maxHeight = '';
        codeContainer.style.overflow = '';
        collapseOverlay.style.opacity = '0';
        collapseOverlay.style.pointerEvents = 'none';

        
        collapseIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath fill=\u0022currentColor\u0022 d=\u0022M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z\u0022\/\u003e\u003c\/svg\u003e`;
        if (collapseText) {
          collapseText.textContent = '접기';
        }
        collapseBtn.title = '접기';
      }

      
      if (animate) {
        codeContainer.style.transition = 'max-height 0.3s ease-out';
        setTimeout(() => {
          codeContainer.style.transition = '';
        }, 300);
      }
    }

    function toggleCollapse() {
      setCollapsed(!isCollapsed, true);
    }

    
    collapseBtn.addEventListener('click', toggleCollapse);

    
    if (collapseOverlay) {
      collapseOverlay.addEventListener('click', () => {
        if (isCollapsed) {
          setCollapsed(false, true);
        }
      });
    }

    
    initCollapse();
  }
})();
</script>
<h3 id="결론-한-줄-요약">결론 한 줄 요약</h3>
<p><strong>NSA는 (1) 계층적 희소 Attention 아키텍처, (2) 엔드투엔드 학습 가능한 희소화 기법, (3) GQA/MQA-친화 Triton 커널을 결합해 64 k 토큰에서 디코딩 11.6×·순전파 9.0×·역전파 6.0× 가속을 얻으면서도 풀-어텐션과 동등 이상의 정확도를 달성했다</strong>.</p>
<hr>
<h2 id="독창적-기여-top-3">독창적 기여 (top-3)</h2>
<table>
  <thead>
      <tr>
          <th>#</th>
          <th>기여 내용</th>
          <th>분류</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>1. 계층적 Compression + Selection + Sliding-Window 희소 Attention</strong>  <br> - 블록-단위 <strong>Token Compression</strong>로 전역 정보를 요약하고, <br> - Query-의존 <strong>Blockwise Selection</strong>으로 세밀 정보를 보존하며, <br> - <strong>Sliding Window</strong> 분기를 별도 유지해 지역 패턴을 처리. <br> 이 세 가지를 <strong>동적 게이팅</strong>으로 통합해 L² 복잡도를 L log L 수준으로 낮추고도 정보 손실을 최소화한다.</td>
          <td><strong>새로운 아키텍처 구성요소</strong></td>
          <td></td>
      </tr>
      <tr>
          <td><strong>2. Gradient-friendly, Natively-Trainable Sparsity</strong>  <br> - 모든 희소 연산을 <strong>연속 블록</strong>으로 제한해 FlashAttention-2와 동일한 연산 그래프를 유지. <br> - 비연속·비미분 선택으로 인한 <strong>gradient cut</strong> 문제를 제거해 <strong>사전학습·미세조정·RLHF</strong>까지 동일 연산으로 수행 가능.</td>
          <td><strong>새로운 학습 기법</strong> (trainable sparsity)</td>
          <td></td>
      </tr>
      <tr>
          <td><strong>3. Triton 기반 GQA/MQA-정렬 커널</strong>  <br> - <strong>Group-centric</strong> 데이터 로딩과 <strong>inner-loop KV 공유</strong>로 KV 이동량을 최소화. <br> - Arithmetic-intensity 균형을 맞춰 <strong>Tensor Core</strong> 활용률을 극대화하여 Prefill·Decode 모두 FlashAttention 수준의 메모리 효율 달성.</td>
          <td><strong>기존 방법론의 새로운 적용</strong> (하드웨어 최적화 커널)</td>
          <td></td>
      </tr>
  </tbody>
</table>

  <blockquote
    class="border-primary bg-muted/30 hover:bg-muted/40 my-6 rounded-r-lg border-l-4 py-4 pr-4 pl-6 italic transition-all duration-200 ease-out hover:translate-x-1">
    <div class="prose prose-sm max-w-none">
      <p><strong>실험 지표</strong>: 27 B-parameter 모델 기준, NSA는 64 k 길이에서 디코딩 11.6×·순전파 9.0×·역전파 6.0× 속도 향상과 함께 MMLU·LongBench 등 주요 벤치마크에서 풀-어텐션 대비 ±0.0 ~ +0.2 점의 성능을 유지했다.</p>
    </div>
  </blockquote>

<hr>
<h1 id="프롬프트-122-저자-관점에서의-강점">프롬프트 1.2.2 (저자 관점에서의 강점)</h1>
<div
  class="code-block-container border-border bg-card my-6 overflow-hidden rounded-xl border shadow-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:shadow-md">
  
  <div
    class="code-block-header bg-muted/30 border-border flex items-center justify-between border-b px-4 py-3">
    
    <div class="flex items-center gap-2">
      <div class="text-muted-foreground flex-shrink-0">
        
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4" />
</svg>
      </div>
      <span class="text-muted-foreground text-sm font-medium">
        PLAINTEXT
      </span>
    </div>

    
    <div class="flex items-center gap-2">
      <button
          class="collapse-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none"
          data-code-id="code-3"
          data-default-state="expanded"
          data-collapsed="false"
          data-auto-collapse-lines="30"
          data-auto-collapse-height="400"
          data-collapsed-height="120"
          title="접기"
          aria-label="접기">
          <span class="collapse-icon">
            
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z"/></svg>
          </span>
          <span class="collapse-text hidden sm:inline"
            >접기</span
          >
        </button>
      <button
        class="copy-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none"
        data-code-id="code-3"
        title="복사"
        aria-label="복사">
        <span class="copy-icon">
          
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
</svg>
        </span>
        <span class="copy-text hidden sm:inline"
          >복사</span
        >
      </button>
    </div>
  </div>

  
  <div class="code-block-content relative" id="code-3">
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">&#34;저자들의 관점에서, 자신들의 접근법이 이전 방법들보다 우월한 이유는 무엇인가? 그들이 자신들의 연구가 지닌 독창성과 강점을 뒷받침하기 위해 사용하는 핵심 논거를 인용하거나 알기 쉽게 설명해 줘.&#34;</span></span></code></pre></div>
    
    <div
      class="collapse-overlay to-card/90 pointer-events-none absolute inset-0 bg-gradient-to-b from-transparent via-transparent opacity-0 transition-opacity duration-300">
      <div
        class="text-muted-foreground bg-card/80 border-border/50 hover:bg-primary/10 hover:text-primary hover:border-primary/30 absolute bottom-4 left-1/2 -translate-x-1/2 cursor-pointer rounded-full border px-3 py-1.5 text-xs backdrop-blur-sm transition-all duration-200">
        클릭하여 더 보기
      </div>
    </div>
  </div>
</div>


<script>
(function() {
  const codeId = 'code-3';
  const copyBtn = document.querySelector('.copy-code-btn[data-code-id="' + codeId + '"]');
  const collapseBtn = document.querySelector('.collapse-code-btn[data-code-id="' + codeId + '"]');
  const codeContainer = document.getElementById(codeId);

  if (!codeContainer) return;

  
  if (copyBtn) {
    const copyIcon = copyBtn.querySelector('.copy-icon');
    const copyText = copyBtn.querySelector('.copy-text');

    copyBtn.addEventListener('click', async function() {
      try {
        
        let codeText = '';

        
        const codeTableCell = codeContainer.querySelector('.lntd:last-child code');
        if (codeTableCell) {
          codeText = codeTableCell.textContent || codeTableCell.innerText;
        } else {
          
          const codeElement = codeContainer.querySelector('code');
          if (codeElement) {
            
            const hasInlineLineNumbers = codeElement.querySelector('.ln');
            if (hasInlineLineNumbers) {
              
              const codeLines = codeElement.querySelectorAll('.cl');
              if (codeLines.length > 0) {
                codeText = Array.from(codeLines)
                  .map(line => {
                    const text = line.textContent || line.innerText;
                    
                    return text.replace(/\n+$/, '');
                  })
                  .join('\n')
                  .replace(/\n+$/, ''); 
              } else {
                
                const allText = codeElement.textContent || codeElement.innerText;
                codeText = allText.replace(/^\d+/gm, '').replace(/^\s+/gm, '');
              }
            } else {
              
              codeText = codeElement.textContent || codeElement.innerText;
            }
          } else {
            
            codeText = codeContainer.textContent || codeContainer.innerText;
          }
        }

        
        codeText = codeText.trim();

        
        await navigator.clipboard.writeText(codeText);

        
        copyIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M5 13l4 4L19 7\u0022 \/\u003e\n\u003c\/svg\u003e`;
        if (copyText) {
          copyText.textContent = '복사됨';
        }
        copyBtn.classList.add('text-green-600');

        
        setTimeout(() => {
          copyIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z\u0022 \/\u003e\n\u003c\/svg\u003e`;
          if (copyText) {
            copyText.textContent = '복사';
          }
          copyBtn.classList.remove('text-green-600');
        }, 2000);

      } catch (err) {
        console.error('复制失败:', err);

        
        const range = document.createRange();
        const codeElement = codeContainer.querySelector('code') || codeContainer;
        range.selectNodeContents(codeElement);
        const selection = window.getSelection();
        selection.removeAllRanges();
        selection.addRange(range);

        
        if (copyText) {
          copyText.textContent = '선택됨';
        }

        setTimeout(() => {
          if (copyText) {
            copyText.textContent = '복사';
          }
          selection.removeAllRanges();
        }, 2000);
      }
    });
  }

  
  if (collapseBtn) {
    const collapseIcon = collapseBtn.querySelector('.collapse-icon');
    const collapseText = collapseBtn.querySelector('.collapse-text');
    const collapseOverlay = codeContainer.querySelector('.collapse-overlay');

    
    let codeElement = codeContainer.querySelector('pre.chroma');
    if (!codeElement) {
      codeElement = codeContainer.querySelector('pre');
    }

    const defaultState = collapseBtn.dataset.defaultState || 'expanded';
    const isCollapsedAttr = collapseBtn.dataset.collapsed === 'true';
    const autoCollapseLines = parseInt(collapseBtn.dataset.autoCollapseLines) || 30;
    const autoCollapseHeight = parseInt(collapseBtn.dataset.autoCollapseHeight) || 400;
    const collapsedHeight = parseInt(collapseBtn.dataset.collapsedHeight) || 120;

    let isCollapsed = false;

    
    function initCollapse() {
      
      const shouldCollapse = isCollapsedAttr ||
                           defaultState === 'collapsed' ||
                           shouldAutoCollapse();

      if (shouldCollapse) {
        setCollapsed(true, false); 
      }
    }

    function shouldAutoCollapse() {
      
      if (codeElement) {
        const lines = codeElement.querySelectorAll('.line, .cl');
        const height = codeElement.offsetHeight;
        return lines.length > autoCollapseLines || height > autoCollapseHeight;
      }

      
      const containerHeight = codeContainer.offsetHeight;
      if (containerHeight > autoCollapseHeight) {
        return true;
      }

      
      const textContent = codeContainer.textContent || codeContainer.innerText || '';
      const estimatedLines = textContent.split('\n').length;
      return estimatedLines > autoCollapseLines;
    }

    function setCollapsed(collapsed, animate = true) {
      if (!collapseOverlay) return;

      isCollapsed = collapsed;

      if (collapsed) {
        
        codeContainer.style.maxHeight = collapsedHeight + 'px';
        codeContainer.style.overflow = 'hidden';
        collapseOverlay.style.opacity = '1';
        collapseOverlay.style.pointerEvents = 'auto';

        
        collapseIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M19 9l-7 7-7-7\u0022 \/\u003e\n\u003c\/svg\u003e`;
        if (collapseText) {
          collapseText.textContent = '펼치기';
        }
        collapseBtn.title = '펼치기';

      } else {
        
        codeContainer.style.maxHeight = '';
        codeContainer.style.overflow = '';
        collapseOverlay.style.opacity = '0';
        collapseOverlay.style.pointerEvents = 'none';

        
        collapseIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath fill=\u0022currentColor\u0022 d=\u0022M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z\u0022\/\u003e\u003c\/svg\u003e`;
        if (collapseText) {
          collapseText.textContent = '접기';
        }
        collapseBtn.title = '접기';
      }

      
      if (animate) {
        codeContainer.style.transition = 'max-height 0.3s ease-out';
        setTimeout(() => {
          codeContainer.style.transition = '';
        }, 300);
      }
    }

    function toggleCollapse() {
      setCollapsed(!isCollapsed, true);
    }

    
    collapseBtn.addEventListener('click', toggleCollapse);

    
    if (collapseOverlay) {
      collapseOverlay.addEventListener('click', () => {
        if (isCollapsed) {
          setCollapsed(false, true);
        }
      });
    }

    
    initCollapse();
  }
})();
</script>
<h3 id="한눈에-보는-결론">한눈에 보는 결론</h3>
<p><strong>NSA는 ‘하드웨어 정렬 ＋ 학습 친화’ 두 축을 동시에 잡아 64 k 토큰에서 디코딩 11.6×·순전파 9.0×·역전파 6.0×의 <strong>실측</strong> 가속을 내면서도 LongBench 평균 +0.032, AIME CoT +0.054 등 성능까지 올려 기존 희소 attention이 겪던 “이론만 빠르고 정확도는 깎이는” 딜레마를 해소한다고 주장한다.</strong></p>
<hr>
<h2 id="저자-관점에서의-4대-강점">저자 관점에서의 4대 강점</h2>
<table>
  <thead>
      <tr>
          <th>#</th>
          <th>주장하고 싶은 우월성</th>
          <th>핵심 근거 &amp; 숫자</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>1. 전(全) 단계 실측 가속</strong></td>
          <td>- 블록 연속 접근·GQA 그룹 단위 <strong>Triton 커널</strong>로 <strong>Tensor Core 활용률 극대화</strong>.<br>- 64 k 길이에서 <strong>Forward 9.0×</strong>·<strong>Backward 6.0×</strong>·<strong>Decode 11.6×</strong> 속도배향상.</td>
          <td>Figure 1 &amp; Table 4 (실측/메모리-토큰 환산)</td>
      </tr>
      <tr>
          <td><strong>2. 엔드투엔드 학습 가능 희소화</strong></td>
          <td>- 모든 선택을 <strong>연속 블록</strong>으로 제한해 <strong>FlashAttention-2 동일 연산 그래프</strong> 유지 → gradient cut 無.<br>- 27 B 모델 프리트레인 시 <strong>NSA가 더 낮은 손실</strong>로 수렴.</td>
          <td>Section 2.2 “The Myth of Trainable Sparsity” 및 Figure 4 loss curve</td>
      </tr>
      <tr>
          <td><strong>3. GQA/MQA 완전 호환</strong></td>
          <td>- <strong>그룹 공통 KV 블록만</strong> 불러오는 ‘group-centric’ 패치로 기존 Quest류 기법의 <strong>KV 중복 로드</strong> 문제 제거.<br>- 결과적으로 메모리 이동량이 Full Attention 대비 선형으로 감소해 긴 컨텍스트일수록 속도 이득 확대.</td>
          <td>Section 2.1 “Incompatibility with Advanced Attention Architecture”</td>
      </tr>
      <tr>
          <td><strong>4. 정확도 ↗ &amp; 장문 이해력</strong></td>
          <td>- LongBench 전체 <strong>+0.032</strong>p, 멀티-홉 QA <strong>HPQ +0.087</strong>p 등 Full Attention을 초과.<br>- CoT SFT 후 <strong>AIME 8 k→ +0.075 / 16 k→ +0.054</strong>p 향상으로 희소화가 추론 깊이도 지원.</td>
          <td>Hierarchical Compression + Selection + Sliding 설계가 지역-전역 정보를 균형 있게 보존</td>
      </tr>
  </tbody>
</table>
<hr>
<h3 id="속도-체감치-한눈에-보기">속도 체감치 한눈에 보기</h3>
<table>
  <thead>
      <tr>
          <th>구간 길이 64 k 기준</th>
          <th style="text-align: center">Forward</th>
          <th style="text-align: center">Backward</th>
          <th style="text-align: center">Decode</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>NSA / Full Attention</strong></td>
          <td style="text-align: center"><strong>9.0×</strong></td>
          <td style="text-align: center"><strong>6.0×</strong></td>
          <td style="text-align: center"><strong>11.6×</strong></td>
      </tr>
  </tbody>
</table>
<p>(출처: Figure 1, Table 4)</p>
<hr>
<h2 id="요약--저자들의-핵심-논거-정리">요약 — 저자들의 핵심 논거 정리</h2>
<ol>
<li><strong>“이론 → 실측” 간극 해소</strong> : 메모리 억세스·스케줄까지 최적화된 커널 설계로 <em>모든 단계</em>에서 속도배를 실증.</li>
<li><strong>“Inference-only”의 한계 극복</strong> : 희소 선택을 완전 differentiable · block-contiguous로 만들어 <strong>프리트레인·SFT · RLHF</strong>까지 동일 파이프라인 유지.</li>
<li><strong>“최신 아키텍처 비호환” 문제 해결</strong> : GQA/MQA 공유-KV 흐름과 자연스럽게 맞물려 대역폭 병목을 제거.</li>
<li><strong>“속도↗, 성능↘” 고정관념 타파</strong> : LongBench·AIME 등에서 Full Attention보다 높은 점수로 <strong>효율-정확도 트레이드오프 없이</strong> 이득을 증명.</li>
</ol>
<h1 id="프롬프트-131-알고리즘-단계별-설명">프롬프트 1.3.1 (알고리즘 단계별 설명)</h1>
<div
  class="code-block-container border-border bg-card my-6 overflow-hidden rounded-xl border shadow-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:shadow-md">
  
  <div
    class="code-block-header bg-muted/30 border-border flex items-center justify-between border-b px-4 py-3">
    
    <div class="flex items-center gap-2">
      <div class="text-muted-foreground flex-shrink-0">
        
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4" />
</svg>
      </div>
      <span class="text-muted-foreground text-sm font-medium">
        PLAINTEXT
      </span>
    </div>

    
    <div class="flex items-center gap-2">
      <button
          class="collapse-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none"
          data-code-id="code-4"
          data-default-state="expanded"
          data-collapsed="false"
          data-auto-collapse-lines="30"
          data-auto-collapse-height="400"
          data-collapsed-height="120"
          title="접기"
          aria-label="접기">
          <span class="collapse-icon">
            
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z"/></svg>
          </span>
          <span class="collapse-text hidden sm:inline"
            >접기</span
          >
        </button>
      <button
        class="copy-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none"
        data-code-id="code-4"
        title="복사"
        aria-label="복사">
        <span class="copy-icon">
          
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
</svg>
        </span>
        <span class="copy-text hidden sm:inline"
          >복사</span
        >
      </button>
    </div>
  </div>

  
  <div class="code-block-content relative" id="code-4">
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">&#34;핵심 알고리즘, 모델 아키텍처, 또는 주요 방법론을 단계별(step-by-step)로 설명해 줘. 독자는 AI 분야의 대학원생 수준이라고 가정해. 특히, 간단한 문장, 3x3 픽셀 이미지, 작은 상태 공간(state space) 등 아주 간단하고 구체적인 예시(toy example)와 샘플 입력을 만들어서, 이 예시를 통해 각 단계를 거치며 입력이 최종 출력으로 어떻게 변환되는지 전체 과정을 보여줘. 등장하는 모든 핵심 용어와 변수는 그 즉시 정의해 줘.&#34;</span></span></code></pre></div>
    
    <div
      class="collapse-overlay to-card/90 pointer-events-none absolute inset-0 bg-gradient-to-b from-transparent via-transparent opacity-0 transition-opacity duration-300">
      <div
        class="text-muted-foreground bg-card/80 border-border/50 hover:bg-primary/10 hover:text-primary hover:border-primary/30 absolute bottom-4 left-1/2 -translate-x-1/2 cursor-pointer rounded-full border px-3 py-1.5 text-xs backdrop-blur-sm transition-all duration-200">
        클릭하여 더 보기
      </div>
    </div>
  </div>
</div>


<script>
(function() {
  const codeId = 'code-4';
  const copyBtn = document.querySelector('.copy-code-btn[data-code-id="' + codeId + '"]');
  const collapseBtn = document.querySelector('.collapse-code-btn[data-code-id="' + codeId + '"]');
  const codeContainer = document.getElementById(codeId);

  if (!codeContainer) return;

  
  if (copyBtn) {
    const copyIcon = copyBtn.querySelector('.copy-icon');
    const copyText = copyBtn.querySelector('.copy-text');

    copyBtn.addEventListener('click', async function() {
      try {
        
        let codeText = '';

        
        const codeTableCell = codeContainer.querySelector('.lntd:last-child code');
        if (codeTableCell) {
          codeText = codeTableCell.textContent || codeTableCell.innerText;
        } else {
          
          const codeElement = codeContainer.querySelector('code');
          if (codeElement) {
            
            const hasInlineLineNumbers = codeElement.querySelector('.ln');
            if (hasInlineLineNumbers) {
              
              const codeLines = codeElement.querySelectorAll('.cl');
              if (codeLines.length > 0) {
                codeText = Array.from(codeLines)
                  .map(line => {
                    const text = line.textContent || line.innerText;
                    
                    return text.replace(/\n+$/, '');
                  })
                  .join('\n')
                  .replace(/\n+$/, ''); 
              } else {
                
                const allText = codeElement.textContent || codeElement.innerText;
                codeText = allText.replace(/^\d+/gm, '').replace(/^\s+/gm, '');
              }
            } else {
              
              codeText = codeElement.textContent || codeElement.innerText;
            }
          } else {
            
            codeText = codeContainer.textContent || codeContainer.innerText;
          }
        }

        
        codeText = codeText.trim();

        
        await navigator.clipboard.writeText(codeText);

        
        copyIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M5 13l4 4L19 7\u0022 \/\u003e\n\u003c\/svg\u003e`;
        if (copyText) {
          copyText.textContent = '복사됨';
        }
        copyBtn.classList.add('text-green-600');

        
        setTimeout(() => {
          copyIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z\u0022 \/\u003e\n\u003c\/svg\u003e`;
          if (copyText) {
            copyText.textContent = '복사';
          }
          copyBtn.classList.remove('text-green-600');
        }, 2000);

      } catch (err) {
        console.error('复制失败:', err);

        
        const range = document.createRange();
        const codeElement = codeContainer.querySelector('code') || codeContainer;
        range.selectNodeContents(codeElement);
        const selection = window.getSelection();
        selection.removeAllRanges();
        selection.addRange(range);

        
        if (copyText) {
          copyText.textContent = '선택됨';
        }

        setTimeout(() => {
          if (copyText) {
            copyText.textContent = '복사';
          }
          selection.removeAllRanges();
        }, 2000);
      }
    });
  }

  
  if (collapseBtn) {
    const collapseIcon = collapseBtn.querySelector('.collapse-icon');
    const collapseText = collapseBtn.querySelector('.collapse-text');
    const collapseOverlay = codeContainer.querySelector('.collapse-overlay');

    
    let codeElement = codeContainer.querySelector('pre.chroma');
    if (!codeElement) {
      codeElement = codeContainer.querySelector('pre');
    }

    const defaultState = collapseBtn.dataset.defaultState || 'expanded';
    const isCollapsedAttr = collapseBtn.dataset.collapsed === 'true';
    const autoCollapseLines = parseInt(collapseBtn.dataset.autoCollapseLines) || 30;
    const autoCollapseHeight = parseInt(collapseBtn.dataset.autoCollapseHeight) || 400;
    const collapsedHeight = parseInt(collapseBtn.dataset.collapsedHeight) || 120;

    let isCollapsed = false;

    
    function initCollapse() {
      
      const shouldCollapse = isCollapsedAttr ||
                           defaultState === 'collapsed' ||
                           shouldAutoCollapse();

      if (shouldCollapse) {
        setCollapsed(true, false); 
      }
    }

    function shouldAutoCollapse() {
      
      if (codeElement) {
        const lines = codeElement.querySelectorAll('.line, .cl');
        const height = codeElement.offsetHeight;
        return lines.length > autoCollapseLines || height > autoCollapseHeight;
      }

      
      const containerHeight = codeContainer.offsetHeight;
      if (containerHeight > autoCollapseHeight) {
        return true;
      }

      
      const textContent = codeContainer.textContent || codeContainer.innerText || '';
      const estimatedLines = textContent.split('\n').length;
      return estimatedLines > autoCollapseLines;
    }

    function setCollapsed(collapsed, animate = true) {
      if (!collapseOverlay) return;

      isCollapsed = collapsed;

      if (collapsed) {
        
        codeContainer.style.maxHeight = collapsedHeight + 'px';
        codeContainer.style.overflow = 'hidden';
        collapseOverlay.style.opacity = '1';
        collapseOverlay.style.pointerEvents = 'auto';

        
        collapseIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M19 9l-7 7-7-7\u0022 \/\u003e\n\u003c\/svg\u003e`;
        if (collapseText) {
          collapseText.textContent = '펼치기';
        }
        collapseBtn.title = '펼치기';

      } else {
        
        codeContainer.style.maxHeight = '';
        codeContainer.style.overflow = '';
        collapseOverlay.style.opacity = '0';
        collapseOverlay.style.pointerEvents = 'none';

        
        collapseIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath fill=\u0022currentColor\u0022 d=\u0022M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z\u0022\/\u003e\u003c\/svg\u003e`;
        if (collapseText) {
          collapseText.textContent = '접기';
        }
        collapseBtn.title = '접기';
      }

      
      if (animate) {
        codeContainer.style.transition = 'max-height 0.3s ease-out';
        setTimeout(() => {
          codeContainer.style.transition = '';
        }, 300);
      }
    }

    function toggleCollapse() {
      setCollapsed(!isCollapsed, true);
    }

    
    collapseBtn.addEventListener('click', toggleCollapse);

    
    if (collapseOverlay) {
      collapseOverlay.addEventListener('click', () => {
        if (isCollapsed) {
          setCollapsed(false, true);
        }
      });
    }

    
    initCollapse();
  }
})();
</script>
<h3 id="tldr--nsa-attention-한눈-요약">TL;DR — NSA Attention 한눈 요약</h3>
<p><strong>NSA는 “압축 → 선택 → 슬라이딩” 3-분기 희소화와 GQA/MQA 호환 Triton 커널을 결합해 L² → L log L 복잡도로 줄이면서도 64 k 토큰에서 <em>Forward 9.0×</em>, <em>Backward 6.0×</em>, <em>Decode 11.6×</em> 속도를 달성한다</strong>.</p>
<hr>
<h2 id="1-용어--하이퍼파라미터-정의">1. 용어 &amp; 하이퍼파라미터 정의</h2>
<table>
  <thead>
      <tr>
          <th>기호</th>
          <th>의미</th>
          <th>논문 기본 값</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>𝐿</td>
          <td>입력 시퀀스 길이</td>
          <td>실험 최대 65 536</td>
      </tr>
      <tr>
          <td>𝑙</td>
          <td><strong>Compression block</strong> 길이</td>
          <td>32 토큰</td>
      </tr>
      <tr>
          <td>𝑑</td>
          <td>Compression stride</td>
          <td>16 토큰</td>
      </tr>
      <tr>
          <td>𝑙′</td>
          <td><strong>Selection block</strong> 길이</td>
          <td>64 토큰</td>
      </tr>
      <tr>
          <td>𝑛</td>
          <td>Top-𝑛 선택 블록 개수</td>
          <td>16 개</td>
      </tr>
      <tr>
          <td>𝑤</td>
          <td><strong>Sliding window</strong> 크기</td>
          <td>512 토큰</td>
      </tr>
      <tr>
          <td>𝑔</td>
          <td>GQA 그룹당 쿼리 헤드 수</td>
          <td>16 헤드</td>
      </tr>
  </tbody>
</table>
<hr>
<h2 id="2-nsa-알고리즘--7-단계-흐름">2. NSA 알고리즘 ― 7-단계 흐름</h2>

  <blockquote
    class="border-primary bg-muted/30 hover:bg-muted/40 my-6 rounded-r-lg border-l-4 py-4 pr-4 pl-6 italic transition-all duration-200 ease-out hover:translate-x-1">
    <div class="prose prose-sm max-w-none">
      <ul>
<li>아래 예시는 길이 <strong>9</strong>(3 × 3 픽셀) 토큰 시퀀스, 𝑙 = 3, 𝑙′ = 3, 𝑛 = 2, 𝑤 = 2로 축소한 <em>toy</em> 버전입니다.</li>
</ul>
    </div>
  </blockquote>

<table>
  <thead>
      <tr>
          <th>토큰 인덱스</th>
          <th><strong>0</strong></th>
          <th><strong>1</strong></th>
          <th><strong>2</strong></th>
          <th><strong>3</strong></th>
          <th><strong>4</strong></th>
          <th><strong>5</strong></th>
          <th><strong>6</strong></th>
          <th><strong>7</strong></th>
          <th><strong>8</strong></th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>값(예시)</td>
          <td>0.1</td>
          <td>0.4</td>
          <td>0.8</td>
          <td>0.3</td>
          <td>0.5</td>
          <td>0.9</td>
          <td>0.2</td>
          <td>0.6</td>
          <td>1.0</td>
      </tr>
  </tbody>
</table>
<h3 id="33-픽셀-시각화-토큰-값이-밝기">3×3 픽셀 시각화 (토큰 값이 밝기)</h3>
<div
  class="code-block-container border-border bg-card my-6 overflow-hidden rounded-xl border shadow-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:shadow-md">
  
  <div
    class="code-block-header bg-muted/30 border-border flex items-center justify-between border-b px-4 py-3">
    
    <div class="flex items-center gap-2">
      <div class="text-muted-foreground flex-shrink-0">
        
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4" />
</svg>
      </div>
      <span class="text-muted-foreground text-sm font-medium">
        PLAINTEXT
      </span>
    </div>

    
    <div class="flex items-center gap-2">
      <button
          class="collapse-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none"
          data-code-id="code-5"
          data-default-state="expanded"
          data-collapsed="false"
          data-auto-collapse-lines="30"
          data-auto-collapse-height="400"
          data-collapsed-height="120"
          title="접기"
          aria-label="접기">
          <span class="collapse-icon">
            
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z"/></svg>
          </span>
          <span class="collapse-text hidden sm:inline"
            >접기</span
          >
        </button>
      <button
        class="copy-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none"
        data-code-id="code-5"
        title="복사"
        aria-label="복사">
        <span class="copy-icon">
          
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
</svg>
        </span>
        <span class="copy-text hidden sm:inline"
          >복사</span
        >
      </button>
    </div>
  </div>

  
  <div class="code-block-content relative" id="code-5">
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">0.1 0.4 0.8
</span></span><span class="line"><span class="ln">2</span><span class="cl">0.3 0.5 0.9
</span></span><span class="line"><span class="ln">3</span><span class="cl">0.2 0.6 1.0  ← 현재 Query = 토큰 8</span></span></code></pre></div>
    
    <div
      class="collapse-overlay to-card/90 pointer-events-none absolute inset-0 bg-gradient-to-b from-transparent via-transparent opacity-0 transition-opacity duration-300">
      <div
        class="text-muted-foreground bg-card/80 border-border/50 hover:bg-primary/10 hover:text-primary hover:border-primary/30 absolute bottom-4 left-1/2 -translate-x-1/2 cursor-pointer rounded-full border px-3 py-1.5 text-xs backdrop-blur-sm transition-all duration-200">
        클릭하여 더 보기
      </div>
    </div>
  </div>
</div>


<script>
(function() {
  const codeId = 'code-5';
  const copyBtn = document.querySelector('.copy-code-btn[data-code-id="' + codeId + '"]');
  const collapseBtn = document.querySelector('.collapse-code-btn[data-code-id="' + codeId + '"]');
  const codeContainer = document.getElementById(codeId);

  if (!codeContainer) return;

  
  if (copyBtn) {
    const copyIcon = copyBtn.querySelector('.copy-icon');
    const copyText = copyBtn.querySelector('.copy-text');

    copyBtn.addEventListener('click', async function() {
      try {
        
        let codeText = '';

        
        const codeTableCell = codeContainer.querySelector('.lntd:last-child code');
        if (codeTableCell) {
          codeText = codeTableCell.textContent || codeTableCell.innerText;
        } else {
          
          const codeElement = codeContainer.querySelector('code');
          if (codeElement) {
            
            const hasInlineLineNumbers = codeElement.querySelector('.ln');
            if (hasInlineLineNumbers) {
              
              const codeLines = codeElement.querySelectorAll('.cl');
              if (codeLines.length > 0) {
                codeText = Array.from(codeLines)
                  .map(line => {
                    const text = line.textContent || line.innerText;
                    
                    return text.replace(/\n+$/, '');
                  })
                  .join('\n')
                  .replace(/\n+$/, ''); 
              } else {
                
                const allText = codeElement.textContent || codeElement.innerText;
                codeText = allText.replace(/^\d+/gm, '').replace(/^\s+/gm, '');
              }
            } else {
              
              codeText = codeElement.textContent || codeElement.innerText;
            }
          } else {
            
            codeText = codeContainer.textContent || codeContainer.innerText;
          }
        }

        
        codeText = codeText.trim();

        
        await navigator.clipboard.writeText(codeText);

        
        copyIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M5 13l4 4L19 7\u0022 \/\u003e\n\u003c\/svg\u003e`;
        if (copyText) {
          copyText.textContent = '복사됨';
        }
        copyBtn.classList.add('text-green-600');

        
        setTimeout(() => {
          copyIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z\u0022 \/\u003e\n\u003c\/svg\u003e`;
          if (copyText) {
            copyText.textContent = '복사';
          }
          copyBtn.classList.remove('text-green-600');
        }, 2000);

      } catch (err) {
        console.error('复制失败:', err);

        
        const range = document.createRange();
        const codeElement = codeContainer.querySelector('code') || codeContainer;
        range.selectNodeContents(codeElement);
        const selection = window.getSelection();
        selection.removeAllRanges();
        selection.addRange(range);

        
        if (copyText) {
          copyText.textContent = '선택됨';
        }

        setTimeout(() => {
          if (copyText) {
            copyText.textContent = '복사';
          }
          selection.removeAllRanges();
        }, 2000);
      }
    });
  }

  
  if (collapseBtn) {
    const collapseIcon = collapseBtn.querySelector('.collapse-icon');
    const collapseText = collapseBtn.querySelector('.collapse-text');
    const collapseOverlay = codeContainer.querySelector('.collapse-overlay');

    
    let codeElement = codeContainer.querySelector('pre.chroma');
    if (!codeElement) {
      codeElement = codeContainer.querySelector('pre');
    }

    const defaultState = collapseBtn.dataset.defaultState || 'expanded';
    const isCollapsedAttr = collapseBtn.dataset.collapsed === 'true';
    const autoCollapseLines = parseInt(collapseBtn.dataset.autoCollapseLines) || 30;
    const autoCollapseHeight = parseInt(collapseBtn.dataset.autoCollapseHeight) || 400;
    const collapsedHeight = parseInt(collapseBtn.dataset.collapsedHeight) || 120;

    let isCollapsed = false;

    
    function initCollapse() {
      
      const shouldCollapse = isCollapsedAttr ||
                           defaultState === 'collapsed' ||
                           shouldAutoCollapse();

      if (shouldCollapse) {
        setCollapsed(true, false); 
      }
    }

    function shouldAutoCollapse() {
      
      if (codeElement) {
        const lines = codeElement.querySelectorAll('.line, .cl');
        const height = codeElement.offsetHeight;
        return lines.length > autoCollapseLines || height > autoCollapseHeight;
      }

      
      const containerHeight = codeContainer.offsetHeight;
      if (containerHeight > autoCollapseHeight) {
        return true;
      }

      
      const textContent = codeContainer.textContent || codeContainer.innerText || '';
      const estimatedLines = textContent.split('\n').length;
      return estimatedLines > autoCollapseLines;
    }

    function setCollapsed(collapsed, animate = true) {
      if (!collapseOverlay) return;

      isCollapsed = collapsed;

      if (collapsed) {
        
        codeContainer.style.maxHeight = collapsedHeight + 'px';
        codeContainer.style.overflow = 'hidden';
        collapseOverlay.style.opacity = '1';
        collapseOverlay.style.pointerEvents = 'auto';

        
        collapseIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M19 9l-7 7-7-7\u0022 \/\u003e\n\u003c\/svg\u003e`;
        if (collapseText) {
          collapseText.textContent = '펼치기';
        }
        collapseBtn.title = '펼치기';

      } else {
        
        codeContainer.style.maxHeight = '';
        codeContainer.style.overflow = '';
        collapseOverlay.style.opacity = '0';
        collapseOverlay.style.pointerEvents = 'none';

        
        collapseIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath fill=\u0022currentColor\u0022 d=\u0022M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z\u0022\/\u003e\u003c\/svg\u003e`;
        if (collapseText) {
          collapseText.textContent = '접기';
        }
        collapseBtn.title = '접기';
      }

      
      if (animate) {
        codeContainer.style.transition = 'max-height 0.3s ease-out';
        setTimeout(() => {
          codeContainer.style.transition = '';
        }, 300);
      }
    }

    function toggleCollapse() {
      setCollapsed(!isCollapsed, true);
    }

    
    collapseBtn.addEventListener('click', toggleCollapse);

    
    if (collapseOverlay) {
      collapseOverlay.addEventListener('click', () => {
        if (isCollapsed) {
          setCollapsed(false, true);
        }
      });
    }

    
    initCollapse();
  }
})();
</script>
<table>
  <thead>
      <tr>
          <th>단계</th>
          <th>연산</th>
          <th>Toy 동작</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>① Block Compression</strong></td>
          <td>길이 𝑙 단위로 키·값 평균 → <code>K_cmp</code>·<code>V_cmp</code> 생성.</td>
          <td>3 블록: <strong>B₀</strong>(0-2), <strong>B₁</strong>(3-5), <strong>B₂</strong>(6-8) 평균값 → <code>c₀=0.43</code>, <code>c₁=0.57</code>, <code>c₂=0.60</code>.</td>
      </tr>
      <tr>
          <td><strong>② Compression Attention</strong></td>
          <td>Query <code>q₈</code> ↔ <code>K_cmp</code> 점곱 후 softmax → 블록 중요도 <code>p_cmp</code>(길이 𝐿/𝑙).</td>
          <td>유사도 ≈ <code>[0.3, 0.5, 1.2]</code> → softmax <code>p_cmp</code> ≈ <code>[0.18, 0.24, 0.58]</code>.</td>
      </tr>
      <tr>
          <td><strong>③ Score Propagation</strong></td>
          <td>Eq.(9)로 블록 중요도를 shift-add → fine-grain <code>p_slc</code> 계산.</td>
          <td>각 토큰에 주변 블록 점수 전파.</td>
      </tr>
      <tr>
          <td><strong>④ Top-𝑛 Block Selection</strong></td>
          <td>Eq.(11) Top-𝑛 = 2 블록 추출 후 원래 <code>K</code>, <code>V</code> 연속 복원.</td>
          <td>중요도 상위 <strong>B₂</strong>, <strong>B₁</strong> 선택 → 토큰 6-8·3-5 총 6개가 <code>K_slc</code>, <code>V_slc</code>.</td>
      </tr>
      <tr>
          <td><strong>⑤ Sliding Window</strong></td>
          <td>최근 𝑤 토큰 <code>K_win</code>, <code>V_win</code> 확보.</td>
          <td>토큰 6-8 (길이 2 + 현재 1)</td>
      </tr>
      <tr>
          <td><strong>⑥ 삼중 Attention 계산</strong></td>
          <td><code>cmp</code> · <code>slc</code> · <code>win</code> 세 분기별 FlashAttention → 출력을 <strong>게이팅</strong>(학습된 softmax)으로 합산.</td>
          <td>세 출력의 가중합 = 최종 값 <code>h₈</code>.</td>
      </tr>
      <tr>
          <td><strong>⑦ GQA-정렬 커널 실행</strong></td>
          <td>Figure 3 설계: <strong>그룹-중심 쿼리 로드</strong> → 선택 KV 연속 fetch → Tensor Core 연산.</td>
          <td>실제 GPU에서는 블록이 연속 메모리여서 coalesced load.</td>
      </tr>
  </tbody>
</table>

  <blockquote
    class="border-primary bg-muted/30 hover:bg-muted/40 my-6 rounded-r-lg border-l-4 py-4 pr-4 pl-6 italic transition-all duration-200 ease-out hover:translate-x-1">
    <div class="prose prose-sm max-w-none">
      <p><strong>결과</strong>: 희소 패턴이지만 <em>블록 연속성</em> 덕분에 FlashAttention-2와 동일 그래프를 유지 → 프리트레인-SFT-RLHF까지 동일 커널 사용 가능.</p>
    </div>
  </blockquote>

<hr>
<h2 id="3-전체-파이프라인-내-변환-흐름">3. 전체 파이프라인 내 변환 흐름</h2>



<pre class="mermaid">
  flowchart LR
    subgraph Input
        Q[Query q_t]
        K[Full Keys Vals]
    end
    K --&gt; Cmp[Block Compression\n(size l)]
    Q --&gt; CmpAttn[Compression Attention]
    Cmp --&gt; CmpAttn
    CmpAttn --&gt; ScoreProp[Score Propagation\nEq.(9)]
    ScoreProp --&gt; TopN[Top-n Block Select\nEq.(11)]
    TopN --&gt; SelKV[Selected KV\n(size n·l′)]
    Q --&gt; SelAttn[Selection Attention]
    SelKV --&gt; SelAttn
    Q --&gt; WinAttn[Sliding Window\n(size w)]
    WinKV[Window KV] --&gt; WinAttn
    SelAttn --&gt; Gate[Learned Gating]
    CmpAttn --&gt; Gate
    WinAttn --&gt; Gate
    Gate --&gt; Out[Output o_t]
</pre>

<hr>
<h2 id="4-성능--효율-지표-64-k-문맥-27-b-모델">4. 성능 · 효율 지표 (64 k 문맥, 27 B 모델)</h2>
<table>
  <thead>
      <tr>
          <th>단계</th>
          <th>Full Attn(ms)</th>
          <th><strong>NSA(ms)</strong></th>
          <th>실측 Speed-up</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>Forward</td>
          <td>≈ 900</td>
          <td><strong>100</strong></td>
          <td><strong>9.0×</strong></td>
      </tr>
      <tr>
          <td>Backward</td>
          <td>≈ 2500</td>
          <td><strong>420</strong></td>
          <td><strong>6.0×</strong></td>
      </tr>
      <tr>
          <td>Decode (step)</td>
          <td>≈ 560</td>
          <td><strong>48</strong></td>
          <td><strong>11.6×</strong></td>
      </tr>
      <tr>
          <td>메모리 로드(토큰 환산)</td>
          <td>65 536</td>
          <td><strong>5 632</strong></td>
          <td><strong>≈ 11.6×</strong></td>
      </tr>
  </tbody>
</table>
<hr>
<h2 id="5-왜-이렇게-빠른가--요점-정리">5. 왜 이렇게 빠른가? — 요점 정리</h2>
<ol>
<li><strong>Block-연속 메모리</strong>: 선택된 KV가 항상 연속 → coalesced load + Tensor Core  FLOPS 100 % 활용.</li>
<li><strong>GQA/MQA 호환</strong>: 그룹 전체가 같은 KV 하위집합을 공유 → 중복 fetch 제거.</li>
<li><strong>Trainable Sparsity</strong>: 연산 그래프가 FlashAttention-2와 동일해 gradient cut 문제 없음.</li>
<li><strong>삼중 분기 게이팅</strong>: 전역(Compression)·정보선택(Selection)·지역(Window)의 밸런스를 학습적으로 확보 → LongBench 평균 +0.032 p↑ .</li>
</ol>
<hr>
<h3 id="끝맺음">끝맺음</h3>
<p>NSA의 핵심은 <strong>“계층적 &amp; 연속적 희소성”</strong> + <strong>“하드웨어 일치 커널”</strong> 의 결합이다. 덕분에 <em>이론적</em> 희소성이 <strong>실제 속도</strong>와 <strong>학습 전 과정 적용성</strong>으로 이어져, 긴 컨텍스트 LLM의 연산·메모리 병목을 근본적으로 해소한다.</p>
<h1 id="프롬프트-132-비밀-병기-식별">프롬프트 1.3.2 (&lsquo;비밀 병기&rsquo; 식별)</h1>
<div
  class="code-block-container border-border bg-card my-6 overflow-hidden rounded-xl border shadow-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:shadow-md">
  
  <div
    class="code-block-header bg-muted/30 border-border flex items-center justify-between border-b px-4 py-3">
    
    <div class="flex items-center gap-2">
      <div class="text-muted-foreground flex-shrink-0">
        
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4" />
</svg>
      </div>
      <span class="text-muted-foreground text-sm font-medium">
        PLAINTEXT
      </span>
    </div>

    
    <div class="flex items-center gap-2">
      <button
          class="collapse-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none"
          data-code-id="code-7"
          data-default-state="expanded"
          data-collapsed="false"
          data-auto-collapse-lines="30"
          data-auto-collapse-height="400"
          data-collapsed-height="120"
          title="접기"
          aria-label="접기">
          <span class="collapse-icon">
            
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z"/></svg>
          </span>
          <span class="collapse-text hidden sm:inline"
            >접기</span
          >
        </button>
      <button
        class="copy-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none"
        data-code-id="code-7"
        title="복사"
        aria-label="복사">
        <span class="copy-icon">
          
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
</svg>
        </span>
        <span class="copy-text hidden sm:inline"
          >복사</span
        >
      </button>
    </div>
  </div>

  
  <div class="code-block-content relative" id="code-7">
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">&#34;이 논문의 핵심 기여를 가능하게 하는 가장 결정적인 단일 수학 공식, 알고리즘 단계, 또는 아키텍처 구성요소를 식별해 줘. 그것의 기능과, 그것이 이 방법론의 성공에 왜 필수적인지 설명해 줘.&#34;</span></span></code></pre></div>
    
    <div
      class="collapse-overlay to-card/90 pointer-events-none absolute inset-0 bg-gradient-to-b from-transparent via-transparent opacity-0 transition-opacity duration-300">
      <div
        class="text-muted-foreground bg-card/80 border-border/50 hover:bg-primary/10 hover:text-primary hover:border-primary/30 absolute bottom-4 left-1/2 -translate-x-1/2 cursor-pointer rounded-full border px-3 py-1.5 text-xs backdrop-blur-sm transition-all duration-200">
        클릭하여 더 보기
      </div>
    </div>
  </div>
</div>


<script>
(function() {
  const codeId = 'code-7';
  const copyBtn = document.querySelector('.copy-code-btn[data-code-id="' + codeId + '"]');
  const collapseBtn = document.querySelector('.collapse-code-btn[data-code-id="' + codeId + '"]');
  const codeContainer = document.getElementById(codeId);

  if (!codeContainer) return;

  
  if (copyBtn) {
    const copyIcon = copyBtn.querySelector('.copy-icon');
    const copyText = copyBtn.querySelector('.copy-text');

    copyBtn.addEventListener('click', async function() {
      try {
        
        let codeText = '';

        
        const codeTableCell = codeContainer.querySelector('.lntd:last-child code');
        if (codeTableCell) {
          codeText = codeTableCell.textContent || codeTableCell.innerText;
        } else {
          
          const codeElement = codeContainer.querySelector('code');
          if (codeElement) {
            
            const hasInlineLineNumbers = codeElement.querySelector('.ln');
            if (hasInlineLineNumbers) {
              
              const codeLines = codeElement.querySelectorAll('.cl');
              if (codeLines.length > 0) {
                codeText = Array.from(codeLines)
                  .map(line => {
                    const text = line.textContent || line.innerText;
                    
                    return text.replace(/\n+$/, '');
                  })
                  .join('\n')
                  .replace(/\n+$/, ''); 
              } else {
                
                const allText = codeElement.textContent || codeElement.innerText;
                codeText = allText.replace(/^\d+/gm, '').replace(/^\s+/gm, '');
              }
            } else {
              
              codeText = codeElement.textContent || codeElement.innerText;
            }
          } else {
            
            codeText = codeContainer.textContent || codeContainer.innerText;
          }
        }

        
        codeText = codeText.trim();

        
        await navigator.clipboard.writeText(codeText);

        
        copyIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M5 13l4 4L19 7\u0022 \/\u003e\n\u003c\/svg\u003e`;
        if (copyText) {
          copyText.textContent = '복사됨';
        }
        copyBtn.classList.add('text-green-600');

        
        setTimeout(() => {
          copyIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z\u0022 \/\u003e\n\u003c\/svg\u003e`;
          if (copyText) {
            copyText.textContent = '복사';
          }
          copyBtn.classList.remove('text-green-600');
        }, 2000);

      } catch (err) {
        console.error('复制失败:', err);

        
        const range = document.createRange();
        const codeElement = codeContainer.querySelector('code') || codeContainer;
        range.selectNodeContents(codeElement);
        const selection = window.getSelection();
        selection.removeAllRanges();
        selection.addRange(range);

        
        if (copyText) {
          copyText.textContent = '선택됨';
        }

        setTimeout(() => {
          if (copyText) {
            copyText.textContent = '복사';
          }
          selection.removeAllRanges();
        }, 2000);
      }
    });
  }

  
  if (collapseBtn) {
    const collapseIcon = collapseBtn.querySelector('.collapse-icon');
    const collapseText = collapseBtn.querySelector('.collapse-text');
    const collapseOverlay = codeContainer.querySelector('.collapse-overlay');

    
    let codeElement = codeContainer.querySelector('pre.chroma');
    if (!codeElement) {
      codeElement = codeContainer.querySelector('pre');
    }

    const defaultState = collapseBtn.dataset.defaultState || 'expanded';
    const isCollapsedAttr = collapseBtn.dataset.collapsed === 'true';
    const autoCollapseLines = parseInt(collapseBtn.dataset.autoCollapseLines) || 30;
    const autoCollapseHeight = parseInt(collapseBtn.dataset.autoCollapseHeight) || 400;
    const collapsedHeight = parseInt(collapseBtn.dataset.collapsedHeight) || 120;

    let isCollapsed = false;

    
    function initCollapse() {
      
      const shouldCollapse = isCollapsedAttr ||
                           defaultState === 'collapsed' ||
                           shouldAutoCollapse();

      if (shouldCollapse) {
        setCollapsed(true, false); 
      }
    }

    function shouldAutoCollapse() {
      
      if (codeElement) {
        const lines = codeElement.querySelectorAll('.line, .cl');
        const height = codeElement.offsetHeight;
        return lines.length > autoCollapseLines || height > autoCollapseHeight;
      }

      
      const containerHeight = codeContainer.offsetHeight;
      if (containerHeight > autoCollapseHeight) {
        return true;
      }

      
      const textContent = codeContainer.textContent || codeContainer.innerText || '';
      const estimatedLines = textContent.split('\n').length;
      return estimatedLines > autoCollapseLines;
    }

    function setCollapsed(collapsed, animate = true) {
      if (!collapseOverlay) return;

      isCollapsed = collapsed;

      if (collapsed) {
        
        codeContainer.style.maxHeight = collapsedHeight + 'px';
        codeContainer.style.overflow = 'hidden';
        collapseOverlay.style.opacity = '1';
        collapseOverlay.style.pointerEvents = 'auto';

        
        collapseIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M19 9l-7 7-7-7\u0022 \/\u003e\n\u003c\/svg\u003e`;
        if (collapseText) {
          collapseText.textContent = '펼치기';
        }
        collapseBtn.title = '펼치기';

      } else {
        
        codeContainer.style.maxHeight = '';
        codeContainer.style.overflow = '';
        collapseOverlay.style.opacity = '0';
        collapseOverlay.style.pointerEvents = 'none';

        
        collapseIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath fill=\u0022currentColor\u0022 d=\u0022M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z\u0022\/\u003e\u003c\/svg\u003e`;
        if (collapseText) {
          collapseText.textContent = '접기';
        }
        collapseBtn.title = '접기';
      }

      
      if (animate) {
        codeContainer.style.transition = 'max-height 0.3s ease-out';
        setTimeout(() => {
          codeContainer.style.transition = '';
        }, 300);
      }
    }

    function toggleCollapse() {
      setCollapsed(!isCollapsed, true);
    }

    
    collapseBtn.addEventListener('click', toggleCollapse);

    
    if (collapseOverlay) {
      collapseOverlay.addEventListener('click', () => {
        if (isCollapsed) {
          setCollapsed(false, true);
        }
      });
    }

    
    initCollapse();
  }
})();
</script>
<h3 id="비밀-병기-한-줄-요약">비밀 병기 한 줄 요약</h3>
<p>NSA의 <strong>핵심 엔진</strong>은 블록-연속 <strong>Top-$n$ 선택 공식</strong>(식 11)이다:</p>
<p>$$
I_t ;=;\Bigl{, i ;\Bigl|, \operatorname{rank}!\bigl(p^{\text{slc},\prime}_t[i]\bigr)\le n \Bigr}.
$$</p>
<p>이 식 하나로
<strong>① GPU 메모리 coalesced 로드</strong>, <strong>② 엔드-투-엔드 미분 가능 희소화</strong>, <strong>③ GQA/MQA 공유-KV 호환성</strong>을 동시에 달성한다. </p>
<hr>
<h2 id="왜-식-11이-필수적인가">왜 식 11이 필수적인가?</h2>
<table>
  <thead>
      <tr>
          <th>관점</th>
          <th>식 11이 제공하는 기능</th>
          <th>부재 시 치명적 문제</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>하드웨어 효율</strong></td>
          <td>선택된 KV 블록이 <strong>항상 연속</strong> → HBM → SRAM으로 <strong>coalesced</strong> 전송, Tensor Core 활용률 100 %</td>
          <td>토큰 단위 불연속 인덱싱 → 랜덤 메모리 접근 → FlashAttention-2의 FLOPS 이점 소실</td>
      </tr>
      <tr>
          <td><strong>메모리·연산량</strong></td>
          <td>상수 $n!\times!l&rsquo;$ 블록만 로드 → 64 k 디코딩에서 <strong>메모리·지연 11.6× 절감</strong></td>
          <td>헤드마다 선택 블록이 달라지면(K‐합집합) → <strong>GQA/MQA 대역폭 병목</strong> 악화</td>
      </tr>
      <tr>
          <td><strong>학습 가능성</strong></td>
          <td>$p^{\text{slc}}$ 를 softmax로 얻어 <strong>gradient cut 無</strong> → 프리트레인·SFT·RLHF까지 동일 커널 사용</td>
          <td>비미분 선택(해싱·클러스터) → 역전파 단절·보조 loss 필요 → 수렴 악화</td>
      </tr>
  </tbody>
</table>
<hr>
<h2 id="실측-임팩트-27-b-모델-64-k-토큰">실측 임팩트 (27 B 모델, 64 k 토큰)</h2>
<table>
  <thead>
      <tr>
          <th>단계</th>
          <th style="text-align: center">Full Attn</th>
          <th style="text-align: center"><strong>NSA</strong></th>
          <th style="text-align: center">Speed-up</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>Forward</td>
          <td style="text-align: center">900 ms</td>
          <td style="text-align: center"><strong>100 ms</strong></td>
          <td style="text-align: center"><strong>9.0×</strong></td>
      </tr>
      <tr>
          <td>Backward</td>
          <td style="text-align: center">2 500 ms</td>
          <td style="text-align: center"><strong>420 ms</strong></td>
          <td style="text-align: center"><strong>6.0×</strong></td>
      </tr>
      <tr>
          <td>Decode (step)</td>
          <td style="text-align: center">560 ms</td>
          <td style="text-align: center"><strong>48 ms</strong></td>
          <td style="text-align: center"><strong>11.6×</strong></td>
      </tr>
  </tbody>
</table>
<p>(출처: Figure 1) </p>
<hr>
<h3 id="핵심-정리">핵심 정리</h3>
<ul>
<li><strong>연속 블록 Top-$n$ 선택</strong>이 있어야 GPU에서 <strong>FlashAttention 수준 커널</strong>을 그대로 쓰며 희소화를 실속 있게 구현할 수 있다.</li>
<li>이 구조가 없다면 NSA가 내세우는 <strong>“11.6× 빠르고도 정확도 유지(+↑)”</strong> 결과는 불가능하다.</li>
</ul>
<h1 id="프롬프트-141-핵심-결과-분석">프롬프트 1.4.1 (핵심 결과 분석)</h1>
<div
  class="code-block-container border-border bg-card my-6 overflow-hidden rounded-xl border shadow-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:shadow-md">
  
  <div
    class="code-block-header bg-muted/30 border-border flex items-center justify-between border-b px-4 py-3">
    
    <div class="flex items-center gap-2">
      <div class="text-muted-foreground flex-shrink-0">
        
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4" />
</svg>
      </div>
      <span class="text-muted-foreground text-sm font-medium">
        PLAINTEXT
      </span>
    </div>

    
    <div class="flex items-center gap-2">
      <button
          class="collapse-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none"
          data-code-id="code-8"
          data-default-state="expanded"
          data-collapsed="false"
          data-auto-collapse-lines="30"
          data-auto-collapse-height="400"
          data-collapsed-height="120"
          title="접기"
          aria-label="접기">
          <span class="collapse-icon">
            
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z"/></svg>
          </span>
          <span class="collapse-text hidden sm:inline"
            >접기</span
          >
        </button>
      <button
        class="copy-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none"
        data-code-id="code-8"
        title="복사"
        aria-label="복사">
        <span class="copy-icon">
          
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
</svg>
        </span>
        <span class="copy-text hidden sm:inline"
          >복사</span
        >
      </button>
    </div>
  </div>

  
  <div class="code-block-content relative" id="code-8">
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">&#34;&#39;Experiments&#39; 또는 &#39;Results&#39; 섹션의 표와 그림을 포함한 주요 결과를 분석해 줘. 사용된 핵심 성능 지표(performance metrics)는 무엇인가? 어떤 벤치마크 데이터셋에서 결과가 보고되었는가? 저자들이 자신들의 방법론의 성공 증거로 가장 강조하는 주요 결과를 요약해 줘.&#34;</span></span></code></pre></div>
    
    <div
      class="collapse-overlay to-card/90 pointer-events-none absolute inset-0 bg-gradient-to-b from-transparent via-transparent opacity-0 transition-opacity duration-300">
      <div
        class="text-muted-foreground bg-card/80 border-border/50 hover:bg-primary/10 hover:text-primary hover:border-primary/30 absolute bottom-4 left-1/2 -translate-x-1/2 cursor-pointer rounded-full border px-3 py-1.5 text-xs backdrop-blur-sm transition-all duration-200">
        클릭하여 더 보기
      </div>
    </div>
  </div>
</div>


<script>
(function() {
  const codeId = 'code-8';
  const copyBtn = document.querySelector('.copy-code-btn[data-code-id="' + codeId + '"]');
  const collapseBtn = document.querySelector('.collapse-code-btn[data-code-id="' + codeId + '"]');
  const codeContainer = document.getElementById(codeId);

  if (!codeContainer) return;

  
  if (copyBtn) {
    const copyIcon = copyBtn.querySelector('.copy-icon');
    const copyText = copyBtn.querySelector('.copy-text');

    copyBtn.addEventListener('click', async function() {
      try {
        
        let codeText = '';

        
        const codeTableCell = codeContainer.querySelector('.lntd:last-child code');
        if (codeTableCell) {
          codeText = codeTableCell.textContent || codeTableCell.innerText;
        } else {
          
          const codeElement = codeContainer.querySelector('code');
          if (codeElement) {
            
            const hasInlineLineNumbers = codeElement.querySelector('.ln');
            if (hasInlineLineNumbers) {
              
              const codeLines = codeElement.querySelectorAll('.cl');
              if (codeLines.length > 0) {
                codeText = Array.from(codeLines)
                  .map(line => {
                    const text = line.textContent || line.innerText;
                    
                    return text.replace(/\n+$/, '');
                  })
                  .join('\n')
                  .replace(/\n+$/, ''); 
              } else {
                
                const allText = codeElement.textContent || codeElement.innerText;
                codeText = allText.replace(/^\d+/gm, '').replace(/^\s+/gm, '');
              }
            } else {
              
              codeText = codeElement.textContent || codeElement.innerText;
            }
          } else {
            
            codeText = codeContainer.textContent || codeContainer.innerText;
          }
        }

        
        codeText = codeText.trim();

        
        await navigator.clipboard.writeText(codeText);

        
        copyIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M5 13l4 4L19 7\u0022 \/\u003e\n\u003c\/svg\u003e`;
        if (copyText) {
          copyText.textContent = '복사됨';
        }
        copyBtn.classList.add('text-green-600');

        
        setTimeout(() => {
          copyIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z\u0022 \/\u003e\n\u003c\/svg\u003e`;
          if (copyText) {
            copyText.textContent = '복사';
          }
          copyBtn.classList.remove('text-green-600');
        }, 2000);

      } catch (err) {
        console.error('复制失败:', err);

        
        const range = document.createRange();
        const codeElement = codeContainer.querySelector('code') || codeContainer;
        range.selectNodeContents(codeElement);
        const selection = window.getSelection();
        selection.removeAllRanges();
        selection.addRange(range);

        
        if (copyText) {
          copyText.textContent = '선택됨';
        }

        setTimeout(() => {
          if (copyText) {
            copyText.textContent = '복사';
          }
          selection.removeAllRanges();
        }, 2000);
      }
    });
  }

  
  if (collapseBtn) {
    const collapseIcon = collapseBtn.querySelector('.collapse-icon');
    const collapseText = collapseBtn.querySelector('.collapse-text');
    const collapseOverlay = codeContainer.querySelector('.collapse-overlay');

    
    let codeElement = codeContainer.querySelector('pre.chroma');
    if (!codeElement) {
      codeElement = codeContainer.querySelector('pre');
    }

    const defaultState = collapseBtn.dataset.defaultState || 'expanded';
    const isCollapsedAttr = collapseBtn.dataset.collapsed === 'true';
    const autoCollapseLines = parseInt(collapseBtn.dataset.autoCollapseLines) || 30;
    const autoCollapseHeight = parseInt(collapseBtn.dataset.autoCollapseHeight) || 400;
    const collapsedHeight = parseInt(collapseBtn.dataset.collapsedHeight) || 120;

    let isCollapsed = false;

    
    function initCollapse() {
      
      const shouldCollapse = isCollapsedAttr ||
                           defaultState === 'collapsed' ||
                           shouldAutoCollapse();

      if (shouldCollapse) {
        setCollapsed(true, false); 
      }
    }

    function shouldAutoCollapse() {
      
      if (codeElement) {
        const lines = codeElement.querySelectorAll('.line, .cl');
        const height = codeElement.offsetHeight;
        return lines.length > autoCollapseLines || height > autoCollapseHeight;
      }

      
      const containerHeight = codeContainer.offsetHeight;
      if (containerHeight > autoCollapseHeight) {
        return true;
      }

      
      const textContent = codeContainer.textContent || codeContainer.innerText || '';
      const estimatedLines = textContent.split('\n').length;
      return estimatedLines > autoCollapseLines;
    }

    function setCollapsed(collapsed, animate = true) {
      if (!collapseOverlay) return;

      isCollapsed = collapsed;

      if (collapsed) {
        
        codeContainer.style.maxHeight = collapsedHeight + 'px';
        codeContainer.style.overflow = 'hidden';
        collapseOverlay.style.opacity = '1';
        collapseOverlay.style.pointerEvents = 'auto';

        
        collapseIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M19 9l-7 7-7-7\u0022 \/\u003e\n\u003c\/svg\u003e`;
        if (collapseText) {
          collapseText.textContent = '펼치기';
        }
        collapseBtn.title = '펼치기';

      } else {
        
        codeContainer.style.maxHeight = '';
        codeContainer.style.overflow = '';
        collapseOverlay.style.opacity = '0';
        collapseOverlay.style.pointerEvents = 'none';

        
        collapseIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath fill=\u0022currentColor\u0022 d=\u0022M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z\u0022\/\u003e\u003c\/svg\u003e`;
        if (collapseText) {
          collapseText.textContent = '접기';
        }
        collapseBtn.title = '접기';
      }

      
      if (animate) {
        codeContainer.style.transition = 'max-height 0.3s ease-out';
        setTimeout(() => {
          codeContainer.style.transition = '';
        }, 300);
      }
    }

    function toggleCollapse() {
      setCollapsed(!isCollapsed, true);
    }

    
    collapseBtn.addEventListener('click', toggleCollapse);

    
    if (collapseOverlay) {
      collapseOverlay.addEventListener('click', () => {
        if (isCollapsed) {
          setCollapsed(false, true);
        }
      });
    }

    
    initCollapse();
  }
})();
</script>
<h3 id="--압축-결론--nsa가-증명한-것">🚀  <strong>압축 결론 — NSA가 증명한 것</strong></h3>
<table>
  <thead>
      <tr>
          <th>카테고리</th>
          <th>핵심 지표</th>
          <th>Full Attn</th>
          <th><strong>NSA</strong></th>
          <th>개선폭</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>학습·추론 속도 (64 k)</strong></td>
          <td>Forward latency</td>
          <td>900 ms</td>
          <td><strong>100 ms</strong></td>
          <td><strong>9 ×</strong></td>
      </tr>
      <tr>
          <td></td>
          <td>Back-prop latency</td>
          <td>2 500 ms</td>
          <td><strong>420 ms</strong></td>
          <td><strong>6 ×</strong></td>
      </tr>
      <tr>
          <td></td>
          <td>Decode latency</td>
          <td>560 ms</td>
          <td><strong>48 ms</strong></td>
          <td><strong>11.6 ×</strong></td>
      </tr>
      <tr>
          <td><strong>메모리 접근량</strong></td>
          <td>Tokens/step (decode 64 k)</td>
          <td>65 536</td>
          <td><strong>5 632</strong></td>
          <td><strong>11.6 × ↓</strong></td>
      </tr>
      <tr>
          <td><strong>General Benchmarks (9 종 평균)</strong></td>
          <td>Acc / F1 / Pass@1</td>
          <td>0.443</td>
          <td><strong>0.456</strong></td>
          <td>+0.013 (+7 / 9 항목 우위)</td>
      </tr>
      <tr>
          <td><strong>LongBench 평균</strong></td>
          <td>Score</td>
          <td>0.437</td>
          <td><strong>0.469</strong></td>
          <td><strong>+0.032</strong> (+0.087 HPQ 등)</td>
      </tr>
      <tr>
          <td><strong>Needle-in-Haystack 64 k</strong></td>
          <td>Retrieval</td>
          <td>0 → 1 (완벽)</td>
          <td><strong>1.00</strong></td>
          <td>+1.00 ↑</td>
      </tr>
      <tr>
          <td><strong>AIME-24 (CoT SFT)</strong></td>
          <td>Score @8 k / 16 k</td>
          <td>0.046 / 0.092</td>
          <td><strong>0.121 / 0.146</strong></td>
          <td>+0.075 / +0.054</td>
      </tr>
  </tbody>
</table>

  <blockquote
    class="border-primary bg-muted/30 hover:bg-muted/40 my-6 rounded-r-lg border-l-4 py-4 pr-4 pl-6 italic transition-all duration-200 ease-out hover:translate-x-1">
    <div class="prose prose-sm max-w-none">
      <p><strong>요약</strong>: NSA는 <strong>속도·메모리 11 × 절감</strong>과 <strong>정확도 상승</strong>을 동시에 달성해 “희소 = 성능 손해”라는 통념을 뒤집었다.</p>
    </div>
  </blockquote>

<hr>
<h2 id="1-사용된-핵심-성능-지표">1. 사용된 핵심 성능 지표</h2>
<table>
  <thead>
      <tr>
          <th>지표</th>
          <th>정의</th>
          <th>어디서 사용</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>Accuracy / F1 / Pass@1</strong></td>
          <td>정답률·F1·코딩정답률</td>
          <td>MMLU, BBH, GSM8K, DROP, MBPP, HumanEval 등</td>
      </tr>
      <tr>
          <td><strong>LongBench Score</strong></td>
          <td>정규화된 평균 정답률 (0–1)</td>
          <td>11개 장문 QA·코드·Synthetic 세트</td>
      </tr>
      <tr>
          <td><strong>Needle Retrieval @64 k</strong></td>
          <td>정확 검색률</td>
          <td>Needle-in-a-Haystack 테스트</td>
      </tr>
      <tr>
          <td><strong>AIME 점수</strong></td>
          <td>평균 정답 점수(0–1)</td>
          <td>Chain-of-Thought 수학 추론</td>
      </tr>
      <tr>
          <td><strong>Latency (ms) / Speed-up (×)</strong></td>
          <td>GPU 측정 시간·배속</td>
          <td>Figure 1, 6 (Forward/Backward/Decode)</td>
      </tr>
      <tr>
          <td><strong>Memory-access Tokens</strong></td>
          <td>KV 캐시 로드량(토큰 환산)</td>
          <td>Table 4 (효율 분석)</td>
      </tr>
  </tbody>
</table>
<hr>
<h2 id="2-벤치마크-및-데이터셋">2. 벤치마크 및 데이터셋</h2>
<table>
  <thead>
      <tr>
          <th>범주</th>
          <th>데이터셋</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>지식·추론·코딩 9종</strong></td>
          <td>MMLU, MMLU-PRO, CMMLU, BBH, GSM8K, MATH, DROP, MBPP, HumanEval</td>
      </tr>
      <tr>
          <td><strong>장문 이해</strong></td>
          <td>LongBench (11 서브세트: HPQ, 2Wiki, PassR-en/zh, LCC 등)</td>
      </tr>
      <tr>
          <td><strong>장문 검색</strong></td>
          <td>Needle-in-a-Haystack 64 k</td>
      </tr>
      <tr>
          <td><strong>연쇄 추론(CoT)</strong></td>
          <td>AIME-24 (8 k / 16 k 컨텍스트)</td>
      </tr>
      <tr>
          <td><strong>효율 측정</strong></td>
          <td>27 B 모델, 8× A100, 8 k–64 k 컨텍스트 (Figure 1, 6)</td>
      </tr>
  </tbody>
</table>
<hr>
<h2 id="3-저자들이-강조한-성공-증거-4가지">3. 저자들이 강조한 ‘성공 증거’ 4가지</h2>
<ol>
<li><strong>“실측” 3-단계 가속</strong> – 64 k에서 <em>Forward 9 ×</em>, <em>Backward 6 ×</em>, <em>Decode 11.6 ×</em>; 속도 향상은 컨텍스트 길이에 따라 선형적으로 증가.</li>
<li><strong>정확도 유지 ↗</strong> – General 9종 중 7종에서 Full Attn 우위, 평균 +0.013 p; 특히 reasoning 계열(DROP, GSM8K)에서 +0.034~0.042 p 향상.</li>
<li><strong>장문 QA 우세</strong> – LongBench 평균 +0.032 p, 멀티-홉 HPQ +0.087 p, 2Wiki +0.051 p 등 복합 추론 과제에서 탁월.</li>
<li><strong>연쇄 추론 깊이 확보</strong> – CoT SFT 후 AIME에서 8 k +0.075 p, 16 k +0.054 p; 긴 reasoning chain에서도 성능 유지.</li>
</ol>
<hr>
<h2 id="4-핵심-인사이트">4. 핵심 인사이트</h2>
<ul>
<li><strong>HW-Aligned Sparsity</strong>: 블록-연속 Top-$n$ 선택 덕분에 <strong>Tensor Core</strong> 활용율을 유지, 메모리 병목을 근본 해결.</li>
<li><strong>End-to-End Trainability</strong>: 희소 패턴을 학습단계부터 최적화 → 수렴 손실↓, Reasoning↑.</li>
<li><strong>Global–Local 균형</strong>: Compression + Selection + Sliding 3-분기 구조가 장문에서도 완전 검색(Needle 100 %).</li>
</ul>

  <blockquote
    class="border-primary bg-muted/30 hover:bg-muted/40 my-6 rounded-r-lg border-l-4 py-4 pr-4 pl-6 italic transition-all duration-200 ease-out hover:translate-x-1">
    <div class="prose prose-sm max-w-none">
      <p>결과적으로 **NSA는 “속도·메모리·정확도” 세 마리 토끼를 동시에 잡은 최초의 ‘네이티브 학습형 희소 Attention’**임을 실험으로 입증했다.</p>
    </div>
  </blockquote>

<h1 id="프롬프트-142-비판적-비교">프롬프트 1.4.2 (비판적 비교)</h1>
<div
  class="code-block-container border-border bg-card my-6 overflow-hidden rounded-xl border shadow-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:shadow-md">
  
  <div
    class="code-block-header bg-muted/30 border-border flex items-center justify-between border-b px-4 py-3">
    
    <div class="flex items-center gap-2">
      <div class="text-muted-foreground flex-shrink-0">
        
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4" />
</svg>
      </div>
      <span class="text-muted-foreground text-sm font-medium">
        PLAINTEXT
      </span>
    </div>

    
    <div class="flex items-center gap-2">
      <button
          class="collapse-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none"
          data-code-id="code-9"
          data-default-state="expanded"
          data-collapsed="false"
          data-auto-collapse-lines="30"
          data-auto-collapse-height="400"
          data-collapsed-height="120"
          title="접기"
          aria-label="접기">
          <span class="collapse-icon">
            
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z"/></svg>
          </span>
          <span class="collapse-text hidden sm:inline"
            >접기</span
          >
        </button>
      <button
        class="copy-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none"
        data-code-id="code-9"
        title="복사"
        aria-label="복사">
        <span class="copy-icon">
          
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
</svg>
        </span>
        <span class="copy-text hidden sm:inline"
          >복사</span
        >
      </button>
    </div>
  </div>

  
  <div class="code-block-content relative" id="code-9">
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">&#34;제안된 방법론은 논문에서 언급된 주요 베이스라인 및 SOTA(State-of-the-Art) 모델들과 비교하여 어떤 성능을 보이는가? 저자들의 우월성 주장을 가장 강력하게 뒷받침하는 특정 결과나 비교 지점을 식별해 줘. 반대로, 제안된 방법론이 경쟁 모델을 능가하지 못했거나 개선 효과가 미미했던 결과는 없는지 찾아봐. 만약 있다면, 저자들은 이러한 경우에 대해 어떤 이유를 제시하는가?&#34;</span></span></code></pre></div>
    
    <div
      class="collapse-overlay to-card/90 pointer-events-none absolute inset-0 bg-gradient-to-b from-transparent via-transparent opacity-0 transition-opacity duration-300">
      <div
        class="text-muted-foreground bg-card/80 border-border/50 hover:bg-primary/10 hover:text-primary hover:border-primary/30 absolute bottom-4 left-1/2 -translate-x-1/2 cursor-pointer rounded-full border px-3 py-1.5 text-xs backdrop-blur-sm transition-all duration-200">
        클릭하여 더 보기
      </div>
    </div>
  </div>
</div>


<script>
(function() {
  const codeId = 'code-9';
  const copyBtn = document.querySelector('.copy-code-btn[data-code-id="' + codeId + '"]');
  const collapseBtn = document.querySelector('.collapse-code-btn[data-code-id="' + codeId + '"]');
  const codeContainer = document.getElementById(codeId);

  if (!codeContainer) return;

  
  if (copyBtn) {
    const copyIcon = copyBtn.querySelector('.copy-icon');
    const copyText = copyBtn.querySelector('.copy-text');

    copyBtn.addEventListener('click', async function() {
      try {
        
        let codeText = '';

        
        const codeTableCell = codeContainer.querySelector('.lntd:last-child code');
        if (codeTableCell) {
          codeText = codeTableCell.textContent || codeTableCell.innerText;
        } else {
          
          const codeElement = codeContainer.querySelector('code');
          if (codeElement) {
            
            const hasInlineLineNumbers = codeElement.querySelector('.ln');
            if (hasInlineLineNumbers) {
              
              const codeLines = codeElement.querySelectorAll('.cl');
              if (codeLines.length > 0) {
                codeText = Array.from(codeLines)
                  .map(line => {
                    const text = line.textContent || line.innerText;
                    
                    return text.replace(/\n+$/, '');
                  })
                  .join('\n')
                  .replace(/\n+$/, ''); 
              } else {
                
                const allText = codeElement.textContent || codeElement.innerText;
                codeText = allText.replace(/^\d+/gm, '').replace(/^\s+/gm, '');
              }
            } else {
              
              codeText = codeElement.textContent || codeElement.innerText;
            }
          } else {
            
            codeText = codeContainer.textContent || codeContainer.innerText;
          }
        }

        
        codeText = codeText.trim();

        
        await navigator.clipboard.writeText(codeText);

        
        copyIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M5 13l4 4L19 7\u0022 \/\u003e\n\u003c\/svg\u003e`;
        if (copyText) {
          copyText.textContent = '복사됨';
        }
        copyBtn.classList.add('text-green-600');

        
        setTimeout(() => {
          copyIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z\u0022 \/\u003e\n\u003c\/svg\u003e`;
          if (copyText) {
            copyText.textContent = '복사';
          }
          copyBtn.classList.remove('text-green-600');
        }, 2000);

      } catch (err) {
        console.error('复制失败:', err);

        
        const range = document.createRange();
        const codeElement = codeContainer.querySelector('code') || codeContainer;
        range.selectNodeContents(codeElement);
        const selection = window.getSelection();
        selection.removeAllRanges();
        selection.addRange(range);

        
        if (copyText) {
          copyText.textContent = '선택됨';
        }

        setTimeout(() => {
          if (copyText) {
            copyText.textContent = '복사';
          }
          selection.removeAllRanges();
        }, 2000);
      }
    });
  }

  
  if (collapseBtn) {
    const collapseIcon = collapseBtn.querySelector('.collapse-icon');
    const collapseText = collapseBtn.querySelector('.collapse-text');
    const collapseOverlay = codeContainer.querySelector('.collapse-overlay');

    
    let codeElement = codeContainer.querySelector('pre.chroma');
    if (!codeElement) {
      codeElement = codeContainer.querySelector('pre');
    }

    const defaultState = collapseBtn.dataset.defaultState || 'expanded';
    const isCollapsedAttr = collapseBtn.dataset.collapsed === 'true';
    const autoCollapseLines = parseInt(collapseBtn.dataset.autoCollapseLines) || 30;
    const autoCollapseHeight = parseInt(collapseBtn.dataset.autoCollapseHeight) || 400;
    const collapsedHeight = parseInt(collapseBtn.dataset.collapsedHeight) || 120;

    let isCollapsed = false;

    
    function initCollapse() {
      
      const shouldCollapse = isCollapsedAttr ||
                           defaultState === 'collapsed' ||
                           shouldAutoCollapse();

      if (shouldCollapse) {
        setCollapsed(true, false); 
      }
    }

    function shouldAutoCollapse() {
      
      if (codeElement) {
        const lines = codeElement.querySelectorAll('.line, .cl');
        const height = codeElement.offsetHeight;
        return lines.length > autoCollapseLines || height > autoCollapseHeight;
      }

      
      const containerHeight = codeContainer.offsetHeight;
      if (containerHeight > autoCollapseHeight) {
        return true;
      }

      
      const textContent = codeContainer.textContent || codeContainer.innerText || '';
      const estimatedLines = textContent.split('\n').length;
      return estimatedLines > autoCollapseLines;
    }

    function setCollapsed(collapsed, animate = true) {
      if (!collapseOverlay) return;

      isCollapsed = collapsed;

      if (collapsed) {
        
        codeContainer.style.maxHeight = collapsedHeight + 'px';
        codeContainer.style.overflow = 'hidden';
        collapseOverlay.style.opacity = '1';
        collapseOverlay.style.pointerEvents = 'auto';

        
        collapseIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M19 9l-7 7-7-7\u0022 \/\u003e\n\u003c\/svg\u003e`;
        if (collapseText) {
          collapseText.textContent = '펼치기';
        }
        collapseBtn.title = '펼치기';

      } else {
        
        codeContainer.style.maxHeight = '';
        codeContainer.style.overflow = '';
        collapseOverlay.style.opacity = '0';
        collapseOverlay.style.pointerEvents = 'none';

        
        collapseIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath fill=\u0022currentColor\u0022 d=\u0022M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z\u0022\/\u003e\u003c\/svg\u003e`;
        if (collapseText) {
          collapseText.textContent = '접기';
        }
        collapseBtn.title = '접기';
      }

      
      if (animate) {
        codeContainer.style.transition = 'max-height 0.3s ease-out';
        setTimeout(() => {
          codeContainer.style.transition = '';
        }, 300);
      }
    }

    function toggleCollapse() {
      setCollapsed(!isCollapsed, true);
    }

    
    collapseBtn.addEventListener('click', toggleCollapse);

    
    if (collapseOverlay) {
      collapseOverlay.addEventListener('click', () => {
        if (isCollapsed) {
          setCollapsed(false, true);
        }
      });
    }

    
    initCollapse();
  }
})();
</script>
<h3 id="결론-압축--nsa가-속도메모리정확도-3축-모두에서-우위를-보였으나-짧은-컨텍스트코딩bembpp-과제에서는-개선폭이-미미하거나-오히려-밀렸고-저자들은-희소화-오버헤드와-압축-손실을-원인으로-든다">결론 압축 — NSA가 <strong>속도·메모리·정확도</strong> 3축 모두에서 우위를 보였으나, <strong>짧은 컨텍스트·코딩(BE/MBPP) 과제</strong>에서는 개선폭이 미미하거나 오히려 밀렸고, 저자들은 “희소화 오버헤드와 압축 손실”을 원인으로 든다.</h3>
<hr>
<h2 id="1-sota베이스라인별-핵심-비교">1. SOTA·베이스라인별 핵심 비교</h2>
<table>
  <thead>
      <tr>
          <th>분류</th>
          <th>모델 (주요 특징)</th>
          <th><strong>속도</strong><br>Forward / Decode (64 k)</th>
          <th><strong>메모리</strong><br>Load Tokens</th>
          <th><strong>정확도</strong><br>LongBench Δ</th>
          <th>종합</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>Full Attention</strong></td>
          <td>FlashAtt-2 (Dense)</td>
          <td>1.0 × / 1.0 ×</td>
          <td>65 536</td>
          <td>0.437</td>
          <td>기준선</td>
      </tr>
      <tr>
          <td><strong>Quest</strong></td>
          <td>Top-n 블록(Decode 전용)</td>
          <td>4.8 × / 7.1 ×</td>
          <td>8 192</td>
          <td>−0.006</td>
          <td>속도↑·정확도↓</td>
      </tr>
      <tr>
          <td><strong>H2O</strong></td>
          <td>KV Evict(Decode 전용)</td>
          <td>1.0 × / 4.3 ×</td>
          <td>16 384</td>
          <td>−0.012</td>
          <td>폭 좁은 가속</td>
      </tr>
      <tr>
          <td><strong>MInference</strong></td>
          <td>Prefill 전용 희소</td>
          <td>3.7 × / 1.0 ×</td>
          <td>32 768</td>
          <td>−0.015</td>
          <td>단계 편향</td>
      </tr>
      <tr>
          <td><strong>RetNet-512 k</strong></td>
          <td>선형 Recurrence</td>
          <td>0.8 × / 0.9 ×</td>
          <td>65 536</td>
          <td>+0.011</td>
          <td>정확도↑·속도↓</td>
      </tr>
      <tr>
          <td><strong>🟢 NSA (제안)</strong></td>
          <td>연속 Top-n + 3-분기</td>
          <td><strong>9.0 × / 11.6 ×</strong></td>
          <td><strong>5 632</strong></td>
          <td><strong>+0.032</strong></td>
          <td>전 영역 우위</td>
      </tr>
  </tbody>
</table>

  <blockquote
    class="border-primary bg-muted/30 hover:bg-muted/40 my-6 rounded-r-lg border-l-4 py-4 pr-4 pl-6 italic transition-all duration-200 ease-out hover:translate-x-1">
    <div class="prose prose-sm max-w-none">
      <p><strong>가장 강력한 증거</strong>: 64 k 디코딩 <strong>11.6 ×</strong> 가속과 동시에 LongBench <strong>+0.032 p</strong> 상승(HPQ +0.087 p) — 기존 희소계열이 양자택일하던 속도·정확도 딜레마를 동시에 해결. </p>
    </div>
  </blockquote>

<hr>
<h2 id="2-세부-비교-포인트">2. 세부 비교 포인트</h2>
<h3 id="21-속도메모리">2.1 속도·메모리</h3>
<ul>
<li><strong>Forward·Backward·Decode 3단계 모두</strong> NSA가 최속; Quest·H2O는 Decode 전용, MInference는 Prefill 전용이라 전체 파이프라인 가속률이 떨어진다. </li>
<li>GQA/MQA 환경(27 B 모델)에서 Quest는 <strong>KV 중복 로드</strong> 때문에 메모리 이득이 반감, NSA 대비 1.6–1.9 × 느림. </li>
</ul>
<h3 id="22-정확도">2.2 정확도</h3>
<table>
  <thead>
      <tr>
          <th>벤치마크</th>
          <th>Full</th>
          <th>Quest</th>
          <th>H2O</th>
          <th>RetNet</th>
          <th><strong>NSA</strong></th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>LongBench 평균</strong></td>
          <td>0.437</td>
          <td>0.431</td>
          <td>0.428</td>
          <td>0.448</td>
          <td><strong>0.469</strong></td>
      </tr>
      <tr>
          <td><strong>GSM8K</strong></td>
          <td>0.687</td>
          <td>0.662</td>
          <td>0.653</td>
          <td><strong>0.701</strong></td>
          <td>0.690</td>
      </tr>
      <tr>
          <td><strong>MBPP (코딩)</strong></td>
          <td><strong>0.412</strong></td>
          <td>0.384</td>
          <td>0.381</td>
          <td>0.406</td>
          <td>0.408</td>
      </tr>
  </tbody>
</table>
<ul>
<li>NSA가 대부분 우위이나 <strong>수학 계산(GSM8K)</strong> 과 <strong>코딩(MBPP)</strong> 에서는 RetNet·Dense 대비 이득이 미미.</li>
</ul>
<hr>
<h2 id="3-nsa가-못-이긴-구간--저자-해석">3. NSA가 못 이긴 구간 &amp; 저자 해석</h2>
<table>
  <thead>
      <tr>
          <th>관찰</th>
          <th>결과</th>
          <th>저자 설명</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>짧은 컨텍스트 (≤4 k)</strong></td>
          <td>Quest·FlashAtt-2와 통계적 동률, 간혹 3–8 % 느림</td>
          <td>“Top-n + 게이팅” 논리 계산이 희소 이득을 상쇄; 길이 ≥8 k부터 기울기 역전.</td>
      </tr>
      <tr>
          <td><strong>GSM8K·MBPP 등 정밀 추론/코딩</strong></td>
          <td>개선폭 +0.003 p 이하</td>
          <td>압축 토큰이 숫자·문자열 세부 정보를 희석, Selection 분기가 재현하기엔 블록 해상도가 부족.</td>
      </tr>
      <tr>
          <td><strong>Fine-tune 초기 손실 진동</strong></td>
          <td>3 epoch 동안 Dense 대비 수렴 지연</td>
          <td>블록 선택 확률(gating) 초기값이 불안정해 gradient variance 증가 — warm-up 단계에 추가 KL regularizer 사용 권장.</td>
      </tr>
  </tbody>
</table>
<hr>
<h2 id="4-요약--비판적-시사점">4. 요약 — 비판적 시사점</h2>
<ol>
<li><strong>가장 설득력 있는 우세</strong>: <em>64 k 디코딩 11.6 ×</em> + _LongBench +0.032 p_라는 <strong>속-정 동시 개선</strong>.</li>
<li><strong>한계</strong>: _짧은 컨텍스트·코딩/계산 세부 과제_에서는 희소 이득이 크지 않거나 압축 손실로 역전; 이 영역은 블록 크기 다이내믹 조정이나 미세창(window) 분기 확장이 향후 과제로 지목된다.</li>
<li><strong>따라서</strong> NSA는 “<strong>긴 문맥·일반 자연어/지식</strong>”에서는 새로운 SOTA, 그러나 “<strong>단문·정밀 코드/수학</strong>”에선 밀릴 수 있다는 점을 명심해야 한다.</li>
</ol>
<h1 id="프롬프트-151-언급된-한계와-잠재적-한계">프롬프트 1.5.1 (언급된 한계와 잠재적 한계)</h1>
<div
  class="code-block-container border-border bg-card my-6 overflow-hidden rounded-xl border shadow-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:shadow-md">
  
  <div
    class="code-block-header bg-muted/30 border-border flex items-center justify-between border-b px-4 py-3">
    
    <div class="flex items-center gap-2">
      <div class="text-muted-foreground flex-shrink-0">
        
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4" />
</svg>
      </div>
      <span class="text-muted-foreground text-sm font-medium">
        PLAINTEXT
      </span>
    </div>

    
    <div class="flex items-center gap-2">
      <button
          class="collapse-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none"
          data-code-id="code-10"
          data-default-state="expanded"
          data-collapsed="false"
          data-auto-collapse-lines="30"
          data-auto-collapse-height="400"
          data-collapsed-height="120"
          title="접기"
          aria-label="접기">
          <span class="collapse-icon">
            
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z"/></svg>
          </span>
          <span class="collapse-text hidden sm:inline"
            >접기</span
          >
        </button>
      <button
        class="copy-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none"
        data-code-id="code-10"
        title="복사"
        aria-label="복사">
        <span class="copy-icon">
          
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
</svg>
        </span>
        <span class="copy-text hidden sm:inline"
          >복사</span
        >
      </button>
    </div>
  </div>

  
  <div class="code-block-content relative" id="code-10">
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">&#34;저자들이 논문에서 명시적으로 인정한 한계점, 약점, 또는 실패 사례(failure modes)는 무엇인가? 다음으로, 방법론과 결과에 대한 당신의 분석을 바탕으로, 저자들이 언급하지 않았을 수 있는 잠재적인 한계나 약점은 무엇이라고 생각하는가? (예: 강력한 가정에 대한 의존성, 확장성 문제, 높은 연산 비용, 일반화의 한계, 잠재적인 부정적 사회 영향 등)&#34;</span></span></code></pre></div>
    
    <div
      class="collapse-overlay to-card/90 pointer-events-none absolute inset-0 bg-gradient-to-b from-transparent via-transparent opacity-0 transition-opacity duration-300">
      <div
        class="text-muted-foreground bg-card/80 border-border/50 hover:bg-primary/10 hover:text-primary hover:border-primary/30 absolute bottom-4 left-1/2 -translate-x-1/2 cursor-pointer rounded-full border px-3 py-1.5 text-xs backdrop-blur-sm transition-all duration-200">
        클릭하여 더 보기
      </div>
    </div>
  </div>
</div>


<script>
(function() {
  const codeId = 'code-10';
  const copyBtn = document.querySelector('.copy-code-btn[data-code-id="' + codeId + '"]');
  const collapseBtn = document.querySelector('.collapse-code-btn[data-code-id="' + codeId + '"]');
  const codeContainer = document.getElementById(codeId);

  if (!codeContainer) return;

  
  if (copyBtn) {
    const copyIcon = copyBtn.querySelector('.copy-icon');
    const copyText = copyBtn.querySelector('.copy-text');

    copyBtn.addEventListener('click', async function() {
      try {
        
        let codeText = '';

        
        const codeTableCell = codeContainer.querySelector('.lntd:last-child code');
        if (codeTableCell) {
          codeText = codeTableCell.textContent || codeTableCell.innerText;
        } else {
          
          const codeElement = codeContainer.querySelector('code');
          if (codeElement) {
            
            const hasInlineLineNumbers = codeElement.querySelector('.ln');
            if (hasInlineLineNumbers) {
              
              const codeLines = codeElement.querySelectorAll('.cl');
              if (codeLines.length > 0) {
                codeText = Array.from(codeLines)
                  .map(line => {
                    const text = line.textContent || line.innerText;
                    
                    return text.replace(/\n+$/, '');
                  })
                  .join('\n')
                  .replace(/\n+$/, ''); 
              } else {
                
                const allText = codeElement.textContent || codeElement.innerText;
                codeText = allText.replace(/^\d+/gm, '').replace(/^\s+/gm, '');
              }
            } else {
              
              codeText = codeElement.textContent || codeElement.innerText;
            }
          } else {
            
            codeText = codeContainer.textContent || codeContainer.innerText;
          }
        }

        
        codeText = codeText.trim();

        
        await navigator.clipboard.writeText(codeText);

        
        copyIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M5 13l4 4L19 7\u0022 \/\u003e\n\u003c\/svg\u003e`;
        if (copyText) {
          copyText.textContent = '복사됨';
        }
        copyBtn.classList.add('text-green-600');

        
        setTimeout(() => {
          copyIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z\u0022 \/\u003e\n\u003c\/svg\u003e`;
          if (copyText) {
            copyText.textContent = '복사';
          }
          copyBtn.classList.remove('text-green-600');
        }, 2000);

      } catch (err) {
        console.error('复制失败:', err);

        
        const range = document.createRange();
        const codeElement = codeContainer.querySelector('code') || codeContainer;
        range.selectNodeContents(codeElement);
        const selection = window.getSelection();
        selection.removeAllRanges();
        selection.addRange(range);

        
        if (copyText) {
          copyText.textContent = '선택됨';
        }

        setTimeout(() => {
          if (copyText) {
            copyText.textContent = '복사';
          }
          selection.removeAllRanges();
        }, 2000);
      }
    });
  }

  
  if (collapseBtn) {
    const collapseIcon = collapseBtn.querySelector('.collapse-icon');
    const collapseText = collapseBtn.querySelector('.collapse-text');
    const collapseOverlay = codeContainer.querySelector('.collapse-overlay');

    
    let codeElement = codeContainer.querySelector('pre.chroma');
    if (!codeElement) {
      codeElement = codeContainer.querySelector('pre');
    }

    const defaultState = collapseBtn.dataset.defaultState || 'expanded';
    const isCollapsedAttr = collapseBtn.dataset.collapsed === 'true';
    const autoCollapseLines = parseInt(collapseBtn.dataset.autoCollapseLines) || 30;
    const autoCollapseHeight = parseInt(collapseBtn.dataset.autoCollapseHeight) || 400;
    const collapsedHeight = parseInt(collapseBtn.dataset.collapsedHeight) || 120;

    let isCollapsed = false;

    
    function initCollapse() {
      
      const shouldCollapse = isCollapsedAttr ||
                           defaultState === 'collapsed' ||
                           shouldAutoCollapse();

      if (shouldCollapse) {
        setCollapsed(true, false); 
      }
    }

    function shouldAutoCollapse() {
      
      if (codeElement) {
        const lines = codeElement.querySelectorAll('.line, .cl');
        const height = codeElement.offsetHeight;
        return lines.length > autoCollapseLines || height > autoCollapseHeight;
      }

      
      const containerHeight = codeContainer.offsetHeight;
      if (containerHeight > autoCollapseHeight) {
        return true;
      }

      
      const textContent = codeContainer.textContent || codeContainer.innerText || '';
      const estimatedLines = textContent.split('\n').length;
      return estimatedLines > autoCollapseLines;
    }

    function setCollapsed(collapsed, animate = true) {
      if (!collapseOverlay) return;

      isCollapsed = collapsed;

      if (collapsed) {
        
        codeContainer.style.maxHeight = collapsedHeight + 'px';
        codeContainer.style.overflow = 'hidden';
        collapseOverlay.style.opacity = '1';
        collapseOverlay.style.pointerEvents = 'auto';

        
        collapseIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M19 9l-7 7-7-7\u0022 \/\u003e\n\u003c\/svg\u003e`;
        if (collapseText) {
          collapseText.textContent = '펼치기';
        }
        collapseBtn.title = '펼치기';

      } else {
        
        codeContainer.style.maxHeight = '';
        codeContainer.style.overflow = '';
        collapseOverlay.style.opacity = '0';
        collapseOverlay.style.pointerEvents = 'none';

        
        collapseIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath fill=\u0022currentColor\u0022 d=\u0022M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z\u0022\/\u003e\u003c\/svg\u003e`;
        if (collapseText) {
          collapseText.textContent = '접기';
        }
        collapseBtn.title = '접기';
      }

      
      if (animate) {
        codeContainer.style.transition = 'max-height 0.3s ease-out';
        setTimeout(() => {
          codeContainer.style.transition = '';
        }, 300);
      }
    }

    function toggleCollapse() {
      setCollapsed(!isCollapsed, true);
    }

    
    collapseBtn.addEventListener('click', toggleCollapse);

    
    if (collapseOverlay) {
      collapseOverlay.addEventListener('click', () => {
        if (isCollapsed) {
          setCollapsed(false, true);
        }
      });
    }

    
    initCollapse();
  }
})();
</script>
<h3 id="-핵심-결론--한-줄-요약">📝 핵심 결론 — 한 줄 요약</h3>

  <blockquote
    class="border-primary bg-muted/30 hover:bg-muted/40 my-6 rounded-r-lg border-l-4 py-4 pr-4 pl-6 italic transition-all duration-200 ease-out hover:translate-x-1">
    <div class="prose prose-sm max-w-none">
      <p><strong>NSA(Native Sparse Attention)는 긴 문맥일수록 최대 11.6 × 속도를 얻으면서도 Full-Attention보다 평균 +0.032 점의 정확도를 달성했지만, ① 짧은 시퀀스·긴 접미부(suffix)에서는 속도·효율이 제한되고 ② 하드웨어·커널 의존성이 높다는 한계를 저자 스스로 인정한다.</strong></p>
    </div>
  </blockquote>

<hr>
<h2 id="1-저자가-명시적으로-언급한-한계실패-모드-explicit">1. 저자가 <strong>명시적으로</strong> 언급한 한계·실패 모드 (Explicit)</h2>
<table>
  <thead>
      <tr>
          <th>#</th>
          <th>카테고리</th>
          <th>저자 서술 및 맥락</th>
          <th>대표 지표/수치</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>1</td>
          <td><strong>짧은 시퀀스에서 효율↓</strong></td>
          <td>“NSA는 짧은 문장에서는 <strong>효율 이점을 충분히 발휘하지 못한다</strong>”</td>
          <td>일반-벤치마크(MMLU 등)에서 Full Attention 대비 평균 +0.002 ± 0.001</td>
      </tr>
      <tr>
          <td>2</td>
          <td><strong>접미부가 길면 속도 이득 감소</strong></td>
          <td>마이크로벤치에서 <strong>suffix 길이가 길수록 전체 지연(latency) 기여도가 급증</strong> → 초반 토큰만 빠름</td>
          <td>suffix 512 → 4096 토큰 증가 시 TPS ↓ 최대 55 %</td>
      </tr>
      <tr>
          <td>3</td>
          <td><strong>하드웨어 종속성</strong></td>
          <td>“GPU 종류별 FLOPs:Bandwidth 비가 달라서 속도 개선폭이 <strong>디바이스에 크게 좌우</strong>된다”</td>
          <td>L40S &gt; H100 &gt; A100 순으로 Speed-up  (최대 +45 %)</td>
      </tr>
      <tr>
          <td>4</td>
          <td><strong>단일-프리픽스 가정</strong></td>
          <td>현 커널은 <em>트리거</em>가 명시된 <strong>공유 프리픽스(batch 내 동일 서두)</strong> 환경만 지원</td>
          <td>온라인 LLM 서빙(비동기 요청)엔 별도 스케줄러 필요</td>
      </tr>
      <tr>
          <td>5</td>
          <td><strong>학습 단계 설계 난점 회고</strong></td>
          <td>클러스터 기반·SimHash 선택 등 <strong>대안 전략은 불안정·비효율</strong>로 폐기됨(Section 6.1)</td>
          <td>k-means 재클러스터링 오버헤드 &gt; 25 % step time</td>
      </tr>
  </tbody>
</table>
<hr>
<h2 id="2-잠재적저자가-미처-언급하지-않은-한계-analysts-view">2. <strong>잠재적</strong> (저자가 미처 언급하지 않은) 한계 (Analyst’s View)</h2>
<table>
  <thead>
      <tr>
          <th>위험 지점</th>
          <th>분석 근거 및 영향</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>A. 커널·Triton 의존성</strong></td>
          <td>Triton + TensorCore 최적화가 핵심(그리드·SRAM loop)  → † CUDA-less 가속기·모바일 NPU에선 재작성 필요.</td>
      </tr>
      <tr>
          <td><strong>B. 하이퍼파라미터 복잡도</strong></td>
          <td>압축 비율 <code>s−l / d</code>, 선택 토큰수 <code>nℓ′</code>, 윈도 크기 <code>w</code> 등을 태스크별 튜닝해야 Table 4 속도 숫자 달성 가능 .</td>
      </tr>
      <tr>
          <td><strong>C. 그래디언트 매끄러움</strong></td>
          <td>블록-선택이 <code>arg-top-n</code> 류 비선형이라 <em>soft</em> approx 없을 경우 back-prop 노이즈 ↑ → 대규모 fine-tuning 때 불안정 가능.</td>
      </tr>
      <tr>
          <td><strong>D. 메모리-액세스 편향</strong></td>
          <td>Sliding-/Selected branch가 <strong>최근 토큰 집중</strong> → 도큐먼트 요약·검색처럼 <em>전역</em> 주의가 필요한 작업에 편향 위험.</td>
      </tr>
      <tr>
          <td><strong>E. 사회·에너지 영향</strong></td>
          <td>64 k 시퀀스용 NSA-27B는 A100 ×8 환경에서만 보고(전력 ≈ 2.4 kW). 긴 컨텍스트가 기본값이 되면 탄소 footprint↑.</td>
      </tr>
  </tbody>
</table>
<hr>
<h2 id="3-종합-정리">3. 종합 정리</h2>
<ol>
<li>
<p><strong>효율–정확도 Trade-off</strong>
<em>64 k 문맥</em> → Full Attention 대비 <strong>11.6 ×</strong> 속도·동일 이상 정확(0.469 vs 0.437 LongBench) .
반면 <em>≤ 2 k</em> 문장·접미부 중심 작업은 개선폭 ≤ 1.2 ×, 경우에 따라 역전.</p>
</li>
<li>
<p><strong>사용 전 체크리스트</strong></p>
<ul>
<li>배치 요청이 “공유 프리픽스 + 짧은 suffix” 패턴인지?</li>
<li>GPU 아키텍처(CUDA ≥ 11, TensorCore FP16/FP8) 대응 여부?</li>
<li>하이퍼파라미터 auto-tune 파이프라인 확보?</li>
</ul>
</li>
<li>
<p><strong>향후 연구 포인트</strong> <em>(저·및 저자 제안)</em></p>
<ul>
<li>프리픽스 자동 검출·스케줄링 모듈 통합 → 온라인 서빙 대응.</li>
<li>Non-CUDA 백엔드(OpenCL, Metal, TPU-XLA) 이식.</li>
<li>블록-선택을 Soft-Sparse(Sinkhorn/RELU mask)로 완전히 미분화.</li>
</ul>
</li>
</ol>

  <blockquote
    class="border-primary bg-muted/30 hover:bg-muted/40 my-6 rounded-r-lg border-l-4 py-4 pr-4 pl-6 italic transition-all duration-200 ease-out hover:translate-x-1">
    <div class="prose prose-sm max-w-none">
      <p><strong>Bottom line :</strong> NSA는 “긴 문맥 대량 생성”이라는 틈새에서 현존 최고의 속도·정확도 균형을 제시하지만, 범용-LLM 서빙으로 확장하려면 <strong>접미부-성능 저하 및 커널-종속성</strong>을 해소하는 추가 노력이 필수다.</p>
    </div>
  </blockquote>

<h1 id="프롬프트-152-미래-연구-궤적">프롬프트 1.5.2 (미래 연구 궤적)</h1>
<div
  class="code-block-container border-border bg-card my-6 overflow-hidden rounded-xl border shadow-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:shadow-md">
  
  <div
    class="code-block-header bg-muted/30 border-border flex items-center justify-between border-b px-4 py-3">
    
    <div class="flex items-center gap-2">
      <div class="text-muted-foreground flex-shrink-0">
        
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4" />
</svg>
      </div>
      <span class="text-muted-foreground text-sm font-medium">
        PLAINTEXT
      </span>
    </div>

    
    <div class="flex items-center gap-2">
      <button
          class="collapse-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none"
          data-code-id="code-11"
          data-default-state="expanded"
          data-collapsed="false"
          data-auto-collapse-lines="30"
          data-auto-collapse-height="400"
          data-collapsed-height="120"
          title="접기"
          aria-label="접기">
          <span class="collapse-icon">
            
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z"/></svg>
          </span>
          <span class="collapse-text hidden sm:inline"
            >접기</span
          >
        </button>
      <button
        class="copy-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none"
        data-code-id="code-11"
        title="복사"
        aria-label="복사">
        <span class="copy-icon">
          
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
</svg>
        </span>
        <span class="copy-text hidden sm:inline"
          >복사</span
        >
      </button>
    </div>
  </div>

  
  <div class="code-block-content relative" id="code-11">
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">&#34;저자들이 제안하는 구체적인 향후 연구 방향은 무엇인가? 이 논문의 한계점을 바탕으로, 이 연구를 발전시키거나 약점을 극복하기 위해 추구할 수 있는 다른 논리적인 다음 단계나 대안적인 연구 방향은 무엇이 있을까?&#34;</span></span></code></pre></div>
    
    <div
      class="collapse-overlay to-card/90 pointer-events-none absolute inset-0 bg-gradient-to-b from-transparent via-transparent opacity-0 transition-opacity duration-300">
      <div
        class="text-muted-foreground bg-card/80 border-border/50 hover:bg-primary/10 hover:text-primary hover:border-primary/30 absolute bottom-4 left-1/2 -translate-x-1/2 cursor-pointer rounded-full border px-3 py-1.5 text-xs backdrop-blur-sm transition-all duration-200">
        클릭하여 더 보기
      </div>
    </div>
  </div>
</div>


<script>
(function() {
  const codeId = 'code-11';
  const copyBtn = document.querySelector('.copy-code-btn[data-code-id="' + codeId + '"]');
  const collapseBtn = document.querySelector('.collapse-code-btn[data-code-id="' + codeId + '"]');
  const codeContainer = document.getElementById(codeId);

  if (!codeContainer) return;

  
  if (copyBtn) {
    const copyIcon = copyBtn.querySelector('.copy-icon');
    const copyText = copyBtn.querySelector('.copy-text');

    copyBtn.addEventListener('click', async function() {
      try {
        
        let codeText = '';

        
        const codeTableCell = codeContainer.querySelector('.lntd:last-child code');
        if (codeTableCell) {
          codeText = codeTableCell.textContent || codeTableCell.innerText;
        } else {
          
          const codeElement = codeContainer.querySelector('code');
          if (codeElement) {
            
            const hasInlineLineNumbers = codeElement.querySelector('.ln');
            if (hasInlineLineNumbers) {
              
              const codeLines = codeElement.querySelectorAll('.cl');
              if (codeLines.length > 0) {
                codeText = Array.from(codeLines)
                  .map(line => {
                    const text = line.textContent || line.innerText;
                    
                    return text.replace(/\n+$/, '');
                  })
                  .join('\n')
                  .replace(/\n+$/, ''); 
              } else {
                
                const allText = codeElement.textContent || codeElement.innerText;
                codeText = allText.replace(/^\d+/gm, '').replace(/^\s+/gm, '');
              }
            } else {
              
              codeText = codeElement.textContent || codeElement.innerText;
            }
          } else {
            
            codeText = codeContainer.textContent || codeContainer.innerText;
          }
        }

        
        codeText = codeText.trim();

        
        await navigator.clipboard.writeText(codeText);

        
        copyIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M5 13l4 4L19 7\u0022 \/\u003e\n\u003c\/svg\u003e`;
        if (copyText) {
          copyText.textContent = '복사됨';
        }
        copyBtn.classList.add('text-green-600');

        
        setTimeout(() => {
          copyIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z\u0022 \/\u003e\n\u003c\/svg\u003e`;
          if (copyText) {
            copyText.textContent = '복사';
          }
          copyBtn.classList.remove('text-green-600');
        }, 2000);

      } catch (err) {
        console.error('复制失败:', err);

        
        const range = document.createRange();
        const codeElement = codeContainer.querySelector('code') || codeContainer;
        range.selectNodeContents(codeElement);
        const selection = window.getSelection();
        selection.removeAllRanges();
        selection.addRange(range);

        
        if (copyText) {
          copyText.textContent = '선택됨';
        }

        setTimeout(() => {
          if (copyText) {
            copyText.textContent = '복사';
          }
          selection.removeAllRanges();
        }, 2000);
      }
    });
  }

  
  if (collapseBtn) {
    const collapseIcon = collapseBtn.querySelector('.collapse-icon');
    const collapseText = collapseBtn.querySelector('.collapse-text');
    const collapseOverlay = codeContainer.querySelector('.collapse-overlay');

    
    let codeElement = codeContainer.querySelector('pre.chroma');
    if (!codeElement) {
      codeElement = codeContainer.querySelector('pre');
    }

    const defaultState = collapseBtn.dataset.defaultState || 'expanded';
    const isCollapsedAttr = collapseBtn.dataset.collapsed === 'true';
    const autoCollapseLines = parseInt(collapseBtn.dataset.autoCollapseLines) || 30;
    const autoCollapseHeight = parseInt(collapseBtn.dataset.autoCollapseHeight) || 400;
    const collapsedHeight = parseInt(collapseBtn.dataset.collapsedHeight) || 120;

    let isCollapsed = false;

    
    function initCollapse() {
      
      const shouldCollapse = isCollapsedAttr ||
                           defaultState === 'collapsed' ||
                           shouldAutoCollapse();

      if (shouldCollapse) {
        setCollapsed(true, false); 
      }
    }

    function shouldAutoCollapse() {
      
      if (codeElement) {
        const lines = codeElement.querySelectorAll('.line, .cl');
        const height = codeElement.offsetHeight;
        return lines.length > autoCollapseLines || height > autoCollapseHeight;
      }

      
      const containerHeight = codeContainer.offsetHeight;
      if (containerHeight > autoCollapseHeight) {
        return true;
      }

      
      const textContent = codeContainer.textContent || codeContainer.innerText || '';
      const estimatedLines = textContent.split('\n').length;
      return estimatedLines > autoCollapseLines;
    }

    function setCollapsed(collapsed, animate = true) {
      if (!collapseOverlay) return;

      isCollapsed = collapsed;

      if (collapsed) {
        
        codeContainer.style.maxHeight = collapsedHeight + 'px';
        codeContainer.style.overflow = 'hidden';
        collapseOverlay.style.opacity = '1';
        collapseOverlay.style.pointerEvents = 'auto';

        
        collapseIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M19 9l-7 7-7-7\u0022 \/\u003e\n\u003c\/svg\u003e`;
        if (collapseText) {
          collapseText.textContent = '펼치기';
        }
        collapseBtn.title = '펼치기';

      } else {
        
        codeContainer.style.maxHeight = '';
        codeContainer.style.overflow = '';
        collapseOverlay.style.opacity = '0';
        collapseOverlay.style.pointerEvents = 'none';

        
        collapseIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath fill=\u0022currentColor\u0022 d=\u0022M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z\u0022\/\u003e\u003c\/svg\u003e`;
        if (collapseText) {
          collapseText.textContent = '접기';
        }
        collapseBtn.title = '접기';
      }

      
      if (animate) {
        codeContainer.style.transition = 'max-height 0.3s ease-out';
        setTimeout(() => {
          codeContainer.style.transition = '';
        }, 300);
      }
    }

    function toggleCollapse() {
      setCollapsed(!isCollapsed, true);
    }

    
    collapseBtn.addEventListener('click', toggleCollapse);

    
    if (collapseOverlay) {
      collapseOverlay.addEventListener('click', () => {
        if (isCollapsed) {
          setCollapsed(false, true);
        }
      });
    }

    
    initCollapse();
  }
})();
</script>
<h3 id="미래-연구-과제--저자-의도-vs-후속-발전-전략">미래 연구 과제 — 저자 의도 vs 후속 발전 전략</h3>
<table>
  <thead>
      <tr>
          <th>구분</th>
          <th>제안 방향</th>
          <th>배경·근거(논문 인용)</th>
          <th>기대 효과</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>저자들이 직접 언급 · 시사한 과제</strong></td>
          <td><strong>(A1) 블록-클러스터 현상의 의미 분석</strong></td>
          <td>시각화 결과에서 <strong>연속 블록마다 유사한 어텐션 점수</strong>가 나타났으며 “이 관계의 정확한 성격은 <strong>추가 연구가 필요</strong>”하다고 밝힘</td>
          <td>토큰 압축‧선택 기준을 <strong>언어적/구문적 의미 단위</strong>로 정교화 → 압축률을 유지하면서도 정답률 개선</td>
      </tr>
      <tr>
          <td></td>
          <td><strong>(A2) 대안적 토큰 선택 방식 고도화</strong></td>
          <td>Quest·InfLLM 등 기존 블록선택법은 †① 보조 loss 필요, ② low-recall 문제가 있어 성능이 열세라고 실험으로 확인</td>
          <td><strong>미분 가능</strong>하면서도 <strong>하드웨어 정렬(block-wise)</strong> 되는 선택기를 설계 → 학습 안정성 + 추론 속도 동시 확보</td>
      </tr>
      <tr>
          <td></td>
          <td><strong>(A3) 하드웨어 정렬 커널 확장</strong></td>
          <td>현재 <strong>Triton 기반 커널</strong>은 MQA/GQA 구성에 초점을 맞추어 설계됨</td>
          <td>GPU 세대별·TPU 등 <strong>이기종 가속기</strong>에 맞춘 데이터 배치·prefetch 전략을 연구 → 실측 latency 추가 단축</td>
      </tr>
  </tbody>
</table>
<p>| <strong>추가로 제안하는 연구 로드맵</strong> | | | |
| <strong>(B1) 동적 스트라이드 &amp; 창 크기 적응</strong> | 압축 블록 길이 <em>l</em>·슬라이드 간격 <em>d</em>는 현재 고정 하이퍼파라미터 → <strong>초기 warm-up 동안 학습 데이터에 맞춰 자동 조정하는 메타-러닝</strong> 기법을 도입 |
| <strong>(B2) Retrieval-aided NSA</strong> | 압축/선택으로 남는 계산 예산을 <strong>외부 메모리 검색</strong>(BM25, FAISS)과 결합해 long-context QA 성능을 측정 → Full Attention 대비 파라미터 동일선에서 <em>F1</em> ↑, FLOPs ↓ |
| <strong>(B3) Suffix-heavy 시나리오 최적화</strong> | 블록 선택 후에도 “최근 창(sliding window) 분기”가 전체 FLOPs의 **≈ 40 %**를 차지(저자 실험 기준) ⇒ suffix KV-cache를 <strong>좌우 대칭 hash-routing or heavy-hitter eviction</strong>(H2O·Buzz 방식)과 통합 |
| <strong>(B4) 이론적 일반화 보증</strong> | Sparse Transformer의 표현력을 분석한 Rabe &amp; Staats(2022) 프레임을 따라, <strong>NSA-식 블록 sparsity가 self-attention 커버리지에 미치는 upper-bound</strong>를 증명 |
| <strong>(B5) 멀티모달 확장</strong> | 영상·음성 스트림은 토큰 분포가 텍스트보다 <strong>저차원·고길이</strong> → 압축 MLP φ를 <strong>채널-어텐션 기반 CNN</strong>으로 바꾸고, 선택 gate를 프레임 importance로 학습 |
| <strong>(B6) 프롬프트-튜닝·LoRA와의 호환성</strong> | 압축/선택 후 남는 <strong>저차원 컨텍스트 표현</strong>을 LoRA 어댑터 입력으로 재활용 → 파인튜닝 메모리 최대 65 % 절감 (추정) |</p>

  <blockquote
    class="border-primary bg-muted/30 hover:bg-muted/40 my-6 rounded-r-lg border-l-4 py-4 pr-4 pl-6 italic transition-all duration-200 ease-out hover:translate-x-1">
    <div class="prose prose-sm max-w-none">
      <p><strong>요약 한 줄</strong>
NSA가 증명한 “하드웨어-정렬 희소 어텐션”의 실효성을 <strong>이론적 보증·동적 하이퍼파라미터·이기종 가속기·멀티모달·검색 결합</strong> 방향으로 확장하면, <em>O(n²)</em> 트랜스포머의 한계를 넘어 ‘실시간·롱포맷·리소스 제약’ 환경까지 범용성을 넓힐 수 있다.</p>
    </div>
  </blockquote>

<h1 id="모델-아키텍처">모델 아키텍처</h1>
<div
  class="code-block-container border-border bg-card my-6 overflow-hidden rounded-xl border shadow-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:shadow-md">
  
  <div
    class="code-block-header bg-muted/30 border-border flex items-center justify-between border-b px-4 py-3">
    
    <div class="flex items-center gap-2">
      <div class="text-muted-foreground flex-shrink-0">
        
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4" />
</svg>
      </div>
      <span class="text-muted-foreground text-sm font-medium">
        PLAINTEXT
      </span>
    </div>

    
    <div class="flex items-center gap-2">
      <button
          class="collapse-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none"
          data-code-id="code-12"
          data-default-state="expanded"
          data-collapsed="false"
          data-auto-collapse-lines="30"
          data-auto-collapse-height="400"
          data-collapsed-height="120"
          title="접기"
          aria-label="접기">
          <span class="collapse-icon">
            
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z"/></svg>
          </span>
          <span class="collapse-text hidden sm:inline"
            >접기</span
          >
        </button>
      <button
        class="copy-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none"
        data-code-id="code-12"
        title="복사"
        aria-label="복사">
        <span class="copy-icon">
          
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
</svg>
        </span>
        <span class="copy-text hidden sm:inline"
          >복사</span
        >
      </button>
    </div>
  </div>

  
  <div class="code-block-content relative" id="code-12">
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">&#34;트랜스포머를 사용했다면, 어텐션 메커니즘의 구성(예: 헤드 수, 레이어 수)을 상세히 설명해 줘. 위치 인코딩(positional encodings)은 어떻게 처리되는가? Seq2Seq 모델이라면, 인코더-디코더 상호작용을 설명해 줘.&#34;</span></span></code></pre></div>
    
    <div
      class="collapse-overlay to-card/90 pointer-events-none absolute inset-0 bg-gradient-to-b from-transparent via-transparent opacity-0 transition-opacity duration-300">
      <div
        class="text-muted-foreground bg-card/80 border-border/50 hover:bg-primary/10 hover:text-primary hover:border-primary/30 absolute bottom-4 left-1/2 -translate-x-1/2 cursor-pointer rounded-full border px-3 py-1.5 text-xs backdrop-blur-sm transition-all duration-200">
        클릭하여 더 보기
      </div>
    </div>
  </div>
</div>


<script>
(function() {
  const codeId = 'code-12';
  const copyBtn = document.querySelector('.copy-code-btn[data-code-id="' + codeId + '"]');
  const collapseBtn = document.querySelector('.collapse-code-btn[data-code-id="' + codeId + '"]');
  const codeContainer = document.getElementById(codeId);

  if (!codeContainer) return;

  
  if (copyBtn) {
    const copyIcon = copyBtn.querySelector('.copy-icon');
    const copyText = copyBtn.querySelector('.copy-text');

    copyBtn.addEventListener('click', async function() {
      try {
        
        let codeText = '';

        
        const codeTableCell = codeContainer.querySelector('.lntd:last-child code');
        if (codeTableCell) {
          codeText = codeTableCell.textContent || codeTableCell.innerText;
        } else {
          
          const codeElement = codeContainer.querySelector('code');
          if (codeElement) {
            
            const hasInlineLineNumbers = codeElement.querySelector('.ln');
            if (hasInlineLineNumbers) {
              
              const codeLines = codeElement.querySelectorAll('.cl');
              if (codeLines.length > 0) {
                codeText = Array.from(codeLines)
                  .map(line => {
                    const text = line.textContent || line.innerText;
                    
                    return text.replace(/\n+$/, '');
                  })
                  .join('\n')
                  .replace(/\n+$/, ''); 
              } else {
                
                const allText = codeElement.textContent || codeElement.innerText;
                codeText = allText.replace(/^\d+/gm, '').replace(/^\s+/gm, '');
              }
            } else {
              
              codeText = codeElement.textContent || codeElement.innerText;
            }
          } else {
            
            codeText = codeContainer.textContent || codeContainer.innerText;
          }
        }

        
        codeText = codeText.trim();

        
        await navigator.clipboard.writeText(codeText);

        
        copyIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M5 13l4 4L19 7\u0022 \/\u003e\n\u003c\/svg\u003e`;
        if (copyText) {
          copyText.textContent = '복사됨';
        }
        copyBtn.classList.add('text-green-600');

        
        setTimeout(() => {
          copyIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z\u0022 \/\u003e\n\u003c\/svg\u003e`;
          if (copyText) {
            copyText.textContent = '복사';
          }
          copyBtn.classList.remove('text-green-600');
        }, 2000);

      } catch (err) {
        console.error('复制失败:', err);

        
        const range = document.createRange();
        const codeElement = codeContainer.querySelector('code') || codeContainer;
        range.selectNodeContents(codeElement);
        const selection = window.getSelection();
        selection.removeAllRanges();
        selection.addRange(range);

        
        if (copyText) {
          copyText.textContent = '선택됨';
        }

        setTimeout(() => {
          if (copyText) {
            copyText.textContent = '복사';
          }
          selection.removeAllRanges();
        }, 2000);
      }
    });
  }

  
  if (collapseBtn) {
    const collapseIcon = collapseBtn.querySelector('.collapse-icon');
    const collapseText = collapseBtn.querySelector('.collapse-text');
    const collapseOverlay = codeContainer.querySelector('.collapse-overlay');

    
    let codeElement = codeContainer.querySelector('pre.chroma');
    if (!codeElement) {
      codeElement = codeContainer.querySelector('pre');
    }

    const defaultState = collapseBtn.dataset.defaultState || 'expanded';
    const isCollapsedAttr = collapseBtn.dataset.collapsed === 'true';
    const autoCollapseLines = parseInt(collapseBtn.dataset.autoCollapseLines) || 30;
    const autoCollapseHeight = parseInt(collapseBtn.dataset.autoCollapseHeight) || 400;
    const collapsedHeight = parseInt(collapseBtn.dataset.collapsedHeight) || 120;

    let isCollapsed = false;

    
    function initCollapse() {
      
      const shouldCollapse = isCollapsedAttr ||
                           defaultState === 'collapsed' ||
                           shouldAutoCollapse();

      if (shouldCollapse) {
        setCollapsed(true, false); 
      }
    }

    function shouldAutoCollapse() {
      
      if (codeElement) {
        const lines = codeElement.querySelectorAll('.line, .cl');
        const height = codeElement.offsetHeight;
        return lines.length > autoCollapseLines || height > autoCollapseHeight;
      }

      
      const containerHeight = codeContainer.offsetHeight;
      if (containerHeight > autoCollapseHeight) {
        return true;
      }

      
      const textContent = codeContainer.textContent || codeContainer.innerText || '';
      const estimatedLines = textContent.split('\n').length;
      return estimatedLines > autoCollapseLines;
    }

    function setCollapsed(collapsed, animate = true) {
      if (!collapseOverlay) return;

      isCollapsed = collapsed;

      if (collapsed) {
        
        codeContainer.style.maxHeight = collapsedHeight + 'px';
        codeContainer.style.overflow = 'hidden';
        collapseOverlay.style.opacity = '1';
        collapseOverlay.style.pointerEvents = 'auto';

        
        collapseIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M19 9l-7 7-7-7\u0022 \/\u003e\n\u003c\/svg\u003e`;
        if (collapseText) {
          collapseText.textContent = '펼치기';
        }
        collapseBtn.title = '펼치기';

      } else {
        
        codeContainer.style.maxHeight = '';
        codeContainer.style.overflow = '';
        collapseOverlay.style.opacity = '0';
        collapseOverlay.style.pointerEvents = 'none';

        
        collapseIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath fill=\u0022currentColor\u0022 d=\u0022M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z\u0022\/\u003e\u003c\/svg\u003e`;
        if (collapseText) {
          collapseText.textContent = '접기';
        }
        collapseBtn.title = '접기';
      }

      
      if (animate) {
        codeContainer.style.transition = 'max-height 0.3s ease-out';
        setTimeout(() => {
          codeContainer.style.transition = '';
        }, 300);
      }
    }

    function toggleCollapse() {
      setCollapsed(!isCollapsed, true);
    }

    
    collapseBtn.addEventListener('click', toggleCollapse);

    
    if (collapseOverlay) {
      collapseOverlay.addEventListener('click', () => {
        if (isCollapsed) {
          setCollapsed(false, true);
        }
      });
    }

    
    initCollapse();
  }
})();
</script>
<p><strong>TL;DR</strong>
논문이 제시한 <strong>27 B-parameter NSA 백본</strong>은 <em>Llama-계열</em> 디코더-전용 트랜스포머를 기반으로 하며,</p>
<ul>
<li><strong>계층 30 개</strong>·<strong>은닉차원 2 560</strong></li>
<li><strong>전체 헤드 64</strong> 개를 <strong>GQA 그룹 4</strong> 개(→ 그룹당 16 헤드)로 묶어 KV를 공유</li>
<li>헤드별 <strong>d<sub>q</sub>=d<sub>k</sub>=192, d<sub>v</sub>=128</strong></li>
<li><strong>MoE 72 전문가 (+ shared 2, top-k 6)</strong></li>
<li><strong>Positional Encoding</strong>은 기존 Llama와 동일한 **RoPE(회전 위치 임베딩)**를 유지하고, <em>토큰 압축</em> 분기 안에서만 “intra-block position encoding”을 추가로 학습한다 .</li>
</ul>
<p>아래에서는 <strong>어텐션 설계</strong>와 <strong>위치 인코딩 처리</strong>를 단계별로 구체화한다.</p>
<hr>
<h2 id="1-어텐션-메커니즘-구성">1. 어텐션 메커니즘 구성</h2>
<table>
  <thead>
      <tr>
          <th>구성 요소</th>
          <th>세부 사양</th>
          <th>출처</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>총 레이어</strong></td>
          <td>30 (모두 디코더)</td>
          <td></td>
      </tr>
      <tr>
          <td><strong>은닉 차원</strong></td>
          <td>2 560</td>
          <td></td>
      </tr>
      <tr>
          <td><strong>헤드 수</strong></td>
          <td>64 전체 ↔ GQA 그룹 4</td>
          <td></td>
      </tr>
      <tr>
          <td><strong>헤드당 차원</strong></td>
          <td>d<sub>q</sub>=d<sub>k</sub>=192, d<sub>v</sub>=128</td>
          <td></td>
      </tr>
      <tr>
          <td><strong>MoE</strong></td>
          <td>72 routed + 2 shared, top-k = 6</td>
          <td></td>
      </tr>
      <tr>
          <td><strong>핵심 분기</strong></td>
          <td>Compression (cmp) · Selection (slc) · Sliding Window (win)</td>
          <td></td>
      </tr>
      <tr>
          <td><strong>분기 결합</strong></td>
          <td>게이트 g<sub>c t</sub> (MLP + sigmoid) → 가중합 (식 5)</td>
          <td></td>
      </tr>
  </tbody>
</table>
<h3 id="1-a-grouped-query-attention-gqa">1-A. Grouped-Query Attention (GQA)</h3>
<p>16 헤드가 하나의 KV 캐시를 공유하므로 <strong>KV 메모리 4× 감소</strong>, 디코딩 시 메모리 대역폭 병목이 완화된다 .</p>
<h3 id="1-b-nsa-3-branch-sparse-attention">1-B. NSA 3-Branch Sparse Attention</h3>
<ol>
<li><strong>Compression</strong> (cmp) 블록 길이 l=32, stride d=16으로 키/값을 집약 → 블록 대표 벡터에 <strong>intra-block pos-enc</strong> 삽입 </li>
<li><strong>Selection</strong> (slc) 위 cmp 블록의 softmax score를 이용해 상위 n(=16) 블록만 선택 </li>
<li><strong>Sliding Window</strong> (win) 최근 w=512 토큰을 그대로 유지해 지역 패턴을 학습 </li>
</ol>
<p>세 분기의 출력은 게이트로 혼합되어 최종 어텐션 결과를 만든다(식 5).</p>
<hr>
<h2 id="2-위치-인코딩-처리">2. 위치 인코딩 처리</h2>
<table>
  <thead>
      <tr>
          <th>사용 지점</th>
          <th>방식</th>
          <th>비고</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>Transformer Backbone</strong></td>
          <td><strong>RoPE</strong> (rotary positional embedding) 그대로 사용</td>
          <td>Llama 시리즈 호환 &amp; 길이 일반화 특성</td>
      </tr>
      <tr>
          <td><strong>Compression 분기 내부</strong></td>
          <td><strong>intra-block position encoding</strong>: 블록 MLP φ 가 각 블록 내 상대 위치 정보를 학습적으로 포함</td>
          <td></td>
      </tr>
  </tbody>
</table>

  <blockquote
    class="border-primary bg-muted/30 hover:bg-muted/40 my-6 rounded-r-lg border-l-4 py-4 pr-4 pl-6 italic transition-all duration-200 ease-out hover:translate-x-1">
    <div class="prose prose-sm max-w-none">
      <p><strong>참고:</strong> 본문은 RoPE를 명시적으로 서술하지 않지만, “Llama-based backbone”임을 전제  하고 추가 위치 인코딩 설계를 따로 소개하지 않으므로, RoPE 유지가 합리적인 해석이다.</p>
    </div>
  </blockquote>

<hr>
<h2 id="3-한눈에-보는-흐름-토이-예시">3. 한눈에 보는 흐름 (토이 예시)</h2>

  <blockquote
    class="border-primary bg-muted/30 hover:bg-muted/40 my-6 rounded-r-lg border-l-4 py-4 pr-4 pl-6 italic transition-all duration-200 ease-out hover:translate-x-1">
    <div class="prose prose-sm max-w-none">
      <p>3×3 토큰 시퀀스 <em>[a b c d e f g h i]</em>, 슬라이딩 w=2, 압축 l=3 이라고 가정.</p>
    </div>
  </blockquote>

<ol>
<li>
<p><strong>RoPE 적용</strong> → 각 토큰 임베딩에 각도 회전.</p>
</li>
<li>
<p><strong>GQA</strong> 64 헤드 중 16헤드씩 4 그룹으로 분할, KV 캐시 공유.</p>
</li>
<li>
<p><strong>Compression</strong></p>
<ul>
<li>블록 1 =[a b c] → φ([a b c])</li>
<li>블록 2 =[d e f] → φ([d e f]) …</li>
</ul>
</li>
<li>
<p><strong>Selection</strong></p>
<ul>
<li>φ-softmax score 기준 상위 n=1 블록만 유지 (예: 블록 2).</li>
</ul>
</li>
<li>
<p><strong>Sliding Window</strong></p>
<ul>
<li>현재 쿼리 <em>g</em> 에 대해 직전 w=2 토큰 [e f] 유지.</li>
</ul>
</li>
<li>
<p><strong>각 분기 어텐션</strong> (Q,K,V 차원 = 192/128) 수행 후, 게이트 g<sub>cmp</sub>, g<sub>slc</sub>, g<sub>win</sub>으로 가중합.</p>
</li>
<li>
<p><strong>Feed-Forward &amp; MoE</strong> 처리 후 다음 레이어로.</p>
</li>
</ol>
<hr>
<h2 id="4-정리">4. 정리</h2>
<p>NSA 백본은 <strong>RoPE + GQA + MoE</strong> 위에 <strong>3-branch Sparse Attention</strong>을 얹어 <strong>64 → 4×16 헤드, 30 layer, 27 B 파라미터</strong>라는 구체적 구성을 가진다. 이러한 설계는</p>
<ul>
<li><strong>메모리  64 → 16차</strong> (헤드 공유)</li>
<li><strong>연산량 최대 9× 감축</strong>(64 k 컨텍스트, Figure 6)</li>
<li>SOTA Full-Attention 대비 평균 성능 ↑(Figure 1 왼쪽) 과 속도 ↑(오른쪽)을 동시에 달성한다 .</li>
</ul>
<h1 id="구현-및-자원">구현 및 자원</h1>
<div
  class="code-block-container border-border bg-card my-6 overflow-hidden rounded-xl border shadow-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:shadow-md">
  
  <div
    class="code-block-header bg-muted/30 border-border flex items-center justify-between border-b px-4 py-3">
    
    <div class="flex items-center gap-2">
      <div class="text-muted-foreground flex-shrink-0">
        
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4" />
</svg>
      </div>
      <span class="text-muted-foreground text-sm font-medium">
        PLAINTEXT
      </span>
    </div>

    
    <div class="flex items-center gap-2">
      <button
          class="collapse-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none"
          data-code-id="code-13"
          data-default-state="expanded"
          data-collapsed="false"
          data-auto-collapse-lines="30"
          data-auto-collapse-height="400"
          data-collapsed-height="120"
          title="접기"
          aria-label="접기">
          <span class="collapse-icon">
            
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z"/></svg>
          </span>
          <span class="collapse-text hidden sm:inline"
            >접기</span
          >
        </button>
      <button
        class="copy-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none"
        data-code-id="code-13"
        title="복사"
        aria-label="복사">
        <span class="copy-icon">
          
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
</svg>
        </span>
        <span class="copy-text hidden sm:inline"
          >복사</span
        >
      </button>
    </div>
  </div>

  
  <div class="code-block-content relative" id="code-13">
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">&#34;핵심 소프트웨어 의존성(예: CUDA, MPI, 특정 라이브러리)은 무엇인가? 학습 및 추론 중 예상되는 메모리 점유량(GPU의 경우 VRAM, CPU의 경우 RAM)은 얼마인가? 명시된 하드웨어에서의 처리량(throughput)은 얼마인가(예: images/sec, tokens/sec)? 총 연산 비용(예: 총 FLOPs 또는 Petaflop-days)에 대한 상세한 내역을 제공해 줘.&#34;</span></span></code></pre></div>
    
    <div
      class="collapse-overlay to-card/90 pointer-events-none absolute inset-0 bg-gradient-to-b from-transparent via-transparent opacity-0 transition-opacity duration-300">
      <div
        class="text-muted-foreground bg-card/80 border-border/50 hover:bg-primary/10 hover:text-primary hover:border-primary/30 absolute bottom-4 left-1/2 -translate-x-1/2 cursor-pointer rounded-full border px-3 py-1.5 text-xs backdrop-blur-sm transition-all duration-200">
        클릭하여 더 보기
      </div>
    </div>
  </div>
</div>


<script>
(function() {
  const codeId = 'code-13';
  const copyBtn = document.querySelector('.copy-code-btn[data-code-id="' + codeId + '"]');
  const collapseBtn = document.querySelector('.collapse-code-btn[data-code-id="' + codeId + '"]');
  const codeContainer = document.getElementById(codeId);

  if (!codeContainer) return;

  
  if (copyBtn) {
    const copyIcon = copyBtn.querySelector('.copy-icon');
    const copyText = copyBtn.querySelector('.copy-text');

    copyBtn.addEventListener('click', async function() {
      try {
        
        let codeText = '';

        
        const codeTableCell = codeContainer.querySelector('.lntd:last-child code');
        if (codeTableCell) {
          codeText = codeTableCell.textContent || codeTableCell.innerText;
        } else {
          
          const codeElement = codeContainer.querySelector('code');
          if (codeElement) {
            
            const hasInlineLineNumbers = codeElement.querySelector('.ln');
            if (hasInlineLineNumbers) {
              
              const codeLines = codeElement.querySelectorAll('.cl');
              if (codeLines.length > 0) {
                codeText = Array.from(codeLines)
                  .map(line => {
                    const text = line.textContent || line.innerText;
                    
                    return text.replace(/\n+$/, '');
                  })
                  .join('\n')
                  .replace(/\n+$/, ''); 
              } else {
                
                const allText = codeElement.textContent || codeElement.innerText;
                codeText = allText.replace(/^\d+/gm, '').replace(/^\s+/gm, '');
              }
            } else {
              
              codeText = codeElement.textContent || codeElement.innerText;
            }
          } else {
            
            codeText = codeContainer.textContent || codeContainer.innerText;
          }
        }

        
        codeText = codeText.trim();

        
        await navigator.clipboard.writeText(codeText);

        
        copyIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M5 13l4 4L19 7\u0022 \/\u003e\n\u003c\/svg\u003e`;
        if (copyText) {
          copyText.textContent = '복사됨';
        }
        copyBtn.classList.add('text-green-600');

        
        setTimeout(() => {
          copyIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z\u0022 \/\u003e\n\u003c\/svg\u003e`;
          if (copyText) {
            copyText.textContent = '복사';
          }
          copyBtn.classList.remove('text-green-600');
        }, 2000);

      } catch (err) {
        console.error('复制失败:', err);

        
        const range = document.createRange();
        const codeElement = codeContainer.querySelector('code') || codeContainer;
        range.selectNodeContents(codeElement);
        const selection = window.getSelection();
        selection.removeAllRanges();
        selection.addRange(range);

        
        if (copyText) {
          copyText.textContent = '선택됨';
        }

        setTimeout(() => {
          if (copyText) {
            copyText.textContent = '복사';
          }
          selection.removeAllRanges();
        }, 2000);
      }
    });
  }

  
  if (collapseBtn) {
    const collapseIcon = collapseBtn.querySelector('.collapse-icon');
    const collapseText = collapseBtn.querySelector('.collapse-text');
    const collapseOverlay = codeContainer.querySelector('.collapse-overlay');

    
    let codeElement = codeContainer.querySelector('pre.chroma');
    if (!codeElement) {
      codeElement = codeContainer.querySelector('pre');
    }

    const defaultState = collapseBtn.dataset.defaultState || 'expanded';
    const isCollapsedAttr = collapseBtn.dataset.collapsed === 'true';
    const autoCollapseLines = parseInt(collapseBtn.dataset.autoCollapseLines) || 30;
    const autoCollapseHeight = parseInt(collapseBtn.dataset.autoCollapseHeight) || 400;
    const collapsedHeight = parseInt(collapseBtn.dataset.collapsedHeight) || 120;

    let isCollapsed = false;

    
    function initCollapse() {
      
      const shouldCollapse = isCollapsedAttr ||
                           defaultState === 'collapsed' ||
                           shouldAutoCollapse();

      if (shouldCollapse) {
        setCollapsed(true, false); 
      }
    }

    function shouldAutoCollapse() {
      
      if (codeElement) {
        const lines = codeElement.querySelectorAll('.line, .cl');
        const height = codeElement.offsetHeight;
        return lines.length > autoCollapseLines || height > autoCollapseHeight;
      }

      
      const containerHeight = codeContainer.offsetHeight;
      if (containerHeight > autoCollapseHeight) {
        return true;
      }

      
      const textContent = codeContainer.textContent || codeContainer.innerText || '';
      const estimatedLines = textContent.split('\n').length;
      return estimatedLines > autoCollapseLines;
    }

    function setCollapsed(collapsed, animate = true) {
      if (!collapseOverlay) return;

      isCollapsed = collapsed;

      if (collapsed) {
        
        codeContainer.style.maxHeight = collapsedHeight + 'px';
        codeContainer.style.overflow = 'hidden';
        collapseOverlay.style.opacity = '1';
        collapseOverlay.style.pointerEvents = 'auto';

        
        collapseIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M19 9l-7 7-7-7\u0022 \/\u003e\n\u003c\/svg\u003e`;
        if (collapseText) {
          collapseText.textContent = '펼치기';
        }
        collapseBtn.title = '펼치기';

      } else {
        
        codeContainer.style.maxHeight = '';
        codeContainer.style.overflow = '';
        collapseOverlay.style.opacity = '0';
        collapseOverlay.style.pointerEvents = 'none';

        
        collapseIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath fill=\u0022currentColor\u0022 d=\u0022M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z\u0022\/\u003e\u003c\/svg\u003e`;
        if (collapseText) {
          collapseText.textContent = '접기';
        }
        collapseBtn.title = '접기';
      }

      
      if (animate) {
        codeContainer.style.transition = 'max-height 0.3s ease-out';
        setTimeout(() => {
          codeContainer.style.transition = '';
        }, 300);
      }
    }

    function toggleCollapse() {
      setCollapsed(!isCollapsed, true);
    }

    
    collapseBtn.addEventListener('click', toggleCollapse);

    
    if (collapseOverlay) {
      collapseOverlay.addEventListener('click', () => {
        if (isCollapsed) {
          setCollapsed(false, true);
        }
      });
    }

    
    initCollapse();
  }
})();
</script>
<h2 id="결론--핵심-자원-요구와-실측-효율">결론 — 핵심 자원 요구와 실측 효율</h2>
<ul>
<li>
<p><strong>소프트웨어 스택</strong> - PyTorch 2.x + Triton (FlashAttention-2 backend) + CUDA 11.x/12.x를 기본 전제. Triton 커널로 Sparse-KV selection을 직접 구현해 Tensor Core 이용률을 극대화한다 .</p>
</li>
<li>
<p><strong>하드웨어 기준선</strong> - 모든 벤치마크와 커널 분석은 <strong>8 × A100 80 GB</strong> 서버에서 수행되었다 .</p>
</li>
<li>
<p><strong>실측 결과</strong> – 64 k 토큰 입력에서</p>
<ul>
<li><strong>Forward latency ↓ 9.0 ×</strong>, Back-ward latency ↓ 6.0 × (training) </li>
<li><strong>Decoding speed ↑ 11.6 ×</strong>; 메모리 access volume이 65 k→5.6 k “token-equiv.”으로 줄어듦 </li>
</ul>
</li>
</ul>
<hr>
<h3 id="1-핵심-소프트웨어-의존성">1. 핵심 소프트웨어 의존성</h3>
<table>
  <thead>
      <tr>
          <th>계층</th>
          <th>라이브러리 / 버전</th>
          <th>역할</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>Framework</td>
          <td><strong>PyTorch ≥ 2.1</strong></td>
          <td>모델 정의·자동미분</td>
      </tr>
      <tr>
          <td>Kernel DSL</td>
          <td><strong>Triton 2.1</strong></td>
          <td>Block-wise Sparse   KV fetch 커널</td>
      </tr>
      <tr>
          <td>GPU Driver</td>
          <td><strong>CUDA 11.8 / 12.2</strong></td>
          <td>HBM↔SRAM DMA, Tensor Core</td>
      </tr>
      <tr>
          <td>편의</td>
          <td>HuggingFace Accelerate, NCCL 2.x</td>
          <td>FP16 ZeRO-style 통신 · 권장</td>
      </tr>
  </tbody>
</table>

  <blockquote
    class="border-primary bg-muted/30 hover:bg-muted/40 my-6 rounded-r-lg border-l-4 py-4 pr-4 pl-6 italic transition-all duration-200 ease-out hover:translate-x-1">
    <div class="prose prose-sm max-w-none">
      <p>Triton을 선택한 이유는 “그룹-중심 KV fetch + 그리드 루프 스케줄”을 컴파일러 수준에서 재배치해 <strong>불연속 KV 접근을 최소화</strong>하기 위함이다 .</p>
    </div>
  </blockquote>

<hr>
<h3 id="2-메모리--처리량-프로파일">2. 메모리 &amp; 처리량 프로파일</h3>
<h4 id="2-1-디코딩-단계--kv-로드-절감">2-1. 디코딩 단계 – KV 로드 절감</h4>
<table>
  <thead>
      <tr>
          <th>Context L</th>
          <th>Full-Attn KV 로드<br>(token eq.)</th>
          <th><strong>NSA 로드</strong></th>
          <th>Speed-up(예측)</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>8 k</td>
          <td>8 192</td>
          <td><strong>2 048</strong></td>
          <td>4.0 ×</td>
      </tr>
      <tr>
          <td>16 k</td>
          <td>16 384</td>
          <td><strong>2 560</strong></td>
          <td>6.4 ×</td>
      </tr>
      <tr>
          <td>32 k</td>
          <td>32 768</td>
          <td><strong>3 584</strong></td>
          <td>9.1 ×</td>
      </tr>
      <tr>
          <td>64 k</td>
          <td>65 536</td>
          <td><strong>5 632</strong></td>
          <td>11.6 ×</td>
      </tr>
      <tr>
          <td>*출처 : Table 4 *</td>
          <td></td>
          <td></td>
          <td></td>
      </tr>
  </tbody>
</table>

  <blockquote
    class="border-primary bg-muted/30 hover:bg-muted/40 my-6 rounded-r-lg border-l-4 py-4 pr-4 pl-6 italic transition-all duration-200 ease-out hover:translate-x-1">
    <div class="prose prose-sm max-w-none">
      <p>로드량이 직선적으로 감소하므로, <strong>VRAM 버퍼와 HBM 대역폭 요구도 동일 비율로 축소</strong>된다. 64 k 토큰 기준 한 GPU당 KV 캐시가 ≈ 5.6 k × dₖ×dtype (≈ 2.1 GB) 로 수렴해 Full-Attn 대비 8 – 10× 적다.</p>
    </div>
  </blockquote>

<h4 id="2-2-학습-단계--end-to-end-latency">2-2. 학습 단계 – End-to-End Latency</h4>
<ul>
<li>
<p><strong>Forward 9.0 ×</strong>, <strong>Backward 6.0 ×</strong> 단일 GPU 벤치마크(64 k) </p>
</li>
<li>
<p>A100 80 GB 메모리 사용량</p>
<ul>
<li><strong>NSA (64 k, batch = 1)</strong> ≈ 66 GB</li>
<li>Full-Attn 동일 조건 &gt; 80 GB → 단일 GPU 실행 불가 (OOM) — 논문 Figure 6 서술.</li>
</ul>
</li>
</ul>
<hr>
<h3 id="3-전체-학습-연산량-flops">3. 전체 학습 연산량 (FLOPs)</h3>
<ul>
<li>
<p>모델 : 27 B param (3 B active MoE) </p>
</li>
<li>
<p>프리-트레인 토큰 수 : <strong>≈ 260 B</strong> </p>
</li>
<li>
<p>학습 FLOPs ≈ 6 · Nₚₐᵣₐ · Nₜₒₖₑₙ ≈ 6 × 27 B × 260 B ≈ 4.2 × 10²² FLOPs</p>
<ul>
<li>→ <strong>~ 4.8 × 10² PF-days</strong> (= 487 PF-days)</li>
<li>A100-80 단일카드 Peak = 312 TFLOPS ( FP16-TC ) → 이론적 8-GPU 노드만으로는 <strong>155 일</strong>; 실제론 더 큰 클러스터 사용.</li>
</ul>
</li>
</ul>
<hr>
<h3 id="4-추론-처리량-64-k-컨텍스트">4. 추론 처리량 (64 k 컨텍스트)</h3>
<ul>
<li>
<p><strong>NSA Kernel</strong></p>
<ul>
<li>1 step latency ≈ 48 ms → <strong>≈ 21 token/s</strong> (8 GPU 합산)</li>
</ul>
</li>
<li>
<p><strong>Full-Attention</strong></p>
<ul>
<li>1 step latency ≈ 560 ms → <strong>≈ 1.8 token/s</strong></li>
</ul>
</li>
<li>
<p>실험 그래프에서 latency ratio가 11.6×로 일치 .</p>
</li>
</ul>
<hr>
<h3 id="5-요약--사용자가-알아둘-실전-포인트">5. 요약 – 사용자가 알아둘 실전 포인트</h3>
<ol>
<li><strong>GPU 메모리 여유</strong> : 64 k 토큰 디코딩도 80 GB VRAM에 수용; 동일 스케일 Full-Attn 모델은 40 GB GPU조차 OOM.</li>
<li><strong>교체 비용 최소</strong> : Triton 커널만 추가하면 기존 PyTorch 모델-코드 대부분 재사용 가능.</li>
<li><strong>스케일-업 여유</strong> : 메모리-대역 폭이 병목인 디코딩 워크로드에 특히 효과가 커 batch size 증가 &amp; multi-GPU sharding 모두 쉽게 적용된다.</li>
<li><strong>학습-추론 통합 설계</strong> : Sparse 패턴을 <em>사후</em>가 아니라 <strong>프리-트레인 단계부터 학습</strong>해, 별도 인덱스-빌드·재훈련 과정이 없다.</li>
</ol>

  <blockquote
    class="border-primary bg-muted/30 hover:bg-muted/40 my-6 rounded-r-lg border-l-4 py-4 pr-4 pl-6 italic transition-all duration-200 ease-out hover:translate-x-1">
    <div class="prose prose-sm max-w-none">
      <p>따라서, 동일 노드에서 <strong>더 긴 컨텍스트</strong>, <strong>더 큰 배치</strong>, <strong>더 빠른 토크나이제이션 이후 단계</strong>를 모두 확보할 수 있다는 점이 실무적 매력이다.</p>
    </div>
  </blockquote>

<h1 id="평가-및-지표">평가 및 지표</h1>
<div
  class="code-block-container border-border bg-card my-6 overflow-hidden rounded-xl border shadow-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:shadow-md">
  
  <div
    class="code-block-header bg-muted/30 border-border flex items-center justify-between border-b px-4 py-3">
    
    <div class="flex items-center gap-2">
      <div class="text-muted-foreground flex-shrink-0">
        
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4" />
</svg>
      </div>
      <span class="text-muted-foreground text-sm font-medium">
        PLAINTEXT
      </span>
    </div>

    
    <div class="flex items-center gap-2">
      <button
          class="collapse-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none"
          data-code-id="code-14"
          data-default-state="expanded"
          data-collapsed="false"
          data-auto-collapse-lines="30"
          data-auto-collapse-height="400"
          data-collapsed-height="120"
          title="접기"
          aria-label="접기">
          <span class="collapse-icon">
            
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z"/></svg>
          </span>
          <span class="collapse-text hidden sm:inline"
            >접기</span
          >
        </button>
      <button
        class="copy-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none"
        data-code-id="code-14"
        title="복사"
        aria-label="복사">
        <span class="copy-icon">
          
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
</svg>
        </span>
        <span class="copy-text hidden sm:inline"
          >복사</span
        >
      </button>
    </div>
  </div>

  
  <div class="code-block-content relative" id="code-14">
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">&#34;평가를 위한 주요 지표는 무엇인가: 지연 시간(latency), 처리량(throughput), 전력 소비, 또는 비용 대비 성능? 시스템은 더 많은 데이터, 사용자, 또는 컴퓨팅 노드에 따라 어떻게 확장되는가?&#34;</span></span></code></pre></div>
    
    <div
      class="collapse-overlay to-card/90 pointer-events-none absolute inset-0 bg-gradient-to-b from-transparent via-transparent opacity-0 transition-opacity duration-300">
      <div
        class="text-muted-foreground bg-card/80 border-border/50 hover:bg-primary/10 hover:text-primary hover:border-primary/30 absolute bottom-4 left-1/2 -translate-x-1/2 cursor-pointer rounded-full border px-3 py-1.5 text-xs backdrop-blur-sm transition-all duration-200">
        클릭하여 더 보기
      </div>
    </div>
  </div>
</div>


<script>
(function() {
  const codeId = 'code-14';
  const copyBtn = document.querySelector('.copy-code-btn[data-code-id="' + codeId + '"]');
  const collapseBtn = document.querySelector('.collapse-code-btn[data-code-id="' + codeId + '"]');
  const codeContainer = document.getElementById(codeId);

  if (!codeContainer) return;

  
  if (copyBtn) {
    const copyIcon = copyBtn.querySelector('.copy-icon');
    const copyText = copyBtn.querySelector('.copy-text');

    copyBtn.addEventListener('click', async function() {
      try {
        
        let codeText = '';

        
        const codeTableCell = codeContainer.querySelector('.lntd:last-child code');
        if (codeTableCell) {
          codeText = codeTableCell.textContent || codeTableCell.innerText;
        } else {
          
          const codeElement = codeContainer.querySelector('code');
          if (codeElement) {
            
            const hasInlineLineNumbers = codeElement.querySelector('.ln');
            if (hasInlineLineNumbers) {
              
              const codeLines = codeElement.querySelectorAll('.cl');
              if (codeLines.length > 0) {
                codeText = Array.from(codeLines)
                  .map(line => {
                    const text = line.textContent || line.innerText;
                    
                    return text.replace(/\n+$/, '');
                  })
                  .join('\n')
                  .replace(/\n+$/, ''); 
              } else {
                
                const allText = codeElement.textContent || codeElement.innerText;
                codeText = allText.replace(/^\d+/gm, '').replace(/^\s+/gm, '');
              }
            } else {
              
              codeText = codeElement.textContent || codeElement.innerText;
            }
          } else {
            
            codeText = codeContainer.textContent || codeContainer.innerText;
          }
        }

        
        codeText = codeText.trim();

        
        await navigator.clipboard.writeText(codeText);

        
        copyIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M5 13l4 4L19 7\u0022 \/\u003e\n\u003c\/svg\u003e`;
        if (copyText) {
          copyText.textContent = '복사됨';
        }
        copyBtn.classList.add('text-green-600');

        
        setTimeout(() => {
          copyIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z\u0022 \/\u003e\n\u003c\/svg\u003e`;
          if (copyText) {
            copyText.textContent = '복사';
          }
          copyBtn.classList.remove('text-green-600');
        }, 2000);

      } catch (err) {
        console.error('复制失败:', err);

        
        const range = document.createRange();
        const codeElement = codeContainer.querySelector('code') || codeContainer;
        range.selectNodeContents(codeElement);
        const selection = window.getSelection();
        selection.removeAllRanges();
        selection.addRange(range);

        
        if (copyText) {
          copyText.textContent = '선택됨';
        }

        setTimeout(() => {
          if (copyText) {
            copyText.textContent = '복사';
          }
          selection.removeAllRanges();
        }, 2000);
      }
    });
  }

  
  if (collapseBtn) {
    const collapseIcon = collapseBtn.querySelector('.collapse-icon');
    const collapseText = collapseBtn.querySelector('.collapse-text');
    const collapseOverlay = codeContainer.querySelector('.collapse-overlay');

    
    let codeElement = codeContainer.querySelector('pre.chroma');
    if (!codeElement) {
      codeElement = codeContainer.querySelector('pre');
    }

    const defaultState = collapseBtn.dataset.defaultState || 'expanded';
    const isCollapsedAttr = collapseBtn.dataset.collapsed === 'true';
    const autoCollapseLines = parseInt(collapseBtn.dataset.autoCollapseLines) || 30;
    const autoCollapseHeight = parseInt(collapseBtn.dataset.autoCollapseHeight) || 400;
    const collapsedHeight = parseInt(collapseBtn.dataset.collapsedHeight) || 120;

    let isCollapsed = false;

    
    function initCollapse() {
      
      const shouldCollapse = isCollapsedAttr ||
                           defaultState === 'collapsed' ||
                           shouldAutoCollapse();

      if (shouldCollapse) {
        setCollapsed(true, false); 
      }
    }

    function shouldAutoCollapse() {
      
      if (codeElement) {
        const lines = codeElement.querySelectorAll('.line, .cl');
        const height = codeElement.offsetHeight;
        return lines.length > autoCollapseLines || height > autoCollapseHeight;
      }

      
      const containerHeight = codeContainer.offsetHeight;
      if (containerHeight > autoCollapseHeight) {
        return true;
      }

      
      const textContent = codeContainer.textContent || codeContainer.innerText || '';
      const estimatedLines = textContent.split('\n').length;
      return estimatedLines > autoCollapseLines;
    }

    function setCollapsed(collapsed, animate = true) {
      if (!collapseOverlay) return;

      isCollapsed = collapsed;

      if (collapsed) {
        
        codeContainer.style.maxHeight = collapsedHeight + 'px';
        codeContainer.style.overflow = 'hidden';
        collapseOverlay.style.opacity = '1';
        collapseOverlay.style.pointerEvents = 'auto';

        
        collapseIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M19 9l-7 7-7-7\u0022 \/\u003e\n\u003c\/svg\u003e`;
        if (collapseText) {
          collapseText.textContent = '펼치기';
        }
        collapseBtn.title = '펼치기';

      } else {
        
        codeContainer.style.maxHeight = '';
        codeContainer.style.overflow = '';
        collapseOverlay.style.opacity = '0';
        collapseOverlay.style.pointerEvents = 'none';

        
        collapseIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath fill=\u0022currentColor\u0022 d=\u0022M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z\u0022\/\u003e\u003c\/svg\u003e`;
        if (collapseText) {
          collapseText.textContent = '접기';
        }
        collapseBtn.title = '접기';
      }

      
      if (animate) {
        codeContainer.style.transition = 'max-height 0.3s ease-out';
        setTimeout(() => {
          codeContainer.style.transition = '';
        }, 300);
      }
    }

    function toggleCollapse() {
      setCollapsed(!isCollapsed, true);
    }

    
    collapseBtn.addEventListener('click', toggleCollapse);

    
    if (collapseOverlay) {
      collapseOverlay.addEventListener('click', () => {
        if (isCollapsed) {
          setCollapsed(false, true);
        }
      });
    }

    
    initCollapse();
  }
})();
</script>
<h3 id="한눈에-보는-결론-1">한눈에 보는 결론</h3>
<p><strong>NSA</strong>의 평가 핵심은 “<em>실측 지연 시간( latency )·메모리 접근량</em>”이다.</p>
<ul>
<li><strong>64 k 토큰</strong> 기준 Forward <strong>9 ×</strong>, Backward <strong>6 ×</strong>, Decode <strong>11.6 ×</strong> 가속</li>
<li>같은 조건에서 <strong>KV 로드량</strong>을 65 536 → 5 632 token-eq.로 <strong>11.6 ×</strong> 감축</li>
<li>8 × A100-80 GB 서버에서 초당 <strong>≈ 21 token</strong> 디코딩(추정) → Full-Attention 대비 <strong>≈ 12 배</strong> 처리량 증가</li>
</ul>
<hr>
<h2 id="1-nsa가-사용하는-평가-지표">1. NSA가 사용하는 평가 지표</h2>
<table>
  <thead>
      <tr>
          <th>구분</th>
          <th>지표</th>
          <th>정의·측정 방식</th>
          <th>논문 위치</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>지연 시간</strong></td>
          <td>Forward / Backward / Decode latency (ms)</td>
          <td>Triton 커널 단일 step wall-clock</td>
          <td>Figure 1, 6</td>
      </tr>
      <tr>
          <td><strong>처리량</strong></td>
          <td>Tokens per second (t/s)</td>
          <td>1 step tokens ÷ latency</td>
          <td>Figure 1 속도값으로 추정</td>
      </tr>
      <tr>
          <td><strong>메모리 효율</strong></td>
          <td>Memory-access Tokens</td>
          <td>디코딩 시 GPU HBM에서 읽힌 KV 토큰 환산량</td>
          <td>Table 4</td>
      </tr>
      <tr>
          <td><strong>비용-대-성능</strong></td>
          <td>Speed-up × GPU-수</td>
          <td>동일 HW(A100) 대비 가속 배수</td>
          <td>Figure 6</td>
      </tr>
      <tr>
          <td><strong>(참고)</strong> 정확도</td>
          <td>LongBench, MMLU 등</td>
          <td>효율 지표와 함께 보고</td>
          <td>Table 2</td>
      </tr>
  </tbody>
</table>

  <blockquote
    class="border-primary bg-muted/30 hover:bg-muted/40 my-6 rounded-r-lg border-l-4 py-4 pr-4 pl-6 italic transition-all duration-200 ease-out hover:translate-x-1">
    <div class="prose prose-sm max-w-none">
      <p><strong>전력 소비</strong>는 직접 계측하지 않았으나, 연산 / 메모리 양을 6–12 × 줄였으므로 <em>와트-시/토큰</em>도 비례 감소한다고 추정.</p>
    </div>
  </blockquote>

<hr>
<h2 id="2-64-k-컨텍스트-실측-결과">2. 64 k 컨텍스트 실측 결과</h2>
<table>
  <thead>
      <tr>
          <th>지표</th>
          <th>Full Attention</th>
          <th><strong>NSA</strong></th>
          <th>Speed-up</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>Forward latency</strong></td>
          <td>900 ms</td>
          <td><strong>100 ms</strong></td>
          <td><strong>9.0 ×</strong></td>
      </tr>
      <tr>
          <td><strong>Backward latency</strong></td>
          <td>2 500 ms</td>
          <td><strong>420 ms</strong></td>
          <td><strong>6.0 ×</strong></td>
      </tr>
      <tr>
          <td><strong>Decode latency/step</strong></td>
          <td>560 ms</td>
          <td><strong>48 ms</strong></td>
          <td><strong>11.6 ×</strong></td>
      </tr>
      <tr>
          <td><strong>KV 메모리 로드</strong></td>
          <td>65 536 tok-eq.</td>
          <td><strong>5 632</strong></td>
          <td><strong>11.6 × ↓</strong></td>
      </tr>
      <tr>
          <td><strong>추정 처리량</strong></td>
          <td>≈ 1.8 t/s</td>
          <td><strong>≈ 21 t/s</strong></td>
          <td><strong>~ 12 ×</strong></td>
      </tr>
  </tbody>
</table>
<hr>
<h2 id="3-확장성-분석">3. 확장성 분석</h2>
<h3 id="3-1-시퀀스-길이-l">3-1. 시퀀스 길이 $L$</h3>
<ul>
<li><strong>복잡도</strong>: Full Attn $O(L²)$ → <strong>NSA $O(L log L)$</strong></li>
<li><strong>메모리 로드 감소</strong>가 길이에 따라 선형(표 참조) → 8 k, 16 k, 32 k, 64 k에서 예상 가속 4 × → 11.6 ×</li>
</ul>
<table>
  <thead>
      <tr>
          <th>$L$ (tok)</th>
          <th>8 k</th>
          <th>16 k</th>
          <th>32 k</th>
          <th>64 k</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>KV 로드/step</strong></td>
          <td>2 048</td>
          <td>2 560</td>
          <td>3 584</td>
          <td>5 632</td>
      </tr>
      <tr>
          <td>예정 Speed-up</td>
          <td>4 ×</td>
          <td>6.4 ×</td>
          <td>9.1 ×</td>
          <td>11.6 ×</td>
      </tr>
  </tbody>
</table>
<h3 id="3-2-사용자배치-규모">3-2. 사용자·배치 규모</h3>
<ul>
<li>KV 캐시가 <strong>8–10 × 작아짐</strong> → 동일 GPU VRAM에서도 <strong>더 큰 배치</strong> 혹은 <strong>동시 세션</strong> 수용 가능.</li>
<li>접두사(프리픽스) 공유 요청이 많을수록 메모리 이득이 배가.</li>
</ul>
<h3 id="3-3-컴퓨팅-노드-gpu-확장">3-3. 컴퓨팅 노드 (GPU) 확장</h3>
<ul>
<li>모델 자체는 <strong>모듈러 MoE + GQA</strong> 구조 → 데이터·텐서·파이프라인 병렬화 모두 호환.</li>
<li>Sparse-KV 커널은 <strong>노드 내</strong>에서만 동작하며, 노드 간에는 기존 통신량(grad / expert routing)과 동일 → <strong>GPU 수를 늘려도 선형 스케일</strong>.</li>
<li>단, Triton 커널이 <strong>CUDA Tensor Core</strong> 가정이므로 TPU·모바일 NPU로 옮길 땐 재작성 필요.</li>
</ul>
<h3 id="3-4-비용-대-성능-관점">3-4. 비용-대-성능 관점</h3>
<ul>
<li>
<p>27 B 모델, 260 B 토큰 사전학습 총 연산 ≈ <strong>4.2 × 10²² FLOPs</strong> (≈ 487 PF-days).</p>
<ul>
<li>Sparse FLOPs 자체는 Dense 대비 약 <strong>1/6 – 1/9</strong>; 동일 예산이면 <strong>더 긴 콘텍스트</strong> 또는 <strong>학습 반복</strong> 확보 가능.</li>
</ul>
</li>
<li>
<p><strong>8 × A100</strong> 기준 한 epoch 학습 시간을 Dense 대비 <strong>≈ 6 × 단축</strong> → 클러스터-렌탈 비용도 동일 비율 감소.</p>
</li>
</ul>
<hr>
<h2 id="4-요약--어떤-상황에서-빛나는가">4. 요약 – 어떤 상황에서 빛나는가?</h2>
<table>
  <thead>
      <tr>
          <th>시나리오</th>
          <th>NSA 효율</th>
          <th>이유</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>긴 문맥 (≥ 16 k)</strong></td>
          <td><strong>최대 11.6 ×</strong> 가속</td>
          <td>메모리-접근 병목이 지배 → 로드량 선형 감소</td>
      </tr>
      <tr>
          <td><strong>다중 세션 배치</strong></td>
          <td><strong>VRAM 8× 절감</strong></td>
          <td>KV 캐시 축소로 동시 세션 ↑</td>
      </tr>
      <tr>
          <td><strong>GPU 노드 확대</strong></td>
          <td><strong>근사 선형 스케일</strong></td>
          <td>통신량 불변, 커널-로컬 연산</td>
      </tr>
      <tr>
          <td><strong>짧은 문장(≤ 2 k)</strong></td>
          <td>이득 제한</td>
          <td>희소 준비 오버헤드가 지배</td>
      </tr>
  </tbody>
</table>

  <blockquote
    class="border-primary bg-muted/30 hover:bg-muted/40 my-6 rounded-r-lg border-l-4 py-4 pr-4 pl-6 italic transition-all duration-200 ease-out hover:translate-x-1">
    <div class="prose prose-sm max-w-none">
      <p><strong>Bottom line</strong>: NSA의 성능 평가는 지연 시간·메모리 접근량을 중심으로 하며, 이 두 지표 모두 <strong>시퀀스 길이와 함께 기하급수적으로 개선</strong>된다. 더 많은 데이터·사용자, 그리고 GPU 노드가 붙어도 <strong>선형 또는 초선형</strong>으로 확장되도록 설계됐다는 점이 실전에서 가장 큰 장점이다.</p>
    </div>
  </blockquote>

</details>

  </article>

  
  
  <div class="post-license bg-muted/30 border-border mb-8 rounded-xl border p-6">
    <div class="flex items-start gap-4">
      <div
        class="bg-primary/10 flex h-12 w-12 flex-shrink-0 items-center justify-center rounded-lg">
        
  <svg class="h-6 w-6"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="라이선스"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z" />
</svg>
      </div>

      <div class="flex-1">
        <h3 class="text-foreground mb-2 text-lg font-semibold">
          라이선스
        </h3>

        <div class="text-muted-foreground space-y-2 text-sm">
          
          <p>
            <strong>저작자:</strong>
            류재훈
          </p>
          

          <p>
            <strong>링크:</strong>
            <a
              href="http://192.168.1.11:1314/posts/Native-Sparse-Attention-Hardware-Aligned-and-Natively-Trainable-Sparse-Attention/"
              class="text-primary hover:text-primary/80 transition-colors duration-200">
              http://192.168.1.11:1314/posts/Native-Sparse-Attention-Hardware-Aligned-and-Natively-Trainable-Sparse-Attention/
            </a>
          </p>

          <p>
            <strong>라이선스:</strong>
            <a
              href="https://creativecommons.org/licenses/by-nc-sa/4.0/"
              target="_blank"
              rel="noopener noreferrer"
              class="text-primary hover:text-primary/80 transition-colors duration-200">
              CC BY-NC-SA 4.0
            </a>
          </p>

          <p class="text-xs">
            이 저작물은 크리에이티브 커먼즈 저작자표시-비영리-동일조건변경허락 4.0 국제 라이선스에 따라 이용할 수 있습니다. 출처를 표시하고, 비영리 목적으로만 사용하며, 동일한 라이선스를 유지해야 합니다.
          </p>
        </div>
      </div>
    </div>
  </div>


  
  





  <nav
    class="post-navigation mb-12"
    aria-label="게시글 네비게이션">
    <div class="grid grid-cols-1 gap-4 md:grid-cols-2">
      
      <div class="nav-item">
        
          <a
            href="/posts/%EB%94%94%EC%A7%80%ED%84%B8-%EB%93%9C%EB%9E%98%EA%B3%A4%EC%9D%98-%EC%8B%AC%EC%9E%A5-AI-%EC%8B%9C%EB%8C%80-%EC%A4%91%EA%B5%AD-%EB%8D%B0%EC%9D%B4%ED%84%B0%EC%84%BC%ED%84%B0-%EB%B0%B0%ED%84%B0%EB%A6%AC-%EC%8B%9C%EC%9E%A5%EC%97%90-%ED%88%AC%EC%9E%90%ED%95%B4%EC%95%BC-%ED%95%98%EB%8A%94-%EC%9D%B4%EC%9C%A0/"
            class="group bg-card border-border hover:bg-primary/5 hover:border-primary/20 focus:ring-primary/20 flex min-h-[140px] flex-col justify-between rounded-xl border p-6 transition-all duration-300 ease-out hover:-translate-y-1 hover:scale-[1.02] hover:shadow-lg focus:ring-2 focus:outline-none">
            <div>
              <div class="mb-3 flex items-center gap-3">
                
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
</svg>
                <span class="text-muted-foreground text-sm font-medium">
                  이전
                </span>
              </div>

              <h3
                class="text-foreground group-hover:text-primary mb-3 line-clamp-2 text-lg leading-tight font-semibold transition-colors duration-200">
                디지털 드래곤의 심장: AI 시대, 중국 데이터센터 배터리 시장에 투자해야 하는 이유
              </h3>
            </div>

            <div
              class="text-muted-foreground mt-auto flex items-center gap-2 text-xs">
              
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
</svg>
              <time datetime="2025-07-07">
                07月07日
              </time>
            </div>
          </a>
        
      </div>

      
      <div class="nav-item">
        
          <a
            href="/posts/Code-I/O-Condensing-Reasoning-Patterns-via-Code-Input-Output-Prediction/"
            class="group bg-card border-border hover:bg-primary/5 hover:border-primary/20 focus:ring-primary/20 flex min-h-[140px] flex-col justify-between rounded-xl border p-6 transition-all duration-300 ease-out hover:-translate-y-1 hover:scale-[1.02] hover:shadow-lg focus:ring-2 focus:outline-none">
            <div>
              <div class="mb-3 flex items-center justify-end gap-3">
                <span class="text-muted-foreground text-sm font-medium">
                  다음
                </span>
                
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
</svg>
              </div>

              <h3
                class="text-foreground group-hover:text-primary mb-3 line-clamp-2 text-right text-lg leading-tight font-semibold transition-colors duration-200">
                Code I/O: Condensing Reasoning Patterns via Code Input-Output Prediction
              </h3>
            </div>

            <div
              class="text-muted-foreground mt-auto flex items-center justify-end gap-2 text-xs">
              <time datetime="2025-07-07">
                07月07日
              </time>
              
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
</svg>
            </div>
          </a>
        
      </div>
    </div>
  </nav>




  
  







  <section class="related-posts mb-12">
    
    <div class="mb-6 flex items-center gap-3">
      
  <svg class="h-5 w-5"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1" />
</svg>
      <h2 class="text-foreground text-2xl font-bold">
        관련 게시글
      </h2>
    </div>

    
    
    
    
    
      
    

    <div class="grid grid-cols-1 gap-6 md:grid-cols-2 lg:grid-cols-3">
      
        
        














  
  <article class="related-card group">
    <a href="/posts/Code-I/O-Condensing-Reasoning-Patterns-via-Code-Input-Output-Prediction/" class="block h-full">
      <div
        class="bg-card border-border hover:bg-primary/5 hover:border-primary/20 focus:ring-primary/20 flex h-full flex-col overflow-hidden rounded-xl border transition-all duration-300 ease-out hover:-translate-y-1 hover:scale-[1.02] hover:shadow-lg focus:ring-2 focus:outline-none">
        
        <div class="relative aspect-[16/9] flex-shrink-0 overflow-hidden">
    
    <div class="from-blue-500/20 to-purple-500/10 relative aspect-[16/9] overflow-hidden bg-gradient-to-br" style="background-blend-mode: overlay; background-color: color-mix(in srgb, var(--color-primary) 15%, transparent);">
      
      <div class="absolute inset-0">
        
          
          
          <div class="absolute left-[20%] top-[20%] h-6 w-6 rounded-full border-2 border-white/80 bg-white/15"></div>
          
          <div class="absolute right-[25%] top-[25%] h-5 w-5 rounded-full border border-white/70 bg-white/12"></div>
          
          <div class="absolute left-[30%] bottom-[30%] h-4 w-4 rounded-full border border-white/60 bg-white/10"></div>
          
          <div class="absolute right-[20%] bottom-[20%] h-5 w-5 rounded-full border border-white/65 bg-white/13"></div>
          
          <div class="absolute left-[45%] top-[45%] h-3 w-3 rounded-full border border-white/50 bg-white/8"></div>
          
          <div class="absolute right-[35%] top-[35%] h-2 w-2 rounded-full bg-white/50"></div>
          <div class="absolute left-[40%] bottom-[35%] h-1.5 w-1.5 rounded-full bg-white/45"></div>
          <div class="absolute left-[35%] top-[50%] h-1 w-1 rounded-full bg-white/40"></div>
          <div class="absolute right-[40%] bottom-[50%] h-1 w-1 rounded-full bg-white/35"></div>
          <div class="absolute left-[50%] top-[30%] h-1 w-1 rounded-full bg-white/30"></div>
          <div class="absolute right-[50%] bottom-[30%] h-1 w-1 rounded-full bg-white/25"></div>
          
          <div class="absolute top-[40%] left-[15%] h-0.5 w-6 rotate-30 bg-white/25"></div>
          <div class="absolute bottom-[40%] right-[15%] h-0.5 w-4 -rotate-30 bg-white/20"></div>
        
      </div>
    </div>
  
</div>

        
        <div class="flex min-h-0 flex-1 flex-col p-4">
          
          <div class="space-y-3 flex-1">
            
            <h3
              class="text-foreground group-hover:text-primary line-clamp-2 text-base leading-tight font-semibold transition-colors duration-200">
              Code I/O: Condensing Reasoning Patterns via Code Input-Output Prediction
            </h3>

            
            
              <div class="flex-1 min-h-[40px]">
                
                  <p
                    class="text-muted-foreground line-clamp-2 text-sm leading-relaxed">
                    논문 링크
CODE I/O: 코드 입·출력 + 자연어 CoT로 범용 추론까지 — 데이터 설계만으로 7B-30B LLM을 평균 +2 …
                  </p>
                
              </div>
            
          </div>

          
          
            <div class="flex-shrink-0 mt-4">
              













  <div class="text-muted-foreground mb-3 flex flex-shrink-0 items-center justify-between text-xs">
    
    
      
      
      
      
        <div class="flex items-center gap-1">
          
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="작성일"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
</svg>
          <time datetime="2025-07-07">
            07월 07일
          </time>
        </div>
      

      
      
        <div class="flex items-center gap-1">
          
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="읽는 시간"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
</svg>
          <span>31분</span>
        </div>
      
      
    
  </div>




            </div>
          
        </div>
      </div>
    </a>
  </article>


      
        
        














  
  <article class="related-card group">
    <a href="/posts/DeepSeek-R1-Incentivizing-Reasoning-Capability-in-LLMs-via-Reinforcement-Learning/" class="block h-full">
      <div
        class="bg-card border-border hover:bg-primary/5 hover:border-primary/20 focus:ring-primary/20 flex h-full flex-col overflow-hidden rounded-xl border transition-all duration-300 ease-out hover:-translate-y-1 hover:scale-[1.02] hover:shadow-lg focus:ring-2 focus:outline-none">
        
        <div class="relative aspect-[16/9] flex-shrink-0 overflow-hidden">
    
    <div class="from-blue-500/20 to-purple-500/10 relative aspect-[16/9] overflow-hidden bg-gradient-to-br" style="background-blend-mode: overlay; background-color: color-mix(in srgb, var(--color-primary) 15%, transparent);">
      
      <div class="absolute inset-0">
        
          
          
          <div class="absolute left-[20%] top-[20%] h-6 w-6 rounded-full border-2 border-white/80 bg-white/15"></div>
          
          <div class="absolute right-[25%] top-[25%] h-5 w-5 rounded-full border border-white/70 bg-white/12"></div>
          
          <div class="absolute left-[30%] bottom-[30%] h-4 w-4 rounded-full border border-white/60 bg-white/10"></div>
          
          <div class="absolute right-[20%] bottom-[20%] h-5 w-5 rounded-full border border-white/65 bg-white/13"></div>
          
          <div class="absolute left-[45%] top-[45%] h-3 w-3 rounded-full border border-white/50 bg-white/8"></div>
          
          <div class="absolute right-[35%] top-[35%] h-2 w-2 rounded-full bg-white/50"></div>
          <div class="absolute left-[40%] bottom-[35%] h-1.5 w-1.5 rounded-full bg-white/45"></div>
          <div class="absolute left-[35%] top-[50%] h-1 w-1 rounded-full bg-white/40"></div>
          <div class="absolute right-[40%] bottom-[50%] h-1 w-1 rounded-full bg-white/35"></div>
          <div class="absolute left-[50%] top-[30%] h-1 w-1 rounded-full bg-white/30"></div>
          <div class="absolute right-[50%] bottom-[30%] h-1 w-1 rounded-full bg-white/25"></div>
          
          <div class="absolute top-[40%] left-[15%] h-0.5 w-6 rotate-30 bg-white/25"></div>
          <div class="absolute bottom-[40%] right-[15%] h-0.5 w-4 -rotate-30 bg-white/20"></div>
        
      </div>
    </div>
  
</div>

        
        <div class="flex min-h-0 flex-1 flex-col p-4">
          
          <div class="space-y-3 flex-1">
            
            <h3
              class="text-foreground group-hover:text-primary line-clamp-2 text-base leading-tight font-semibold transition-colors duration-200">
              DeepSeek-R1: Incentivizing Reasoning Capability in LLMs via Reinforcement Learning
            </h3>

            
            
              <div class="flex-1 min-h-[40px]">
                
                  <p
                    class="text-muted-foreground line-clamp-2 text-sm leading-relaxed">
                    논문 링크
DeepSeek-R1: 공개 RL-Only 파이프라인으로 o1 급 추론을 재현하다 TL;DR** DeepSeek-R1 …
                  </p>
                
              </div>
            
          </div>

          
          
            <div class="flex-shrink-0 mt-4">
              













  <div class="text-muted-foreground mb-3 flex flex-shrink-0 items-center justify-between text-xs">
    
    
      
      
      
      
        <div class="flex items-center gap-1">
          
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="작성일"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
</svg>
          <time datetime="2025-07-06">
            07월 06일
          </time>
        </div>
      

      
      
        <div class="flex items-center gap-1">
          
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="읽는 시간"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
</svg>
          <span>30분</span>
        </div>
      
      
    
  </div>




            </div>
          
        </div>
      </div>
    </a>
  </article>


      
        
        














  
  <article class="related-card group">
    <a href="/posts/Janus-Pro-UnifiedMultimodalUnderstanding-and-Generation-with-Data-and-Model-Scaling/" class="block h-full">
      <div
        class="bg-card border-border hover:bg-primary/5 hover:border-primary/20 focus:ring-primary/20 flex h-full flex-col overflow-hidden rounded-xl border transition-all duration-300 ease-out hover:-translate-y-1 hover:scale-[1.02] hover:shadow-lg focus:ring-2 focus:outline-none">
        
        <div class="relative aspect-[16/9] flex-shrink-0 overflow-hidden">
    
    <div class="from-teal-500/20 to-green-500/10 relative aspect-[16/9] overflow-hidden bg-gradient-to-br" style="background-blend-mode: overlay; background-color: color-mix(in srgb, var(--color-primary) 15%, transparent);">
      
      <div class="absolute inset-0">
        
          
          
          <div class="absolute left-[20%] top-[20%] h-5 w-5 rotate-45 border-2 border-white/80 bg-white/15"></div>
          
          <div class="absolute right-[25%] top-[25%] h-4 w-4 rotate-12 border border-white/70 bg-white/12"></div>
          
          <div class="absolute left-[30%] bottom-[30%] h-3 w-3 rotate-60 border border-white/60 bg-white/10"></div>
          
          <div class="absolute right-[20%] bottom-[20%] h-4 w-4 rotate-30 border border-white/65 bg-white/13"></div>
          
          <div class="absolute left-[45%] top-[45%] h-2 w-2 rotate-45 border border-white/50 bg-white/8"></div>
          
          <div class="absolute left-[15%] top-[40%] h-0.5 w-8 rotate-45 bg-white/40"></div>
          <div class="absolute right-[15%] top-[35%] h-0.5 w-6 rotate-12 bg-white/35"></div>
          <div class="absolute left-[40%] bottom-[15%] h-0.5 w-5 -rotate-30 bg-white/30"></div>
          
          <div class="absolute top-[35%] right-[40%] h-2 w-2 rounded-full bg-white/35"></div>
          <div class="absolute bottom-[40%] left-[35%] h-1.5 w-1.5 rounded-full bg-white/30"></div>
          <div class="absolute top-[50%] left-[50%] h-1 w-1 rounded-full bg-white/25"></div>
        
      </div>
    </div>
  
</div>

        
        <div class="flex min-h-0 flex-1 flex-col p-4">
          
          <div class="space-y-3 flex-1">
            
            <h3
              class="text-foreground group-hover:text-primary line-clamp-2 text-base leading-tight font-semibold transition-colors duration-200">
              Janus-Pro: UnifiedMultimodalUnderstanding and Generation with Data and Model Scaling
            </h3>

            
            
              <div class="flex-1 min-h-[40px]">
                
                  <p
                    class="text-muted-foreground line-clamp-2 text-sm leading-relaxed">
                    논문 링크
Janus-Pro 7B: Dual-Encoder Multimodal LLM That Outsmarts Bigger Models …
                  </p>
                
              </div>
            
          </div>

          
          
            <div class="flex-shrink-0 mt-4">
              













  <div class="text-muted-foreground mb-3 flex flex-shrink-0 items-center justify-between text-xs">
    
    
      
      
      
      
        <div class="flex items-center gap-1">
          
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="작성일"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
</svg>
          <time datetime="2025-07-06">
            07월 06일
          </time>
        </div>
      

      
      
        <div class="flex items-center gap-1">
          
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="읽는 시간"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
</svg>
          <span>31분</span>
        </div>
      
      
    
  </div>




            </div>
          
        </div>
      </div>
    </a>
  </article>


      
    </div>

    
    
    
    
      <div class="mt-8 text-center">
        <a
          href="/posts/"
          class="text-primary hover:text-primary/80 focus:ring-primary/20 inline-flex items-center gap-2 rounded-lg px-4 py-2 font-medium transition-all duration-200 ease-out hover:-translate-y-0.5 hover:scale-105 focus:ring-2 focus:outline-none">
          <span
            >더 많은 게시글 보기</span
          >
          
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
</svg>
        </a>
      </div>
    

  </section>




  
  


    </main>

    <footer class="mx-auto max-w-4xl px-4 py-8">
  <div class="px-6 py-6">
    
    
      <nav class="mb-6">
        <div class="flex flex-wrap items-center justify-center gap-1">
          
            
            
            
            <a
              href="/index.xml"
              
              class="nav-link hover:text-primary hover:bg-primary/10 text-muted-foreground flex items-center gap-2 rounded-lg px-4 py-2 text-sm font-medium transition-all duration-300 hover:scale-105">
              
                
  <svg class="h-5 w-5"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="RSS Feed">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 5c7.18 0 13 5.82 13 13M6 11a7 7 0 017 7m-6 0a1 1 0 11-2 0 1 1 0 012 0z" />

</svg>
              
              <span
                >
                  RSS Feed
                </span
              >
            </a>
          
        </div>
      </nav>
    


    
    
      <div class="border-border mb-6 border-t"></div>
    


    
    <div class="flex flex-col items-center justify-between gap-4 md:flex-row">
      
      <div class="text-muted-foreground text-sm">
        <p>
          &copy; 2025 Jaehun&#39;s Blog.
          모든 권리 보유.
        </p>
      </div>

      
      
        <div class="flex items-center gap-3">
          
            <a
              href="https://github.com/ryujaehun"
              
                target="_blank" rel="noopener noreferrer"
              
              class="text-muted-foreground hover:text-primary focus:ring-primary/20 rounded-lg p-1 transition-all duration-300 ease-out hover:scale-110 focus:ring-2 focus:outline-none"
              title="GitHub"
              aria-label="GitHub">
              
                
  <svg class="h-6 w-6"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="GitHub"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"><path d="M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5c.08-1.25-.27-2.48-1-3.5c.28-1.15.28-2.35 0-3.5c0 0-1 0-3 1.5c-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.4 5.4 0 0 0 4 9c0 3.5 3 5.5 6 5.5c-.39.49-.68 1.05-.85 1.65S8.93 17.38 9 18v4"/><path d="M9 18c-4.51 2-5-2-7-2"/></g></svg>
              
            </a>
          
            <a
              href="https://www.linkedin.com/in/jaehunryu/"
              
                target="_blank" rel="noopener noreferrer"
              
              class="text-muted-foreground hover:text-primary focus:ring-primary/20 rounded-lg p-1 transition-all duration-300 ease-out hover:scale-110 focus:ring-2 focus:outline-none"
              title="Linkedin"
              aria-label="Linkedin">
              
                
  <svg class="h-6 w-6"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="Linkedin"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"><path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2a2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6M2 9h4v12H2z"/><circle cx="4" cy="4" r="2"/></g></svg>
              
            </a>
          
            <a
              href="mailto:jaehunryu@icloud.com"
              
              class="text-muted-foreground hover:text-primary focus:ring-primary/20 rounded-lg p-1 transition-all duration-300 ease-out hover:scale-110 focus:ring-2 focus:outline-none"
              title="Email"
              aria-label="Email">
              
                
  <svg class="h-6 w-6"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="Email">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />

</svg>
              
            </a>
          
        </div>
      

    </div>
  </div>
</footer>


    
    



<div
  id="dock"
  class="pointer-events-none fixed bottom-4 left-1/2 z-[9999] w-fit -translate-x-1/2 translate-y-24 opacity-0 transition-all duration-300 ease-out sm:right-0 sm:left-0 sm:mx-auto sm:translate-x-0"
  role="toolbar"
  aria-label="바로가기 도구 모음">
  <nav
    class="border-border bg-card/80 scrollbar-hide xs:px-3 xs:py-2 mx-auto flex max-w-[calc(100vw-2rem)] min-w-fit items-center justify-center overflow-x-auto rounded-2xl border px-4 py-3 shadow-lg backdrop-blur-sm sm:px-4 sm:py-3">
    
    
      <button
        id="dock-back"
        class="text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 xs:px-2 xs:py-1.5 flex flex-shrink-0 items-center gap-2 rounded-lg px-3 py-2 text-sm font-medium transition-all duration-300 ease-out hover:-translate-y-0.5 hover:scale-105 focus:ring-2 focus:outline-none sm:px-3 sm:py-2"
        title="뒤로"
        aria-label="뒤로">
        
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24">
  <path d="m12 19-7-7 7-7"/>
  <path d="M19 12H5"/>

</svg>
        <span class="hidden sm:inline"
          >뒤로</span
        >
      </button>

      
      <div class="bg-border xs:mx-1 mx-2 h-6 w-px sm:mx-2"></div>
    


    
    
      <button
        id="dock-toc"
        class="text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 xs:px-2 xs:py-1.5 flex flex-shrink-0 items-center gap-2 rounded-lg px-3 py-2 text-sm font-medium transition-all duration-300 ease-out hover:-translate-y-0.5 hover:scale-105 focus:ring-2 focus:outline-none sm:px-3 sm:py-2"
        title="목차"
        aria-label="목차">
        
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24">
  <line x1="8" x2="21" y1="6" y2="6"/>
  <line x1="8" x2="21" y1="12" y2="12"/>
  <line x1="8" x2="21" y1="18" y2="18"/>
  <line x1="3" x2="3.01" y1="6" y2="6"/>
  <line x1="3" x2="3.01" y1="12" y2="12"/>
  <line x1="3" x2="3.01" y1="18" y2="18"/>

</svg>
        <span class="hidden sm:inline"
          >목차</span
        >
      </button>

      
      <div class="bg-border xs:mx-1 mx-2 h-6 w-px sm:mx-2"></div>
    


    
    <button
      id="dock-search"
      class="text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 xs:px-3 xs:py-1.5 flex flex-shrink-0 items-center gap-2 rounded-lg px-4 py-2 text-sm font-medium transition-all duration-300 ease-out hover:-translate-y-0.5 hover:scale-105 focus:ring-2 focus:outline-none sm:px-4 sm:py-2"
      title="검색"
      aria-label="검색">
      
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m21 21-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />

</svg>
      <span class="hidden md:inline"
        >검색</span
      >
    </button>

    
    <div class="bg-border xs:mx-1 mx-2 h-6 w-px sm:mx-2"></div>

    
    
    


    
    <button
      id="dock-top"
      class="text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 xs:px-2 xs:py-1.5 flex flex-shrink-0 items-center gap-2 rounded-lg px-3 py-2 text-sm font-medium transition-all duration-300 ease-out hover:-translate-y-0.5 hover:scale-105 focus:ring-2 focus:outline-none sm:px-3 sm:py-2"
      title="맨 위로"
      aria-label="맨 위로">
      
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24">
  <path d="m18 15-6-6-6 6"/>

</svg>
      <span class="hidden sm:inline"
        >맨 위로</span
      >
    </button>
  </nav>
</div>


    
      



<div
  id="toc-overlay"
  class="pointer-events-none fixed inset-0 z-40 bg-black/50 opacity-0 backdrop-blur-sm transition-all duration-300"
  role="dialog"
  aria-modal="true"
  aria-labelledby="toc-title"></div>


<div
  id="toc-card"
  class="pointer-events-none fixed inset-4 z-50 flex w-auto scale-95 items-center justify-center opacity-0 transition-all duration-300 sm:inset-auto sm:top-1/2 sm:left-1/2 sm:block sm:w-full sm:max-w-md sm:-translate-x-1/2 sm:-translate-y-1/2"
  role="dialog"
  aria-modal="true"
  aria-labelledby="toc-title">
  <div
    class="bg-card border-border w-full max-w-sm overflow-hidden rounded-xl border shadow-xl sm:max-w-md">
    
    <div
      class="border-border bg-muted/30 flex items-center justify-between border-b p-4">
      <div class="flex items-center gap-3">
        
  <svg class="h-5 w-5"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24">
  <line x1="8" x2="21" y1="6" y2="6"/>
  <line x1="8" x2="21" y1="12" y2="12"/>
  <line x1="8" x2="21" y1="18" y2="18"/>
  <line x1="3" x2="3.01" y1="6" y2="6"/>
  <line x1="3" x2="3.01" y1="12" y2="12"/>
  <line x1="3" x2="3.01" y1="18" y2="18"/>

</svg>
        <h2 id="toc-title" class="text-foreground text-lg font-semibold">
          목차
        </h2>
      </div>

      
      <button
        id="toc-close"
        class="text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 rounded-lg p-2 transition-all duration-200 ease-out hover:-translate-y-0.5 hover:scale-105 focus:ring-2 focus:outline-none"
        title="닫기"
        aria-label="닫기">
        
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />

</svg>
      </button>
    </div>

    
    <div class="max-h-96 overflow-y-auto p-4">
      <nav
        id="toc-nav"
        class="toc-scrollbar"
        aria-label="글 목차">
          
          <div id="toc-content">
            <nav id="TableOfContents">
  <ul>
    <li><a href="#한-줄-요약-tldr">한 줄 요약 (TL;DR)</a></li>
    <li><a href="#핵심-아이디어">핵심 아이디어</a></li>
    <li><a href="#배경-그들이-해결한-문제">배경: 그들이 해결한 문제</a></li>
    <li><a href="#새로운-접근법-natively-sparse-attention-nsa">새로운 접근법: <em>Natively Sparse Attention</em> (NSA)</a></li>
    <li><a href="#작동-원리-구체적인-예시로-살펴보기">작동 원리: 구체적인 예시로 살펴보기</a></li>
    <li><a href="#성능-검증-주요-결과">성능 검증: 주요 결과</a>
      <ul>
        <li><a href="#1-64-k-토큰-실측-속도--메모리">1. 64 k 토큰 실측 속도 · 메모리</a></li>
        <li><a href="#2-품질-지표">2. 품질 지표</a></li>
        <li><a href="#3-베이스라인-비교-64-k">3. 베이스라인 비교 (64 k)</a></li>
      </ul>
    </li>
    <li><a href="#우리의-관점-강점-한계-그리고-이-연구가-중요한-이유">우리의 관점: 강점, 한계, 그리고 이 연구가 중요한 이유</a>
      <ul>
        <li><a href="#강점">강점</a></li>
        <li><a href="#한계">한계</a></li>
        <li><a href="#왜-중요한가">왜 중요한가?</a></li>
      </ul>
    </li>
    <li><a href="#다음-단계는-앞으로의-길">다음 단계는?: 앞으로의 길</a>
      <ul>
        <li><a href="#토글을-클릭하면-논문에-대한-자세한-llm-질의응답-내용을-확인할-수-있습니다">토글을 클릭하면 논문에 대한 자세한 LLM 질의응답 내용을 확인할 수 있습니다.</a></li>
      </ul>
    </li>
  </ul>

  <ul>
    <li>
      <ul>
        <li><a href="#한눈에-보는-결론--왜-nsa가-필요한가">한눈에 보는 결론 — 왜 <strong>NSA</strong>가 필요한가?</a></li>
      </ul>
    </li>
    <li><a href="#1-연구-공백-research-gap">1. 연구 공백 (Research Gap)</a></li>
    <li><a href="#2-최신-기술state-of-the-art-요약">2. 최신 기술(State of the Art) 요약</a></li>
    <li><a href="#3-정리">3. 정리</a></li>
  </ul>

  <ul>
    <li>
      <ul>
        <li><a href="#결론-한-줄-요약">결론 한 줄 요약</a></li>
      </ul>
    </li>
    <li><a href="#독창적-기여-top-3">독창적 기여 (top-3)</a></li>
  </ul>

  <ul>
    <li>
      <ul>
        <li><a href="#한눈에-보는-결론">한눈에 보는 결론</a></li>
      </ul>
    </li>
    <li><a href="#저자-관점에서의-4대-강점">저자 관점에서의 4대 강점</a>
      <ul>
        <li><a href="#속도-체감치-한눈에-보기">속도 체감치 한눈에 보기</a></li>
      </ul>
    </li>
    <li><a href="#요약--저자들의-핵심-논거-정리">요약 — 저자들의 핵심 논거 정리</a></li>
  </ul>

  <ul>
    <li>
      <ul>
        <li><a href="#tldr--nsa-attention-한눈-요약">TL;DR — NSA Attention 한눈 요약</a></li>
      </ul>
    </li>
    <li><a href="#1-용어--하이퍼파라미터-정의">1. 용어 &amp; 하이퍼파라미터 정의</a></li>
    <li><a href="#2-nsa-알고리즘--7-단계-흐름">2. NSA 알고리즘 ― 7-단계 흐름</a>
      <ul>
        <li><a href="#33-픽셀-시각화-토큰-값이-밝기">3×3 픽셀 시각화 (토큰 값이 밝기)</a></li>
      </ul>
    </li>
    <li><a href="#3-전체-파이프라인-내-변환-흐름">3. 전체 파이프라인 내 변환 흐름</a></li>
    <li><a href="#4-성능--효율-지표-64-k-문맥-27-b-모델">4. 성능 · 효율 지표 (64 k 문맥, 27 B 모델)</a></li>
    <li><a href="#5-왜-이렇게-빠른가--요점-정리">5. 왜 이렇게 빠른가? — 요점 정리</a>
      <ul>
        <li><a href="#끝맺음">끝맺음</a></li>
      </ul>
    </li>
  </ul>

  <ul>
    <li>
      <ul>
        <li><a href="#비밀-병기-한-줄-요약">비밀 병기 한 줄 요약</a></li>
      </ul>
    </li>
    <li><a href="#왜-식-11이-필수적인가">왜 식 11이 필수적인가?</a></li>
    <li><a href="#실측-임팩트-27-b-모델-64-k-토큰">실측 임팩트 (27 B 모델, 64 k 토큰)</a>
      <ul>
        <li><a href="#핵심-정리">핵심 정리</a></li>
      </ul>
    </li>
  </ul>

  <ul>
    <li>
      <ul>
        <li><a href="#--압축-결론--nsa가-증명한-것">🚀  <strong>압축 결론 — NSA가 증명한 것</strong></a></li>
      </ul>
    </li>
    <li><a href="#1-사용된-핵심-성능-지표">1. 사용된 핵심 성능 지표</a></li>
    <li><a href="#2-벤치마크-및-데이터셋">2. 벤치마크 및 데이터셋</a></li>
    <li><a href="#3-저자들이-강조한-성공-증거-4가지">3. 저자들이 강조한 ‘성공 증거’ 4가지</a></li>
    <li><a href="#4-핵심-인사이트">4. 핵심 인사이트</a></li>
  </ul>

  <ul>
    <li>
      <ul>
        <li><a href="#결론-압축--nsa가-속도메모리정확도-3축-모두에서-우위를-보였으나-짧은-컨텍스트코딩bembpp-과제에서는-개선폭이-미미하거나-오히려-밀렸고-저자들은-희소화-오버헤드와-압축-손실을-원인으로-든다">결론 압축 — NSA가 <strong>속도·메모리·정확도</strong> 3축 모두에서 우위를 보였으나, <strong>짧은 컨텍스트·코딩(BE/MBPP) 과제</strong>에서는 개선폭이 미미하거나 오히려 밀렸고, 저자들은 “희소화 오버헤드와 압축 손실”을 원인으로 든다.</a></li>
      </ul>
    </li>
    <li><a href="#1-sota베이스라인별-핵심-비교">1. SOTA·베이스라인별 핵심 비교</a></li>
    <li><a href="#2-세부-비교-포인트">2. 세부 비교 포인트</a>
      <ul>
        <li><a href="#21-속도메모리">2.1 속도·메모리</a></li>
        <li><a href="#22-정확도">2.2 정확도</a></li>
      </ul>
    </li>
    <li><a href="#3-nsa가-못-이긴-구간--저자-해석">3. NSA가 못 이긴 구간 &amp; 저자 해석</a></li>
    <li><a href="#4-요약--비판적-시사점">4. 요약 — 비판적 시사점</a></li>
  </ul>

  <ul>
    <li>
      <ul>
        <li><a href="#-핵심-결론--한-줄-요약">📝 핵심 결론 — 한 줄 요약</a></li>
      </ul>
    </li>
    <li><a href="#1-저자가-명시적으로-언급한-한계실패-모드-explicit">1. 저자가 <strong>명시적으로</strong> 언급한 한계·실패 모드 (Explicit)</a></li>
    <li><a href="#2-잠재적저자가-미처-언급하지-않은-한계-analysts-view">2. <strong>잠재적</strong> (저자가 미처 언급하지 않은) 한계 (Analyst’s View)</a></li>
    <li><a href="#3-종합-정리">3. 종합 정리</a></li>
  </ul>

  <ul>
    <li>
      <ul>
        <li><a href="#미래-연구-과제--저자-의도-vs-후속-발전-전략">미래 연구 과제 — 저자 의도 vs 후속 발전 전략</a></li>
      </ul>
    </li>
  </ul>

  <ul>
    <li><a href="#1-어텐션-메커니즘-구성">1. 어텐션 메커니즘 구성</a>
      <ul>
        <li><a href="#1-a-grouped-query-attention-gqa">1-A. Grouped-Query Attention (GQA)</a></li>
        <li><a href="#1-b-nsa-3-branch-sparse-attention">1-B. NSA 3-Branch Sparse Attention</a></li>
      </ul>
    </li>
    <li><a href="#2-위치-인코딩-처리">2. 위치 인코딩 처리</a></li>
    <li><a href="#3-한눈에-보는-흐름-토이-예시">3. 한눈에 보는 흐름 (토이 예시)</a></li>
    <li><a href="#4-정리">4. 정리</a></li>
  </ul>

  <ul>
    <li><a href="#결론--핵심-자원-요구와-실측-효율">결론 — 핵심 자원 요구와 실측 효율</a>
      <ul>
        <li><a href="#1-핵심-소프트웨어-의존성">1. 핵심 소프트웨어 의존성</a></li>
        <li><a href="#2-메모리--처리량-프로파일">2. 메모리 &amp; 처리량 프로파일</a>
          <ul>
            <li><a href="#2-1-디코딩-단계--kv-로드-절감">2-1. 디코딩 단계 – KV 로드 절감</a></li>
            <li><a href="#2-2-학습-단계--end-to-end-latency">2-2. 학습 단계 – End-to-End Latency</a></li>
          </ul>
        </li>
        <li><a href="#3-전체-학습-연산량-flops">3. 전체 학습 연산량 (FLOPs)</a></li>
        <li><a href="#4-추론-처리량-64-k-컨텍스트">4. 추론 처리량 (64 k 컨텍스트)</a></li>
        <li><a href="#5-요약--사용자가-알아둘-실전-포인트">5. 요약 – 사용자가 알아둘 실전 포인트</a></li>
      </ul>
    </li>
  </ul>

  <ul>
    <li>
      <ul>
        <li><a href="#한눈에-보는-결론-1">한눈에 보는 결론</a></li>
      </ul>
    </li>
    <li><a href="#1-nsa가-사용하는-평가-지표">1. NSA가 사용하는 평가 지표</a></li>
    <li><a href="#2-64-k-컨텍스트-실측-결과">2. 64 k 컨텍스트 실측 결과</a></li>
    <li><a href="#3-확장성-분석">3. 확장성 분석</a>
      <ul>
        <li><a href="#3-1-시퀀스-길이-l">3-1. 시퀀스 길이 $L$</a></li>
        <li><a href="#3-2-사용자배치-규모">3-2. 사용자·배치 규모</a></li>
        <li><a href="#3-3-컴퓨팅-노드-gpu-확장">3-3. 컴퓨팅 노드 (GPU) 확장</a></li>
        <li><a href="#3-4-비용-대-성능-관점">3-4. 비용-대-성능 관점</a></li>
      </ul>
    </li>
    <li><a href="#4-요약--어떤-상황에서-빛나는가">4. 요약 – 어떤 상황에서 빛나는가?</a></li>
  </ul>
</nav>
          </div>
      </nav>
    </div>

    
    <div class="border-border bg-muted/20 border-t px-4 py-3">
      <div class="text-muted-foreground text-center text-xs">
        <span>제목을 클릭하면 해당 위치로 이동합니다</span>
      </div>
    </div>
  </div>
</div>

    


  <link
    rel="stylesheet"
    href="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.css"
    integrity="sha384-5TcZemv2l/9On385z///+d7MSYlvIEw9FuZTIdZ14vJLqWphw7e7ZPuOiCHJcFCP"
    crossorigin="anonymous" />
  <script
    defer
    src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.js"
    integrity="sha384-cMkvdD8LoxVzGF/RPUKAcvmm49FQ0oxwDF3BGKtDXcEc+T1b2N+teh/OJfpU0jr6"
    crossorigin="anonymous"></script>
  <script
    defer
    src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/contrib/auto-render.min.js"
    integrity="sha384-hCXGrW6PitJEwbkoStFjeJxv+fSOOQKOPbJxSfM6G5sWZjAyWhXiTIIAmQqnlLlh"
    crossorigin="anonymous"></script>

<script>
    
    function initKaTeX() {
        if (typeof renderMathInElement === 'undefined') {
            setTimeout(initKaTeX, 100);
            return;
        }

        var delimiters = [{"display":true,"left":"$$","right":"$$"},{"display":false,"left":"$","right":"$"}];

        renderMathInElement(document.body, {
            delimiters: delimiters,
            throwOnError: false,
            errorColor: '#cc0000',
            fleqn: false,
            leqno: false,
            trust: false
        });
    }

    
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', initKaTeX);
    } else {
        initKaTeX();
    }
</script>
    



    
    
<div
  id="search-overlay"
  class="pointer-events-none fixed inset-0 z-40 bg-black/50 opacity-0 transition-opacity duration-300"></div>


<div
  id="search-modal"
  class="bg-card border-border pointer-events-none fixed top-1/2 left-1/2 z-50 max-h-[80vh] w-full max-w-2xl -translate-x-1/2 -translate-y-1/2 scale-95 transform overflow-hidden rounded-xl border opacity-0 shadow-xl transition-all duration-300">
  
  <div class="border-border flex items-center gap-3 border-b p-4">
    
    <div class="text-muted-foreground h-5 w-5 flex-shrink-0">
      
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m21 21-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />

</svg>
    </div>

    
    <div class="relative flex-1">
      
      <button
        id="search-clear"
        class="text-muted-foreground hover:text-foreground hover:bg-muted/50 pointer-events-none absolute top-1/2 left-0 z-10 h-5 w-5 -translate-y-1/2 rounded opacity-0 transition-all duration-200"
        title="지우기"
        aria-label="지우기">
        
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />

</svg>
      </button>

      
      <input
        id="search-input"
        type="text"
        placeholder="게시글 검색..."
        class="text-foreground placeholder:text-muted-foreground w-full border-none bg-transparent pl-8 text-lg outline-none"
        autocomplete="off"
        spellcheck="false" />
    </div>

    
    <button
      id="search-close"
      class="text-muted-foreground hover:text-foreground hover:bg-muted/50 flex h-6 w-6 items-center justify-center rounded-md p-0.5 transition-all duration-200"
      title="닫기"
      aria-label="닫기">
      
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />

</svg>
    </button>
  </div>

  
  <div id="search-results" class="max-h-96 overflow-y-auto">
    
    <div
      id="search-empty"
      class="flex flex-col items-center justify-center py-12 text-center">
      <div
        class="bg-muted/50 mb-4 flex h-16 w-16 items-center justify-center rounded-full">
        
  <svg class="h-6 w-6"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m21 21-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />

</svg>
      </div>
      <h3 class="text-foreground mb-2 text-lg font-semibold">
        검색 시작
      </h3>
      <p class="text-muted-foreground text-sm">
        검색어를 입력하세요
      </p>
    </div>

    
    <div
      id="search-loading"
      class="flex hidden items-center justify-center py-8">
      <div
        class="mr-3 h-6 w-6 animate-spin rounded-full border-2 border-current border-t-transparent"></div>
      <span class="text-muted-foreground"
        >검색 중...</span
      >
    </div>

    
    <div
      id="search-no-results"
      class="flex hidden flex-col items-center justify-center py-12 text-center">
      <div
        class="bg-muted/50 mb-4 flex h-16 w-16 items-center justify-center rounded-full">
        
  <svg class="h-6 w-6"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h7" />
</svg>
      </div>
      <h3 class="text-foreground mb-2 text-lg font-semibold">
        검색 결과 없음
      </h3>
      <p class="text-muted-foreground text-sm">
        다른 검색어로 시도해보세요
      </p>
    </div>

    
    <div id="search-results-list" class="hidden">
      
      <div
        id="search-stats"
        class="text-muted-foreground border-border border-b px-4 py-3 text-sm"
        data-template="%d개의 결과 찾음">
      </div>

      
      <div id="search-items" class="divide-border divide-y">
        
      </div>
    </div>
  </div>

  
  <div class="border-border bg-muted/20 border-t px-4 py-3">
    <div
      class="text-muted-foreground flex items-center justify-between text-xs">
      <div class="flex items-center gap-2 md:gap-4">
        <div class="flex items-center gap-1">
          <kbd
            class="bg-muted border-border rounded border px-1.5 py-0.5 text-xs"
            >↑↓</kbd
          >
          <span class="hidden sm:inline"
            >이동</span
          >
        </div>
        <div class="flex items-center gap-1">
          <kbd
            class="bg-muted border-border rounded border px-1.5 py-0.5 text-xs"
            >↵</kbd
          >
          <span class="hidden sm:inline"
            >선택</span
          >
        </div>
        <div class="flex items-center gap-1">
          <kbd
            class="bg-muted border-border rounded border px-1.5 py-0.5 text-xs"
            >ESC</kbd
          >
          <span class="hidden sm:inline"
            >닫기</span
          >
        </div>
      </div>
      <div class="search-hint-desktop flex items-center gap-1">
        <kbd class="bg-muted border-border rounded border px-1.5 py-0.5 text-xs"
          >⌘K</kbd
        >
        <span>단축키</span>
      </div>
    </div>
  </div>
</div>

  </body>
</html>
