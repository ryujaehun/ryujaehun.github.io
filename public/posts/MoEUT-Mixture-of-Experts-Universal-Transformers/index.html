<!doctype html>
<html
  lang="ko-kr"
  data-theme="claude">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1314&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8" />
<meta
  name="viewport"
  content="width=device-width, initial-scale=1, shrink-to-fit=no" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />

<title>MoEUT: Mixture-of-Experts Universal Transformers | Jaehun&#39;s Blog</title>

<meta name="description" content="ë…¼ë¬¸ ë§í¬
Q : ì´ ë…¼ë¬¸ì„ ì•„ì£¼ ìì„¸í•˜ê²Œ ì½ê³  ë…¼ë¬¸ì˜ ê°•ì ê³¼ ë…ì°½ì ì¸ ì§€ì ì„ ì„¤ëª…í•´ì£¼ê³  í•µì‹¬ ì•Œê³ ë¦¬ì¦˜ì„ ì˜ˆì‹œ ì…ë ¥ì„ ë“¤ì–´ì„œ ì „ì²´ì ì¸ ê³¼ì •ì„ ì„¤ëª…í•´ì¤˜ ì¶”ê°€ì ìœ¼ë¡œ ë…¼ë¬¸ì˜ í•œê³„ì ì— ëŒ€í•´ì„œë„ ì•Œë ¤ì¤˜ âœ… ê²°ë¡  ìš”ì•½ (í•µì‹¬ ê°•ì , ë…ì°½ì„±, í•µì‹¬ ë©”ì»¤ë‹ˆì¦˜) MoEUT..." />
<meta name="keywords" content="ê°œë°œ, ì»´íŒŒì¼ëŸ¬, í”„ë¡œê·¸ë˜ë°, ì—ì„¸ì´" />
<meta name="author" content="" />
<meta name="language" content="ko-kr" />

<meta name="robots" content="index, follow" />
<link rel="canonical" href="http://192.168.1.11:1314/posts/MoEUT-Mixture-of-Experts-Universal-Transformers/" />



  <link rel="icon" type="image/svg+xml" href="/favicon.svg" />



<link rel="manifest" href="/site.webmanifest" />
<meta property="og:url" content="http://192.168.1.11:1314/posts/MoEUT-Mixture-of-Experts-Universal-Transformers/">
  <meta property="og:site_name" content="Jaehun&#39;s Blog">
  <meta property="og:title" content="MoEUT: Mixture-of-Experts Universal Transformers">
  <meta property="og:description" content="ë…¼ë¬¸ ë§í¬
Q : ì´ ë…¼ë¬¸ì„ ì•„ì£¼ ìì„¸í•˜ê²Œ ì½ê³  ë…¼ë¬¸ì˜ ê°•ì ê³¼ ë…ì°½ì ì¸ ì§€ì ì„ ì„¤ëª…í•´ì£¼ê³  í•µì‹¬ ì•Œê³ ë¦¬ì¦˜ì„ ì˜ˆì‹œ ì…ë ¥ì„ ë“¤ì–´ì„œ ì „ì²´ì ì¸ ê³¼ì •ì„ ì„¤ëª…í•´ì¤˜ ì¶”ê°€ì ìœ¼ë¡œ ë…¼ë¬¸ì˜ í•œê³„ì ì— ëŒ€í•´ì„œë„ ì•Œë ¤ì¤˜ âœ… ê²°ë¡  ìš”ì•½ (í•µì‹¬ ê°•ì , ë…ì°½ì„±, í•µì‹¬ ë©”ì»¤ë‹ˆì¦˜) MoEUTëŠ” Universal Transformer(UT)ì˜ êµ¬ì¡°ì  ê°•ì (ë ˆì´ì–´ íŒŒë¼ë¯¸í„° ê³µìœ  ê¸°ë°˜ì˜ recurrence)ì„ ìœ ì§€í•˜ë©´ì„œë„ ê¸°ì¡´ í•œê³„ì˜€ë˜ parameter-compute ratio ë¬¸ì œë¥¼ í•´ê²°í•œ êµ¬ì¡°ë‹¤. í•µì‹¬ì€ ë‹¤ìŒ ì„¸ ê°€ì§€ë‹¤:">
  <meta property="og:locale" content="ko_kr">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-04-13T00:00:00+00:00">
    <meta property="article:modified_time" content="2025-04-13T00:00:00+00:00">
    <meta property="og:image" content="http://192.168.1.11:1314/images/og-default.avif">


  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="http://192.168.1.11:1314/images/og-default.avif">
  <meta name="twitter:title" content="MoEUT: Mixture-of-Experts Universal Transformers">
  <meta name="twitter:description" content="ë…¼ë¬¸ ë§í¬
Q : ì´ ë…¼ë¬¸ì„ ì•„ì£¼ ìì„¸í•˜ê²Œ ì½ê³  ë…¼ë¬¸ì˜ ê°•ì ê³¼ ë…ì°½ì ì¸ ì§€ì ì„ ì„¤ëª…í•´ì£¼ê³  í•µì‹¬ ì•Œê³ ë¦¬ì¦˜ì„ ì˜ˆì‹œ ì…ë ¥ì„ ë“¤ì–´ì„œ ì „ì²´ì ì¸ ê³¼ì •ì„ ì„¤ëª…í•´ì¤˜ ì¶”ê°€ì ìœ¼ë¡œ ë…¼ë¬¸ì˜ í•œê³„ì ì— ëŒ€í•´ì„œë„ ì•Œë ¤ì¤˜ âœ… ê²°ë¡  ìš”ì•½ (í•µì‹¬ ê°•ì , ë…ì°½ì„±, í•µì‹¬ ë©”ì»¤ë‹ˆì¦˜) MoEUTëŠ” Universal Transformer(UT)ì˜ êµ¬ì¡°ì  ê°•ì (ë ˆì´ì–´ íŒŒë¼ë¯¸í„° ê³µìœ  ê¸°ë°˜ì˜ recurrence)ì„ ìœ ì§€í•˜ë©´ì„œë„ ê¸°ì¡´ í•œê³„ì˜€ë˜ parameter-compute ratio ë¬¸ì œë¥¼ í•´ê²°í•œ êµ¬ì¡°ë‹¤. í•µì‹¬ì€ ë‹¤ìŒ ì„¸ ê°€ì§€ë‹¤:">


  <meta itemprop="name" content="MoEUT: Mixture-of-Experts Universal Transformers">
  <meta itemprop="description" content="ë…¼ë¬¸ ë§í¬
Q : ì´ ë…¼ë¬¸ì„ ì•„ì£¼ ìì„¸í•˜ê²Œ ì½ê³  ë…¼ë¬¸ì˜ ê°•ì ê³¼ ë…ì°½ì ì¸ ì§€ì ì„ ì„¤ëª…í•´ì£¼ê³  í•µì‹¬ ì•Œê³ ë¦¬ì¦˜ì„ ì˜ˆì‹œ ì…ë ¥ì„ ë“¤ì–´ì„œ ì „ì²´ì ì¸ ê³¼ì •ì„ ì„¤ëª…í•´ì¤˜ ì¶”ê°€ì ìœ¼ë¡œ ë…¼ë¬¸ì˜ í•œê³„ì ì— ëŒ€í•´ì„œë„ ì•Œë ¤ì¤˜ âœ… ê²°ë¡  ìš”ì•½ (í•µì‹¬ ê°•ì , ë…ì°½ì„±, í•µì‹¬ ë©”ì»¤ë‹ˆì¦˜) MoEUTëŠ” Universal Transformer(UT)ì˜ êµ¬ì¡°ì  ê°•ì (ë ˆì´ì–´ íŒŒë¼ë¯¸í„° ê³µìœ  ê¸°ë°˜ì˜ recurrence)ì„ ìœ ì§€í•˜ë©´ì„œë„ ê¸°ì¡´ í•œê³„ì˜€ë˜ parameter-compute ratio ë¬¸ì œë¥¼ í•´ê²°í•œ êµ¬ì¡°ë‹¤. í•µì‹¬ì€ ë‹¤ìŒ ì„¸ ê°€ì§€ë‹¤:">
  <meta itemprop="datePublished" content="2025-04-13T00:00:00+00:00">
  <meta itemprop="dateModified" content="2025-04-13T00:00:00+00:00">
  <meta itemprop="wordCount" content="11281">
  <meta itemprop="image" content="http://192.168.1.11:1314/images/og-default.avif">
  <meta itemprop="keywords" content="Paper-Review,With-Gpt">







<script>
  window.HUGO_SEARCH_CONFIG = {
    searchIndexURL: "\"/index.json\""
  };
</script>


































<script>

  window.HUGO_GALLERY_CONFIG = {
    justified_gallery:  false ,
    lightbox:  false ,
    justified: "{}",
    lightbox_options: "{}"
  };
</script>




  
    <link rel="stylesheet" href="/css/compiled.css" />
  





  
    <link rel="stylesheet" href="/css/chroma.css" />
  












      <script src="/js/main.js"></script>



  <script src="/js/gumshoe.polyfills.min.js"></script>



        <script src="/js/toc.js" defer></script>



      <script src="/js/search.js" defer></script>



      <script src="/js/dock.js" defer></script>











  











    <script>
      
      (function() {
        const theme = localStorage.getItem('theme') || 'system';
        const colorScheme = localStorage.getItem('colorScheme') || 'claude';

        
        document.documentElement.setAttribute('data-theme', colorScheme);

        
        function applyTheme() {
          if (theme === 'dark' || (theme === 'system' && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
            document.documentElement.classList.add('dark');
          } else {
            document.documentElement.classList.remove('dark');
          }
        }

        applyTheme();

        
        if (theme === 'system') {
          window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', applyTheme);
        }
      })();
    </script>
  </head>

  <body class="bg-background text-foreground min-h-screen antialiased">
    
    
  <div
    id="reading-progress-container"
    class="reading-progress-container pointer-events-none fixed top-0 right-0 left-0 z-50 transition-opacity duration-300 ease-out"
    data-height="3"
    data-smooth-scroll="true"
    data-hide-on-complete="false">
    
    <div class="reading-progress-bg w-full"></div>

    
    <div
      id="reading-progress-bar"
      class="from-primary to-primary/80 reading-progress-bar 
        transition-all duration-150 ease-out
       absolute top-0 left-0 w-0 bg-gradient-to-r"></div>
  </div>

  <script>
    (function () {
      "use strict";

      const progressContainer = document.getElementById(
        "reading-progress-container",
      );
      const progressBar = document.getElementById("reading-progress-bar");

      if (!progressContainer || !progressBar) return;

      
      const config = {
        smoothScroll: progressContainer.dataset.smoothScroll === "true",
        hideOnComplete: progressContainer.dataset.hideOnComplete === "true",
      };

      let isVisible = true;
      let gumshoeInstance = null;

      
      function calculateProgress() {
        const scrollTop =
          window.pageYOffset || document.documentElement.scrollTop;
        const documentHeight = document.documentElement.scrollHeight;
        const windowHeight = window.innerHeight;
        const scrollableHeight = documentHeight - windowHeight;

        if (scrollableHeight <= 0) return 0;

        return Math.min(Math.max((scrollTop / scrollableHeight) * 100, 0), 100);
      }

      
      function updateProgress() {
        const progress = calculateProgress();
        progressBar.style.width = progress + "%";

        
        if (config.hideOnComplete && progress >= 99.5) {
          if (isVisible) {
            progressContainer.style.opacity = "0";
            isVisible = false;
          }
        } else if (!isVisible) {
          progressContainer.style.opacity = "1";
          isVisible = true;
        }
      }

      
      let ticking = false;
      function requestTick() {
        if (!ticking) {
          requestAnimationFrame(() => {
            updateProgress();
            ticking = false;
          });
          ticking = true;
        }
      }

      
      function init() {
        
        window.addEventListener("scroll", requestTick, { passive: true });
        window.addEventListener("resize", requestTick, { passive: true });
        document.addEventListener("visibilitychange", () => {
          if (!document.hidden) requestTick();
        });

        
        requestTick();

        
        window.addEventListener("beforeunload", () => {
          window.removeEventListener("scroll", requestTick);
          window.removeEventListener("resize", requestTick);
        });
      }

      
      if (document.readyState === "loading") {
        document.addEventListener("DOMContentLoaded", init);
      } else {
        init();
      }
    })();
  </script>

    <header class="sticky top-0 z-50 mx-auto max-w-4xl px-4 py-6">
  <div
    class="border-border bg-card/80 flex items-center rounded-xl border px-6 py-4 shadow-sm backdrop-blur-sm">
    
    <div class="hidden w-full items-center md:flex">
      
      <div class="flex items-center">
        
          
          <a
            href="/"
            class="bg-primary text-primary-foreground hover:bg-primary/90 flex h-10 w-10 items-center justify-center rounded-full text-lg font-bold transition-transform duration-200 hover:scale-105"
            aria-label="Jaehun&#39;s Blog">
            J
          </a>
        
      </div>

      
      <nav class="mx-8 flex flex-1 items-center justify-center">
        <div class="flex items-center space-x-1">
          
          
            
            
            
              
                
              
            
            
            <a
              href="/posts/"
              class="nav-link 
                text-muted-foreground hover:text-primary hover:bg-primary/10
               focus:ring-primary/20 relative flex items-center gap-2 rounded-lg px-4 py-2 text-sm font-medium transition-all duration-300 ease-out hover:-translate-y-0.5 hover:scale-105 focus:ring-2 focus:outline-none">
              
                
  <svg class="h-5 w-5"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="nav.posts">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 20H5a2 2 0 01-2-2V6a2 2 0 012-2h10a2 2 0 012 2v1m2 13a2 2 0 01-2-2V7m2 13a2 2 0 002-2V9a2 2 0 00-2-2h-2m-4-3H9M7 16h6M7 8h6v4H7V8z" />

</svg>
              
              <span
                >
                  ê²Œì‹œê¸€
                </span
              >
            </a>
          
            
            
            
              
                
              
            
            
            <a
              href="/categories/"
              class="nav-link 
                text-muted-foreground hover:text-primary hover:bg-primary/10
               focus:ring-primary/20 relative flex items-center gap-2 rounded-lg px-4 py-2 text-sm font-medium transition-all duration-300 ease-out hover:-translate-y-0.5 hover:scale-105 focus:ring-2 focus:outline-none">
              
                
  <svg class="h-5 w-5"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="nav.categories">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10" />

</svg>
              
              <span
                >
                  ì¹´í…Œê³ ë¦¬
                </span
              >
            </a>
          
            
            
            
              
                
              
            
            
            <a
              href="/tags/"
              class="nav-link 
                text-muted-foreground hover:text-primary hover:bg-primary/10
               focus:ring-primary/20 relative flex items-center gap-2 rounded-lg px-4 py-2 text-sm font-medium transition-all duration-300 ease-out hover:-translate-y-0.5 hover:scale-105 focus:ring-2 focus:outline-none">
              
                
  <svg class="h-5 w-5"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="nav.tags">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z" />

</svg>
              
              <span
                >
                  íƒœê·¸
                </span
              >
            </a>
          
            
            
            
              
                
              
            
            
            <a
              href="/archives/"
              class="nav-link 
                text-muted-foreground hover:text-primary hover:bg-primary/10
               focus:ring-primary/20 relative flex items-center gap-2 rounded-lg px-4 py-2 text-sm font-medium transition-all duration-300 ease-out hover:-translate-y-0.5 hover:scale-105 focus:ring-2 focus:outline-none">
              
                
  <svg class="h-5 w-5"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="nav.archives">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 8h14M5 8a2 2 0 110-4h14a2 2 0 110 4M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8m-9 4h4" />

</svg>
              
              <span
                >
                  ì•„ì¹´ì´ë¸Œ
                </span
              >
            </a>
          
        </div>
      </nav>

      
      <div class="flex items-center space-x-2">
        
        
<div class="relative">
  <button id="language-toggle"
    class="dropdown-toggle border-border bg-background text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex h-10 w-10 items-center justify-center rounded-lg border transition-all duration-300 ease-out hover:scale-105 focus:ring-2 focus:outline-none active:scale-95"
    data-dropdown-type="language"
    aria-label="ì–¸ì–´ ë³€ê²½"
    aria-expanded="false"
    aria-haspopup="true">
      
  <svg class="h-5 w-5 relative z-10"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="ì–¸ì–´ ë³€ê²½">
	<path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m5 8l6 6m-7 0l6-6l2-3M2 5h12M7 2h1m14 20l-5-10l-5 10m2-4h6" />
</svg></button>

  
  <div id="language-dropdown"
    class="dropdown-menu border-border bg-popover/95 absolute top-12 right-0 z-[60] hidden w-40 rounded-lg border p-1 shadow-lg backdrop-blur-sm transition-all duration-200 ease-out"
    data-dropdown-type="language"
    role="menu"
    aria-labelledby="language-toggle"><a href="/ko/" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none" role="menuitem" aria-current="true"><span class="font-medium">í•œêµ­ì–´</span></a><a href="/en/" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none" role="menuitem"><span class="font-medium">English</span></a></div>
</div>

        
        
<div class="relative">
  <button id="color-scheme-toggle"
    class="dropdown-toggle border-border bg-background text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex h-10 w-10 items-center justify-center rounded-lg border transition-all duration-300 ease-out hover:scale-105 focus:ring-2 focus:outline-none active:scale-95"
    data-dropdown-type="color-scheme"
    aria-label="í…Œë§ˆ ë³€ê²½"
    aria-expanded="false"
    aria-haspopup="true">
      
  <svg class="h-5 w-5 relative z-10"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="í…Œë§ˆ ë³€ê²½">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zM21 5a2 2 0 00-2-2h-4a2 2 0 00-2 2v6a2 2 0 002 2h4a2 2 0 002-2V5z" />

</svg></button>

  
  <div id="color-scheme-dropdown"
    class="dropdown-menu border-border bg-popover/95 absolute top-12 right-0 z-[60] hidden w-44 rounded-lg border p-1 shadow-lg backdrop-blur-sm transition-all duration-200 ease-out"
    data-dropdown-type="color-scheme"><button data-color-scheme="claude" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Default</span></button><button data-color-scheme="default" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>White</span></button><button data-color-scheme="bumblebee" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Bumblebee</span></button><button data-color-scheme="emerald" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Emerald</span></button><button data-color-scheme="nord" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Nord</span></button><button data-color-scheme="sunset" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Sunset</span></button><button data-color-scheme="abyss" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Abyss</span></button><button data-color-scheme="dracula" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Dracula</span></button><button data-color-scheme="amethyst" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Amethyst</span></button><button data-color-scheme="slate" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Slate</span></button><button data-color-scheme="twitter" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Twitter</span></button></div>
</div>

        
        
<div class="relative">
  <button id="theme-toggle"
    class="dropdown-toggle border-border bg-background text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex h-10 w-10 items-center justify-center rounded-lg border transition-all duration-300 ease-out hover:scale-105 focus:ring-2 focus:outline-none active:scale-95"
    data-dropdown-type="theme"
    aria-label="í…Œë§ˆ ë³€ê²½"
    aria-expanded="false"
    aria-haspopup="true">
      
      
  <svg class="h-5 w-5 sun-icon hidden relative z-10"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="ë¼ì´íŠ¸">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" />

</svg>
      
      
  <svg class="h-5 w-5 moon-icon hidden relative z-10"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="ë‹¤í¬">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" />

</svg>
      
      
  <svg class="h-5 w-5 system-icon hidden relative z-10"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="ì‹œìŠ¤í…œ">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />

</svg></button>

  
  <div id="theme-dropdown"
    class="dropdown-menu border-border bg-popover/95 absolute top-12 right-0 z-[60] hidden w-40 rounded-lg border p-1 shadow-lg backdrop-blur-sm transition-all duration-200 ease-out"
    data-dropdown-type="theme"><button data-theme="light" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none">
  <svg class="h-5 w-5 mr-3 h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="ë¼ì´íŠ¸">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" />

</svg><span>ë¼ì´íŠ¸</span></button><button data-theme="dark" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none">
  <svg class="h-5 w-5 mr-3 h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="ë‹¤í¬">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" />

</svg><span>ë‹¤í¬</span></button><button data-theme="system" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none">
  <svg class="h-5 w-5 mr-3 h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="ì‹œìŠ¤í…œ">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />

</svg><span>ì‹œìŠ¤í…œ</span></button></div>
</div>
      </div>
    </div>

    
    <div class="flex w-full items-center justify-between md:hidden">
      
      
<div class="relative">
  <button
    id="mobile-menu-toggle"
    class="dropdown-toggle border-border bg-background text-muted-foreground hover:bg-accent hover:text-foreground flex h-10 w-10 items-center justify-center rounded-lg border transition-colors duration-200"
    data-dropdown-type="mobile-menu"
    aria-label="ë©”ë‰´"
    aria-expanded="false"
    aria-haspopup="true">
    
  <svg class="h-5 w-5"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="ë©”ë‰´">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />

</svg>
  </button>

  
  <div
    id="mobile-menu"
    class="mobile-menu dropdown-menu border-border bg-popover/95 absolute top-12 left-0 z-[60] hidden w-80 max-w-[calc(100vw-2rem)] rounded-lg border p-1 shadow-lg backdrop-blur-sm transition-all duration-200 ease-out md:hidden"
    data-dropdown-type="mobile-menu"
    role="menu"
    aria-labelledby="mobile-menu-toggle">
    <nav class="flex flex-col">
      
      
        
        
        
          
            
          
        
        
        <a
          href="/posts/"
          class="nav-link 
            text-muted-foreground hover:text-primary hover:bg-primary/10
           focus:ring-primary/20 relative flex items-center gap-3 rounded-md px-4 py-3 text-sm font-medium transition-all duration-200 ease-out hover:translate-x-1 focus:ring-2 focus:outline-none"
          role="menuitem"
          >
          
            
  <svg class="h-5 w-5"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="nav.posts">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 20H5a2 2 0 01-2-2V6a2 2 0 012-2h10a2 2 0 012 2v1m2 13a2 2 0 01-2-2V7m2 13a2 2 0 002-2V9a2 2 0 00-2-2h-2m-4-3H9M7 16h6M7 8h6v4H7V8z" />

</svg>
          
          <span
            >
              ê²Œì‹œê¸€
            </span
          >
        </a>
      
        
        
        
          
            
          
        
        
        <a
          href="/categories/"
          class="nav-link 
            text-muted-foreground hover:text-primary hover:bg-primary/10
           focus:ring-primary/20 relative flex items-center gap-3 rounded-md px-4 py-3 text-sm font-medium transition-all duration-200 ease-out hover:translate-x-1 focus:ring-2 focus:outline-none"
          role="menuitem"
          >
          
            
  <svg class="h-5 w-5"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="nav.categories">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10" />

</svg>
          
          <span
            >
              ì¹´í…Œê³ ë¦¬
            </span
          >
        </a>
      
        
        
        
          
            
          
        
        
        <a
          href="/tags/"
          class="nav-link 
            text-muted-foreground hover:text-primary hover:bg-primary/10
           focus:ring-primary/20 relative flex items-center gap-3 rounded-md px-4 py-3 text-sm font-medium transition-all duration-200 ease-out hover:translate-x-1 focus:ring-2 focus:outline-none"
          role="menuitem"
          >
          
            
  <svg class="h-5 w-5"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="nav.tags">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z" />

</svg>
          
          <span
            >
              íƒœê·¸
            </span
          >
        </a>
      
        
        
        
          
            
          
        
        
        <a
          href="/archives/"
          class="nav-link 
            text-muted-foreground hover:text-primary hover:bg-primary/10
           focus:ring-primary/20 relative flex items-center gap-3 rounded-md px-4 py-3 text-sm font-medium transition-all duration-200 ease-out hover:translate-x-1 focus:ring-2 focus:outline-none"
          role="menuitem"
          >
          
            
  <svg class="h-5 w-5"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="nav.archives">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 8h14M5 8a2 2 0 110-4h14a2 2 0 110 4M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8m-9 4h4" />

</svg>
          
          <span
            >
              ì•„ì¹´ì´ë¸Œ
            </span
          >
        </a>
      
    </nav>
  </div>
</div>


      
      <div class="flex items-center space-x-2">
        
        
<div class="relative">
  <button id="language-toggle"
    class="dropdown-toggle border-border bg-background text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex h-10 w-10 items-center justify-center rounded-lg border transition-all duration-300 ease-out hover:scale-105 focus:ring-2 focus:outline-none active:scale-95"
    data-dropdown-type="language"
    aria-label="ì–¸ì–´ ë³€ê²½"
    aria-expanded="false"
    aria-haspopup="true">
      
  <svg class="h-5 w-5 relative z-10"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="ì–¸ì–´ ë³€ê²½">
	<path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m5 8l6 6m-7 0l6-6l2-3M2 5h12M7 2h1m14 20l-5-10l-5 10m2-4h6" />
</svg></button>

  
  <div id="language-dropdown"
    class="dropdown-menu border-border bg-popover/95 absolute top-12 right-0 z-[60] hidden w-40 rounded-lg border p-1 shadow-lg backdrop-blur-sm transition-all duration-200 ease-out"
    data-dropdown-type="language"
    role="menu"
    aria-labelledby="language-toggle"><a href="/ko/" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none" role="menuitem" aria-current="true"><span class="font-medium">í•œêµ­ì–´</span></a><a href="/en/" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none" role="menuitem"><span class="font-medium">English</span></a></div>
</div>

        
        
<div class="relative">
  <button id="color-scheme-toggle"
    class="dropdown-toggle border-border bg-background text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex h-10 w-10 items-center justify-center rounded-lg border transition-all duration-300 ease-out hover:scale-105 focus:ring-2 focus:outline-none active:scale-95"
    data-dropdown-type="color-scheme"
    aria-label="í…Œë§ˆ ë³€ê²½"
    aria-expanded="false"
    aria-haspopup="true">
      
  <svg class="h-5 w-5 relative z-10"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="í…Œë§ˆ ë³€ê²½">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zM21 5a2 2 0 00-2-2h-4a2 2 0 00-2 2v6a2 2 0 002 2h4a2 2 0 002-2V5z" />

</svg></button>

  
  <div id="color-scheme-dropdown"
    class="dropdown-menu border-border bg-popover/95 absolute top-12 right-0 z-[60] hidden w-44 rounded-lg border p-1 shadow-lg backdrop-blur-sm transition-all duration-200 ease-out"
    data-dropdown-type="color-scheme"><button data-color-scheme="claude" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Default</span></button><button data-color-scheme="default" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>White</span></button><button data-color-scheme="bumblebee" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Bumblebee</span></button><button data-color-scheme="emerald" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Emerald</span></button><button data-color-scheme="nord" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Nord</span></button><button data-color-scheme="sunset" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Sunset</span></button><button data-color-scheme="abyss" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Abyss</span></button><button data-color-scheme="dracula" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Dracula</span></button><button data-color-scheme="amethyst" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Amethyst</span></button><button data-color-scheme="slate" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Slate</span></button><button data-color-scheme="twitter" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Twitter</span></button></div>
</div>

        
        
<div class="relative">
  <button id="theme-toggle"
    class="dropdown-toggle border-border bg-background text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex h-10 w-10 items-center justify-center rounded-lg border transition-all duration-300 ease-out hover:scale-105 focus:ring-2 focus:outline-none active:scale-95"
    data-dropdown-type="theme"
    aria-label="í…Œë§ˆ ë³€ê²½"
    aria-expanded="false"
    aria-haspopup="true">
      
      
  <svg class="h-5 w-5 sun-icon hidden relative z-10"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="ë¼ì´íŠ¸">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" />

</svg>
      
      
  <svg class="h-5 w-5 moon-icon hidden relative z-10"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="ë‹¤í¬">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" />

</svg>
      
      
  <svg class="h-5 w-5 system-icon hidden relative z-10"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="ì‹œìŠ¤í…œ">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />

</svg></button>

  
  <div id="theme-dropdown"
    class="dropdown-menu border-border bg-popover/95 absolute top-12 right-0 z-[60] hidden w-40 rounded-lg border p-1 shadow-lg backdrop-blur-sm transition-all duration-200 ease-out"
    data-dropdown-type="theme"><button data-theme="light" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none">
  <svg class="h-5 w-5 mr-3 h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="ë¼ì´íŠ¸">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" />

</svg><span>ë¼ì´íŠ¸</span></button><button data-theme="dark" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none">
  <svg class="h-5 w-5 mr-3 h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="ë‹¤í¬">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" />

</svg><span>ë‹¤í¬</span></button><button data-theme="system" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none">
  <svg class="h-5 w-5 mr-3 h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="ì‹œìŠ¤í…œ">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />

</svg><span>ì‹œìŠ¤í…œ</span></button></div>
</div>
      </div>
    </div>
  </div>
</header>


    <main class="mx-auto max-w-4xl px-4 py-6">
      
  
  <nav
  class="breadcrumb mb-4 md:mb-6 py-1"
  aria-label="ê²½ë¡œ">
  <ol class="text-muted-foreground flex items-center space-x-1 md:space-x-2 text-sm overflow-x-auto whitespace-nowrap scrollbar-hide py-1">
    
    <li class="flex-shrink-0">
      <a
        href="/"
        class="text-muted-foreground hover:text-primary hover:bg-primary/10 flex items-center gap-0.5 md:gap-1 rounded-lg px-1 md:px-3 py-0.5 md:py-1.5 transition-all duration-200 ease-out hover:-translate-y-0.5 hover:scale-[1.02]">
        
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="í™ˆ">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m3 12 2-2m0 0 7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" />

</svg>
        <span class="max-w-[4rem] md:max-w-none truncate">í™ˆ</span>
      </a>
    </li>

    
    
      <li class="flex items-center gap-1 md:gap-2 min-w-0">
        <span class="text-muted-foreground/50 flex-shrink-0"
          >
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
</svg>
        </span>

        
          
          <div class="flex items-center gap-1 md:gap-2 min-w-0">
            
              
              <a
                href="/posts"
                class="text-muted-foreground hover:text-primary hover:bg-primary/10 flex items-center gap-0.5 md:gap-1 rounded-lg px-1 md:px-3 py-0.5 md:py-1.5 transition-all duration-200 ease-out hover:-translate-y-0.5 hover:scale-[1.02] flex-shrink-0">
                
                  
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 20H5a2 2 0 01-2-2V6a2 2 0 012-2h10a2 2 0 012 2v1m2 13a2 2 0 01-2-2V7m2 13a2 2 0 002-2V9a2 2 0 00-2-2h-2m-4-3H9M7 16h6M7 8h6v4H7V8z" />

</svg>
                  <span class="max-w-[3rem] md:max-w-none truncate">ê²Œì‹œê¸€</span>
                
              </a>
              <span class="text-muted-foreground/50 flex-shrink-0"
                >
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
</svg></span
              >
            
            
            <span class="text-foreground flex items-center gap-0.5 md:gap-1 font-medium min-w-0">
              
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
</svg>
              <span class="max-w-[8rem] md:max-w-[16rem] lg:max-w-none truncate">MoEUT: Mixture-of-Experts Universal Transformers</span>
            </span>
          </div>
        
      </li>
    

  </ol>
</nav>



  


  
  <header class="mb-8">
    


<div class="post-meta">
  
  <h1 class="text-foreground mb-6 text-3xl leading-tight font-bold md:text-4xl">
    MoEUT: Mixture-of-Experts Universal Transformers
  </h1>

  
  


  
  <div class="bg-card border-border flex flex-col gap-4 rounded-xl border p-6">
    
    <div
      class="text-muted-foreground flex flex-wrap items-center gap-4 text-sm">
      
      <div class="flex items-center gap-2">
        
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="ì‘ì„±ì¼"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
</svg>
        <time datetime="2025-04-13">
          2025ë…„ 04ì›” 13ì¼
        </time>
      </div>

      
      


      
      
        <div class="flex items-center gap-2">
          
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="ì½ëŠ” ì‹œê°„"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
</svg>
          <span
            >23 ë¶„</span
          >
        </div>
      


      
      
        <div class="flex items-center gap-2">
          
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="ë‹¨ì–´ ìˆ˜"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h7" />
</svg>
          <span>11281 ë‹¨ì–´</span>
        </div>
      

    </div>

    
    
      <div class="flex flex-wrap items-center gap-4">
        
        
          <div class="flex items-center gap-2">
            
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="ì¹´í…Œê³ ë¦¬"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z" />
</svg>
            <span class="text-muted-foreground mr-2 text-sm"
              >ì¹´í…Œê³ ë¦¬:</span
            >
            <div class="flex flex-wrap gap-2">
              
                <a
                  href="/categories/paper-review/"
                  class="bg-primary/10 text-primary hover:bg-primary/20 focus:ring-primary/20 inline-flex items-center rounded-full px-3 py-1 text-sm font-medium transition-all duration-200 ease-out hover:-translate-y-0.5 hover:scale-105 hover:shadow-md focus:ring-2 focus:outline-none">
                  paper-review
                </a>
              
                <a
                  href="/categories/with-gpt/"
                  class="bg-primary/10 text-primary hover:bg-primary/20 focus:ring-primary/20 inline-flex items-center rounded-full px-3 py-1 text-sm font-medium transition-all duration-200 ease-out hover:-translate-y-0.5 hover:scale-105 hover:shadow-md focus:ring-2 focus:outline-none">
                  with-gpt
                </a>
              
            </div>
          </div>
        


        
        

      </div>
    


    
    

  </div>
</div>

  </header>

  
  <article class="prose prose-neutral dark:prose-invert mb-12 max-w-none">
    <p><a href="https://arxiv.org/abs/2405.16039v2">ë…¼ë¬¸ ë§í¬</a></p>
<h1 id="q--ì´-ë…¼ë¬¸ì„-ì•„ì£¼-ìì„¸í•˜ê²Œ-ì½ê³ -ë…¼ë¬¸ì˜-ê°•ì ê³¼-ë…ì°½ì ì¸-ì§€ì ì„-ì„¤ëª…í•´ì£¼ê³ -í•µì‹¬-ì•Œê³ ë¦¬ì¦˜ì„-ì˜ˆì‹œ-ì…ë ¥ì„-ë“¤ì–´ì„œ-ì „ì²´ì ì¸-ê³¼ì •ì„-ì„¤ëª…í•´ì¤˜-ì¶”ê°€ì ìœ¼ë¡œ-ë…¼ë¬¸ì˜-í•œê³„ì ì—-ëŒ€í•´ì„œë„-ì•Œë ¤ì¤˜">Q : ì´ ë…¼ë¬¸ì„ ì•„ì£¼ ìì„¸í•˜ê²Œ ì½ê³  ë…¼ë¬¸ì˜ ê°•ì ê³¼ ë…ì°½ì ì¸ ì§€ì ì„ ì„¤ëª…í•´ì£¼ê³  í•µì‹¬ ì•Œê³ ë¦¬ì¦˜ì„ ì˜ˆì‹œ ì…ë ¥ì„ ë“¤ì–´ì„œ ì „ì²´ì ì¸ ê³¼ì •ì„ ì„¤ëª…í•´ì¤˜ ì¶”ê°€ì ìœ¼ë¡œ ë…¼ë¬¸ì˜ í•œê³„ì ì— ëŒ€í•´ì„œë„ ì•Œë ¤ì¤˜</h1>
<h3 id="-ê²°ë¡ -ìš”ì•½-í•µì‹¬-ê°•ì -ë…ì°½ì„±-í•µì‹¬-ë©”ì»¤ë‹ˆì¦˜">âœ… ê²°ë¡  ìš”ì•½ (í•µì‹¬ ê°•ì , ë…ì°½ì„±, í•µì‹¬ ë©”ì»¤ë‹ˆì¦˜)</h3>
<p><strong>MoEUT</strong>ëŠ” Universal Transformer(UT)ì˜ êµ¬ì¡°ì  ê°•ì (ë ˆì´ì–´ íŒŒë¼ë¯¸í„° ê³µìœ  ê¸°ë°˜ì˜ recurrence)ì„ ìœ ì§€í•˜ë©´ì„œë„ ê¸°ì¡´ í•œê³„ì˜€ë˜ <strong>parameter-compute ratio ë¬¸ì œ</strong>ë¥¼ í•´ê²°í•œ êµ¬ì¡°ë‹¤. í•µì‹¬ì€ ë‹¤ìŒ ì„¸ ê°€ì§€ë‹¤:</p>
<ol>
<li>**Mixture-of-Experts (MoE)**ë¥¼ Feedforwardì™€ Attention ì–‘ìª½ì— ì‚¬ìš©í•´ <strong>íŒŒë¼ë¯¸í„° ìˆ˜ëŠ” ëŠ˜ë¦¬ê³  ì—°ì‚°ëŸ‰ì€ ì¤„ì´ëŠ” sparse ê³„ì‚°</strong> ê°€ëŠ¥.</li>
<li><strong>Layer Grouping</strong>ìœ¼ë¡œ ë‹¨ì¼ shared-layerê°€ ê°€ì§„ expressive power ë¶€ì¡±ì„ í•´ê²°.</li>
<li><strong>Peri-layernorm</strong>ìœ¼ë¡œ gradient flowì™€ residual scaling ë¬¸ì œë¥¼ ë™ì‹œì— í•´ê²°.</li>
</ol>
<p><strong>â‡’ ê²°ê³¼ì ìœ¼ë¡œ</strong>, ê°™ì€ íŒŒë¼ë¯¸í„° ìˆ˜ë‚˜ MACs ê¸°ì¤€ì—ì„œ MoEUTëŠ” ê¸°ì¡´ Transformerë¥¼ ì†Œí­ ìƒíšŒí•˜ë©°, íŠ¹íˆ compute efficiency ì¸¡ë©´ì—ì„œ ìš°ìˆ˜í•¨ì„ ë³´ì¸ë‹¤.</p>
<hr>
<h3 id="-í•µì‹¬-êµ¬ì„±-ìš”ì†Œì™€-ì•Œê³ ë¦¬ì¦˜-ì„¤ëª…-ì˜ˆì‹œ-í¬í•¨">ğŸ” í•µì‹¬ êµ¬ì„± ìš”ì†Œì™€ ì•Œê³ ë¦¬ì¦˜ ì„¤ëª… (ì˜ˆì‹œ í¬í•¨)</h3>
<h4 id="1-Ïƒ-moe-ê¸°ë°˜-feedforward-block">1. Ïƒ-MoE ê¸°ë°˜ Feedforward Block</h4>
<ul>
<li>ê° layerëŠ” NEê°œì˜ <strong>ì‘ì€ expert</strong> (dexpert=128)ë¥¼ ê°€ì§€ë©°, top-K (K â‰ˆ dmodel/dexpert) expertë¥¼ ì„ íƒí•´ ê³„ì‚°.</li>
</ul>
<p><strong>ì…ë ¥ ì˜ˆì‹œ:</strong></p>
<ul>
<li><code>xt</code> âˆˆ â„^dmodel (í† í° tì˜ embedding)</li>
<li>Expert ì„ íƒ:<br>
[
s_t = Ïƒ(x_t W_S) \in â„^{NE}
]
ìƒìœ„ Kê°œì˜ expert ID ì„ íƒ:<br>
[
E(x_t) = \text{TopK}(s_t, K)
]</li>
<li>Output ê³„ì‚°:<br>
[
y_t = \sum_{e \in E(x_t)} s_t[e] \cdot \text{ReLU}(x_t W_1^e) W_2^e
]</li>
</ul>
<p>â†’ Expert selectionì— entropy-based regularization ì¶”ê°€:
[
L = \sum_{e=1}^{NE} p[e] \log p[e], \quad p = \frac{1}{T} \sum_{t=1}^{T} \text{softmax}(x_t W_S)
]</p>
<h4 id="2-moe-self-attention-switchhead">2. MoE Self-Attention (SwitchHead)</h4>
<ul>
<li>ê° headì˜ Value, Output projectionì´ MoE êµ¬ì¡°.</li>
<li>Query, KeyëŠ” denseí•˜ê²Œ ê³„ì‚°í•˜ë©° Value, Outputì€ MoE expert ì¤‘ ì„ íƒí•˜ì—¬ ê³„ì‚°.</li>
</ul>
<p>ì˜ˆì‹œ: Head h, í† í° tì— ëŒ€í•´</p>
<ul>
<li>Expert score:
[
s_{V,t}^h = Ïƒ(x_t W_{SV}^h)
]</li>
<li>ì„ íƒëœ expertë¡œ value projection:
[
v_t^h = \sum_{e \in E^h_V(x_t)} s^h_{V,t}[e] \cdot x_t W_V^{h,e}
]</li>
<li>Attention ê³„ì‚° í›„ output projectionë„ ìœ ì‚¬í•˜ê²Œ MoE ì²˜ë¦¬.</li>
</ul>
<h4 id="3-layer-grouping">3. Layer Grouping</h4>
<ul>
<li>Gê°œì˜ non-shared ë ˆì´ì–´ë¥¼ í•˜ë‚˜ì˜ groupìœ¼ë¡œ ë¬¶ê³ , ê·¸ groupì„ ë°˜ë³µí•˜ì—¬ recurrence.</li>
<li>ì˜ˆì‹œ: G=2ì¼ ë•Œ ì „ì²´ depthê°€ 18ì´ë©´ 9ë²ˆ A-B ë ˆì´ì–´ë¥¼ ë°˜ë³µ â†’ ABABABAB&hellip;</li>
</ul>
<p>ì´ ë°©ì‹ì€ ì•„ë˜ì™€ ê°™ì€ <strong>ë³µí•© ì—°ì‚°ì„ ë ˆì´ì–´ ê°„ ë¶„í• í•˜ì—¬ ìˆ˜í–‰í•˜ëŠ” inductive bias</strong>ë¥¼ ì œê³µ:</p>
<ul>
<li>A â†’ sub-operation 1</li>
<li>B â†’ sub-operation 2</li>
<li>A-B â†’ ì „ì²´ ì—°ì‚° ì™„ì„±</li>
</ul>
<h4 id="4-peri-layernorm">4. Peri-layernorm</h4>
<ul>
<li>ì¼ë°˜ì ì¸ pre/post-layernormê³¼ ë‹¬ë¦¬ <strong>sigmoid, softmax ì•ì—ì„œë§Œ layernorm ì ìš©</strong>.</li>
<li>Attentionì˜ Query/Key, MoE gating score ê³„ì‚°ì—ë§Œ ì ìš©.</li>
<li>Residual pathì—ëŠ” ì ìš©í•˜ì§€ ì•Šì•„ gradient flow, residual scale ë¬¸ì œ ë™ì‹œ í•´ê²°.</li>
</ul>
<hr>
<h3 id="-ì„±ëŠ¥-ë¹„êµ-ìš”ì•½">ğŸ“Š ì„±ëŠ¥ ë¹„êµ ìš”ì•½</h3>
<table>
  <thead>
      <tr>
          <th>ëª¨ë¸ ìœ í˜•</th>
          <th>íŒŒë¼ë¯¸í„° ìˆ˜</th>
          <th>Perplexity (C4)</th>
          <th>Training MACs ê¸°ì¤€ íš¨ìœ¨ì„±</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>Baseline Transformer</td>
          <td>244M</td>
          <td>13.40</td>
          <td>ê¸°ì¤€ì </td>
      </tr>
      <tr>
          <td>Ïƒ-MoE (non-shared)</td>
          <td>244M</td>
          <td>13.70</td>
          <td>ë‚®ìŒ</td>
      </tr>
      <tr>
          <td><strong>MoEUT (shared)</strong></td>
          <td>243M</td>
          <td><strong>13.24</strong></td>
          <td><strong>ê°€ì¥ íš¨ìœ¨ì </strong></td>
      </tr>
  </tbody>
</table>
<p><em>Peri-layernorm</em>, <em>G=2 Grouping</em>, <em>Ïƒ-MoE+SwitchHead</em>ê°€ ì¡°í•©ë  ë•Œ ì„±ëŠ¥ì´ ê°€ì¥ ì¢‹ìŒ.</p>
<hr>
<h3 id="-ë…¼ë¬¸ì˜-ê°•ì -ë°-ë…ì°½ì -ê¸°ì—¬">ğŸŒŸ ë…¼ë¬¸ì˜ ê°•ì  ë° ë…ì°½ì  ê¸°ì—¬</h3>
<table>
  <thead>
      <tr>
          <th>í•­ëª©</th>
          <th>ê¸°ì—¬ ìš”ì•½</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>Compute íš¨ìœ¨ì„±</td>
          <td>ë™ì¼ compute (MACs) ëŒ€ë¹„ perplexity ê°œì„ </td>
      </tr>
      <tr>
          <td>ëª¨ë¸ êµ¬ì¡°</td>
          <td>UTì™€ MoEì˜ ì¥ì  ê²°í•©í•œ ìµœì´ˆì˜ êµ¬ì¡°</td>
      </tr>
      <tr>
          <td>í•™ìŠµ ì•ˆì •ì„±</td>
          <td>MoE gatingì— entropy ê¸°ë°˜ regularization ë„ì…</td>
      </tr>
      <tr>
          <td>Layer Grouping</td>
          <td>MoEUTì˜ expressive powerë¥¼ êµ¬ì¡°ì ìœ¼ë¡œ í™•ì¥</td>
      </tr>
      <tr>
          <td>Peri-layernorm</td>
          <td>ê¸°ì¡´ pre/post-layernormì˜ ë¬¸ì œì ì„ ëª¨ë‘ í•´ê²°í•œ ìƒˆë¡œìš´ ë°©ì‹</td>
      </tr>
      <tr>
          <td>ë¶„ì„</td>
          <td>Expert ì‚¬ìš© diversity, token-context íŠ¹ì´ì„±ê¹Œì§€ ì²´ê³„ì  ë¶„ì„</td>
      </tr>
  </tbody>
</table>
<hr>
<h3 id="-í•œê³„ì -ë°-ê°œì„ -ì—¬ì§€">âš ï¸ í•œê³„ì  ë° ê°œì„  ì—¬ì§€</h3>
<table>
  <thead>
      <tr>
          <th>í•œê³„</th>
          <th>ì„¤ëª…</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>Triton ê¸°ë°˜ MoE ì»¤ë„</td>
          <td>í˜„ì¬ëŠ” ë¹„íš¨ìœ¨ì  êµ¬í˜„ìœ¼ë¡œ ì¸í•´ baselineë³´ë‹¤ í•™ìŠµ ì†ë„ ëŠë¦¼ (1.7x)</td>
      </tr>
      <tr>
          <td>ACT ë¯¸ì ìš©</td>
          <td>Adaptive Computation Timeì€ ë³¸ ë…¼ë¬¸ì—ì„œ ì œì™¸ë¨ (UTì˜ ì£¼ìš” ê¸°ë²• ì¤‘ í•˜ë‚˜ì¸ë° ë³‘í•©ë˜ì§€ ì•ŠìŒ)</td>
      </tr>
      <tr>
          <td>ìŠ¤ì¼€ì¼ ì œí•œ</td>
          <td>ìµœëŒ€ 1B íŒŒë¼ë¯¸í„° ìˆ˜ì¤€ ì‹¤í—˜ì— í•œì • (GPT-4, Claude 3 ê°™ì€ scaleë¡œëŠ” ë¯¸ê²€ì¦)</td>
      </tr>
      <tr>
          <td>Downstream ì„±ëŠ¥</td>
          <td>ëŒ€ë¶€ë¶„ marginal improvement ìˆ˜ì¤€ (zero-shotì—ì„œ ì•„ì£¼ í° ì°¨ì´ëŠ” ì•„ë‹˜)</td>
      </tr>
  </tbody>
</table>
<hr>
<h3 id="-ê²°ë¡ ">âœ… ê²°ë¡ </h3>
<p>MoEUTëŠ” Universal Transformerê°€ ê°–ëŠ” layer recurrence ê¸°ë°˜ì˜ generalization ëŠ¥ë ¥ì„ ìœ ì§€í•˜ë©´ì„œ, compute/resource íš¨ìœ¨ì„± ë¬¸ì œë¥¼ MoEë¡œ í•´ê²°í•œ <strong>ê°€ì¥ ì‹¤ìš©ì ì¸ UT ë³€í˜• ì•„í‚¤í…ì²˜</strong>ë‹¤. íŠ¹íˆ <strong>fine-grained expert êµ¬ì„±</strong>, <strong>ë ˆì´ì–´ ê·¸ë£¹ ë°˜ë³µ ì„¤ê³„</strong>, <strong>peri-layernorm ë„ì…</strong>ì€ ëª¨ë‘ UTì˜ í•œê³„ë¥¼ ê·¹ë³µí•˜ëŠ” ë° í•„ìˆ˜ì ì´ë©°, ì´ ë…¼ë¬¸ì€ ê·¸ ëª¨ë“  ìš”ì†Œë¥¼ ê²°í•©í•´ ì‹¤ì§ˆì ìœ¼ë¡œ baselineì„ ëŠ¥ê°€í•˜ëŠ” ê²°ê³¼ë¥¼ ìµœì´ˆë¡œ ì œì‹œí–ˆë‹¤ëŠ” ì ì—ì„œ ë†’ì€ ê°€ì¹˜ë¥¼ ê°€ì§„ë‹¤.</p>
<h1 id="q--ë…¼ë¬¸ì˜-í•µì‹¬ì•Œê³ ë¦¬ì¦˜ì„-ì˜ˆì‹œë¥¼-ë“¤ì–´-ì•„ì£¼-ìì„¸í•˜ê²Œ-ì„¤ëª…í•´ì£¼ê³ -ì •ë¦¬í•´-ì¤˜">Q : ë…¼ë¬¸ì˜ í•µì‹¬ì•Œê³ ë¦¬ì¦˜ì„ ì˜ˆì‹œë¥¼ ë“¤ì–´ ì•„ì£¼ ìì„¸í•˜ê²Œ ì„¤ëª…í•´ì£¼ê³  ì •ë¦¬í•´ ì¤˜</h1>
<p>ì¢‹ìŠµë‹ˆë‹¤. ì•„ë˜ëŠ” <strong>MoEUT (Mixture-of-Experts Universal Transformer)</strong> ë…¼ë¬¸ì˜ <strong>í•µì‹¬ ì•Œê³ ë¦¬ì¦˜</strong>ì„ ìˆ˜ì‹ ê¸°ë°˜ìœ¼ë¡œ ì •ë¦¬í•˜ê³ , <strong>ì˜ˆì‹œ ì…ë ¥ì„ í†µí•´ step-by-stepìœ¼ë¡œ ì‘ë™ ê³¼ì •ì„ ì„¤ëª…</strong>í•œ ë‚´ìš©ì…ë‹ˆë‹¤.</p>
<hr>
<h2 id="-í•µì‹¬-ì•Œê³ ë¦¬ì¦˜-êµ¬ì„±-ìš”ì•½-ìš”ì†Œë³„-êµ¬ì¡°ì™€-ì—°ê²°ê´€ê³„">âœ… í•µì‹¬ ì•Œê³ ë¦¬ì¦˜ êµ¬ì„± ìš”ì•½ (ìš”ì†Œë³„ êµ¬ì¡°ì™€ ì—°ê²°ê´€ê³„)</h2>
<table>
  <thead>
      <tr>
          <th>ì»´í¬ë„ŒíŠ¸</th>
          <th>ë°©ì‹</th>
          <th>íŠ¹ì§•</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>Ïƒ-MoE FFN</strong></td>
          <td>top-K soft routing</td>
          <td>fine-grained expert selection</td>
      </tr>
      <tr>
          <td><strong>MoE Self-Attention</strong></td>
          <td>SwitchHead êµ¬ì¡°</td>
          <td>head-wise expert mixture</td>
      </tr>
      <tr>
          <td><strong>Layer Grouping</strong></td>
          <td>ë°˜ë³µ êµ¬ì¡° A-B-A-B</td>
          <td>sub-operation ë¶„í•  ìœ ë„</td>
      </tr>
      <tr>
          <td><strong>Peri-LayerNorm</strong></td>
          <td>í™œì„±í™” ì´ì „ì—ë§Œ ì ìš©</td>
          <td>signal scaling ë¬¸ì œ í•´ê²°</td>
      </tr>
  </tbody>
</table>
<hr>
<h2 id="-ì˜ˆì‹œ-ê¸°ë°˜-ì„¤ëª…-Ïƒ-moe--moe-self-attention-ê²½ë¡œ">ğŸ§ª ì˜ˆì‹œ ê¸°ë°˜ ì„¤ëª… (Ïƒ-MoE + MoE Self-Attention ê²½ë¡œ)</h2>
<h3 id="ê°€ì •">ê°€ì •</h3>
<ul>
<li>ëª¨ë¸ íŒŒë¼ë¯¸í„°:
<ul>
<li>( d_{\text{model}} = 4 ), ( d_{\text{expert}} = 2 ), expert ìˆ˜ ( N_E = 3 ), top-K = 2</li>
</ul>
</li>
<li>ì…ë ¥ í† í°: ( x_t = [0.1, -0.5, 0.3, 0.9] )</li>
</ul>
<hr>
<h3 id="-step-1-Ïƒ-moe-feedforward">ğŸ”¹ Step 1: Ïƒ-MoE Feedforward</h3>
<h4 id="1-1-expert-ì„ íƒ">1-1. Expert ì„ íƒ</h4>
<p>[
s_t = \sigma(x_t W_S)
\quad \text{(sigmoid gating)}
]</p>
<p>ê°€ì •:<br>
[
W_S =
\begin{bmatrix}
0.2 &amp; -0.3 &amp; 0.5 \
-0.1 &amp; 0.4 &amp; 0.2 \
0.6 &amp; -0.2 &amp; 0.1 \
-0.4 &amp; 0.3 &amp; -0.1
\end{bmatrix}
\Rightarrow
x_t W_S = [0.5, -0.2, 0.3]
\Rightarrow
s_t = \sigma([0.5, -0.2, 0.3]) \approx [0.62, 0.45, 0.57]
]</p>
<p>â†’ top-2 expert: <strong>1ë²ˆ, 3ë²ˆ expert ì„ íƒ</strong></p>
<h4 id="1-2-ì„ íƒëœ-expert-ì²˜ë¦¬">1-2. ì„ íƒëœ expert ì²˜ë¦¬</h4>
<p>ê° expertëŠ” ë‘ weight:</p>
<ul>
<li>( W_1^e \in \mathbb{R}^{4\times2} ), ( W_2^e \in \mathbb{R}^{2\times4} )</li>
</ul>
<p>ê°€ì •:</p>
<ul>
<li>( \text{ReLU}(x_t W_1^e) W_2^e ) ê²°ê³¼ëŠ” ë‹¤ìŒê³¼ ê°™ìŒ:
<ul>
<li>Expert 1: ( v_1 = [0.1, 0.2, 0.0, 0.1] )</li>
<li>Expert 3: ( v_3 = [0.05, 0.1, 0.2, 0.0] )</li>
</ul>
</li>
</ul>
<p>ìµœì¢… output:
[
y_t = 0.62 \cdot v_1 + 0.57 \cdot v_3
= [0.62(0.1)+0.57(0.05), \dots]
\Rightarrow
y_t â‰ˆ [0.1035, 0.197, 0.114, 0.062]
]</p>
<hr>
<h3 id="-step-2-moe-self-attention-switchhead">ğŸ”¹ Step 2: MoE Self-Attention (SwitchHead)</h3>
<p>ê°€ì •: 2-head attention, head dimension ( d_{\text{head}} = 2 )</p>
<h4 id="2-1-querykey-ê³„ì‚°-dense">2-1. Query/Key ê³„ì‚° (dense)</h4>
<p>[
Q_t^h = x_t W_Q^h,\quad K_t^h = x_t W_K^h
]</p>
<p>â†’ dot-product attention weight ê³„ì‚°ì€ ì¼ë°˜ attentionê³¼ ë™ì¼</p>
<h4 id="2-2-valueoutputì—-moe-ì ìš©">2-2. Value/Outputì— MoE ì ìš©</h4>
<p>ê° headë§ˆë‹¤ expert routing:</p>
<ul>
<li>expert score:<br>
[
s_V^h = \sigma(x_t W_{SV}^h)
\Rightarrow \text{top-2 expert ì„ íƒ}
]</li>
<li>ì˜ˆ: expert 1, 2 ì„ íƒ</li>
<li>ê°’:
<ul>
<li>( V^h = \sum_{e \in \text{top-2}} s[e] \cdot x_t W_V^{h,e} )</li>
</ul>
</li>
<li>attention ê²°ê³¼ ( a_t^h = \text{Attention}(Q, K, V) )</li>
<li>output: ( y_t = \sum_h a_t^h W_O^{h,e} )</li>
</ul>
<hr>
<h3 id="-step-3-residual--peri-layernorm">ğŸ”¹ Step 3: Residual + Peri-layernorm</h3>
<ul>
<li><strong>Peri-layernorm ì ìš© ìœ„ì¹˜:</strong>
<ul>
<li>Attention: Q, K projection ì „ì—ë§Œ</li>
<li>FFN: gating (Ïƒ-MoE) ì „ì—ë§Œ</li>
</ul>
</li>
</ul>
<p>â†’ Main data path (FFN, V-proj ë“±)ì—ëŠ” layernorm ì—†ìŒ
â†’ gradient flowëŠ” ì˜ ìœ ì§€í•˜ë©´ì„œ residual scaling ë¬¸ì œ íšŒí”¼</p>
<hr>
<h2 id="-ìš”ì•½-ì „ì²´-ì—°ì‚°-íë¦„">ğŸ§  ìš”ì•½: ì „ì²´ ì—°ì‚° íë¦„</h2>
<div
  class="code-block-container border-border bg-card my-6 overflow-hidden rounded-xl border shadow-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:shadow-md">
  
  <div
    class="code-block-header bg-muted/30 border-border flex items-center justify-between border-b px-4 py-3">
    
    <div class="flex items-center gap-2">
      <div class="text-muted-foreground flex-shrink-0">
        
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4" />
</svg>
      </div>
      <span class="text-muted-foreground text-sm font-medium">
        PLAINTEXT
      </span>
    </div>

    
    <div class="flex items-center gap-2">
      <button
          class="collapse-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none"
          data-code-id="code-0"
          data-default-state="expanded"
          data-collapsed="false"
          data-auto-collapse-lines="30"
          data-auto-collapse-height="400"
          data-collapsed-height="120"
          title="ì ‘ê¸°"
          aria-label="ì ‘ê¸°">
          <span class="collapse-icon">
            
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z"/></svg>
          </span>
          <span class="collapse-text hidden sm:inline"
            >ì ‘ê¸°</span
          >
        </button>
      <button
        class="copy-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none"
        data-code-id="code-0"
        title="ë³µì‚¬"
        aria-label="ë³µì‚¬">
        <span class="copy-icon">
          
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
</svg>
        </span>
        <span class="copy-text hidden sm:inline"
          >ë³µì‚¬</span
        >
      </button>
    </div>
  </div>

  
  <div class="code-block-content relative" id="code-0">
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="ln">1</span><span class="cl">x_t 
</span></span><span class="line"><span class="ln">2</span><span class="cl"> â†“
</span></span><span class="line"><span class="ln">3</span><span class="cl">[Layer Group]
</span></span><span class="line"><span class="ln">4</span><span class="cl">   â”œâ”€ Ïƒ-MoE FFN â†’ sparse expert ì„ íƒ ë° ê³„ì‚°
</span></span><span class="line"><span class="ln">5</span><span class="cl">   â””â”€ MoE Attention â†’ head-wise expert mixture
</span></span><span class="line"><span class="ln">6</span><span class="cl"> â†“
</span></span><span class="line"><span class="ln">7</span><span class="cl">Peri-layernorm (ì„ íƒì ìœ¼ë¡œ ì ìš©)
</span></span><span class="line"><span class="ln">8</span><span class="cl"> â†“
</span></span><span class="line"><span class="ln">9</span><span class="cl">x_{t+1} (ë‹¤ìŒ stepì˜ ì…ë ¥)</span></span></code></pre></div>
    
    <div
      class="collapse-overlay to-card/90 pointer-events-none absolute inset-0 bg-gradient-to-b from-transparent via-transparent opacity-0 transition-opacity duration-300">
      <div
        class="text-muted-foreground bg-card/80 border-border/50 hover:bg-primary/10 hover:text-primary hover:border-primary/30 absolute bottom-4 left-1/2 -translate-x-1/2 cursor-pointer rounded-full border px-3 py-1.5 text-xs backdrop-blur-sm transition-all duration-200">
        í´ë¦­í•˜ì—¬ ë” ë³´ê¸°
      </div>
    </div>
  </div>
</div>


<script>
(function() {
  const codeId = 'code-0';
  const copyBtn = document.querySelector('.copy-code-btn[data-code-id="' + codeId + '"]');
  const collapseBtn = document.querySelector('.collapse-code-btn[data-code-id="' + codeId + '"]');
  const codeContainer = document.getElementById(codeId);

  if (!codeContainer) return;

  
  if (copyBtn) {
    const copyIcon = copyBtn.querySelector('.copy-icon');
    const copyText = copyBtn.querySelector('.copy-text');

    copyBtn.addEventListener('click', async function() {
      try {
        
        let codeText = '';

        
        const codeTableCell = codeContainer.querySelector('.lntd:last-child code');
        if (codeTableCell) {
          codeText = codeTableCell.textContent || codeTableCell.innerText;
        } else {
          
          const codeElement = codeContainer.querySelector('code');
          if (codeElement) {
            
            const hasInlineLineNumbers = codeElement.querySelector('.ln');
            if (hasInlineLineNumbers) {
              
              const codeLines = codeElement.querySelectorAll('.cl');
              if (codeLines.length > 0) {
                codeText = Array.from(codeLines)
                  .map(line => {
                    const text = line.textContent || line.innerText;
                    
                    return text.replace(/\n+$/, '');
                  })
                  .join('\n')
                  .replace(/\n+$/, ''); 
              } else {
                
                const allText = codeElement.textContent || codeElement.innerText;
                codeText = allText.replace(/^\d+/gm, '').replace(/^\s+/gm, '');
              }
            } else {
              
              codeText = codeElement.textContent || codeElement.innerText;
            }
          } else {
            
            codeText = codeContainer.textContent || codeContainer.innerText;
          }
        }

        
        codeText = codeText.trim();

        
        await navigator.clipboard.writeText(codeText);

        
        copyIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M5 13l4 4L19 7\u0022 \/\u003e\n\u003c\/svg\u003e`;
        if (copyText) {
          copyText.textContent = 'ë³µì‚¬ë¨';
        }
        copyBtn.classList.add('text-green-600');

        
        setTimeout(() => {
          copyIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z\u0022 \/\u003e\n\u003c\/svg\u003e`;
          if (copyText) {
            copyText.textContent = 'ë³µì‚¬';
          }
          copyBtn.classList.remove('text-green-600');
        }, 2000);

      } catch (err) {
        console.error('å¤åˆ¶å¤±è´¥:', err);

        
        const range = document.createRange();
        const codeElement = codeContainer.querySelector('code') || codeContainer;
        range.selectNodeContents(codeElement);
        const selection = window.getSelection();
        selection.removeAllRanges();
        selection.addRange(range);

        
        if (copyText) {
          copyText.textContent = 'ì„ íƒë¨';
        }

        setTimeout(() => {
          if (copyText) {
            copyText.textContent = 'ë³µì‚¬';
          }
          selection.removeAllRanges();
        }, 2000);
      }
    });
  }

  
  if (collapseBtn) {
    const collapseIcon = collapseBtn.querySelector('.collapse-icon');
    const collapseText = collapseBtn.querySelector('.collapse-text');
    const collapseOverlay = codeContainer.querySelector('.collapse-overlay');

    
    let codeElement = codeContainer.querySelector('pre.chroma');
    if (!codeElement) {
      codeElement = codeContainer.querySelector('pre');
    }

    const defaultState = collapseBtn.dataset.defaultState || 'expanded';
    const isCollapsedAttr = collapseBtn.dataset.collapsed === 'true';
    const autoCollapseLines = parseInt(collapseBtn.dataset.autoCollapseLines) || 30;
    const autoCollapseHeight = parseInt(collapseBtn.dataset.autoCollapseHeight) || 400;
    const collapsedHeight = parseInt(collapseBtn.dataset.collapsedHeight) || 120;

    let isCollapsed = false;

    
    function initCollapse() {
      
      const shouldCollapse = isCollapsedAttr ||
                           defaultState === 'collapsed' ||
                           shouldAutoCollapse();

      if (shouldCollapse) {
        setCollapsed(true, false); 
      }
    }

    function shouldAutoCollapse() {
      
      if (codeElement) {
        const lines = codeElement.querySelectorAll('.line, .cl');
        const height = codeElement.offsetHeight;
        return lines.length > autoCollapseLines || height > autoCollapseHeight;
      }

      
      const containerHeight = codeContainer.offsetHeight;
      if (containerHeight > autoCollapseHeight) {
        return true;
      }

      
      const textContent = codeContainer.textContent || codeContainer.innerText || '';
      const estimatedLines = textContent.split('\n').length;
      return estimatedLines > autoCollapseLines;
    }

    function setCollapsed(collapsed, animate = true) {
      if (!collapseOverlay) return;

      isCollapsed = collapsed;

      if (collapsed) {
        
        codeContainer.style.maxHeight = collapsedHeight + 'px';
        codeContainer.style.overflow = 'hidden';
        collapseOverlay.style.opacity = '1';
        collapseOverlay.style.pointerEvents = 'auto';

        
        collapseIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M19 9l-7 7-7-7\u0022 \/\u003e\n\u003c\/svg\u003e`;
        if (collapseText) {
          collapseText.textContent = 'í¼ì¹˜ê¸°';
        }
        collapseBtn.title = 'í¼ì¹˜ê¸°';

      } else {
        
        codeContainer.style.maxHeight = '';
        codeContainer.style.overflow = '';
        collapseOverlay.style.opacity = '0';
        collapseOverlay.style.pointerEvents = 'none';

        
        collapseIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath fill=\u0022currentColor\u0022 d=\u0022M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z\u0022\/\u003e\u003c\/svg\u003e`;
        if (collapseText) {
          collapseText.textContent = 'ì ‘ê¸°';
        }
        collapseBtn.title = 'ì ‘ê¸°';
      }

      
      if (animate) {
        codeContainer.style.transition = 'max-height 0.3s ease-out';
        setTimeout(() => {
          codeContainer.style.transition = '';
        }, 300);
      }
    }

    function toggleCollapse() {
      setCollapsed(!isCollapsed, true);
    }

    
    collapseBtn.addEventListener('click', toggleCollapse);

    
    if (collapseOverlay) {
      collapseOverlay.addEventListener('click', () => {
        if (isCollapsed) {
          setCollapsed(false, true);
        }
      });
    }

    
    initCollapse();
  }
})();
</script>
<hr>
<h2 id="-ì¶”ê°€-í•´ì„¤-ì™œ-ì´ë ‡ê²Œ-ë™ì‘í•˜ëŠ”ê°€">ğŸ’¡ ì¶”ê°€ í•´ì„¤: ì™œ ì´ë ‡ê²Œ ë™ì‘í•˜ëŠ”ê°€?</h2>
<ul>
<li><strong>Ïƒ-MoE</strong>ëŠ” Sigmoid ê¸°ë°˜ soft gatingìœ¼ë¡œ top-K ì „ë¬¸ê°€ë§Œ ì‚¬ìš©í•¨ìœ¼ë¡œì¨ sparse activation â†’ compute ì ˆì•½</li>
<li><strong>SwitchHead</strong>ëŠ” attentionì˜ value/output ë¶€ë¶„ì„ expertë¡œ ë°”ê¿” parameter ìˆ˜ ì¦ê°€ + compute sparseí•˜ê²Œ ë§Œë“¦</li>
<li><strong>Layer Grouping</strong>ì€ ì—°ì‚°ì˜ sub-stepì„ ë ˆì´ì–´ì— ë¶„í• í•˜ê²Œ í•˜ì—¬ recurrent stackì—ì„œë„ expressive power í™•ë³´</li>
<li><strong>Peri-layernorm</strong>ì€ pre/postì˜ ì¥ì ì€ ì‚´ë¦¬ê³  ë‹¨ì ì€ ì œê±°í•œ ìƒˆë¡œìš´ normalization ìœ„ì¹˜ ì „ëµ</li>
</ul>
<h1 id="q--ì´-ë…¼ë¬¸ì—ì„œ-ì‚¬ìš©í•˜ëŠ”-ë°©ë²•ì„-í•™ìŠµí•˜ê¸°-ìœ„í•˜ì—¬-ì–´ë–¤-ë°ì´í„°ì…‹ì´-í•„ìš”í• ê¹Œ-ê·¸ë¦¬ê³ -ì–´ë–»ê²Œ-í•™ìŠµì„-ì§„í–‰í•˜ë©´-ë ì§€-ì˜ˆì‹œë¥¼-ë“¤ì–´ì„œ-ì•„ì£¼-ìì„¸í•˜ê²Œ-ì„¤ëª…í•´ì¤˜">Q : ì´ ë…¼ë¬¸ì—ì„œ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ì„ í•™ìŠµí•˜ê¸° ìœ„í•˜ì—¬ ì–´ë–¤ ë°ì´í„°ì…‹ì´ í•„ìš”í• ê¹Œ? ê·¸ë¦¬ê³  ì–´ë–»ê²Œ í•™ìŠµì„ ì§„í–‰í•˜ë©´ ë ì§€ ì˜ˆì‹œë¥¼ ë“¤ì–´ì„œ ì•„ì£¼ ìì„¸í•˜ê²Œ ì„¤ëª…í•´ì¤˜</h1>
<p>ì¢‹ìŠµë‹ˆë‹¤. ì´ ë…¼ë¬¸ì—ì„œëŠ” **MoEUT (Mixture-of-Experts Universal Transformer)**ë¥¼ ì‹¤ì œë¡œ í•™ìŠµí•˜ê¸° ìœ„í•´ <strong>ì–¸ì–´ ëª¨ë¸ë§ì„ ìœ„í•œ í‘œì¤€ ë°ì´í„°ì…‹</strong>ì„ í™œìš©í•˜ì˜€ìœ¼ë©°, í•™ìŠµ ì ˆì°¨ì™€ í•˜ì´í¼íŒŒë¼ë¯¸í„°ëŠ” ìƒë‹¹íˆ ì •êµí•˜ê²Œ ì„¤ê³„ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ì•„ë˜ì— <strong>ë°ì´í„°ì…‹ ìš”ì•½</strong>, <strong>í›ˆë ¨ ì ˆì°¨</strong>, <strong>ì„¸ë¶€ ì˜ˆì‹œ</strong>ë¥¼ ìˆ˜ì¹˜ ê¸°ë°˜ìœ¼ë¡œ ë§¤ìš° ìì„¸í•˜ê²Œ ì„¤ëª…ë“œë¦½ë‹ˆë‹¤.</p>
<hr>
<h2 id="-1-ì‚¬ìš©í•œ-ì£¼ìš”-ë°ì´í„°ì…‹">âœ… 1. ì‚¬ìš©í•œ ì£¼ìš” ë°ì´í„°ì…‹</h2>
<table>
  <thead>
      <tr>
          <th>ë°ì´í„°ì…‹</th>
          <th>ëª©ì </th>
          <th>íŠ¹ì§•</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>C4</strong> (Colossal Clean Crawled Corpus)</td>
          <td>ì¼ë°˜ ì–¸ì–´ ëª¨ë¸ë§</td>
          <td>ì•½ 100GB ê·œëª¨, ì›¹ í¬ë¡¤ë§ ì •ì œ ë°ì´í„°</td>
      </tr>
      <tr>
          <td><strong>SlimPajama</strong></td>
          <td>ê²½ëŸ‰í™”ëœ RedPajama</td>
          <td>627B í† í°, ë‹¤ì–‘í•œ ë¬¸ì²´ í¬í•¨</td>
      </tr>
      <tr>
          <td><strong>peS2o</strong></td>
          <td>í•™ìˆ  ë…¼ë¬¸ ê¸°ë°˜ í…ìŠ¤íŠ¸</td>
          <td>AI2 S2ORCì—ì„œ ì¶”ì¶œ</td>
      </tr>
      <tr>
          <td><strong>The Stack</strong></td>
          <td>ì½”ë“œ ìƒì„± í•™ìŠµ</td>
          <td>ë‹¤ì–‘í•œ í”„ë¡œê·¸ë˜ë° ì–¸ì–´ í¬í•¨ (Python, Rust, HTML ë“±)</td>
      </tr>
  </tbody>
</table>

  <blockquote
    class="border-primary bg-muted/30 hover:bg-muted/40 my-6 rounded-r-lg border-l-4 py-4 pr-4 pl-6 italic transition-all duration-200 ease-out hover:translate-x-1">
    <div class="prose prose-sm max-w-none">
      <p>âœ… ëª¨ë‘ <strong>auto-regressive LM ë°©ì‹</strong>ìœ¼ë¡œ ì‚¬ìš©ë¨ (e.g., next-token prediction)</p>
    </div>
  </blockquote>

<hr>
<h2 id="-2-í•™ìŠµ-ë°©ì‹-ë°-êµ¬ì„±ìš”ì†Œ">âœ… 2. í•™ìŠµ ë°©ì‹ ë° êµ¬ì„±ìš”ì†Œ</h2>
<h3 id="ê³µí†µ-í•™ìŠµ-ì„¤ì •">ê³µí†µ í•™ìŠµ ì„¤ì •</h3>
<table>
  <thead>
      <tr>
          <th>í•­ëª©</th>
          <th>ê°’</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>Batch size</td>
          <td>64 (global)</td>
      </tr>
      <tr>
          <td>Sequence length</td>
          <td>1024 tokens</td>
      </tr>
      <tr>
          <td>Optimizer</td>
          <td>AdamW (weight decay 0.01)</td>
      </tr>
      <tr>
          <td>LR schedule</td>
          <td>Cosine decay (start=2.5e-4 â†’ end=2.5e-5)</td>
      </tr>
      <tr>
          <td>Gradient clipping</td>
          <td>Îº = 0.25</td>
      </tr>
      <tr>
          <td>FP16 or BF16</td>
          <td>Mixed precision ì‚¬ìš©</td>
      </tr>
      <tr>
          <td>Tokenizer</td>
          <td>SentencePiece (vocab size = 8,000)</td>
      </tr>
  </tbody>
</table>
<hr>
<h2 id="-3-ì „ì²´-í•™ìŠµ-íŒŒì´í”„ë¼ì¸-ì˜ˆì‹œ">âœ… 3. ì „ì²´ í•™ìŠµ íŒŒì´í”„ë¼ì¸ ì˜ˆì‹œ</h2>
<h3 id="-step-by-step-í•™ìŠµ-ì˜ˆì‹œ-ì˜ˆ-c4-ë°ì´í„°-244m-ëª¨ë¸">âš™ï¸ Step-by-Step í•™ìŠµ ì˜ˆì‹œ (ì˜ˆ: C4 ë°ì´í„°, 244M ëª¨ë¸)</h3>
<h4 id="1ë‹¨ê³„-ë°ì´í„°-ì¤€ë¹„">1ë‹¨ê³„: ë°ì´í„° ì¤€ë¹„</h4>
<div
  class="code-block-container border-border bg-card my-6 overflow-hidden rounded-xl border shadow-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:shadow-md">
  
  <div
    class="code-block-header bg-muted/30 border-border flex items-center justify-between border-b px-4 py-3">
    
    <div class="flex items-center gap-2">
      <div class="text-muted-foreground flex-shrink-0">
        
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4" />
</svg>
      </div>
      <span class="text-muted-foreground text-sm font-medium">
        BASH
      </span>
    </div>

    
    <div class="flex items-center gap-2">
      <button
          class="collapse-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none"
          data-code-id="code-1"
          data-default-state="expanded"
          data-collapsed="false"
          data-auto-collapse-lines="30"
          data-auto-collapse-height="400"
          data-collapsed-height="120"
          title="ì ‘ê¸°"
          aria-label="ì ‘ê¸°">
          <span class="collapse-icon">
            
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z"/></svg>
          </span>
          <span class="collapse-text hidden sm:inline"
            >ì ‘ê¸°</span
          >
        </button>
      <button
        class="copy-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none"
        data-code-id="code-1"
        title="ë³µì‚¬"
        aria-label="ë³µì‚¬">
        <span class="copy-icon">
          
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
</svg>
        </span>
        <span class="copy-text hidden sm:inline"
          >ë³µì‚¬</span
        >
      </button>
    </div>
  </div>

  
  <div class="code-block-content relative" id="code-1">
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="c1"># Hugging Face Datasets ì‚¬ìš© ì˜ˆì‹œ</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">from datasets import load_dataset
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="nv">dataset</span> <span class="o">=</span> load_dataset<span class="o">(</span><span class="s2">&#34;c4&#34;</span>, <span class="s2">&#34;en&#34;</span>, <span class="nv">split</span><span class="o">=</span><span class="s2">&#34;train&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">
</span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="c1"># í† í°í™”</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">from sentencepiece import SentencePieceProcessor
</span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="nv">sp</span> <span class="o">=</span> SentencePieceProcessor<span class="o">()</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">sp.load<span class="o">(</span><span class="s2">&#34;c4_8k_tokenizer.model&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">
</span></span><span class="line"><span class="ln">10</span><span class="cl">def tokenize<span class="o">(</span>example<span class="o">)</span>:
</span></span><span class="line"><span class="ln">11</span><span class="cl">    <span class="k">return</span> <span class="o">{</span><span class="s2">&#34;input_ids&#34;</span>: sp.encode<span class="o">(</span>example<span class="o">[</span><span class="s2">&#34;text&#34;</span><span class="o">])}</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">
</span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="nv">tokenized_dataset</span> <span class="o">=</span> dataset.map<span class="o">(</span>tokenize, <span class="nv">batched</span><span class="o">=</span>True<span class="o">)</span></span></span></code></pre></div>
    
    <div
      class="collapse-overlay to-card/90 pointer-events-none absolute inset-0 bg-gradient-to-b from-transparent via-transparent opacity-0 transition-opacity duration-300">
      <div
        class="text-muted-foreground bg-card/80 border-border/50 hover:bg-primary/10 hover:text-primary hover:border-primary/30 absolute bottom-4 left-1/2 -translate-x-1/2 cursor-pointer rounded-full border px-3 py-1.5 text-xs backdrop-blur-sm transition-all duration-200">
        í´ë¦­í•˜ì—¬ ë” ë³´ê¸°
      </div>
    </div>
  </div>
</div>


<script>
(function() {
  const codeId = 'code-1';
  const copyBtn = document.querySelector('.copy-code-btn[data-code-id="' + codeId + '"]');
  const collapseBtn = document.querySelector('.collapse-code-btn[data-code-id="' + codeId + '"]');
  const codeContainer = document.getElementById(codeId);

  if (!codeContainer) return;

  
  if (copyBtn) {
    const copyIcon = copyBtn.querySelector('.copy-icon');
    const copyText = copyBtn.querySelector('.copy-text');

    copyBtn.addEventListener('click', async function() {
      try {
        
        let codeText = '';

        
        const codeTableCell = codeContainer.querySelector('.lntd:last-child code');
        if (codeTableCell) {
          codeText = codeTableCell.textContent || codeTableCell.innerText;
        } else {
          
          const codeElement = codeContainer.querySelector('code');
          if (codeElement) {
            
            const hasInlineLineNumbers = codeElement.querySelector('.ln');
            if (hasInlineLineNumbers) {
              
              const codeLines = codeElement.querySelectorAll('.cl');
              if (codeLines.length > 0) {
                codeText = Array.from(codeLines)
                  .map(line => {
                    const text = line.textContent || line.innerText;
                    
                    return text.replace(/\n+$/, '');
                  })
                  .join('\n')
                  .replace(/\n+$/, ''); 
              } else {
                
                const allText = codeElement.textContent || codeElement.innerText;
                codeText = allText.replace(/^\d+/gm, '').replace(/^\s+/gm, '');
              }
            } else {
              
              codeText = codeElement.textContent || codeElement.innerText;
            }
          } else {
            
            codeText = codeContainer.textContent || codeContainer.innerText;
          }
        }

        
        codeText = codeText.trim();

        
        await navigator.clipboard.writeText(codeText);

        
        copyIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M5 13l4 4L19 7\u0022 \/\u003e\n\u003c\/svg\u003e`;
        if (copyText) {
          copyText.textContent = 'ë³µì‚¬ë¨';
        }
        copyBtn.classList.add('text-green-600');

        
        setTimeout(() => {
          copyIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z\u0022 \/\u003e\n\u003c\/svg\u003e`;
          if (copyText) {
            copyText.textContent = 'ë³µì‚¬';
          }
          copyBtn.classList.remove('text-green-600');
        }, 2000);

      } catch (err) {
        console.error('å¤åˆ¶å¤±è´¥:', err);

        
        const range = document.createRange();
        const codeElement = codeContainer.querySelector('code') || codeContainer;
        range.selectNodeContents(codeElement);
        const selection = window.getSelection();
        selection.removeAllRanges();
        selection.addRange(range);

        
        if (copyText) {
          copyText.textContent = 'ì„ íƒë¨';
        }

        setTimeout(() => {
          if (copyText) {
            copyText.textContent = 'ë³µì‚¬';
          }
          selection.removeAllRanges();
        }, 2000);
      }
    });
  }

  
  if (collapseBtn) {
    const collapseIcon = collapseBtn.querySelector('.collapse-icon');
    const collapseText = collapseBtn.querySelector('.collapse-text');
    const collapseOverlay = codeContainer.querySelector('.collapse-overlay');

    
    let codeElement = codeContainer.querySelector('pre.chroma');
    if (!codeElement) {
      codeElement = codeContainer.querySelector('pre');
    }

    const defaultState = collapseBtn.dataset.defaultState || 'expanded';
    const isCollapsedAttr = collapseBtn.dataset.collapsed === 'true';
    const autoCollapseLines = parseInt(collapseBtn.dataset.autoCollapseLines) || 30;
    const autoCollapseHeight = parseInt(collapseBtn.dataset.autoCollapseHeight) || 400;
    const collapsedHeight = parseInt(collapseBtn.dataset.collapsedHeight) || 120;

    let isCollapsed = false;

    
    function initCollapse() {
      
      const shouldCollapse = isCollapsedAttr ||
                           defaultState === 'collapsed' ||
                           shouldAutoCollapse();

      if (shouldCollapse) {
        setCollapsed(true, false); 
      }
    }

    function shouldAutoCollapse() {
      
      if (codeElement) {
        const lines = codeElement.querySelectorAll('.line, .cl');
        const height = codeElement.offsetHeight;
        return lines.length > autoCollapseLines || height > autoCollapseHeight;
      }

      
      const containerHeight = codeContainer.offsetHeight;
      if (containerHeight > autoCollapseHeight) {
        return true;
      }

      
      const textContent = codeContainer.textContent || codeContainer.innerText || '';
      const estimatedLines = textContent.split('\n').length;
      return estimatedLines > autoCollapseLines;
    }

    function setCollapsed(collapsed, animate = true) {
      if (!collapseOverlay) return;

      isCollapsed = collapsed;

      if (collapsed) {
        
        codeContainer.style.maxHeight = collapsedHeight + 'px';
        codeContainer.style.overflow = 'hidden';
        collapseOverlay.style.opacity = '1';
        collapseOverlay.style.pointerEvents = 'auto';

        
        collapseIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M19 9l-7 7-7-7\u0022 \/\u003e\n\u003c\/svg\u003e`;
        if (collapseText) {
          collapseText.textContent = 'í¼ì¹˜ê¸°';
        }
        collapseBtn.title = 'í¼ì¹˜ê¸°';

      } else {
        
        codeContainer.style.maxHeight = '';
        codeContainer.style.overflow = '';
        collapseOverlay.style.opacity = '0';
        collapseOverlay.style.pointerEvents = 'none';

        
        collapseIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath fill=\u0022currentColor\u0022 d=\u0022M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z\u0022\/\u003e\u003c\/svg\u003e`;
        if (collapseText) {
          collapseText.textContent = 'ì ‘ê¸°';
        }
        collapseBtn.title = 'ì ‘ê¸°';
      }

      
      if (animate) {
        codeContainer.style.transition = 'max-height 0.3s ease-out';
        setTimeout(() => {
          codeContainer.style.transition = '';
        }, 300);
      }
    }

    function toggleCollapse() {
      setCollapsed(!isCollapsed, true);
    }

    
    collapseBtn.addEventListener('click', toggleCollapse);

    
    if (collapseOverlay) {
      collapseOverlay.addEventListener('click', () => {
        if (isCollapsed) {
          setCollapsed(false, true);
        }
      });
    }

    
    initCollapse();
  }
})();
</script>
<h4 id="2ë‹¨ê³„-dataloader-êµ¬ì„±-fixed-length-chunking">2ë‹¨ê³„: DataLoader êµ¬ì„± (Fixed-length chunking)</h4>
<div
  class="code-block-container border-border bg-card my-6 overflow-hidden rounded-xl border shadow-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:shadow-md">
  
  <div
    class="code-block-header bg-muted/30 border-border flex items-center justify-between border-b px-4 py-3">
    
    <div class="flex items-center gap-2">
      <div class="text-muted-foreground flex-shrink-0">
        
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4" />
</svg>
      </div>
      <span class="text-muted-foreground text-sm font-medium">
        PYTHON
      </span>
    </div>

    
    <div class="flex items-center gap-2">
      <button
          class="collapse-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none"
          data-code-id="code-2"
          data-default-state="expanded"
          data-collapsed="false"
          data-auto-collapse-lines="30"
          data-auto-collapse-height="400"
          data-collapsed-height="120"
          title="ì ‘ê¸°"
          aria-label="ì ‘ê¸°">
          <span class="collapse-icon">
            
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z"/></svg>
          </span>
          <span class="collapse-text hidden sm:inline"
            >ì ‘ê¸°</span
          >
        </button>
      <button
        class="copy-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none"
        data-code-id="code-2"
        title="ë³µì‚¬"
        aria-label="ë³µì‚¬">
        <span class="copy-icon">
          
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
</svg>
        </span>
        <span class="copy-text hidden sm:inline"
          >ë³µì‚¬</span
        >
      </button>
    </div>
  </div>

  
  <div class="code-block-content relative" id="code-2">
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="ln">1</span><span class="cl"><span class="kn">from</span> <span class="nn">torch.utils.data</span> <span class="kn">import</span> <span class="n">DataLoader</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl">
</span></span><span class="line"><span class="ln">3</span><span class="cl"><span class="k">def</span> <span class="nf">chunk_inputs</span><span class="p">(</span><span class="n">example</span><span class="p">,</span> <span class="n">context_length</span><span class="o">=</span><span class="mi">1024</span><span class="p">):</span>
</span></span><span class="line"><span class="ln">4</span><span class="cl">    <span class="n">ids</span> <span class="o">=</span> <span class="n">example</span><span class="p">[</span><span class="s2">&#34;input_ids&#34;</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">5</span><span class="cl">    <span class="n">chunks</span> <span class="o">=</span> <span class="p">[</span><span class="n">ids</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="n">context_length</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">ids</span><span class="p">)</span><span class="o">-</span><span class="n">context_length</span><span class="p">,</span> <span class="n">context_length</span><span class="p">)]</span>
</span></span><span class="line"><span class="ln">6</span><span class="cl">    <span class="k">return</span> <span class="p">{</span><span class="s2">&#34;input_ids&#34;</span><span class="p">:</span> <span class="n">chunks</span><span class="p">}</span>
</span></span><span class="line"><span class="ln">7</span><span class="cl">
</span></span><span class="line"><span class="ln">8</span><span class="cl"><span class="n">chunked_dataset</span> <span class="o">=</span> <span class="n">tokenized_dataset</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">chunk_inputs</span><span class="p">,</span> <span class="n">batched</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">remove_columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&#34;text&#34;</span><span class="p">])</span>
</span></span><span class="line"><span class="ln">9</span><span class="cl"><span class="n">train_loader</span> <span class="o">=</span> <span class="n">DataLoader</span><span class="p">(</span><span class="n">chunked_dataset</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></span></span></code></pre></div>
    
    <div
      class="collapse-overlay to-card/90 pointer-events-none absolute inset-0 bg-gradient-to-b from-transparent via-transparent opacity-0 transition-opacity duration-300">
      <div
        class="text-muted-foreground bg-card/80 border-border/50 hover:bg-primary/10 hover:text-primary hover:border-primary/30 absolute bottom-4 left-1/2 -translate-x-1/2 cursor-pointer rounded-full border px-3 py-1.5 text-xs backdrop-blur-sm transition-all duration-200">
        í´ë¦­í•˜ì—¬ ë” ë³´ê¸°
      </div>
    </div>
  </div>
</div>


<script>
(function() {
  const codeId = 'code-2';
  const copyBtn = document.querySelector('.copy-code-btn[data-code-id="' + codeId + '"]');
  const collapseBtn = document.querySelector('.collapse-code-btn[data-code-id="' + codeId + '"]');
  const codeContainer = document.getElementById(codeId);

  if (!codeContainer) return;

  
  if (copyBtn) {
    const copyIcon = copyBtn.querySelector('.copy-icon');
    const copyText = copyBtn.querySelector('.copy-text');

    copyBtn.addEventListener('click', async function() {
      try {
        
        let codeText = '';

        
        const codeTableCell = codeContainer.querySelector('.lntd:last-child code');
        if (codeTableCell) {
          codeText = codeTableCell.textContent || codeTableCell.innerText;
        } else {
          
          const codeElement = codeContainer.querySelector('code');
          if (codeElement) {
            
            const hasInlineLineNumbers = codeElement.querySelector('.ln');
            if (hasInlineLineNumbers) {
              
              const codeLines = codeElement.querySelectorAll('.cl');
              if (codeLines.length > 0) {
                codeText = Array.from(codeLines)
                  .map(line => {
                    const text = line.textContent || line.innerText;
                    
                    return text.replace(/\n+$/, '');
                  })
                  .join('\n')
                  .replace(/\n+$/, ''); 
              } else {
                
                const allText = codeElement.textContent || codeElement.innerText;
                codeText = allText.replace(/^\d+/gm, '').replace(/^\s+/gm, '');
              }
            } else {
              
              codeText = codeElement.textContent || codeElement.innerText;
            }
          } else {
            
            codeText = codeContainer.textContent || codeContainer.innerText;
          }
        }

        
        codeText = codeText.trim();

        
        await navigator.clipboard.writeText(codeText);

        
        copyIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M5 13l4 4L19 7\u0022 \/\u003e\n\u003c\/svg\u003e`;
        if (copyText) {
          copyText.textContent = 'ë³µì‚¬ë¨';
        }
        copyBtn.classList.add('text-green-600');

        
        setTimeout(() => {
          copyIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z\u0022 \/\u003e\n\u003c\/svg\u003e`;
          if (copyText) {
            copyText.textContent = 'ë³µì‚¬';
          }
          copyBtn.classList.remove('text-green-600');
        }, 2000);

      } catch (err) {
        console.error('å¤åˆ¶å¤±è´¥:', err);

        
        const range = document.createRange();
        const codeElement = codeContainer.querySelector('code') || codeContainer;
        range.selectNodeContents(codeElement);
        const selection = window.getSelection();
        selection.removeAllRanges();
        selection.addRange(range);

        
        if (copyText) {
          copyText.textContent = 'ì„ íƒë¨';
        }

        setTimeout(() => {
          if (copyText) {
            copyText.textContent = 'ë³µì‚¬';
          }
          selection.removeAllRanges();
        }, 2000);
      }
    });
  }

  
  if (collapseBtn) {
    const collapseIcon = collapseBtn.querySelector('.collapse-icon');
    const collapseText = collapseBtn.querySelector('.collapse-text');
    const collapseOverlay = codeContainer.querySelector('.collapse-overlay');

    
    let codeElement = codeContainer.querySelector('pre.chroma');
    if (!codeElement) {
      codeElement = codeContainer.querySelector('pre');
    }

    const defaultState = collapseBtn.dataset.defaultState || 'expanded';
    const isCollapsedAttr = collapseBtn.dataset.collapsed === 'true';
    const autoCollapseLines = parseInt(collapseBtn.dataset.autoCollapseLines) || 30;
    const autoCollapseHeight = parseInt(collapseBtn.dataset.autoCollapseHeight) || 400;
    const collapsedHeight = parseInt(collapseBtn.dataset.collapsedHeight) || 120;

    let isCollapsed = false;

    
    function initCollapse() {
      
      const shouldCollapse = isCollapsedAttr ||
                           defaultState === 'collapsed' ||
                           shouldAutoCollapse();

      if (shouldCollapse) {
        setCollapsed(true, false); 
      }
    }

    function shouldAutoCollapse() {
      
      if (codeElement) {
        const lines = codeElement.querySelectorAll('.line, .cl');
        const height = codeElement.offsetHeight;
        return lines.length > autoCollapseLines || height > autoCollapseHeight;
      }

      
      const containerHeight = codeContainer.offsetHeight;
      if (containerHeight > autoCollapseHeight) {
        return true;
      }

      
      const textContent = codeContainer.textContent || codeContainer.innerText || '';
      const estimatedLines = textContent.split('\n').length;
      return estimatedLines > autoCollapseLines;
    }

    function setCollapsed(collapsed, animate = true) {
      if (!collapseOverlay) return;

      isCollapsed = collapsed;

      if (collapsed) {
        
        codeContainer.style.maxHeight = collapsedHeight + 'px';
        codeContainer.style.overflow = 'hidden';
        collapseOverlay.style.opacity = '1';
        collapseOverlay.style.pointerEvents = 'auto';

        
        collapseIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M19 9l-7 7-7-7\u0022 \/\u003e\n\u003c\/svg\u003e`;
        if (collapseText) {
          collapseText.textContent = 'í¼ì¹˜ê¸°';
        }
        collapseBtn.title = 'í¼ì¹˜ê¸°';

      } else {
        
        codeContainer.style.maxHeight = '';
        codeContainer.style.overflow = '';
        collapseOverlay.style.opacity = '0';
        collapseOverlay.style.pointerEvents = 'none';

        
        collapseIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath fill=\u0022currentColor\u0022 d=\u0022M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z\u0022\/\u003e\u003c\/svg\u003e`;
        if (collapseText) {
          collapseText.textContent = 'ì ‘ê¸°';
        }
        collapseBtn.title = 'ì ‘ê¸°';
      }

      
      if (animate) {
        codeContainer.style.transition = 'max-height 0.3s ease-out';
        setTimeout(() => {
          codeContainer.style.transition = '';
        }, 300);
      }
    }

    function toggleCollapse() {
      setCollapsed(!isCollapsed, true);
    }

    
    collapseBtn.addEventListener('click', toggleCollapse);

    
    if (collapseOverlay) {
      collapseOverlay.addEventListener('click', () => {
        if (isCollapsed) {
          setCollapsed(false, true);
        }
      });
    }

    
    initCollapse();
  }
})();
</script>
<hr>
<h4 id="3ë‹¨ê³„-ëª¨ë¸-ì´ˆê¸°í™”">3ë‹¨ê³„: ëª¨ë¸ ì´ˆê¸°í™”</h4>
<div
  class="code-block-container border-border bg-card my-6 overflow-hidden rounded-xl border shadow-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:shadow-md">
  
  <div
    class="code-block-header bg-muted/30 border-border flex items-center justify-between border-b px-4 py-3">
    
    <div class="flex items-center gap-2">
      <div class="text-muted-foreground flex-shrink-0">
        
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4" />
</svg>
      </div>
      <span class="text-muted-foreground text-sm font-medium">
        PYTHON
      </span>
    </div>

    
    <div class="flex items-center gap-2">
      <button
          class="collapse-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none"
          data-code-id="code-3"
          data-default-state="expanded"
          data-collapsed="false"
          data-auto-collapse-lines="30"
          data-auto-collapse-height="400"
          data-collapsed-height="120"
          title="ì ‘ê¸°"
          aria-label="ì ‘ê¸°">
          <span class="collapse-icon">
            
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z"/></svg>
          </span>
          <span class="collapse-text hidden sm:inline"
            >ì ‘ê¸°</span
          >
        </button>
      <button
        class="copy-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none"
        data-code-id="code-3"
        title="ë³µì‚¬"
        aria-label="ë³µì‚¬">
        <span class="copy-icon">
          
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
</svg>
        </span>
        <span class="copy-text hidden sm:inline"
          >ë³µì‚¬</span
        >
      </button>
    </div>
  </div>

  
  <div class="code-block-content relative" id="code-3">
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="kn">from</span> <span class="nn">moeut.modeling_moeut</span> <span class="kn">import</span> <span class="n">MoEUTConfig</span><span class="p">,</span> <span class="n">MoEUTModel</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="n">config</span> <span class="o">=</span> <span class="n">MoEUTConfig</span><span class="p">(</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">    <span class="n">d_model</span><span class="o">=</span><span class="mi">1024</span><span class="p">,</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">    <span class="n">num_layers</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">    <span class="n">num_heads</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">    <span class="n">group_size</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">    <span class="n">num_ff_experts</span><span class="o">=</span><span class="mi">387</span><span class="p">,</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">    <span class="n">num_attn_experts</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">    <span class="n">expert_dim</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">    <span class="n">top_k_ff</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">    <span class="n">top_k_attn</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">    <span class="n">peri_layernorm</span><span class="o">=</span><span class="kc">True</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">
</span></span><span class="line"><span class="ln">16</span><span class="cl"><span class="n">model</span> <span class="o">=</span> <span class="n">MoEUTModel</span><span class="p">(</span><span class="n">config</span><span class="p">)</span></span></span></code></pre></div>
    
    <div
      class="collapse-overlay to-card/90 pointer-events-none absolute inset-0 bg-gradient-to-b from-transparent via-transparent opacity-0 transition-opacity duration-300">
      <div
        class="text-muted-foreground bg-card/80 border-border/50 hover:bg-primary/10 hover:text-primary hover:border-primary/30 absolute bottom-4 left-1/2 -translate-x-1/2 cursor-pointer rounded-full border px-3 py-1.5 text-xs backdrop-blur-sm transition-all duration-200">
        í´ë¦­í•˜ì—¬ ë” ë³´ê¸°
      </div>
    </div>
  </div>
</div>


<script>
(function() {
  const codeId = 'code-3';
  const copyBtn = document.querySelector('.copy-code-btn[data-code-id="' + codeId + '"]');
  const collapseBtn = document.querySelector('.collapse-code-btn[data-code-id="' + codeId + '"]');
  const codeContainer = document.getElementById(codeId);

  if (!codeContainer) return;

  
  if (copyBtn) {
    const copyIcon = copyBtn.querySelector('.copy-icon');
    const copyText = copyBtn.querySelector('.copy-text');

    copyBtn.addEventListener('click', async function() {
      try {
        
        let codeText = '';

        
        const codeTableCell = codeContainer.querySelector('.lntd:last-child code');
        if (codeTableCell) {
          codeText = codeTableCell.textContent || codeTableCell.innerText;
        } else {
          
          const codeElement = codeContainer.querySelector('code');
          if (codeElement) {
            
            const hasInlineLineNumbers = codeElement.querySelector('.ln');
            if (hasInlineLineNumbers) {
              
              const codeLines = codeElement.querySelectorAll('.cl');
              if (codeLines.length > 0) {
                codeText = Array.from(codeLines)
                  .map(line => {
                    const text = line.textContent || line.innerText;
                    
                    return text.replace(/\n+$/, '');
                  })
                  .join('\n')
                  .replace(/\n+$/, ''); 
              } else {
                
                const allText = codeElement.textContent || codeElement.innerText;
                codeText = allText.replace(/^\d+/gm, '').replace(/^\s+/gm, '');
              }
            } else {
              
              codeText = codeElement.textContent || codeElement.innerText;
            }
          } else {
            
            codeText = codeContainer.textContent || codeContainer.innerText;
          }
        }

        
        codeText = codeText.trim();

        
        await navigator.clipboard.writeText(codeText);

        
        copyIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M5 13l4 4L19 7\u0022 \/\u003e\n\u003c\/svg\u003e`;
        if (copyText) {
          copyText.textContent = 'ë³µì‚¬ë¨';
        }
        copyBtn.classList.add('text-green-600');

        
        setTimeout(() => {
          copyIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z\u0022 \/\u003e\n\u003c\/svg\u003e`;
          if (copyText) {
            copyText.textContent = 'ë³µì‚¬';
          }
          copyBtn.classList.remove('text-green-600');
        }, 2000);

      } catch (err) {
        console.error('å¤åˆ¶å¤±è´¥:', err);

        
        const range = document.createRange();
        const codeElement = codeContainer.querySelector('code') || codeContainer;
        range.selectNodeContents(codeElement);
        const selection = window.getSelection();
        selection.removeAllRanges();
        selection.addRange(range);

        
        if (copyText) {
          copyText.textContent = 'ì„ íƒë¨';
        }

        setTimeout(() => {
          if (copyText) {
            copyText.textContent = 'ë³µì‚¬';
          }
          selection.removeAllRanges();
        }, 2000);
      }
    });
  }

  
  if (collapseBtn) {
    const collapseIcon = collapseBtn.querySelector('.collapse-icon');
    const collapseText = collapseBtn.querySelector('.collapse-text');
    const collapseOverlay = codeContainer.querySelector('.collapse-overlay');

    
    let codeElement = codeContainer.querySelector('pre.chroma');
    if (!codeElement) {
      codeElement = codeContainer.querySelector('pre');
    }

    const defaultState = collapseBtn.dataset.defaultState || 'expanded';
    const isCollapsedAttr = collapseBtn.dataset.collapsed === 'true';
    const autoCollapseLines = parseInt(collapseBtn.dataset.autoCollapseLines) || 30;
    const autoCollapseHeight = parseInt(collapseBtn.dataset.autoCollapseHeight) || 400;
    const collapsedHeight = parseInt(collapseBtn.dataset.collapsedHeight) || 120;

    let isCollapsed = false;

    
    function initCollapse() {
      
      const shouldCollapse = isCollapsedAttr ||
                           defaultState === 'collapsed' ||
                           shouldAutoCollapse();

      if (shouldCollapse) {
        setCollapsed(true, false); 
      }
    }

    function shouldAutoCollapse() {
      
      if (codeElement) {
        const lines = codeElement.querySelectorAll('.line, .cl');
        const height = codeElement.offsetHeight;
        return lines.length > autoCollapseLines || height > autoCollapseHeight;
      }

      
      const containerHeight = codeContainer.offsetHeight;
      if (containerHeight > autoCollapseHeight) {
        return true;
      }

      
      const textContent = codeContainer.textContent || codeContainer.innerText || '';
      const estimatedLines = textContent.split('\n').length;
      return estimatedLines > autoCollapseLines;
    }

    function setCollapsed(collapsed, animate = true) {
      if (!collapseOverlay) return;

      isCollapsed = collapsed;

      if (collapsed) {
        
        codeContainer.style.maxHeight = collapsedHeight + 'px';
        codeContainer.style.overflow = 'hidden';
        collapseOverlay.style.opacity = '1';
        collapseOverlay.style.pointerEvents = 'auto';

        
        collapseIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M19 9l-7 7-7-7\u0022 \/\u003e\n\u003c\/svg\u003e`;
        if (collapseText) {
          collapseText.textContent = 'í¼ì¹˜ê¸°';
        }
        collapseBtn.title = 'í¼ì¹˜ê¸°';

      } else {
        
        codeContainer.style.maxHeight = '';
        codeContainer.style.overflow = '';
        collapseOverlay.style.opacity = '0';
        collapseOverlay.style.pointerEvents = 'none';

        
        collapseIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath fill=\u0022currentColor\u0022 d=\u0022M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z\u0022\/\u003e\u003c\/svg\u003e`;
        if (collapseText) {
          collapseText.textContent = 'ì ‘ê¸°';
        }
        collapseBtn.title = 'ì ‘ê¸°';
      }

      
      if (animate) {
        codeContainer.style.transition = 'max-height 0.3s ease-out';
        setTimeout(() => {
          codeContainer.style.transition = '';
        }, 300);
      }
    }

    function toggleCollapse() {
      setCollapsed(!isCollapsed, true);
    }

    
    collapseBtn.addEventListener('click', toggleCollapse);

    
    if (collapseOverlay) {
      collapseOverlay.addEventListener('click', () => {
        if (isCollapsed) {
          setCollapsed(false, true);
        }
      });
    }

    
    initCollapse();
  }
})();
</script>
<hr>
<h4 id="4ë‹¨ê³„-í•™ìŠµ-ë£¨í”„-perplexity-ê¸°ë°˜">4ë‹¨ê³„: í•™ìŠµ ë£¨í”„ (perplexity ê¸°ë°˜)</h4>
<div
  class="code-block-container border-border bg-card my-6 overflow-hidden rounded-xl border shadow-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:shadow-md">
  
  <div
    class="code-block-header bg-muted/30 border-border flex items-center justify-between border-b px-4 py-3">
    
    <div class="flex items-center gap-2">
      <div class="text-muted-foreground flex-shrink-0">
        
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4" />
</svg>
      </div>
      <span class="text-muted-foreground text-sm font-medium">
        PYTHON
      </span>
    </div>

    
    <div class="flex items-center gap-2">
      <button
          class="collapse-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none"
          data-code-id="code-4"
          data-default-state="expanded"
          data-collapsed="false"
          data-auto-collapse-lines="30"
          data-auto-collapse-height="400"
          data-collapsed-height="120"
          title="ì ‘ê¸°"
          aria-label="ì ‘ê¸°">
          <span class="collapse-icon">
            
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z"/></svg>
          </span>
          <span class="collapse-text hidden sm:inline"
            >ì ‘ê¸°</span
          >
        </button>
      <button
        class="copy-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none"
        data-code-id="code-4"
        title="ë³µì‚¬"
        aria-label="ë³µì‚¬">
        <span class="copy-icon">
          
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
</svg>
        </span>
        <span class="copy-text hidden sm:inline"
          >ë³µì‚¬</span
        >
      </button>
    </div>
  </div>

  
  <div class="code-block-content relative" id="code-4">
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="kn">import</span> <span class="nn">torch.nn.functional</span> <span class="k">as</span> <span class="nn">F</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="kn">import</span> <span class="nn">torch</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">
</span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="n">optimizer</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">AdamW</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">lr</span><span class="o">=</span><span class="mf">2.5e-4</span><span class="p">,</span> <span class="n">weight_decay</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">
</span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="k">for</span> <span class="n">step</span><span class="p">,</span> <span class="n">batch</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">train_loader</span><span class="p">):</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">    <span class="n">input_ids</span> <span class="o">=</span> <span class="n">batch</span><span class="p">[</span><span class="s2">&#34;input_ids&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">    <span class="n">labels</span> <span class="o">=</span> <span class="n">input_ids</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">
</span></span><span class="line"><span class="ln">10</span><span class="cl">    <span class="n">logits</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">input_ids</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">    <span class="n">loss</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">cross_entropy</span><span class="p">(</span><span class="n">logits</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">vocab_size</span><span class="p">),</span> <span class="n">labels</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">
</span></span><span class="line"><span class="ln">13</span><span class="cl">    <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl">    <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">clip_grad_norm_</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="mf">0.25</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">    <span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">    <span class="n">optimizer</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">
</span></span><span class="line"><span class="ln">18</span><span class="cl">    <span class="k">if</span> <span class="n">step</span> <span class="o">%</span> <span class="mi">100</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;Step </span><span class="si">{</span><span class="n">step</span><span class="si">}</span><span class="s2">: loss = </span><span class="si">{</span><span class="n">loss</span><span class="o">.</span><span class="n">item</span><span class="p">()</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span></span></span></code></pre></div>
    
    <div
      class="collapse-overlay to-card/90 pointer-events-none absolute inset-0 bg-gradient-to-b from-transparent via-transparent opacity-0 transition-opacity duration-300">
      <div
        class="text-muted-foreground bg-card/80 border-border/50 hover:bg-primary/10 hover:text-primary hover:border-primary/30 absolute bottom-4 left-1/2 -translate-x-1/2 cursor-pointer rounded-full border px-3 py-1.5 text-xs backdrop-blur-sm transition-all duration-200">
        í´ë¦­í•˜ì—¬ ë” ë³´ê¸°
      </div>
    </div>
  </div>
</div>


<script>
(function() {
  const codeId = 'code-4';
  const copyBtn = document.querySelector('.copy-code-btn[data-code-id="' + codeId + '"]');
  const collapseBtn = document.querySelector('.collapse-code-btn[data-code-id="' + codeId + '"]');
  const codeContainer = document.getElementById(codeId);

  if (!codeContainer) return;

  
  if (copyBtn) {
    const copyIcon = copyBtn.querySelector('.copy-icon');
    const copyText = copyBtn.querySelector('.copy-text');

    copyBtn.addEventListener('click', async function() {
      try {
        
        let codeText = '';

        
        const codeTableCell = codeContainer.querySelector('.lntd:last-child code');
        if (codeTableCell) {
          codeText = codeTableCell.textContent || codeTableCell.innerText;
        } else {
          
          const codeElement = codeContainer.querySelector('code');
          if (codeElement) {
            
            const hasInlineLineNumbers = codeElement.querySelector('.ln');
            if (hasInlineLineNumbers) {
              
              const codeLines = codeElement.querySelectorAll('.cl');
              if (codeLines.length > 0) {
                codeText = Array.from(codeLines)
                  .map(line => {
                    const text = line.textContent || line.innerText;
                    
                    return text.replace(/\n+$/, '');
                  })
                  .join('\n')
                  .replace(/\n+$/, ''); 
              } else {
                
                const allText = codeElement.textContent || codeElement.innerText;
                codeText = allText.replace(/^\d+/gm, '').replace(/^\s+/gm, '');
              }
            } else {
              
              codeText = codeElement.textContent || codeElement.innerText;
            }
          } else {
            
            codeText = codeContainer.textContent || codeContainer.innerText;
          }
        }

        
        codeText = codeText.trim();

        
        await navigator.clipboard.writeText(codeText);

        
        copyIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M5 13l4 4L19 7\u0022 \/\u003e\n\u003c\/svg\u003e`;
        if (copyText) {
          copyText.textContent = 'ë³µì‚¬ë¨';
        }
        copyBtn.classList.add('text-green-600');

        
        setTimeout(() => {
          copyIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z\u0022 \/\u003e\n\u003c\/svg\u003e`;
          if (copyText) {
            copyText.textContent = 'ë³µì‚¬';
          }
          copyBtn.classList.remove('text-green-600');
        }, 2000);

      } catch (err) {
        console.error('å¤åˆ¶å¤±è´¥:', err);

        
        const range = document.createRange();
        const codeElement = codeContainer.querySelector('code') || codeContainer;
        range.selectNodeContents(codeElement);
        const selection = window.getSelection();
        selection.removeAllRanges();
        selection.addRange(range);

        
        if (copyText) {
          copyText.textContent = 'ì„ íƒë¨';
        }

        setTimeout(() => {
          if (copyText) {
            copyText.textContent = 'ë³µì‚¬';
          }
          selection.removeAllRanges();
        }, 2000);
      }
    });
  }

  
  if (collapseBtn) {
    const collapseIcon = collapseBtn.querySelector('.collapse-icon');
    const collapseText = collapseBtn.querySelector('.collapse-text');
    const collapseOverlay = codeContainer.querySelector('.collapse-overlay');

    
    let codeElement = codeContainer.querySelector('pre.chroma');
    if (!codeElement) {
      codeElement = codeContainer.querySelector('pre');
    }

    const defaultState = collapseBtn.dataset.defaultState || 'expanded';
    const isCollapsedAttr = collapseBtn.dataset.collapsed === 'true';
    const autoCollapseLines = parseInt(collapseBtn.dataset.autoCollapseLines) || 30;
    const autoCollapseHeight = parseInt(collapseBtn.dataset.autoCollapseHeight) || 400;
    const collapsedHeight = parseInt(collapseBtn.dataset.collapsedHeight) || 120;

    let isCollapsed = false;

    
    function initCollapse() {
      
      const shouldCollapse = isCollapsedAttr ||
                           defaultState === 'collapsed' ||
                           shouldAutoCollapse();

      if (shouldCollapse) {
        setCollapsed(true, false); 
      }
    }

    function shouldAutoCollapse() {
      
      if (codeElement) {
        const lines = codeElement.querySelectorAll('.line, .cl');
        const height = codeElement.offsetHeight;
        return lines.length > autoCollapseLines || height > autoCollapseHeight;
      }

      
      const containerHeight = codeContainer.offsetHeight;
      if (containerHeight > autoCollapseHeight) {
        return true;
      }

      
      const textContent = codeContainer.textContent || codeContainer.innerText || '';
      const estimatedLines = textContent.split('\n').length;
      return estimatedLines > autoCollapseLines;
    }

    function setCollapsed(collapsed, animate = true) {
      if (!collapseOverlay) return;

      isCollapsed = collapsed;

      if (collapsed) {
        
        codeContainer.style.maxHeight = collapsedHeight + 'px';
        codeContainer.style.overflow = 'hidden';
        collapseOverlay.style.opacity = '1';
        collapseOverlay.style.pointerEvents = 'auto';

        
        collapseIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M19 9l-7 7-7-7\u0022 \/\u003e\n\u003c\/svg\u003e`;
        if (collapseText) {
          collapseText.textContent = 'í¼ì¹˜ê¸°';
        }
        collapseBtn.title = 'í¼ì¹˜ê¸°';

      } else {
        
        codeContainer.style.maxHeight = '';
        codeContainer.style.overflow = '';
        collapseOverlay.style.opacity = '0';
        collapseOverlay.style.pointerEvents = 'none';

        
        collapseIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath fill=\u0022currentColor\u0022 d=\u0022M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z\u0022\/\u003e\u003c\/svg\u003e`;
        if (collapseText) {
          collapseText.textContent = 'ì ‘ê¸°';
        }
        collapseBtn.title = 'ì ‘ê¸°';
      }

      
      if (animate) {
        codeContainer.style.transition = 'max-height 0.3s ease-out';
        setTimeout(() => {
          codeContainer.style.transition = '';
        }, 300);
      }
    }

    function toggleCollapse() {
      setCollapsed(!isCollapsed, true);
    }

    
    collapseBtn.addEventListener('click', toggleCollapse);

    
    if (collapseOverlay) {
      collapseOverlay.addEventListener('click', () => {
        if (isCollapsed) {
          setCollapsed(false, true);
        }
      });
    }

    
    initCollapse();
  }
})();
</script>

  <blockquote
    class="border-primary bg-muted/30 hover:bg-muted/40 my-6 rounded-r-lg border-l-4 py-4 pr-4 pl-6 italic transition-all duration-200 ease-out hover:translate-x-1">
    <div class="prose prose-sm max-w-none">
      <p>ğŸ’¡ <strong>Entropy Regularization</strong> í•­ ì¶”ê°€ í•„ìš”:</p>
    </div>
  </blockquote>

<div
  class="code-block-container border-border bg-card my-6 overflow-hidden rounded-xl border shadow-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:shadow-md">
  
  <div
    class="code-block-header bg-muted/30 border-border flex items-center justify-between border-b px-4 py-3">
    
    <div class="flex items-center gap-2">
      <div class="text-muted-foreground flex-shrink-0">
        
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4" />
</svg>
      </div>
      <span class="text-muted-foreground text-sm font-medium">
        PYTHON
      </span>
    </div>

    
    <div class="flex items-center gap-2">
      <button
          class="collapse-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none"
          data-code-id="code-5"
          data-default-state="expanded"
          data-collapsed="false"
          data-auto-collapse-lines="30"
          data-auto-collapse-height="400"
          data-collapsed-height="120"
          title="ì ‘ê¸°"
          aria-label="ì ‘ê¸°">
          <span class="collapse-icon">
            
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z"/></svg>
          </span>
          <span class="collapse-text hidden sm:inline"
            >ì ‘ê¸°</span
          >
        </button>
      <button
        class="copy-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none"
        data-code-id="code-5"
        title="ë³µì‚¬"
        aria-label="ë³µì‚¬">
        <span class="copy-icon">
          
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
</svg>
        </span>
        <span class="copy-text hidden sm:inline"
          >ë³µì‚¬</span
        >
      </button>
    </div>
  </div>

  
  <div class="code-block-content relative" id="code-5">
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="ln">1</span><span class="cl"><span class="n">loss_total</span> <span class="o">=</span> <span class="n">loss_lm</span> <span class="o">+</span> <span class="n">Î³</span> <span class="o">*</span> <span class="n">loss_entropy_ffn</span> <span class="o">+</span> <span class="n">Î´</span> <span class="o">*</span> <span class="n">loss_entropy_attn</span></span></span></code></pre></div>
    
    <div
      class="collapse-overlay to-card/90 pointer-events-none absolute inset-0 bg-gradient-to-b from-transparent via-transparent opacity-0 transition-opacity duration-300">
      <div
        class="text-muted-foreground bg-card/80 border-border/50 hover:bg-primary/10 hover:text-primary hover:border-primary/30 absolute bottom-4 left-1/2 -translate-x-1/2 cursor-pointer rounded-full border px-3 py-1.5 text-xs backdrop-blur-sm transition-all duration-200">
        í´ë¦­í•˜ì—¬ ë” ë³´ê¸°
      </div>
    </div>
  </div>
</div>


<script>
(function() {
  const codeId = 'code-5';
  const copyBtn = document.querySelector('.copy-code-btn[data-code-id="' + codeId + '"]');
  const collapseBtn = document.querySelector('.collapse-code-btn[data-code-id="' + codeId + '"]');
  const codeContainer = document.getElementById(codeId);

  if (!codeContainer) return;

  
  if (copyBtn) {
    const copyIcon = copyBtn.querySelector('.copy-icon');
    const copyText = copyBtn.querySelector('.copy-text');

    copyBtn.addEventListener('click', async function() {
      try {
        
        let codeText = '';

        
        const codeTableCell = codeContainer.querySelector('.lntd:last-child code');
        if (codeTableCell) {
          codeText = codeTableCell.textContent || codeTableCell.innerText;
        } else {
          
          const codeElement = codeContainer.querySelector('code');
          if (codeElement) {
            
            const hasInlineLineNumbers = codeElement.querySelector('.ln');
            if (hasInlineLineNumbers) {
              
              const codeLines = codeElement.querySelectorAll('.cl');
              if (codeLines.length > 0) {
                codeText = Array.from(codeLines)
                  .map(line => {
                    const text = line.textContent || line.innerText;
                    
                    return text.replace(/\n+$/, '');
                  })
                  .join('\n')
                  .replace(/\n+$/, ''); 
              } else {
                
                const allText = codeElement.textContent || codeElement.innerText;
                codeText = allText.replace(/^\d+/gm, '').replace(/^\s+/gm, '');
              }
            } else {
              
              codeText = codeElement.textContent || codeElement.innerText;
            }
          } else {
            
            codeText = codeContainer.textContent || codeContainer.innerText;
          }
        }

        
        codeText = codeText.trim();

        
        await navigator.clipboard.writeText(codeText);

        
        copyIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M5 13l4 4L19 7\u0022 \/\u003e\n\u003c\/svg\u003e`;
        if (copyText) {
          copyText.textContent = 'ë³µì‚¬ë¨';
        }
        copyBtn.classList.add('text-green-600');

        
        setTimeout(() => {
          copyIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z\u0022 \/\u003e\n\u003c\/svg\u003e`;
          if (copyText) {
            copyText.textContent = 'ë³µì‚¬';
          }
          copyBtn.classList.remove('text-green-600');
        }, 2000);

      } catch (err) {
        console.error('å¤åˆ¶å¤±è´¥:', err);

        
        const range = document.createRange();
        const codeElement = codeContainer.querySelector('code') || codeContainer;
        range.selectNodeContents(codeElement);
        const selection = window.getSelection();
        selection.removeAllRanges();
        selection.addRange(range);

        
        if (copyText) {
          copyText.textContent = 'ì„ íƒë¨';
        }

        setTimeout(() => {
          if (copyText) {
            copyText.textContent = 'ë³µì‚¬';
          }
          selection.removeAllRanges();
        }, 2000);
      }
    });
  }

  
  if (collapseBtn) {
    const collapseIcon = collapseBtn.querySelector('.collapse-icon');
    const collapseText = collapseBtn.querySelector('.collapse-text');
    const collapseOverlay = codeContainer.querySelector('.collapse-overlay');

    
    let codeElement = codeContainer.querySelector('pre.chroma');
    if (!codeElement) {
      codeElement = codeContainer.querySelector('pre');
    }

    const defaultState = collapseBtn.dataset.defaultState || 'expanded';
    const isCollapsedAttr = collapseBtn.dataset.collapsed === 'true';
    const autoCollapseLines = parseInt(collapseBtn.dataset.autoCollapseLines) || 30;
    const autoCollapseHeight = parseInt(collapseBtn.dataset.autoCollapseHeight) || 400;
    const collapsedHeight = parseInt(collapseBtn.dataset.collapsedHeight) || 120;

    let isCollapsed = false;

    
    function initCollapse() {
      
      const shouldCollapse = isCollapsedAttr ||
                           defaultState === 'collapsed' ||
                           shouldAutoCollapse();

      if (shouldCollapse) {
        setCollapsed(true, false); 
      }
    }

    function shouldAutoCollapse() {
      
      if (codeElement) {
        const lines = codeElement.querySelectorAll('.line, .cl');
        const height = codeElement.offsetHeight;
        return lines.length > autoCollapseLines || height > autoCollapseHeight;
      }

      
      const containerHeight = codeContainer.offsetHeight;
      if (containerHeight > autoCollapseHeight) {
        return true;
      }

      
      const textContent = codeContainer.textContent || codeContainer.innerText || '';
      const estimatedLines = textContent.split('\n').length;
      return estimatedLines > autoCollapseLines;
    }

    function setCollapsed(collapsed, animate = true) {
      if (!collapseOverlay) return;

      isCollapsed = collapsed;

      if (collapsed) {
        
        codeContainer.style.maxHeight = collapsedHeight + 'px';
        codeContainer.style.overflow = 'hidden';
        collapseOverlay.style.opacity = '1';
        collapseOverlay.style.pointerEvents = 'auto';

        
        collapseIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M19 9l-7 7-7-7\u0022 \/\u003e\n\u003c\/svg\u003e`;
        if (collapseText) {
          collapseText.textContent = 'í¼ì¹˜ê¸°';
        }
        collapseBtn.title = 'í¼ì¹˜ê¸°';

      } else {
        
        codeContainer.style.maxHeight = '';
        codeContainer.style.overflow = '';
        collapseOverlay.style.opacity = '0';
        collapseOverlay.style.pointerEvents = 'none';

        
        collapseIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath fill=\u0022currentColor\u0022 d=\u0022M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z\u0022\/\u003e\u003c\/svg\u003e`;
        if (collapseText) {
          collapseText.textContent = 'ì ‘ê¸°';
        }
        collapseBtn.title = 'ì ‘ê¸°';
      }

      
      if (animate) {
        codeContainer.style.transition = 'max-height 0.3s ease-out';
        setTimeout(() => {
          codeContainer.style.transition = '';
        }, 300);
      }
    }

    function toggleCollapse() {
      setCollapsed(!isCollapsed, true);
    }

    
    collapseBtn.addEventListener('click', toggleCollapse);

    
    if (collapseOverlay) {
      collapseOverlay.addEventListener('click', () => {
        if (isCollapsed) {
          setCollapsed(false, true);
        }
      });
    }

    
    initCollapse();
  }
})();
</script>
<hr>
<h2 id="-4-gpuí•˜ë“œì›¨ì–´-ìš”êµ¬ì‚¬í•­">âœ… 4. GPU/í•˜ë“œì›¨ì–´ ìš”êµ¬ì‚¬í•­</h2>
<table>
  <thead>
      <tr>
          <th>ëª¨ë¸ í¬ê¸°</th>
          <th>GPU ì¢…ë¥˜</th>
          <th>í•™ìŠµ ì‹œê°„ (ëŒ€ëµ)</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>44M</td>
          <td>4x V100</td>
          <td>ì•½ 20ì‹œê°„</td>
      </tr>
      <tr>
          <td>244M</td>
          <td>8x V100</td>
          <td>ì•½ 30ì‹œê°„</td>
      </tr>
      <tr>
          <td>1B</td>
          <td>4x A100 80GB</td>
          <td>ì•½ 70ì‹œê°„</td>
      </tr>
  </tbody>
</table>
<hr>
<h2 id="-5-checkpoint-ë°-evaluation">âœ… 5. Checkpoint ë° Evaluation</h2>
<ul>
<li><strong>Perplexity</strong>: held-out setì—ì„œ next-token prediction perplexityë¡œ í‰ê°€</li>
<li><strong>Zero-shot í‰ê°€</strong>: BLiMP, LAMBADA, PIQA ë“±ì—ì„œ accuracy ì¸¡ì •</li>
</ul>
<hr>
<h2 id="-6-ì¬í˜„ìš©-ì¶”ì²œ-ìŠ¤í¬ë¦½íŠ¸">âœ… 6. ì¬í˜„ìš© ì¶”ì²œ ìŠ¤í¬ë¦½íŠ¸</h2>
<p>ë…¼ë¬¸ì—ì„œ ì œê³µí•œ ê³µì‹ ë ˆí¬:</p>
<ul>
<li>ğŸ“¦ GitHub: <a href="https://github.com/robertcsordas/moeut">https://github.com/robertcsordas/moeut</a></li>
</ul>

  <blockquote
    class="border-primary bg-muted/30 hover:bg-muted/40 my-6 rounded-r-lg border-l-4 py-4 pr-4 pl-6 italic transition-all duration-200 ease-out hover:translate-x-1">
    <div class="prose prose-sm max-w-none">
      <p><code>train.py</code>, <code>modeling_moeut.py</code>, <code>config.yaml</code> êµ¬ì„±ë¨</p>
    </div>
  </blockquote>

<hr>
<h2 id="-ì •ë¦¬">ğŸ“ ì •ë¦¬</h2>
<table>
  <thead>
      <tr>
          <th>í•­ëª©</th>
          <th>MoEUT í•™ìŠµ ì‹œ í•„ìš”í•œ êµ¬ì„±</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>ë°ì´í„°ì…‹</td>
          <td>ì–¸ì–´ ëª¨ë¸ë§ (C4, SlimPajama ë“±), ì½”ë“œ (The Stack)</td>
      </tr>
      <tr>
          <td>ì…ë ¥ ë°©ì‹</td>
          <td>auto-regressive LM (1024 í† í°)</td>
      </tr>
      <tr>
          <td>í† í°í™”</td>
          <td>SentencePiece (8K)</td>
      </tr>
      <tr>
          <td>Loss êµ¬ì„±</td>
          <td>CrossEntropy + Ïƒ-MoE/attention entropy loss</td>
      </tr>
      <tr>
          <td>ëª¨ë¸ êµ¬ì„±</td>
          <td>Ïƒ-MoE FFN + SwitchHead Attention + Layer Grouping</td>
      </tr>
      <tr>
          <td>ìì› ìš”êµ¬</td>
          <td>ìµœì†Œ V100, ëŒ€ê·œëª¨ ì‹œ A100 í•„ìš”</td>
      </tr>
      <tr>
          <td>ì„±ëŠ¥ ì§€í‘œ</td>
          <td>perplexity, zero-shot accuracy</td>
      </tr>
  </tbody>
</table>
<h1 id="q--ì´-ë…¼ë¬¸ì—ì„œ-ì œì‹œí•œ-ê²°ê³¼ë¥¼-ìì„¸í•˜ê²Œ-ë³´ê³ -ë‹¤ë¥¸-ë°©ë²•ë¡ ì—-ë¹„í•˜ì—¬-íŠ¹ì¶œë‚œ-ì ê³¼-ë…¼ë¬¸ì—ì„œ-ì œê¸°í•˜ëŠ”-ì–´ë– í•œ-ë°©ë²•ì´-ì´ëŸ¬í•œ-ê²°ê³¼ë¥¼-ë„ì¶œí•˜ê²Œ-ë˜ì—ˆëŠ”ì§€-ë…¼ë¬¸ì—ì„œ-ì œì‹œí•˜ëŠ”-ì´ìœ ì™€-ë„ˆì˜-ìƒê°ì„-ì•Œë ¤ì¤˜">Q : ì´ ë…¼ë¬¸ì—ì„œ ì œì‹œí•œ ê²°ê³¼ë¥¼ ìì„¸í•˜ê²Œ ë³´ê³  ë‹¤ë¥¸ ë°©ë²•ë¡ ì— ë¹„í•˜ì—¬ íŠ¹ì¶œë‚œ ì ê³¼ ë…¼ë¬¸ì—ì„œ ì œê¸°í•˜ëŠ” ì–´ë– í•œ ë°©ë²•ì´ ì´ëŸ¬í•œ ê²°ê³¼ë¥¼ ë„ì¶œí•˜ê²Œ ë˜ì—ˆëŠ”ì§€ ë…¼ë¬¸ì—ì„œ ì œì‹œí•˜ëŠ” ì´ìœ ì™€ ë„ˆì˜ ìƒê°ì„ ì•Œë ¤ì¤˜</h1>
<p>ì¢‹ìŠµë‹ˆë‹¤. MoEUT ë…¼ë¬¸ì€ <strong>Universal Transformerì˜ layer-sharing ê¸°ë°˜ ì¼ë°˜í™” ì„±ëŠ¥</strong>ê³¼ <strong>Mixture-of-Experts(MoE)ì˜ compute íš¨ìœ¨ì„±</strong>ì„ ì ‘ëª©í•´ <strong>parameter efficiencyì™€ compute efficiency ëª¨ë‘ ë‹¬ì„±</strong>í•˜ëŠ” ê²ƒì„ ëª©í‘œë¡œ í–ˆìœ¼ë©°, ì‹¤í—˜ ê²°ê³¼ëŠ” ê·¸ ëª©í‘œì— ë¶€í•©í•©ë‹ˆë‹¤. ì•„ë˜ì— <strong>ê²°ê³¼ ìš”ì•½</strong>, <strong>ê¸°ì¡´ ë°©ë²•ê³¼ ë¹„êµí•´ íŠ¹ì¶œë‚œ ì </strong>, <strong>ê¸°ì—¬í•œ í•µì‹¬ ê¸°ë²•</strong>, ê·¸ë¦¬ê³  <strong>ì œì•ˆì˜ íƒ€ë‹¹ì„±ì— ëŒ€í•œ ì œ ì˜ê²¬</strong>ê¹Œì§€ êµ¬ì¡°í™”í•´ ì„¤ëª…ë“œë¦¬ê² ìŠµë‹ˆë‹¤.</p>
<hr>
<h2 id="-1-ì£¼ìš”-ì‹¤í—˜-ê²°ê³¼-ì •ë¦¬-í‘œ-ê¸°ë°˜-ìš”ì•½">âœ… 1. ì£¼ìš” ì‹¤í—˜ ê²°ê³¼ ì •ë¦¬ (í‘œ ê¸°ë°˜ ìš”ì•½)</h2>
<h3 id="-language-modeling-perplexity-c4-ê¸°ì¤€-held-out-set">ğŸ“Š Language Modeling Perplexity (C4 ê¸°ì¤€, held-out set)</h3>
<table>
  <thead>
      <tr>
          <th>ëª¨ë¸ ìœ í˜•</th>
          <th>#íŒŒë¼ë¯¸í„°</th>
          <th>Perplexity â†“</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>Dense Transformer</td>
          <td>244M</td>
          <td>13.40</td>
      </tr>
      <tr>
          <td>Ïƒ-MoE (non-shared)</td>
          <td>244M</td>
          <td>13.70</td>
      </tr>
      <tr>
          <td><strong>MoEUT (shared)</strong></td>
          <td>243M</td>
          <td><strong>13.24</strong></td>
      </tr>
  </tbody>
</table>
<ul>
<li><strong>ê°™ì€ íŒŒë¼ë¯¸í„° ìˆ˜ ì¡°ê±´ì—ì„œ ê°€ì¥ ë‚®ì€ perplexity</strong>ë¥¼ ê¸°ë¡</li>
<li><strong>ë™ì¼ compute (MACs) ì¡°ê±´</strong>ì—ì„œë„ MoEUTê°€ ìš°ìˆ˜í•¨</li>
</ul>
<h3 id="-zero-shot-downstream-ì„±ëŠ¥-ì˜ˆ-244m-ëª¨ë¸-ê¸°ì¤€">ğŸ“Š Zero-shot Downstream ì„±ëŠ¥ (ì˜ˆ: 244M ëª¨ë¸ ê¸°ì¤€)</h3>
<table>
  <thead>
      <tr>
          <th>Task</th>
          <th>Transformer</th>
          <th>MoEUT</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>LAMBADA</td>
          <td>33.1%</td>
          <td>30.6%</td>
      </tr>
      <tr>
          <td>BLiMP</td>
          <td>78.5%</td>
          <td><strong>79.7%</strong></td>
      </tr>
      <tr>
          <td>HellaSwag</td>
          <td>34.5%</td>
          <td><strong>35.7%</strong></td>
      </tr>
      <tr>
          <td>PIQA</td>
          <td>64.9%</td>
          <td><strong>65.2%</strong></td>
      </tr>
      <tr>
          <td>ARC-E</td>
          <td>36.9%</td>
          <td>36.4%</td>
      </tr>
      <tr>
          <td><strong>Average</strong></td>
          <td>55.6%</td>
          <td><strong>55.5%</strong></td>
      </tr>
  </tbody>
</table>
<ul>
<li>í° ì°¨ì´ëŠ” ì•„ë‹ˆì§€ë§Œ <strong>ì „ë°˜ì ìœ¼ë¡œ MoEUTê°€ ë” ë‚˜ì€ í‰ê·  ì„±ëŠ¥</strong></li>
</ul>
<hr>
<h2 id="-2-ê¸°ì¡´-ë°©ë²•-ëŒ€ë¹„-íŠ¹ì¶œë‚œ-ì -ë¹„êµ-ê´€ì ">âœ… 2. ê¸°ì¡´ ë°©ë²• ëŒ€ë¹„ íŠ¹ì¶œë‚œ ì  (ë¹„êµ ê´€ì )</h2>
<table>
  <thead>
      <tr>
          <th>ì¸¡ë©´</th>
          <th>ê¸°ì¡´ Dense Transformer</th>
          <th>SUT (Sparse UT)</th>
          <th><strong>MoEUT</strong></th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>Layer Sharing</td>
          <td>âŒ (no recurrence)</td>
          <td>âœ…</td>
          <td>âœ…</td>
      </tr>
      <tr>
          <td>Expert ì‚¬ìš©</td>
          <td>âŒ</td>
          <td>âœ… (MoE ì ìš©)</td>
          <td>âœ…</td>
      </tr>
      <tr>
          <td>Attentionì— MoE</td>
          <td>âŒ</td>
          <td>âœ…</td>
          <td>âœ… (SwitchHead)</td>
      </tr>
      <tr>
          <td>Layernorm ì „ëµ</td>
          <td>PreLN/PostLN</td>
          <td>PostLN</td>
          <td><strong>Peri-layernorm</strong></td>
      </tr>
      <tr>
          <td>Layer Grouping</td>
          <td>âŒ</td>
          <td>âŒ</td>
          <td>âœ…</td>
      </tr>
      <tr>
          <td>Compute Efficiency</td>
          <td>ì¤‘ê°„</td>
          <td>ë‚®ìŒ (ACT ë³‘ëª©)</td>
          <td><strong>ìš°ìˆ˜</strong></td>
      </tr>
      <tr>
          <td>í•™ìŠµ ì†ë„</td>
          <td>ë¹ ë¦„</td>
          <td>ëŠë¦¼ (ACT)</td>
          <td>ëŠë¦¼ (í˜„ì¬ ì»¤ë„ êµ¬í˜„ìƒ)</td>
      </tr>
      <tr>
          <td>Memory ì‚¬ìš©</td>
          <td>ë‚®ìŒ</td>
          <td>ë†’ìŒ</td>
          <td><strong>ë‚®ìŒ</strong></td>
      </tr>
  </tbody>
</table>
<p>â†’ íŠ¹íˆ <strong>parameter-compute ratio ë¬¸ì œë¥¼ íš¨ê³¼ì ìœ¼ë¡œ í•´ê²°í•œ ìµœì´ˆì˜ UT êµ¬ì¡°</strong></p>
<hr>
<h2 id="-3-ì„±ëŠ¥-í–¥ìƒì—-ê¸°ì—¬í•œ-í•µì‹¬-ê¸°ë²•-ë°-ë…¼ë¬¸-ì£¼ì¥">âœ… 3. ì„±ëŠ¥ í–¥ìƒì— ê¸°ì—¬í•œ í•µì‹¬ ê¸°ë²• ë° ë…¼ë¬¸ ì£¼ì¥</h2>
<h3 id="-1-Ïƒ-moe-in-ffn">ğŸ”¹ (1) Ïƒ-MoE in FFN</h3>
<ul>
<li><strong>ìˆ˜ë°± ê°œì˜ ì‘ì€ ì „ë¬¸ê°€ ì¤‘ top-Kë§Œ í™œì„±í™”</strong></li>
<li><code>dexpert = 128</code>, <code>K = d_model / dexpert</code> ë°©ì‹ìœ¼ë¡œ <strong>fine-grained sparsity</strong></li>
<li>ë…¼ë¬¸ ì£¼ì¥: ì‘ì€ expert ì‚¬ìš©ì´ í•™ìŠµ ì•ˆì •ì„±ê³¼ compute íš¨ìœ¨ì— í•µì‹¬ì </li>
</ul>
<p>â†’ ì‹¤í—˜ì  ì¦ê±°:</p>
<ul>
<li>Fig. 13ì—ì„œ ì‘ì€ dexpertê°€ ë” ë‚®ì€ perplexity ìœ ë„</li>
</ul>
<hr>
<h3 id="-2-switchhead-moe-self-attention">ğŸ”¹ (2) SwitchHead (MoE Self-Attention)</h3>
<ul>
<li>attentionì˜ <strong>value/output projectionì— expert êµ¬ì¡°</strong> ì‚½ì…</li>
<li>ê° head ë³„ë¡œ MoE êµ¬ì„± â†’ MoE-Attn íŠ¹í™” ê¸°ë²•</li>
</ul>
<p>â†’ MoEë¥¼ FFN ë¿ë§Œ ì•„ë‹ˆë¼ attentionê¹Œì§€ í™•ëŒ€ ì ìš©í•œ ì‚¬ë¡€ë¡œëŠ” ë“œë¬¾</p>
<hr>
<h3 id="-3-layer-grouping-ex-a-b-a-b-ìŠ¤íƒ€ì¼-ë°˜ë³µ">ğŸ”¹ (3) Layer Grouping (ex: A-B-A-B ìŠ¤íƒ€ì¼ ë°˜ë³µ)</h3>
<ul>
<li>ë™ì¼í•œ íŒŒë¼ë¯¸í„°ë¥¼ ê³µìœ í•˜ì§€ë§Œ <strong>ì„œë¡œ ë‹¤ë¥¸ ì—­í•  ìˆ˜í–‰í•˜ëŠ” ì—°ì†ëœ ë ˆì´ì–´</strong> êµ¬ì„±</li>
<li>sub-operation ë¶„ë¦¬ í•™ìŠµì„ ìœ ë„í•˜ì—¬ expressive power íšŒë³µ</li>
</ul>
<p>â†’ ì‹¤í—˜: Fig. 6ì—ì„œ G=2ê°€ ìµœì , G=1ì´ë‚˜ AABBëŠ” ì„±ëŠ¥ ì €í•˜</p>
<hr>
<h3 id="-4-peri-layernorm">ğŸ”¹ (4) Peri-layernorm</h3>
<ul>
<li><strong>LayerNormì„ gating activation ì•ì—ë§Œ ì ìš©</strong></li>
<li>residual pathì—ëŠ” ì ìš©í•˜ì§€ ì•ŠìŒ</li>
<li>gradient flowì™€ residual norm ì„±ì¥ ë¬¸ì œë¥¼ ë™ì‹œì— í•´ê²°</li>
</ul>
<p>â†’ Fig. 8ì—ì„œ PeriLNì´ PreLN/PostLNë³´ë‹¤ ë‚®ì€ perplexity ë‹¬ì„±</p>
<hr>
<h2 id="-4-ë…¼ë¬¸-ì£¼ì¥ì—-ëŒ€í•œ-ë¹„íŒì -ë¶„ì„-ë°-ë‚´-ìƒê°">ğŸ’­ 4. ë…¼ë¬¸ ì£¼ì¥ì— ëŒ€í•œ ë¹„íŒì  ë¶„ì„ ë° ë‚´ ìƒê°</h2>
<h3 id="-íƒ€ë‹¹í•œ-ì ">ğŸ’¡ íƒ€ë‹¹í•œ ì </h3>
<ol>
<li><strong>shared-layer UTì˜ expressive power ë¬¸ì œë¥¼ ì˜ íŒŒì•…í•˜ê³  ëŒ€ì‘</strong>
<ul>
<li>Layer groupingì€ recurrence êµ¬ì¡° ë‚´ ì—°ì‚° êµ¬ë¶„ì„ ëª…í™•íˆ í•´ì¤Œ</li>
</ul>
</li>
<li><strong>SwitchHeadì™€ Ïƒ-MoEì˜ ê²°í•©</strong>ì€ attentionê³¼ FFN ëª¨ë‘ì— sparse routingì„ ë„ì…í•œ <strong>ë“œë¬¸ ì„¤ê³„</strong></li>
<li><strong>Peri-layernorm ì„¤ê³„</strong>ëŠ” ê¸°ì¡´ norm ì „ëµì˜ ë‹¨ì ì„ í”¼í•˜ë©°, ì‹¤í—˜ì  íš¨ê³¼ë„ ëª…í™•</li>
</ol>
<h3 id="ë³´ì™„-í•„ìš”í•´-ë³´ì´ëŠ”-ì ">â—ï¸ë³´ì™„ í•„ìš”í•´ ë³´ì´ëŠ” ì </h3>
<ol>
<li>
<p><strong>í•™ìŠµ ì†ë„ ë° ì»¤ë„ êµ¬í˜„ ìµœì í™” ë¯¸ë¹„</strong><br>
â†’ FlashAttention ìˆ˜ì¤€ì˜ ì»¤ë„ì´ íƒ‘ì¬ë˜ë©´ í•™ìŠµ ì†ë„ 1.7x ê°œì„  ì˜ˆìƒ</p>
</li>
<li>
<p><strong>Massive scale ì‹¤í—˜ ë¶€ì¬</strong><br>
â†’ 1B íŒŒë¼ë¯¸í„° ì´ìƒì—ì„œëŠ” ë‹¤ë¥¸ íŠ¹ì„±ì´ ë‚˜íƒ€ë‚  ìˆ˜ ìˆìœ¼ë¯€ë¡œ, ì‹¤í—˜ í™•ì¥ì´ í•„ìš”</p>
</li>
<li>
<p><strong>Downstream ì„±ëŠ¥ í–¥ìƒì€ ì œí•œì </strong><br>
â†’ marginal ê°œì„  ìˆ˜ì¤€, ì—¬ì „íˆ zero-shot taskì—ì„œ ì˜ë¯¸ ìˆëŠ” ì°¨ì´ëŠ” ì ìŒ</p>
</li>
</ol>
<hr>
<h2 id="-ê²°ë¡ -1">ğŸ”š ê²°ë¡ </h2>
<p>MoEUTëŠ” <strong>ê¸°ì¡´ Universal Transformerê°€ ê°–ëŠ” compute ë¹„íš¨ìœ¨ì„± ë¬¸ì œë¥¼ MoEë¡œ í•´ê²°í•˜ê³ </strong>, ì—¬ê¸°ì— <strong>layer groupingê³¼ peri-layernormì´ë¼ëŠ” ê³ ìœ í•œ ì„¤ê³„ë¥¼ ì¶”ê°€í•˜ì—¬ í•™ìŠµ ì•ˆì •ì„±ê³¼ expressive powerë¥¼ í™•ë³´</strong>í•œ êµ¬ì¡°ì…ë‹ˆë‹¤. <strong>ê°™ì€ íŒŒë¼ë¯¸í„° ì¡°ê±´ ë˜ëŠ” ê°™ì€ ì—°ì‚°ëŸ‰ ì¡°ê±´ì—ì„œ ì„±ëŠ¥ì´ ìš°ìˆ˜</strong>í•˜ë‹¤ëŠ” ì ì€ ì‹¤í—˜ì ìœ¼ë¡œ ì¶©ë¶„íˆ ì…ì¦ë˜ì—ˆìœ¼ë©°, <strong>ì•ìœ¼ë¡œ layer-sharing ê¸°ë°˜ LLM êµ¬ì¡°ì—ì„œ ì¤‘ìš”í•œ ê¸°ì´ˆ ë‹¨ìœ„ë¡œ ì‚¬ìš©ë  ìˆ˜ ìˆëŠ” ì„¤ê³„</strong>ë¼ê³  íŒë‹¨ë©ë‹ˆë‹¤.</p>
<p>í•„ìš”í•˜ì‹œë©´ ì´ êµ¬ì¡°ë¥¼ ë‹¤ë¥¸ LLM (ì˜ˆ: LLaMAë‚˜ GPT ì‹œë¦¬ì¦ˆ)ì™€ í†µí•©í•˜ê±°ë‚˜ íŒŒìƒ êµ¬ì¡°ë¥¼ ì„¤ê³„í•˜ëŠ” ë°©ì•ˆë„ ì œì‹œë“œë¦´ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<h1 id="q--ì´-ë…¼ë¬¸ì˜-ì…ë ¥ë°ì´í„°ì™€-ì¶”ë¡ -ê³¼ì •ì—-ëŒ€í•´ì„œ-ì˜ˆì‹œë¥¼-ë“¤ì–´-ì•„ì£¼-ìì„¸í•˜ê²Œ-ì„¤ëª…í•´-ì£¼ê² ë‹ˆ-ì¶”ê°€ì ìœ¼ë¡œ-ëª¨ë¸ì•„í‚¤í…ì²˜ì˜-êµ¬ì„±-ë°-ëª¨ë¸ì„-êµ¬ì„±í•˜ëŠ”-ì—°ì‚°ê³¼-ë©”ëª¨ë¦¬-ìš”êµ¬ëŸ‰-ì»´í“¨íŒ…-ìš”êµ¬ëŸ‰-ëŒ€í•´ì„œë„-ì„¤ëª…í•´ì¤˜">Q : ì´ ë…¼ë¬¸ì˜ ì…ë ¥ë°ì´í„°ì™€ ì¶”ë¡  ê³¼ì •ì— ëŒ€í•´ì„œ ì˜ˆì‹œë¥¼ ë“¤ì–´ ì•„ì£¼ ìì„¸í•˜ê²Œ ì„¤ëª…í•´ ì£¼ê² ë‹ˆ? ì¶”ê°€ì ìœ¼ë¡œ ëª¨ë¸ì•„í‚¤í…ì²˜ì˜ êµ¬ì„± ë° ëª¨ë¸ì„ êµ¬ì„±í•˜ëŠ” ì—°ì‚°ê³¼ ë©”ëª¨ë¦¬ ìš”êµ¬ëŸ‰ ì»´í“¨íŒ… ìš”êµ¬ëŸ‰ ëŒ€í•´ì„œë„ ì„¤ëª…í•´ì¤˜</h1>
<p>ì¢‹ìŠµë‹ˆë‹¤. ì•„ë˜ëŠ” MoEUT ë…¼ë¬¸ì—ì„œì˜ <strong>ì…ë ¥â€“ì¶”ë¡  ê³¼ì •</strong>, <strong>ëª¨ë¸ ì•„í‚¤í…ì²˜ êµ¬ì„±</strong>, ê·¸ë¦¬ê³  <strong>ê° êµ¬ì„± ìš”ì†Œë³„ ì—°ì‚°ëŸ‰ ë° ë©”ëª¨ë¦¬/ì»´í“¨íŒ… ë¹„ìš© ë¶„ì„</strong>ì„ <strong>êµ¬ì²´ì ì¸ ì˜ˆì‹œ</strong>ë¥¼ í†µí•´ ì•„ì£¼ ìì„¸í•˜ê²Œ ì •ë¦¬í•œ ë‚´ìš©ì…ë‹ˆë‹¤.</p>
<hr>
<h2 id="-1-ì…ë ¥-ë°ì´í„°ì™€-ì¶”ë¡ -ê³¼ì •-ì˜ˆì‹œ-ê¸°ë°˜-ì„¤ëª…">âœ… 1. ì…ë ¥ ë°ì´í„°ì™€ ì¶”ë¡  ê³¼ì •: ì˜ˆì‹œ ê¸°ë°˜ ì„¤ëª…</h2>
<h3 id="-ì˜ˆì‹œ-ì…ë ¥">âœï¸ ì˜ˆì‹œ ì…ë ¥</h3>
<ul>
<li>
<p>ì…ë ¥ ë¬¸ì¥: <code>&quot;The cat sat on the mat.&quot;</code></p>
</li>
<li>
<p>í† í¬ë‚˜ì´ì €: SentencePiece, vocab size = 8000</p>
</li>
<li>
<p>ì˜ˆì‹œ í† í°í™” ê²°ê³¼:</p>
<div
  class="code-block-container border-border bg-card my-6 overflow-hidden rounded-xl border shadow-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:shadow-md">
  
  <div
    class="code-block-header bg-muted/30 border-border flex items-center justify-between border-b px-4 py-3">
    
    <div class="flex items-center gap-2">
      <div class="text-muted-foreground flex-shrink-0">
        
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4" />
</svg>
      </div>
      <span class="text-muted-foreground text-sm font-medium">
        PYTHON
      </span>
    </div>

    
    <div class="flex items-center gap-2">
      <button
          class="collapse-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none"
          data-code-id="code-6"
          data-default-state="expanded"
          data-collapsed="false"
          data-auto-collapse-lines="30"
          data-auto-collapse-height="400"
          data-collapsed-height="120"
          title="ì ‘ê¸°"
          aria-label="ì ‘ê¸°">
          <span class="collapse-icon">
            
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z"/></svg>
          </span>
          <span class="collapse-text hidden sm:inline"
            >ì ‘ê¸°</span
          >
        </button>
      <button
        class="copy-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none"
        data-code-id="code-6"
        title="ë³µì‚¬"
        aria-label="ë³µì‚¬">
        <span class="copy-icon">
          
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
</svg>
        </span>
        <span class="copy-text hidden sm:inline"
          >ë³µì‚¬</span
        >
      </button>
    </div>
  </div>

  
  <div class="code-block-content relative" id="code-6">
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="ln">1</span><span class="cl"><span class="p">[</span><span class="s2">&#34;â–The&#34;</span><span class="p">,</span> <span class="s2">&#34;â–cat&#34;</span><span class="p">,</span> <span class="s2">&#34;â–sat&#34;</span><span class="p">,</span> <span class="s2">&#34;â–on&#34;</span><span class="p">,</span> <span class="s2">&#34;â–the&#34;</span><span class="p">,</span> <span class="s2">&#34;â–mat&#34;</span><span class="p">,</span> <span class="s2">&#34;.&#34;</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="err">â‡’</span> <span class="n">input_ids</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1012</span><span class="p">,</span> <span class="mi">2024</span><span class="p">,</span> <span class="mi">1543</span><span class="p">,</span> <span class="mi">1324</span><span class="p">,</span> <span class="mi">1091</span><span class="p">,</span> <span class="mi">2932</span><span class="p">,</span> <span class="mi">7</span><span class="p">]</span></span></span></code></pre></div>
    
    <div
      class="collapse-overlay to-card/90 pointer-events-none absolute inset-0 bg-gradient-to-b from-transparent via-transparent opacity-0 transition-opacity duration-300">
      <div
        class="text-muted-foreground bg-card/80 border-border/50 hover:bg-primary/10 hover:text-primary hover:border-primary/30 absolute bottom-4 left-1/2 -translate-x-1/2 cursor-pointer rounded-full border px-3 py-1.5 text-xs backdrop-blur-sm transition-all duration-200">
        í´ë¦­í•˜ì—¬ ë” ë³´ê¸°
      </div>
    </div>
  </div>
</div>


<script>
(function() {
  const codeId = 'code-6';
  const copyBtn = document.querySelector('.copy-code-btn[data-code-id="' + codeId + '"]');
  const collapseBtn = document.querySelector('.collapse-code-btn[data-code-id="' + codeId + '"]');
  const codeContainer = document.getElementById(codeId);

  if (!codeContainer) return;

  
  if (copyBtn) {
    const copyIcon = copyBtn.querySelector('.copy-icon');
    const copyText = copyBtn.querySelector('.copy-text');

    copyBtn.addEventListener('click', async function() {
      try {
        
        let codeText = '';

        
        const codeTableCell = codeContainer.querySelector('.lntd:last-child code');
        if (codeTableCell) {
          codeText = codeTableCell.textContent || codeTableCell.innerText;
        } else {
          
          const codeElement = codeContainer.querySelector('code');
          if (codeElement) {
            
            const hasInlineLineNumbers = codeElement.querySelector('.ln');
            if (hasInlineLineNumbers) {
              
              const codeLines = codeElement.querySelectorAll('.cl');
              if (codeLines.length > 0) {
                codeText = Array.from(codeLines)
                  .map(line => {
                    const text = line.textContent || line.innerText;
                    
                    return text.replace(/\n+$/, '');
                  })
                  .join('\n')
                  .replace(/\n+$/, ''); 
              } else {
                
                const allText = codeElement.textContent || codeElement.innerText;
                codeText = allText.replace(/^\d+/gm, '').replace(/^\s+/gm, '');
              }
            } else {
              
              codeText = codeElement.textContent || codeElement.innerText;
            }
          } else {
            
            codeText = codeContainer.textContent || codeContainer.innerText;
          }
        }

        
        codeText = codeText.trim();

        
        await navigator.clipboard.writeText(codeText);

        
        copyIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M5 13l4 4L19 7\u0022 \/\u003e\n\u003c\/svg\u003e`;
        if (copyText) {
          copyText.textContent = 'ë³µì‚¬ë¨';
        }
        copyBtn.classList.add('text-green-600');

        
        setTimeout(() => {
          copyIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z\u0022 \/\u003e\n\u003c\/svg\u003e`;
          if (copyText) {
            copyText.textContent = 'ë³µì‚¬';
          }
          copyBtn.classList.remove('text-green-600');
        }, 2000);

      } catch (err) {
        console.error('å¤åˆ¶å¤±è´¥:', err);

        
        const range = document.createRange();
        const codeElement = codeContainer.querySelector('code') || codeContainer;
        range.selectNodeContents(codeElement);
        const selection = window.getSelection();
        selection.removeAllRanges();
        selection.addRange(range);

        
        if (copyText) {
          copyText.textContent = 'ì„ íƒë¨';
        }

        setTimeout(() => {
          if (copyText) {
            copyText.textContent = 'ë³µì‚¬';
          }
          selection.removeAllRanges();
        }, 2000);
      }
    });
  }

  
  if (collapseBtn) {
    const collapseIcon = collapseBtn.querySelector('.collapse-icon');
    const collapseText = collapseBtn.querySelector('.collapse-text');
    const collapseOverlay = codeContainer.querySelector('.collapse-overlay');

    
    let codeElement = codeContainer.querySelector('pre.chroma');
    if (!codeElement) {
      codeElement = codeContainer.querySelector('pre');
    }

    const defaultState = collapseBtn.dataset.defaultState || 'expanded';
    const isCollapsedAttr = collapseBtn.dataset.collapsed === 'true';
    const autoCollapseLines = parseInt(collapseBtn.dataset.autoCollapseLines) || 30;
    const autoCollapseHeight = parseInt(collapseBtn.dataset.autoCollapseHeight) || 400;
    const collapsedHeight = parseInt(collapseBtn.dataset.collapsedHeight) || 120;

    let isCollapsed = false;

    
    function initCollapse() {
      
      const shouldCollapse = isCollapsedAttr ||
                           defaultState === 'collapsed' ||
                           shouldAutoCollapse();

      if (shouldCollapse) {
        setCollapsed(true, false); 
      }
    }

    function shouldAutoCollapse() {
      
      if (codeElement) {
        const lines = codeElement.querySelectorAll('.line, .cl');
        const height = codeElement.offsetHeight;
        return lines.length > autoCollapseLines || height > autoCollapseHeight;
      }

      
      const containerHeight = codeContainer.offsetHeight;
      if (containerHeight > autoCollapseHeight) {
        return true;
      }

      
      const textContent = codeContainer.textContent || codeContainer.innerText || '';
      const estimatedLines = textContent.split('\n').length;
      return estimatedLines > autoCollapseLines;
    }

    function setCollapsed(collapsed, animate = true) {
      if (!collapseOverlay) return;

      isCollapsed = collapsed;

      if (collapsed) {
        
        codeContainer.style.maxHeight = collapsedHeight + 'px';
        codeContainer.style.overflow = 'hidden';
        collapseOverlay.style.opacity = '1';
        collapseOverlay.style.pointerEvents = 'auto';

        
        collapseIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M19 9l-7 7-7-7\u0022 \/\u003e\n\u003c\/svg\u003e`;
        if (collapseText) {
          collapseText.textContent = 'í¼ì¹˜ê¸°';
        }
        collapseBtn.title = 'í¼ì¹˜ê¸°';

      } else {
        
        codeContainer.style.maxHeight = '';
        codeContainer.style.overflow = '';
        collapseOverlay.style.opacity = '0';
        collapseOverlay.style.pointerEvents = 'none';

        
        collapseIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath fill=\u0022currentColor\u0022 d=\u0022M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z\u0022\/\u003e\u003c\/svg\u003e`;
        if (collapseText) {
          collapseText.textContent = 'ì ‘ê¸°';
        }
        collapseBtn.title = 'ì ‘ê¸°';
      }

      
      if (animate) {
        codeContainer.style.transition = 'max-height 0.3s ease-out';
        setTimeout(() => {
          codeContainer.style.transition = '';
        }, 300);
      }
    }

    function toggleCollapse() {
      setCollapsed(!isCollapsed, true);
    }

    
    collapseBtn.addEventListener('click', toggleCollapse);

    
    if (collapseOverlay) {
      collapseOverlay.addEventListener('click', () => {
        if (isCollapsed) {
          setCollapsed(false, true);
        }
      });
    }

    
    initCollapse();
  }
})();
</script>
</li>
<li>
<p>ì‹œí€€ìŠ¤ ê¸¸ì´: <code>L = 7</code></p>
</li>
<li>
<p>Embedding dimension: <code>d_model = 1024</code></p>
</li>
</ul>
<hr>
<h3 id="-ì¶”ë¡ -ìˆœì„œ-simplified-inference-path">ğŸ” ì¶”ë¡  ìˆœì„œ (Simplified Inference Path)</h3>
<h4 id="-input-embedding">â‘  Input Embedding</h4>
<ul>
<li>ì…ë ¥: <code>input_ids âˆˆ â„¤â·</code></li>
<li>Position Encoding: RoPE ì ìš©</li>
<li>ì¶œë ¥: <code>X âˆˆ â„^{7Ã—1024}</code></li>
</ul>
<h4 id="-layer-group-ë°˜ë³µ-ex-g2-l18--9íšŒ-ë°˜ë³µ">â‘¡ Layer Group ë°˜ë³µ (ex: G=2, L=18 â†’ 9íšŒ ë°˜ë³µ)</h4>
<p>ê° group = [Layer A, Layer B] = [MoE-Attn + MoE-FFN] with shared weights</p>
<hr>
<h4 id="-step-by-step-single-moe-layer-ì˜ˆì‹œ">â–¶ Step-by-step: Single MoE Layer ì˜ˆì‹œ</h4>
<h5 id="a-moe-self-attention-switchhead">A. <strong>MoE Self-Attention (SwitchHead)</strong></h5>
<ul>
<li>Head ìˆ˜: 4 (dense ëŒ€ë¹„ ê°ì†Œ)</li>
<li>ê° headì˜ value/output projectionì€ MoE êµ¬ì¡°</li>
</ul>
<p><strong>ì˜ˆë¥¼ ë“¤ì–´</strong>, <code>head h</code>ì—ì„œ í† í° <code>xâ‚œ âˆˆ â„^{1024}</code>ê°€ ë‹¤ìŒê³¼ ê°™ì´ ì²˜ë¦¬ë¨:</p>
<ul>
<li>Query/KeyëŠ” dense ê³„ì‚°:
[
q_t^h = x_t W_Q^h, \quad k_t^h = x_t W_K^h \quad (\text{ë‘˜ ë‹¤ } â„^{256})
]</li>
<li>Value: top-K MoE routing (ex: NA=10, K=2)
<ul>
<li>Expert gating score:<br>
[
s_t^h = Ïƒ(x_t W_{SV}^h) âˆˆ â„^{10}
\Rightarrow \text{Top-2 expert ì„ íƒ}
]</li>
<li>ê° expertì˜ value projection:
[
v_t^h = \sum_{eâˆˆtop2} s_t^h[e] Â· x_t W_V^{h,e} âˆˆ â„^{256}
]</li>
</ul>
</li>
<li>Output projectionë„ ë™ì¼í•œ MoE êµ¬ì¡°</li>
</ul>
<p>â‡’ ê° í† í°ë‹¹ multi-head attention ìˆ˜í–‰ í›„ concat + projection â†’ <code>â„^{1024}</code></p>
<hr>
<h5 id="b-Ïƒ-moe-feedforward">B. <strong>Ïƒ-MoE Feedforward</strong></h5>
<ul>
<li>
<p>Expert ìˆ˜: NE = 387</p>
</li>
<li>
<p>Expert dimension: dexpert = 128</p>
</li>
<li>
<p>Top-K = 16</p>
</li>
<li>
<p>í† í° <code>x_t âˆˆ â„^{1024}</code> ì²˜ë¦¬:</p>
<ul>
<li>Gating score ê³„ì‚°:<br>
[
s_t = Ïƒ(x_t W_S) âˆˆ â„^{387}
\Rightarrow \text{Top-16 expert ì„ íƒ}
]</li>
<li>ê° expertì˜ ì—°ì‚°:
[
v_t^e = ReLU(x_t W_1^e) W_2^e âˆˆ â„^{1024}
]</li>
<li>Weighted sum:
[
y_t = \sum_{eâˆˆtop16} s_t[e] Â· v_t^e
]</li>
</ul>
</li>
</ul>
<hr>
<h4 id="-residual--peri-layernorm">â‘¢ Residual + Peri-layernorm</h4>
<ul>
<li>LayerNormì€ <strong>Query/Key projection ë° gating ì•ì—ë§Œ</strong> ì ìš©ë¨</li>
<li>Main data path (V, ReLU ë“±)ëŠ” LayerNorm ì—†ì´ ì§„í–‰</li>
<li>Residual connectionìœ¼ë¡œ <code>x_t + y_t</code> ì¡°í•©</li>
</ul>
<hr>
<h4 id="-output-layer">â‘£ Output Layer</h4>
<ul>
<li>ë§ˆì§€ë§‰ hidden state â†’ Linear â†’ Softmax â†’ ë‹¤ìŒ í† í° ì˜ˆì¸¡ í™•ë¥  ë¶„í¬</li>
</ul>
<hr>
<h2 id="-2-ëª¨ë¸-ì•„í‚¤í…ì²˜-êµ¬ì„±-ìš”ì•½">âœ… 2. ëª¨ë¸ ì•„í‚¤í…ì²˜ êµ¬ì„± ìš”ì•½</h2>
<table>
  <thead>
      <tr>
          <th>ì»´í¬ë„ŒíŠ¸</th>
          <th>êµ¬ì¡°</th>
          <th>íŠ¹ì§•</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>Embedding</td>
          <td>Token + RoPE Positional</td>
          <td>RoFormer ìŠ¤íƒ€ì¼</td>
      </tr>
      <tr>
          <td>Layer</td>
          <td>Layer Group (A, B)</td>
          <td>Shared-weight ë°˜ë³µ êµ¬ì¡°</td>
      </tr>
      <tr>
          <td>Attention</td>
          <td>Multi-head + SwitchHead</td>
          <td>value/outputì— MoE ì ìš©</td>
      </tr>
      <tr>
          <td>FFN</td>
          <td>Ïƒ-MoE</td>
          <td>Top-K soft gating, fine-grained experts</td>
      </tr>
      <tr>
          <td>LayerNorm</td>
          <td>Peri-layernorm</td>
          <td>gating/score ê³„ì‚° ì „ìš©</td>
      </tr>
      <tr>
          <td>Output</td>
          <td>LM Head (Linear)</td>
          <td>token logits ì˜ˆì¸¡</td>
      </tr>
  </tbody>
</table>
<hr>
<h2 id="-3-ì—°ì‚°ëŸ‰-ë°-ë©”ëª¨ë¦¬-ë¶„ì„-per-token-ê¸°ì¤€">âœ… 3. ì—°ì‚°ëŸ‰ ë° ë©”ëª¨ë¦¬ ë¶„ì„ (per-token ê¸°ì¤€)</h2>
<h3 id="-feedforward-Ïƒ-moe">âœ³ï¸ Feedforward (Ïƒ-MoE)</h3>
<table>
  <thead>
      <tr>
          <th>í•­ëª©</th>
          <th>ì—°ì‚°ëŸ‰</th>
          <th>ë©”ëª¨ë¦¬</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>Gating (1 Ã— 1024 Ã— 387)</td>
          <td>396K MACs</td>
          <td>387 floats</td>
      </tr>
      <tr>
          <td>K=16 Expert ì—°ì‚°</td>
          <td>16 Ã— (1024Ã—128 + 128Ã—1024) = 4.2M MACs</td>
          <td>16Ã—Wâ‚, Wâ‚‚ (static)</td>
      </tr>
      <tr>
          <td>ì´í•©</td>
          <td><strong>~4.6M MACs</strong></td>
          <td>Expert ê°€ì¤‘ì¹˜ ìºì‹œ í•„ìš”</td>
      </tr>
  </tbody>
</table>
<p>â†’ Sparse routing ë•ë¶„ì— dense FFN ëŒ€ë¹„ compute ì ˆë°˜ ì´í•˜</p>
<hr>
<h3 id="-moe-attention-switchhead">âœ³ï¸ MoE Attention (SwitchHead)</h3>
<table>
  <thead>
      <tr>
          <th>í•­ëª©</th>
          <th>ì—°ì‚°ëŸ‰</th>
          <th>ë©”ëª¨ë¦¬</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>Q/K/V projection</td>
          <td>Q,K: 1Ã—1024Ã—256 = 262K Ã— 2</td>
          <td>ì‘ìŒ</td>
      </tr>
      <tr>
          <td>Value expert routing</td>
          <td>Top-2, ê° V proj 1024Ã—256 â†’ 2Ã—262K = 524K</td>
          <td></td>
      </tr>
      <tr>
          <td>Attention score + weighted sum</td>
          <td>(TÃ—T) scaled dot</td>
          <td>T ì œí•œë¨</td>
      </tr>
      <tr>
          <td>Output MoE projection</td>
          <td>2Ã—(256Ã—1024) = 524K</td>
          <td></td>
      </tr>
      <tr>
          <td>ì´í•©</td>
          <td><strong>~1.6M MACs</strong></td>
          <td>per-head, per-token</td>
      </tr>
  </tbody>
</table>
<hr>
<h3 id="-ì´-ì¶”ë¡ -ë¹„ìš©-ì˜ˆ-t1024-18-shared-layers-g2">ğŸ”¢ ì´ ì¶”ë¡  ë¹„ìš© (ì˜ˆ: T=1024, 18 shared layers, G=2)</h3>
<ul>
<li>ë ˆì´ì–´ ë°˜ë³µ: 9íšŒ</li>
<li>ì´ ì—°ì‚°ëŸ‰ (per-token ê¸°ì¤€):<br>
[
9 Ã— (MoEAttn + MoEFFN) â‰ˆ 9 Ã— (1.6M + 4.6M) â‰ˆ 55.8M MACs/token
]</li>
</ul>
<p>â†’ ëŒ€í˜• ëª¨ë¸ì—ì„œ token-by-token ì¶”ë¡  ì‹œ ë§¤ìš° ì¤‘ìš”</p>
<hr>
<h2 id="-4-ë©”ëª¨ë¦¬-ì‚¬ìš©ëŸ‰-ë¹„êµ-ì‹¤í—˜-ê²°ê³¼-ê¸°ë°˜">âœ… 4. ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ë¹„êµ (ì‹¤í—˜ ê²°ê³¼ ê¸°ë°˜)</h2>
<table>
  <thead>
      <tr>
          <th>ëª¨ë¸</th>
          <th>íŒŒë¼ë¯¸í„° ìˆ˜</th>
          <th>Memory (8Ã—V100 ê¸°ì¤€)</th>
          <th>í•™ìŠµ ì‹œê°„</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>Transformer (dense)</td>
          <td>244M</td>
          <td>9.2 GB</td>
          <td>443 ms/batch</td>
      </tr>
      <tr>
          <td>MoEUT</td>
          <td>243M</td>
          <td><strong>9.0 GB</strong></td>
          <td><strong>772 ms/batch</strong></td>
      </tr>
      <tr>
          <td>SUT</td>
          <td>244M</td>
          <td>23.4 GB</td>
          <td>1344 ms/batch</td>
      </tr>
  </tbody>
</table>
<p>â†’ MoEUTëŠ” <strong>ë©”ëª¨ë¦¬ íš¨ìœ¨ì€ denseì™€ ìœ ì‚¬</strong>, <strong>SUTë³´ë‹¤ 2.5ë°° ë¹ ë¦„</strong></p>
<hr>
<h2 id="-ê²°ë¡ -ìš”ì•½">âœ… ê²°ë¡  ìš”ì•½</h2>
<table>
  <thead>
      <tr>
          <th>í•­ëª©</th>
          <th>ì„¤ëª…</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>ì…ë ¥ â†’ ì¶”ë¡ </td>
          <td>SentencePiece â†’ Embedding â†’ ë°˜ë³µ Group Layer (MoE + Attention) â†’ Softmax</td>
      </tr>
      <tr>
          <td>ì•„í‚¤í…ì²˜ í•µì‹¬</td>
          <td>Ïƒ-MoE + SwitchHead + Grouping + PeriLayerNorm</td>
      </tr>
      <tr>
          <td>ì¶”ë¡  ê²½ë¡œ</td>
          <td>ê° tokenë§ˆë‹¤ MoE routing â†’ expert ì—°ì‚° â†’ residual + attention</td>
      </tr>
      <tr>
          <td>ì—°ì‚°ëŸ‰</td>
          <td>FFN &gt; Attentionì´ë©°, ëª¨ë‘ sparse routingìœ¼ë¡œ íš¨ìœ¨í™”</td>
      </tr>
      <tr>
          <td>ë©”ëª¨ë¦¬</td>
          <td>Expert paramì€ ê³µìœ , activationë§Œ token-dependentë¡œ ìºì‹œ ê°€ëŠ¥</td>
      </tr>
  </tbody>
</table>
<h1 id="q--ì´-ë…¼ë¬¸ì˜-í•œê³„ë¥¼-ê·¹ë³µí•˜ê¸°-ìœ„í•œ-ë°©ë²•ìœ¼ë¡œ-ì–´ë–¤-ì—°êµ¬íë¦„ì´-ìˆëŠ”ì§€-ì •ë¦¬í•´ì„œ-ìì„¸í•˜ê²Œ-ì„¤ëª…í•´-ì¤˜">Q : ì´ ë…¼ë¬¸ì˜ í•œê³„ë¥¼ ê·¹ë³µí•˜ê¸° ìœ„í•œ ë°©ë²•ìœ¼ë¡œ ì–´ë–¤ ì—°êµ¬íë¦„ì´ ìˆëŠ”ì§€ ì •ë¦¬í•´ì„œ ìì„¸í•˜ê²Œ ì„¤ëª…í•´ ì¤˜</h1>
<p>ì¢‹ìŠµë‹ˆë‹¤. MoEUT ë…¼ë¬¸ì€ Universal Transformer(UT)ì˜ compute inefficiency ë¬¸ì œë¥¼ Mixture-of-Experts(MoE)ë¡œ ê·¹ë³µí•œ êµ¬ì¡°ì  í˜ì‹ ì´ì§€ë§Œ, <strong>í•™ìŠµ ì†ë„</strong>, <strong>scaling í•œê³„</strong>, <strong>downstream ì„±ëŠ¥</strong>, <strong>MoE ìµœì í™” í•œê³„</strong> ë“± ì—¬ëŸ¬ <strong>ë¯¸í•´ê²° ë¬¸ì œì </strong>ë„ ì¡´ì¬í•©ë‹ˆë‹¤. ì•„ë˜ì—ëŠ” ì´ í•œê³„ë¥¼ ê·¹ë³µí•˜ê¸° ìœ„í•œ <strong>ì—°êµ¬ íë¦„ ë° ì£¼ìš” ì ‘ê·¼ ë°©ë²•</strong>ì„ ì²´ê³„ì ìœ¼ë¡œ ì •ë¦¬í•´ë“œë¦½ë‹ˆë‹¤.</p>
<hr>
<h2 id="-1-ë…¼ë¬¸ì—ì„œ-ì–¸ê¸‰í•œ-í•œê³„-ìš”ì•½">âœ… 1. ë…¼ë¬¸ì—ì„œ ì–¸ê¸‰í•œ í•œê³„ ìš”ì•½</h2>
<table>
  <thead>
      <tr>
          <th>í•œê³„ ìœ í˜•</th>
          <th>ìƒì„¸ ì„¤ëª…</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>âš¡ ì†ë„ ë¬¸ì œ</td>
          <td>í˜„ì¬ MoE kernel (Triton) ë¹„íš¨ìœ¨ â†’ Dense Transformerë³´ë‹¤ 1.7~2x ëŠë¦¼</td>
      </tr>
      <tr>
          <td>ğŸ“‰ ë‹¤ìš´ìŠ¤íŠ¸ë¦¼ ì„±ëŠ¥</td>
          <td>BLiMP, LAMBADA ë“±ì—ì„œ ì„±ëŠ¥ marginalí•¨ (zero-shotì—ì„œ í™•ì‹¤í•œ ìš°ìœ„ ì—†ìŒ)</td>
      </tr>
      <tr>
          <td>ğŸ§  MoE ë¶ˆì•ˆì •ì„±</td>
          <td>Ïƒ-MoEëŠ” soft routingìœ¼ë¡œ gradient noiseê°€ ìˆìŒ (í›ˆë ¨ ë¶ˆì•ˆì •)</td>
      </tr>
      <tr>
          <td>ğŸ—ï¸ ëŒ€ê·œëª¨ ìŠ¤ì¼€ì¼ë§ ë¶€ì¬</td>
          <td>1B ì´ìƒ scaleì—ì„œì˜ ì„±ëŠ¥ ë° íš¨ìœ¨ì„± ë¯¸ê²€ì¦</td>
      </tr>
      <tr>
          <td>ğŸ§© ACT ë¯¸í†µí•©</td>
          <td>Adaptive Computation Timeì€ ì œì™¸ë˜ì–´ ìˆìŒ (UTì˜ í•µì‹¬ íŠ¹ì„± ì¤‘ í•˜ë‚˜)</td>
      </tr>
  </tbody>
</table>
<hr>
<h2 id="-2-í•œê³„-ê·¹ë³µì„-ìœ„í•œ-ëŒ€í‘œ-ì—°êµ¬-íë¦„">ğŸ” 2. í•œê³„ ê·¹ë³µì„ ìœ„í•œ ëŒ€í‘œ ì—°êµ¬ íë¦„</h2>
<h3 id="-1-íš¨ìœ¨ì ì¸-moe-í•™ìŠµ--ì»¤ë„-ìµœì í™”">ğŸ§  [1] íš¨ìœ¨ì ì¸ MoE í•™ìŠµ &amp; ì»¤ë„ ìµœì í™”</h3>
<table>
  <thead>
      <tr>
          <th>ì—°êµ¬ íë¦„</th>
          <th>ë‚´ìš©</th>
          <th>ëŒ€í‘œ ì—°êµ¬</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>Flash-MoE / Triton ê°œì„ </strong></td>
          <td>Ïƒ-MoEë¥¼ CUDA kernel ìµœì í™”ë¡œ êµ¬í˜„ (ë¬¸ë§¥ ë³‘ë ¬í™”, routing ê°€ì†)</td>
          <td>GShard [Lepikhin et al.], DeepSpeed-MoE</td>
      </tr>
      <tr>
          <td><strong>Routing-aware load balancing</strong></td>
          <td>Expert routing ì‹œ token ë¶„ì‚°ì„ ê· í˜• ìˆê²Œ ìœ ì§€</td>
          <td>BASE Layer [Lewis et al.]</td>
      </tr>
      <tr>
          <td><strong>Soft-to-hard routing ì „í™˜</strong></td>
          <td>Ïƒ-MoE â†’ hard top-1 routing ë˜ëŠ” Gumbel-softmax ì‚¬ìš©</td>
          <td>Switch Transformer [Fedus et al.]</td>
      </tr>
  </tbody>
</table>
<p>âœ… <strong>MoEUT ì ìš© ê°€ëŠ¥ì„±</strong>: SwitchHeadì™€ Ïƒ-MoEì˜ kernelì´ ìµœì í™”ë˜ë©´ <strong>í•™ìŠµ ì†ë„ 1.5â€“2x ê°œì„  ê¸°ëŒ€</strong></p>
<hr>
<h3 id="-2-adaptive-computation-integration-ut-íŠ¹í™”">ğŸ§  [2] Adaptive Computation Integration (UT íŠ¹í™”)</h3>
<table>
  <thead>
      <tr>
          <th>ì—°êµ¬ íë¦„</th>
          <th>ë‚´ìš©</th>
          <th>ëŒ€í‘œ ì—°êµ¬</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>ACT with MoE</strong></td>
          <td>MoE ê¸°ë°˜ Layerì—ì„œ ACT ì‚¬ìš© (layer depth skip)</td>
          <td>SUT [Tan et al.]</td>
      </tr>
      <tr>
          <td><strong>Token-level depth control</strong></td>
          <td>ê° tokenë³„ë¡œ ë‹¤ë¥¸ layer depth â†’ tokenë³„ early exit</td>
          <td>UniversalTransformer [Dehghani et al.]</td>
      </tr>
  </tbody>
</table>
<p>âœ… <strong>MoEUT í™•ì¥ ê°€ëŠ¥ì„±</strong>: ACTë¥¼ ì¶”ê°€í•˜ë©´ <strong>layer recurrenceë¥¼ ë” íš¨ìœ¨ì ìœ¼ë¡œ ì œì–´ ê°€ëŠ¥</strong> â†’ ë” ê¸´ ì»¨í…ìŠ¤íŠ¸ ëª¨ë¸ë§ ê°€ëŠ¥ì„± â†‘</p>
<hr>
<h3 id="-3-expert-specialization-í–¥ìƒ-dynamic-routing-ê°œì„ ">ğŸ§  [3] Expert Specialization í–¥ìƒ (Dynamic Routing ê°œì„ )</h3>
<table>
  <thead>
      <tr>
          <th>ì—°êµ¬ íë¦„</th>
          <th>ë‚´ìš©</th>
          <th>ëŒ€í‘œ ì—°êµ¬</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>Fine-grained MoE with learned expert roles</strong></td>
          <td>Expertê°€ íŠ¹ì • ê¸°ëŠ¥ì— íŠ¹í™”ë˜ë„ë¡ ìœ ë„ (ex. syntax expert, entity expert)</td>
          <td>DeepSeekMoE [Dai et al.]</td>
      </tr>
      <tr>
          <td><strong>Token clustering ê¸°ë°˜ expert ì„ íƒ</strong></td>
          <td>token cluster (e.g., named entities)ë³„ expert ì§€ì •</td>
          <td>SLaM [2024]</td>
      </tr>
      <tr>
          <td><strong>Routing collapse ë°©ì§€</strong></td>
          <td>entropy regularization + balanced loss ê°œì„ </td>
          <td>V-MoE [Riquelme et al.]</td>
      </tr>
  </tbody>
</table>
<p>âœ… MoEUTì—ì„œ ì´ë¯¸ entropy regularization ì‚¬ìš© â†’ <strong>í† í° íŠ¹í™” routingì„ ë” ì •êµí•˜ê²Œ ì œì–´í•˜ë©´ ì„±ëŠ¥ ê°œì„  ì—¬ì§€ ìˆìŒ</strong></p>
<hr>
<h3 id="-4-downstream-task-fine-tuning-zero-shot-í•œê³„-ê·¹ë³µ">ğŸ§  [4] Downstream Task Fine-tuning (Zero-shot í•œê³„ ê·¹ë³µ)</h3>
<table>
  <thead>
      <tr>
          <th>ì—°êµ¬ íë¦„</th>
          <th>ë‚´ìš©</th>
          <th>ëŒ€í‘œ ì—°êµ¬</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>MoE adapter head</strong></td>
          <td>Pretrained MoE ë³¸ì²´ + ì‘ì€ task-specific adapterë§Œ fine-tune</td>
          <td>MoE-A [Gao et al.]</td>
      </tr>
      <tr>
          <td><strong>LayerDrop or LoRA on experts</strong></td>
          <td>ì¼ë¶€ expertë§Œ í™œì„±í™”í•˜ì—¬ ë¯¸ì„¸ ì¡°ì •</td>
          <td>SparseAdapt [ICLR 2024]</td>
      </tr>
      <tr>
          <td><strong>Expert freezing or reordering</strong></td>
          <td>Pretraining expert ê³ ì • + downstreamì—ì„œ ìƒˆë¡œìš´ expert ì¶”ê°€</td>
          <td>HydraMoE [ICLR 2024]</td>
      </tr>
  </tbody>
</table>
<p>âœ… MoEUTëŠ” <strong>zero-shot ìœ„ì£¼ í‰ê°€ë§Œ ì§„í–‰ë¨</strong> â†’ downstream ì „ì´ í•™ìŠµ ì„±ëŠ¥ ê°•í™” ì—°êµ¬ê°€ í•„ìš”</p>
<hr>
<h3 id="-5-massive-scale-universal-moe-1b-ìŠ¤ì¼€ì¼-í™•ì¥">ğŸ§  [5] Massive Scale Universal MoE (1B+ ìŠ¤ì¼€ì¼ í™•ì¥)</h3>
<table>
  <thead>
      <tr>
          <th>ì—°êµ¬ íë¦„</th>
          <th>ë‚´ìš©</th>
          <th>ëŒ€í‘œ ì—°êµ¬</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>UT ê¸°ë°˜ 10B+ MoE ì‹¤í—˜</strong></td>
          <td>í•™ìŠµ ì•ˆì •ì„±, routing saturation ë°©ì§€ ê¸°ë²• í•„ìš”</td>
          <td>Google PaLM-MoE, M6-T [Alibaba]</td>
      </tr>
      <tr>
          <td><strong>Expert shard-parallelism</strong></td>
          <td>ì „ë¬¸ê°€ë¥¼ cross-deviceë¡œ ë¶„ì‚°í•˜ì—¬ ë” ë§ì€ expert í™œìš©</td>
          <td>GShard [Google], DeepSpeed-MoE</td>
      </tr>
  </tbody>
</table>
<p>âœ… MoEUTëŠ” 1Bê¹Œì§€ ì‹¤í—˜ â†’ <strong>1B ì´ìƒì˜ sparse UT êµ¬ì¡° ì‹¤í—˜ì´ í•„ìš”</strong></p>
<hr>
<h2 id="-ë‚´-ì œì•ˆ-moeutì˜-í•œê³„-ê·¹ë³µì„-ìœ„í•œ-í†µí•©-ë°©í–¥">ğŸ§  ë‚´ ì œì•ˆ: MoEUTì˜ í•œê³„ ê·¹ë³µì„ ìœ„í•œ í†µí•© ë°©í–¥</h2>
<table>
  <thead>
      <tr>
          <th>ì œì•ˆ</th>
          <th>ì„¤ëª…</th>
          <th>ê¸°ëŒ€ íš¨ê³¼</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>âœ… <strong>ACT + Layer Grouping ê²°í•©</strong></td>
          <td>ê° ê·¸ë£¹ë³„ recurrence stepì„ ACTë¡œ ì œì–´</td>
          <td>ë” íš¨ìœ¨ì ì¸ ê³„ì¸µ ê¹Šì´ ì¡°ì •</td>
      </tr>
      <tr>
          <td>âœ… <strong>Routing-aware loss ê°œì„ </strong></td>
          <td>Ïƒ-MoEì˜ entropy loss + token diversity penalty ì¶”ê°€</td>
          <td>expert collapse ë°©ì§€</td>
      </tr>
      <tr>
          <td>âœ… <strong>Expert affinity í•™ìŠµ ì¶”ê°€</strong></td>
          <td>token â†” expert affinity matrix í•™ìŠµ</td>
          <td>í† í° íŠ¹í™” expert ì—­í•  ê³ ì •</td>
      </tr>
      <tr>
          <td>âœ… <strong>Pretraining í›„ LoRA fine-tuning</strong></td>
          <td>MoEUTì— low-rank adapterë§Œ ì¶”ê°€</td>
          <td>downstream ì ì‘ë ¥ ê°•í™”</td>
      </tr>
      <tr>
          <td>âœ… <strong>CUDA kernel ìµœì í™” (FlashMoE í†µí•©)</strong></td>
          <td>FlashAttention + MoE fusion</td>
          <td>training/inference ì†ë„ ëŒ€í­ í–¥ìƒ</td>
      </tr>
  </tbody>
</table>
<hr>
<h2 id="-ì •ë¦¬-1">âœ… ì •ë¦¬</h2>
<table>
  <thead>
      <tr>
          <th>ê·¹ë³µ ê³¼ì œ</th>
          <th>ëŒ€í‘œì  ì ‘ê·¼ íë¦„</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>í•™ìŠµ ì†ë„</td>
          <td>Triton kernel â†’ FlashMoE, Switch-style hard routing</td>
      </tr>
      <tr>
          <td>zero-shot í•œê³„</td>
          <td>Adapter ë°©ì‹ downstream fine-tuning</td>
      </tr>
      <tr>
          <td>Expert collapse</td>
          <td>entropy ì •ê·œí™” ê°œì„ , token cluster routing</td>
      </tr>
      <tr>
          <td>ACT ë¶€ì¬</td>
          <td>token-level depth control í†µí•©</td>
      </tr>
      <tr>
          <td>í™•ì¥ì„± ë¶€ì¡±</td>
          <td>10B+ scale UT+MoE ì‹¤í—˜, expert ë¶„ì‚° ë³‘ë ¬í™”</td>
      </tr>
  </tbody>
</table>

  <blockquote
    class="border-primary bg-muted/30 hover:bg-muted/40 my-6 rounded-r-lg border-l-4 py-4 pr-4 pl-6 italic transition-all duration-200 ease-out hover:translate-x-1">
    <div class="prose prose-sm max-w-none">
      <p>âœ… MoEUTëŠ” ê¸°ë°˜ì´ ë§¤ìš° í›Œë¥­í•œ êµ¬ì¡°ì´ë¯€ë¡œ, <strong>ì»¤ë„ ìµœì í™” + ë™ì  routing ì œì–´ + ACT í™•ì¥ + fine-tuning ì „ëµ í†µí•©</strong>ë§Œ ì˜ ì´ë£¨ì–´ì§€ë©´ ë‹¤ìŒ ì„¸ëŒ€ sparse UTë¡œ ì§„í™” ê°€ëŠ¥ì„±ì´ í½ë‹ˆë‹¤.</p>
    </div>
  </blockquote>

<p>í•„ìš”í•˜ì‹œë©´ ì´ëŸ¬í•œ ë°©í–¥ì„ ì ìš©í•œ í›„ì† ì—°êµ¬ ì•„ì´ë””ì–´ë¥¼ êµ¬ì²´ì  ì‹¤í—˜ ì„¤ê³„ë‚˜ ë…¼ë¬¸ í˜•íƒœë¡œ ì •ë¦¬í•´ë“œë¦´ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<p>ë¬¼ë¡ ì…ë‹ˆë‹¤! ì•„ë˜ëŠ” MoEUT ë…¼ë¬¸ì„ ë” ê¹Šì´ ìˆê²Œ ì´í•´í•˜ê¸° ìœ„í•œ <strong>í•µì‹¬ ì§ˆë¬¸ 3ê°€ì§€</strong>ì…ë‹ˆë‹¤. ë§ˆí¬ë‹¤ìš´ ë¬¸ë²• ì—†ì´, ë³µë¶™í•˜ê¸° ì‰¬ìš´ í˜•ì‹ìœ¼ë¡œ ì œê³µë“œë¦½ë‹ˆë‹¤.</p>
<h1 id="q--moeutëŠ”-ê¸°ì¡´-universal-transformerì˜-parameter-compute-ratio-ë¬¸ì œë¥¼-ì–´ë–»ê²Œ-í•´ê²°í•˜ë©°-Ïƒ-moeì™€-switchheadì˜-êµ¬ì¡°ì -ì°¨ë³„ì ì€-ë¬´ì—‡ì¸ê°€">Q : MoEUTëŠ” ê¸°ì¡´ Universal Transformerì˜ parameter-compute ratio ë¬¸ì œë¥¼ ì–´ë–»ê²Œ í•´ê²°í•˜ë©°, Ïƒ-MoEì™€ SwitchHeadì˜ êµ¬ì¡°ì  ì°¨ë³„ì ì€ ë¬´ì—‡ì¸ê°€?</h1>
<p>ì•„ì£¼ ì¢‹ì€ ì§ˆë¬¸ì…ë‹ˆë‹¤. ì•„ë˜ì— <strong>ì •í™•í•˜ê³  ìˆ˜ì¹˜ ê¸°ë°˜ìœ¼ë¡œ ê¹Šì´ ìˆê²Œ</strong> ì„¤ëª…ë“œë¦´ê²Œìš”.</p>
<hr>
<h2 id="-ì§ˆë¬¸-í•µì‹¬-ìš”ì•½">âœ… ì§ˆë¬¸ í•µì‹¬ ìš”ì•½</h2>
<p><strong>Q1. MoEUTëŠ” ê¸°ì¡´ Universal Transformerì˜ parameter-compute ratio ë¬¸ì œë¥¼ ì–´ë–»ê²Œ í•´ê²°í•˜ë©°, Ïƒ-MoEì™€ SwitchHeadì˜ êµ¬ì¡°ì  ì°¨ë³„ì ì€ ë¬´ì—‡ì¸ê°€?</strong></p>
<hr>
<h2 id="1-ê¸°ì¡´-universal-transformerì˜-í•œê³„-parametercompute-ratio">1. ê¸°ì¡´ Universal Transformerì˜ í•œê³„: parameterâ€“compute ratio</h2>
<p><strong>ë¬¸ì œ ìš”ì•½</strong>:<br>
UTëŠ” <strong>ë ˆì´ì–´ë¥¼ ë°˜ë³µì ìœ¼ë¡œ ê³µìœ </strong>í•¨ìœ¼ë¡œì¨ recurrenceë¥¼ ë„ì…í•˜ì§€ë§Œ, ê·¸ ê²°ê³¼:</p>
<ul>
<li>ì´ íŒŒë¼ë¯¸í„° ìˆ˜ê°€ ê°ì†Œí•¨ (ë ˆì´ì–´ê°€ ê³µìœ ë˜ë¯€ë¡œ)</li>
<li>ë™ì¼í•œ depthë¡œ í•™ìŠµí•´ë„ expressivenessê°€ ë¶€ì¡±í•´ì§</li>
<li>ì´ë¥¼ í•´ê²°í•˜ë ¤ë©´ ë ˆì´ì–´ë¥¼ <strong>Lë°° ë„“ê²Œ ë§Œë“¤ì–´ì•¼ í•¨ (dff, dmodel í™•ì¥)</strong><br>
â†’ ê·¸ëŸ¼ <strong>ì—°ì‚°ëŸ‰, ë©”ëª¨ë¦¬ cost ê¸‰ì¦</strong></li>
</ul>
<p><strong>ìˆ˜ì‹ ì˜ˆì‹œ</strong>:</p>
<ul>
<li>Dense Transformer: L layers Ã— dmodel = ì´ íŒŒë¼ë¯¸í„° ìˆ˜ O(LÃ—dÂ²)</li>
<li>UT: 1 layer ê³µìœ  â†’ O(dÂ²)</li>
<li>dë¥¼ âˆšL ë°° í‚¤ì›Œì•¼ ë™ì¼ expressiveness â†’ O(LÃ—dÂ²) ì—°ì‚°ëŸ‰ â†’ compute í„°ì§</li>
</ul>
<hr>
<h2 id="2-moeutì˜-í•´ê²°ì±…-sparse-expert-êµ¬ì¡°">2. MoEUTì˜ í•´ê²°ì±…: Sparse Expert êµ¬ì¡°</h2>
<h3 id="-í•µì‹¬-ì•„ì´ë””ì–´-íŒŒë¼ë¯¸í„°-ìˆ˜ëŠ”-ëŠ˜ë¦¬ë˜-ì—°ì‚°ëŸ‰ì€-ê·¸ëŒ€ë¡œ-ë˜ëŠ”-ì¤„ì¸ë‹¤">ğŸ”¹ í•µì‹¬ ì•„ì´ë””ì–´: &ldquo;íŒŒë¼ë¯¸í„° ìˆ˜ëŠ” ëŠ˜ë¦¬ë˜, ì—°ì‚°ëŸ‰ì€ ê·¸ëŒ€ë¡œ ë˜ëŠ” ì¤„ì¸ë‹¤&rdquo;</h3>
<ul>
<li>
<p><strong>Ïƒ-MoE (feedforward)</strong>:</p>
<ul>
<li>NEê°œì˜ expert ì¤‘ <strong>Top-Kë§Œ í™œì„±í™”</strong></li>
<li>ê° expertëŠ” small: <code>d_model Ã— d_expert (128) â†’ d_expert Ã— d_model</code></li>
<li>Soft routing (Ïƒ) ì‚¬ìš© â†’ sparseí•˜ê²Œë§Œ ì—°ì‚°</li>
</ul>
</li>
<li>
<p><strong>SwitchHead (self-attention)</strong>:</p>
<ul>
<li>ê° attention headì˜ value/output projectionì„ MoEë¡œ êµ¬ì„±</li>
<li>ì—­ì‹œ Top-K expertë§Œ ì‚¬ìš© â†’ sparse attention projection</li>
</ul>
</li>
</ul>

  <blockquote
    class="border-primary bg-muted/30 hover:bg-muted/40 my-6 rounded-r-lg border-l-4 py-4 pr-4 pl-6 italic transition-all duration-200 ease-out hover:translate-x-1">
    <div class="prose prose-sm max-w-none">
      <p>ê²°ê³¼ì ìœ¼ë¡œ:</p>
    </div>
  </blockquote>

<ul>
<li><strong>ë ˆì´ì–´ëŠ” ì—¬ì „íˆ ê³µìœ </strong> (UT êµ¬ì¡° ìœ ì§€)</li>
<li><strong>parameterëŠ” ë§ì•„ì§ (ë§ì€ expertë¡œ)</strong></li>
<li><strong>ì—°ì‚°ëŸ‰ì€ ì¼ë¶€ expertë§Œ ê³„ì‚°í•˜ë¯€ë¡œ ì¦ê°€í•˜ì§€ ì•ŠìŒ</strong></li>
</ul>
<hr>
<h2 id="3-Ïƒ-moe-vs-switchhead-êµ¬ì¡°-ë¹„êµ">3. Ïƒ-MoE vs SwitchHead: êµ¬ì¡° ë¹„êµ</h2>
<table>
  <thead>
      <tr>
          <th>ìš”ì†Œ</th>
          <th>Ïƒ-MoE (FFN)</th>
          <th>SwitchHead (Attention)</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>ì ìš© ìœ„ì¹˜</td>
          <td>FFN (ReLU í¬í•¨ëœ MLP block)</td>
          <td>Attention value/output projection</td>
      </tr>
      <tr>
          <td>Expert êµ¬ì„±</td>
          <td>small expertë“¤ (NE=100~500), d_expert=128</td>
          <td>ê° headë§ˆë‹¤ NAê°œì˜ expert</td>
      </tr>
      <tr>
          <td>Routing ë°©ì‹</td>
          <td>Ïƒ(x W_s) â†’ Top-K ì„ íƒ (soft routing)</td>
          <td>Ïƒ(x W_sv) â†’ Top-K per-head ì„ íƒ</td>
      </tr>
      <tr>
          <td>Regularization</td>
          <td>Entropy loss ì ìš© (sequence ë‹¨ìœ„)</td>
          <td>ë™ì¼í•œ entropy loss ì ìš© (value/output ê°ê°)</td>
      </tr>
      <tr>
          <td>í•™ìŠµ ì‹œ ë¶ˆì•ˆì •ì„±</td>
          <td>Ïƒ-MoEëŠ” gradient noise í¼ â†’ batch ë‚´ë¶€ regularization í•„ìš”</td>
          <td>ë” fine-grained (head-wise) routing â†’ ê³„ì‚°ëŸ‰ ì¦ê°€ ì†Œí­ ìˆìŒ</td>
      </tr>
  </tbody>
</table>
<p><strong>ê³µí†µì </strong>:</p>
<ul>
<li>ë‘˜ ë‹¤ <strong>fine-grained MoE</strong>, ì¦‰ expertì˜ í¬ê¸°ëŠ” ì‘ê³  ê°œìˆ˜ëŠ” ë§ìŒ</li>
<li>Top-Kë§Œ ì‚¬ìš©í•˜ë¯€ë¡œ <strong>ê³„ì‚°ëŸ‰ â‰ª parameter ìˆ˜</strong></li>
</ul>
<hr>
<h2 id="4-ì‹¤í—˜ì -ê·¼ê±°">4. ì‹¤í—˜ì  ê·¼ê±°</h2>
<table>
  <thead>
      <tr>
          <th>ëª¨ë¸</th>
          <th>Params</th>
          <th>MACs</th>
          <th>Perplexity (C4)</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>Dense</td>
          <td>244M</td>
          <td>ê¸°ì¤€ì </td>
          <td>13.40</td>
      </tr>
      <tr>
          <td>Ïƒ-MoE (non-shared)</td>
          <td>244M</td>
          <td>â†“</td>
          <td>13.70 (ì„±ëŠ¥ â†“)</td>
      </tr>
      <tr>
          <td><strong>MoEUT</strong></td>
          <td>243M</td>
          <td>â†“â†“</td>
          <td><strong>13.24</strong> âœ…</td>
      </tr>
  </tbody>
</table>
<p>â†’ ì¦‰, MoEUTëŠ” <strong>shared-layer êµ¬ì¡°ë¥¼ ìœ ì§€í•˜ë©´ì„œë„ Ïƒ-MoE + SwitchHead ë•ë¶„ì— compute íš¨ìœ¨ì„ í¬ê²Œ ì˜¬ë¦¬ê³ </strong>, ë™ì‹œì— <strong>parameter-rich ëª¨ë¸ì˜ expressive power</strong>ë„ íšŒë³µí•œ í˜•íƒœ</p>
<hr>
<h2 id="-ì •ë¦¬-2">âœ… ì •ë¦¬</h2>
<p>MoEUTëŠ” Universal Transformerì˜ í•µì‹¬ í•œê³„ì¸ <strong>parameter-compute ratio ë¬¸ì œ</strong>ë¥¼ **Ïƒ-MoE (FFN), SwitchHead (Attention)**ë¥¼ ë„ì…í•¨ìœ¼ë¡œì¨ í•´ê²°í–ˆë‹¤.<br>
ì´ë“¤ì€ ê°ê° <strong>ì—°ì‚°ëŸ‰ì„ ìœ ì§€í•œ ì±„ íŒŒë¼ë¯¸í„° ìˆ˜ë¥¼ ì¦ê°€</strong>ì‹œí‚¤ëŠ” êµ¬ì¡°ì´ë©°,<br>
shared-layer êµ¬ì¡°ì—ì„œë„ <strong>expressivenessì™€ efficiencyë¥¼ ë™ì‹œì— í™•ë³´</strong>í•˜ê²Œ í•´ì£¼ëŠ” í•µì‹¬ ì»´í¬ë„ŒíŠ¸ë‹¤.</p>
<p>í•„ìš”í•˜ì‹œë©´ Ïƒ-MoEì™€ SwitchHeadì˜ forward pathë¥¼ pseudocodeë¡œ êµ¬ì„±í•´ë“œë¦´ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<h1 id="q--layer-groupingê³¼-peri-layernormì€-ì™œ-shared-layer-êµ¬ì¡°ì—ì„œ-í•„ìˆ˜ì ì¸-ì„¤ê³„ë¡œ-ê°„ì£¼ë˜ë©°-ê°ê°ì´-ëª¨ë¸ì˜-í‘œí˜„ë ¥ê³¼-í•™ìŠµ-ì•ˆì •ì„±ì—-ë¯¸ì¹˜ëŠ”-êµ¬ì²´ì -ê¸°ì—¬ëŠ”-ë¬´ì—‡ì¸ê°€">Q : Layer Groupingê³¼ Peri-layernormì€ ì™œ shared-layer êµ¬ì¡°ì—ì„œ í•„ìˆ˜ì ì¸ ì„¤ê³„ë¡œ ê°„ì£¼ë˜ë©°, ê°ê°ì´ ëª¨ë¸ì˜ í‘œí˜„ë ¥ê³¼ í•™ìŠµ ì•ˆì •ì„±ì— ë¯¸ì¹˜ëŠ” êµ¬ì²´ì  ê¸°ì—¬ëŠ” ë¬´ì—‡ì¸ê°€?</h1>
<p>ì¢‹ìŠµë‹ˆë‹¤. ì´ ì§ˆë¬¸ì€ <strong>MoEUTì˜ ì„¤ê³„ì—ì„œ ê°€ì¥ ì¤‘ìš”í•œ êµ¬ì¡°ì  ê¸°ë²• ë‘ ê°€ì§€ì¸ <code>Layer Grouping</code>ê³¼ <code>Peri-layernorm</code>ì˜ ë„ì… ë°°ê²½ê³¼ ì‹¤íš¨ì„±</strong>ì„ ì´í•´í•˜ëŠ” í•µì‹¬ í¬ì¸íŠ¸ì…ë‹ˆë‹¤. ë…¼ë¬¸ì´ ì œì‹œí•œ ê·¼ê±° + ì‹¤ì œ ì‹¤í—˜ + ì´ë¡ ì  ì„¤ëª…ì„ í•¨ê»˜ ì—°ê²°í•´ì„œ ì •ë¦¬í•´ë“œë¦¬ê² ìŠµë‹ˆë‹¤.</p>
<hr>
<h2 id="-ì§ˆë¬¸-í•µì‹¬-ìš”ì•½-1">âœ… ì§ˆë¬¸ í•µì‹¬ ìš”ì•½</h2>
<p><strong>Q2. Layer Groupingê³¼ Peri-layernormì€ ì™œ shared-layer êµ¬ì¡°ì—ì„œ í•„ìˆ˜ì ì¸ ì„¤ê³„ë¡œ ê°„ì£¼ë˜ë©°, ê°ê°ì´ ëª¨ë¸ì˜ í‘œí˜„ë ¥ê³¼ í•™ìŠµ ì•ˆì •ì„±ì— ë¯¸ì¹˜ëŠ” êµ¬ì²´ì  ê¸°ì—¬ëŠ” ë¬´ì—‡ì¸ê°€?</strong></p>
<hr>
<h2 id="1-layer-grouping-í‘œí˜„ë ¥expressiveness-íšŒë³µì„-ìœ„í•œ-ì„¤ê³„">1. Layer Grouping: í‘œí˜„ë ¥(Expressiveness) íšŒë³µì„ ìœ„í•œ ì„¤ê³„</h2>
<h3 id="-ë¬¸ì œ-ì™„ì „í•œ-layer-sharingì€-í‘œí˜„ë ¥ì´-ì•½í•´ì§">â— ë¬¸ì œ: ì™„ì „í•œ Layer Sharingì€ í‘œí˜„ë ¥ì´ ì•½í•´ì§</h3>
<ul>
<li>UTëŠ” ë™ì¼í•œ ë ˆì´ì–´ë¥¼ ë°˜ë³µì ìœ¼ë¡œ ì ìš©í•¨ (f(f(f(&hellip;f(x)))) êµ¬ì¡°)</li>
<li>í•˜ì§€ë§Œ ë ˆì´ì–´ë§ˆë‹¤ **ì„œë¡œ ë‹¤ë¥¸ ì—°ì‚°(sub-operation)**ì„ í•˜ëŠ” ê²ƒì´ ì¼ë°˜ì ì¸ Transformerì˜ í•™ìŠµ ë°©ì‹</li>
<li>ë”°ë¼ì„œ <strong>ëª¨ë“  ë ˆì´ì–´ê°€ ë™ì¼í•œ íŒŒë¼ë¯¸í„°ë¥¼ ê³µìœ í•  ê²½ìš°</strong>, <strong>ì„œë¡œ ë‹¤ë¥¸ ì—°ì‚°ì„ ìª¼ê°œ ìˆ˜í–‰í•˜ê¸° ì–´ë ¤ì›€</strong> â†’ í‘œí˜„ë ¥ ì œí•œ</li>
</ul>
<hr>
<h3 id="-í•´ê²°ì±…-groupingëœ-ë ˆì´ì–´-ë¸”ë¡ì„-ë°˜ë³µ-a-b-a-b">âœ… í•´ê²°ì±…: Groupingëœ &ldquo;ë ˆì´ì–´ ë¸”ë¡&quot;ì„ ë°˜ë³µ (A-B-A-B&hellip;)</h3>
<ul>
<li>Gê°œì˜ non-shared ë ˆì´ì–´ë¥¼ í•˜ë‚˜ì˜ groupìœ¼ë¡œ êµ¬ì„± â†’ ê·¸ë£¹ ë‹¨ìœ„ë¡œ íŒŒë¼ë¯¸í„°ë¥¼ ê³µìœ </li>
<li>ì˜ˆ: G=2ì¼ ë•Œ [A, B]ë¥¼ ë°˜ë³µí•˜ì—¬ A-B-A-B-A-B êµ¬ì¡°ë¡œ ìˆ˜í–‰</li>
</ul>
<p><strong>ì‹¤í—˜ì  ê·¼ê±° (ë…¼ë¬¸ Fig. 6):</strong></p>
<table>
  <thead>
      <tr>
          <th>Group Size G</th>
          <th>Perplexity â†“</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>G = 1 (ì™„ì „ ê³µìœ )</td>
          <td>13.85</td>
      </tr>
      <tr>
          <td>G = 2 (MoEUT ê¸°ë³¸ê°’)</td>
          <td><strong>13.24</strong> âœ…</td>
      </tr>
      <tr>
          <td>G = 18 (non-shared Ïƒ-MoE)</td>
          <td>13.70</td>
      </tr>
  </tbody>
</table>
<ul>
<li>G=2ì¼ ë•Œ ì„±ëŠ¥ ìµœì </li>
<li>Group êµ¬ì¡°ê°€ induction head-style sub-operation ë¶„ë¦¬ì™€ alignedë¨</li>
</ul>
<hr>
<h3 id="-ìš”ì•½-layer-groupingì˜-ê¸°ì—¬">ğŸ’¡ ìš”ì•½: Layer Groupingì˜ ê¸°ì—¬</h3>
<ul>
<li><strong>í‘œí˜„ë ¥ ì¦ê°€</strong>: ì—°ì†ëœ ë ˆì´ì–´ì— ì„œë¡œ ë‹¤ë¥¸ ì—­í•  ë¶€ì—¬ ê°€ëŠ¥</li>
<li><strong>recurrence êµ¬ì¡°ì˜ expressive bottleneck í•´ì†Œ</strong></li>
<li><strong>MoEì™€ ê²°í•© ì‹œ expert specialization ìœ ë„</strong></li>
</ul>
<hr>
<h2 id="2-peri-layernorm-í•™ìŠµ-ì•ˆì •ì„±--gradient-flow-ê°œì„ ">2. Peri-layernorm: í•™ìŠµ ì•ˆì •ì„± + gradient flow ê°œì„ </h2>
<h3 id="-ë¬¸ì œ-standard-pre-layernormì€-shared-layer-êµ¬ì¡°ì—ì„œ-ë¬¸ì œ-ë°œìƒ">â— ë¬¸ì œ: Standard pre-layernormì€ shared-layer êµ¬ì¡°ì—ì„œ ë¬¸ì œ ë°œìƒ</h3>
<table>
  <thead>
      <tr>
          <th>êµ¬ì¡°</th>
          <th>ë¬¸ì œì </th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>Pre-LN</td>
          <td>residualì´ ê³„ì† ì»¤ì§€ë¯€ë¡œ shared-layerê°€ late depthì—ì„œ ì‘ë™í•˜ê¸° ì–´ë ¤ì›€</td>
      </tr>
      <tr>
          <td>Post-LN</td>
          <td>gradient flow ë¶ˆì•ˆì • (ì´ˆê¸° í•™ìŠµ ìˆ˜ë ´ ì†ë„ ëŠë¦¼)</td>
      </tr>
  </tbody>
</table>
<ul>
<li>Pre-LNì˜ ê²½ìš° residual vectorì˜ normì´ layer ê¹Šì´ì— ë”°ë¼ ì ì  ì»¤ì§<br>
â†’ shared-layerê°€ ê¹Šì€ ìœ„ì¹˜ì—ì„œë„ ë™ì¼í•œ ì¶œë ¥ì„ ë‚´ê¸° ìœ„í•´ì„  <strong>ì¶œë ¥ scalingì´ ì–´ë ¤ì›€</strong></li>
</ul>
<hr>
<h3 id="-í•´ê²°ì±…-peri-layernorm-ë¹„ì„ í˜•-ì—°ì‚°-ì•ì—ë§Œ-ln-ì‚½ì…">âœ… í•´ê²°ì±…: Peri-layernorm (ë¹„ì„ í˜• ì—°ì‚° ì•ì—ë§Œ LN ì‚½ì…)</h3>
<p><strong>êµ¬ì²´ì ìœ¼ë¡œ ì ìš© ìœ„ì¹˜:</strong></p>
<ul>
<li>Attention: Query/Key projection ì „ì—ë§Œ</li>
<li>FFN: Ïƒ-MoEì˜ gating score ê³„ì‚° ì „ì—ë§Œ</li>
<li>Main path (value projection, ReLU ì´í›„ ë“±)ì—ëŠ” <strong>layernorm ìƒëµ</strong></li>
</ul>
<p><strong>ê²°ê³¼:</strong></p>
<ul>
<li><strong>Residual normì´ ë¹„ì •ìƒì ìœ¼ë¡œ ì»¤ì§€ëŠ” í˜„ìƒ ë°©ì§€</strong></li>
<li><strong>Gradient flowëŠ” ìœ ì§€ë˜ë©°</strong> â†’ ê¹Šì€ networkì—ì„œë„ í•™ìŠµ ì•ˆì •í™”ë¨</li>
</ul>
<hr>
<h3 id="ì‹¤í—˜ì -ê·¼ê±°-ë…¼ë¬¸-fig-8">ì‹¤í—˜ì  ê·¼ê±° (ë…¼ë¬¸ Fig. 8)</h3>
<table>
  <thead>
      <tr>
          <th>Norm Scheme</th>
          <th>Perplexity â†“ (C4, 244M)</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>Post-LN</td>
          <td>13.36</td>
      </tr>
      <tr>
          <td>Pre-LN</td>
          <td>13.59</td>
      </tr>
      <tr>
          <td><strong>Peri-LN</strong></td>
          <td><strong>13.24</strong> âœ…</td>
      </tr>
  </tbody>
</table>
<ul>
<li>ì‘ì€ ëª¨ë¸ì¼ìˆ˜ë¡ gapì´ í¬ê²Œ ë‚˜íƒ€ë‚¨</li>
<li>í•™ìŠµ ì´ˆê¸°ì— ë” ë¹ ë¥¸ ìˆ˜ë ´ê³¼ ì•ˆì •ì„± ì œê³µ</li>
</ul>
<hr>
<h3 id="-ìš”ì•½-peri-layernormì˜-ê¸°ì—¬">ğŸ’¡ ìš”ì•½: Peri-layernormì˜ ê¸°ì—¬</h3>
<ul>
<li><strong>í•™ìŠµ ì•ˆì •ì„± í–¥ìƒ</strong>: residual explosion ë°©ì§€</li>
<li><strong>shared-layer ì¬ì‚¬ìš© ê°€ëŠ¥ì„± ì¦ê°€</strong>: depthì— ê´€ê³„ì—†ì´ ë™ì¼ íšŒë¡œ ì‚¬ìš©</li>
<li><strong>gradient flow í™•ë³´</strong> + <strong>MoE gating ì—°ì‚° ì •ê·œí™”</strong> ë³‘í–‰</li>
</ul>
<hr>
<h2 id="-ì „ì²´-ìš”ì•½-ì •ë¦¬">âœ… ì „ì²´ ìš”ì•½ ì •ë¦¬</h2>
<table>
  <thead>
      <tr>
          <th>ìš”ì†Œ</th>
          <th>ì™œ í•„ìš”í•œê°€?</th>
          <th>ë¬´ì—‡ì— ê¸°ì—¬í•˜ëŠ”ê°€?</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>Layer Grouping</td>
          <td>ì™„ì „ ê³µìœ  ì‹œ í‘œí˜„ë ¥ ë¶€ì¡±</td>
          <td>sub-operation ë¶„ë¦¬ë¡œ í‘œí˜„ë ¥ ì¦ê°€</td>
      </tr>
      <tr>
          <td>Peri-layernorm</td>
          <td>pre-LN: residual í­ì£¼, post-LN: gradient flow ì•…í™”</td>
          <td>ì•ˆì •ì  í•™ìŠµ + residual scaling ì™„í™”</td>
      </tr>
  </tbody>
</table>
<p>ë‘˜ì€ <strong>shared-layer ê¸°ë°˜ Universal Transformerì—ì„œ expressive powerì™€ optimization ì•ˆì •ì„±ì„ ë³´ì™„í•˜ê¸° ìœ„í•´ ë°˜ë“œì‹œ í•„ìš”í•œ ì„¤ê³„</strong>ì´ë©°, ì‹¤í—˜ì ìœ¼ë¡œë„ <strong>ì—†ìœ¼ë©´ ì„±ëŠ¥ í•˜ë½</strong>ì´ ëª…í™•íˆ ë‚˜íƒ€ë‚¬ìŠµë‹ˆë‹¤.</p>
<p>í•„ìš”í•˜ì‹œë©´ ì´ë¥¼ êµ¬í˜„í•˜ëŠ” PyTorch Module íŒ¨í„´ì´ë‚˜ ì‹¤ì œ ablation ì‹¤í—˜ êµ¬ì„± ë°©ì‹ë„ ì •ë¦¬í•´ë“œë¦´ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<h1 id="q--ë™ì¼í•œ-íŒŒë¼ë¯¸í„°-ìˆ˜-ë˜ëŠ”-compute-budget-ì¡°ê±´ì—ì„œ-moeutê°€-dense-transformer-ëŒ€ë¹„-ë”-ë‚˜ì€-perplexityë¥¼-ë‹¬ì„±í•œ-ê·¼ë³¸ì ì¸-ì´ìœ ëŠ”-ë¬´ì—‡ì´ë©°-ì´-ì„±ëŠ¥-ê²©ì°¨ê°€-íŠ¹ì •-êµ¬ì„±-ìš”ì†Œmoe-routing-recurrence-normalization-ë“±-ì¤‘-ì–´ë””ì—ì„œ-ê¸°ì¸í•˜ëŠ”ê°€">Q : ë™ì¼í•œ íŒŒë¼ë¯¸í„° ìˆ˜ ë˜ëŠ” compute budget ì¡°ê±´ì—ì„œ MoEUTê°€ dense Transformer ëŒ€ë¹„ ë” ë‚˜ì€ perplexityë¥¼ ë‹¬ì„±í•œ ê·¼ë³¸ì ì¸ ì´ìœ ëŠ” ë¬´ì—‡ì´ë©°, ì´ ì„±ëŠ¥ ê²©ì°¨ê°€ íŠ¹ì • êµ¬ì„± ìš”ì†Œ(MoE routing, recurrence, normalization ë“±) ì¤‘ ì–´ë””ì—ì„œ ê¸°ì¸í•˜ëŠ”ê°€?</h1>
<p>ì•„ì£¼ í•µì‹¬ì ì¸ ì§ˆë¬¸ì…ë‹ˆë‹¤. ì´ ì§ˆë¬¸ì€ MoEUTê°€ ë‹¨ìˆœíˆ êµ¬ì¡°ë¥¼ ë³µì¡í•˜ê²Œ ë§Œë“  ê²ƒì´ ì•„ë‹ˆë¼, <strong>ì™œ ì‹¤ì œ ì„±ëŠ¥ì´ í–¥ìƒë˜ëŠ”ê°€</strong>, ì¦‰ <strong>ì„±ëŠ¥ ê²©ì°¨ì˜ ë³¸ì§ˆì  ì›ì¸</strong>ì„ íŒŒì•…í•˜ëŠ” ë° ì¤‘ìš”í•©ë‹ˆë‹¤. ì•„ë˜ì— ë…¼ë¬¸ì—ì„œ ì œì‹œí•œ ì£¼ì¥ + ì‹¤í—˜ì  ì¦ê±° + ì œ ë¶„ì„ì„ í•¨ê»˜ ì¢…í•©í•´ ì„¤ëª…ë“œë¦½ë‹ˆë‹¤.</p>
<hr>
<h2 id="-ì§ˆë¬¸-í•µì‹¬-ìš”ì•½-2">âœ… ì§ˆë¬¸ í•µì‹¬ ìš”ì•½</h2>
<p><strong>Q3. ë™ì¼í•œ íŒŒë¼ë¯¸í„° ìˆ˜ ë˜ëŠ” compute budget ì¡°ê±´ì—ì„œ MoEUTê°€ dense Transformer ëŒ€ë¹„ ë” ë‚˜ì€ perplexityë¥¼ ë‹¬ì„±í•œ ê·¼ë³¸ì ì¸ ì´ìœ ëŠ” ë¬´ì—‡ì´ë©°, ì´ ì„±ëŠ¥ ê²©ì°¨ê°€ íŠ¹ì • êµ¬ì„± ìš”ì†Œ(MoE routing, recurrence, normalization ë“±) ì¤‘ ì–´ë””ì—ì„œ ê¸°ì¸í•˜ëŠ”ê°€?</strong></p>
<hr>
<h2 id="1-ì‹¤í—˜-ê²°ê³¼-ìš”ì•½-ê°™ì€-íŒŒë¼ë¯¸í„°ì—°ì‚°ëŸ‰-ê¸°ì¤€-ë¹„êµ">1. ì‹¤í—˜ ê²°ê³¼ ìš”ì•½: ê°™ì€ íŒŒë¼ë¯¸í„°/ì—°ì‚°ëŸ‰ ê¸°ì¤€ ë¹„êµ</h2>
<h3 id="-ì˜ˆ-c4-ì–¸ì–´-ëª¨ë¸ë§-perplexity-ë¹„êµ">ğŸ“Œ ì˜ˆ: C4 ì–¸ì–´ ëª¨ë¸ë§ Perplexity ë¹„êµ</h3>
<table>
  <thead>
      <tr>
          <th>ëª¨ë¸</th>
          <th>Params</th>
          <th>Perplexity â†“</th>
          <th>MACs</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>Dense Transformer</td>
          <td>244M</td>
          <td>13.40</td>
          <td>ê¸°ì¤€ì¹˜</td>
      </tr>
      <tr>
          <td>Ïƒ-MoE (non-shared)</td>
          <td>244M</td>
          <td>13.70</td>
          <td>â†“</td>
      </tr>
      <tr>
          <td><strong>MoEUT (shared)</strong></td>
          <td>243M</td>
          <td><strong>13.24</strong> âœ…</td>
          <td>â†“â†“</td>
      </tr>
  </tbody>
</table>
<p>â†’ ê°™ì€ íŒŒë¼ë¯¸í„° ìˆ˜ ë˜ëŠ” compute(MACs) ê¸°ì¤€ì—ì„œ MoEUTê°€ í•­ìƒ ë” ë‚®ì€ perplexity<br>
â†’ **Ïƒ-MoE(ë¹„ê³µìœ  êµ¬ì¡°)**ë³´ë‹¤ë„ MoEUT(ë ˆì´ì–´ ê³µìœ  êµ¬ì¡°)ê°€ ë” ì¢‹ìŒ â†’ í•µì‹¬ì  í¬ì¸íŠ¸</p>
<hr>
<h2 id="2-ê·¼ë³¸-ì›ì¸-ìš”ì•½-sparse-routing--recurrenceì˜-ê²°í•©-ì‹œë„ˆì§€">2. ê·¼ë³¸ ì›ì¸ ìš”ì•½: &ldquo;Sparse Routing + Recurrenceì˜ ê²°í•© ì‹œë„ˆì§€&rdquo;</h2>
<p><strong>Dense Transformer</strong>ëŠ” ëª¨ë“  ë ˆì´ì–´ì— ë™ì¼í•œ íŒŒë¼ë¯¸í„°ë¥¼ ëª¨ë‘ ì‚¬ìš©í•˜ë©°, íš¨ìœ¨ì„±ê³¼ ìœ ì—°ì„± ê°„ trade-off ì¡´ì¬</p>
<p><strong>MoEUT</strong>ëŠ” ë‹¤ìŒ ë‘ ê°€ì§€ ì¶•ì„ <strong>ë™ì‹œì— í™œìš©</strong>:</p>
<h3 id="-a-moe-routingìœ¼ë¡œ-parameter-efficiency-í™•ë³´-ëª¨ë¸ì˜-capacity-ì¦ê°€">ğŸ§  A. MoE routingìœ¼ë¡œ parameter efficiency í™•ë³´ (ëª¨ë¸ì˜ capacity ì¦ê°€)</h3>
<ul>
<li>Ïƒ-MoE, SwitchHead â†’ Top-K expertë§Œ ì‚¬ìš©</li>
<li>ê°™ì€ ì—°ì‚°ëŸ‰ ëŒ€ë¹„ í›¨ì”¬ ë§ì€ íŒŒë¼ë¯¸í„° ì‚¬ìš© ê°€ëŠ¥</li>
<li>â†’ <strong>Parameter efficiency â†‘</strong></li>
<li>â†’ íŠ¹ì • tokenì— <strong>ì „ë¬¸í™”ëœ íšŒë¡œ(expert) ì‚¬ìš© ê°€ëŠ¥</strong> (e.g., ë¬¸ë²•, ì—”í‹°í‹° ë“±)</li>
</ul>
<p><strong>ì‹¤í—˜ ì¦ê±°</strong>:</p>
<ul>
<li>Fig. 13, 14: ì „ë¬¸ê°€ ìˆ˜ê°€ ëŠ˜ì–´ë‚˜ê³  Top-Kê°€ ì»¤ì§ˆìˆ˜ë¡ perplexity ê°ì†Œ</li>
<li>Fig. 9â€“10: tokenë§ˆë‹¤ expert specialization ìƒê¹€ â†’ diversity í–¥ìƒ</li>
</ul>
<hr>
<h3 id="-b-recurrence-shared-layerë¡œ-inductive-bias-ë„ì…">ğŸ” B. Recurrence (shared-layer)ë¡œ inductive bias ë„ì…</h3>
<ul>
<li>UTì˜ í•µì‹¬ ì¥ì : f(f(f(&hellip;))) êµ¬ì¡° â†’ <strong>compositional ì—°ì‚° í‘œí˜„ë ¥ ì¦ê°€</strong></li>
<li>ë ˆì´ì–´ ê³µìœ ë¥¼ í†µí•´ <strong>ì¼ê´€ëœ íšŒë¡œ ë°˜ë³µ ì ìš©</strong> â†’ êµ¬ì¡°ì  ì¼ë°˜í™”</li>
</ul>
<p><strong>ì‹¤í—˜ ì¦ê±°</strong>:</p>
<ul>
<li>Fig. 6: G=1 (ì™„ì „ ê³µìœ ) vs G=18 (non-shared)ë³´ë‹¤ G=2 (recurrent group)ì—ì„œ ì„±ëŠ¥ ìµœìƒ</li>
<li>â†’ <strong>ì •í•´ì§„ íšŒë¡œ ë°˜ë³µ êµ¬ì¡°</strong>ê°€ ë³µì¡í•œ ì¶”ë¡ ì— ìœ ë¦¬</li>
</ul>
<hr>
<h2 id="3-ì„±ëŠ¥-í–¥ìƒì˜-ì£¼ìš”-ê¸°ì—¬-ìš”ì†Œ-ë¶„í•´">3. ì„±ëŠ¥ í–¥ìƒì˜ ì£¼ìš” ê¸°ì—¬ ìš”ì†Œ ë¶„í•´</h2>
<h3 id="-ablation-ê¸°ë°˜-ì˜í–¥ë„-ë¶„ì„-ì •ì„±ì -ìˆœìœ„">ğŸ“Š Ablation ê¸°ë°˜ ì˜í–¥ë„ ë¶„ì„ (ì •ì„±ì  ìˆœìœ„)</h3>
<table>
  <thead>
      <tr>
          <th>êµ¬ì„± ìš”ì†Œ</th>
          <th>ê¸°ì—¬ë„</th>
          <th>ê·¼ê±°</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>âœ… Ïƒ-MoE Feedforward</td>
          <td>â˜…â˜…â˜…â˜…â˜…</td>
          <td>ê°€ì¥ í° perplexity ê°ì†Œ ìš”ì¸ (fine-grained MoE)</td>
      </tr>
      <tr>
          <td>âœ… Layer Grouping (Recurrence)</td>
          <td>â˜…â˜…â˜…â˜…â˜†</td>
          <td>G=2ì—ì„œ best performance (Fig. 6)</td>
      </tr>
      <tr>
          <td>âœ… SwitchHead Attention</td>
          <td>â˜…â˜…â˜…â˜†â˜†</td>
          <td>attention head-wise routing â†’ sparse + expressive attention</td>
      </tr>
      <tr>
          <td>âœ… Peri-layernorm</td>
          <td>â˜…â˜…â˜†â˜†â˜†</td>
          <td>residual í­ì£¼ ë°©ì§€ + gradient flow ê°œì„ </td>
      </tr>
      <tr>
          <td>âŒ ACT</td>
          <td>ì—†ìŒ</td>
          <td>MoEUTì—ì„œëŠ” ë¯¸ì‚¬ìš© (SUT ë¹„êµì—ì„œ íš¨ìœ¨ ë‚®ìŒ)</td>
      </tr>
  </tbody>
</table>
<hr>
<h2 id="4-ë‚´-ë¶„ì„-ì™œ-ì‹œë„ˆì§€-íš¨ê³¼ê°€-í°ê°€">4. ë‚´ ë¶„ì„: ì™œ ì‹œë„ˆì§€ íš¨ê³¼ê°€ í°ê°€?</h2>
<table>
  <thead>
      <tr>
          <th>Dense Transformer</th>
          <th>MoEUT</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>ë™ì¼ íŒŒë¼ë¯¸í„° ëª¨ë‘ ì‚¬ìš© â†’ í‘œí˜„ë ¥ì€ ìˆì§€ë§Œ generalization ì–´ë ¤ì›€</td>
          <td>expert ì„ íƒ + recurrence â†’ <strong>ì „ë¬¸í™” + ë°˜ë³µì  ì‚¬ê³  êµ¬ì¡°</strong></td>
      </tr>
      <tr>
          <td>layer ê°œë³„ í•™ìŠµ â†’ ì¼ê´€ì„± ë¶€ì¡±</td>
          <td>íŒŒë¼ë¯¸í„° ê³µìœ  â†’ ì˜ë¯¸ ìˆëŠ” ë°˜ë³µ êµ¬ì¡° í•™ìŠµ ê°€ëŠ¥</td>
      </tr>
      <tr>
          <td>LayerNormì„ residual pathì— ëª¨ë‘ ì ìš© â†’ norm scaling í•„ìš”</td>
          <td>peri-norm êµ¬ì¡° â†’ residual ì„±ì¥ ì•ˆì •í™”</td>
      </tr>
  </tbody>
</table>
<p><strong>ì¦‰, MoEUTëŠ”</strong></p>
<ul>
<li>tokenë³„ë¡œ expertë¥¼ ë‹¤ë¥´ê²Œ ì‚¬ìš©í•´ <strong>token-level íŠ¹í™”</strong>ë¥¼ ì§€ì›í•˜ê³ ,</li>
<li>recurrenceë¡œ <strong>depth-wise structure</strong>ë¥¼ í•™ìŠµí•˜ë©°,</li>
<li>normalizationìœ¼ë¡œ <strong>gradient ì•ˆì •í™”</strong>ê¹Œì§€ ë™ì‹œì— ì‹¤í˜„í•œë‹¤ëŠ” ì ì—ì„œ<br>
<strong>Dense Transformerë³´ë‹¤ ë³¸ì§ˆì ìœ¼ë¡œ ë” ìœ ì—°í•˜ë©´ì„œë„ ì•ˆì •ì ì¸ êµ¬ì¡°</strong>ë¼ê³  ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li>
</ul>
<hr>
<h2 id="-ê²°ë¡ -ìš”ì•½-1">âœ… ê²°ë¡  ìš”ì•½</h2>
<p>MoEUTê°€ Dense Transformer ëŒ€ë¹„ ë™ì¼ íŒŒë¼ë¯¸í„°/compute ì¡°ê±´ì—ì„œ ë” ë‚˜ì€ ì„±ëŠ¥(perplexity)ì„ ë³´ì´ëŠ” ì´ìœ ëŠ”,</p>
<ul>
<li>Ïƒ-MoE ë° SwitchHeadë¥¼ í†µí•œ <strong>sparse expert routing</strong>ìœ¼ë¡œ <strong>parameter íš¨ìœ¨ì„± ê·¹ëŒ€í™”</strong>,</li>
<li>Layer Grouping ê¸°ë°˜ <strong>recurrence êµ¬ì¡°</strong>ë¡œ <strong>compositional expressiveness í™•ë³´</strong>,</li>
<li>Peri-layernormìœ¼ë¡œ <strong>í•™ìŠµ ì•ˆì •ì„±ê³¼ gradient flow ë³´ì¥</strong>ì´ë¼ëŠ” 3ì¶• ì „ëµì´ ê²°í•©ë˜ì—ˆê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.</li>
</ul>
<p>ì´ëŸ¬í•œ êµ¬ì¡°ì  ì¡°í•©ì€ ë‹¨ì¼ êµ¬ì„±ìš”ì†Œë³´ë‹¤ í›¨ì”¬ ê°•ë ¥í•œ <strong>ìƒí˜¸ë³´ì™„ì  íš¨ê³¼</strong>ë¥¼ ë§Œë“¤ì–´ë‚¸ë‹¤ê³  íŒë‹¨ë©ë‹ˆë‹¤.</p>

  </article>

  
  
  <div class="post-license bg-muted/30 border-border mb-8 rounded-xl border p-6">
    <div class="flex items-start gap-4">
      <div
        class="bg-primary/10 flex h-12 w-12 flex-shrink-0 items-center justify-center rounded-lg">
        
  <svg class="h-6 w-6"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="ë¼ì´ì„ ìŠ¤"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z" />
</svg>
      </div>

      <div class="flex-1">
        <h3 class="text-foreground mb-2 text-lg font-semibold">
          ë¼ì´ì„ ìŠ¤
        </h3>

        <div class="text-muted-foreground space-y-2 text-sm">
          
          <p>
            <strong>ì €ì‘ì:</strong>
            ë¥˜ì¬í›ˆ
          </p>
          

          <p>
            <strong>ë§í¬:</strong>
            <a
              href="http://192.168.1.11:1314/posts/MoEUT-Mixture-of-Experts-Universal-Transformers/"
              class="text-primary hover:text-primary/80 transition-colors duration-200">
              http://192.168.1.11:1314/posts/MoEUT-Mixture-of-Experts-Universal-Transformers/
            </a>
          </p>

          <p>
            <strong>ë¼ì´ì„ ìŠ¤:</strong>
            <a
              href="https://creativecommons.org/licenses/by-nc-sa/4.0/"
              target="_blank"
              rel="noopener noreferrer"
              class="text-primary hover:text-primary/80 transition-colors duration-200">
              CC BY-NC-SA 4.0
            </a>
          </p>

          <p class="text-xs">
            ì´ ì €ì‘ë¬¼ì€ í¬ë¦¬ì—ì´í‹°ë¸Œ ì»¤ë¨¼ì¦ˆ ì €ì‘ìí‘œì‹œ-ë¹„ì˜ë¦¬-ë™ì¼ì¡°ê±´ë³€ê²½í—ˆë½ 4.0 êµ­ì œ ë¼ì´ì„ ìŠ¤ì— ë”°ë¼ ì´ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì¶œì²˜ë¥¼ í‘œì‹œí•˜ê³ , ë¹„ì˜ë¦¬ ëª©ì ìœ¼ë¡œë§Œ ì‚¬ìš©í•˜ë©°, ë™ì¼í•œ ë¼ì´ì„ ìŠ¤ë¥¼ ìœ ì§€í•´ì•¼ í•©ë‹ˆë‹¤.
          </p>
        </div>
      </div>
    </div>
  </div>


  
  





  <nav
    class="post-navigation mb-12"
    aria-label="ê²Œì‹œê¸€ ë„¤ë¹„ê²Œì´ì…˜">
    <div class="grid grid-cols-1 gap-4 md:grid-cols-2">
      
      <div class="nav-item">
        
          <a
            href="/posts/FLEX-ATTENTION-A-PROGRAMMING-MODEL-FOR-GENERATING-OPTIMIZED-ATTENTION-KERNELS/"
            class="group bg-card border-border hover:bg-primary/5 hover:border-primary/20 focus:ring-primary/20 flex min-h-[140px] flex-col justify-between rounded-xl border p-6 transition-all duration-300 ease-out hover:-translate-y-1 hover:scale-[1.02] hover:shadow-lg focus:ring-2 focus:outline-none">
            <div>
              <div class="mb-3 flex items-center gap-3">
                
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
</svg>
                <span class="text-muted-foreground text-sm font-medium">
                  ì´ì „
                </span>
              </div>

              <h3
                class="text-foreground group-hover:text-primary mb-3 line-clamp-2 text-lg leading-tight font-semibold transition-colors duration-200">
                FLEX ATTENTION: A PROGRAMMING MODEL FOR GENERATING OPTIMIZED ATTENTION KERNELS
              </h3>
            </div>

            <div
              class="text-muted-foreground mt-auto flex items-center gap-2 text-xs">
              
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
</svg>
              <time datetime="2025-04-07">
                04æœˆ07æ—¥
              </time>
            </div>
          </a>
        
      </div>

      
      <div class="nav-item">
        
          <a
            href="/posts/Mirage-A-Multi-Level-Superoptimizer-for-Tensor-Programs/"
            class="group bg-card border-border hover:bg-primary/5 hover:border-primary/20 focus:ring-primary/20 flex min-h-[140px] flex-col justify-between rounded-xl border p-6 transition-all duration-300 ease-out hover:-translate-y-1 hover:scale-[1.02] hover:shadow-lg focus:ring-2 focus:outline-none">
            <div>
              <div class="mb-3 flex items-center justify-end gap-3">
                <span class="text-muted-foreground text-sm font-medium">
                  ë‹¤ìŒ
                </span>
                
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
</svg>
              </div>

              <h3
                class="text-foreground group-hover:text-primary mb-3 line-clamp-2 text-right text-lg leading-tight font-semibold transition-colors duration-200">
                Mirage: A Multi-Level Superoptimizer for Tensor Programs
              </h3>
            </div>

            <div
              class="text-muted-foreground mt-auto flex items-center justify-end gap-2 text-xs">
              <time datetime="2025-04-13">
                04æœˆ13æ—¥
              </time>
              
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
</svg>
            </div>
          </a>
        
      </div>
    </div>
  </nav>




  
  










  
  


    </main>

    <footer class="mx-auto max-w-4xl px-4 py-8">
  <div class="px-6 py-6">
    
    
      <nav class="mb-6">
        <div class="flex flex-wrap items-center justify-center gap-1">
          
            
            
            
            <a
              href="/index.xml"
              
              class="nav-link hover:text-primary hover:bg-primary/10 text-muted-foreground flex items-center gap-2 rounded-lg px-4 py-2 text-sm font-medium transition-all duration-300 hover:scale-105">
              
                
  <svg class="h-5 w-5"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="RSS Feed">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 5c7.18 0 13 5.82 13 13M6 11a7 7 0 017 7m-6 0a1 1 0 11-2 0 1 1 0 012 0z" />

</svg>
              
              <span
                >
                  RSS Feed
                </span
              >
            </a>
          
        </div>
      </nav>
    


    
    
      <div class="border-border mb-6 border-t"></div>
    


    
    <div class="flex flex-col items-center justify-between gap-4 md:flex-row">
      
      <div class="text-muted-foreground text-sm">
        <p>
          &copy; 2025 Jaehun&#39;s Blog.
          ëª¨ë“  ê¶Œë¦¬ ë³´ìœ .
        </p>
      </div>

      
      
        <div class="flex items-center gap-3">
          
            <a
              href="https://github.com/ryujaehun"
              
                target="_blank" rel="noopener noreferrer"
              
              class="text-muted-foreground hover:text-primary focus:ring-primary/20 rounded-lg p-1 transition-all duration-300 ease-out hover:scale-110 focus:ring-2 focus:outline-none"
              title="GitHub"
              aria-label="GitHub">
              
                
  <svg class="h-6 w-6"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="GitHub"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"><path d="M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5c.08-1.25-.27-2.48-1-3.5c.28-1.15.28-2.35 0-3.5c0 0-1 0-3 1.5c-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.4 5.4 0 0 0 4 9c0 3.5 3 5.5 6 5.5c-.39.49-.68 1.05-.85 1.65S8.93 17.38 9 18v4"/><path d="M9 18c-4.51 2-5-2-7-2"/></g></svg>
              
            </a>
          
            <a
              href="https://www.linkedin.com/in/jaehunryu/"
              
                target="_blank" rel="noopener noreferrer"
              
              class="text-muted-foreground hover:text-primary focus:ring-primary/20 rounded-lg p-1 transition-all duration-300 ease-out hover:scale-110 focus:ring-2 focus:outline-none"
              title="Linkedin"
              aria-label="Linkedin">
              
                
  <svg class="h-6 w-6"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="Linkedin"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"><path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2a2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6M2 9h4v12H2z"/><circle cx="4" cy="4" r="2"/></g></svg>
              
            </a>
          
            <a
              href="mailto:jaehunryu@icloud.com"
              
              class="text-muted-foreground hover:text-primary focus:ring-primary/20 rounded-lg p-1 transition-all duration-300 ease-out hover:scale-110 focus:ring-2 focus:outline-none"
              title="Email"
              aria-label="Email">
              
                
  <svg class="h-6 w-6"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="Email">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />

</svg>
              
            </a>
          
        </div>
      

    </div>
  </div>
</footer>


    
    



<div
  id="dock"
  class="pointer-events-none fixed bottom-4 left-1/2 z-[9999] w-fit -translate-x-1/2 translate-y-24 opacity-0 transition-all duration-300 ease-out sm:right-0 sm:left-0 sm:mx-auto sm:translate-x-0"
  role="toolbar"
  aria-label="ë°”ë¡œê°€ê¸° ë„êµ¬ ëª¨ìŒ">
  <nav
    class="border-border bg-card/80 scrollbar-hide xs:px-3 xs:py-2 mx-auto flex max-w-[calc(100vw-2rem)] min-w-fit items-center justify-center overflow-x-auto rounded-2xl border px-4 py-3 shadow-lg backdrop-blur-sm sm:px-4 sm:py-3">
    
    
      <button
        id="dock-back"
        class="text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 xs:px-2 xs:py-1.5 flex flex-shrink-0 items-center gap-2 rounded-lg px-3 py-2 text-sm font-medium transition-all duration-300 ease-out hover:-translate-y-0.5 hover:scale-105 focus:ring-2 focus:outline-none sm:px-3 sm:py-2"
        title="ë’¤ë¡œ"
        aria-label="ë’¤ë¡œ">
        
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24">
  <path d="m12 19-7-7 7-7"/>
  <path d="M19 12H5"/>

</svg>
        <span class="hidden sm:inline"
          >ë’¤ë¡œ</span
        >
      </button>

      
      <div class="bg-border xs:mx-1 mx-2 h-6 w-px sm:mx-2"></div>
    


    
    
      <button
        id="dock-toc"
        class="text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 xs:px-2 xs:py-1.5 flex flex-shrink-0 items-center gap-2 rounded-lg px-3 py-2 text-sm font-medium transition-all duration-300 ease-out hover:-translate-y-0.5 hover:scale-105 focus:ring-2 focus:outline-none sm:px-3 sm:py-2"
        title="ëª©ì°¨"
        aria-label="ëª©ì°¨">
        
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24">
  <line x1="8" x2="21" y1="6" y2="6"/>
  <line x1="8" x2="21" y1="12" y2="12"/>
  <line x1="8" x2="21" y1="18" y2="18"/>
  <line x1="3" x2="3.01" y1="6" y2="6"/>
  <line x1="3" x2="3.01" y1="12" y2="12"/>
  <line x1="3" x2="3.01" y1="18" y2="18"/>

</svg>
        <span class="hidden sm:inline"
          >ëª©ì°¨</span
        >
      </button>

      
      <div class="bg-border xs:mx-1 mx-2 h-6 w-px sm:mx-2"></div>
    


    
    <button
      id="dock-search"
      class="text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 xs:px-3 xs:py-1.5 flex flex-shrink-0 items-center gap-2 rounded-lg px-4 py-2 text-sm font-medium transition-all duration-300 ease-out hover:-translate-y-0.5 hover:scale-105 focus:ring-2 focus:outline-none sm:px-4 sm:py-2"
      title="ê²€ìƒ‰"
      aria-label="ê²€ìƒ‰">
      
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m21 21-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />

</svg>
      <span class="hidden md:inline"
        >ê²€ìƒ‰</span
      >
    </button>

    
    <div class="bg-border xs:mx-1 mx-2 h-6 w-px sm:mx-2"></div>

    
    
    


    
    <button
      id="dock-top"
      class="text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 xs:px-2 xs:py-1.5 flex flex-shrink-0 items-center gap-2 rounded-lg px-3 py-2 text-sm font-medium transition-all duration-300 ease-out hover:-translate-y-0.5 hover:scale-105 focus:ring-2 focus:outline-none sm:px-3 sm:py-2"
      title="ë§¨ ìœ„ë¡œ"
      aria-label="ë§¨ ìœ„ë¡œ">
      
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24">
  <path d="m18 15-6-6-6 6"/>

</svg>
      <span class="hidden sm:inline"
        >ë§¨ ìœ„ë¡œ</span
      >
    </button>
  </nav>
</div>


    
      



<div
  id="toc-overlay"
  class="pointer-events-none fixed inset-0 z-40 bg-black/50 opacity-0 backdrop-blur-sm transition-all duration-300"
  role="dialog"
  aria-modal="true"
  aria-labelledby="toc-title"></div>


<div
  id="toc-card"
  class="pointer-events-none fixed inset-4 z-50 flex w-auto scale-95 items-center justify-center opacity-0 transition-all duration-300 sm:inset-auto sm:top-1/2 sm:left-1/2 sm:block sm:w-full sm:max-w-md sm:-translate-x-1/2 sm:-translate-y-1/2"
  role="dialog"
  aria-modal="true"
  aria-labelledby="toc-title">
  <div
    class="bg-card border-border w-full max-w-sm overflow-hidden rounded-xl border shadow-xl sm:max-w-md">
    
    <div
      class="border-border bg-muted/30 flex items-center justify-between border-b p-4">
      <div class="flex items-center gap-3">
        
  <svg class="h-5 w-5"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24">
  <line x1="8" x2="21" y1="6" y2="6"/>
  <line x1="8" x2="21" y1="12" y2="12"/>
  <line x1="8" x2="21" y1="18" y2="18"/>
  <line x1="3" x2="3.01" y1="6" y2="6"/>
  <line x1="3" x2="3.01" y1="12" y2="12"/>
  <line x1="3" x2="3.01" y1="18" y2="18"/>

</svg>
        <h2 id="toc-title" class="text-foreground text-lg font-semibold">
          ëª©ì°¨
        </h2>
      </div>

      
      <button
        id="toc-close"
        class="text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 rounded-lg p-2 transition-all duration-200 ease-out hover:-translate-y-0.5 hover:scale-105 focus:ring-2 focus:outline-none"
        title="ë‹«ê¸°"
        aria-label="ë‹«ê¸°">
        
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />

</svg>
      </button>
    </div>

    
    <div class="max-h-96 overflow-y-auto p-4">
      <nav
        id="toc-nav"
        class="toc-scrollbar"
        aria-label="ê¸€ ëª©ì°¨">
          
          <div id="toc-content">
            <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#-ê²°ë¡ -ìš”ì•½-í•µì‹¬-ê°•ì -ë…ì°½ì„±-í•µì‹¬-ë©”ì»¤ë‹ˆì¦˜">âœ… ê²°ë¡  ìš”ì•½ (í•µì‹¬ ê°•ì , ë…ì°½ì„±, í•µì‹¬ ë©”ì»¤ë‹ˆì¦˜)</a></li>
        <li><a href="#-í•µì‹¬-êµ¬ì„±-ìš”ì†Œì™€-ì•Œê³ ë¦¬ì¦˜-ì„¤ëª…-ì˜ˆì‹œ-í¬í•¨">ğŸ” í•µì‹¬ êµ¬ì„± ìš”ì†Œì™€ ì•Œê³ ë¦¬ì¦˜ ì„¤ëª… (ì˜ˆì‹œ í¬í•¨)</a>
          <ul>
            <li><a href="#1-Ïƒ-moe-ê¸°ë°˜-feedforward-block">1. Ïƒ-MoE ê¸°ë°˜ Feedforward Block</a></li>
            <li><a href="#2-moe-self-attention-switchhead">2. MoE Self-Attention (SwitchHead)</a></li>
            <li><a href="#3-layer-grouping">3. Layer Grouping</a></li>
            <li><a href="#4-peri-layernorm">4. Peri-layernorm</a></li>
          </ul>
        </li>
        <li><a href="#-ì„±ëŠ¥-ë¹„êµ-ìš”ì•½">ğŸ“Š ì„±ëŠ¥ ë¹„êµ ìš”ì•½</a></li>
        <li><a href="#-ë…¼ë¬¸ì˜-ê°•ì -ë°-ë…ì°½ì -ê¸°ì—¬">ğŸŒŸ ë…¼ë¬¸ì˜ ê°•ì  ë° ë…ì°½ì  ê¸°ì—¬</a></li>
        <li><a href="#-í•œê³„ì -ë°-ê°œì„ -ì—¬ì§€">âš ï¸ í•œê³„ì  ë° ê°œì„  ì—¬ì§€</a></li>
        <li><a href="#-ê²°ë¡ ">âœ… ê²°ë¡ </a></li>
      </ul>
    </li>
  </ul>

  <ul>
    <li><a href="#-í•µì‹¬-ì•Œê³ ë¦¬ì¦˜-êµ¬ì„±-ìš”ì•½-ìš”ì†Œë³„-êµ¬ì¡°ì™€-ì—°ê²°ê´€ê³„">âœ… í•µì‹¬ ì•Œê³ ë¦¬ì¦˜ êµ¬ì„± ìš”ì•½ (ìš”ì†Œë³„ êµ¬ì¡°ì™€ ì—°ê²°ê´€ê³„)</a></li>
    <li><a href="#-ì˜ˆì‹œ-ê¸°ë°˜-ì„¤ëª…-Ïƒ-moe--moe-self-attention-ê²½ë¡œ">ğŸ§ª ì˜ˆì‹œ ê¸°ë°˜ ì„¤ëª… (Ïƒ-MoE + MoE Self-Attention ê²½ë¡œ)</a>
      <ul>
        <li><a href="#ê°€ì •">ê°€ì •</a></li>
        <li><a href="#-step-1-Ïƒ-moe-feedforward">ğŸ”¹ Step 1: Ïƒ-MoE Feedforward</a>
          <ul>
            <li><a href="#1-1-expert-ì„ íƒ">1-1. Expert ì„ íƒ</a></li>
            <li><a href="#1-2-ì„ íƒëœ-expert-ì²˜ë¦¬">1-2. ì„ íƒëœ expert ì²˜ë¦¬</a></li>
          </ul>
        </li>
        <li><a href="#-step-2-moe-self-attention-switchhead">ğŸ”¹ Step 2: MoE Self-Attention (SwitchHead)</a>
          <ul>
            <li><a href="#2-1-querykey-ê³„ì‚°-dense">2-1. Query/Key ê³„ì‚° (dense)</a></li>
            <li><a href="#2-2-valueoutputì—-moe-ì ìš©">2-2. Value/Outputì— MoE ì ìš©</a></li>
          </ul>
        </li>
        <li><a href="#-step-3-residual--peri-layernorm">ğŸ”¹ Step 3: Residual + Peri-layernorm</a></li>
      </ul>
    </li>
    <li><a href="#-ìš”ì•½-ì „ì²´-ì—°ì‚°-íë¦„">ğŸ§  ìš”ì•½: ì „ì²´ ì—°ì‚° íë¦„</a></li>
    <li><a href="#-ì¶”ê°€-í•´ì„¤-ì™œ-ì´ë ‡ê²Œ-ë™ì‘í•˜ëŠ”ê°€">ğŸ’¡ ì¶”ê°€ í•´ì„¤: ì™œ ì´ë ‡ê²Œ ë™ì‘í•˜ëŠ”ê°€?</a></li>
  </ul>

  <ul>
    <li><a href="#-1-ì‚¬ìš©í•œ-ì£¼ìš”-ë°ì´í„°ì…‹">âœ… 1. ì‚¬ìš©í•œ ì£¼ìš” ë°ì´í„°ì…‹</a></li>
    <li><a href="#-2-í•™ìŠµ-ë°©ì‹-ë°-êµ¬ì„±ìš”ì†Œ">âœ… 2. í•™ìŠµ ë°©ì‹ ë° êµ¬ì„±ìš”ì†Œ</a>
      <ul>
        <li><a href="#ê³µí†µ-í•™ìŠµ-ì„¤ì •">ê³µí†µ í•™ìŠµ ì„¤ì •</a></li>
      </ul>
    </li>
    <li><a href="#-3-ì „ì²´-í•™ìŠµ-íŒŒì´í”„ë¼ì¸-ì˜ˆì‹œ">âœ… 3. ì „ì²´ í•™ìŠµ íŒŒì´í”„ë¼ì¸ ì˜ˆì‹œ</a>
      <ul>
        <li><a href="#-step-by-step-í•™ìŠµ-ì˜ˆì‹œ-ì˜ˆ-c4-ë°ì´í„°-244m-ëª¨ë¸">âš™ï¸ Step-by-Step í•™ìŠµ ì˜ˆì‹œ (ì˜ˆ: C4 ë°ì´í„°, 244M ëª¨ë¸)</a>
          <ul>
            <li><a href="#1ë‹¨ê³„-ë°ì´í„°-ì¤€ë¹„">1ë‹¨ê³„: ë°ì´í„° ì¤€ë¹„</a></li>
            <li><a href="#2ë‹¨ê³„-dataloader-êµ¬ì„±-fixed-length-chunking">2ë‹¨ê³„: DataLoader êµ¬ì„± (Fixed-length chunking)</a></li>
            <li><a href="#3ë‹¨ê³„-ëª¨ë¸-ì´ˆê¸°í™”">3ë‹¨ê³„: ëª¨ë¸ ì´ˆê¸°í™”</a></li>
            <li><a href="#4ë‹¨ê³„-í•™ìŠµ-ë£¨í”„-perplexity-ê¸°ë°˜">4ë‹¨ê³„: í•™ìŠµ ë£¨í”„ (perplexity ê¸°ë°˜)</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#-4-gpuí•˜ë“œì›¨ì–´-ìš”êµ¬ì‚¬í•­">âœ… 4. GPU/í•˜ë“œì›¨ì–´ ìš”êµ¬ì‚¬í•­</a></li>
    <li><a href="#-5-checkpoint-ë°-evaluation">âœ… 5. Checkpoint ë° Evaluation</a></li>
    <li><a href="#-6-ì¬í˜„ìš©-ì¶”ì²œ-ìŠ¤í¬ë¦½íŠ¸">âœ… 6. ì¬í˜„ìš© ì¶”ì²œ ìŠ¤í¬ë¦½íŠ¸</a></li>
    <li><a href="#-ì •ë¦¬">ğŸ“ ì •ë¦¬</a></li>
  </ul>

  <ul>
    <li><a href="#-1-ì£¼ìš”-ì‹¤í—˜-ê²°ê³¼-ì •ë¦¬-í‘œ-ê¸°ë°˜-ìš”ì•½">âœ… 1. ì£¼ìš” ì‹¤í—˜ ê²°ê³¼ ì •ë¦¬ (í‘œ ê¸°ë°˜ ìš”ì•½)</a>
      <ul>
        <li><a href="#-language-modeling-perplexity-c4-ê¸°ì¤€-held-out-set">ğŸ“Š Language Modeling Perplexity (C4 ê¸°ì¤€, held-out set)</a></li>
        <li><a href="#-zero-shot-downstream-ì„±ëŠ¥-ì˜ˆ-244m-ëª¨ë¸-ê¸°ì¤€">ğŸ“Š Zero-shot Downstream ì„±ëŠ¥ (ì˜ˆ: 244M ëª¨ë¸ ê¸°ì¤€)</a></li>
      </ul>
    </li>
    <li><a href="#-2-ê¸°ì¡´-ë°©ë²•-ëŒ€ë¹„-íŠ¹ì¶œë‚œ-ì -ë¹„êµ-ê´€ì ">âœ… 2. ê¸°ì¡´ ë°©ë²• ëŒ€ë¹„ íŠ¹ì¶œë‚œ ì  (ë¹„êµ ê´€ì )</a></li>
    <li><a href="#-3-ì„±ëŠ¥-í–¥ìƒì—-ê¸°ì—¬í•œ-í•µì‹¬-ê¸°ë²•-ë°-ë…¼ë¬¸-ì£¼ì¥">âœ… 3. ì„±ëŠ¥ í–¥ìƒì— ê¸°ì—¬í•œ í•µì‹¬ ê¸°ë²• ë° ë…¼ë¬¸ ì£¼ì¥</a>
      <ul>
        <li><a href="#-1-Ïƒ-moe-in-ffn">ğŸ”¹ (1) Ïƒ-MoE in FFN</a></li>
        <li><a href="#-2-switchhead-moe-self-attention">ğŸ”¹ (2) SwitchHead (MoE Self-Attention)</a></li>
        <li><a href="#-3-layer-grouping-ex-a-b-a-b-ìŠ¤íƒ€ì¼-ë°˜ë³µ">ğŸ”¹ (3) Layer Grouping (ex: A-B-A-B ìŠ¤íƒ€ì¼ ë°˜ë³µ)</a></li>
        <li><a href="#-4-peri-layernorm">ğŸ”¹ (4) Peri-layernorm</a></li>
      </ul>
    </li>
    <li><a href="#-4-ë…¼ë¬¸-ì£¼ì¥ì—-ëŒ€í•œ-ë¹„íŒì -ë¶„ì„-ë°-ë‚´-ìƒê°">ğŸ’­ 4. ë…¼ë¬¸ ì£¼ì¥ì— ëŒ€í•œ ë¹„íŒì  ë¶„ì„ ë° ë‚´ ìƒê°</a>
      <ul>
        <li><a href="#-íƒ€ë‹¹í•œ-ì ">ğŸ’¡ íƒ€ë‹¹í•œ ì </a></li>
        <li><a href="#ë³´ì™„-í•„ìš”í•´-ë³´ì´ëŠ”-ì ">â—ï¸ë³´ì™„ í•„ìš”í•´ ë³´ì´ëŠ” ì </a></li>
      </ul>
    </li>
    <li><a href="#-ê²°ë¡ -1">ğŸ”š ê²°ë¡ </a></li>
  </ul>

  <ul>
    <li><a href="#-1-ì…ë ¥-ë°ì´í„°ì™€-ì¶”ë¡ -ê³¼ì •-ì˜ˆì‹œ-ê¸°ë°˜-ì„¤ëª…">âœ… 1. ì…ë ¥ ë°ì´í„°ì™€ ì¶”ë¡  ê³¼ì •: ì˜ˆì‹œ ê¸°ë°˜ ì„¤ëª…</a>
      <ul>
        <li><a href="#-ì˜ˆì‹œ-ì…ë ¥">âœï¸ ì˜ˆì‹œ ì…ë ¥</a></li>
        <li><a href="#-ì¶”ë¡ -ìˆœì„œ-simplified-inference-path">ğŸ” ì¶”ë¡  ìˆœì„œ (Simplified Inference Path)</a>
          <ul>
            <li><a href="#-input-embedding">â‘  Input Embedding</a></li>
            <li><a href="#-layer-group-ë°˜ë³µ-ex-g2-l18--9íšŒ-ë°˜ë³µ">â‘¡ Layer Group ë°˜ë³µ (ex: G=2, L=18 â†’ 9íšŒ ë°˜ë³µ)</a></li>
            <li><a href="#-step-by-step-single-moe-layer-ì˜ˆì‹œ">â–¶ Step-by-step: Single MoE Layer ì˜ˆì‹œ</a></li>
            <li><a href="#-residual--peri-layernorm">â‘¢ Residual + Peri-layernorm</a></li>
            <li><a href="#-output-layer">â‘£ Output Layer</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#-2-ëª¨ë¸-ì•„í‚¤í…ì²˜-êµ¬ì„±-ìš”ì•½">âœ… 2. ëª¨ë¸ ì•„í‚¤í…ì²˜ êµ¬ì„± ìš”ì•½</a></li>
    <li><a href="#-3-ì—°ì‚°ëŸ‰-ë°-ë©”ëª¨ë¦¬-ë¶„ì„-per-token-ê¸°ì¤€">âœ… 3. ì—°ì‚°ëŸ‰ ë° ë©”ëª¨ë¦¬ ë¶„ì„ (per-token ê¸°ì¤€)</a>
      <ul>
        <li><a href="#-feedforward-Ïƒ-moe">âœ³ï¸ Feedforward (Ïƒ-MoE)</a></li>
        <li><a href="#-moe-attention-switchhead">âœ³ï¸ MoE Attention (SwitchHead)</a></li>
        <li><a href="#-ì´-ì¶”ë¡ -ë¹„ìš©-ì˜ˆ-t1024-18-shared-layers-g2">ğŸ”¢ ì´ ì¶”ë¡  ë¹„ìš© (ì˜ˆ: T=1024, 18 shared layers, G=2)</a></li>
      </ul>
    </li>
    <li><a href="#-4-ë©”ëª¨ë¦¬-ì‚¬ìš©ëŸ‰-ë¹„êµ-ì‹¤í—˜-ê²°ê³¼-ê¸°ë°˜">âœ… 4. ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ë¹„êµ (ì‹¤í—˜ ê²°ê³¼ ê¸°ë°˜)</a></li>
    <li><a href="#-ê²°ë¡ -ìš”ì•½">âœ… ê²°ë¡  ìš”ì•½</a></li>
  </ul>

  <ul>
    <li><a href="#-1-ë…¼ë¬¸ì—ì„œ-ì–¸ê¸‰í•œ-í•œê³„-ìš”ì•½">âœ… 1. ë…¼ë¬¸ì—ì„œ ì–¸ê¸‰í•œ í•œê³„ ìš”ì•½</a></li>
    <li><a href="#-2-í•œê³„-ê·¹ë³µì„-ìœ„í•œ-ëŒ€í‘œ-ì—°êµ¬-íë¦„">ğŸ” 2. í•œê³„ ê·¹ë³µì„ ìœ„í•œ ëŒ€í‘œ ì—°êµ¬ íë¦„</a>
      <ul>
        <li><a href="#-1-íš¨ìœ¨ì ì¸-moe-í•™ìŠµ--ì»¤ë„-ìµœì í™”">ğŸ§  [1] íš¨ìœ¨ì ì¸ MoE í•™ìŠµ &amp; ì»¤ë„ ìµœì í™”</a></li>
        <li><a href="#-2-adaptive-computation-integration-ut-íŠ¹í™”">ğŸ§  [2] Adaptive Computation Integration (UT íŠ¹í™”)</a></li>
        <li><a href="#-3-expert-specialization-í–¥ìƒ-dynamic-routing-ê°œì„ ">ğŸ§  [3] Expert Specialization í–¥ìƒ (Dynamic Routing ê°œì„ )</a></li>
        <li><a href="#-4-downstream-task-fine-tuning-zero-shot-í•œê³„-ê·¹ë³µ">ğŸ§  [4] Downstream Task Fine-tuning (Zero-shot í•œê³„ ê·¹ë³µ)</a></li>
        <li><a href="#-5-massive-scale-universal-moe-1b-ìŠ¤ì¼€ì¼-í™•ì¥">ğŸ§  [5] Massive Scale Universal MoE (1B+ ìŠ¤ì¼€ì¼ í™•ì¥)</a></li>
      </ul>
    </li>
    <li><a href="#-ë‚´-ì œì•ˆ-moeutì˜-í•œê³„-ê·¹ë³µì„-ìœ„í•œ-í†µí•©-ë°©í–¥">ğŸ§  ë‚´ ì œì•ˆ: MoEUTì˜ í•œê³„ ê·¹ë³µì„ ìœ„í•œ í†µí•© ë°©í–¥</a></li>
    <li><a href="#-ì •ë¦¬-1">âœ… ì •ë¦¬</a></li>
  </ul>

  <ul>
    <li><a href="#-ì§ˆë¬¸-í•µì‹¬-ìš”ì•½">âœ… ì§ˆë¬¸ í•µì‹¬ ìš”ì•½</a></li>
    <li><a href="#1-ê¸°ì¡´-universal-transformerì˜-í•œê³„-parametercompute-ratio">1. ê¸°ì¡´ Universal Transformerì˜ í•œê³„: parameterâ€“compute ratio</a></li>
    <li><a href="#2-moeutì˜-í•´ê²°ì±…-sparse-expert-êµ¬ì¡°">2. MoEUTì˜ í•´ê²°ì±…: Sparse Expert êµ¬ì¡°</a>
      <ul>
        <li><a href="#-í•µì‹¬-ì•„ì´ë””ì–´-íŒŒë¼ë¯¸í„°-ìˆ˜ëŠ”-ëŠ˜ë¦¬ë˜-ì—°ì‚°ëŸ‰ì€-ê·¸ëŒ€ë¡œ-ë˜ëŠ”-ì¤„ì¸ë‹¤">ğŸ”¹ í•µì‹¬ ì•„ì´ë””ì–´: &ldquo;íŒŒë¼ë¯¸í„° ìˆ˜ëŠ” ëŠ˜ë¦¬ë˜, ì—°ì‚°ëŸ‰ì€ ê·¸ëŒ€ë¡œ ë˜ëŠ” ì¤„ì¸ë‹¤&rdquo;</a></li>
      </ul>
    </li>
    <li><a href="#3-Ïƒ-moe-vs-switchhead-êµ¬ì¡°-ë¹„êµ">3. Ïƒ-MoE vs SwitchHead: êµ¬ì¡° ë¹„êµ</a></li>
    <li><a href="#4-ì‹¤í—˜ì -ê·¼ê±°">4. ì‹¤í—˜ì  ê·¼ê±°</a></li>
    <li><a href="#-ì •ë¦¬-2">âœ… ì •ë¦¬</a></li>
  </ul>

  <ul>
    <li><a href="#-ì§ˆë¬¸-í•µì‹¬-ìš”ì•½-1">âœ… ì§ˆë¬¸ í•µì‹¬ ìš”ì•½</a></li>
    <li><a href="#1-layer-grouping-í‘œí˜„ë ¥expressiveness-íšŒë³µì„-ìœ„í•œ-ì„¤ê³„">1. Layer Grouping: í‘œí˜„ë ¥(Expressiveness) íšŒë³µì„ ìœ„í•œ ì„¤ê³„</a>
      <ul>
        <li><a href="#-ë¬¸ì œ-ì™„ì „í•œ-layer-sharingì€-í‘œí˜„ë ¥ì´-ì•½í•´ì§">â— ë¬¸ì œ: ì™„ì „í•œ Layer Sharingì€ í‘œí˜„ë ¥ì´ ì•½í•´ì§</a></li>
        <li><a href="#-í•´ê²°ì±…-groupingëœ-ë ˆì´ì–´-ë¸”ë¡ì„-ë°˜ë³µ-a-b-a-b">âœ… í•´ê²°ì±…: Groupingëœ &ldquo;ë ˆì´ì–´ ë¸”ë¡&quot;ì„ ë°˜ë³µ (A-B-A-B&hellip;)</a></li>
        <li><a href="#-ìš”ì•½-layer-groupingì˜-ê¸°ì—¬">ğŸ’¡ ìš”ì•½: Layer Groupingì˜ ê¸°ì—¬</a></li>
      </ul>
    </li>
    <li><a href="#2-peri-layernorm-í•™ìŠµ-ì•ˆì •ì„±--gradient-flow-ê°œì„ ">2. Peri-layernorm: í•™ìŠµ ì•ˆì •ì„± + gradient flow ê°œì„ </a>
      <ul>
        <li><a href="#-ë¬¸ì œ-standard-pre-layernormì€-shared-layer-êµ¬ì¡°ì—ì„œ-ë¬¸ì œ-ë°œìƒ">â— ë¬¸ì œ: Standard pre-layernormì€ shared-layer êµ¬ì¡°ì—ì„œ ë¬¸ì œ ë°œìƒ</a></li>
        <li><a href="#-í•´ê²°ì±…-peri-layernorm-ë¹„ì„ í˜•-ì—°ì‚°-ì•ì—ë§Œ-ln-ì‚½ì…">âœ… í•´ê²°ì±…: Peri-layernorm (ë¹„ì„ í˜• ì—°ì‚° ì•ì—ë§Œ LN ì‚½ì…)</a></li>
        <li><a href="#ì‹¤í—˜ì -ê·¼ê±°-ë…¼ë¬¸-fig-8">ì‹¤í—˜ì  ê·¼ê±° (ë…¼ë¬¸ Fig. 8)</a></li>
        <li><a href="#-ìš”ì•½-peri-layernormì˜-ê¸°ì—¬">ğŸ’¡ ìš”ì•½: Peri-layernormì˜ ê¸°ì—¬</a></li>
      </ul>
    </li>
    <li><a href="#-ì „ì²´-ìš”ì•½-ì •ë¦¬">âœ… ì „ì²´ ìš”ì•½ ì •ë¦¬</a></li>
  </ul>

  <ul>
    <li><a href="#-ì§ˆë¬¸-í•µì‹¬-ìš”ì•½-2">âœ… ì§ˆë¬¸ í•µì‹¬ ìš”ì•½</a></li>
    <li><a href="#1-ì‹¤í—˜-ê²°ê³¼-ìš”ì•½-ê°™ì€-íŒŒë¼ë¯¸í„°ì—°ì‚°ëŸ‰-ê¸°ì¤€-ë¹„êµ">1. ì‹¤í—˜ ê²°ê³¼ ìš”ì•½: ê°™ì€ íŒŒë¼ë¯¸í„°/ì—°ì‚°ëŸ‰ ê¸°ì¤€ ë¹„êµ</a>
      <ul>
        <li><a href="#-ì˜ˆ-c4-ì–¸ì–´-ëª¨ë¸ë§-perplexity-ë¹„êµ">ğŸ“Œ ì˜ˆ: C4 ì–¸ì–´ ëª¨ë¸ë§ Perplexity ë¹„êµ</a></li>
      </ul>
    </li>
    <li><a href="#2-ê·¼ë³¸-ì›ì¸-ìš”ì•½-sparse-routing--recurrenceì˜-ê²°í•©-ì‹œë„ˆì§€">2. ê·¼ë³¸ ì›ì¸ ìš”ì•½: &ldquo;Sparse Routing + Recurrenceì˜ ê²°í•© ì‹œë„ˆì§€&rdquo;</a>
      <ul>
        <li><a href="#-a-moe-routingìœ¼ë¡œ-parameter-efficiency-í™•ë³´-ëª¨ë¸ì˜-capacity-ì¦ê°€">ğŸ§  A. MoE routingìœ¼ë¡œ parameter efficiency í™•ë³´ (ëª¨ë¸ì˜ capacity ì¦ê°€)</a></li>
        <li><a href="#-b-recurrence-shared-layerë¡œ-inductive-bias-ë„ì…">ğŸ” B. Recurrence (shared-layer)ë¡œ inductive bias ë„ì…</a></li>
      </ul>
    </li>
    <li><a href="#3-ì„±ëŠ¥-í–¥ìƒì˜-ì£¼ìš”-ê¸°ì—¬-ìš”ì†Œ-ë¶„í•´">3. ì„±ëŠ¥ í–¥ìƒì˜ ì£¼ìš” ê¸°ì—¬ ìš”ì†Œ ë¶„í•´</a>
      <ul>
        <li><a href="#-ablation-ê¸°ë°˜-ì˜í–¥ë„-ë¶„ì„-ì •ì„±ì -ìˆœìœ„">ğŸ“Š Ablation ê¸°ë°˜ ì˜í–¥ë„ ë¶„ì„ (ì •ì„±ì  ìˆœìœ„)</a></li>
      </ul>
    </li>
    <li><a href="#4-ë‚´-ë¶„ì„-ì™œ-ì‹œë„ˆì§€-íš¨ê³¼ê°€-í°ê°€">4. ë‚´ ë¶„ì„: ì™œ ì‹œë„ˆì§€ íš¨ê³¼ê°€ í°ê°€?</a></li>
    <li><a href="#-ê²°ë¡ -ìš”ì•½-1">âœ… ê²°ë¡  ìš”ì•½</a></li>
  </ul>
</nav>
          </div>
      </nav>
    </div>

    
    <div class="border-border bg-muted/20 border-t px-4 py-3">
      <div class="text-muted-foreground text-center text-xs">
        <span>ì œëª©ì„ í´ë¦­í•˜ë©´ í•´ë‹¹ ìœ„ì¹˜ë¡œ ì´ë™í•©ë‹ˆë‹¤</span>
      </div>
    </div>
  </div>
</div>

    


  <link
    rel="stylesheet"
    href="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.css"
    integrity="sha384-5TcZemv2l/9On385z///+d7MSYlvIEw9FuZTIdZ14vJLqWphw7e7ZPuOiCHJcFCP"
    crossorigin="anonymous" />
  <script
    defer
    src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.js"
    integrity="sha384-cMkvdD8LoxVzGF/RPUKAcvmm49FQ0oxwDF3BGKtDXcEc+T1b2N+teh/OJfpU0jr6"
    crossorigin="anonymous"></script>
  <script
    defer
    src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/contrib/auto-render.min.js"
    integrity="sha384-hCXGrW6PitJEwbkoStFjeJxv+fSOOQKOPbJxSfM6G5sWZjAyWhXiTIIAmQqnlLlh"
    crossorigin="anonymous"></script>

<script>
    
    function initKaTeX() {
        if (typeof renderMathInElement === 'undefined') {
            setTimeout(initKaTeX, 100);
            return;
        }

        var delimiters = [{"display":true,"left":"$$","right":"$$"},{"display":false,"left":"$","right":"$"}];

        renderMathInElement(document.body, {
            delimiters: delimiters,
            throwOnError: false,
            errorColor: '#cc0000',
            fleqn: false,
            leqno: false,
            trust: false
        });
    }

    
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', initKaTeX);
    } else {
        initKaTeX();
    }
</script>
    



    
    
<div
  id="search-overlay"
  class="pointer-events-none fixed inset-0 z-40 bg-black/50 opacity-0 transition-opacity duration-300"></div>


<div
  id="search-modal"
  class="bg-card border-border pointer-events-none fixed top-1/2 left-1/2 z-50 max-h-[80vh] w-full max-w-2xl -translate-x-1/2 -translate-y-1/2 scale-95 transform overflow-hidden rounded-xl border opacity-0 shadow-xl transition-all duration-300">
  
  <div class="border-border flex items-center gap-3 border-b p-4">
    
    <div class="text-muted-foreground h-5 w-5 flex-shrink-0">
      
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m21 21-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />

</svg>
    </div>

    
    <div class="relative flex-1">
      
      <button
        id="search-clear"
        class="text-muted-foreground hover:text-foreground hover:bg-muted/50 pointer-events-none absolute top-1/2 left-0 z-10 h-5 w-5 -translate-y-1/2 rounded opacity-0 transition-all duration-200"
        title="ì§€ìš°ê¸°"
        aria-label="ì§€ìš°ê¸°">
        
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />

</svg>
      </button>

      
      <input
        id="search-input"
        type="text"
        placeholder="ê²Œì‹œê¸€ ê²€ìƒ‰..."
        class="text-foreground placeholder:text-muted-foreground w-full border-none bg-transparent pl-8 text-lg outline-none"
        autocomplete="off"
        spellcheck="false" />
    </div>

    
    <button
      id="search-close"
      class="text-muted-foreground hover:text-foreground hover:bg-muted/50 flex h-6 w-6 items-center justify-center rounded-md p-0.5 transition-all duration-200"
      title="ë‹«ê¸°"
      aria-label="ë‹«ê¸°">
      
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />

</svg>
    </button>
  </div>

  
  <div id="search-results" class="max-h-96 overflow-y-auto">
    
    <div
      id="search-empty"
      class="flex flex-col items-center justify-center py-12 text-center">
      <div
        class="bg-muted/50 mb-4 flex h-16 w-16 items-center justify-center rounded-full">
        
  <svg class="h-6 w-6"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m21 21-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />

</svg>
      </div>
      <h3 class="text-foreground mb-2 text-lg font-semibold">
        ê²€ìƒ‰ ì‹œì‘
      </h3>
      <p class="text-muted-foreground text-sm">
        ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•˜ì„¸ìš”
      </p>
    </div>

    
    <div
      id="search-loading"
      class="flex hidden items-center justify-center py-8">
      <div
        class="mr-3 h-6 w-6 animate-spin rounded-full border-2 border-current border-t-transparent"></div>
      <span class="text-muted-foreground"
        >ê²€ìƒ‰ ì¤‘...</span
      >
    </div>

    
    <div
      id="search-no-results"
      class="flex hidden flex-col items-center justify-center py-12 text-center">
      <div
        class="bg-muted/50 mb-4 flex h-16 w-16 items-center justify-center rounded-full">
        
  <svg class="h-6 w-6"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h7" />
</svg>
      </div>
      <h3 class="text-foreground mb-2 text-lg font-semibold">
        ê²€ìƒ‰ ê²°ê³¼ ì—†ìŒ
      </h3>
      <p class="text-muted-foreground text-sm">
        ë‹¤ë¥¸ ê²€ìƒ‰ì–´ë¡œ ì‹œë„í•´ë³´ì„¸ìš”
      </p>
    </div>

    
    <div id="search-results-list" class="hidden">
      
      <div
        id="search-stats"
        class="text-muted-foreground border-border border-b px-4 py-3 text-sm"
        data-template="%dê°œì˜ ê²°ê³¼ ì°¾ìŒ">
      </div>

      
      <div id="search-items" class="divide-border divide-y">
        
      </div>
    </div>
  </div>

  
  <div class="border-border bg-muted/20 border-t px-4 py-3">
    <div
      class="text-muted-foreground flex items-center justify-between text-xs">
      <div class="flex items-center gap-2 md:gap-4">
        <div class="flex items-center gap-1">
          <kbd
            class="bg-muted border-border rounded border px-1.5 py-0.5 text-xs"
            >â†‘â†“</kbd
          >
          <span class="hidden sm:inline"
            >ì´ë™</span
          >
        </div>
        <div class="flex items-center gap-1">
          <kbd
            class="bg-muted border-border rounded border px-1.5 py-0.5 text-xs"
            >â†µ</kbd
          >
          <span class="hidden sm:inline"
            >ì„ íƒ</span
          >
        </div>
        <div class="flex items-center gap-1">
          <kbd
            class="bg-muted border-border rounded border px-1.5 py-0.5 text-xs"
            >ESC</kbd
          >
          <span class="hidden sm:inline"
            >ë‹«ê¸°</span
          >
        </div>
      </div>
      <div class="search-hint-desktop flex items-center gap-1">
        <kbd class="bg-muted border-border rounded border px-1.5 py-0.5 text-xs"
          >âŒ˜K</kbd
        >
        <span>ë‹¨ì¶•í‚¤</span>
      </div>
    </div>
  </div>
</div>

  </body>
</html>
