<!doctype html>
<html
  lang="ko-kr"
  data-theme="claude">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1314&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8" />
<meta
  name="viewport"
  content="width=device-width, initial-scale=1, shrink-to-fit=no" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />

<title>Keyformer KV Cache Reduction through Key Tokens Selection for Efficient Generative Inference | Jaehun&#39;s Blog</title>

<meta name="description" content="논문 : https://arxiv.org/abs/2403.09054
개인의견 : 예전부터 KV cache중에 핵심이 되는 내용만 잘 선택하면 오버헤드를 줄일수 있지 않을까라고 생각했는데 핵심 토큰만 가지고 이러한 방법을 구현한 논문입니다...." />
<meta name="keywords" content="개발, 컴파일러, 프로그래밍, 에세이" />
<meta name="author" content="" />
<meta name="language" content="ko-kr" />

<meta name="robots" content="index, follow" />
<link rel="canonical" href="http://192.168.1.11:1314/posts/Keyformer-KV-Cache-Reduction-through-Key-Tokens-Selection-for-Efficient-Generative-Inference/" />



  <link rel="icon" type="image/svg+xml" href="/favicon.svg" />



<link rel="manifest" href="/site.webmanifest" />
<meta property="og:url" content="http://192.168.1.11:1314/posts/Keyformer-KV-Cache-Reduction-through-Key-Tokens-Selection-for-Efficient-Generative-Inference/">
  <meta property="og:site_name" content="Jaehun&#39;s Blog">
  <meta property="og:title" content="Keyformer KV Cache Reduction through Key Tokens Selection for Efficient Generative Inference">
  <meta property="og:description" content="논문 : https://arxiv.org/abs/2403.09054
개인의견 : 예전부터 KV cache중에 핵심이 되는 내용만 잘 선택하면 오버헤드를 줄일수 있지 않을까라고 생각했는데 핵심 토큰만 가지고 이러한 방법을 구현한 논문입니다. 이러한 논문을 볼때 마다 항상 과연 정확도에 얼마나 영향을 줄까라는 의심이 생길수 밖에 없지만 이렇게 알고리즘쪽에서 경량화를 많이 해주면 좋겠네요">
  <meta property="og:locale" content="ko_kr">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-10-31T00:00:00+00:00">
    <meta property="article:modified_time" content="2024-10-31T00:00:00+00:00">
    <meta property="og:image" content="http://192.168.1.11:1314/images/og-default.avif">


  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="http://192.168.1.11:1314/images/og-default.avif">
  <meta name="twitter:title" content="Keyformer KV Cache Reduction through Key Tokens Selection for Efficient Generative Inference">
  <meta name="twitter:description" content="논문 : https://arxiv.org/abs/2403.09054
개인의견 : 예전부터 KV cache중에 핵심이 되는 내용만 잘 선택하면 오버헤드를 줄일수 있지 않을까라고 생각했는데 핵심 토큰만 가지고 이러한 방법을 구현한 논문입니다. 이러한 논문을 볼때 마다 항상 과연 정확도에 얼마나 영향을 줄까라는 의심이 생길수 밖에 없지만 이렇게 알고리즘쪽에서 경량화를 많이 해주면 좋겠네요">


  <meta itemprop="name" content="Keyformer KV Cache Reduction through Key Tokens Selection for Efficient Generative Inference">
  <meta itemprop="description" content="논문 : https://arxiv.org/abs/2403.09054
개인의견 : 예전부터 KV cache중에 핵심이 되는 내용만 잘 선택하면 오버헤드를 줄일수 있지 않을까라고 생각했는데 핵심 토큰만 가지고 이러한 방법을 구현한 논문입니다. 이러한 논문을 볼때 마다 항상 과연 정확도에 얼마나 영향을 줄까라는 의심이 생길수 밖에 없지만 이렇게 알고리즘쪽에서 경량화를 많이 해주면 좋겠네요">
  <meta itemprop="datePublished" content="2024-10-31T00:00:00+00:00">
  <meta itemprop="dateModified" content="2024-10-31T00:00:00+00:00">
  <meta itemprop="wordCount" content="7411">
  <meta itemprop="image" content="http://192.168.1.11:1314/images/og-default.avif">
  <meta itemprop="keywords" content="Paper-Review,With-Gpt">







<script>
  window.HUGO_SEARCH_CONFIG = {
    searchIndexURL: "\"/index.json\""
  };
</script>


































<script>

  window.HUGO_GALLERY_CONFIG = {
    justified_gallery:  false ,
    lightbox:  false ,
    justified: "{}",
    lightbox_options: "{}"
  };
</script>




  
    <link rel="stylesheet" href="/css/compiled.css" />
  





  
    <link rel="stylesheet" href="/css/chroma.css" />
  












      <script src="/js/main.js"></script>



  <script src="/js/gumshoe.polyfills.min.js"></script>



        <script src="/js/toc.js" defer></script>



      <script src="/js/search.js" defer></script>



      <script src="/js/dock.js" defer></script>











  











    <script>
      
      (function() {
        const theme = localStorage.getItem('theme') || 'system';
        const colorScheme = localStorage.getItem('colorScheme') || 'claude';

        
        document.documentElement.setAttribute('data-theme', colorScheme);

        
        function applyTheme() {
          if (theme === 'dark' || (theme === 'system' && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
            document.documentElement.classList.add('dark');
          } else {
            document.documentElement.classList.remove('dark');
          }
        }

        applyTheme();

        
        if (theme === 'system') {
          window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', applyTheme);
        }
      })();
    </script>
  </head>

  <body class="bg-background text-foreground min-h-screen antialiased">
    
    
  <div
    id="reading-progress-container"
    class="reading-progress-container pointer-events-none fixed top-0 right-0 left-0 z-50 transition-opacity duration-300 ease-out"
    data-height="3"
    data-smooth-scroll="true"
    data-hide-on-complete="false">
    
    <div class="reading-progress-bg w-full"></div>

    
    <div
      id="reading-progress-bar"
      class="from-primary to-primary/80 reading-progress-bar 
        transition-all duration-150 ease-out
       absolute top-0 left-0 w-0 bg-gradient-to-r"></div>
  </div>

  <script>
    (function () {
      "use strict";

      const progressContainer = document.getElementById(
        "reading-progress-container",
      );
      const progressBar = document.getElementById("reading-progress-bar");

      if (!progressContainer || !progressBar) return;

      
      const config = {
        smoothScroll: progressContainer.dataset.smoothScroll === "true",
        hideOnComplete: progressContainer.dataset.hideOnComplete === "true",
      };

      let isVisible = true;
      let gumshoeInstance = null;

      
      function calculateProgress() {
        const scrollTop =
          window.pageYOffset || document.documentElement.scrollTop;
        const documentHeight = document.documentElement.scrollHeight;
        const windowHeight = window.innerHeight;
        const scrollableHeight = documentHeight - windowHeight;

        if (scrollableHeight <= 0) return 0;

        return Math.min(Math.max((scrollTop / scrollableHeight) * 100, 0), 100);
      }

      
      function updateProgress() {
        const progress = calculateProgress();
        progressBar.style.width = progress + "%";

        
        if (config.hideOnComplete && progress >= 99.5) {
          if (isVisible) {
            progressContainer.style.opacity = "0";
            isVisible = false;
          }
        } else if (!isVisible) {
          progressContainer.style.opacity = "1";
          isVisible = true;
        }
      }

      
      let ticking = false;
      function requestTick() {
        if (!ticking) {
          requestAnimationFrame(() => {
            updateProgress();
            ticking = false;
          });
          ticking = true;
        }
      }

      
      function init() {
        
        window.addEventListener("scroll", requestTick, { passive: true });
        window.addEventListener("resize", requestTick, { passive: true });
        document.addEventListener("visibilitychange", () => {
          if (!document.hidden) requestTick();
        });

        
        requestTick();

        
        window.addEventListener("beforeunload", () => {
          window.removeEventListener("scroll", requestTick);
          window.removeEventListener("resize", requestTick);
        });
      }

      
      if (document.readyState === "loading") {
        document.addEventListener("DOMContentLoaded", init);
      } else {
        init();
      }
    })();
  </script>

    <header class="sticky top-0 z-50 mx-auto max-w-4xl px-4 py-6">
  <div
    class="border-border bg-card/80 flex items-center rounded-xl border px-6 py-4 shadow-sm backdrop-blur-sm">
    
    <div class="hidden w-full items-center md:flex">
      
      <div class="flex items-center">
        
          
          <a
            href="/"
            class="bg-primary text-primary-foreground hover:bg-primary/90 flex h-10 w-10 items-center justify-center rounded-full text-lg font-bold transition-transform duration-200 hover:scale-105"
            aria-label="Jaehun&#39;s Blog">
            J
          </a>
        
      </div>

      
      <nav class="mx-8 flex flex-1 items-center justify-center">
        <div class="flex items-center space-x-1">
          
          
            
            
            
              
                
              
            
            
            <a
              href="/posts/"
              class="nav-link 
                text-muted-foreground hover:text-primary hover:bg-primary/10
               focus:ring-primary/20 relative flex items-center gap-2 rounded-lg px-4 py-2 text-sm font-medium transition-all duration-300 ease-out hover:-translate-y-0.5 hover:scale-105 focus:ring-2 focus:outline-none">
              
                
  <svg class="h-5 w-5"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="nav.posts">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 20H5a2 2 0 01-2-2V6a2 2 0 012-2h10a2 2 0 012 2v1m2 13a2 2 0 01-2-2V7m2 13a2 2 0 002-2V9a2 2 0 00-2-2h-2m-4-3H9M7 16h6M7 8h6v4H7V8z" />

</svg>
              
              <span
                >
                  게시글
                </span
              >
            </a>
          
            
            
            
              
                
              
            
            
            <a
              href="/categories/"
              class="nav-link 
                text-muted-foreground hover:text-primary hover:bg-primary/10
               focus:ring-primary/20 relative flex items-center gap-2 rounded-lg px-4 py-2 text-sm font-medium transition-all duration-300 ease-out hover:-translate-y-0.5 hover:scale-105 focus:ring-2 focus:outline-none">
              
                
  <svg class="h-5 w-5"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="nav.categories">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10" />

</svg>
              
              <span
                >
                  카테고리
                </span
              >
            </a>
          
            
            
            
              
                
              
            
            
            <a
              href="/tags/"
              class="nav-link 
                text-muted-foreground hover:text-primary hover:bg-primary/10
               focus:ring-primary/20 relative flex items-center gap-2 rounded-lg px-4 py-2 text-sm font-medium transition-all duration-300 ease-out hover:-translate-y-0.5 hover:scale-105 focus:ring-2 focus:outline-none">
              
                
  <svg class="h-5 w-5"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="nav.tags">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z" />

</svg>
              
              <span
                >
                  태그
                </span
              >
            </a>
          
            
            
            
              
                
              
            
            
            <a
              href="/archives/"
              class="nav-link 
                text-muted-foreground hover:text-primary hover:bg-primary/10
               focus:ring-primary/20 relative flex items-center gap-2 rounded-lg px-4 py-2 text-sm font-medium transition-all duration-300 ease-out hover:-translate-y-0.5 hover:scale-105 focus:ring-2 focus:outline-none">
              
                
  <svg class="h-5 w-5"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="nav.archives">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 8h14M5 8a2 2 0 110-4h14a2 2 0 110 4M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8m-9 4h4" />

</svg>
              
              <span
                >
                  아카이브
                </span
              >
            </a>
          
        </div>
      </nav>

      
      <div class="flex items-center space-x-2">
        
        
<div class="relative">
  <button id="language-toggle"
    class="dropdown-toggle border-border bg-background text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex h-10 w-10 items-center justify-center rounded-lg border transition-all duration-300 ease-out hover:scale-105 focus:ring-2 focus:outline-none active:scale-95"
    data-dropdown-type="language"
    aria-label="언어 변경"
    aria-expanded="false"
    aria-haspopup="true">
      
  <svg class="h-5 w-5 relative z-10"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="언어 변경">
	<path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m5 8l6 6m-7 0l6-6l2-3M2 5h12M7 2h1m14 20l-5-10l-5 10m2-4h6" />
</svg></button>

  
  <div id="language-dropdown"
    class="dropdown-menu border-border bg-popover/95 absolute top-12 right-0 z-[60] hidden w-40 rounded-lg border p-1 shadow-lg backdrop-blur-sm transition-all duration-200 ease-out"
    data-dropdown-type="language"
    role="menu"
    aria-labelledby="language-toggle"><a href="/ko/" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none" role="menuitem" aria-current="true"><span class="font-medium">한국어</span></a><a href="/en/" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none" role="menuitem"><span class="font-medium">English</span></a></div>
</div>

        
        
<div class="relative">
  <button id="color-scheme-toggle"
    class="dropdown-toggle border-border bg-background text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex h-10 w-10 items-center justify-center rounded-lg border transition-all duration-300 ease-out hover:scale-105 focus:ring-2 focus:outline-none active:scale-95"
    data-dropdown-type="color-scheme"
    aria-label="테마 변경"
    aria-expanded="false"
    aria-haspopup="true">
      
  <svg class="h-5 w-5 relative z-10"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="테마 변경">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zM21 5a2 2 0 00-2-2h-4a2 2 0 00-2 2v6a2 2 0 002 2h4a2 2 0 002-2V5z" />

</svg></button>

  
  <div id="color-scheme-dropdown"
    class="dropdown-menu border-border bg-popover/95 absolute top-12 right-0 z-[60] hidden w-44 rounded-lg border p-1 shadow-lg backdrop-blur-sm transition-all duration-200 ease-out"
    data-dropdown-type="color-scheme"><button data-color-scheme="claude" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Default</span></button><button data-color-scheme="default" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>White</span></button><button data-color-scheme="bumblebee" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Bumblebee</span></button><button data-color-scheme="emerald" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Emerald</span></button><button data-color-scheme="nord" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Nord</span></button><button data-color-scheme="sunset" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Sunset</span></button><button data-color-scheme="abyss" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Abyss</span></button><button data-color-scheme="dracula" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Dracula</span></button><button data-color-scheme="amethyst" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Amethyst</span></button><button data-color-scheme="slate" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Slate</span></button><button data-color-scheme="twitter" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Twitter</span></button></div>
</div>

        
        
<div class="relative">
  <button id="theme-toggle"
    class="dropdown-toggle border-border bg-background text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex h-10 w-10 items-center justify-center rounded-lg border transition-all duration-300 ease-out hover:scale-105 focus:ring-2 focus:outline-none active:scale-95"
    data-dropdown-type="theme"
    aria-label="테마 변경"
    aria-expanded="false"
    aria-haspopup="true">
      
      
  <svg class="h-5 w-5 sun-icon hidden relative z-10"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="라이트">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" />

</svg>
      
      
  <svg class="h-5 w-5 moon-icon hidden relative z-10"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="다크">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" />

</svg>
      
      
  <svg class="h-5 w-5 system-icon hidden relative z-10"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="시스템">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />

</svg></button>

  
  <div id="theme-dropdown"
    class="dropdown-menu border-border bg-popover/95 absolute top-12 right-0 z-[60] hidden w-40 rounded-lg border p-1 shadow-lg backdrop-blur-sm transition-all duration-200 ease-out"
    data-dropdown-type="theme"><button data-theme="light" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none">
  <svg class="h-5 w-5 mr-3 h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="라이트">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" />

</svg><span>라이트</span></button><button data-theme="dark" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none">
  <svg class="h-5 w-5 mr-3 h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="다크">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" />

</svg><span>다크</span></button><button data-theme="system" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none">
  <svg class="h-5 w-5 mr-3 h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="시스템">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />

</svg><span>시스템</span></button></div>
</div>
      </div>
    </div>

    
    <div class="flex w-full items-center justify-between md:hidden">
      
      
<div class="relative">
  <button
    id="mobile-menu-toggle"
    class="dropdown-toggle border-border bg-background text-muted-foreground hover:bg-accent hover:text-foreground flex h-10 w-10 items-center justify-center rounded-lg border transition-colors duration-200"
    data-dropdown-type="mobile-menu"
    aria-label="메뉴"
    aria-expanded="false"
    aria-haspopup="true">
    
  <svg class="h-5 w-5"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="메뉴">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />

</svg>
  </button>

  
  <div
    id="mobile-menu"
    class="mobile-menu dropdown-menu border-border bg-popover/95 absolute top-12 left-0 z-[60] hidden w-80 max-w-[calc(100vw-2rem)] rounded-lg border p-1 shadow-lg backdrop-blur-sm transition-all duration-200 ease-out md:hidden"
    data-dropdown-type="mobile-menu"
    role="menu"
    aria-labelledby="mobile-menu-toggle">
    <nav class="flex flex-col">
      
      
        
        
        
          
            
          
        
        
        <a
          href="/posts/"
          class="nav-link 
            text-muted-foreground hover:text-primary hover:bg-primary/10
           focus:ring-primary/20 relative flex items-center gap-3 rounded-md px-4 py-3 text-sm font-medium transition-all duration-200 ease-out hover:translate-x-1 focus:ring-2 focus:outline-none"
          role="menuitem"
          >
          
            
  <svg class="h-5 w-5"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="nav.posts">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 20H5a2 2 0 01-2-2V6a2 2 0 012-2h10a2 2 0 012 2v1m2 13a2 2 0 01-2-2V7m2 13a2 2 0 002-2V9a2 2 0 00-2-2h-2m-4-3H9M7 16h6M7 8h6v4H7V8z" />

</svg>
          
          <span
            >
              게시글
            </span
          >
        </a>
      
        
        
        
          
            
          
        
        
        <a
          href="/categories/"
          class="nav-link 
            text-muted-foreground hover:text-primary hover:bg-primary/10
           focus:ring-primary/20 relative flex items-center gap-3 rounded-md px-4 py-3 text-sm font-medium transition-all duration-200 ease-out hover:translate-x-1 focus:ring-2 focus:outline-none"
          role="menuitem"
          >
          
            
  <svg class="h-5 w-5"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="nav.categories">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10" />

</svg>
          
          <span
            >
              카테고리
            </span
          >
        </a>
      
        
        
        
          
            
          
        
        
        <a
          href="/tags/"
          class="nav-link 
            text-muted-foreground hover:text-primary hover:bg-primary/10
           focus:ring-primary/20 relative flex items-center gap-3 rounded-md px-4 py-3 text-sm font-medium transition-all duration-200 ease-out hover:translate-x-1 focus:ring-2 focus:outline-none"
          role="menuitem"
          >
          
            
  <svg class="h-5 w-5"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="nav.tags">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z" />

</svg>
          
          <span
            >
              태그
            </span
          >
        </a>
      
        
        
        
          
            
          
        
        
        <a
          href="/archives/"
          class="nav-link 
            text-muted-foreground hover:text-primary hover:bg-primary/10
           focus:ring-primary/20 relative flex items-center gap-3 rounded-md px-4 py-3 text-sm font-medium transition-all duration-200 ease-out hover:translate-x-1 focus:ring-2 focus:outline-none"
          role="menuitem"
          >
          
            
  <svg class="h-5 w-5"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="nav.archives">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 8h14M5 8a2 2 0 110-4h14a2 2 0 110 4M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8m-9 4h4" />

</svg>
          
          <span
            >
              아카이브
            </span
          >
        </a>
      
    </nav>
  </div>
</div>


      
      <div class="flex items-center space-x-2">
        
        
<div class="relative">
  <button id="language-toggle"
    class="dropdown-toggle border-border bg-background text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex h-10 w-10 items-center justify-center rounded-lg border transition-all duration-300 ease-out hover:scale-105 focus:ring-2 focus:outline-none active:scale-95"
    data-dropdown-type="language"
    aria-label="언어 변경"
    aria-expanded="false"
    aria-haspopup="true">
      
  <svg class="h-5 w-5 relative z-10"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="언어 변경">
	<path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m5 8l6 6m-7 0l6-6l2-3M2 5h12M7 2h1m14 20l-5-10l-5 10m2-4h6" />
</svg></button>

  
  <div id="language-dropdown"
    class="dropdown-menu border-border bg-popover/95 absolute top-12 right-0 z-[60] hidden w-40 rounded-lg border p-1 shadow-lg backdrop-blur-sm transition-all duration-200 ease-out"
    data-dropdown-type="language"
    role="menu"
    aria-labelledby="language-toggle"><a href="/ko/" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none" role="menuitem" aria-current="true"><span class="font-medium">한국어</span></a><a href="/en/" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none" role="menuitem"><span class="font-medium">English</span></a></div>
</div>

        
        
<div class="relative">
  <button id="color-scheme-toggle"
    class="dropdown-toggle border-border bg-background text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex h-10 w-10 items-center justify-center rounded-lg border transition-all duration-300 ease-out hover:scale-105 focus:ring-2 focus:outline-none active:scale-95"
    data-dropdown-type="color-scheme"
    aria-label="테마 변경"
    aria-expanded="false"
    aria-haspopup="true">
      
  <svg class="h-5 w-5 relative z-10"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="테마 변경">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zM21 5a2 2 0 00-2-2h-4a2 2 0 00-2 2v6a2 2 0 002 2h4a2 2 0 002-2V5z" />

</svg></button>

  
  <div id="color-scheme-dropdown"
    class="dropdown-menu border-border bg-popover/95 absolute top-12 right-0 z-[60] hidden w-44 rounded-lg border p-1 shadow-lg backdrop-blur-sm transition-all duration-200 ease-out"
    data-dropdown-type="color-scheme"><button data-color-scheme="claude" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Default</span></button><button data-color-scheme="default" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>White</span></button><button data-color-scheme="bumblebee" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Bumblebee</span></button><button data-color-scheme="emerald" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Emerald</span></button><button data-color-scheme="nord" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Nord</span></button><button data-color-scheme="sunset" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Sunset</span></button><button data-color-scheme="abyss" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Abyss</span></button><button data-color-scheme="dracula" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Dracula</span></button><button data-color-scheme="amethyst" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Amethyst</span></button><button data-color-scheme="slate" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Slate</span></button><button data-color-scheme="twitter" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Twitter</span></button></div>
</div>

        
        
<div class="relative">
  <button id="theme-toggle"
    class="dropdown-toggle border-border bg-background text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex h-10 w-10 items-center justify-center rounded-lg border transition-all duration-300 ease-out hover:scale-105 focus:ring-2 focus:outline-none active:scale-95"
    data-dropdown-type="theme"
    aria-label="테마 변경"
    aria-expanded="false"
    aria-haspopup="true">
      
      
  <svg class="h-5 w-5 sun-icon hidden relative z-10"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="라이트">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" />

</svg>
      
      
  <svg class="h-5 w-5 moon-icon hidden relative z-10"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="다크">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" />

</svg>
      
      
  <svg class="h-5 w-5 system-icon hidden relative z-10"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="시스템">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />

</svg></button>

  
  <div id="theme-dropdown"
    class="dropdown-menu border-border bg-popover/95 absolute top-12 right-0 z-[60] hidden w-40 rounded-lg border p-1 shadow-lg backdrop-blur-sm transition-all duration-200 ease-out"
    data-dropdown-type="theme"><button data-theme="light" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none">
  <svg class="h-5 w-5 mr-3 h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="라이트">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" />

</svg><span>라이트</span></button><button data-theme="dark" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none">
  <svg class="h-5 w-5 mr-3 h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="다크">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" />

</svg><span>다크</span></button><button data-theme="system" class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none">
  <svg class="h-5 w-5 mr-3 h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="시스템">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />

</svg><span>시스템</span></button></div>
</div>
      </div>
    </div>
  </div>
</header>


    <main class="mx-auto max-w-4xl px-4 py-6">
      
  
  <nav
  class="breadcrumb mb-4 md:mb-6 py-1"
  aria-label="경로">
  <ol class="text-muted-foreground flex items-center space-x-1 md:space-x-2 text-sm overflow-x-auto whitespace-nowrap scrollbar-hide py-1">
    
    <li class="flex-shrink-0">
      <a
        href="/"
        class="text-muted-foreground hover:text-primary hover:bg-primary/10 flex items-center gap-0.5 md:gap-1 rounded-lg px-1 md:px-3 py-0.5 md:py-1.5 transition-all duration-200 ease-out hover:-translate-y-0.5 hover:scale-[1.02]">
        
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="홈">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m3 12 2-2m0 0 7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" />

</svg>
        <span class="max-w-[4rem] md:max-w-none truncate">홈</span>
      </a>
    </li>

    
    
      <li class="flex items-center gap-1 md:gap-2 min-w-0">
        <span class="text-muted-foreground/50 flex-shrink-0"
          >
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
</svg>
        </span>

        
          
          <div class="flex items-center gap-1 md:gap-2 min-w-0">
            
              
              <a
                href="/posts"
                class="text-muted-foreground hover:text-primary hover:bg-primary/10 flex items-center gap-0.5 md:gap-1 rounded-lg px-1 md:px-3 py-0.5 md:py-1.5 transition-all duration-200 ease-out hover:-translate-y-0.5 hover:scale-[1.02] flex-shrink-0">
                
                  
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 20H5a2 2 0 01-2-2V6a2 2 0 012-2h10a2 2 0 012 2v1m2 13a2 2 0 01-2-2V7m2 13a2 2 0 002-2V9a2 2 0 00-2-2h-2m-4-3H9M7 16h6M7 8h6v4H7V8z" />

</svg>
                  <span class="max-w-[3rem] md:max-w-none truncate">게시글</span>
                
              </a>
              <span class="text-muted-foreground/50 flex-shrink-0"
                >
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
</svg></span
              >
            
            
            <span class="text-foreground flex items-center gap-0.5 md:gap-1 font-medium min-w-0">
              
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
</svg>
              <span class="max-w-[8rem] md:max-w-[16rem] lg:max-w-none truncate">Keyformer KV Cache Reduction through Key Tokens Selection for Efficient Generative Inference</span>
            </span>
          </div>
        
      </li>
    

  </ol>
</nav>



  


  
  <header class="mb-8">
    


<div class="post-meta">
  
  <h1 class="text-foreground mb-6 text-3xl leading-tight font-bold md:text-4xl">
    Keyformer KV Cache Reduction through Key Tokens Selection for Efficient Generative Inference
  </h1>

  
  


  
  <div class="bg-card border-border flex flex-col gap-4 rounded-xl border p-6">
    
    <div
      class="text-muted-foreground flex flex-wrap items-center gap-4 text-sm">
      
      <div class="flex items-center gap-2">
        
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="작성일"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
</svg>
        <time datetime="2024-10-31">
          2024년 10월 31일
        </time>
      </div>

      
      


      
      
        <div class="flex items-center gap-2">
          
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="읽는 시간"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
</svg>
          <span
            >15 분</span
          >
        </div>
      


      
      
        <div class="flex items-center gap-2">
          
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="단어 수"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h7" />
</svg>
          <span>7411 단어</span>
        </div>
      

    </div>

    
    
      <div class="flex flex-wrap items-center gap-4">
        
        
          <div class="flex items-center gap-2">
            
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="카테고리"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z" />
</svg>
            <span class="text-muted-foreground mr-2 text-sm"
              >카테고리:</span
            >
            <div class="flex flex-wrap gap-2">
              
                <a
                  href="/categories/paper-review/"
                  class="bg-primary/10 text-primary hover:bg-primary/20 focus:ring-primary/20 inline-flex items-center rounded-full px-3 py-1 text-sm font-medium transition-all duration-200 ease-out hover:-translate-y-0.5 hover:scale-105 hover:shadow-md focus:ring-2 focus:outline-none">
                  paper-review
                </a>
              
                <a
                  href="/categories/with-gpt/"
                  class="bg-primary/10 text-primary hover:bg-primary/20 focus:ring-primary/20 inline-flex items-center rounded-full px-3 py-1 text-sm font-medium transition-all duration-200 ease-out hover:-translate-y-0.5 hover:scale-105 hover:shadow-md focus:ring-2 focus:outline-none">
                  with-gpt
                </a>
              
            </div>
          </div>
        


        
        

      </div>
    


    
    

  </div>
</div>

  </header>

  
  <article class="prose prose-neutral dark:prose-invert mb-12 max-w-none">
    <p>논문 : <a href="https://arxiv.org/abs/2403.09054">https://arxiv.org/abs/2403.09054</a></p>
<p>개인의견 : 예전부터 KV cache중에 핵심이 되는 내용만 잘 선택하면 오버헤드를 줄일수 있지 않을까라고 생각했는데 핵심 토큰만 가지고 이러한 방법을 구현한 논문입니다.
이러한 논문을 볼때 마다 항상 과연 정확도에 얼마나 영향을 줄까라는 의심이 생길수 밖에 없지만 이렇게 알고리즘쪽에서 경량화를 많이 해주면 좋겠네요</p>
<p>아래글은 Scholar GPT와 대화를 나눈 내용입니다.</p>
<h1 id="q--논문의-핵심-내용과-강점-알고리즘-설명-그리고-한계점">Q : 논문의 핵심 내용과 강점, 알고리즘 설명, 그리고 한계점</h1>
<h1 id="answer-">Answer :</h1>
<h3 id="논문의-주요-내용-강점-독창성-알고리즘-및-한계점">논문의 주요 내용, 강점, 독창성, 알고리즘 및 한계점</h3>
<p>논문 **&ldquo;Keyformer: KV Cache reduction through key tokens selection for Efficient Generative Inference&rdquo;**는 대규모 언어 모델의 생성 추론 효율성을 개선하기 위해 <strong>핵심 토큰을 선택하여 KV Cache(키-값 캐시)를 줄이는 Keyformer 기법</strong>을 제안하고 있습니다.</p>
<h4 id="강점-및-독창성">강점 및 독창성</h4>
<ol>
<li>
<p><strong>KV Cache 최적화</strong>: Keyformer는 KV Cache의 크기를 줄여 메모리 사용량을 최적화합니다. 대부분의 생성 추론 단계에서 <strong>90% 이상의 주의(attention) 가중치가 일부 특정 토큰(핵심 토큰)에 집중</strong>됨을 이용하여 불필요한 토큰을 캐시에서 제외하고 중요한 토큰만 남깁니다.</p>
</li>
<li>
<p><strong>효율성 증가</strong>: 이를 통해 KV Cache의 크기와 메모리 대역폭을 줄여도 정확도를 유지하면서 <strong>추론 속도를 2.1배, 토큰 생성 처리량을 2.4배 향상</strong>시킬 수 있습니다. 이는 특히 긴 문맥의 요약이나 대화형 생성 작업에서 효과적입니다.</p>
</li>
<li>
<p><strong>정확도 유지</strong>: Keyformer는 기존 방법들에 비해 성능 손실을 최소화하면서도 효율을 높이는 독창적인 방식으로, 다른 모델들과 비교해 정확도 저하가 거의 없이 성능을 유지합니다.</p>
</li>
</ol>
<h4 id="핵심-알고리즘-설명-예시-포함">핵심 알고리즘 설명 (예시 포함)</h4>
<p>Keyformer는 다음과 같은 과정을 통해 핵심 토큰을 식별하고 KV Cache 크기를 줄입니다.</p>
<ol>
<li>
<p><strong>주의 가중치 계산 및 핵심 토큰 선택</strong>: 모델이 입력된 텍스트에서 주의 가중치가 높은 핵심 토큰을 선택합니다. 예를 들어, 문장이 &ldquo;The quick brown fox jumps over the lazy dog&quot;이라면 &lsquo;fox&rsquo;, &lsquo;jumps&rsquo;, &lsquo;dog&rsquo; 같은 중요한 키워드가 핵심 토큰으로 선택될 수 있습니다.</p>
</li>
<li>
<p><strong>Gumbel 분포를 활용한 로짓 정규화</strong>: 선택된 핵심 토큰이 특정 관심 영역에 집중되도록 Gumbel 분포를 사용하여 주의 가중치를 조정합니다. 이는 특정 토큰들이 다른 토큰들보다 중요하게 다뤄지도록 도와줍니다.</p>
</li>
<li>
<p><strong>온도 매개변수 사용</strong>: 온도 매개변수 τ를 활용해 분포의 균일성을 제어하고, 각 토큰의 중요성을 조절하여 캐시 공간에서 중요한 토큰들이 유지될 확률을 높입니다.</p>
</li>
<li>
<p><strong>감소된 KV Cache 적용</strong>: 핵심 토큰과 최신 토큰(예: 최근 5개의 단어)을 KV Cache에 유지하고, 불필요한 토큰은 캐시에서 제거하여 메모리 사용을 줄입니다. 예를 들어, 길이 2048의 입력에서 50%의 KV Cache를 줄일 경우, 핵심 토큰과 최신 토큰만 유지하여 나머지는 캐시에서 제외합니다.</p>
</li>
</ol>
<h4 id="한계점">한계점</h4>
<ol>
<li>
<p><strong>주의 가중치 편향</strong>: 핵심 토큰을 선택하는 데 있어 주의 가중치의 편향이 발생할 수 있습니다. 특히 긴 문맥에서 초기 토큰에 과도한 중요성이 부여될 가능성이 있어 모든 문맥을 완전히 이해하는 데 한계가 있을 수 있습니다.</p>
</li>
<li>
<p><strong>정규화로 인한 계산 복잡도 증가</strong>: Gumbel 분포를 활용한 로짓 정규화 과정은 추가적인 계산을 요구하며, 이로 인해 일부 성능 저하가 발생할 수 있습니다.</p>
</li>
<li>
<p><strong>일부 문맥에서 정확도 손실 가능성</strong>: KV Cache 크기를 줄임으로써 일부 경우에서는 문맥 정보가 손실될 수 있어, 모든 문장 구조나 복잡한 맥락에서 높은 정확도를 유지하지 못할 가능성도 존재합니다.</p>
</li>
</ol>
<p>Keyformer는 대규모 언어 모델의 효율적인 생성 추론을 위해 주의 가중치에 기반한 중요한 토큰을 선택해 캐시를 줄이는 혁신적인 접근법을 제공합니다. 이로 인해 기존의 방법에 비해 높은 효율성과 성능을 유지하면서도 메모리 사용량을 절감하는 성과를 보여줍니다</p>
<h1 id="q--figure-6-the-overview-of-keyformer-부분을-조금-더-자세하게-설명해줘-그리고-전체적으로는-attention을-attention하는-구조라고-생각되는데-잘-이해한게-맞을까">Q : Figure 6. The overview of Keyformer 부분을 조금 더 자세하게 설명해줘 그리고 전체적으로는 attention을 attention하는 구조라고 생각되는데 잘 이해한게 맞을까?</h1>
<h1 id="answer--1">Answer :</h1>
<h3 id="figure-6-keyformer-개요---상세-설명">Figure 6: Keyformer 개요 - 상세 설명</h3>
<p>Figure 6은 Keyformer 알고리즘의 전체적인 구조를 보여주는 그림으로, 각 단계별로 Keyformer가 <strong>KV Cache를 효율적으로 관리하여 메모리 사용량을 줄이면서 성능을 높이는 방식</strong>을 설명합니다. 이를 단계별로 자세히 설명하겠습니다:</p>
<ol>
<li>
<p><strong>초기 디코딩 단계 (Decoding Step 1)</strong></p>
<ul>
<li>Keyformer의 첫 번째 디코딩 단계에서는 <strong>n개의 모든 토큰</strong>을 대상으로 Key 및 Value를 계산하여 KV Cache에 저장합니다. 이 단계는 텍스트 생성의 첫 번째 토큰을 예측하기 위한 준비 단계입니다.</li>
<li>이때, Keyformer는 KV Cache에서 **최근 윈도우(recent window)**와 **핵심 토큰(key tokens)**만 유지하고 나머지 토큰은 제거하여 KV Cache의 크기를 줄이기 위한 구조를 준비합니다.</li>
</ul>
</li>
<li>
<p><strong>Gumbel Noise 추가와 핵심 토큰 선택</strong></p>
<ul>
<li>Keyformer는 특정 토큰이 중요할 가능성을 높이기 위해 Gumbel 분포를 활용하여 노이즈(분포값)를 추가합니다. 이렇게 함으로써, <strong>특정 중요 토큰들이 다른 토큰들보다 선택될 확률을 높이게 됩니다</strong>.</li>
<li>Keyformer의 **Score Function (fθ)**는 이 Gumbel 기반의 정규화된 값을 사용하여 토큰의 중요도를 평가하고, <strong>상위 (k-w) 개의 핵심 토큰</strong>을 선정합니다. 이 과정은 선택된 최근 윈도우의 (w)개의 토큰과 결합하여 다음 단계에서 사용될 <strong>축소된 KV Cache</strong>를 구성합니다.</li>
</ul>
</li>
<li>
<p><strong>토큰 생성 단계에서의 축소된 KV Cache 활용 (Decoding Step 2)</strong></p>
<ul>
<li>다음 디코딩 단계에서는 첫 번째 단계에서 만들어진 <strong>축소된 KV Cache</strong>를 사용합니다. 첫 번째 생성된 토큰은 KV Cache에 있는 k개의 토큰에만 주의를 집중하여 효율성을 높입니다.</li>
<li>각 디코딩 단계에서 최근 윈도우는 한 칸씩 오른쪽으로 이동하며, 그 과정에서 Score Function (fθ)가 업데이트되어 새로운 핵심 토큰을 식별하고, <strong>필요한 경우 최근 윈도우와 핵심 토큰의 조합으로 KV Cache를 업데이트</strong>합니다.</li>
<li>이 단계에서는 온도 파라미터 (τ)가 한 단계씩 증가하면서 점차적으로 확률 분포를 부드럽게 조정합니다. 이는 텍스트 생성이 진행됨에 따라 캐시에 남아있는 토큰들이 보다 <strong>일관성 있는 확률 분포를 가지도록 하기 위함</strong>입니다.</li>
</ul>
</li>
<li>
<p><strong>Keyformer의 지속적 Score Function 축적 및 토큰 유지</strong></p>
<ul>
<li>Keyformer는 각 디코딩 단계의 Score Function을 축적하여, <strong>이전에 생성된 토큰과의 일관성을 바탕으로 핵심 토큰을 식별</strong>합니다. 이렇게 함으로써, 단순히 현재 토큰과 이전 토큰 간의 관계뿐만 아니라, <strong>생성된 모든 토큰 간의 일관성</strong>을 반영하여 캐시 내에서 중요한 토큰을 유지할 수 있습니다.</li>
</ul>
</li>
</ol>
<h3 id="attention-on-attention-구조---이해가-맞는지">&ldquo;Attention on Attention&rdquo; 구조 - 이해가 맞는지</h3>
<p>맞습니다. Keyformer는 기존 Attention Mechanism의 구조를 개선하여, 각 토큰이 가지는 중요도에 따라 선택적으로 주의를 집중하는 방식으로 작동합니다. 이를 **&ldquo;attention을 attention하는 구조&rdquo;**로 볼 수 있습니다. 특히, 모든 토큰이 아닌 중요한 토큰에만 집중함으로써 <strong>주의 메커니즘 자체의 효율성을 높이는 역할</strong>을 합니다.</p>
<p>Keyformer는 각 토큰이 얼마나 많은 attention을 받는지를 기반으로 중요도를 계산하고, <strong>이 중요한 토큰들에 대한 캐싱을 최적화</strong>함으로써 <strong>필요 없는 메모리 접근을 줄여 추론 효율성을 극대화</strong>하는 접근 방식입니다.</p>
<h1 id="q--section-3-keyformer-intuition-and-design-의-전체적인-흐름과-gumbel-logit-adjustment같은-방법을-사용하는-이유를-예시를-추가해서-자세하게-설명해줘">Q : section 3 KEYFORMER: INTUITION AND DESIGN 의 전체적인 흐름과 Gumbel Logit Adjustment같은 방법을 사용하는 이유를 예시를 추가해서 자세하게 설명해줘</h1>
<h3 id="section-3-keyformer의-직관과-설계---개요와-주요-기법-설명">Section 3: Keyformer의 직관과 설계 - 개요와 주요 기법 설명</h3>
<p>논문의 3장은 Keyformer의 설계 원리와 이를 효과적으로 구현하기 위한 기법을 설명하고 있습니다. 특히, <strong>Keyformer가 왜 특정 토큰만 선택하여 캐싱하고, 이를 어떻게 효율적으로 관리하는지</strong>에 대해 설명하고 있으며, 이 과정에서 Gumbel Logit Adjustment를 포함한 여러 기법들이 사용됩니다.</p>
<h3 id="1-keyformer-설계의-전체적인-흐름">1. Keyformer 설계의 전체적인 흐름</h3>
<p>Keyformer는 <strong>긴 문맥을 처리하는 언어 모델의 효율성을 높이기 위해 등장</strong>했습니다. 기본 아이디어는 LLM에서 생성 추론 과정 중 모든 토큰이 동일한 중요도를 가지지 않는다는 점을 활용하는 것입니다. 예를 들어, 긴 문장에서 문맥을 이해하는 데 있어 중요한 정보만 담고 있는 특정 토큰에 주의(attention)가 집중되는 경향이 있습니다. 이를 **핵심 토큰(Key Tokens)**이라고 부르며, Keyformer는 이러한 토큰에만 집중적으로 주의를 두고 KV Cache에 저장하여 효율성을 극대화하려 합니다.</p>
<p>이를 위해, Keyformer는 <strong>이전 단계에서 중요도가 높다고 판단된 핵심 토큰과 최근 생성된 토큰만을 KV Cache에 저장</strong>하고, 나머지 덜 중요한 토큰은 제외하여 메모리 사용을 줄입니다. 이때, 어떤 토큰이 중요한지 결정하는 과정에서 <strong>Gumbel Logit Adjustment</strong> 같은 정규화 기법을 사용해 각 토큰의 중요도를 평가합니다.</p>
<h3 id="2-gumbel-logit-adjustment의-사용-이유와-효과">2. Gumbel Logit Adjustment의 사용 이유와 효과</h3>
<h4 id="왜-gumbel-logit-adjustment를-사용하는가">왜 Gumbel Logit Adjustment를 사용하는가?</h4>
<ol>
<li>
<p><strong>주의 가중치 편향 해소</strong>: LLM은 초기 토큰에 대해 높은 주의 가중치를 주는 경향이 있습니다. 예를 들어, <strong>문장의 시작 부분에 있는 단어</strong>가 더 중요한 정보로 평가될 수 있습니다. 그러나 이러한 편향은 후반부의 중요한 정보가 반영되지 않는 문제를 야기할 수 있습니다.</p>
</li>
<li>
<p><strong>최대값을 찾기 위한 분포 특성</strong>: Gumbel 분포는 확률론에서 <strong>최대값을 찾기 위한 분포로 적합</strong>합니다. Keyformer의 목적은 전체 토큰 중 가장 중요한 몇 가지 토큰을 선별하는 것이므로, Gumbel 분포를 활용하면 초기 값에 편향되지 않고 중요한 정보를 가진 토큰들을 선택할 수 있습니다.</p>
</li>
</ol>
<h4 id="예시를-통한-gumbel-logit-adjustment-설명">예시를 통한 Gumbel Logit Adjustment 설명</h4>
<p>다음은 Gumbel Logit Adjustment의 동작 원리를 간단한 예를 통해 설명합니다.</p>
<ul>
<li>
<p>예를 들어, &ldquo;The quick brown fox jumps over the lazy dog&quot;이라는 문장이 있다고 가정합시다.</p>
</li>
<li>
<p>이 문장에서 중요한 정보는 <strong>&ldquo;fox&rdquo;</strong>, <strong>&ldquo;jumps&rdquo;</strong>, **&ldquo;dog&rdquo;**일 수 있습니다. Keyformer는 이 토큰들에 대한 주의 가중치를 높이기 위해 <strong>Gumbel 분포를 사용하여 각 토큰의 중요도를 정규화</strong>합니다.</p>
</li>
<li>
<p>각 토큰이 가지는 주의 가중치를 기반으로 로짓 값을 계산할 때, Gumbel 분포를 사용해 노이즈를 추가하여, 중요도가 높은 토큰들이 최종적으로 높은 점수를 갖도록 합니다.</p>
<p>이를 수식으로 나타내면 다음과 같습니다:</p>
<p>[
y_i = x_i + \zeta_i
]</p>
<p>여기서 ( y_i )는 정규화된 로짓 값이고, ( x_i )는 각 토큰의 원래 로짓 값이며, ( \zeta_i )는 Gumbel 분포에서 나온 노이즈 값입니다. 이 방식으로 중요도가 높은 토큰은 더 큰 값을 갖게 되고, Keyformer는 이 정보를 통해 핵심 토큰을 선택합니다.</p>
</li>
</ul>
<h4 id="gumbel-softmax의-추가적인-장점">Gumbel Softmax의 추가적인 장점</h4>
<ul>
<li><strong>불균일한 확률 분포 보정</strong>: 단순히 모든 토큰에 동일한 확률을 주는 것이 아닌, 중요도가 높은 토큰에게 더 높은 확률을 부여할 수 있도록 <strong>Gumbel Softmax</strong>를 사용합니다.</li>
<li><strong>유연한 온도 매개변수 조정</strong>: 온도 파라미터 ( \tau )를 통해 확률 분포의 경직성을 조정할 수 있습니다. 예를 들어, 낮은 온도일수록 특정 토큰에 주의가 집중되고, 높은 온도일수록 확률 분포가 고르게 퍼져 모든 토큰에 비슷한 주의를 줄 수 있습니다.</li>
</ul>
<h3 id="3-gumbel-logit-adjustment를-통한-핵심-토큰-선택-과정">3. Gumbel Logit Adjustment를 통한 핵심 토큰 선택 과정</h3>
<ol>
<li>
<p><strong>점수 함수 계산</strong>: Keyformer는 각 토큰의 <strong>주의 가중치에 Gumbel 분포 기반의 노이즈를 추가</strong>하여, 중요도가 높은 토큰에 더 큰 값이 주어지도록 합니다.</p>
</li>
<li>
<p><strong>온도 파라미터 조정</strong>: 이후 단계마다 온도 파라미터를 점진적으로 증가시키면서, 현재 단계에서는 중요한 토큰에 더 높은 주의를 주고, 이후 단계에서는 보다 많은 토큰에 고르게 주의를 두도록 확률을 조정합니다.</p>
</li>
<li>
<p><strong>최종 핵심 토큰 선별</strong>: 최종적으로, 계산된 점수 함수에 따라 가장 높은 점수를 가진 토큰들이 KV Cache에 남아 중요한 정보로서의 역할을 하게 됩니다.</p>
</li>
</ol>
<h3 id="요약">요약</h3>
<p>Keyformer는 <strong>주의 메커니즘 내에서 중요한 정보를 갖는 핵심 토큰에 집중</strong>하여 효율적으로 메모리를 사용할 수 있도록 설계되었습니다. Gumbel Logit Adjustment는 <strong>중요한 토큰을 효과적으로 선택</strong>하는 데 필요한 확률 분포를 제공하며, 이를 통해 전체적인 추론 성능을 높이는 데 기여합니다.</p>
<h1 id="q-알고리즘-1-섹션을-자세하게-코드와-예시를-추가해서-설명해주겠니">Q: 알고리즘 1 섹션을 자세하게 코드와 예시를 추가해서 설명해주겠니?</h1>
<p>알고리즘 1은 Keyformer가 <strong>KV Cache의 크기를 줄이면서도 중요한 토큰을 유지하는 방법</strong>을 구현한 단계별 프로세스를 나타냅니다. 이를 통해 Keyformer는 주어진 문장 내에서 중요도가 높은 토큰을 선택하고, 메모리 사용량을 줄이면서도 정확도를 유지합니다. 아래에서는 이 알고리즘을 코드와 예시를 통해 설명하겠습니다.</p>
<h3 id="알고리즘-1-keyformer의-단계별-프로세스">알고리즘 1: Keyformer의 단계별 프로세스</h3>
<h4 id="pseudo-code-설명">Pseudo-Code 설명</h4>
<p>알고리즘의 주요 변수:</p>
<ul>
<li>( k ): KV Cache의 최대 크기 (즉, 저장할 토큰의 수)</li>
<li>( w ): 최근 토큰 윈도우의 크기 (즉, 최신 토큰들 중에서 유지할 토큰의 수)</li>
<li>( T ): 생성할 텍스트의 길이 (즉, 총 생성할 토큰 수)</li>
<li>( \tau_{init} )과 ( \tau_{end} ): 온도 파라미터의 시작 및 종료 값</li>
<li>( S_n ): 프롬프트 시퀀스의 초기 길이</li>
</ul>
<h4 id="코드-기반-알고리즘-설명">코드 기반 알고리즘 설명</h4>
<div
  class="code-block-container border-border bg-card my-6 overflow-hidden rounded-xl border shadow-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:shadow-md">
  
  <div
    class="code-block-header bg-muted/30 border-border flex items-center justify-between border-b px-4 py-3">
    
    <div class="flex items-center gap-2">
      <div class="text-muted-foreground flex-shrink-0">
        
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4" />
</svg>
      </div>
      <span class="text-muted-foreground text-sm font-medium">
        PYTHON
      </span>
    </div>

    
    <div class="flex items-center gap-2">
      <button
          class="collapse-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none"
          data-code-id="code-0"
          data-default-state="expanded"
          data-collapsed="false"
          data-auto-collapse-lines="30"
          data-auto-collapse-height="400"
          data-collapsed-height="120"
          title="접기"
          aria-label="접기">
          <span class="collapse-icon">
            
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z"/></svg>
          </span>
          <span class="collapse-text hidden sm:inline"
            >접기</span
          >
        </button>
      <button
        class="copy-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none"
        data-code-id="code-0"
        title="복사"
        aria-label="복사">
        <span class="copy-icon">
          
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
</svg>
        </span>
        <span class="copy-text hidden sm:inline"
          >복사</span
        >
      </button>
    </div>
  </div>

  
  <div class="code-block-content relative" id="code-0">
    <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="c1"># 알고리즘 1 Keyformer</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="c1"># 입력 변수 설정</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="n">k</span> <span class="o">=</span> <span class="n">KV_cache_size</span>               <span class="c1"># KV Cache 크기</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="n">w</span> <span class="o">=</span> <span class="n">recent_window</span>               <span class="c1"># 최신 윈도우 크기</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="n">T</span> <span class="o">=</span> <span class="n">text_generation_length</span>      <span class="c1"># 생성할 텍스트 길이</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="n">tau_init</span><span class="p">,</span> <span class="n">tau_end</span> <span class="o">=</span> <span class="n">init_temp</span><span class="p">,</span> <span class="n">end_temp</span> <span class="c1"># 온도 초기값과 종료값</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="n">S_n</span> <span class="o">=</span> <span class="n">prompt_sequence_length</span>    <span class="c1"># 프롬프트 시퀀스 길이</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">
</span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="c1"># 초기화</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="n">f_theta</span> <span class="o">=</span> <span class="mi">0</span>                     <span class="c1"># Score Function 초기화</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="n">tau</span> <span class="o">=</span> <span class="n">tau_init</span>                  <span class="c1"># 온도 매개변수 초기화</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="n">delta_tau</span> <span class="o">=</span> <span class="p">(</span><span class="n">tau_end</span> <span class="o">-</span> <span class="n">tau_init</span><span class="p">)</span> <span class="o">/</span> <span class="n">T</span>  <span class="c1"># 온도의 단계적 증가량 설정</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="n">zeta</span> <span class="o">=</span> <span class="n">gumbel_distribution</span><span class="p">()</span>    <span class="c1"># Gumbel 노이즈 초기화</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">
</span></span><span class="line"><span class="ln">16</span><span class="cl"><span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">T</span><span class="p">):</span>               <span class="c1"># 각 디코딩 단계에서</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">    <span class="n">tau</span> <span class="o">=</span> <span class="n">tau_init</span> <span class="o">+</span> <span class="n">t</span> <span class="o">*</span> <span class="n">delta_tau</span>  <span class="c1"># 온도 매개변수 업데이트</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">    
</span></span><span class="line"><span class="ln">19</span><span class="cl">    <span class="k">if</span> <span class="n">phase</span> <span class="o">==</span> <span class="s1">&#39;prompt&#39;</span><span class="p">:</span>         <span class="c1"># 프롬프트 처리 단계인 경우</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">        <span class="n">x_i</span> <span class="o">=</span> <span class="n">compute_logits</span><span class="p">(</span><span class="n">Q_i</span><span class="p">,</span> <span class="n">K_all</span><span class="p">,</span> <span class="n">S_n</span><span class="p">)</span>  <span class="c1"># 모든 토큰에 대해 로짓 계산</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">        <span class="n">m</span> <span class="o">=</span> <span class="n">n</span>                      <span class="c1"># 전체 시퀀스 길이로 설정</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">    <span class="k">else</span><span class="p">:</span>                          <span class="c1"># 생성 단계인 경우</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl">        <span class="n">x_i</span> <span class="o">=</span> <span class="n">compute_logits</span><span class="p">(</span><span class="n">Q_i</span><span class="p">,</span> <span class="n">K_selected</span><span class="p">,</span> <span class="n">S_k</span><span class="p">)</span>  <span class="c1"># KV Cache 내 선택된 토큰들에 대해 로짓 계산</span>
</span></span><span class="line"><span class="ln">24</span><span class="cl">        <span class="n">m</span> <span class="o">=</span> <span class="n">k</span>                      <span class="c1"># 선택된 KV Cache 길이로 설정</span>
</span></span><span class="line"><span class="ln">25</span><span class="cl">    
</span></span><span class="line"><span class="ln">26</span><span class="cl">    <span class="c1"># Score Function 업데이트</span>
</span></span><span class="line"><span class="ln">27</span><span class="cl">    <span class="n">f_theta</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="n">exp</span><span class="p">((</span><span class="n">x_i</span> <span class="o">+</span> <span class="n">zeta_i</span><span class="p">)</span> <span class="o">/</span> <span class="n">tau</span><span class="p">)</span> <span class="o">/</span> <span class="nb">sum</span><span class="p">(</span><span class="n">exp</span><span class="p">((</span><span class="n">x_j</span> <span class="o">+</span> <span class="n">zeta_j</span><span class="p">)</span> <span class="o">/</span> <span class="n">tau</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">))</span>
</span></span><span class="line"><span class="ln">28</span><span class="cl">
</span></span><span class="line"><span class="ln">29</span><span class="cl">    <span class="c1"># 최근 w개의 토큰 선택</span>
</span></span><span class="line"><span class="ln">30</span><span class="cl">    <span class="n">Sw</span> <span class="o">=</span> <span class="n">select_recent_tokens</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">31</span><span class="cl">    
</span></span><span class="line"><span class="ln">32</span><span class="cl">    <span class="c1"># 핵심 토큰 선택</span>
</span></span><span class="line"><span class="ln">33</span><span class="cl">    <span class="n">Skey</span> <span class="o">=</span> <span class="n">select_top_k_tokens</span><span class="p">(</span><span class="n">f_theta</span><span class="p">,</span> <span class="n">k</span> <span class="o">-</span> <span class="n">w</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">34</span><span class="cl">    
</span></span><span class="line"><span class="ln">35</span><span class="cl">    <span class="c1"># 최종 KV Cache 업데이트</span>
</span></span><span class="line"><span class="ln">36</span><span class="cl">    <span class="n">Sk</span> <span class="o">=</span> <span class="n">Skey</span> <span class="o">+</span> <span class="n">Sw</span>                <span class="c1"># 핵심 토큰과 최신 토큰을 합쳐 KV Cache 생성</span></span></span></code></pre></div>
    
    <div
      class="collapse-overlay to-card/90 pointer-events-none absolute inset-0 bg-gradient-to-b from-transparent via-transparent opacity-0 transition-opacity duration-300">
      <div
        class="text-muted-foreground bg-card/80 border-border/50 hover:bg-primary/10 hover:text-primary hover:border-primary/30 absolute bottom-4 left-1/2 -translate-x-1/2 cursor-pointer rounded-full border px-3 py-1.5 text-xs backdrop-blur-sm transition-all duration-200">
        클릭하여 더 보기
      </div>
    </div>
  </div>
</div>


<script>
(function() {
  const codeId = 'code-0';
  const copyBtn = document.querySelector('.copy-code-btn[data-code-id="' + codeId + '"]');
  const collapseBtn = document.querySelector('.collapse-code-btn[data-code-id="' + codeId + '"]');
  const codeContainer = document.getElementById(codeId);

  if (!codeContainer) return;

  
  if (copyBtn) {
    const copyIcon = copyBtn.querySelector('.copy-icon');
    const copyText = copyBtn.querySelector('.copy-text');

    copyBtn.addEventListener('click', async function() {
      try {
        
        let codeText = '';

        
        const codeTableCell = codeContainer.querySelector('.lntd:last-child code');
        if (codeTableCell) {
          codeText = codeTableCell.textContent || codeTableCell.innerText;
        } else {
          
          const codeElement = codeContainer.querySelector('code');
          if (codeElement) {
            
            const hasInlineLineNumbers = codeElement.querySelector('.ln');
            if (hasInlineLineNumbers) {
              
              const codeLines = codeElement.querySelectorAll('.cl');
              if (codeLines.length > 0) {
                codeText = Array.from(codeLines)
                  .map(line => {
                    const text = line.textContent || line.innerText;
                    
                    return text.replace(/\n+$/, '');
                  })
                  .join('\n')
                  .replace(/\n+$/, ''); 
              } else {
                
                const allText = codeElement.textContent || codeElement.innerText;
                codeText = allText.replace(/^\d+/gm, '').replace(/^\s+/gm, '');
              }
            } else {
              
              codeText = codeElement.textContent || codeElement.innerText;
            }
          } else {
            
            codeText = codeContainer.textContent || codeContainer.innerText;
          }
        }

        
        codeText = codeText.trim();

        
        await navigator.clipboard.writeText(codeText);

        
        copyIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M5 13l4 4L19 7\u0022 \/\u003e\n\u003c\/svg\u003e`;
        if (copyText) {
          copyText.textContent = '복사됨';
        }
        copyBtn.classList.add('text-green-600');

        
        setTimeout(() => {
          copyIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z\u0022 \/\u003e\n\u003c\/svg\u003e`;
          if (copyText) {
            copyText.textContent = '복사';
          }
          copyBtn.classList.remove('text-green-600');
        }, 2000);

      } catch (err) {
        console.error('复制失败:', err);

        
        const range = document.createRange();
        const codeElement = codeContainer.querySelector('code') || codeContainer;
        range.selectNodeContents(codeElement);
        const selection = window.getSelection();
        selection.removeAllRanges();
        selection.addRange(range);

        
        if (copyText) {
          copyText.textContent = '선택됨';
        }

        setTimeout(() => {
          if (copyText) {
            copyText.textContent = '복사';
          }
          selection.removeAllRanges();
        }, 2000);
      }
    });
  }

  
  if (collapseBtn) {
    const collapseIcon = collapseBtn.querySelector('.collapse-icon');
    const collapseText = collapseBtn.querySelector('.collapse-text');
    const collapseOverlay = codeContainer.querySelector('.collapse-overlay');

    
    let codeElement = codeContainer.querySelector('pre.chroma');
    if (!codeElement) {
      codeElement = codeContainer.querySelector('pre');
    }

    const defaultState = collapseBtn.dataset.defaultState || 'expanded';
    const isCollapsedAttr = collapseBtn.dataset.collapsed === 'true';
    const autoCollapseLines = parseInt(collapseBtn.dataset.autoCollapseLines) || 30;
    const autoCollapseHeight = parseInt(collapseBtn.dataset.autoCollapseHeight) || 400;
    const collapsedHeight = parseInt(collapseBtn.dataset.collapsedHeight) || 120;

    let isCollapsed = false;

    
    function initCollapse() {
      
      const shouldCollapse = isCollapsedAttr ||
                           defaultState === 'collapsed' ||
                           shouldAutoCollapse();

      if (shouldCollapse) {
        setCollapsed(true, false); 
      }
    }

    function shouldAutoCollapse() {
      
      if (codeElement) {
        const lines = codeElement.querySelectorAll('.line, .cl');
        const height = codeElement.offsetHeight;
        return lines.length > autoCollapseLines || height > autoCollapseHeight;
      }

      
      const containerHeight = codeContainer.offsetHeight;
      if (containerHeight > autoCollapseHeight) {
        return true;
      }

      
      const textContent = codeContainer.textContent || codeContainer.innerText || '';
      const estimatedLines = textContent.split('\n').length;
      return estimatedLines > autoCollapseLines;
    }

    function setCollapsed(collapsed, animate = true) {
      if (!collapseOverlay) return;

      isCollapsed = collapsed;

      if (collapsed) {
        
        codeContainer.style.maxHeight = collapsedHeight + 'px';
        codeContainer.style.overflow = 'hidden';
        collapseOverlay.style.opacity = '1';
        collapseOverlay.style.pointerEvents = 'auto';

        
        collapseIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath stroke-linecap=\u0022round\u0022 stroke-linejoin=\u0022round\u0022 stroke-width=\u00222\u0022 d=\u0022M19 9l-7 7-7-7\u0022 \/\u003e\n\u003c\/svg\u003e`;
        if (collapseText) {
          collapseText.textContent = '펼치기';
        }
        collapseBtn.title = '펼치기';

      } else {
        
        codeContainer.style.maxHeight = '';
        codeContainer.style.overflow = '';
        collapseOverlay.style.opacity = '0';
        collapseOverlay.style.pointerEvents = 'none';

        
        collapseIcon.innerHTML = `\n  \u003csvg class=\u0022h-3 w-3\u0022\n    fill=\u0022none\u0022\n    stroke=\u0022currentColor\u0022\n    viewBox=\u00220 0 24 24\u0022\u003e\u003cpath fill=\u0022currentColor\u0022 d=\u0022M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z\u0022\/\u003e\u003c\/svg\u003e`;
        if (collapseText) {
          collapseText.textContent = '접기';
        }
        collapseBtn.title = '접기';
      }

      
      if (animate) {
        codeContainer.style.transition = 'max-height 0.3s ease-out';
        setTimeout(() => {
          codeContainer.style.transition = '';
        }, 300);
      }
    }

    function toggleCollapse() {
      setCollapsed(!isCollapsed, true);
    }

    
    collapseBtn.addEventListener('click', toggleCollapse);

    
    if (collapseOverlay) {
      collapseOverlay.addEventListener('click', () => {
        if (isCollapsed) {
          setCollapsed(false, true);
        }
      });
    }

    
    initCollapse();
  }
})();
</script>
<h3 id="예시와-함께-단계별로-설명">예시와 함께 단계별로 설명</h3>
<p><strong>문장 예시</strong>: &ldquo;The quick brown fox jumps over the lazy dog&quot;이라는 문장을 프롬프트로 사용하여 Keyformer가 동작하는 과정을 단계별로 설명하겠습니다.</p>
<h4 id="단계-1-초기-설정">단계 1: 초기 설정</h4>
<ol>
<li>
<p><strong>입력 설정</strong>:</p>
<ul>
<li>KV Cache 크기 ( k = 5 ): 이 예제에서는 최대 5개의 토큰을 캐시에 저장할 수 있다고 가정합니다.</li>
<li>최근 윈도우 크기 ( w = 2 ): 최신 토큰 2개를 무조건 KV Cache에 저장하도록 설정합니다.</li>
<li>텍스트 생성 길이 ( T = 10 ): 10개의 토큰을 생성할 계획입니다.</li>
<li>온도 매개변수 ( \tau_{init} = 1 ), ( \tau_{end} = 2 ): 온도가 1에서 시작하여 점차 증가하도록 합니다.</li>
</ul>
</li>
<li>
<p><strong>초기화</strong>:</p>
<ul>
<li>( f_{\theta} )는 Score Function의 초기 값으로, 각 토큰의 중요도를 평가하기 위해 사용됩니다.</li>
<li>( \tau )는 초기 온도 값으로 시작하여 점진적으로 증가합니다.</li>
</ul>
</li>
</ol>
<h4 id="단계-2-첫-번째-디코딩-루프-디코딩-단계-t0">단계 2: 첫 번째 디코딩 루프 (디코딩 단계 t=0)</h4>
<ol>
<li>
<p><strong>프롬프트 처리 단계</strong>:</p>
<ul>
<li>모든 토큰에 대해 ( x_i = \text{compute_logits}(Q_i, K_{\text{all}}, S_n) )를 계산하여 로짓 값을 얻습니다. 예를 들어 &ldquo;The&rdquo;, &ldquo;quick&rdquo;, &ldquo;brown&rdquo; 등에 대한 로짓이 계산됩니다.</li>
</ul>
</li>
<li>
<p><strong>Score Function 업데이트</strong>:</p>
<ul>
<li>각 토큰에 대해 Gumbel 분포를 사용하여 노이즈를 추가한 다음 ( f_{\theta} )를 업데이트합니다.</li>
<li>예를 들어 &ldquo;fox&quot;와 &ldquo;dog&quot;가 높은 점수를 받아 핵심 토큰으로 선정될 수 있습니다.</li>
</ul>
</li>
<li>
<p><strong>최근 토큰 및 핵심 토큰 선택</strong>:</p>
<ul>
<li>최신 토큰 2개 (&ldquo;lazy&rdquo;, &ldquo;dog&rdquo;)는 <strong>무조건 KV Cache에 추가</strong>됩니다.</li>
<li>핵심 토큰 후보 중 상위 3개를 선택하여 (예: &ldquo;fox&rdquo;, &ldquo;jumps&rdquo;, &ldquo;quick&rdquo;) KV Cache에 포함합니다.</li>
</ul>
</li>
<li>
<p><strong>KV Cache 갱신</strong>:</p>
<ul>
<li>최종 KV Cache는 **&ldquo;fox&rdquo;, &ldquo;jumps&rdquo;, &ldquo;quick&rdquo;, &ldquo;lazy&rdquo;, &ldquo;dog&rdquo;**으로 갱신됩니다.</li>
</ul>
</li>
</ol>
<h4 id="단계-3-생성-단계-디코딩-단계-t1부터">단계 3: 생성 단계 (디코딩 단계 t=1부터)</h4>
<ol>
<li>
<p><strong>로짓 계산 및 온도 조정</strong>:</p>
<ul>
<li>디코딩 단계가 진행될수록 ( \tau )가 증가하여, 새로 추가되는 토큰의 중요도가 더 고르게 분포되도록 유도합니다.</li>
</ul>
</li>
<li>
<p><strong>Score Function 축적</strong>:</p>
<ul>
<li>Score Function ( f_{\theta} )는 이전 단계에서 얻은 중요도를 반영하여 각 토큰의 일관성을 평가합니다.</li>
</ul>
</li>
<li>
<p><strong>KV Cache 유지 및 업데이트</strong>:</p>
<ul>
<li>각 생성 단계에서 최신 토큰과 핵심 토큰이 계속해서 업데이트됩니다. 이를 통해 <strong>최적의 메모리 사용량을 유지하면서 중요한 정보를 잃지 않도록 보장</strong>합니다.</li>
</ul>
</li>
</ol>
<h3 id="요약-1">요약</h3>
<p>Keyformer 알고리즘은 Gumbel 분포를 사용하여 각 토큰의 중요도를 평가하고, 가장 중요한 토큰과 최신 토큰을 유지하는 방식으로 <strong>KV Cache의 크기를 줄이는 동시에 모델의 성능을 유지</strong>합니다.</p>
<h1 id="q--keyformer의-압축율은-어떻게-결정될-수-있을까-그리고-압축으로-인하여-정확도가-논문에서-설명한것과-달리-떨어지는-모델-구조-및-벤치마크가-있을까">Q : keyformer의 압축율은 어떻게 결정될 수 있을까? 그리고 압축으로 인하여 정확도가 논문에서 설명한것과 달리 떨어지는 모델 구조 및 벤치마크가 있을까?</h1>
<h1 id="answer">Answer</h1>
<h3 id="keyformer의-압축률-결정-요인">Keyformer의 압축률 결정 요인</h3>
<p>Keyformer의 압축률은 <strong>KV Cache에서 유지할 핵심 토큰과 최신 토큰의 수</strong>에 의해 결정됩니다. 이를 더 구체적으로 설명하자면:</p>
<ol>
<li>
<p><strong>핵심 토큰의 비율 (Key Token Ratio)</strong>:</p>
<ul>
<li>Keyformer는 문맥 이해에 중요한 핵심 토큰을 선정하여 KV Cache에 유지합니다. 예를 들어, 전체 토큰 수가 100이라면 핵심 토큰을 30%로 설정하여 <strong>최대 30개의 토큰만 캐시에 유지</strong>할 수 있습니다. 이는 필요에 따라 10%, 20% 등으로 조정할 수 있으며, 압축률은 선택된 비율에 따라 결정됩니다.</li>
<li>따라서 압축률은 <strong>핵심 토큰의 비율</strong>에 반비례하게 결정됩니다. 즉, 핵심 토큰 비율이 낮을수록 압축률은 높아집니다.</li>
</ul>
</li>
<li>
<p><strong>최근 윈도우 크기 (Recent Window Size)</strong>:</p>
<ul>
<li>Keyformer는 최신 정보의 중요성을 반영하기 위해 <strong>최근에 생성된 토큰을 일정 수 유지</strong>합니다. 이 또한 압축률에 영향을 미치는데, 최근 윈도우 크기를 크게 설정하면 KV Cache의 크기가 증가하므로 압축률이 떨어지고, 작게 설정하면 압축률이 높아집니다.</li>
</ul>
</li>
<li>
<p><strong>Gumbel Logit Adjustment의 온도 파라미터 (Temperature Parameter)</strong>:</p>
<ul>
<li>온도 파라미터 (\tau)는 토큰 선택의 고르게 분포될 정도를 조절합니다. 이 값이 높아지면 덜 중요한 토큰도 일정 확률로 선택되므로 핵심 토큰의 수가 늘어나게 되고, 결과적으로 <strong>압축률이 낮아질 수 있습니다</strong>.</li>
</ul>
</li>
</ol>
<h3 id="모델-구조-및-벤치마크에-따른-압축의-영향">모델 구조 및 벤치마크에 따른 압축의 영향</h3>
<p>Keyformer의 KV Cache 압축은 여러 모델과 벤치마크에서 테스트되었으나, 일부 구조에서는 예상보다 정확도가 떨어질 수 있습니다. 압축으로 인한 정확도 저하가 발생할 가능성이 있는 모델 구조와 벤치마크는 다음과 같습니다:</p>
<ol>
<li>
<p><strong>대화형 모델과 추론이 복잡한 벤치마크</strong>:</p>
<ul>
<li>대화형 언어 모델은 <strong>긴 문맥을 이해하고 다양한 대화 흐름을 추적</strong>해야 하기 때문에, 많은 양의 문맥 정보를 잃을 경우 정확도가 크게 떨어질 수 있습니다. 예를 들어, MPT-7B와 같은 긴 대화 및 추론이 필요한 벤치마크에서 압축률이 지나치게 높으면 대화의 일관성이나 답변의 질이 저하될 수 있습니다.</li>
</ul>
</li>
<li>
<p><strong>고도의 시퀀스 의존성을 요구하는 모델 (예: GPT-J, T5 계열)</strong>:</p>
<ul>
<li>이들 모델은 입력 시퀀스의 모든 토큰에 대한 강한 의존성을 갖고 있어, 일부 중요한 토큰이 사라지면 모델의 성능이 더 크게 저하될 수 있습니다. 특히 요약(summarization)과 같은 <strong>정확한 문맥 파악이 중요한 작업</strong>에서는, 과도한 압축이 정보를 잃게 만들어 성능이 낮아질 수 있습니다.</li>
</ul>
</li>
<li>
<p><strong>ROUGE 점수를 중심으로 한 벤치마크 (예: CNN/DailyMail)</strong>:</p>
<ul>
<li>요약 작업을 다루는 ROUGE 점수 기반 벤치마크에서, Keyformer가 지나치게 많은 토큰을 제거할 경우 정확도가 떨어질 가능성이 높습니다. CNN/DailyMail과 같은 데이터셋은 텍스트 간의 유사성과 일관성이 중요하기 때문에, <strong>50% 이상의 KV Cache 감소</strong>가 정확도 저하로 이어질 수 있습니다.</li>
</ul>
</li>
<li>
<p><strong>MLPerf와 같은 높은 정확도 요구 벤치마크</strong>:</p>
<ul>
<li>MLPerf는 정확도 기준을 99% 이상으로 유지하도록 요구하는데, 이처럼 <strong>높은 정확도를 요구하는 환경에서는 지나친 압축으로 인한 정보 손실</strong>이 성능 저하를 초래할 수 있습니다. 예를 들어, 전체 90%의 압축률을 목표로 할 때, Keyformer가 99% 정확도를 달성하는 데 어려움을 겪을 수 있습니다.</li>
</ul>
</li>
</ol>
<p>결론적으로, Keyformer는 높은 효율성과 적정 수준의 정확도를 유지할 수 있지만, 일부 모델 구조와 벤치마크에서는 압축률에 따라 성능 저하가 발생할 가능성이 있으며, 이러한 경우 압축률을 적절히 조절해야 합니다.</p>

  </article>

  
  
  <div class="post-license bg-muted/30 border-border mb-8 rounded-xl border p-6">
    <div class="flex items-start gap-4">
      <div
        class="bg-primary/10 flex h-12 w-12 flex-shrink-0 items-center justify-center rounded-lg">
        
  <svg class="h-6 w-6"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="라이선스"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z" />
</svg>
      </div>

      <div class="flex-1">
        <h3 class="text-foreground mb-2 text-lg font-semibold">
          라이선스
        </h3>

        <div class="text-muted-foreground space-y-2 text-sm">
          
          <p>
            <strong>저작자:</strong>
            류재훈
          </p>
          

          <p>
            <strong>링크:</strong>
            <a
              href="http://192.168.1.11:1314/posts/Keyformer-KV-Cache-Reduction-through-Key-Tokens-Selection-for-Efficient-Generative-Inference/"
              class="text-primary hover:text-primary/80 transition-colors duration-200">
              http://192.168.1.11:1314/posts/Keyformer-KV-Cache-Reduction-through-Key-Tokens-Selection-for-Efficient-Generative-Inference/
            </a>
          </p>

          <p>
            <strong>라이선스:</strong>
            <a
              href="https://creativecommons.org/licenses/by-nc-sa/4.0/"
              target="_blank"
              rel="noopener noreferrer"
              class="text-primary hover:text-primary/80 transition-colors duration-200">
              CC BY-NC-SA 4.0
            </a>
          </p>

          <p class="text-xs">
            이 저작물은 크리에이티브 커먼즈 저작자표시-비영리-동일조건변경허락 4.0 국제 라이선스에 따라 이용할 수 있습니다. 출처를 표시하고, 비영리 목적으로만 사용하며, 동일한 라이선스를 유지해야 합니다.
          </p>
        </div>
      </div>
    </div>
  </div>


  
  





  <nav
    class="post-navigation mb-12"
    aria-label="게시글 네비게이션">
    <div class="grid grid-cols-1 gap-4 md:grid-cols-2">
      
      <div class="nav-item">
        
          <a
            href="/posts/Prompt-Cache-Modular-Attention-Reuse-for-Low-Latency-Inference/"
            class="group bg-card border-border hover:bg-primary/5 hover:border-primary/20 focus:ring-primary/20 flex min-h-[140px] flex-col justify-between rounded-xl border p-6 transition-all duration-300 ease-out hover:-translate-y-1 hover:scale-[1.02] hover:shadow-lg focus:ring-2 focus:outline-none">
            <div>
              <div class="mb-3 flex items-center gap-3">
                
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
</svg>
                <span class="text-muted-foreground text-sm font-medium">
                  이전
                </span>
              </div>

              <h3
                class="text-foreground group-hover:text-primary mb-3 line-clamp-2 text-lg leading-tight font-semibold transition-colors duration-200">
                Prompt Cache Modular Attention Reuse for Low-Latency Inference
              </h3>
            </div>

            <div
              class="text-muted-foreground mt-auto flex items-center gap-2 text-xs">
              
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
</svg>
              <time datetime="2024-10-31">
                10月31日
              </time>
            </div>
          </a>
        
      </div>

      
      <div class="nav-item">
        
          <a
            href="/posts/CacheBlend-Fast-Large-Language-Model-Serving-for-RAG-with-Cached-Knowledge-Fusion/"
            class="group bg-card border-border hover:bg-primary/5 hover:border-primary/20 focus:ring-primary/20 flex min-h-[140px] flex-col justify-between rounded-xl border p-6 transition-all duration-300 ease-out hover:-translate-y-1 hover:scale-[1.02] hover:shadow-lg focus:ring-2 focus:outline-none">
            <div>
              <div class="mb-3 flex items-center justify-end gap-3">
                <span class="text-muted-foreground text-sm font-medium">
                  다음
                </span>
                
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
</svg>
              </div>

              <h3
                class="text-foreground group-hover:text-primary mb-3 line-clamp-2 text-right text-lg leading-tight font-semibold transition-colors duration-200">
                CacheBlend Fast Large Language Model Serving for RAG with Cached Knowledge Fusion
              </h3>
            </div>

            <div
              class="text-muted-foreground mt-auto flex items-center justify-end gap-2 text-xs">
              <time datetime="2024-10-31">
                10月31日
              </time>
              
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
</svg>
            </div>
          </a>
        
      </div>
    </div>
  </nav>




  
  










  
  


    </main>

    <footer class="mx-auto max-w-4xl px-4 py-8">
  <div class="px-6 py-6">
    
    
      <nav class="mb-6">
        <div class="flex flex-wrap items-center justify-center gap-1">
          
            
            
            
            <a
              href="/index.xml"
              
              class="nav-link hover:text-primary hover:bg-primary/10 text-muted-foreground flex items-center gap-2 rounded-lg px-4 py-2 text-sm font-medium transition-all duration-300 hover:scale-105">
              
                
  <svg class="h-5 w-5"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="RSS Feed">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 5c7.18 0 13 5.82 13 13M6 11a7 7 0 017 7m-6 0a1 1 0 11-2 0 1 1 0 012 0z" />

</svg>
              
              <span
                >
                  RSS Feed
                </span
              >
            </a>
          
        </div>
      </nav>
    


    
    
      <div class="border-border mb-6 border-t"></div>
    


    
    <div class="flex flex-col items-center justify-between gap-4 md:flex-row">
      
      <div class="text-muted-foreground text-sm">
        <p>
          &copy; 2025 Jaehun&#39;s Blog.
          모든 권리 보유.
        </p>
      </div>

      
      
        <div class="flex items-center gap-3">
          
            <a
              href="https://github.com/ryujaehun"
              
                target="_blank" rel="noopener noreferrer"
              
              class="text-muted-foreground hover:text-primary focus:ring-primary/20 rounded-lg p-1 transition-all duration-300 ease-out hover:scale-110 focus:ring-2 focus:outline-none"
              title="GitHub"
              aria-label="GitHub">
              
                
  <svg class="h-6 w-6"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="GitHub"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"><path d="M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5c.08-1.25-.27-2.48-1-3.5c.28-1.15.28-2.35 0-3.5c0 0-1 0-3 1.5c-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.4 5.4 0 0 0 4 9c0 3.5 3 5.5 6 5.5c-.39.49-.68 1.05-.85 1.65S8.93 17.38 9 18v4"/><path d="M9 18c-4.51 2-5-2-7-2"/></g></svg>
              
            </a>
          
            <a
              href="https://www.linkedin.com/in/jaehunryu/"
              
                target="_blank" rel="noopener noreferrer"
              
              class="text-muted-foreground hover:text-primary focus:ring-primary/20 rounded-lg p-1 transition-all duration-300 ease-out hover:scale-110 focus:ring-2 focus:outline-none"
              title="Linkedin"
              aria-label="Linkedin">
              
                
  <svg class="h-6 w-6"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="Linkedin"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"><path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2a2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6M2 9h4v12H2z"/><circle cx="4" cy="4" r="2"/></g></svg>
              
            </a>
          
            <a
              href="mailto:jaehunryu@icloud.com"
              
              class="text-muted-foreground hover:text-primary focus:ring-primary/20 rounded-lg p-1 transition-all duration-300 ease-out hover:scale-110 focus:ring-2 focus:outline-none"
              title="Email"
              aria-label="Email">
              
                
  <svg class="h-6 w-6"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24" aria-label="Email">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />

</svg>
              
            </a>
          
        </div>
      

    </div>
  </div>
</footer>


    
    



<div
  id="dock"
  class="pointer-events-none fixed bottom-4 left-1/2 z-[9999] w-fit -translate-x-1/2 translate-y-24 opacity-0 transition-all duration-300 ease-out sm:right-0 sm:left-0 sm:mx-auto sm:translate-x-0"
  role="toolbar"
  aria-label="바로가기 도구 모음">
  <nav
    class="border-border bg-card/80 scrollbar-hide xs:px-3 xs:py-2 mx-auto flex max-w-[calc(100vw-2rem)] min-w-fit items-center justify-center overflow-x-auto rounded-2xl border px-4 py-3 shadow-lg backdrop-blur-sm sm:px-4 sm:py-3">
    
    
      <button
        id="dock-back"
        class="text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 xs:px-2 xs:py-1.5 flex flex-shrink-0 items-center gap-2 rounded-lg px-3 py-2 text-sm font-medium transition-all duration-300 ease-out hover:-translate-y-0.5 hover:scale-105 focus:ring-2 focus:outline-none sm:px-3 sm:py-2"
        title="뒤로"
        aria-label="뒤로">
        
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24">
  <path d="m12 19-7-7 7-7"/>
  <path d="M19 12H5"/>

</svg>
        <span class="hidden sm:inline"
          >뒤로</span
        >
      </button>

      
      <div class="bg-border xs:mx-1 mx-2 h-6 w-px sm:mx-2"></div>
    


    
    
      <button
        id="dock-toc"
        class="text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 xs:px-2 xs:py-1.5 flex flex-shrink-0 items-center gap-2 rounded-lg px-3 py-2 text-sm font-medium transition-all duration-300 ease-out hover:-translate-y-0.5 hover:scale-105 focus:ring-2 focus:outline-none sm:px-3 sm:py-2"
        title="목차"
        aria-label="목차">
        
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24">
  <line x1="8" x2="21" y1="6" y2="6"/>
  <line x1="8" x2="21" y1="12" y2="12"/>
  <line x1="8" x2="21" y1="18" y2="18"/>
  <line x1="3" x2="3.01" y1="6" y2="6"/>
  <line x1="3" x2="3.01" y1="12" y2="12"/>
  <line x1="3" x2="3.01" y1="18" y2="18"/>

</svg>
        <span class="hidden sm:inline"
          >목차</span
        >
      </button>

      
      <div class="bg-border xs:mx-1 mx-2 h-6 w-px sm:mx-2"></div>
    


    
    <button
      id="dock-search"
      class="text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 xs:px-3 xs:py-1.5 flex flex-shrink-0 items-center gap-2 rounded-lg px-4 py-2 text-sm font-medium transition-all duration-300 ease-out hover:-translate-y-0.5 hover:scale-105 focus:ring-2 focus:outline-none sm:px-4 sm:py-2"
      title="검색"
      aria-label="검색">
      
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m21 21-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />

</svg>
      <span class="hidden md:inline"
        >검색</span
      >
    </button>

    
    <div class="bg-border xs:mx-1 mx-2 h-6 w-px sm:mx-2"></div>

    
    
    


    
    <button
      id="dock-top"
      class="text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 xs:px-2 xs:py-1.5 flex flex-shrink-0 items-center gap-2 rounded-lg px-3 py-2 text-sm font-medium transition-all duration-300 ease-out hover:-translate-y-0.5 hover:scale-105 focus:ring-2 focus:outline-none sm:px-3 sm:py-2"
      title="맨 위로"
      aria-label="맨 위로">
      
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24">
  <path d="m18 15-6-6-6 6"/>

</svg>
      <span class="hidden sm:inline"
        >맨 위로</span
      >
    </button>
  </nav>
</div>


    
      



<div
  id="toc-overlay"
  class="pointer-events-none fixed inset-0 z-40 bg-black/50 opacity-0 backdrop-blur-sm transition-all duration-300"
  role="dialog"
  aria-modal="true"
  aria-labelledby="toc-title"></div>


<div
  id="toc-card"
  class="pointer-events-none fixed inset-4 z-50 flex w-auto scale-95 items-center justify-center opacity-0 transition-all duration-300 sm:inset-auto sm:top-1/2 sm:left-1/2 sm:block sm:w-full sm:max-w-md sm:-translate-x-1/2 sm:-translate-y-1/2"
  role="dialog"
  aria-modal="true"
  aria-labelledby="toc-title">
  <div
    class="bg-card border-border w-full max-w-sm overflow-hidden rounded-xl border shadow-xl sm:max-w-md">
    
    <div
      class="border-border bg-muted/30 flex items-center justify-between border-b p-4">
      <div class="flex items-center gap-3">
        
  <svg class="h-5 w-5"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24">
  <line x1="8" x2="21" y1="6" y2="6"/>
  <line x1="8" x2="21" y1="12" y2="12"/>
  <line x1="8" x2="21" y1="18" y2="18"/>
  <line x1="3" x2="3.01" y1="6" y2="6"/>
  <line x1="3" x2="3.01" y1="12" y2="12"/>
  <line x1="3" x2="3.01" y1="18" y2="18"/>

</svg>
        <h2 id="toc-title" class="text-foreground text-lg font-semibold">
          목차
        </h2>
      </div>

      
      <button
        id="toc-close"
        class="text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 rounded-lg p-2 transition-all duration-200 ease-out hover:-translate-y-0.5 hover:scale-105 focus:ring-2 focus:outline-none"
        title="닫기"
        aria-label="닫기">
        
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />

</svg>
      </button>
    </div>

    
    <div class="max-h-96 overflow-y-auto p-4">
      <nav
        id="toc-nav"
        class="toc-scrollbar"
        aria-label="글 목차">
          
          <div id="toc-content">
            <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#논문의-주요-내용-강점-독창성-알고리즘-및-한계점">논문의 주요 내용, 강점, 독창성, 알고리즘 및 한계점</a>
          <ul>
            <li><a href="#강점-및-독창성">강점 및 독창성</a></li>
            <li><a href="#핵심-알고리즘-설명-예시-포함">핵심 알고리즘 설명 (예시 포함)</a></li>
            <li><a href="#한계점">한계점</a></li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>

  <ul>
    <li>
      <ul>
        <li><a href="#figure-6-keyformer-개요---상세-설명">Figure 6: Keyformer 개요 - 상세 설명</a></li>
        <li><a href="#attention-on-attention-구조---이해가-맞는지">&ldquo;Attention on Attention&rdquo; 구조 - 이해가 맞는지</a></li>
      </ul>
    </li>
  </ul>

  <ul>
    <li>
      <ul>
        <li><a href="#section-3-keyformer의-직관과-설계---개요와-주요-기법-설명">Section 3: Keyformer의 직관과 설계 - 개요와 주요 기법 설명</a></li>
        <li><a href="#1-keyformer-설계의-전체적인-흐름">1. Keyformer 설계의 전체적인 흐름</a></li>
        <li><a href="#2-gumbel-logit-adjustment의-사용-이유와-효과">2. Gumbel Logit Adjustment의 사용 이유와 효과</a>
          <ul>
            <li><a href="#왜-gumbel-logit-adjustment를-사용하는가">왜 Gumbel Logit Adjustment를 사용하는가?</a></li>
            <li><a href="#예시를-통한-gumbel-logit-adjustment-설명">예시를 통한 Gumbel Logit Adjustment 설명</a></li>
            <li><a href="#gumbel-softmax의-추가적인-장점">Gumbel Softmax의 추가적인 장점</a></li>
          </ul>
        </li>
        <li><a href="#3-gumbel-logit-adjustment를-통한-핵심-토큰-선택-과정">3. Gumbel Logit Adjustment를 통한 핵심 토큰 선택 과정</a></li>
        <li><a href="#요약">요약</a></li>
      </ul>
    </li>
  </ul>

  <ul>
    <li>
      <ul>
        <li><a href="#알고리즘-1-keyformer의-단계별-프로세스">알고리즘 1: Keyformer의 단계별 프로세스</a>
          <ul>
            <li><a href="#pseudo-code-설명">Pseudo-Code 설명</a></li>
            <li><a href="#코드-기반-알고리즘-설명">코드 기반 알고리즘 설명</a></li>
          </ul>
        </li>
        <li><a href="#예시와-함께-단계별로-설명">예시와 함께 단계별로 설명</a>
          <ul>
            <li><a href="#단계-1-초기-설정">단계 1: 초기 설정</a></li>
            <li><a href="#단계-2-첫-번째-디코딩-루프-디코딩-단계-t0">단계 2: 첫 번째 디코딩 루프 (디코딩 단계 t=0)</a></li>
            <li><a href="#단계-3-생성-단계-디코딩-단계-t1부터">단계 3: 생성 단계 (디코딩 단계 t=1부터)</a></li>
          </ul>
        </li>
        <li><a href="#요약-1">요약</a></li>
      </ul>
    </li>
  </ul>

  <ul>
    <li>
      <ul>
        <li><a href="#keyformer의-압축률-결정-요인">Keyformer의 압축률 결정 요인</a></li>
        <li><a href="#모델-구조-및-벤치마크에-따른-압축의-영향">모델 구조 및 벤치마크에 따른 압축의 영향</a></li>
      </ul>
    </li>
  </ul>
</nav>
          </div>
      </nav>
    </div>

    
    <div class="border-border bg-muted/20 border-t px-4 py-3">
      <div class="text-muted-foreground text-center text-xs">
        <span>제목을 클릭하면 해당 위치로 이동합니다</span>
      </div>
    </div>
  </div>
</div>

    


  <link
    rel="stylesheet"
    href="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.css"
    integrity="sha384-5TcZemv2l/9On385z///+d7MSYlvIEw9FuZTIdZ14vJLqWphw7e7ZPuOiCHJcFCP"
    crossorigin="anonymous" />
  <script
    defer
    src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.js"
    integrity="sha384-cMkvdD8LoxVzGF/RPUKAcvmm49FQ0oxwDF3BGKtDXcEc+T1b2N+teh/OJfpU0jr6"
    crossorigin="anonymous"></script>
  <script
    defer
    src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/contrib/auto-render.min.js"
    integrity="sha384-hCXGrW6PitJEwbkoStFjeJxv+fSOOQKOPbJxSfM6G5sWZjAyWhXiTIIAmQqnlLlh"
    crossorigin="anonymous"></script>

<script>
    
    function initKaTeX() {
        if (typeof renderMathInElement === 'undefined') {
            setTimeout(initKaTeX, 100);
            return;
        }

        var delimiters = [{"display":true,"left":"$$","right":"$$"},{"display":false,"left":"$","right":"$"}];

        renderMathInElement(document.body, {
            delimiters: delimiters,
            throwOnError: false,
            errorColor: '#cc0000',
            fleqn: false,
            leqno: false,
            trust: false
        });
    }

    
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', initKaTeX);
    } else {
        initKaTeX();
    }
</script>
    



    
    
<div
  id="search-overlay"
  class="pointer-events-none fixed inset-0 z-40 bg-black/50 opacity-0 transition-opacity duration-300"></div>


<div
  id="search-modal"
  class="bg-card border-border pointer-events-none fixed top-1/2 left-1/2 z-50 max-h-[80vh] w-full max-w-2xl -translate-x-1/2 -translate-y-1/2 scale-95 transform overflow-hidden rounded-xl border opacity-0 shadow-xl transition-all duration-300">
  
  <div class="border-border flex items-center gap-3 border-b p-4">
    
    <div class="text-muted-foreground h-5 w-5 flex-shrink-0">
      
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m21 21-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />

</svg>
    </div>

    
    <div class="relative flex-1">
      
      <button
        id="search-clear"
        class="text-muted-foreground hover:text-foreground hover:bg-muted/50 pointer-events-none absolute top-1/2 left-0 z-10 h-5 w-5 -translate-y-1/2 rounded opacity-0 transition-all duration-200"
        title="지우기"
        aria-label="지우기">
        
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />

</svg>
      </button>

      
      <input
        id="search-input"
        type="text"
        placeholder="게시글 검색..."
        class="text-foreground placeholder:text-muted-foreground w-full border-none bg-transparent pl-8 text-lg outline-none"
        autocomplete="off"
        spellcheck="false" />
    </div>

    
    <button
      id="search-close"
      class="text-muted-foreground hover:text-foreground hover:bg-muted/50 flex h-6 w-6 items-center justify-center rounded-md p-0.5 transition-all duration-200"
      title="닫기"
      aria-label="닫기">
      
  <svg class="h-4 w-4"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />

</svg>
    </button>
  </div>

  
  <div id="search-results" class="max-h-96 overflow-y-auto">
    
    <div
      id="search-empty"
      class="flex flex-col items-center justify-center py-12 text-center">
      <div
        class="bg-muted/50 mb-4 flex h-16 w-16 items-center justify-center rounded-full">
        
  <svg class="h-6 w-6"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m21 21-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />

</svg>
      </div>
      <h3 class="text-foreground mb-2 text-lg font-semibold">
        검색 시작
      </h3>
      <p class="text-muted-foreground text-sm">
        검색어를 입력하세요
      </p>
    </div>

    
    <div
      id="search-loading"
      class="flex hidden items-center justify-center py-8">
      <div
        class="mr-3 h-6 w-6 animate-spin rounded-full border-2 border-current border-t-transparent"></div>
      <span class="text-muted-foreground"
        >검색 중...</span
      >
    </div>

    
    <div
      id="search-no-results"
      class="flex hidden flex-col items-center justify-center py-12 text-center">
      <div
        class="bg-muted/50 mb-4 flex h-16 w-16 items-center justify-center rounded-full">
        
  <svg class="h-6 w-6"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h7" />
</svg>
      </div>
      <h3 class="text-foreground mb-2 text-lg font-semibold">
        검색 결과 없음
      </h3>
      <p class="text-muted-foreground text-sm">
        다른 검색어로 시도해보세요
      </p>
    </div>

    
    <div id="search-results-list" class="hidden">
      
      <div
        id="search-stats"
        class="text-muted-foreground border-border border-b px-4 py-3 text-sm"
        data-template="%d개의 결과 찾음">
      </div>

      
      <div id="search-items" class="divide-border divide-y">
        
      </div>
    </div>
  </div>

  
  <div class="border-border bg-muted/20 border-t px-4 py-3">
    <div
      class="text-muted-foreground flex items-center justify-between text-xs">
      <div class="flex items-center gap-2 md:gap-4">
        <div class="flex items-center gap-1">
          <kbd
            class="bg-muted border-border rounded border px-1.5 py-0.5 text-xs"
            >↑↓</kbd
          >
          <span class="hidden sm:inline"
            >이동</span
          >
        </div>
        <div class="flex items-center gap-1">
          <kbd
            class="bg-muted border-border rounded border px-1.5 py-0.5 text-xs"
            >↵</kbd
          >
          <span class="hidden sm:inline"
            >선택</span
          >
        </div>
        <div class="flex items-center gap-1">
          <kbd
            class="bg-muted border-border rounded border px-1.5 py-0.5 text-xs"
            >ESC</kbd
          >
          <span class="hidden sm:inline"
            >닫기</span
          >
        </div>
      </div>
      <div class="search-hint-desktop flex items-center gap-1">
        <kbd class="bg-muted border-border rounded border px-1.5 py-0.5 text-xs"
          >⌘K</kbd
        >
        <span>단축키</span>
      </div>
    </div>
  </div>
</div>

  </body>
</html>
