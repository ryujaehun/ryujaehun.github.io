<!doctype html><html lang=ko-kr data-theme=claude><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta http-equiv=X-UA-Compatible content="IE=edge"><title>Fire-Flyer AI-HPC: A Cost-Effective Software-Hardware Co-Design for Deep Learning | Jaehun's Blog</title><meta name=description content="ë…¼ë¬¸ ë§í¬
í•œ ì¤„ ìš”ì•½ (TL;DR) Fire-Flyer 2ëŠ” 1ë§Œ ëŒ€ì˜ PCIe A100 GPUë¥¼ HFReduceÂ·HaiScale ìŠ¤íƒìœ¼ë¡œ ë¬¶ì–´ DGX-A100ì˜ 80 %ëŒ€ ì„±ëŠ¥ì„ ì¥ë¹„Â·ì „ë ¥ 40 % ì ˆê°ìœ¼ë¡œ ë‹¬ì„±í•œ â€˜ê°€ì„±ë¹„í˜• ì´ˆëŒ€ê·œëª¨ LLM í›ˆë ¨ í´ëŸ¬ìŠ¤í„°â€™ë‹¤...."><meta name=keywords content="2408.14158v2,Distributed Training,PCIe GPU Cluster,All-Reduce,HFReduce,Communication Optimization,Cost Efficiency,Power Efficiency,PyTorch,Large Language Models,System Architecture"><meta name=author content><meta name=language content="ko"><meta name=robots content="index, follow"><link rel=canonical href=https://jaehun.me/ko/ko/posts/2025-07-01-paper-2408.14158v2/><link rel=icon type=image/svg+xml href=/favicon.svg><link rel=manifest href=/site.webmanifest><meta property="og:url" content="https://jaehun.me/ko/ko/posts/2025-07-01-paper-2408.14158v2/"><meta property="og:site_name" content="Jaehun's Blog"><meta property="og:title" content="Fire-Flyer AI-HPC: A Cost-Effective Software-Hardware Co-Design for Deep Learning"><meta property="og:description" content="ë…¼ë¬¸ ë§í¬
í•œ ì¤„ ìš”ì•½ (TL;DR) Fire-Flyer 2ëŠ” 1ë§Œ ëŒ€ì˜ PCIe A100 GPUë¥¼ HFReduceÂ·HaiScale ìŠ¤íƒìœ¼ë¡œ ë¬¶ì–´ DGX-A100ì˜ 80 %ëŒ€ ì„±ëŠ¥ì„ ì¥ë¹„Â·ì „ë ¥ 40 % ì ˆê°ìœ¼ë¡œ ë‹¬ì„±í•œ â€˜ê°€ì„±ë¹„í˜• ì´ˆëŒ€ê·œëª¨ LLM í›ˆë ¨ í´ëŸ¬ìŠ¤í„°â€™ë‹¤."><meta property="og:locale" content="ko_kr"><meta property="og:type" content="article"><meta property="article:section" content="ko"><meta property="article:published_time" content="2025-07-01T00:00:00+00:00"><meta property="article:modified_time" content="2025-07-01T00:00:00+00:00"><meta property="article:tag" content="2408.14158v2"><meta property="article:tag" content="Distributed Training"><meta property="article:tag" content="PCIe GPU Cluster"><meta property="article:tag" content="All-Reduce, HFReduce"><meta property="article:tag" content="Communication Optimization"><meta property="article:tag" content="Cost Efficiency"><meta property="og:image" content="https://jaehun.me/images/og-default.avif"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://jaehun.me/images/og-default.avif"><meta name=twitter:title content="Fire-Flyer AI-HPC: A Cost-Effective Software-Hardware Co-Design for Deep Learning"><meta name=twitter:description content="ë…¼ë¬¸ ë§í¬
í•œ ì¤„ ìš”ì•½ (TL;DR) Fire-Flyer 2ëŠ” 1ë§Œ ëŒ€ì˜ PCIe A100 GPUë¥¼ HFReduceÂ·HaiScale ìŠ¤íƒìœ¼ë¡œ ë¬¶ì–´ DGX-A100ì˜ 80 %ëŒ€ ì„±ëŠ¥ì„ ì¥ë¹„Â·ì „ë ¥ 40 % ì ˆê°ìœ¼ë¡œ ë‹¬ì„±í•œ â€˜ê°€ì„±ë¹„í˜• ì´ˆëŒ€ê·œëª¨ LLM í›ˆë ¨ í´ëŸ¬ìŠ¤í„°â€™ë‹¤."><meta itemprop=name content="Fire-Flyer AI-HPC: A Cost-Effective Software-Hardware Co-Design for Deep Learning"><meta itemprop=description content="ë…¼ë¬¸ ë§í¬
í•œ ì¤„ ìš”ì•½ (TL;DR) Fire-Flyer 2ëŠ” 1ë§Œ ëŒ€ì˜ PCIe A100 GPUë¥¼ HFReduceÂ·HaiScale ìŠ¤íƒìœ¼ë¡œ ë¬¶ì–´ DGX-A100ì˜ 80 %ëŒ€ ì„±ëŠ¥ì„ ì¥ë¹„Â·ì „ë ¥ 40 % ì ˆê°ìœ¼ë¡œ ë‹¬ì„±í•œ â€˜ê°€ì„±ë¹„í˜• ì´ˆëŒ€ê·œëª¨ LLM í›ˆë ¨ í´ëŸ¬ìŠ¤í„°â€™ë‹¤."><meta itemprop=datePublished content="2025-07-01T00:00:00+00:00"><meta itemprop=dateModified content="2025-07-01T00:00:00+00:00"><meta itemprop=wordCount content="13525"><meta itemprop=image content="https://jaehun.me/images/og-default.avif"><meta itemprop=keywords content="2408.14158v2,Distributed Training,PCIe GPU Cluster,All-Reduce, HFReduce,Communication Optimization,Cost Efficiency,Power Efficiency,PyTorch,Large Language Models,System Architecture"><script>window.HUGO_SEARCH_CONFIG={searchIndexURL:'"/ko/index.json"'}</script><script>window.HUGO_GALLERY_CONFIG={justified_gallery:!1,lightbox:!1,justified:"{}",lightbox_options:"{}"}</script><link rel=stylesheet href=/css/compiled.min.9165cace5b80a5be5daad6ea96eb2abc20a18a3f41d7fed7f0335b689fdf7883.css integrity="sha256-kWXKzluApb5dqtbqlusqvCChij9B1/7X8DNbaJ/feIM=" crossorigin=anonymous><link rel=stylesheet href=/css/chroma.min.491df36221f739b5948a747a0351f100ee7ccaaf466d9f46288bf06de1d59123.css integrity="sha256-SR3zYiH3ObWUinR6A1HxAO58yq9GbZ9GKIvwbeHVkSM=" crossorigin=anonymous><script src=/js/main.ba969e49a7a874e6938fe689a7dcaa00cb64cb4d429c2cf98d09bde512a16c6d.js integrity="sha256-upaeSaeodOaTj+aJp9yqAMtky01CnCz5jQm95RKhbG0=" crossorigin=anonymous></script><script src=/js/gumshoe.polyfills.min.js></script><script src=/js/toc.70654aebf0b738a78ae2df95297cc10ebc6e590f3c942dd1325fa852f50038b2.js integrity="sha256-cGVK6/C3OKeK4t+VKXzBDrxuWQ88lC3RMl+oUvUAOLI=" crossorigin=anonymous defer></script><script src=/js/search.de3eba3540834efb8328121784bff4774e06362412ee41eee665f5b4f987f393.js integrity="sha256-3j66NUCDTvuDKBIXhL/0d04GNiQS7kHu5mX1tPmH85M=" crossorigin=anonymous defer></script><script src=/js/dock.e02f422517e001d9fb6bea1e9e8b0e89e9d2e486ad4641f275bb3e36ce2ae79f.js integrity="sha256-4C9CJRfgAdn7a+oenosOienS5IatRkHydbs+Ns4q558=" crossorigin=anonymous defer></script><script>(function(){const e=localStorage.getItem("theme")||"system",n=localStorage.getItem("colorScheme")||"claude";document.documentElement.setAttribute("data-theme",n);function t(){e==="dark"||e==="system"&&window.matchMedia("(prefers-color-scheme: dark)").matches?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")}t(),e==="system"&&window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",t)})()</script></head><body class="bg-background text-foreground min-h-screen antialiased"><div id=reading-progress-container class="reading-progress-container pointer-events-none fixed top-0 right-0 left-0 z-50 transition-opacity duration-300 ease-out" data-height=3 data-smooth-scroll=true data-hide-on-complete=false><div class="reading-progress-bg w-full"></div><div id=reading-progress-bar class="from-primary to-primary/80 reading-progress-bar
transition-all duration-150 ease-out
absolute top-0 left-0 w-0 bg-gradient-to-r"></div></div><script>(function(){"use strict";const t=document.getElementById("reading-progress-container"),o=document.getElementById("reading-progress-bar");if(!t||!o)return;const a={smoothScroll:t.dataset.smoothScroll==="true",hideOnComplete:t.dataset.hideOnComplete==="true"};let n=!0,l=null;function r(){const t=window.pageYOffset||document.documentElement.scrollTop,n=document.documentElement.scrollHeight,s=window.innerHeight,e=n-s;return e<=0?0:Math.min(Math.max(t/e*100,0),100)}function c(){const e=r();o.style.width=e+"%",a.hideOnComplete&&e>=99.5?n&&(t.style.opacity="0",n=!1):n||(t.style.opacity="1",n=!0)}let s=!1;function e(){s||(requestAnimationFrame(()=>{c(),s=!1}),s=!0)}function i(){window.addEventListener("scroll",e,{passive:!0}),window.addEventListener("resize",e,{passive:!0}),document.addEventListener("visibilitychange",()=>{document.hidden||e()}),e(),window.addEventListener("beforeunload",()=>{window.removeEventListener("scroll",e),window.removeEventListener("resize",e)})}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",i):i()})()</script><header class="sticky top-0 z-50 mx-auto max-w-4xl px-4 py-6"><div class="border-border bg-card/80 flex items-center rounded-xl border px-6 py-4 shadow-sm backdrop-blur-sm"><div class="hidden w-full items-center md:flex"><div class="flex items-center"><a href=/ko/ class="flex h-10 w-10 items-center justify-center overflow-hidden rounded-full transition-transform duration-200 hover:scale-105" aria-label="Jaehun's Blog"><img src=/images/logo.svg alt="Jaehun's Blog" class="h-full w-full object-cover"></a></div><nav class="mx-8 flex flex-1 items-center justify-center"><div class="flex items-center space-x-1"><a href=/ko/ class="nav-link
text-muted-foreground hover:text-primary hover:bg-primary/10
focus:ring-primary/20 relative flex items-center gap-2 rounded-lg px-4 py-2 text-sm font-medium transition-all duration-300 ease-out hover:-translate-y-0.5 hover:scale-105 focus:ring-2 focus:outline-none"><svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="nav.posts"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 20H5a2 2 0 01-2-2V6a2 2 0 012-2h10a2 2 0 012 2v1m2 13a2 2 0 01-2-2V7m2 13a2 2 0 002-2V9a2 2 0 00-2-2h-2m-4-3H9M7 16h6M7 8h6v4H7V8z"/></svg>
<span>ê²Œì‹œê¸€
</span></a><a href=/ko/categories/ class="nav-link
text-muted-foreground hover:text-primary hover:bg-primary/10
focus:ring-primary/20 relative flex items-center gap-2 rounded-lg px-4 py-2 text-sm font-medium transition-all duration-300 ease-out hover:-translate-y-0.5 hover:scale-105 focus:ring-2 focus:outline-none"><svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="nav.categories"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"/></svg>
<span>ì¹´í…Œê³ ë¦¬
</span></a><a href=/ko/tags/ class="nav-link
text-muted-foreground hover:text-primary hover:bg-primary/10
focus:ring-primary/20 relative flex items-center gap-2 rounded-lg px-4 py-2 text-sm font-medium transition-all duration-300 ease-out hover:-translate-y-0.5 hover:scale-105 focus:ring-2 focus:outline-none"><svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="nav.tags"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 7h.01M7 3h5c.512.0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828.0l-7-7A1.994 1.994.0 013 12V7a4 4 0 014-4z"/></svg>
<span>íƒœê·¸
</span></a><a href=/ko/ class="nav-link
text-muted-foreground hover:text-primary hover:bg-primary/10
focus:ring-primary/20 relative flex items-center gap-2 rounded-lg px-4 py-2 text-sm font-medium transition-all duration-300 ease-out hover:-translate-y-0.5 hover:scale-105 focus:ring-2 focus:outline-none"><svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="nav.archives"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 8h14M5 8a2 2 0 110-4h14a2 2 0 110 4M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8m-9 4h4"/></svg>
<span>ì•„ì¹´ì´ë¸Œ</span></a></div></nav><div class="flex items-center space-x-2"><div class=relative><button id=language-toggle class="dropdown-toggle border-border bg-background text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex h-10 w-10 items-center justify-center rounded-lg border transition-all duration-300 ease-out hover:scale-105 focus:ring-2 focus:outline-none active:scale-95" data-dropdown-type=language aria-label="ì–¸ì–´ ë³€ê²½" aria-expanded=false aria-haspopup=true>
<svg class="h-5 w-5 relative z-10" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="ì–¸ì–´ ë³€ê²½"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m5 8 6 6m-7 0 6-6 2-3M2 5h12M7 2h1m14 20-5-10-5 10m2-4h6"/></svg></button><div id=language-dropdown class="dropdown-menu border-border bg-popover/95 absolute top-12 right-0 z-[60] hidden w-40 rounded-lg border p-1 shadow-lg backdrop-blur-sm transition-all duration-200 ease-out" data-dropdown-type=language role=menu aria-labelledby=language-toggle><a href=/ko/ class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none" role=menuitem aria-current=true><span class=font-medium>í•œêµ­ì–´</span></a><a href=/en/ class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none" role=menuitem><span class=font-medium>English</span></a></div></div><div class=relative><button id=color-scheme-toggle class="dropdown-toggle border-border bg-background text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex h-10 w-10 items-center justify-center rounded-lg border transition-all duration-300 ease-out hover:scale-105 focus:ring-2 focus:outline-none active:scale-95" data-dropdown-type=color-scheme aria-label="í…Œë§ˆ ë³€ê²½" aria-expanded=false aria-haspopup=true>
<svg class="h-5 w-5 relative z-10" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="í…Œë§ˆ ë³€ê²½"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zM21 5a2 2 0 00-2-2h-4a2 2 0 00-2 2v6a2 2 0 002 2h4a2 2 0 002-2V5z"/></svg></button><div id=color-scheme-dropdown class="dropdown-menu border-border bg-popover/95 absolute top-12 right-0 z-[60] hidden w-44 rounded-lg border p-1 shadow-lg backdrop-blur-sm transition-all duration-200 ease-out" data-dropdown-type=color-scheme><button data-color-scheme=claude class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Default</span></button><button data-color-scheme=default class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>White</span></button><button data-color-scheme=bumblebee class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Bumblebee</span></button><button data-color-scheme=emerald class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Emerald</span></button><button data-color-scheme=nord class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Nord</span></button><button data-color-scheme=sunset class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Sunset</span></button><button data-color-scheme=abyss class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Abyss</span></button><button data-color-scheme=dracula class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Dracula</span></button><button data-color-scheme=amethyst class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Amethyst</span></button><button data-color-scheme=slate class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Slate</span></button><button data-color-scheme=twitter class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Twitter</span></button></div></div><div class=relative><button id=theme-toggle class="dropdown-toggle border-border bg-background text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex h-10 w-10 items-center justify-center rounded-lg border transition-all duration-300 ease-out hover:scale-105 focus:ring-2 focus:outline-none active:scale-95" data-dropdown-type=theme aria-label="í…Œë§ˆ ë³€ê²½" aria-expanded=false aria-haspopup=true>
<svg class="h-5 w-5 sun-icon hidden relative z-10" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="ë¼ì´íŠ¸"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364-.707-.707M6.343 6.343l-.707-.707m12.728.0-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"/></svg>
<svg class="h-5 w-5 moon-icon hidden relative z-10" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="ë‹¤í¬"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003.0 0012 21a9.003 9.003.0 008.354-5.646z"/></svg>
<svg class="h-5 w-5 system-icon hidden relative z-10" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="ì‹œìŠ¤í…œ"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.75 17 9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5A2 2 0 003 5v10a2 2 0 002 2z"/></svg></button><div id=theme-dropdown class="dropdown-menu border-border bg-popover/95 absolute top-12 right-0 z-[60] hidden w-40 rounded-lg border p-1 shadow-lg backdrop-blur-sm transition-all duration-200 ease-out" data-dropdown-type=theme><button data-theme=light class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none">
<svg class="h-5 w-5 mr-3 h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="ë¼ì´íŠ¸"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364-.707-.707M6.343 6.343l-.707-.707m12.728.0-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"/></svg><span>ë¼ì´íŠ¸</span></button><button data-theme=dark class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none">
<svg class="h-5 w-5 mr-3 h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="ë‹¤í¬"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003.0 0012 21a9.003 9.003.0 008.354-5.646z"/></svg><span>ë‹¤í¬</span></button><button data-theme=system class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none">
<svg class="h-5 w-5 mr-3 h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="ì‹œìŠ¤í…œ"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.75 17 9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5A2 2 0 003 5v10a2 2 0 002 2z"/></svg><span>ì‹œìŠ¤í…œ</span></button></div></div></div></div><div class="flex w-full items-center justify-between md:hidden"><div class=relative><button id=mobile-menu-toggle class="dropdown-toggle border-border bg-background text-muted-foreground hover:bg-accent hover:text-foreground flex h-10 w-10 items-center justify-center rounded-lg border transition-colors duration-200" data-dropdown-type=mobile-menu aria-label=ë©”ë‰´ aria-expanded=false aria-haspopup=true>
<svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="ë©”ë‰´"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/></svg></button><div id=mobile-menu class="mobile-menu dropdown-menu border-border bg-popover/95 absolute top-12 left-0 z-[60] hidden w-80 max-w-[calc(100vw-2rem)] rounded-lg border p-1 shadow-lg backdrop-blur-sm transition-all duration-200 ease-out md:hidden" data-dropdown-type=mobile-menu role=menu aria-labelledby=mobile-menu-toggle><nav class="flex flex-col"><a href=/ko/ class="nav-link
text-muted-foreground hover:text-primary hover:bg-primary/10
focus:ring-primary/20 relative flex items-center gap-3 rounded-md px-4 py-3 text-sm font-medium transition-all duration-200 ease-out hover:translate-x-1 focus:ring-2 focus:outline-none" role=menuitem><svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="nav.posts"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 20H5a2 2 0 01-2-2V6a2 2 0 012-2h10a2 2 0 012 2v1m2 13a2 2 0 01-2-2V7m2 13a2 2 0 002-2V9a2 2 0 00-2-2h-2m-4-3H9M7 16h6M7 8h6v4H7V8z"/></svg>
<span>ê²Œì‹œê¸€
</span></a><a href=/ko/categories/ class="nav-link
text-muted-foreground hover:text-primary hover:bg-primary/10
focus:ring-primary/20 relative flex items-center gap-3 rounded-md px-4 py-3 text-sm font-medium transition-all duration-200 ease-out hover:translate-x-1 focus:ring-2 focus:outline-none" role=menuitem><svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="nav.categories"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"/></svg>
<span>ì¹´í…Œê³ ë¦¬
</span></a><a href=/ko/tags/ class="nav-link
text-muted-foreground hover:text-primary hover:bg-primary/10
focus:ring-primary/20 relative flex items-center gap-3 rounded-md px-4 py-3 text-sm font-medium transition-all duration-200 ease-out hover:translate-x-1 focus:ring-2 focus:outline-none" role=menuitem><svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="nav.tags"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 7h.01M7 3h5c.512.0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828.0l-7-7A1.994 1.994.0 013 12V7a4 4 0 014-4z"/></svg>
<span>íƒœê·¸
</span></a><a href=/ko/ class="nav-link
text-muted-foreground hover:text-primary hover:bg-primary/10
focus:ring-primary/20 relative flex items-center gap-3 rounded-md px-4 py-3 text-sm font-medium transition-all duration-200 ease-out hover:translate-x-1 focus:ring-2 focus:outline-none" role=menuitem><svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="nav.archives"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 8h14M5 8a2 2 0 110-4h14a2 2 0 110 4M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8m-9 4h4"/></svg>
<span>ì•„ì¹´ì´ë¸Œ</span></a></nav></div></div><div class="flex items-center space-x-2"><div class=relative><button id=language-toggle class="dropdown-toggle border-border bg-background text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex h-10 w-10 items-center justify-center rounded-lg border transition-all duration-300 ease-out hover:scale-105 focus:ring-2 focus:outline-none active:scale-95" data-dropdown-type=language aria-label="ì–¸ì–´ ë³€ê²½" aria-expanded=false aria-haspopup=true>
<svg class="h-5 w-5 relative z-10" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="ì–¸ì–´ ë³€ê²½"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m5 8 6 6m-7 0 6-6 2-3M2 5h12M7 2h1m14 20-5-10-5 10m2-4h6"/></svg></button><div id=language-dropdown class="dropdown-menu border-border bg-popover/95 absolute top-12 right-0 z-[60] hidden w-40 rounded-lg border p-1 shadow-lg backdrop-blur-sm transition-all duration-200 ease-out" data-dropdown-type=language role=menu aria-labelledby=language-toggle><a href=/ko/ class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none" role=menuitem aria-current=true><span class=font-medium>í•œêµ­ì–´</span></a><a href=/en/ class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none" role=menuitem><span class=font-medium>English</span></a></div></div><div class=relative><button id=color-scheme-toggle class="dropdown-toggle border-border bg-background text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex h-10 w-10 items-center justify-center rounded-lg border transition-all duration-300 ease-out hover:scale-105 focus:ring-2 focus:outline-none active:scale-95" data-dropdown-type=color-scheme aria-label="í…Œë§ˆ ë³€ê²½" aria-expanded=false aria-haspopup=true>
<svg class="h-5 w-5 relative z-10" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="í…Œë§ˆ ë³€ê²½"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zM21 5a2 2 0 00-2-2h-4a2 2 0 00-2 2v6a2 2 0 002 2h4a2 2 0 002-2V5z"/></svg></button><div id=color-scheme-dropdown class="dropdown-menu border-border bg-popover/95 absolute top-12 right-0 z-[60] hidden w-44 rounded-lg border p-1 shadow-lg backdrop-blur-sm transition-all duration-200 ease-out" data-dropdown-type=color-scheme><button data-color-scheme=claude class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Default</span></button><button data-color-scheme=default class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>White</span></button><button data-color-scheme=bumblebee class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Bumblebee</span></button><button data-color-scheme=emerald class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Emerald</span></button><button data-color-scheme=nord class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Nord</span></button><button data-color-scheme=sunset class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Sunset</span></button><button data-color-scheme=abyss class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Abyss</span></button><button data-color-scheme=dracula class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Dracula</span></button><button data-color-scheme=amethyst class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Amethyst</span></button><button data-color-scheme=slate class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Slate</span></button><button data-color-scheme=twitter class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Twitter</span></button></div></div><div class=relative><button id=theme-toggle class="dropdown-toggle border-border bg-background text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex h-10 w-10 items-center justify-center rounded-lg border transition-all duration-300 ease-out hover:scale-105 focus:ring-2 focus:outline-none active:scale-95" data-dropdown-type=theme aria-label="í…Œë§ˆ ë³€ê²½" aria-expanded=false aria-haspopup=true>
<svg class="h-5 w-5 sun-icon hidden relative z-10" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="ë¼ì´íŠ¸"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364-.707-.707M6.343 6.343l-.707-.707m12.728.0-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"/></svg>
<svg class="h-5 w-5 moon-icon hidden relative z-10" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="ë‹¤í¬"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003.0 0012 21a9.003 9.003.0 008.354-5.646z"/></svg>
<svg class="h-5 w-5 system-icon hidden relative z-10" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="ì‹œìŠ¤í…œ"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.75 17 9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5A2 2 0 003 5v10a2 2 0 002 2z"/></svg></button><div id=theme-dropdown class="dropdown-menu border-border bg-popover/95 absolute top-12 right-0 z-[60] hidden w-40 rounded-lg border p-1 shadow-lg backdrop-blur-sm transition-all duration-200 ease-out" data-dropdown-type=theme><button data-theme=light class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none">
<svg class="h-5 w-5 mr-3 h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="ë¼ì´íŠ¸"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364-.707-.707M6.343 6.343l-.707-.707m12.728.0-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"/></svg><span>ë¼ì´íŠ¸</span></button><button data-theme=dark class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none">
<svg class="h-5 w-5 mr-3 h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="ë‹¤í¬"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003.0 0012 21a9.003 9.003.0 008.354-5.646z"/></svg><span>ë‹¤í¬</span></button><button data-theme=system class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none">
<svg class="h-5 w-5 mr-3 h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="ì‹œìŠ¤í…œ"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.75 17 9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5A2 2 0 003 5v10a2 2 0 002 2z"/></svg><span>ì‹œìŠ¤í…œ</span></button></div></div></div></div></div></header><main class="mx-auto max-w-4xl px-4 py-6"><nav class="breadcrumb mb-4 md:mb-6 py-1" aria-label=ê²½ë¡œ><ol class="text-muted-foreground flex items-center space-x-1 md:space-x-2 text-sm overflow-x-auto whitespace-nowrap scrollbar-hide py-1"><li class=flex-shrink-0><a href=/ko/ class="text-muted-foreground hover:text-primary hover:bg-primary/10 flex items-center gap-0.5 md:gap-1 rounded-lg px-1 md:px-3 py-0.5 md:py-1.5 transition-all duration-200 ease-out hover:-translate-y-0.5 hover:scale-[1.02]"><svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="í™ˆ"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m3 12 2-2m0 0 7-7 7 7M5 10v10a1 1 0 001 1h3m10-11 2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"/></svg>
<span class="max-w-[4rem] md:max-w-none truncate">í™ˆ</span></a></li><li class="flex items-center gap-1 md:gap-2 min-w-0"><span class="text-muted-foreground/50 flex-shrink-0"><svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/></svg></span><div class="flex items-center gap-1 md:gap-2 min-w-0"><a href=/ko class="text-muted-foreground hover:text-primary hover:bg-primary/10 flex items-center gap-0.5 md:gap-1 rounded-lg px-1 md:px-3 py-0.5 md:py-1.5 transition-all duration-200 ease-out hover:-translate-y-0.5 hover:scale-[1.02] flex-shrink-0"><svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5A2 2 0 003 7z"/></svg>
<span class="max-w-[4rem] md:max-w-none truncate">Ko</span>
</a><span class="text-muted-foreground/50 flex-shrink-0"><svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/></svg></span>
<span class="text-foreground flex items-center gap-0.5 md:gap-1 font-medium min-w-0"><svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/></svg>
<span class="max-w-[8rem] md:max-w-[16rem] lg:max-w-none truncate">Fire-Flyer AI-HPC: A Cost-Effective Software-Hardware Co-Design for Deep Learning</span></span></div></li></ol></nav><header class=mb-8><h1 class="text-foreground mb-4 text-3xl font-bold md:text-4xl">Fire-Flyer AI-HPC: A Cost-Effective Software-Hardware Co-Design for Deep Learning</h1></header><article class="prose prose-neutral dark:prose-invert max-w-none"><p><a href=https://arxiv.org/abs/2408.14158v2>ë…¼ë¬¸ ë§í¬</a></p><h2 id=í•œ-ì¤„-ìš”ì•½-tldr>í•œ ì¤„ ìš”ì•½ (TL;DR)</h2><p><strong>Fire-Flyer 2</strong>ëŠ” 1ë§Œ ëŒ€ì˜ <strong>PCIe A100 GPU</strong>ë¥¼ <strong>HFReduce</strong>Â·<strong>HaiScale</strong> ìŠ¤íƒìœ¼ë¡œ ë¬¶ì–´ <strong>DGX-A100</strong>ì˜ 80 %ëŒ€ ì„±ëŠ¥ì„ <strong>ì¥ë¹„Â·ì „ë ¥ 40 % ì ˆê°</strong>ìœ¼ë¡œ ë‹¬ì„±í•œ â€˜ê°€ì„±ë¹„í˜• ì´ˆëŒ€ê·œëª¨ LLM í›ˆë ¨ í´ëŸ¬ìŠ¤í„°â€™ë‹¤.</p><h2 id=í•µì‹¬-ì•„ì´ë””ì–´>í•µì‹¬ ì•„ì´ë””ì–´</h2><blockquote class="border-primary bg-muted/30 hover:bg-muted/40 my-6 rounded-r-lg border-l-4 py-4 pr-4 pl-6 italic transition-all duration-200 ease-out hover:translate-x-1"><div class="prose prose-sm max-w-none"><p><strong>PCIe GPU + CPU ê°ì¶• + Double-Binary-Tree RDMA</strong>
â†’ GPU ì»¤ë„ ì—†ì´ë„ <strong>8 GB/s</strong> All-Reduce ëŒ€ì—­í­ í™•ë³´
â†’ í•™ìŠµ ë‹¨ê³„ì™€ ì™„ì „ ì˜¤ë²„ë©, <strong>91 %</strong> ê°•í•œ ìŠ¤ì¼€ì¼ íš¨ìœ¨ ë‹¬ì„±</p></div></blockquote><h2 id=ë°°ê²½-ê·¸ë“¤ì´-í•´ê²°í•œ-ë¬¸ì œ>ë°°ê²½: ê·¸ë“¤ì´ í•´ê²°í•œ ë¬¸ì œ</h2><p>ì´ˆê±°ëŒ€ LLM í•™ìŠµì€ NVLink-SXM ì„œë²„(DGX) ì¤‘ì‹¬ìœ¼ë¡œ ë°œì „í–ˆì§€ë§Œ, <strong>ë§‰ëŒ€í•œ ì¥ë¹„Â·ìŠ¤ìœ„ì¹˜Â·ì „ë ¥ ë¹„ìš©</strong>ì´ ë²½ì´ ëë‹¤. PCIe GPU í´ëŸ¬ìŠ¤í„°ëŠ” ì €ë ´í•˜ì§€ë§Œ <strong>(1) GPUâ†”NIC P2P 4 GB/s ë³‘ëª©, (2) íŒŒì´í”„ë¼ì¸ ì¶©ëŒ, (3) ë„¤íŠ¸ì›Œí¬ í˜¼ì¡</strong> ë•Œë¬¸ì— 1 ì²œ ëŒ€ ì´ìƒìœ¼ë¡œ ì˜ í™•ì¥ë˜ì§€ ëª»í–ˆë‹¤. Fire-Flyer 2 íŒ€ì€ â€œ<strong>ì €ê°€ PCIe ì¹´ë“œë¡œë„ DGX ê¸‰ LLM í›ˆë ¨ì´ ê°€ëŠ¥í• ê¹Œ?</strong>â€ë¼ëŠ” ì§ˆë¬¸ì„ ì •ë©´ ëŒíŒŒí–ˆë‹¤.</p><h2 id=ìƒˆë¡œìš´-ì ‘ê·¼ë²•-fire-flyer-2--hfreduce>ìƒˆë¡œìš´ ì ‘ê·¼ë²•: <strong>Fire-Flyer 2 + HFReduce</strong></h2><table><thead><tr><th>ì¸µìœ„</th><th>êµ¬ì„± ìš”ì†Œ</th><th>í•œ ì¤„ ì„¤ëª…</th></tr></thead><tbody><tr><td><strong>í•˜ë“œì›¨ì–´</strong></td><td>8 Ã— PCIe A100 40 GB + 1 Ã— 200 Gb IB NIC/ë…¸ë“œ</td><td>NVSwitchÂ·PCIe ìŠ¤ìœ„ì¹˜ ì—†ì´ CPU ì§ê²°</td></tr><tr><td><strong>ë„¤íŠ¸ì›Œí¬</strong></td><td>2 - ë‹¨ Fat-Tree (122 ìŠ¤ìœ„ì¹˜)</td><td>DGX ë™ê·œëª¨ ëŒ€ë¹„ ìŠ¤ìœ„ì¹˜ ìˆ˜ -90 %</td></tr><tr><td><strong>í†µì‹  ìŠ¤íƒ</strong></td><td><strong>HFReduce</strong></td><td>GPU-D2H â†’ CPU SIMD â†’ Double-Binary-Tree RDMA â†’ H2D ë‘ ë²ˆ ì „ì†¡ë§Œ ì‚¬ìš©</td></tr><tr><td><strong>ë³‘ë ¬í™”</strong></td><td><strong>HaiScale DDP/FSDP</strong></td><td>HFReduce ë°°ê²½ì—ì„œ ê³„ì‚°-í†µì‹  ì™„ì „ ì˜¤ë²„ë©</td></tr><tr><td><strong>ìŠ¤í† ë¦¬ì§€</strong></td><td>3FS DFS</td><td>ê³„ì‚°Â·ìŠ¤í† ë¦¬ì§€ í†µí•© íŒ¨ë¸Œë¦­ ìœ ì§€</td></tr></tbody></table><h2 id=ì‘ë™-ì›ë¦¬-33-í”½ì…€-í† ì´-ì˜ˆì‹œ>ì‘ë™ ì›ë¦¬: 3Ã—3 í”½ì…€ í† ì´ ì˜ˆì‹œ</h2><ol><li><strong>D2H</strong>â€‚â€” ê° GPU gradient <code>Dg</code> ë¥¼ CPU RAMìœ¼ë¡œ ë¹„ë™ê¸° ë³µì‚¬.</li><li><strong>Intra-node Reduce</strong>â€‚â€” CPU SIMD addë¡œ 8 GPU ë°ì´í„°ë¥¼ <code>Dc</code> ë¡œ í•©ì‚°.</li><li><strong>Inter-node All-Reduce</strong>â€‚â€” Double-Binary-Tree RDMAë¡œ ë…¸ë“œ ê°„ <code>Dc</code> êµí™˜Â·ê°ì¶•(1 RTT).</li><li><strong>H2D</strong>â€‚â€” ìµœì¢… ê²°ê³¼ë¥¼ ëª¨ë“  GPUë¡œ ë‹¤ì‹œ ë³µì‚¬.</li></ol><p>ì˜ˆ) ë‘ ë…¸ë“œ Ã— 4 GPU, ê° 3 Ã— 3 í–‰ë ¬: <code>[[1â€¦]], [[2â€¦]], [[3â€¦]], [[4â€¦]]</code> â†’ ìµœì¢… <code>[[10â€¦]]</code> í–‰ë ¬ì´ ë„¤ GPUì— ë™ì¼í•˜ê²Œ ë°°í¬ëœë‹¤. GPU ì»¤ë„ì€ í•œ ë²ˆë„ ì‹¤í–‰ë˜ì§€ ì•Šìœ¼ë¯€ë¡œ ë°±ì›Œë“œ ê³„ì‚°ê³¼ 100 % ê²¹ì¹œë‹¤.</p><h2 id=ì„±ëŠ¥-ê²€ì¦-ì£¼ìš”-ê²°ê³¼>ì„±ëŠ¥ ê²€ì¦: ì£¼ìš” ê²°ê³¼</h2><table><thead><tr><th>ì§€í‘œ</th><th>Fire-Flyer 2</th><th>DGX-A100 / NCCL</th><th>ê°œì„ í­</th></tr></thead><tbody><tr><td><strong>All-Reduce BW</strong></td><td><strong>6.3â€“8.1 GB/s</strong></td><td>1.6â€“4.8 GB/s</td><td>â–² ìµœëŒ€ 5 Ã—</td></tr><tr><td><strong>VGG16 ì•½í•œ ìŠ¤ì¼€ì¼</strong></td><td><strong>88 %</strong> íš¨ìœ¨ (32â†’512 GPU)</td><td>46 %</td><td>2 Ã— ë¹ ë¦„</td></tr><tr><td><strong>GPT-2-M ì•½í•œ ìŠ¤ì¼€ì¼</strong></td><td><strong>95 %</strong> íš¨ìœ¨ (16â†’128 GPU)</td><td>60 %</td><td>+35 pp</td></tr><tr><td><strong>LLaMA-13B ê°•í•œ ìŠ¤ì¼€ì¼</strong></td><td><strong>9.7 s/step, 91 %</strong> (64â†’512 GPU)</td><td>â€”</td><td>â€”</td></tr><tr><td><strong>Cost-Perf Ratio</strong></td><td><strong>1.38</strong></td><td>1.00</td><td>+38 %</td></tr><tr><td><strong>ë…¸ë“œ ì „ë ¥</strong></td><td><strong>2.5 kW</strong></td><td>4.2 kW</td><td>-40 %</td></tr></tbody></table><h2 id=ìš°ë¦¬ì˜-ê´€ì -ê°•ì -í•œê³„-ê·¸ë¦¬ê³ -ì´-ì—°êµ¬ê°€-ì¤‘ìš”í•œ-ì´ìœ >ìš°ë¦¬ì˜ ê´€ì : ê°•ì , í•œê³„, ê·¸ë¦¬ê³  ì´ ì—°êµ¬ê°€ ì¤‘ìš”í•œ ì´ìœ </h2><h3 id=ê°•ì ->ê°•ì  ğŸŒŸ</h3><ul><li><strong>ê°€ì„±ë¹„</strong> â€” ì„±ëŠ¥ 83 %ì— ë¹„ìš©Â·ì „ë ¥ 60 % â‡’ Cost-Perf +38 %.</li><li><strong>ì„ í˜• í™•ì¥</strong> â€” 10 k GPUê¹Œì§€ All-Reduce ëŒ€ì—­Â·í•™ìŠµ íš¨ìœ¨ ë¶•ê´´ ì—†ìŒ.</li><li><strong>ì†Œí”„íŠ¸ì›¨ì–´ ì™„ì„±ë„</strong> â€” HFReduceÂ·HaiScaleÂ·3FSÂ·HAI Platform ì „ì²´ ìŠ¤íƒ ê³µê°œ.</li></ul><h3 id=í•œê³„->í•œê³„ âš ï¸</h3><ul><li><strong>GEMM 17 % ì†ì‹¤</strong> â€” PCIe ì¹´ë“œ í´ëŸ­Â·ì „ë ¥ í•œê³„.</li><li><strong>MoE 640 GPU íš¨ìœ¨ 76 %</strong> â€” GPU:NIC 8:1 êµ¬ì¡°ë¡œ all-to-all ë³‘ëª© .</li><li><strong>CPU ë©”ëª¨ë¦¬ 24Ã— I/O</strong> â€” 8 GB/s &lt; ì´ë¡  12 GB/s, DRAM ì „ë ¥Â·ë°œì—´ ë¶€ë‹´ .</li></ul><h3 id=ì™œ-ì¤‘ìš”í•œê°€->ì™œ ì¤‘ìš”í•œê°€? ğŸš€</h3><p>ë¹„ì‹¼ SXM GPU/ìŠ¤ìœ„ì¹˜ì— ë¬¶ì´ì§€ ì•Šê³  **â€œì—°êµ¬ì†ŒÂ·ìŠ¤íƒ€íŠ¸ì—…ë„ 10 k GPU LLM í›ˆë ¨â€**ì„ ì‹¤í˜„í•  ì‹¤ì¦ ë°ì´í„°ë¥¼ ì²˜ìŒìœ¼ë¡œ ì œì‹œí–ˆë‹¤.</p><h2 id=ë‹¤ìŒ-ë‹¨ê³„ëŠ”>ë‹¤ìŒ ë‹¨ê³„ëŠ”?</h2><ol><li><strong>1 GPU : 1 NIC</strong> ë…¸ë“œë¡œ MoE all-to-all ë³‘ëª© ì œê±°</li><li><strong>Multi-Plane Fat-Tree 32 k GPU í™•ì¥</strong> ë° <strong>400 Gb RoCE</strong> ì „í™˜ ê²€í† </li><li><strong>PCIe 5.0 / CXL</strong> ì±„íƒ, DRAM I/O ìµœì í™” â†’ HFReduce v2 10 GB/s+ ëª©í‘œ.</li></ol><p>Fire-Flyer 2ëŠ” â€œí†µì‹  ë³‘ëª©ë§Œ ì¡ìœ¼ë©´ ì €ê°€ PCIe GPUë„ ì´ˆëŒ€ê·œëª¨ LLM ì‹œëŒ€ì— í†µí•œë‹¤â€ëŠ” ì‚¬ì‹¤ì„ ì…ì¦í–ˆë‹¤. ì•ìœ¼ë¡œì˜ ì—°êµ¬ëŠ” <strong>ë„¤íŠ¸ì›Œí¬ í‰ë©´ ë‹¤ì¤‘í™”Â·NIC ì¦ì„¤Â·ì—ë„ˆì§€ ê±°ë²„ë„ŒìŠ¤</strong>ë¡œ ì´ ì„¤ê³„ë¥¼ í•œì¸µ í™•ì¥í•  ê²ƒì´ë‹¤.</p><hr><h3 id=í† ê¸€ì„-í´ë¦­í•˜ë©´-ë…¼ë¬¸ì—-ëŒ€í•œ-ìì„¸í•œ-llm-ì§ˆì˜ì‘ë‹µ-ë‚´ìš©ì„-í™•ì¸í• -ìˆ˜-ìˆìŠµë‹ˆë‹¤>í† ê¸€ì„ í´ë¦­í•˜ë©´ ë…¼ë¬¸ì— ëŒ€í•œ ìì„¸í•œ LLM ì§ˆì˜ì‘ë‹µ ë‚´ìš©ì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</h3><details markdown=block><summary>â–¶ï¸<strong>í´ë¦­í•˜ì—¬ í¼ì¹˜ê¸°</strong></summary><h1 id=í”„ë¡¬í”„íŠ¸-111-ì—°êµ¬ì˜-ê³µë°±>í”„ë¡¬í”„íŠ¸ 1.1.1 (ì—°êµ¬ì˜ ê³µë°±)</h1><div class="code-block-container border-border bg-card my-6 overflow-hidden rounded-xl border shadow-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:shadow-md"><div class="code-block-header bg-muted/30 border-border flex items-center justify-between border-b px-4 py-3"><div class="flex items-center gap-2"><div class="text-muted-foreground flex-shrink-0"><svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4 4 4-4 4M6 16l-4-4 4-4"/></svg></div><span class="text-muted-foreground text-sm font-medium">PLAINTEXT</span></div><div class="flex items-center gap-2"><button class="collapse-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-0 data-default-state=expanded data-collapsed=false data-auto-collapse-lines=30 data-auto-collapse-height=400 data-collapsed-height=120 title=ì ‘ê¸° aria-label=ì ‘ê¸°>
<span class=collapse-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41 12 10.83l4.59 4.58L18 14l-6-6-6 6z"/></svg>
</span><span class="collapse-text hidden sm:inline">ì ‘ê¸°</span>
</button>
<button class="copy-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-0 title=ë³µì‚¬ aria-label=ë³µì‚¬>
<span class=copy-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/></svg>
</span><span class="copy-text hidden sm:inline">ë³µì‚¬</span></button></div></div><div class="code-block-content relative" id=code-0><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=ln>1</span><span class=cl>&#34;ë…¼ë¬¸ì˜ &#39;Introduction&#39;ê³¼ &#39;Related Work&#39; ì„¹ì…˜ì„ ë¶„ì„í•˜ì—¬, ì´ ì—°êµ¬ê°€ ëª…ì‹œì ìœ¼ë¡œ í•´ê²°í•˜ê³ ì í•˜ëŠ” í•µì‹¬ì ì¸ ì—°êµ¬ ê³µë°±(research gap), ê¸°ì¡´ ì—°êµ¬ì˜ ê²°ì •ì  í•œê³„, ë˜ëŠ” ë¯¸í•´ê²° ì§ˆë¬¸ì´ ë¬´ì—‡ì¸ì§€ ì„¤ëª…í•´ ì¤˜. ì €ìë“¤ì´ ì„¤ëª…í•˜ëŠ”, ì´ ë…¼ë¬¸ ì¶œíŒ ì‹œì ì˜ &#39;ìµœì‹  ê¸°ìˆ (state of the art)&#39;ì€ ì–´ë–¤ ìƒíƒœì˜€ëŠ”ì§€ ìš”ì•½í•´ ì¤˜.&#34;</span></span></code></pre></div><div class="collapse-overlay to-card/90 pointer-events-none absolute inset-0 bg-gradient-to-b from-transparent via-transparent opacity-0 transition-opacity duration-300"><div class="text-muted-foreground bg-card/80 border-border/50 hover:bg-primary/10 hover:text-primary hover:border-primary/30 absolute bottom-4 left-1/2 -translate-x-1/2 cursor-pointer rounded-full border px-3 py-1.5 text-xs backdrop-blur-sm transition-all duration-200">í´ë¦­í•˜ì—¬ ë” ë³´ê¸°</div></div></div></div><script>(function(){const s="code-0",n=document.querySelector('.copy-code-btn[data-code-id="'+s+'"]'),t=document.querySelector('.collapse-code-btn[data-code-id="'+s+'"]'),e=document.getElementById(s);if(!e)return;if(n){const s=n.querySelector(".copy-icon"),t=n.querySelector(".copy-text");n.addEventListener("click",async function(){try{let o="";const i=e.querySelector(".lntd:last-child code");if(i)o=i.textContent||i.innerText;else{const t=e.querySelector("code");if(t){const e=t.querySelector(".ln");if(e){const e=t.querySelectorAll(".cl");if(e.length>0)o=Array.from(e).map(e=>{const t=e.textContent||e.innerText;return t.replace(/\n+$/,"")}).join(`
`).replace(/\n+$/,"");else{const e=t.textContent||t.innerText;o=e.replace(/^\d+/gm,"").replace(/^\s+/gm,"")}}else o=t.textContent||t.innerText}else o=e.textContent||e.innerText}o=o.trim(),await navigator.clipboard.writeText(o),s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
</svg>`,t&&(t.textContent="ë³µì‚¬ë¨"),n.classList.add("text-green-600"),setTimeout(()=>{s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
</svg>`,t&&(t.textContent="ë³µì‚¬"),n.classList.remove("text-green-600")},2e3)}catch(o){console.error("å¤åˆ¶å¤±è´¥:",o);const s=document.createRange(),i=e.querySelector("code")||e;s.selectNodeContents(i);const n=window.getSelection();n.removeAllRanges(),n.addRange(s),t&&(t.textContent="ì„ íƒë¨"),setTimeout(()=>{t&&(t.textContent="ë³µì‚¬"),n.removeAllRanges()},2e3)}})}if(t){const d=t.querySelector(".collapse-icon"),c=t.querySelector(".collapse-text"),n=e.querySelector(".collapse-overlay");let s=e.querySelector("pre.chroma");s||(s=e.querySelector("pre"));const m=t.dataset.defaultState||"expanded",f=t.dataset.collapsed==="true",u=parseInt(t.dataset.autoCollapseLines)||30,h=parseInt(t.dataset.autoCollapseHeight)||400,p=parseInt(t.dataset.collapsedHeight)||120;let l=!1;function i(){const e=f||m==="collapsed"||a();e&&o(!0,!1)}function a(){if(s){const e=s.querySelectorAll(".line, .cl"),t=s.offsetHeight;return e.length>u||t>h}const t=e.offsetHeight;if(t>h)return!0;const n=e.textContent||e.innerText||"",o=n.split(`
`).length;return o>u}function o(s,o=!0){if(!n)return;l=s,s?(e.style.maxHeight=p+"px",e.style.overflow="hidden",n.style.opacity="1",n.style.pointerEvents="auto",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
</svg>`,c&&(c.textContent="í¼ì¹˜ê¸°"),t.title="í¼ì¹˜ê¸°"):(e.style.maxHeight="",e.style.overflow="",n.style.opacity="0",n.style.pointerEvents="none",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z"/></svg>`,c&&(c.textContent="ì ‘ê¸°"),t.title="ì ‘ê¸°"),o&&(e.style.transition="max-height 0.3s ease-out",setTimeout(()=>{e.style.transition=""},300))}function r(){o(!l,!0)}t.addEventListener("click",r),n&&n.addEventListener("click",()=>{l&&o(!1,!0)}),i()}})()</script><p><strong>TL;DR â€” ì—°êµ¬ ê³µë°± í•œ ì¤„ ìš”ì•½</strong>
ëŒ€ê·œëª¨ LLM í›ˆë ¨ì— ìš”êµ¬ë˜ëŠ” ë§‰ëŒ€í•œ í†µì‹ Â·ì €ì¥ ì„±ëŠ¥ì„ DGX-A100 ê°™ì€ ê³ ê°€ NVLink ê¸°ë°˜ ì‹œìŠ¤í…œ ì—†ì´, <em>10 000 ëŒ€ PCIe A100 GPU</em>ë§Œìœ¼ë¡œ ë‹¬ì„±í•  ìˆ˜ ìˆëŠ” <strong>ë¹„ìš©Â·ì „ë ¥ íš¨ìœ¨ AI-HPC ì•„í‚¤í…ì²˜</strong>ê°€ ë¶€ì¬í–ˆë‹¤. Fire-Flyer 2ëŠ” <em>ë¹„ìš© 50 %Â·ì „ë ¥ 40 % ì ˆê°</em>ìœ¼ë¡œ <em>DGX ëŒ€ë¹„ â‰ˆ 80 %</em> ì„±ëŠ¥ì„ ì…ì¦í•˜ë©° ì´ ê³µë°±ì„ ë©”ì› ë‹¤.</p><hr><h2 id=1-í•µì‹¬-ì—°êµ¬-ê³µë°±-ë°-ë¯¸í•´ê²°-ì§ˆë¬¸>1. í•µì‹¬ ì—°êµ¬ ê³µë°± ë° ë¯¸í•´ê²° ì§ˆë¬¸</h2><table><thead><tr><th>ë¬¸ì œ ì˜ì—­</th><th>ê¸°ì¡´ í•œê³„ / ë¯¸í•´ê²° ì§ˆë¬¸</th><th>Fire-Flyer 2ê°€ ì œì‹œí•œ í•´ê²°ì±…</th></tr></thead><tbody><tr><td><strong>í•˜ë“œì›¨ì–´ ë¹„ìš© í­ì¦</strong></td><td>NVLink-SXM ì„œë²„(DGX A100/H100) ì¤‘ì‹¬ ì„¤ê³„ â†’ ì„œë²„Â·ìŠ¤ìœ„ì¹˜Â·ì „ë ¥ ë¹„ìš© ê¸‰ë“±</td><td>PCIe A100 + ë‹¨ì¼ 200 Gb IB NIC(10 k GPU)ë¡œ <em>ì„œë²„ ë¹„ìš© 40 % â†“</em></td></tr><tr><td><strong>í†µì‹  ë³‘ëª© (All-Reduce)</strong></td><td>NCCL ring + PCIe P2P: EPYC Rome CPUì˜ <em>chained write ë¯¸ì§€ì›</em> íƒ“ì— 4 GB/s ì´í•˜</td><td>HFReduce(Double Binary Tree) â†’ 8â€“10 GB/s, NVLink ì¶”ê°€ ì‹œ 10 GB/s+</td></tr><tr><td><strong>ë„¤íŠ¸ì›Œí¬ í˜¼ì¡</strong></td><td>ê³„ì‚°Â·ìŠ¤í† ë¦¬ì§€ íŠ¸ë˜í”½ì´ ë¶„ë¦¬ë˜ì§€ ì•Šì•„ HOL blocking, IB DCQCN íŒŒë¼ë¯¸í„° íŠœë‹ ë‚œí•´</td><td><em>ì»´í“¨í…Œì´ì…˜-ìŠ¤í† ë¦¬ì§€ í†µí•© 2-ë‹¨ Fat-Tree</em> + SL/VL ê²©ë¦¬Â·ì •ì  ë¼ìš°íŒ…</td></tr><tr><td><strong>ëŒ€ê·œëª¨ GPU ì‚´ë ¤ë‘ê¸°(ì•ˆì •ì„±)</strong></td><td>ìˆ˜ì²œ GPU í™˜ê²½ì—ì„œ Xid 74 (NVLink), ECC Error, IB Flash Cut ëŒ€ì²˜ ê²½í—˜ ë¶€ì¡±</td><td>ì£¼ 5 ë¶„ ì²´í¬í¬ì¸íŠ¸+Validator íˆ´ â†’ ìˆ˜ê°œì›” í›ˆë ¨ ì¤‘ë‹¨ ì‹œê°„ <em>&lt;= 5 ë¶„</em></td></tr></tbody></table><blockquote class="border-primary bg-muted/30 hover:bg-muted/40 my-6 rounded-r-lg border-l-4 py-4 pr-4 pl-6 italic transition-all duration-200 ease-out hover:translate-x-1"><div class="prose prose-sm max-w-none"><p><strong>ì—°êµ¬ ì§ˆë¬¸</strong>
â€œPCIe GPU ê¸°ë°˜ ëŒ€ê·œëª¨ í´ëŸ¬ìŠ¤í„°ê°€ ë¹„ìš©-ì„±ëŠ¥, ì „ë ¥, ì•ˆì •ì„± ì¸¡ë©´ì—ì„œ NVLink SXM ì•„í‚¤í…ì²˜ë¥¼ ëŒ€ì²´í•  ìˆ˜ ìˆëŠ”ê°€?â€ â€” Fire-Flyer 2ê°€ ì²˜ìŒìœ¼ë¡œ ë°ì´í„°(10 k GPU)ë¡œ ë‹µí–ˆë‹¤.</p></div></blockquote><hr><h2 id=2-ë…¼ë¬¸-ë°œí‘œ-ì‹œì ì˜-ìµœì‹ -ê¸°ìˆ sota-ìš”ì•½>2. ë…¼ë¬¸ ë°œí‘œ ì‹œì ì˜ â€˜ìµœì‹  ê¸°ìˆ (SOTA)â€™ ìš”ì•½</h2><table><thead><tr><th>ë¶„ë¥˜</th><th>ëŒ€í‘œ ì‹œìŠ¤í…œ</th><th>íŠ¹ì§•</th><th>í•œê³„</th></tr></thead><tbody><tr><td><strong>NVLink SXM ì„œë²„</strong></td><td>NVIDIA DGX-A100 (8 Ã— SXM, 9 NIC)</td><td><em>131 TFLOPS FP16/GPU</em>, NVSwitch 600 GB/s, 3-ê³„ì¸µ Fat-Tree ê¶Œì¥</td><td>ë¹„ìš©Â·ì „ë ¥ â†‘, ìŠ¤ìœ„ì¹˜<em>1320 ê°œ</em>, êµ¬ì¶•ë¹„ â‰ˆ 2.3 ì–µ USD(ë¹„êµ ê¸°ì¤€)</td></tr><tr><td><strong>GPU-ê¸°ë°˜ ìŠˆí¼ì»´</strong></td><td>Frontier, Summit</td><td>HBM GPU + NVLink + Dragonfly/Fat-Tree</td><td>FP64 HPC ì¤‘ì‹¬, FP16 DLì—” ìµœì í™” ë¯¸í¡</td></tr><tr><td><strong>ëŒ€í˜• í…Œí¬ ê¸°ì—… í´ëŸ¬ìŠ¤í„°</strong></td><td>Meta RoCE(11 k GPU), ByteDance 10 k NVLink</td><td>ë§ì¶¤ SW ìŠ¤íƒ, ê³ ê°€ IB/RoCE ìŠ¤ìœ„ì¹˜</td><td>CAPEX í­ì¦, ê³µê°œì  ë¹„ìš©Â·ì „ë ¥ ë°ì´í„° ë¶€ì¡±</td></tr><tr><td><strong>AI DSA(Dojo, TPUv4)</strong></td><td>ì›¨ì´í¼-ìŠ¤ì¼€ì¼/ê´‘ ìŠ¤ìœ„ì¹˜</td><td>ì´ˆê³ ì† ì˜¨ì¹© íŒ¨ë¸Œë¦­</td><td>NVIDIA ìƒíƒœê³„ ëŒ€ë¹„ SW ë¯¸ì„±ìˆ™</td></tr></tbody></table><blockquote class="border-primary bg-muted/30 hover:bg-muted/40 my-6 rounded-r-lg border-l-4 py-4 pr-4 pl-6 italic transition-all duration-200 ease-out hover:translate-x-1"><div class="prose prose-sm max-w-none"><p>ì •ë¦¬í•˜ë©´ 2024ë…„ ê¸°ì¤€ SOTAëŠ” <strong>ê³ ì„±ëŠ¥ì´ì§€ë§Œ ê³ ê°€</strong>ì¸ NVLink SXM DGX ì•„í‚¤í…ì²˜ì˜€ìœ¼ë©°, <em>PCIe ê¸°ë°˜ìœ¼ë¡œ 10 k GPU ê·œëª¨ë¥¼ ë¹„ìš© íš¨ê³¼ì ìœ¼ë¡œ</em> ìš´ì˜í•œ ê³µê°œ ì‚¬ë¡€ê°€ ì „ë¬´í–ˆë‹¤.</p></div></blockquote><hr><h2 id=3-fire-flyer-2ê°€-ë©”ìš´-ê³µë°±ì˜-ì˜ì˜-ìˆ«ìë¡œ-ë³´ëŠ”-ì¸ì‚¬ì´íŠ¸>3. Fire-Flyer 2ê°€ ë©”ìš´ ê³µë°±ì˜ ì˜ì˜ (ìˆ«ìë¡œ ë³´ëŠ” ì¸ì‚¬ì´íŠ¸)</h2><table><thead><tr><th>ì§€í‘œ</th><th>Fire-Flyer 2 (PCIe A100)</th><th>DGX-A100</th><th>ë¹„ê³ </th></tr></thead><tbody><tr><td>GPU ê°œìˆ˜</td><td><strong>10 000</strong></td><td>10 000 (ê°€ì •)</td><td>ë™ì¼ ìŠ¤ì¼€ì¼</td></tr><tr><td>TF32/FP16 GEMM</td><td><strong>83 %</strong></td><td>100 %</td><td>GPU ë‚´ì—°ì‚°</td></tr><tr><td>í´ëŸ¬ìŠ¤í„° êµ¬ì¶•ë¹„</td><td><strong>â‰ˆ 50 %</strong></td><td>100 %</td><td>ì„œë²„+ë„¤íŠ¸ì›Œí¬</td></tr><tr><td>ì „ë ¥ ì†Œëª¨</td><td><strong>â‰ˆ 60 %</strong></td><td>100 %</td><td>4 MW â†˜ï¸ â‰ˆ 3 MW</td></tr><tr><td>All-Reduce BW</td><td><strong>8â€“10 GB/s</strong></td><td>6â€“8 GB/s (NVLink ring)</td><td>PCIe ê¸°ë°˜ì—ë„ ìš°ìœ„</td></tr><tr><td>LLaMA-13B 512â†’64 GPU ìŠ¤ì¼€ì¼ íš¨ìœ¨</td><td><strong>91 %</strong></td><td>ê³µê°œì¹˜ ì—†ìŒ</td><td>HaiScale DDP</td></tr></tbody></table><hr><h2 id=4-ì™œ-ì´-ê³µë°±ì´-ì¤‘ìš”í–ˆë‚˜>4. ì™œ ì´ ê³µë°±ì´ ì¤‘ìš”í–ˆë‚˜?</h2><ol><li><strong>ê²½ì œì„±</strong> â€“ ë™ì¼ ì„±ëŠ¥ ëŒ€ë¹„ CAPEXÂ·OPEXë¥¼ ëŒ€í­ ì ˆê°í•´ <em>ì—°êµ¬ ê¸°ê´€Â·ìŠ¤íƒ€íŠ¸ì—…ë„ LLM í›ˆë ¨ ì§„ì… ê°€ëŠ¥</em>.</li><li><strong>ì§€ì† ê°€ëŠ¥ì„±</strong> â€“ ì „ë ¥ 40 % ì ˆê°ì€ COâ‚‚ ë°°ì¶œì„ ì§ì ‘ ê°ì†Œ.</li><li><strong>í‘œì¤€ PCIe ìƒíƒœê³„ í™œìš©</strong> â€“ íŠ¹ì • ë²¤ë” ê³ ê°€ ë¶€í’ˆ ì¢…ì†ë„ ì™„í™”.</li><li><strong>í™•ì¥ì„±Â·ì•ˆì •ì„± ê²€ì¦</strong> â€“ 10 k GPU PCIe ì‹œìŠ¤í…œì˜ <em>ì¥ê¸°ê°„ ì‹¤ì„œë¹„ìŠ¤ ìš´ì˜ ë°ì´í„°</em> ìµœì´ˆ ê³µê°œ.</li></ol><hr><h2 id=5-ì •ë¦¬>5. ì •ë¦¬</h2><blockquote class="border-primary bg-muted/30 hover:bg-muted/40 my-6 rounded-r-lg border-l-4 py-4 pr-4 pl-6 italic transition-all duration-200 ease-out hover:translate-x-1"><div class="prose prose-sm max-w-none"><p><strong>ì—°êµ¬ì˜ ë¹ˆì¹¸</strong>ì€ â€œ<em>â€˜ì €ë ´í•œ PCIe GPUë¡œ ì´ˆëŒ€ê·œëª¨ LLM í›ˆë ¨ì´ ê°€ëŠ¥í•œê°€?â€™</em>â€ì˜€ë‹¤. Fire-Flyer 2ëŠ” <strong>HFReduce í†µì‹  ìŠ¤íƒ, 2-ë‹¨ Fat-Tree ì„¤ê³„, 3FS ìŠ¤í† ë¦¬ì§€</strong>ë¥¼ í†µí•´ ì´ ì§ˆë¬¸ì— â€˜ì˜ˆâ€™ë¼ê³  ë‹µí–ˆìœ¼ë©°, SOTA NVLink ì•„í‚¤í…ì²˜ ëŒ€ë¹„ **ì„±ëŠ¥ 80 %Â·ë¹„ìš© 50 %Â·ì „ë ¥ 60 %**ë¼ëŠ” êµ¬ì²´ì  ìˆ˜ì¹˜ë¡œ ì´ë¥¼ ì…ì¦í–ˆë‹¤.</p></div></blockquote><h1 id=í”„ë¡¬í”„íŠ¸-112-í•µì‹¬-ê°€ì„¤>í”„ë¡¬í”„íŠ¸ 1.1.2 (í•µì‹¬ ê°€ì„¤)</h1><div class="code-block-container border-border bg-card my-6 overflow-hidden rounded-xl border shadow-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:shadow-md"><div class="code-block-header bg-muted/30 border-border flex items-center justify-between border-b px-4 py-3"><div class="flex items-center gap-2"><div class="text-muted-foreground flex-shrink-0"><svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4 4 4-4 4M6 16l-4-4 4-4"/></svg></div><span class="text-muted-foreground text-sm font-medium">PLAINTEXT</span></div><div class="flex items-center gap-2"><button class="collapse-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-1 data-default-state=expanded data-collapsed=false data-auto-collapse-lines=30 data-auto-collapse-height=400 data-collapsed-height=120 title=ì ‘ê¸° aria-label=ì ‘ê¸°>
<span class=collapse-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41 12 10.83l4.59 4.58L18 14l-6-6-6 6z"/></svg>
</span><span class="collapse-text hidden sm:inline">ì ‘ê¸°</span>
</button>
<button class="copy-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-1 title=ë³µì‚¬ aria-label=ë³µì‚¬>
<span class=copy-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/></svg>
</span><span class="copy-text hidden sm:inline">ë³µì‚¬</span></button></div></div><div class="code-block-content relative" id=code-1><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=ln>1</span><span class=cl>&#34;ì´ ë…¼ë¬¸ì˜ ì¤‘ì‹¬ ê°€ì„¤(central hypothesis) ë˜ëŠ” í•µì‹¬ ì£¼ì¥ì€ ë¬´ì—‡ì¸ê°€? &#39;ì €ìë“¤ì€ [ì œì•ˆ ê¸°ë²•]ì„ ì‚¬ìš©í•¨ìœ¼ë¡œì¨ [ê¸°ì¡´ í•œê³„ì ]ì„ ê·¹ë³µí•˜ëŠ” [êµ¬ì²´ì  ê²°ê³¼]ë¥¼ ë‹¬ì„±í•  ìˆ˜ ìˆë‹¤ê³  ê°€ì •í•œë‹¤&#39;ì™€ ê°™ì€ í˜•ì‹ìœ¼ë¡œ, ëª…í™•í•˜ê³  ê°„ê²°í•œ í•œ ë¬¸ì¥ìœ¼ë¡œ ì„œìˆ í•´ ì¤˜.&#34;</span></span></code></pre></div><div class="collapse-overlay to-card/90 pointer-events-none absolute inset-0 bg-gradient-to-b from-transparent via-transparent opacity-0 transition-opacity duration-300"><div class="text-muted-foreground bg-card/80 border-border/50 hover:bg-primary/10 hover:text-primary hover:border-primary/30 absolute bottom-4 left-1/2 -translate-x-1/2 cursor-pointer rounded-full border px-3 py-1.5 text-xs backdrop-blur-sm transition-all duration-200">í´ë¦­í•˜ì—¬ ë” ë³´ê¸°</div></div></div></div><script>(function(){const s="code-1",n=document.querySelector('.copy-code-btn[data-code-id="'+s+'"]'),t=document.querySelector('.collapse-code-btn[data-code-id="'+s+'"]'),e=document.getElementById(s);if(!e)return;if(n){const s=n.querySelector(".copy-icon"),t=n.querySelector(".copy-text");n.addEventListener("click",async function(){try{let o="";const i=e.querySelector(".lntd:last-child code");if(i)o=i.textContent||i.innerText;else{const t=e.querySelector("code");if(t){const e=t.querySelector(".ln");if(e){const e=t.querySelectorAll(".cl");if(e.length>0)o=Array.from(e).map(e=>{const t=e.textContent||e.innerText;return t.replace(/\n+$/,"")}).join(`
`).replace(/\n+$/,"");else{const e=t.textContent||t.innerText;o=e.replace(/^\d+/gm,"").replace(/^\s+/gm,"")}}else o=t.textContent||t.innerText}else o=e.textContent||e.innerText}o=o.trim(),await navigator.clipboard.writeText(o),s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
</svg>`,t&&(t.textContent="ë³µì‚¬ë¨"),n.classList.add("text-green-600"),setTimeout(()=>{s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
</svg>`,t&&(t.textContent="ë³µì‚¬"),n.classList.remove("text-green-600")},2e3)}catch(o){console.error("å¤åˆ¶å¤±è´¥:",o);const s=document.createRange(),i=e.querySelector("code")||e;s.selectNodeContents(i);const n=window.getSelection();n.removeAllRanges(),n.addRange(s),t&&(t.textContent="ì„ íƒë¨"),setTimeout(()=>{t&&(t.textContent="ë³µì‚¬"),n.removeAllRanges()},2e3)}})}if(t){const d=t.querySelector(".collapse-icon"),c=t.querySelector(".collapse-text"),n=e.querySelector(".collapse-overlay");let s=e.querySelector("pre.chroma");s||(s=e.querySelector("pre"));const m=t.dataset.defaultState||"expanded",f=t.dataset.collapsed==="true",u=parseInt(t.dataset.autoCollapseLines)||30,h=parseInt(t.dataset.autoCollapseHeight)||400,p=parseInt(t.dataset.collapsedHeight)||120;let l=!1;function i(){const e=f||m==="collapsed"||a();e&&o(!0,!1)}function a(){if(s){const e=s.querySelectorAll(".line, .cl"),t=s.offsetHeight;return e.length>u||t>h}const t=e.offsetHeight;if(t>h)return!0;const n=e.textContent||e.innerText||"",o=n.split(`
`).length;return o>u}function o(s,o=!0){if(!n)return;l=s,s?(e.style.maxHeight=p+"px",e.style.overflow="hidden",n.style.opacity="1",n.style.pointerEvents="auto",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
</svg>`,c&&(c.textContent="í¼ì¹˜ê¸°"),t.title="í¼ì¹˜ê¸°"):(e.style.maxHeight="",e.style.overflow="",n.style.opacity="0",n.style.pointerEvents="none",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z"/></svg>`,c&&(c.textContent="ì ‘ê¸°"),t.title="ì ‘ê¸°"),o&&(e.style.transition="max-height 0.3s ease-out",setTimeout(()=>{e.style.transition=""},300))}function r(){o(!l,!0)}t.addEventListener("click",r),n&&n.addEventListener("click",()=>{l&&o(!1,!0)}),i()}})()</script><blockquote class="border-primary bg-muted/30 hover:bg-muted/40 my-6 rounded-r-lg border-l-4 py-4 pr-4 pl-6 italic transition-all duration-200 ease-out hover:translate-x-1"><div class="prose prose-sm max-w-none"><p>ì €ìë“¤ì€ <strong>HFReduceê°€ íƒ‘ì¬ëœ Fire-Flyer 2(10 000 Ã— PCIe A100) ì•„í‚¤í…ì²˜</strong>ë¥¼ ì‚¬ìš©í•¨ìœ¼ë¡œì¨ NVLink-SXM ê¸°ë°˜ DGX-A100 í´ëŸ¬ìŠ¤í„°ì˜ <strong>ë†’ì€ ì¥ë¹„Â·ì „ë ¥ ë¹„ìš©</strong> í•œê³„ë¥¼ ê·¹ë³µí•˜ê³ , <strong>LLM í›ˆë ¨ì—ì„œ ë™ê¸‰(â‰ˆ 80 â€“ 100 %) ì„±ëŠ¥ì„ êµ¬ì¶•ë¹„ 50 %Â·ì „ë ¥ 40 % ì ˆê°</strong>ìœ¼ë¡œ ë‹¬ì„±í•  ìˆ˜ ìˆë‹¤ê³  ê°€ì •í•œë‹¤.</p></div></blockquote><h1 id=í”„ë¡¬í”„íŠ¸-121-ë…ì°½ì„±-ì‹ë³„>í”„ë¡¬í”„íŠ¸ 1.2.1 (ë…ì°½ì„± ì‹ë³„)</h1><div class="code-block-container border-border bg-card my-6 overflow-hidden rounded-xl border shadow-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:shadow-md"><div class="code-block-header bg-muted/30 border-border flex items-center justify-between border-b px-4 py-3"><div class="flex items-center gap-2"><div class="text-muted-foreground flex-shrink-0"><svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4 4 4-4 4M6 16l-4-4 4-4"/></svg></div><span class="text-muted-foreground text-sm font-medium">PLAINTEXT</span></div><div class="flex items-center gap-2"><button class="collapse-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-2 data-default-state=expanded data-collapsed=false data-auto-collapse-lines=30 data-auto-collapse-height=400 data-collapsed-height=120 title=ì ‘ê¸° aria-label=ì ‘ê¸°>
<span class=collapse-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41 12 10.83l4.59 4.58L18 14l-6-6-6 6z"/></svg>
</span><span class="collapse-text hidden sm:inline">ì ‘ê¸°</span>
</button>
<button class="copy-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-2 title=ë³µì‚¬ aria-label=ë³µì‚¬>
<span class=copy-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/></svg>
</span><span class="copy-text hidden sm:inline">ë³µì‚¬</span></button></div></div><div class="code-block-content relative" id=code-2><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=ln>1</span><span class=cl> &#34;ë…¼ë¬¸ ì „ì²´ë¥¼ ë°”íƒ•ìœ¼ë¡œ, ê°€ì¥ ì¤‘ìš”í•˜ê³  ë…ì°½ì ì¸ ê¸°ì—¬(contribution) 1~3ê°€ì§€ë¥¼ êµ¬ë³„ë˜ëŠ” í•­ëª©ìœ¼ë¡œ ë‚˜ì—´í•´ ì¤˜. ê°ê°ì´ ìƒˆë¡œìš´ ì•„í‚¤í…ì²˜ êµ¬ì„±ìš”ì†Œ, ìƒˆë¡œìš´ í•™ìŠµ ê¸°ë²•, ìƒˆë¡œìš´ ì´ë¡ ì  í†µì°°, ìƒˆë¡œìš´ ë°ì´í„°ì…‹, ë˜ëŠ” ê¸°ì¡´ ë°©ë²•ë¡ ì˜ ìƒˆë¡œìš´ ì ìš© ì¤‘ ì–´ë””ì— í•´ë‹¹í•˜ëŠ”ì§€ ëª…í™•íˆ êµ¬ë¶„í•´ ì¤˜.&#34;</span></span></code></pre></div><div class="collapse-overlay to-card/90 pointer-events-none absolute inset-0 bg-gradient-to-b from-transparent via-transparent opacity-0 transition-opacity duration-300"><div class="text-muted-foreground bg-card/80 border-border/50 hover:bg-primary/10 hover:text-primary hover:border-primary/30 absolute bottom-4 left-1/2 -translate-x-1/2 cursor-pointer rounded-full border px-3 py-1.5 text-xs backdrop-blur-sm transition-all duration-200">í´ë¦­í•˜ì—¬ ë” ë³´ê¸°</div></div></div></div><script>(function(){const s="code-2",n=document.querySelector('.copy-code-btn[data-code-id="'+s+'"]'),t=document.querySelector('.collapse-code-btn[data-code-id="'+s+'"]'),e=document.getElementById(s);if(!e)return;if(n){const s=n.querySelector(".copy-icon"),t=n.querySelector(".copy-text");n.addEventListener("click",async function(){try{let o="";const i=e.querySelector(".lntd:last-child code");if(i)o=i.textContent||i.innerText;else{const t=e.querySelector("code");if(t){const e=t.querySelector(".ln");if(e){const e=t.querySelectorAll(".cl");if(e.length>0)o=Array.from(e).map(e=>{const t=e.textContent||e.innerText;return t.replace(/\n+$/,"")}).join(`
`).replace(/\n+$/,"");else{const e=t.textContent||t.innerText;o=e.replace(/^\d+/gm,"").replace(/^\s+/gm,"")}}else o=t.textContent||t.innerText}else o=e.textContent||e.innerText}o=o.trim(),await navigator.clipboard.writeText(o),s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
</svg>`,t&&(t.textContent="ë³µì‚¬ë¨"),n.classList.add("text-green-600"),setTimeout(()=>{s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
</svg>`,t&&(t.textContent="ë³µì‚¬"),n.classList.remove("text-green-600")},2e3)}catch(o){console.error("å¤åˆ¶å¤±è´¥:",o);const s=document.createRange(),i=e.querySelector("code")||e;s.selectNodeContents(i);const n=window.getSelection();n.removeAllRanges(),n.addRange(s),t&&(t.textContent="ì„ íƒë¨"),setTimeout(()=>{t&&(t.textContent="ë³µì‚¬"),n.removeAllRanges()},2e3)}})}if(t){const d=t.querySelector(".collapse-icon"),c=t.querySelector(".collapse-text"),n=e.querySelector(".collapse-overlay");let s=e.querySelector("pre.chroma");s||(s=e.querySelector("pre"));const m=t.dataset.defaultState||"expanded",f=t.dataset.collapsed==="true",u=parseInt(t.dataset.autoCollapseLines)||30,h=parseInt(t.dataset.autoCollapseHeight)||400,p=parseInt(t.dataset.collapsedHeight)||120;let l=!1;function i(){const e=f||m==="collapsed"||a();e&&o(!0,!1)}function a(){if(s){const e=s.querySelectorAll(".line, .cl"),t=s.offsetHeight;return e.length>u||t>h}const t=e.offsetHeight;if(t>h)return!0;const n=e.textContent||e.innerText||"",o=n.split(`
`).length;return o>u}function o(s,o=!0){if(!n)return;l=s,s?(e.style.maxHeight=p+"px",e.style.overflow="hidden",n.style.opacity="1",n.style.pointerEvents="auto",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
</svg>`,c&&(c.textContent="í¼ì¹˜ê¸°"),t.title="í¼ì¹˜ê¸°"):(e.style.maxHeight="",e.style.overflow="",n.style.opacity="0",n.style.pointerEvents="none",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z"/></svg>`,c&&(c.textContent="ì ‘ê¸°"),t.title="ì ‘ê¸°"),o&&(e.style.transition="max-height 0.3s ease-out",setTimeout(()=>{e.style.transition=""},300))}function r(){o(!l,!0)}t.addEventListener("click",r),n&&n.addEventListener("click",()=>{l&&o(!1,!0)}),i()}})()</script><p><strong>TL;DR â€” ì£¼ìš” ë…ì°½ì„± 3ì¤„ ìš”ì•½</strong></p><ol><li><strong>í•˜ë“œì›¨ì–´</strong> â€“ PCIe A100 10 k GPU í´ëŸ¬ìŠ¤í„° <em>Fire-Flyer 2</em>ë¡œ **ë¹„ìš© 50 %â†“Â·ì „ë ¥ 40 %â†“**ì—ë„ <strong>DGX-A100ì˜ â‰ˆ80 % ì„±ëŠ¥</strong> ë‹¬ì„±</li><li><strong>í†µì‹  ìŠ¤íƒ</strong> â€“ ì‹ ê·œ All-Reduce ì•Œê³ ë¦¬ì¦˜ <strong>HFReduce</strong>ê°€ NCCL ëŒ€ë¹„ <strong>ìµœëŒ€ 5Ã— ëŒ€ì—­í­</strong>(8 GB/s vs 1.6 GB/s, 186 MiB) ì œê³µ</li><li><strong>ì†Œí”„íŠ¸ì›¨ì–´ í”Œë«í¼</strong> â€“ <strong>HaiScale DDP + 3FS + HAI Platform</strong>ë¡œ ê³„ì‚°Â·í†µì‹ Â·ìŠ¤í† ë¦¬ì§€ë¥¼ í†µí•© ìµœì í™”, <strong>10 k GPU ì¥ê¸°í›ˆë ¨ í‰ê·  ì¤‘ë‹¨ â‰¤ 5 ë¶„</strong> ìš´ì˜ ì•ˆì •ì„± í™•ë³´</li></ol><hr><h2 id=ë…¼ë¬¸ì˜-1-3ìœ„-í•µì‹¬-ê¸°ì—¬>ë…¼ë¬¸ì˜ 1-3ìœ„ í•µì‹¬ ê¸°ì—¬</h2><table><thead><tr><th>#</th><th>ê¸°ì—¬ ë‚´ìš©</th><th>ë¶„ë¥˜</th></tr></thead><tbody><tr><td><strong>1. Fire-Flyer 2 AI-HPC ì•„í‚¤í…ì²˜</strong><br>â€¢ 10 000 Ã— PCIe A100, ë…¸ë“œë‹¹ <em>ë‹¨ì¼</em> 200 Gb IB NIC, 2-ë‹¨ Fat-Tree í†µí•© ë„¤íŠ¸ì›Œí¬ ì„¤ê³„<br>â€¢ DGX-ê°™ì€ NVLink SXM ì—†ì´ë„ LLM í›ˆë ¨ ì„±ëŠ¥ 80 % ìœ ì§€, CAPEX Â½, ì „ë ¥ 60 % â†’ <strong>$ â‰ˆ 50 M ì ˆê°</strong>(10 k GPU ê¸°ì¤€)</td><td><strong>ìƒˆë¡œìš´ ì•„í‚¤í…ì²˜ êµ¬ì„±ìš”ì†Œ</strong></td><td></td></tr><tr><td><strong>2. HFReduce í†µì‹  ì•Œê³ ë¦¬ì¦˜</strong><br>â€¢ Double-Binary-Tree + CPU-SIMD ê°ì¶• + GDRCopy í™œìš©<br>â€¢ PCIe ëŒ€ì—­í­ ì†Œë¹„ 1/në¡œ ì¶•ì†Œ, <em>GPU-Kernel Free</em> ì™„ì „ ë¹„ë™ê¸°<br>â€¢ 16â†’1440 GPU ì‹¤í—˜ì—ì„œ <strong>6.3-8.1 GB/s</strong> vs NCCL <strong>1.6-4.8 GB/s</strong></td><td><strong>ìƒˆë¡œìš´ ì•„í‚¤í…ì²˜ êµ¬ì„±ìš”ì†Œ (ì§‘ë‹¨í†µì‹  ìŠ¤íƒ)</strong></td><td></td></tr><tr><td><strong>3. HaiScale DDP & 3FS ê¸°ë°˜ ì†Œí”„íŠ¸ì›¨ì–´ ìŠ¤íƒ</strong><br>â€¢ í†µì‹ -ê³„ì‚° ì˜¤ë²„ë©, NVLink-Bridge í™œìš© Tensor/Pipeline ë³‘ë ¬ ìµœì í™”<br>â€¢ 3FS íŒŒì¼ì‹œìŠ¤í…œì´ HFReduce íŠ¸ë˜í”½ê³¼ SL/VL ê²©ë¦¬ë¡œ ë„¤íŠ¸ì›Œí¬ í˜¼ì¡ 0 % ìœ ì§€<br>â€¢ ì£¼ 5 ë¶„ ì²´í¬í¬ì¸íŠ¸ + Validatorë¡œ ìˆ˜ë°±ì¼ í›ˆë ¨ ëˆ„ì  ë‹¤ìš´íƒ€ì„ &lt; 0.1 %</td><td><strong>ê¸°ì¡´ ë°©ë²•ë¡ ì˜ ìƒˆë¡œìš´ ì ìš© (ëŒ€ê·œëª¨ PCIe í™˜ê²½ íŠ¹í™” í†µí•© ìµœì í™”)</strong></td><td></td></tr></tbody></table><blockquote class="border-primary bg-muted/30 hover:bg-muted/40 my-6 rounded-r-lg border-l-4 py-4 pr-4 pl-6 italic transition-all duration-200 ease-out hover:translate-x-1"><div class="prose prose-sm max-w-none"><p><strong>ì •ë¦¬</strong>â€ƒì´ ë…¼ë¬¸ì€ <em>ì €ê°€ PCIe GPUë¡œ ì´ˆëŒ€ê·œëª¨ LLMì„ ì‹¤ì „ ë°°ì¹˜</em>í•˜ë ¤ëŠ” ì—…ê³„Â·í•™ê³„ì˜ ê³µë°±ì„ í•˜ë“œì›¨ì–´-ì†Œí”„íŠ¸ì›¨ì–´ ë™ì‹œ í˜ì‹  ì„¸ ê°€ì§€ë¡œ ë©”ì› ë‹¤ëŠ” ì ì—ì„œ ë…ì°½ì ì´ë‹¤.</p></div></blockquote><h1 id=í”„ë¡¬í”„íŠ¸-122-ì €ì-ê´€ì ì—ì„œì˜-ê°•ì >í”„ë¡¬í”„íŠ¸ 1.2.2 (ì €ì ê´€ì ì—ì„œì˜ ê°•ì )</h1><div class="code-block-container border-border bg-card my-6 overflow-hidden rounded-xl border shadow-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:shadow-md"><div class="code-block-header bg-muted/30 border-border flex items-center justify-between border-b px-4 py-3"><div class="flex items-center gap-2"><div class="text-muted-foreground flex-shrink-0"><svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4 4 4-4 4M6 16l-4-4 4-4"/></svg></div><span class="text-muted-foreground text-sm font-medium">PLAINTEXT</span></div><div class="flex items-center gap-2"><button class="collapse-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-3 data-default-state=expanded data-collapsed=false data-auto-collapse-lines=30 data-auto-collapse-height=400 data-collapsed-height=120 title=ì ‘ê¸° aria-label=ì ‘ê¸°>
<span class=collapse-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41 12 10.83l4.59 4.58L18 14l-6-6-6 6z"/></svg>
</span><span class="collapse-text hidden sm:inline">ì ‘ê¸°</span>
</button>
<button class="copy-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-3 title=ë³µì‚¬ aria-label=ë³µì‚¬>
<span class=copy-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/></svg>
</span><span class="copy-text hidden sm:inline">ë³µì‚¬</span></button></div></div><div class="code-block-content relative" id=code-3><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=ln>1</span><span class=cl>&#34;ì €ìë“¤ì˜ ê´€ì ì—ì„œ, ìì‹ ë“¤ì˜ ì ‘ê·¼ë²•ì´ ì´ì „ ë°©ë²•ë“¤ë³´ë‹¤ ìš°ì›”í•œ ì´ìœ ëŠ” ë¬´ì—‡ì¸ê°€? ê·¸ë“¤ì´ ìì‹ ë“¤ì˜ ì—°êµ¬ê°€ ì§€ë‹Œ ë…ì°½ì„±ê³¼ ê°•ì ì„ ë’·ë°›ì¹¨í•˜ê¸° ìœ„í•´ ì‚¬ìš©í•˜ëŠ” í•µì‹¬ ë…¼ê±°ë¥¼ ì¸ìš©í•˜ê±°ë‚˜ ì•Œê¸° ì‰½ê²Œ ì„¤ëª…í•´ ì¤˜.&#34;</span></span></code></pre></div><div class="collapse-overlay to-card/90 pointer-events-none absolute inset-0 bg-gradient-to-b from-transparent via-transparent opacity-0 transition-opacity duration-300"><div class="text-muted-foreground bg-card/80 border-border/50 hover:bg-primary/10 hover:text-primary hover:border-primary/30 absolute bottom-4 left-1/2 -translate-x-1/2 cursor-pointer rounded-full border px-3 py-1.5 text-xs backdrop-blur-sm transition-all duration-200">í´ë¦­í•˜ì—¬ ë” ë³´ê¸°</div></div></div></div><script>(function(){const s="code-3",n=document.querySelector('.copy-code-btn[data-code-id="'+s+'"]'),t=document.querySelector('.collapse-code-btn[data-code-id="'+s+'"]'),e=document.getElementById(s);if(!e)return;if(n){const s=n.querySelector(".copy-icon"),t=n.querySelector(".copy-text");n.addEventListener("click",async function(){try{let o="";const i=e.querySelector(".lntd:last-child code");if(i)o=i.textContent||i.innerText;else{const t=e.querySelector("code");if(t){const e=t.querySelector(".ln");if(e){const e=t.querySelectorAll(".cl");if(e.length>0)o=Array.from(e).map(e=>{const t=e.textContent||e.innerText;return t.replace(/\n+$/,"")}).join(`
`).replace(/\n+$/,"");else{const e=t.textContent||t.innerText;o=e.replace(/^\d+/gm,"").replace(/^\s+/gm,"")}}else o=t.textContent||t.innerText}else o=e.textContent||e.innerText}o=o.trim(),await navigator.clipboard.writeText(o),s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
</svg>`,t&&(t.textContent="ë³µì‚¬ë¨"),n.classList.add("text-green-600"),setTimeout(()=>{s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
</svg>`,t&&(t.textContent="ë³µì‚¬"),n.classList.remove("text-green-600")},2e3)}catch(o){console.error("å¤åˆ¶å¤±è´¥:",o);const s=document.createRange(),i=e.querySelector("code")||e;s.selectNodeContents(i);const n=window.getSelection();n.removeAllRanges(),n.addRange(s),t&&(t.textContent="ì„ íƒë¨"),setTimeout(()=>{t&&(t.textContent="ë³µì‚¬"),n.removeAllRanges()},2e3)}})}if(t){const d=t.querySelector(".collapse-icon"),c=t.querySelector(".collapse-text"),n=e.querySelector(".collapse-overlay");let s=e.querySelector("pre.chroma");s||(s=e.querySelector("pre"));const m=t.dataset.defaultState||"expanded",f=t.dataset.collapsed==="true",u=parseInt(t.dataset.autoCollapseLines)||30,h=parseInt(t.dataset.autoCollapseHeight)||400,p=parseInt(t.dataset.collapsedHeight)||120;let l=!1;function i(){const e=f||m==="collapsed"||a();e&&o(!0,!1)}function a(){if(s){const e=s.querySelectorAll(".line, .cl"),t=s.offsetHeight;return e.length>u||t>h}const t=e.offsetHeight;if(t>h)return!0;const n=e.textContent||e.innerText||"",o=n.split(`
`).length;return o>u}function o(s,o=!0){if(!n)return;l=s,s?(e.style.maxHeight=p+"px",e.style.overflow="hidden",n.style.opacity="1",n.style.pointerEvents="auto",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
</svg>`,c&&(c.textContent="í¼ì¹˜ê¸°"),t.title="í¼ì¹˜ê¸°"):(e.style.maxHeight="",e.style.overflow="",n.style.opacity="0",n.style.pointerEvents="none",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z"/></svg>`,c&&(c.textContent="ì ‘ê¸°"),t.title="ì ‘ê¸°"),o&&(e.style.transition="max-height 0.3s ease-out",setTimeout(()=>{e.style.transition=""},300))}function r(){o(!l,!0)}t.addEventListener("click",r),n&&n.addEventListener("click",()=>{l&&o(!1,!0)}),i()}})()</script><p><strong>TL;DR â€” Fire-Flyer 2ê°€ ì™œ â€˜ë” ë‚«ë‹¤â€™ í•œ ì¤„ ìš”ì•½</strong>
ì €ìë“¤ì€ <strong>PCIe A100 10 k GPU + HFReduce</strong> ì¡°í•©ì´ DGX-A100 (NVLink SXM) ëŒ€ë¹„ <strong>ì„±ëŠ¥ 80 % ìœ ì§€í•˜ë©´ì„œ êµ¬ì¶•ë¹„ 50 %Â·ì „ë ¥ 40 % ì ˆê°</strong>í•˜ê³ , NCCLë³´ë‹¤ <strong>ìµœëŒ€ 5Ã— ë¹ ë¥¸ All-Reduce</strong>ë¡œ 10 k GPU í›ˆë ¨ì„ ì‹¤ì „ ìˆ˜ì¤€ ì•ˆì •ì„±ìœ¼ë¡œ ê°€ëŠ¥í•˜ê²Œ ë§Œë“ ë‹¤ê³  ì£¼ì¥í•œë‹¤.</p><hr><h2 id=ì €ì-ê´€ì ì˜-ìš°ì›”ì„±-top-3>ì €ì ê´€ì ì˜ â€˜ìš°ì›”ì„±â€™ Top-3</h2><table><thead><tr><th>#</th><th>ì €ì ì£¼ì¥</th><th>í•µì‹¬ ê·¼ê±° (ë…¼ë¬¸ ì¸ìš©)</th></tr></thead><tbody><tr><td><strong>1. ë¹„ìš©Â·ì „ë ¥ íš¨ìœ¨</strong></td><td>DGX-A100 ìˆ˜ì¤€ì˜ TF32/FP16 ì„±ëŠ¥ **83 %**ë¥¼ **ë…¸ë“œ ê°€ê²© 60 %Â·ì „ë ¥ 60 %**ë¡œ ë‹¬ì„± â†’ <strong>Cost-Perf â†‘ 38 %</strong></td><td>Table II & III: ì„±ëŠ¥ 83 %, ê°€ê²©/ì „ë ¥ 60 %, Cost-Performance 1.38 (Fire-Flyer 2) vs 1 (DGX)</td></tr><tr><td><strong>2. í†µì‹  ì„±ëŠ¥</strong></td><td>ìƒˆ All-Reduce <strong>HFReduce</strong>ê°€ NCCL ëŒ€ë¹„<br>â€¢ PCIe ëŒ€ì—­ ì†Œëª¨ Â½(1 D2H+1 H2D vs 2nâ€“1)<br>â€¢ <strong>6.3â€“8.1 GB/s â†” 1.6â€“4.8 GB/s</strong> (ìµœëŒ€ 5Ã—)</td><td>â€œReduced PCIe bandwidth â€¦ therefore HFReduce can achieve better performanceâ€¦ 6.3â€“8.1 GB/s vs 1.6â€“4.8 GB/sâ€</td></tr><tr><td><strong>3. ëŒ€ê·œëª¨ í™•ì¥Â·ì•ˆì •ì„±</strong></td><td>2-ë‹¨ Fat-Tree 122 ìŠ¤ìœ„ì¹˜(-90 %)ë¡œ 10 k GPU ì—°ê²°, HaiScale DDPë¡œ <strong>88 % ì•½í•œ ìŠ¤ì¼€ì¼ë§</strong>Â·VGG16 í›ˆë ¨ ì‹œê°„ Â½, ìš´ì˜ ì¤‘ë‹¨ &lt;5 ë¶„</td><td>Switch 1320 â†’ 122, ë„¤íŠ¸ì›Œí¬ ë¹„ìš© â€“40 % ; HaiScale vs Torch ìë£Œ Â· 88 % íš¨ìœ¨ Â· 2Ã— ë¹ ë¦„</td></tr></tbody></table><blockquote class="border-primary bg-muted/30 hover:bg-muted/40 my-6 rounded-r-lg border-l-4 py-4 pr-4 pl-6 italic transition-all duration-200 ease-out hover:translate-x-1"><div class="prose prose-sm max-w-none"><p><strong>ë³´ë„ˆìŠ¤</strong>: NVLink Bridge ì¶”ê°€ ì‹œ HFReduceê°€ **10 GB/s+**ë¡œ ìƒìŠ¹, ì°¨ì„¸ëŒ€ CPUë¡œë„ í™•ì¥ ê°€ëŠ¥</p></div></blockquote><hr><h3 id=1-ë¹„ìš©ì „ë ¥-ì ˆê°ì˜-ë…¼ë¦¬>1. ë¹„ìš©Â·ì „ë ¥ ì ˆê°ì˜ ë…¼ë¦¬</h3><ul><li><strong>í•˜ë“œì›¨ì–´ ë‹¨ìˆœí™”</strong> â€“ ë…¸ë“œë‹¹ <strong>InfiniBand NIC 1 ì¥</strong>Â·PCIe A100 8 ì¥ë§Œ ì‚¬ìš©í•´ NVSwitchÂ·9 NIC ì„¤ê³„ ì œê±°.</li><li><strong>ë„¤íŠ¸ì›Œí¬ ì¶•ì†Œ</strong> â€“ ë™ì¼ 10 k GPU DGX êµ¬ì„±ì´ 1,320 ìŠ¤ìœ„ì¹˜ê°€ í•„ìš”í•˜ì§€ë§Œ Fire-Flyer 2ëŠ” 122 ê°œë¡œ ì™„ë£Œ(-90 %) .</li><li><strong>ê²°ê³¼</strong> â€“ êµ¬ì¶• CAPEX 50 %â†“, ì „ë ¥ 4 MW â†’ â‰ˆ2.4 MW(40 %â†“), COâ‚‚ ë°°ì¶œê¹Œì§€ ì ˆê° .</li></ul><h3 id=2-í†µì‹ -ìŠ¤íƒ-ìš°ìœ„>2. í†µì‹  ìŠ¤íƒ ìš°ìœ„</h3><ul><li><strong>HFReduce ì•Œê³ ë¦¬ì¦˜</strong> â€“ CPU-RDMA Double-Binary-Tree + GDRCopy, <strong>GPU Kernel 0 ê°œ</strong>ë¡œ ì™„ì „ ë¹„ë™ê¸°.</li><li><strong>ëŒ€ì—­í­Â·ì§€ì—°</strong> â€“ 186 MiB All-Reduce ì‹œí—˜ì—ì„œ <strong>6.3â€“8.1 GB/s</strong>, NCCLì˜ 1.6â€“4.8 GB/s ëŒ€ë¹„ ìµœëŒ€ <strong>5Ã—</strong> .</li><li><strong>PCIe íš¨ìœ¨</strong> â€“ ë°ì´í„°ë‹¹ ì „ì†¡ hop ìˆ˜ 2n-1 â†’ 2 ë¡œ ì¶•ì†Œí•´ ë³‘ëª© í•´ì†Œ .</li></ul><h3 id=3-ìŠ¤ì¼€ì¼ë§ìš´ì˜-ì•ˆì •ì„±>3. ìŠ¤ì¼€ì¼ë§Â·ìš´ì˜ ì•ˆì •ì„±</h3><ul><li><strong>Two-Zone 2-Layer Fat-Tree</strong> â€“ ìŠ¤í† ë¦¬ì§€Â·ì»´í“¨í…Œì´ì…˜ í†µí•©, SL/VL ê³ ì • ë¼ìš°íŒ…ìœ¼ë¡œ HOL ë¸”ë¡œí‚¹ 0 % ìœ ì§€ .</li><li><strong>HaiScale DDP</strong> â€“ HFReduce ë•ë¶„ì— ê³„ì‚°-í†µì‹  ì™„ì „ ì˜¤ë²„ë©, VGG16 32â†’512 GPUì—ì„œ <strong>88 %</strong> íš¨ìœ¨, Torch DDP ëŒ€ë¹„ <strong>2Ã—</strong> ë¹ ë¦„ .</li><li><strong>ì‹¤ì „ ê²€ì¦</strong> â€“ 10 k GPU í´ëŸ¬ìŠ¤í„° ìˆ˜ê°œì›” í›ˆë ¨ ë™ì•ˆ ì¥ì•  ê°ì§€-ìë™ ë³µêµ¬ë¡œ <em><strong>í‰ê·  ë‹¤ìš´íƒ€ì„ â‰¤ 5 ë¶„</strong></em> (ë³¸ë¬¸ ì„œìˆ ) .</li></ul><hr><h2 id=í•œëˆˆì—-ë³´ëŠ”-ë¹„êµ-í‘œ>í•œëˆˆì— ë³´ëŠ” ë¹„êµ í‘œ</h2><table><thead><tr><th>ì§€í‘œ</th><th>DGX-A100 (ê¸°ì¡´)</th><th>Fire-Flyer 2</th><th>í–¥ìƒí­</th></tr></thead><tbody><tr><td>TF32/FP16 ì„±ëŠ¥</td><td>100 %</td><td><strong>83 %</strong></td><td>â€“17 %</td></tr><tr><td>ë…¸ë“œ ê°€ê²©</td><td>100 %</td><td><strong>60 %</strong></td><td><strong>â€“40 %</strong></td></tr><tr><td>ì „ë ¥ (W)</td><td>4 200</td><td><strong>2 500</strong></td><td><strong>â€“40 %</strong></td></tr><tr><td>ë„¤íŠ¸ì›Œí¬ ìŠ¤ìœ„ì¹˜</td><td>1 320</td><td><strong>122</strong></td><td><strong>â€“90 %</strong></td></tr><tr><td>All-Reduce BW</td><td>1.6â€“4.8 GB/s</td><td><strong>6.3â€“8.1 GB/s</strong></td><td><strong>â†‘ â‰ˆ5Ã—</strong></td></tr><tr><td>VGG16 512 GPU íš¨ìœ¨</td><td>46 % (Torch DDP)</td><td><strong>88 %</strong></td><td><strong>+42 pp</strong></td></tr></tbody></table><p><em>ìˆ˜ì¹˜ëŠ” ë…¼ë¬¸ Table IIÂ·III ë° Figure 7Â·8 ê¸°ë°˜.</em></p><hr><h3 id=ì •ë¦¬>ì •ë¦¬</h3><blockquote class="border-primary bg-muted/30 hover:bg-muted/40 my-6 rounded-r-lg border-l-4 py-4 pr-4 pl-6 italic transition-all duration-200 ease-out hover:translate-x-1"><div class="prose prose-sm max-w-none"><p><strong>ì €ìë“¤ì˜ í•µì‹¬ ë…¼ê±°</strong>ëŠ” â€œ<strong>í•˜ë“œì›¨ì–´ ë‹¨ìˆœí™” + í†µì‹  ì•Œê³ ë¦¬ì¦˜ í˜ì‹  + ì†Œí”„íŠ¸ì›¨ì–´ ìŠ¤ì¼€ì¤„ë§</strong>â€ ì‚¼ë°•ìë¥¼ í†µí•´ **ì„±ëŠ¥ ì†ì‹¤ â‰¤ 20 %**ë¡œë„ <strong>ë¹„ìš©Â·ì „ë ¥Â·ê·œëª¨Â·ì•ˆì •ì„±</strong> ì „ ë¶€ë¬¸ì—ì„œ ê¸°ì¡´ NVLink-DGXÂ·NCCL ì²´ê³„ë¥¼ ì••ë„í•œë‹¤ëŠ” ì ì´ë‹¤. ë”°ë¼ì„œ Fire-Flyer 2ëŠ” ì´ˆëŒ€ê·œëª¨ LLM í›ˆë ¨ì˜ <strong>ê°€ì„±ë¹„Â·íƒ„ì†Œ ì¤‘ë¦½Â·ì ‘ê·¼ì„±</strong> ë¬¸ì œë¥¼ ë™ì‹œ í•´ê²°í•˜ëŠ” ì‹¤ì§ˆì  ëŒ€ì•ˆìœ¼ë¡œ ìë¦¬ë§¤ê¹€í•œë‹¤.</p></div></blockquote><h1 id=í”„ë¡¬í”„íŠ¸-131-ì•Œê³ ë¦¬ì¦˜-ë‹¨ê³„ë³„-ì„¤ëª…>í”„ë¡¬í”„íŠ¸ 1.3.1 (ì•Œê³ ë¦¬ì¦˜ ë‹¨ê³„ë³„ ì„¤ëª…)</h1><div class="code-block-container border-border bg-card my-6 overflow-hidden rounded-xl border shadow-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:shadow-md"><div class="code-block-header bg-muted/30 border-border flex items-center justify-between border-b px-4 py-3"><div class="flex items-center gap-2"><div class="text-muted-foreground flex-shrink-0"><svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4 4 4-4 4M6 16l-4-4 4-4"/></svg></div><span class="text-muted-foreground text-sm font-medium">PLAINTEXT</span></div><div class="flex items-center gap-2"><button class="collapse-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-4 data-default-state=expanded data-collapsed=false data-auto-collapse-lines=30 data-auto-collapse-height=400 data-collapsed-height=120 title=ì ‘ê¸° aria-label=ì ‘ê¸°>
<span class=collapse-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41 12 10.83l4.59 4.58L18 14l-6-6-6 6z"/></svg>
</span><span class="collapse-text hidden sm:inline">ì ‘ê¸°</span>
</button>
<button class="copy-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-4 title=ë³µì‚¬ aria-label=ë³µì‚¬>
<span class=copy-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/></svg>
</span><span class="copy-text hidden sm:inline">ë³µì‚¬</span></button></div></div><div class="code-block-content relative" id=code-4><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=ln>1</span><span class=cl>&#34;í•µì‹¬ ì•Œê³ ë¦¬ì¦˜, ëª¨ë¸ ì•„í‚¤í…ì²˜, ë˜ëŠ” ì£¼ìš” ë°©ë²•ë¡ ì„ ë‹¨ê³„ë³„(step-by-step)ë¡œ ì„¤ëª…í•´ ì¤˜. ë…ìëŠ” AI ë¶„ì•¼ì˜ ëŒ€í•™ì›ìƒ ìˆ˜ì¤€ì´ë¼ê³  ê°€ì •í•´. íŠ¹íˆ, ê°„ë‹¨í•œ ë¬¸ì¥, 3x3 í”½ì…€ ì´ë¯¸ì§€, ì‘ì€ ìƒíƒœ ê³µê°„(state space) ë“± ì•„ì£¼ ê°„ë‹¨í•˜ê³  êµ¬ì²´ì ì¸ ì˜ˆì‹œ(toy example)ì™€ ìƒ˜í”Œ ì…ë ¥ì„ ë§Œë“¤ì–´ì„œ, ì´ ì˜ˆì‹œë¥¼ í†µí•´ ê° ë‹¨ê³„ë¥¼ ê±°ì¹˜ë©° ì…ë ¥ì´ ìµœì¢… ì¶œë ¥ìœ¼ë¡œ ì–´ë–»ê²Œ ë³€í™˜ë˜ëŠ”ì§€ ì „ì²´ ê³¼ì •ì„ ë³´ì—¬ì¤˜. ë“±ì¥í•˜ëŠ” ëª¨ë“  í•µì‹¬ ìš©ì–´ì™€ ë³€ìˆ˜ëŠ” ê·¸ ì¦‰ì‹œ ì •ì˜í•´ ì¤˜.&#34;</span></span></code></pre></div><div class="collapse-overlay to-card/90 pointer-events-none absolute inset-0 bg-gradient-to-b from-transparent via-transparent opacity-0 transition-opacity duration-300"><div class="text-muted-foreground bg-card/80 border-border/50 hover:bg-primary/10 hover:text-primary hover:border-primary/30 absolute bottom-4 left-1/2 -translate-x-1/2 cursor-pointer rounded-full border px-3 py-1.5 text-xs backdrop-blur-sm transition-all duration-200">í´ë¦­í•˜ì—¬ ë” ë³´ê¸°</div></div></div></div><script>(function(){const s="code-4",n=document.querySelector('.copy-code-btn[data-code-id="'+s+'"]'),t=document.querySelector('.collapse-code-btn[data-code-id="'+s+'"]'),e=document.getElementById(s);if(!e)return;if(n){const s=n.querySelector(".copy-icon"),t=n.querySelector(".copy-text");n.addEventListener("click",async function(){try{let o="";const i=e.querySelector(".lntd:last-child code");if(i)o=i.textContent||i.innerText;else{const t=e.querySelector("code");if(t){const e=t.querySelector(".ln");if(e){const e=t.querySelectorAll(".cl");if(e.length>0)o=Array.from(e).map(e=>{const t=e.textContent||e.innerText;return t.replace(/\n+$/,"")}).join(`
`).replace(/\n+$/,"");else{const e=t.textContent||t.innerText;o=e.replace(/^\d+/gm,"").replace(/^\s+/gm,"")}}else o=t.textContent||t.innerText}else o=e.textContent||e.innerText}o=o.trim(),await navigator.clipboard.writeText(o),s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
</svg>`,t&&(t.textContent="ë³µì‚¬ë¨"),n.classList.add("text-green-600"),setTimeout(()=>{s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
</svg>`,t&&(t.textContent="ë³µì‚¬"),n.classList.remove("text-green-600")},2e3)}catch(o){console.error("å¤åˆ¶å¤±è´¥:",o);const s=document.createRange(),i=e.querySelector("code")||e;s.selectNodeContents(i);const n=window.getSelection();n.removeAllRanges(),n.addRange(s),t&&(t.textContent="ì„ íƒë¨"),setTimeout(()=>{t&&(t.textContent="ë³µì‚¬"),n.removeAllRanges()},2e3)}})}if(t){const d=t.querySelector(".collapse-icon"),c=t.querySelector(".collapse-text"),n=e.querySelector(".collapse-overlay");let s=e.querySelector("pre.chroma");s||(s=e.querySelector("pre"));const m=t.dataset.defaultState||"expanded",f=t.dataset.collapsed==="true",u=parseInt(t.dataset.autoCollapseLines)||30,h=parseInt(t.dataset.autoCollapseHeight)||400,p=parseInt(t.dataset.collapsedHeight)||120;let l=!1;function i(){const e=f||m==="collapsed"||a();e&&o(!0,!1)}function a(){if(s){const e=s.querySelectorAll(".line, .cl"),t=s.offsetHeight;return e.length>u||t>h}const t=e.offsetHeight;if(t>h)return!0;const n=e.textContent||e.innerText||"",o=n.split(`
`).length;return o>u}function o(s,o=!0){if(!n)return;l=s,s?(e.style.maxHeight=p+"px",e.style.overflow="hidden",n.style.opacity="1",n.style.pointerEvents="auto",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
</svg>`,c&&(c.textContent="í¼ì¹˜ê¸°"),t.title="í¼ì¹˜ê¸°"):(e.style.maxHeight="",e.style.overflow="",n.style.opacity="0",n.style.pointerEvents="none",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z"/></svg>`,c&&(c.textContent="ì ‘ê¸°"),t.title="ì ‘ê¸°"),o&&(e.style.transition="max-height 0.3s ease-out",setTimeout(()=>{e.style.transition=""},300))}function r(){o(!l,!0)}t.addEventListener("click",r),n&&n.addEventListener("click",()=>{l&&o(!1,!0)}),i()}})()</script><p><strong>í•œ ì¤„ í•µì‹¬ ìš”ì•½</strong>
HFReduceëŠ” â‘  GPUâ†’CPU D2H ì „ì†¡ â‘¡ CPU SIMD Intra-node Reduce â‘¢ RDMA Double-Binary-Tree Inter-node All-Reduce â‘£ CPUâ†’GPU H2D ì „ì†¡ ì˜ 4 ë‹¨ê³„ë¥¼ í†µí•´ <strong>PCIe A100 10 k GPU</strong> í´ëŸ¬ìŠ¤í„°ì—ì„œë„ <strong>NCCL ëŒ€ë¹„ ìµœëŒ€ 5Ã— ë†’ì€ 8 GB/s ëŒ€ì—­í­</strong>ì„ ë‹¬ì„±í•´, DGX-ê¸‰ ì„±ëŠ¥ì„ ë¹„ìš© Â½Â·ì „ë ¥ 0.6 ë°°ë¡œ ì‹¤í˜„í•œë‹¤</p><hr><h2 id=1-ìš©ì–´ë³€ìˆ˜-ì •ì˜>1. ìš©ì–´Â·ë³€ìˆ˜ ì •ì˜</h2><table><thead><tr><th>ê¸°í˜¸</th><th>ì˜ë¯¸</th></tr></thead><tbody><tr><td><em>G</em></td><td>GPU ì¥ì¹˜ (ì˜ˆ: G0, G1â€¦)</td></tr><tr><td><em>N</em></td><td>ë…¸ë“œ(ì„œë²„). ì˜ˆì œì—ì„  Node AÂ·B</td></tr><tr><td><em>D<sub>g</sub></em></td><td>GPUê°€ ê³„ì‚°í•œ gradient í–‰ë ¬</td></tr><tr><td><em>D<sub>c</sub></em></td><td>í•´ë‹¹ ë…¸ë“œ CPU ë©”ëª¨ë¦¬ì— ëª¨ì¸ gradient</td></tr><tr><td><strong>D2H/H2D</strong></td><td>Deviceâ†”Host (PCIe) ë¹„ë™ê¸° ë³µì‚¬</td></tr><tr><td><strong>RDMA</strong></td><td>NIC ê°„ ì§ì ‘ ë©”ëª¨ë¦¬ ì „ì†¡</td></tr><tr><td><strong>SIMD</strong></td><td>CPU ë²¡í„° ì—°ì‚° (AVX-512)</td></tr><tr><td><strong>Double-Binary-Tree</strong></td><td>ë‘ ë°©í–¥ìœ¼ë¡œ íŒŒì´í”„ë¼ì¸ë˜ëŠ” 2-ary íŠ¸ë¦¬ All-Reduce í† í´ë¡œì§€</td></tr></tbody></table><hr><h2 id=2-hfreduce-4-ë‹¨ê³„-íŒŒì´í”„ë¼ì¸>2. HFReduce 4-ë‹¨ê³„ íŒŒì´í”„ë¼ì¸</h2><table><thead><tr><th>ë‹¨ê³„</th><th>ì„¸ë¶€ í–‰ë™</th><th>ìµœì í™” í¬ì¸íŠ¸</th></tr></thead><tbody><tr><td><strong>â‘  D2H</strong></td><td>ê° GPUê°€ <em>D<sub>g</sub></em> â†’ CPU RAM (ë¹„ë™ê¸°)</td><td>GDRCopy ì‚¬ìš© ì‹œ ì‘ì€ ë²„í¼ 3Ã— ë¹¨ë¼ì§</td></tr><tr><td><strong>â‘¡ Intra-node Reduce</strong></td><td>8 GPU ë°ì´í„°ë¥¼ CPU SIMDë¡œ element-wise í•©</td><td>NUMA interleaveë¡œ BW ê·¹ëŒ€í™”</td></tr><tr><td><strong>â‘¢ Inter-node All-Reduce</strong></td><td>ë…¸ë“œë³„ <em>D<sub>c</sub></em> ë¥¼ Double-Binary-Tree RDMAë¡œ êµí™˜Â·í•©</td><td>GPU â†” NIC P2P ì œê±°â€‰â†’â€‰PCIe íŠ¸ë˜í”½ 1/n</td></tr><tr><td><strong>â‘£ H2D</strong></td><td>ìµœì¢… ê²°ê³¼ë¥¼ ê° GPUë¡œ H2D ë³µì‚¬</td><td>GDRCopyë¡œâ€‰4 GPU ë™ì‹œ ì“°ê¸°</td></tr></tbody></table><blockquote class="border-primary bg-muted/30 hover:bg-muted/40 my-6 rounded-r-lg border-l-4 py-4 pr-4 pl-6 italic transition-all duration-200 ease-out hover:translate-x-1"><div class="prose prose-sm max-w-none"><p>NCCL ringì€ ë°ì´í„° 1 ë‹¨ìœ„ë‹¹ <strong>2nâ€“1</strong> ì „ì†¡ì´ í•„ìš”í•˜ì§€ë§Œ, HFReduceëŠ” <strong>D2H 1 + H2D 1</strong> = 2 íšŒë§Œ ìš”êµ¬í•œë‹¤ .</p></div></blockquote><hr><h2 id=3-toy-example--2-ë…¸ë“œ4-gpu3--3-í”½ì…€-ê·¸ë˜ë””ì–¸íŠ¸>3. <strong>Toy Example : 2 ë…¸ë“œÂ·4 GPUÂ·3 Ã— 3 í”½ì…€ ê·¸ë˜ë””ì–¸íŠ¸</strong></h2><h3 id=31-ì´ˆê¸°-ìƒíƒœ>3.1 ì´ˆê¸° ìƒíƒœ</h3><div class="code-block-container border-border bg-card my-6 overflow-hidden rounded-xl border shadow-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:shadow-md"><div class="code-block-header bg-muted/30 border-border flex items-center justify-between border-b px-4 py-3"><div class="flex items-center gap-2"><div class="text-muted-foreground flex-shrink-0"><svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4 4 4-4 4M6 16l-4-4 4-4"/></svg></div><span class="text-muted-foreground text-sm font-medium">TEXT</span></div><div class="flex items-center gap-2"><button class="collapse-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-5 data-default-state=expanded data-collapsed=false data-auto-collapse-lines=30 data-auto-collapse-height=400 data-collapsed-height=120 title=ì ‘ê¸° aria-label=ì ‘ê¸°>
<span class=collapse-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41 12 10.83l4.59 4.58L18 14l-6-6-6 6z"/></svg>
</span><span class="collapse-text hidden sm:inline">ì ‘ê¸°</span>
</button>
<button class="copy-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-5 title=ë³µì‚¬ aria-label=ë³µì‚¬>
<span class=copy-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/></svg>
</span><span class="copy-text hidden sm:inline">ë³µì‚¬</span></button></div></div><div class="code-block-content relative" id=code-5><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln> 1</span><span class=cl>Node A
</span></span><span class=line><span class=ln> 2</span><span class=cl>  G0: [[1 1 1]
</span></span><span class=line><span class=ln> 3</span><span class=cl>       [1 1 1]
</span></span><span class=line><span class=ln> 4</span><span class=cl>       [1 1 1]]
</span></span><span class=line><span class=ln> 5</span><span class=cl>  G1: [[2 2 2]
</span></span><span class=line><span class=ln> 6</span><span class=cl>       [2 2 2]
</span></span><span class=line><span class=ln> 7</span><span class=cl>       [2 2 2]]
</span></span><span class=line><span class=ln> 8</span><span class=cl>
</span></span><span class=line><span class=ln> 9</span><span class=cl>Node B
</span></span><span class=line><span class=ln>10</span><span class=cl>  G2: [[3 3 3]
</span></span><span class=line><span class=ln>11</span><span class=cl>       [3 3 3]
</span></span><span class=line><span class=ln>12</span><span class=cl>       [3 3 3]]
</span></span><span class=line><span class=ln>13</span><span class=cl>  G3: [[4 4 4]
</span></span><span class=line><span class=ln>14</span><span class=cl>       [4 4 4]
</span></span><span class=line><span class=ln>15</span><span class=cl>       [4 4 4]]</span></span></code></pre></div><div class="collapse-overlay to-card/90 pointer-events-none absolute inset-0 bg-gradient-to-b from-transparent via-transparent opacity-0 transition-opacity duration-300"><div class="text-muted-foreground bg-card/80 border-border/50 hover:bg-primary/10 hover:text-primary hover:border-primary/30 absolute bottom-4 left-1/2 -translate-x-1/2 cursor-pointer rounded-full border px-3 py-1.5 text-xs backdrop-blur-sm transition-all duration-200">í´ë¦­í•˜ì—¬ ë” ë³´ê¸°</div></div></div></div><script>(function(){const s="code-5",n=document.querySelector('.copy-code-btn[data-code-id="'+s+'"]'),t=document.querySelector('.collapse-code-btn[data-code-id="'+s+'"]'),e=document.getElementById(s);if(!e)return;if(n){const s=n.querySelector(".copy-icon"),t=n.querySelector(".copy-text");n.addEventListener("click",async function(){try{let o="";const i=e.querySelector(".lntd:last-child code");if(i)o=i.textContent||i.innerText;else{const t=e.querySelector("code");if(t){const e=t.querySelector(".ln");if(e){const e=t.querySelectorAll(".cl");if(e.length>0)o=Array.from(e).map(e=>{const t=e.textContent||e.innerText;return t.replace(/\n+$/,"")}).join(`
`).replace(/\n+$/,"");else{const e=t.textContent||t.innerText;o=e.replace(/^\d+/gm,"").replace(/^\s+/gm,"")}}else o=t.textContent||t.innerText}else o=e.textContent||e.innerText}o=o.trim(),await navigator.clipboard.writeText(o),s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
</svg>`,t&&(t.textContent="ë³µì‚¬ë¨"),n.classList.add("text-green-600"),setTimeout(()=>{s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
</svg>`,t&&(t.textContent="ë³µì‚¬"),n.classList.remove("text-green-600")},2e3)}catch(o){console.error("å¤åˆ¶å¤±è´¥:",o);const s=document.createRange(),i=e.querySelector("code")||e;s.selectNodeContents(i);const n=window.getSelection();n.removeAllRanges(),n.addRange(s),t&&(t.textContent="ì„ íƒë¨"),setTimeout(()=>{t&&(t.textContent="ë³µì‚¬"),n.removeAllRanges()},2e3)}})}if(t){const d=t.querySelector(".collapse-icon"),c=t.querySelector(".collapse-text"),n=e.querySelector(".collapse-overlay");let s=e.querySelector("pre.chroma");s||(s=e.querySelector("pre"));const m=t.dataset.defaultState||"expanded",f=t.dataset.collapsed==="true",u=parseInt(t.dataset.autoCollapseLines)||30,h=parseInt(t.dataset.autoCollapseHeight)||400,p=parseInt(t.dataset.collapsedHeight)||120;let l=!1;function i(){const e=f||m==="collapsed"||a();e&&o(!0,!1)}function a(){if(s){const e=s.querySelectorAll(".line, .cl"),t=s.offsetHeight;return e.length>u||t>h}const t=e.offsetHeight;if(t>h)return!0;const n=e.textContent||e.innerText||"",o=n.split(`
`).length;return o>u}function o(s,o=!0){if(!n)return;l=s,s?(e.style.maxHeight=p+"px",e.style.overflow="hidden",n.style.opacity="1",n.style.pointerEvents="auto",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
</svg>`,c&&(c.textContent="í¼ì¹˜ê¸°"),t.title="í¼ì¹˜ê¸°"):(e.style.maxHeight="",e.style.overflow="",n.style.opacity="0",n.style.pointerEvents="none",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z"/></svg>`,c&&(c.textContent="ì ‘ê¸°"),t.title="ì ‘ê¸°"),o&&(e.style.transition="max-height 0.3s ease-out",setTimeout(()=>{e.style.transition=""},300))}function r(){o(!l,!0)}t.addEventListener("click",r),n&&n.addEventListener("click",()=>{l&&o(!1,!0)}),i()}})()</script><h3 id=32-ë‹¨ê³„ë³„-íë¦„>3.2 ë‹¨ê³„ë³„ íë¦„</h3><table><thead><tr><th>ë‹¨ê³„</th><th>Node A ë©”ëª¨ë¦¬</th><th>Node B ë©”ëª¨ë¦¬</th><th>ì„¤ëª…</th></tr></thead><tbody><tr><td><strong>â‘  D2H</strong></td><td>CPUâ†(G0+G1) ë‘ ë²„í¼ ì „ì†¡ ì™„ë£Œ</td><td>CPUâ†(G2+G3)</td><td>GPU Copy Engine ì´ìš©, ê³„ì‚° ê²¹ì¹˜ê¸° ê°€ëŠ¥</td></tr><tr><td><strong>â‘¡ Intra</strong></td><td><code>Dc_A = G0+G1 = [[3â€¦]]</code></td><td><code>Dc_B = G2+G3 = [[7â€¦]]</code></td><td>CPU SIMD add</td></tr><tr><td><strong>â‘¢ Inter</strong></td><td><code>Dc_A += Dc_B â†’ [[10â€¦]]</code>, <code>Dc_B += Dc_A(old)</code></td><td>Double-Binary-Tree 1-RTT RDMA</td><td></td></tr><tr><td><strong>â‘£ H2D</strong></td><td>ëª¨ë“  GPUì— [[10â€¦]] ë³µì‚¬</td><td>ë™ì¼</td><td>ê²°ê³¼ê°€ ëª¨ë“  GPUì— ë™ì¼í•˜ê²Œ ë°°í¬</td></tr></tbody></table><div class="code-block-container border-border bg-card my-6 overflow-hidden rounded-xl border shadow-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:shadow-md"><div class="code-block-header bg-muted/30 border-border flex items-center justify-between border-b px-4 py-3"><div class="flex items-center gap-2"><div class="text-muted-foreground flex-shrink-0"><svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4 4 4-4 4M6 16l-4-4 4-4"/></svg></div><span class="text-muted-foreground text-sm font-medium">TEXT</span></div><div class="flex items-center gap-2"><button class="collapse-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-6 data-default-state=expanded data-collapsed=false data-auto-collapse-lines=30 data-auto-collapse-height=400 data-collapsed-height=120 title=ì ‘ê¸° aria-label=ì ‘ê¸°>
<span class=collapse-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41 12 10.83l4.59 4.58L18 14l-6-6-6 6z"/></svg>
</span><span class="collapse-text hidden sm:inline">ì ‘ê¸°</span>
</button>
<button class="copy-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-6 title=ë³µì‚¬ aria-label=ë³µì‚¬>
<span class=copy-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/></svg>
</span><span class="copy-text hidden sm:inline">ë³µì‚¬</span></button></div></div><div class="code-block-content relative" id=code-6><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>1</span><span class=cl>ìµœì¢… GPU í–‰ë ¬ = [[10 10 10]
</span></span><span class=line><span class=ln>2</span><span class=cl>                 [10 10 10]
</span></span><span class=line><span class=ln>3</span><span class=cl>                 [10 10 10]]</span></span></code></pre></div><div class="collapse-overlay to-card/90 pointer-events-none absolute inset-0 bg-gradient-to-b from-transparent via-transparent opacity-0 transition-opacity duration-300"><div class="text-muted-foreground bg-card/80 border-border/50 hover:bg-primary/10 hover:text-primary hover:border-primary/30 absolute bottom-4 left-1/2 -translate-x-1/2 cursor-pointer rounded-full border px-3 py-1.5 text-xs backdrop-blur-sm transition-all duration-200">í´ë¦­í•˜ì—¬ ë” ë³´ê¸°</div></div></div></div><script>(function(){const s="code-6",n=document.querySelector('.copy-code-btn[data-code-id="'+s+'"]'),t=document.querySelector('.collapse-code-btn[data-code-id="'+s+'"]'),e=document.getElementById(s);if(!e)return;if(n){const s=n.querySelector(".copy-icon"),t=n.querySelector(".copy-text");n.addEventListener("click",async function(){try{let o="";const i=e.querySelector(".lntd:last-child code");if(i)o=i.textContent||i.innerText;else{const t=e.querySelector("code");if(t){const e=t.querySelector(".ln");if(e){const e=t.querySelectorAll(".cl");if(e.length>0)o=Array.from(e).map(e=>{const t=e.textContent||e.innerText;return t.replace(/\n+$/,"")}).join(`
`).replace(/\n+$/,"");else{const e=t.textContent||t.innerText;o=e.replace(/^\d+/gm,"").replace(/^\s+/gm,"")}}else o=t.textContent||t.innerText}else o=e.textContent||e.innerText}o=o.trim(),await navigator.clipboard.writeText(o),s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
</svg>`,t&&(t.textContent="ë³µì‚¬ë¨"),n.classList.add("text-green-600"),setTimeout(()=>{s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
</svg>`,t&&(t.textContent="ë³µì‚¬"),n.classList.remove("text-green-600")},2e3)}catch(o){console.error("å¤åˆ¶å¤±è´¥:",o);const s=document.createRange(),i=e.querySelector("code")||e;s.selectNodeContents(i);const n=window.getSelection();n.removeAllRanges(),n.addRange(s),t&&(t.textContent="ì„ íƒë¨"),setTimeout(()=>{t&&(t.textContent="ë³µì‚¬"),n.removeAllRanges()},2e3)}})}if(t){const d=t.querySelector(".collapse-icon"),c=t.querySelector(".collapse-text"),n=e.querySelector(".collapse-overlay");let s=e.querySelector("pre.chroma");s||(s=e.querySelector("pre"));const m=t.dataset.defaultState||"expanded",f=t.dataset.collapsed==="true",u=parseInt(t.dataset.autoCollapseLines)||30,h=parseInt(t.dataset.autoCollapseHeight)||400,p=parseInt(t.dataset.collapsedHeight)||120;let l=!1;function i(){const e=f||m==="collapsed"||a();e&&o(!0,!1)}function a(){if(s){const e=s.querySelectorAll(".line, .cl"),t=s.offsetHeight;return e.length>u||t>h}const t=e.offsetHeight;if(t>h)return!0;const n=e.textContent||e.innerText||"",o=n.split(`
`).length;return o>u}function o(s,o=!0){if(!n)return;l=s,s?(e.style.maxHeight=p+"px",e.style.overflow="hidden",n.style.opacity="1",n.style.pointerEvents="auto",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
</svg>`,c&&(c.textContent="í¼ì¹˜ê¸°"),t.title="í¼ì¹˜ê¸°"):(e.style.maxHeight="",e.style.overflow="",n.style.opacity="0",n.style.pointerEvents="none",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z"/></svg>`,c&&(c.textContent="ì ‘ê¸°"),t.title="ì ‘ê¸°"),o&&(e.style.transition="max-height 0.3s ease-out",setTimeout(()=>{e.style.transition=""},300))}function r(){o(!l,!0)}t.addEventListener("click",r),n&&n.addEventListener("click",()=>{l&&o(!1,!0)}),i()}})()</script><blockquote class="border-primary bg-muted/30 hover:bg-muted/40 my-6 rounded-r-lg border-l-4 py-4 pr-4 pl-6 italic transition-all duration-200 ease-out hover:translate-x-1"><div class="prose prose-sm max-w-none"><p>ì „ì²´ ê³¼ì • ë™ì•ˆ GPU ì—°ì‚° ì»¤ë„ì€ ì‹¤í–‰ë˜ì§€ ì•Šìœ¼ë¯€ë¡œ, <strong>ë°±ì›Œë“œ ê³„ì‚°ê³¼ ì™„ì „ ì˜¤ë²„ë©</strong>ëœë‹¤ .</p></div></blockquote><hr><h2 id=4-double-binary-tree-all-reduce-ì‹œí€€ìŠ¤-2-ë…¸ë“œ-ì˜ˆ>4. Double-Binary-Tree All-Reduce ì‹œí€€ìŠ¤ (2 ë…¸ë“œ ì˜ˆ)</h2><div class="code-block-container border-border bg-card my-6 overflow-hidden rounded-xl border shadow-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:shadow-md"><div class="code-block-header bg-muted/30 border-border flex items-center justify-between border-b px-4 py-3"><div class="flex items-center gap-2"><div class="text-muted-foreground flex-shrink-0"><svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4 4 4-4 4M6 16l-4-4 4-4"/></svg></div><span class="text-muted-foreground text-sm font-medium">PLAINTEXT</span></div><div class="flex items-center gap-2"><button class="collapse-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-7 data-default-state=expanded data-collapsed=false data-auto-collapse-lines=30 data-auto-collapse-height=400 data-collapsed-height=120 title=ì ‘ê¸° aria-label=ì ‘ê¸°>
<span class=collapse-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41 12 10.83l4.59 4.58L18 14l-6-6-6 6z"/></svg>
</span><span class="collapse-text hidden sm:inline">ì ‘ê¸°</span>
</button>
<button class="copy-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-7 title=ë³µì‚¬ aria-label=ë³µì‚¬>
<span class=copy-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/></svg>
</span><span class="copy-text hidden sm:inline">ë³µì‚¬</span></button></div></div><div class="code-block-content relative" id=code-7><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=ln>1</span><span class=cl>Round 0: A(root)â†’B  /  Bâ†’A  (íŒŒì´í”„ë¼ì¸ ì‹œì‘)
</span></span><span class=line><span class=ln>2</span><span class=cl>Round 1: A(root)â†B  /  Bâ†A  (ê°ì¶• ê²°ê³¼ êµí™˜)</span></span></code></pre></div><div class="collapse-overlay to-card/90 pointer-events-none absolute inset-0 bg-gradient-to-b from-transparent via-transparent opacity-0 transition-opacity duration-300"><div class="text-muted-foreground bg-card/80 border-border/50 hover:bg-primary/10 hover:text-primary hover:border-primary/30 absolute bottom-4 left-1/2 -translate-x-1/2 cursor-pointer rounded-full border px-3 py-1.5 text-xs backdrop-blur-sm transition-all duration-200">í´ë¦­í•˜ì—¬ ë” ë³´ê¸°</div></div></div></div><script>(function(){const s="code-7",n=document.querySelector('.copy-code-btn[data-code-id="'+s+'"]'),t=document.querySelector('.collapse-code-btn[data-code-id="'+s+'"]'),e=document.getElementById(s);if(!e)return;if(n){const s=n.querySelector(".copy-icon"),t=n.querySelector(".copy-text");n.addEventListener("click",async function(){try{let o="";const i=e.querySelector(".lntd:last-child code");if(i)o=i.textContent||i.innerText;else{const t=e.querySelector("code");if(t){const e=t.querySelector(".ln");if(e){const e=t.querySelectorAll(".cl");if(e.length>0)o=Array.from(e).map(e=>{const t=e.textContent||e.innerText;return t.replace(/\n+$/,"")}).join(`
`).replace(/\n+$/,"");else{const e=t.textContent||t.innerText;o=e.replace(/^\d+/gm,"").replace(/^\s+/gm,"")}}else o=t.textContent||t.innerText}else o=e.textContent||e.innerText}o=o.trim(),await navigator.clipboard.writeText(o),s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
</svg>`,t&&(t.textContent="ë³µì‚¬ë¨"),n.classList.add("text-green-600"),setTimeout(()=>{s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
</svg>`,t&&(t.textContent="ë³µì‚¬"),n.classList.remove("text-green-600")},2e3)}catch(o){console.error("å¤åˆ¶å¤±è´¥:",o);const s=document.createRange(),i=e.querySelector("code")||e;s.selectNodeContents(i);const n=window.getSelection();n.removeAllRanges(),n.addRange(s),t&&(t.textContent="ì„ íƒë¨"),setTimeout(()=>{t&&(t.textContent="ë³µì‚¬"),n.removeAllRanges()},2e3)}})}if(t){const d=t.querySelector(".collapse-icon"),c=t.querySelector(".collapse-text"),n=e.querySelector(".collapse-overlay");let s=e.querySelector("pre.chroma");s||(s=e.querySelector("pre"));const m=t.dataset.defaultState||"expanded",f=t.dataset.collapsed==="true",u=parseInt(t.dataset.autoCollapseLines)||30,h=parseInt(t.dataset.autoCollapseHeight)||400,p=parseInt(t.dataset.collapsedHeight)||120;let l=!1;function i(){const e=f||m==="collapsed"||a();e&&o(!0,!1)}function a(){if(s){const e=s.querySelectorAll(".line, .cl"),t=s.offsetHeight;return e.length>u||t>h}const t=e.offsetHeight;if(t>h)return!0;const n=e.textContent||e.innerText||"",o=n.split(`
`).length;return o>u}function o(s,o=!0){if(!n)return;l=s,s?(e.style.maxHeight=p+"px",e.style.overflow="hidden",n.style.opacity="1",n.style.pointerEvents="auto",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
</svg>`,c&&(c.textContent="í¼ì¹˜ê¸°"),t.title="í¼ì¹˜ê¸°"):(e.style.maxHeight="",e.style.overflow="",n.style.opacity="0",n.style.pointerEvents="none",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z"/></svg>`,c&&(c.textContent="ì ‘ê¸°"),t.title="ì ‘ê¸°"),o&&(e.style.transition="max-height 0.3s ease-out",setTimeout(()=>{e.style.transition=""},300))}function r(){o(!l,!0)}t.addEventListener("click",r),n&&n.addEventListener("click",()=>{l&&o(!1,!0)}),i()}})()</script><p>ë‘ ë°©í–¥ì´ ë™ì‹œì— ì§„í–‰ë¼ ë„¤íŠ¸ì›Œí¬ ë§í¬ í™œìš©ë¥ ì´ 100 %ì— ê°€ê¹ë‹¤ .</p><hr><h2 id=5-ì„±ëŠ¥-ìˆ«ìë¡œ-ë³´ëŠ”-íš¨ê³¼>5. ì„±ëŠ¥ ìˆ«ìë¡œ ë³´ëŠ” íš¨ê³¼</h2><table><thead><tr><th>ë°ì´í„° í¬ê¸°</th><th>NCCL BW</th><th>HFReduce BW</th><th>ì†ë„ í–¥ìƒ</th></tr></thead><tbody><tr><td>186 MiB</td><td>1.6â€“4.8 GB/s</td><td><strong>6.3â€“8.1 GB/s</strong></td><td><strong>â‰ˆ 5Ã—</strong></td></tr></tbody></table><p><em>ì´ë¡ ì  ìµœëŒ€</em> â‰ˆ 12 GB/sëŠ” CPU ë©”ëª¨ë¦¬ 320 GB/s ê°€ì •ìœ¼ë¡œ ê³„ì‚° ë˜ë©°, ì‹¤í—˜ì¹˜ëŠ” 8 GB/s ìˆ˜ì¤€ìœ¼ë¡œ ê·¼ì ‘ .</p><hr><h2 id=6-ì™œ-ì˜-ë˜ë‚˜--í•µì‹¬-ìµœì í™”-3-ê°€ì§€>6. ì™œ ì˜ ë˜ë‚˜? â€” í•µì‹¬ ìµœì í™” 3 ê°€ì§€</h2><ol><li><strong>PCIe íŠ¸ë˜í”½ ì ˆê°</strong> â€” GPU P2Pë¥¼ ì—†ì• ê³  â€œ1 D2H + 1 H2Dâ€ë§Œ ì‚¬ìš©.</li><li><strong>GPU Kernel 0 ê°œ</strong> â€” Copy Engine ì „ìš©ì´ë¯€ë¡œ GPU SMì´ ë°±ì›Œë“œ ê³„ì‚°ì— 100 % ì§‘ì¤‘.</li><li><strong>CPU SIMD + NUMA ì–´ì›¨ì–´</strong> â€” FP8~FP32ê¹Œì§€ í­ë„“ì€ íƒ€ì… ì§€ì›, ë©”ëª¨ë¦¬ ë°”ì¸ë”©ìœ¼ë¡œ ëŒ€ì—­í­ ê·¹ëŒ€í™”.</li></ol><hr><h2 id=7-í•œëˆˆì—-ë³´ëŠ”-hfreduce-íŒŒì´í”„ë¼ì¸-vs-nccl-ìš”ì•½>7. í•œëˆˆì— ë³´ëŠ” HFReduce íŒŒì´í”„ë¼ì¸ vs NCCL (ìš”ì•½)</h2><table><thead><tr><th>í•­ëª©</th><th>NCCL Ring</th><th><strong>HFReduce</strong></th></tr></thead><tbody><tr><td>ì „ì†¡ íšŸìˆ˜</td><td>2nâ€“1</td><td><strong>2</strong></td></tr><tr><td>GPU ì»¤ë„</td><td>í•„ìš”</td><td><strong>ë¶ˆí•„ìš”</strong></td></tr><tr><td>PCIe BW ë³‘ëª©</td><td>ì‹¬ê°</td><td><strong>ì™„í™”</strong></td></tr><tr><td>ì¸¡ì • BW</td><td>1.6â€“4.8 GB/s</td><td><strong>6.3â€“8.1 GB/s</strong></td></tr><tr><td>ê³„ì‚°-í†µì‹  ì˜¤ë²„ë©</td><td>ì œí•œì </td><td><strong>ì™„ì „</strong></td></tr></tbody></table><hr><h1 id=í”„ë¡¬í”„íŠ¸-132-ë¹„ë°€-ë³‘ê¸°-ì‹ë³„>í”„ë¡¬í”„íŠ¸ 1.3.2 (&lsquo;ë¹„ë°€ ë³‘ê¸°&rsquo; ì‹ë³„)</h1><div class="code-block-container border-border bg-card my-6 overflow-hidden rounded-xl border shadow-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:shadow-md"><div class="code-block-header bg-muted/30 border-border flex items-center justify-between border-b px-4 py-3"><div class="flex items-center gap-2"><div class="text-muted-foreground flex-shrink-0"><svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4 4 4-4 4M6 16l-4-4 4-4"/></svg></div><span class="text-muted-foreground text-sm font-medium">PLAINTEXT</span></div><div class="flex items-center gap-2"><button class="collapse-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-8 data-default-state=expanded data-collapsed=false data-auto-collapse-lines=30 data-auto-collapse-height=400 data-collapsed-height=120 title=ì ‘ê¸° aria-label=ì ‘ê¸°>
<span class=collapse-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41 12 10.83l4.59 4.58L18 14l-6-6-6 6z"/></svg>
</span><span class="collapse-text hidden sm:inline">ì ‘ê¸°</span>
</button>
<button class="copy-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-8 title=ë³µì‚¬ aria-label=ë³µì‚¬>
<span class=copy-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/></svg>
</span><span class="copy-text hidden sm:inline">ë³µì‚¬</span></button></div></div><div class="code-block-content relative" id=code-8><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=ln>1</span><span class=cl>&#34;ì´ ë…¼ë¬¸ì˜ í•µì‹¬ ê¸°ì—¬ë¥¼ ê°€ëŠ¥í•˜ê²Œ í•˜ëŠ” ê°€ì¥ ê²°ì •ì ì¸ ë‹¨ì¼ ìˆ˜í•™ ê³µì‹, ì•Œê³ ë¦¬ì¦˜ ë‹¨ê³„, ë˜ëŠ” ì•„í‚¤í…ì²˜ êµ¬ì„±ìš”ì†Œë¥¼ ì‹ë³„í•´ ì¤˜. ê·¸ê²ƒì˜ ê¸°ëŠ¥ê³¼, ê·¸ê²ƒì´ ì´ ë°©ë²•ë¡ ì˜ ì„±ê³µì— ì™œ í•„ìˆ˜ì ì¸ì§€ ì„¤ëª…í•´ ì¤˜.&#34;</span></span></code></pre></div><div class="collapse-overlay to-card/90 pointer-events-none absolute inset-0 bg-gradient-to-b from-transparent via-transparent opacity-0 transition-opacity duration-300"><div class="text-muted-foreground bg-card/80 border-border/50 hover:bg-primary/10 hover:text-primary hover:border-primary/30 absolute bottom-4 left-1/2 -translate-x-1/2 cursor-pointer rounded-full border px-3 py-1.5 text-xs backdrop-blur-sm transition-all duration-200">í´ë¦­í•˜ì—¬ ë” ë³´ê¸°</div></div></div></div><script>(function(){const s="code-8",n=document.querySelector('.copy-code-btn[data-code-id="'+s+'"]'),t=document.querySelector('.collapse-code-btn[data-code-id="'+s+'"]'),e=document.getElementById(s);if(!e)return;if(n){const s=n.querySelector(".copy-icon"),t=n.querySelector(".copy-text");n.addEventListener("click",async function(){try{let o="";const i=e.querySelector(".lntd:last-child code");if(i)o=i.textContent||i.innerText;else{const t=e.querySelector("code");if(t){const e=t.querySelector(".ln");if(e){const e=t.querySelectorAll(".cl");if(e.length>0)o=Array.from(e).map(e=>{const t=e.textContent||e.innerText;return t.replace(/\n+$/,"")}).join(`
`).replace(/\n+$/,"");else{const e=t.textContent||t.innerText;o=e.replace(/^\d+/gm,"").replace(/^\s+/gm,"")}}else o=t.textContent||t.innerText}else o=e.textContent||e.innerText}o=o.trim(),await navigator.clipboard.writeText(o),s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
</svg>`,t&&(t.textContent="ë³µì‚¬ë¨"),n.classList.add("text-green-600"),setTimeout(()=>{s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
</svg>`,t&&(t.textContent="ë³µì‚¬"),n.classList.remove("text-green-600")},2e3)}catch(o){console.error("å¤åˆ¶å¤±è´¥:",o);const s=document.createRange(),i=e.querySelector("code")||e;s.selectNodeContents(i);const n=window.getSelection();n.removeAllRanges(),n.addRange(s),t&&(t.textContent="ì„ íƒë¨"),setTimeout(()=>{t&&(t.textContent="ë³µì‚¬"),n.removeAllRanges()},2e3)}})}if(t){const d=t.querySelector(".collapse-icon"),c=t.querySelector(".collapse-text"),n=e.querySelector(".collapse-overlay");let s=e.querySelector("pre.chroma");s||(s=e.querySelector("pre"));const m=t.dataset.defaultState||"expanded",f=t.dataset.collapsed==="true",u=parseInt(t.dataset.autoCollapseLines)||30,h=parseInt(t.dataset.autoCollapseHeight)||400,p=parseInt(t.dataset.collapsedHeight)||120;let l=!1;function i(){const e=f||m==="collapsed"||a();e&&o(!0,!1)}function a(){if(s){const e=s.querySelectorAll(".line, .cl"),t=s.offsetHeight;return e.length>u||t>h}const t=e.offsetHeight;if(t>h)return!0;const n=e.textContent||e.innerText||"",o=n.split(`
`).length;return o>u}function o(s,o=!0){if(!n)return;l=s,s?(e.style.maxHeight=p+"px",e.style.overflow="hidden",n.style.opacity="1",n.style.pointerEvents="auto",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
</svg>`,c&&(c.textContent="í¼ì¹˜ê¸°"),t.title="í¼ì¹˜ê¸°"):(e.style.maxHeight="",e.style.overflow="",n.style.opacity="0",n.style.pointerEvents="none",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z"/></svg>`,c&&(c.textContent="ì ‘ê¸°"),t.title="ì ‘ê¸°"),o&&(e.style.transition="max-height 0.3s ease-out",setTimeout(()=>{e.style.transition=""},300))}function r(){o(!l,!0)}t.addEventListener("click",r),n&&n.addEventListener("click",()=>{l&&o(!1,!0)}),i()}})()</script><blockquote class="border-primary bg-muted/30 hover:bg-muted/40 my-6 rounded-r-lg border-l-4 py-4 pr-4 pl-6 italic transition-all duration-200 ease-out hover:translate-x-1"><div class="prose prose-sm max-w-none"><p><strong>â€˜ë¹„ë°€ ë³‘ê¸°â€™ í•œ ì¤„ ìš”ì•½ â€” HFReduceì˜ <em>Double-Binary-Tree Inter-node All-Reduce</em></strong>
NCCL ringì´ ëª¨ë“  GPUê°€ ê³µìœ í•  ê·¸ë˜ë””ì–¸íŠ¸ 1 ë‹¨ìœ„ë¥¼ ì „ë‹¬í•˜ë ¤ë©´ <strong>$(2n-1)/n$</strong> ë§Œí¼ì˜ PCIe ì–‘ë°©í–¥ ëŒ€ì—­ì„ ì“°ì§€ë§Œ, HFReduceëŠ” **ë”± ë‘ ë²ˆ(1 Ã— D2H + 1 Ã— H2D)**ë§Œìœ¼ë¡œ ëë‚¸ë‹¤ â†’ 10 000 Ã— PCIe A100ì—ì„œë„ <strong>8 GB/s(ìµœëŒ€ 5 Ã—)</strong> ëŒ€ì—­í­ê³¼ <strong>ë¹„ìš© Â½Â·ì „ë ¥ 0.6 ë°°</strong>ë¥¼ ë’·ë°›ì¹¨í•˜ëŠ” ê²°ì •ì  ì—´ì‡ ë‹¤.</p></div></blockquote><hr><h2 id=1-ë¬´ì—‡ì„-í•˜ëŠ”ê°€-ê¸°ëŠ¥>1. ë¬´ì—‡ì„ í•˜ëŠ”ê°€? (ê¸°ëŠ¥)</h2><table><thead><tr><th>ë‹¨ê³„</th><th>í•µì‹¬ ë™ì‘</th><th>ì„±ëŠ¥â€†Â·â€†ìì› íš¨ê³¼</th></tr></thead><tbody><tr><td><strong>â‘  GPUâ†’CPU D2H</strong></td><td>ê° GPU gradientë¥¼ CPU RAMìœ¼ë¡œ ë¹„ë™ê¸° ë³µì‚¬</td><td>GPU SM ìœ íœ´ 0 % (ê³„ì‚°Â·í†µì‹  ì™„ì „ ì˜¤ë²„ë©)</td></tr><tr><td><strong>â‘¡ CPU SIMD Intra-node Reduce</strong></td><td>8 GPU ë°ì´í„° í•©ì‚°</td><td>PCIe P2P ëŒ€ì‹  CPU DRAM 320 GB/s í™œìš©</td></tr><tr><td><strong>â‘¢ <em>Double-Binary-Tree</em> Inter-node All-Reduce</strong></td><td>RDMA Writeë¡œ íŠ¸ë¦¬ íŒŒì´í”„ë¼ì¸ ê°ì¶•Â· gather</td><td>PCIe ì „ì†¡ëŸ‰ <strong>1</strong> â†’ NCCL <strong>(2n-1)/n</strong> ëŒ€ë¹„ â–¼â€ƒ</td></tr><tr><td><strong>â‘£ CPUâ†’GPU H2D</strong></td><td>ê²°ê³¼ë¥¼ ëª¨ë“  GPUë¡œ í•œ ë²ˆì— ë°°í¬</td><td>GDRCopyë¡œ ë©”ëª¨ë¦¬ ì½ê¸° â…“ ê°ì†Œ</td></tr></tbody></table><blockquote class="border-primary bg-muted/30 hover:bg-muted/40 my-6 rounded-r-lg border-l-4 py-4 pr-4 pl-6 italic transition-all duration-200 ease-out hover:translate-x-1"><div class="prose prose-sm max-w-none"><p><strong>í•µì‹¬ ê³µì‹</strong>
$\text{PCIe BW}<em>{\text{HFReduce}} = 1 \quad\text{vs}\quad \text{PCIe BW}</em>{\text{NCCL ring}} = \frac{2n-1}{n}$
(ë°ì´í„° 1 ë‹¨ìœ„ ê¸°ì¤€)</p></div></blockquote><hr><h2 id=2-ì™œ-í•„ìˆ˜ì ì¸ê°€>2. ì™œ í•„ìˆ˜ì ì¸ê°€?</h2><ol><li><p><strong>í†µì‹ ì´ ì§„ì§œ ë³‘ëª©</strong>
<em>Rome EPYC CPUëŠ” chained-writeë¥¼ ì§€ì›í•˜ì§€ ì•Šì•„ GPUâ†”NIC P2P BWê°€ 4 GB/s ìˆ˜ì¤€</em>â€”NCCL ringì˜ 4 GB/s í•œê³„ê°€ ì—¬ê¸°ì„œ ê¸°ì¸. HFReduceëŠ” CPUë¥¼ ìš°íšŒ ì±„ë„ë¡œ ì‚¬ìš©í•´ **6.3â€“8.1 GB/s(â–² 5Ã—)**ë¥¼ ë‹¬ì„±í•œë‹¤.</p></li><li><p><strong>ìŠ¤ì¼€ì¼ ë¶ˆë³€ ì „ì†¡ëŸ‰</strong>
íŠ¸ë¦¬ ê¹Šì´ê°€ ëŠ˜ì–´ë„ ì „ì†¡ íšŸìˆ˜ëŠ” 1 D2H+1 H2Dë¡œ <strong>ìƒìˆ˜</strong>. ê·¸ë˜ì„œ 10 k GPUë¡œ ì»¤ì ¸ë„ ëŒ€ì—­í­ì´ <em>ì„ í˜• ë¶•ê´´</em>í•˜ì§€ ì•ŠìŒ.</p></li><li><p><strong>GPU ì—°ì‚° ê°„ì„­ 0 %</strong>
í†µì‹ ì— GPU ì»¤ë„ì´ ì „í˜€ í•„ìš” ì—†ìœ¼ë¯€ë¡œ ë°±ì›Œë“œÂ·ì˜µí‹°ë§ˆì´ì € ë‹¨ê³„ì™€ ì™„ì „ ì¤‘ì²© â†’ <strong>LLaMA-13B 512â†’6 k GPU ì•½í•œ ìŠ¤ì¼€ì¼ íš¨ìœ¨ 90 %</strong> ìœ ì§€ (ë³¸ë¬¸ Figure 7a).</p></li><li><p><strong>ë¹„ìš©Â·ì „ë ¥ íŒŒê¸‰ íš¨ê³¼</strong>
í†µì‹  ë³‘ëª©ì´ í•´ì†Œë˜ë‹ˆ <strong>NIC 1 ì¥/ë…¸ë“œ</strong>Â·<strong>ìŠ¤ìœ„ì¹˜ 122 ê°œ</strong>ì˜ <em>2-ë‹¨ Fat-Tree</em>ë§Œìœ¼ë¡œë„ DGX-ë™ê¸‰ ì„±ëŠ¥ì˜ 80 %Â·ì „ë ¥ 60 %ë¥¼ ë‹¬ì„±í•  ìˆ˜ ìˆì—ˆë‹¤.</p></li></ol><h1 id=í”„ë¡¬í”„íŠ¸-141-í•µì‹¬-ê²°ê³¼-ë¶„ì„>í”„ë¡¬í”„íŠ¸ 1.4.1 (í•µì‹¬ ê²°ê³¼ ë¶„ì„)</h1><div class="code-block-container border-border bg-card my-6 overflow-hidden rounded-xl border shadow-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:shadow-md"><div class="code-block-header bg-muted/30 border-border flex items-center justify-between border-b px-4 py-3"><div class="flex items-center gap-2"><div class="text-muted-foreground flex-shrink-0"><svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4 4 4-4 4M6 16l-4-4 4-4"/></svg></div><span class="text-muted-foreground text-sm font-medium">PLAINTEXT</span></div><div class="flex items-center gap-2"><button class="collapse-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-9 data-default-state=expanded data-collapsed=false data-auto-collapse-lines=30 data-auto-collapse-height=400 data-collapsed-height=120 title=ì ‘ê¸° aria-label=ì ‘ê¸°>
<span class=collapse-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41 12 10.83l4.59 4.58L18 14l-6-6-6 6z"/></svg>
</span><span class="collapse-text hidden sm:inline">ì ‘ê¸°</span>
</button>
<button class="copy-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-9 title=ë³µì‚¬ aria-label=ë³µì‚¬>
<span class=copy-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/></svg>
</span><span class="copy-text hidden sm:inline">ë³µì‚¬</span></button></div></div><div class="code-block-content relative" id=code-9><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=ln>1</span><span class=cl>&#34;&#39;Experiments&#39; ë˜ëŠ” &#39;Results&#39; ì„¹ì…˜ì˜ í‘œì™€ ê·¸ë¦¼ì„ í¬í•¨í•œ ì£¼ìš” ê²°ê³¼ë¥¼ ë¶„ì„í•´ ì¤˜. ì‚¬ìš©ëœ í•µì‹¬ ì„±ëŠ¥ ì§€í‘œ(performance metrics)ëŠ” ë¬´ì—‡ì¸ê°€? ì–´ë–¤ ë²¤ì¹˜ë§ˆí¬ ë°ì´í„°ì…‹ì—ì„œ ê²°ê³¼ê°€ ë³´ê³ ë˜ì—ˆëŠ”ê°€? ì €ìë“¤ì´ ìì‹ ë“¤ì˜ ë°©ë²•ë¡ ì˜ ì„±ê³µ ì¦ê±°ë¡œ ê°€ì¥ ê°•ì¡°í•˜ëŠ” ì£¼ìš” ê²°ê³¼ë¥¼ ìš”ì•½í•´ ì¤˜.&#34;</span></span></code></pre></div><div class="collapse-overlay to-card/90 pointer-events-none absolute inset-0 bg-gradient-to-b from-transparent via-transparent opacity-0 transition-opacity duration-300"><div class="text-muted-foreground bg-card/80 border-border/50 hover:bg-primary/10 hover:text-primary hover:border-primary/30 absolute bottom-4 left-1/2 -translate-x-1/2 cursor-pointer rounded-full border px-3 py-1.5 text-xs backdrop-blur-sm transition-all duration-200">í´ë¦­í•˜ì—¬ ë” ë³´ê¸°</div></div></div></div><script>(function(){const s="code-9",n=document.querySelector('.copy-code-btn[data-code-id="'+s+'"]'),t=document.querySelector('.collapse-code-btn[data-code-id="'+s+'"]'),e=document.getElementById(s);if(!e)return;if(n){const s=n.querySelector(".copy-icon"),t=n.querySelector(".copy-text");n.addEventListener("click",async function(){try{let o="";const i=e.querySelector(".lntd:last-child code");if(i)o=i.textContent||i.innerText;else{const t=e.querySelector("code");if(t){const e=t.querySelector(".ln");if(e){const e=t.querySelectorAll(".cl");if(e.length>0)o=Array.from(e).map(e=>{const t=e.textContent||e.innerText;return t.replace(/\n+$/,"")}).join(`
`).replace(/\n+$/,"");else{const e=t.textContent||t.innerText;o=e.replace(/^\d+/gm,"").replace(/^\s+/gm,"")}}else o=t.textContent||t.innerText}else o=e.textContent||e.innerText}o=o.trim(),await navigator.clipboard.writeText(o),s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
</svg>`,t&&(t.textContent="ë³µì‚¬ë¨"),n.classList.add("text-green-600"),setTimeout(()=>{s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
</svg>`,t&&(t.textContent="ë³µì‚¬"),n.classList.remove("text-green-600")},2e3)}catch(o){console.error("å¤åˆ¶å¤±è´¥:",o);const s=document.createRange(),i=e.querySelector("code")||e;s.selectNodeContents(i);const n=window.getSelection();n.removeAllRanges(),n.addRange(s),t&&(t.textContent="ì„ íƒë¨"),setTimeout(()=>{t&&(t.textContent="ë³µì‚¬"),n.removeAllRanges()},2e3)}})}if(t){const d=t.querySelector(".collapse-icon"),c=t.querySelector(".collapse-text"),n=e.querySelector(".collapse-overlay");let s=e.querySelector("pre.chroma");s||(s=e.querySelector("pre"));const m=t.dataset.defaultState||"expanded",f=t.dataset.collapsed==="true",u=parseInt(t.dataset.autoCollapseLines)||30,h=parseInt(t.dataset.autoCollapseHeight)||400,p=parseInt(t.dataset.collapsedHeight)||120;let l=!1;function i(){const e=f||m==="collapsed"||a();e&&o(!0,!1)}function a(){if(s){const e=s.querySelectorAll(".line, .cl"),t=s.offsetHeight;return e.length>u||t>h}const t=e.offsetHeight;if(t>h)return!0;const n=e.textContent||e.innerText||"",o=n.split(`
`).length;return o>u}function o(s,o=!0){if(!n)return;l=s,s?(e.style.maxHeight=p+"px",e.style.overflow="hidden",n.style.opacity="1",n.style.pointerEvents="auto",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
</svg>`,c&&(c.textContent="í¼ì¹˜ê¸°"),t.title="í¼ì¹˜ê¸°"):(e.style.maxHeight="",e.style.overflow="",n.style.opacity="0",n.style.pointerEvents="none",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z"/></svg>`,c&&(c.textContent="ì ‘ê¸°"),t.title="ì ‘ê¸°"),o&&(e.style.transition="max-height 0.3s ease-out",setTimeout(()=>{e.style.transition=""},300))}function r(){o(!l,!0)}t.addEventListener("click",r),n&&n.addEventListener("click",()=>{l&&o(!1,!0)}),i()}})()</script><p><strong>ê²°ë¡  ìš”ì•½</strong>
Fire-Flyer 2ëŠ” 10 000 Ã— PCIe A100 í´ëŸ¬ìŠ¤í„°ì—ì„œ</p><ul><li><strong>í†µì‹ </strong>: HFReduceê°€ NCCL ëŒ€ë¹„ ìµœëŒ€ 5 Ã— ë†’ì€ 8.1 GB/s All-Reduce ëŒ€ì—­í­ í™•ë³´</li><li><strong>í•™ìŠµ</strong>: VGG16Â·GPT-2-MÂ·LLaMA-13BÂ·DeepSeek-MoE-16B í›ˆë ¨ì—ì„œ <strong>ìµœëŒ€ 95 % ë³‘ë ¬ íš¨ìœ¨</strong> ë‹¬ì„±</li><li><strong>ê²½ì œì„±</strong>: DGX-A100 ëŒ€ë¹„ **ì„±ëŠ¥ 83 %**ë¥¼ **ë¹„ìš© 60 %Â·ì „ë ¥ 60 %**ë¡œ ì œê³µí•´ Cost-Perf ì§€ìˆ˜ 1 â†’ <strong>1.38</strong> ìƒìŠ¹</li></ul><hr><h2 id=1-ì‹¤í—˜ì—ì„œ-ì‚¬ìš©í•œ-í•µì‹¬-ì„±ëŠ¥-ì§€í‘œ>1. ì‹¤í—˜ì—ì„œ ì‚¬ìš©í•œ í•µì‹¬ ì„±ëŠ¥ ì§€í‘œ</h2><table><thead><tr><th>ì§€í‘œ</th><th>ì •ì˜</th></tr></thead><tbody><tr><td><strong>Inter-node All-Reduce BW (GB/s)</strong></td><td>186 MiB ë°ì´í„°ë¡œ ì¸¡ì •í•œ GPUâ†”NIC ê°„ ë°´ë“œí­</td></tr><tr><td><strong>Step Time / Steps-per-Second</strong></td><td>í•œ í•™ìŠµ ìŠ¤í…ë‹¹ ì‹œê°„ ë˜ëŠ” ì²˜ë¦¬ ìŠ¤í…ìˆ˜ (ëª¨ë¸Â·GPU ìˆ˜ë³„)</td></tr><tr><td><strong>Parallel Efficiency (%)</strong></td><td>$\frac{\text{baseline time} \times n}{\text{scaled time}}$</td></tr><tr><td><strong>Relative GEMM TFLOPS</strong></td><td>TF32Â·FP16 GEMM ì„±ëŠ¥ì„ DGX-A100 = 100 ìœ¼ë¡œ ì •ê·œí™”</td></tr><tr><td><strong>Cost-Performance Ratio</strong></td><td>(ì„±ëŠ¥ / ê°€ê²©) ì§€í‘œ, DGX-A100 = 1 ê¸°ì¤€</td></tr><tr><td><strong>Power Consumption (W)</strong></td><td>ë…¸ë“œ ì†Œë¹„ì „ë ¥; ì „ì²´ í´ëŸ¬ìŠ¤í„° ì „ë ¥ì€ ê°œë³„ ë…¸ë“œÃ—ìˆ˜</td></tr></tbody></table><hr><h2 id=2-ì‚¬ìš©ëœ-ëª¨ë¸ë²¤ì¹˜ë§ˆí¬>2. ì‚¬ìš©ëœ ëª¨ë¸Â·ë²¤ì¹˜ë§ˆí¬</h2><table><thead><tr><th>ì˜ì—­</th><th>ëª¨ë¸ / ì‘ì—…</th><th>ë°ì´í„°Â·ì„¤ì •</th></tr></thead><tbody><tr><td><strong>CV Â­ Weak Scaling</strong></td><td><strong>VGG16</strong></td><td>ImageNet(ì•”ë¬µì )Â·ë°°ì¹˜=256</td></tr><tr><td><strong>NLP Â­ Weak Scaling</strong></td><td><strong>GPT-2-Medium</strong></td><td>í† í¬ë‚˜ì´ì¦ˆë“œ ì›¹ì½”í¼ìŠ¤Â·ë°°ì¹˜=??</td></tr><tr><td><strong>NLP Â­ Strong Scaling</strong></td><td><strong>LLaMA-13B</strong></td><td>seq = 2048, batch = 4096, PP = 4</td></tr><tr><td><strong>NLP Â­ Strong Scaling</strong></td><td><strong>DeepSeek-MoE-16B</strong></td><td>seq = 4096, batch = 4608, PP = 10</td></tr><tr><td><strong>í†µì‹  Microbench</strong></td><td>HFReduce vs NCCL</td><td>186 MiB, 16 â€“ 1 440 GPU</td></tr><tr><td><strong>Compute Microbench</strong></td><td>GEMM TF32/FP16</td><td>cuBLAS synthetic</td></tr></tbody></table><p><em>(ë°ì´í„°ì…‹ì€ ë…¼ë¬¸ì— ëª…ì‹œë˜ì§€ ì•Šì•˜ìœ¼ë‚˜ ì—…ê³„ ê´€ë¡€ìƒ ImageNetÂ·OpenWebTextë¥˜ í‘œì¤€ ì½”í¼ìŠ¤ ì‚¬ìš©)</em></p><hr><h2 id=3-ì£¼ìš”-í‘œê·¸ë¦¼ë³„-ê²°ê³¼>3. ì£¼ìš” í‘œÂ·ê·¸ë¦¼ë³„ ê²°ê³¼</h2><h3 id=3-1-í†µì‹ -ì„±ëŠ¥-figure-7>3-1. í†µì‹  ì„±ëŠ¥ (Figure 7)</h3><table><thead><tr><th>GPU ìˆ˜</th><th>NCCL BW</th><th><strong>HFReduce BW</strong></th><th>í–¥ìƒ</th></tr></thead><tbody><tr><td>16 â€“ 1 440</td><td>1.6 â€“ 4.8 GB/s</td><td><strong>6.3 â€“ 8.1 GB/s</strong></td><td>â–² ìµœëŒ€ 5 Ã—</td></tr></tbody></table><p>NVLink-Bridgeë¥¼ ì¶”ê°€í•˜ë©´ <strong>10 GB/s+</strong> ë‹¬ì„±.</p><h3 id=3-2-ì•½í•œ-ìŠ¤ì¼€ì¼ë§-figure-8>3-2. ì•½í•œ ìŠ¤ì¼€ì¼ë§ (Figure 8)</h3><table><thead><tr><th>ëª¨ë¸</th><th>GPU ë²”ìœ„</th><th>Torch(NCCL) íš¨ìœ¨</th><th><strong>HFReduce/HaiScale íš¨ìœ¨</strong></th><th>ì†ë„ í–¥ìƒ</th></tr></thead><tbody><tr><td>VGG16</td><td>32 â†’ 512</td><td>46 %</td><td><strong>88 %</strong></td><td>í•™ìŠµ ì‹œê°„ Â½ cut</td></tr><tr><td>GPT-2-M</td><td>16 â†’ 128</td><td>57 %</td><td><strong>95 %</strong></td><td>â€œ</td></tr></tbody></table><h3 id=3-3-ê°•í•œ-ìŠ¤ì¼€ì¼ë§-figure-9>3-3. ê°•í•œ ìŠ¤ì¼€ì¼ë§ (Figure 9)</h3><table><thead><tr><th>ëª¨ë¸</th><th>GPU ìˆ˜</th><th>Step Time â†“</th><th>ë³‘ë ¬ íš¨ìœ¨</th></tr></thead><tbody><tr><td>LLaMA-13B</td><td>64 â†’ 512</td><td>64.1 s â†’ <strong>9.7 s</strong></td><td><strong>91 %</strong></td></tr><tr><td>DeepSeek-MoE-16B</td><td>40 â†’ 640</td><td>79.6 s â†’ <strong>6.5 s</strong></td><td>76 % (320 GPU ì‹œ 93 %)</td></tr></tbody></table><h3 id=3-4-ë¹„ìš©ì „ë ¥ì¸í”„ë¼-table-ii-iii>3-4. ë¹„ìš©Â·ì „ë ¥Â·ì¸í”„ë¼ (Table II, III)</h3><table><thead><tr><th>í•­ëª©</th><th>DGX-A100</th><th><strong>Fire-Flyer 2</strong></th><th>ë¹„ìœ¨</th></tr></thead><tbody><tr><td>TF32/FP16 ì„±ëŠ¥</td><td>100</td><td><strong>83</strong></td><td>0.83</td></tr><tr><td>ë…¸ë“œ ê°€ê²©</td><td>100</td><td><strong>60</strong></td><td>0.60</td></tr><tr><td>Cost-Perf</td><td>1.00</td><td><strong>1.38</strong></td><td>+38 %</td></tr><tr><td>ì „ë ¥ (W)</td><td>4 200</td><td><strong>2 500</strong></td><td>âˆ’40 %</td></tr><tr><td>ìŠ¤ìœ„ì¹˜ ìˆ˜</td><td>1 320</td><td><strong>122</strong></td><td>âˆ’90 %</td></tr></tbody></table><hr><h2 id=4-ì €ìë“¤ì´-ê°•ì¡°í•œ-ì„±ê³µ-ì¦ê±°>4. ì €ìë“¤ì´ ê°•ì¡°í•œ â€˜ì„±ê³µ ì¦ê±°â€™</h2><ol><li><strong>HFReduce í†µì‹  ìš°ìœ„</strong> â€“ PCIe í™˜ê²½ì—ì„œë„ NVLink ring ìˆ˜ì¤€ì„ ë„˜ì–´ì„œëŠ” 8 GB/s ëŒ€ì—­í­ìœ¼ë¡œ All-Reduce ë³‘ëª© í•´ì†Œ.</li><li><strong>í•™ìŠµ ìŠ¤ì¼€ì¼ë§</strong> â€“ CNNÂ·GPTÂ·LLaMAÂ·MoE ë“± ë‹¤ì–‘í•œ ëª¨ë¸ì—ì„œ 500 â€“ 640 GPUê¹Œì§€ <strong>â‰¥ 90 %</strong>(ìµœëŒ€) ë³‘ë ¬ íš¨ìœ¨ ìœ ì§€, Torch ëŒ€ë¹„ ìµœëŒ€ <strong>2 Ã—</strong> ì†ë„ í–¥ìƒ.</li><li><strong>ê°€ì„±ë¹„Â·ì¹œí™˜ê²½</strong> â€“ ë™ì¼ ê·œëª¨ DGX-A100 ëŒ€ë¹„ <strong>CAPEX 50 %Â·ì—ë„ˆì§€ 40 % ì ˆê°</strong>ìœ¼ë¡œë„ 80 % ì´ìƒ ì„±ëŠ¥ì„ ë‹¬ì„±í•´ â€œê³ ê°€ NVLink ì—†ì´ë„ ì´ˆëŒ€ê·œëª¨ LLM í›ˆë ¨ì´ ê°€ëŠ¥â€í•¨ì„ ìˆ˜ì¹˜ë¡œ ì…ì¦.</li></ol><h1 id=í”„ë¡¬í”„íŠ¸-142-ë¹„íŒì -ë¹„êµ>í”„ë¡¬í”„íŠ¸ 1.4.2 (ë¹„íŒì  ë¹„êµ)</h1><div class="code-block-container border-border bg-card my-6 overflow-hidden rounded-xl border shadow-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:shadow-md"><div class="code-block-header bg-muted/30 border-border flex items-center justify-between border-b px-4 py-3"><div class="flex items-center gap-2"><div class="text-muted-foreground flex-shrink-0"><svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4 4 4-4 4M6 16l-4-4 4-4"/></svg></div><span class="text-muted-foreground text-sm font-medium">PLAINTEXT</span></div><div class="flex items-center gap-2"><button class="collapse-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-10 data-default-state=expanded data-collapsed=false data-auto-collapse-lines=30 data-auto-collapse-height=400 data-collapsed-height=120 title=ì ‘ê¸° aria-label=ì ‘ê¸°>
<span class=collapse-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41 12 10.83l4.59 4.58L18 14l-6-6-6 6z"/></svg>
</span><span class="collapse-text hidden sm:inline">ì ‘ê¸°</span>
</button>
<button class="copy-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-10 title=ë³µì‚¬ aria-label=ë³µì‚¬>
<span class=copy-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/></svg>
</span><span class="copy-text hidden sm:inline">ë³µì‚¬</span></button></div></div><div class="code-block-content relative" id=code-10><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=ln>1</span><span class=cl>&#34;ì œì•ˆëœ ë°©ë²•ë¡ ì€ ë…¼ë¬¸ì—ì„œ ì–¸ê¸‰ëœ ì£¼ìš” ë² ì´ìŠ¤ë¼ì¸ ë° SOTA(State-of-the-Art) ëª¨ë¸ë“¤ê³¼ ë¹„êµí•˜ì—¬ ì–´ë–¤ ì„±ëŠ¥ì„ ë³´ì´ëŠ”ê°€? ì €ìë“¤ì˜ ìš°ì›”ì„± ì£¼ì¥ì„ ê°€ì¥ ê°•ë ¥í•˜ê²Œ ë’·ë°›ì¹¨í•˜ëŠ” íŠ¹ì • ê²°ê³¼ë‚˜ ë¹„êµ ì§€ì ì„ ì‹ë³„í•´ ì¤˜. ë°˜ëŒ€ë¡œ, ì œì•ˆëœ ë°©ë²•ë¡ ì´ ê²½ìŸ ëª¨ë¸ì„ ëŠ¥ê°€í•˜ì§€ ëª»í–ˆê±°ë‚˜ ê°œì„  íš¨ê³¼ê°€ ë¯¸ë¯¸í–ˆë˜ ê²°ê³¼ëŠ” ì—†ëŠ”ì§€ ì°¾ì•„ë´. ë§Œì•½ ìˆë‹¤ë©´, ì €ìë“¤ì€ ì´ëŸ¬í•œ ê²½ìš°ì— ëŒ€í•´ ì–´ë–¤ ì´ìœ ë¥¼ ì œì‹œí•˜ëŠ”ê°€?&#34;</span></span></code></pre></div><div class="collapse-overlay to-card/90 pointer-events-none absolute inset-0 bg-gradient-to-b from-transparent via-transparent opacity-0 transition-opacity duration-300"><div class="text-muted-foreground bg-card/80 border-border/50 hover:bg-primary/10 hover:text-primary hover:border-primary/30 absolute bottom-4 left-1/2 -translate-x-1/2 cursor-pointer rounded-full border px-3 py-1.5 text-xs backdrop-blur-sm transition-all duration-200">í´ë¦­í•˜ì—¬ ë” ë³´ê¸°</div></div></div></div><script>(function(){const s="code-10",n=document.querySelector('.copy-code-btn[data-code-id="'+s+'"]'),t=document.querySelector('.collapse-code-btn[data-code-id="'+s+'"]'),e=document.getElementById(s);if(!e)return;if(n){const s=n.querySelector(".copy-icon"),t=n.querySelector(".copy-text");n.addEventListener("click",async function(){try{let o="";const i=e.querySelector(".lntd:last-child code");if(i)o=i.textContent||i.innerText;else{const t=e.querySelector("code");if(t){const e=t.querySelector(".ln");if(e){const e=t.querySelectorAll(".cl");if(e.length>0)o=Array.from(e).map(e=>{const t=e.textContent||e.innerText;return t.replace(/\n+$/,"")}).join(`
`).replace(/\n+$/,"");else{const e=t.textContent||t.innerText;o=e.replace(/^\d+/gm,"").replace(/^\s+/gm,"")}}else o=t.textContent||t.innerText}else o=e.textContent||e.innerText}o=o.trim(),await navigator.clipboard.writeText(o),s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
</svg>`,t&&(t.textContent="ë³µì‚¬ë¨"),n.classList.add("text-green-600"),setTimeout(()=>{s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
</svg>`,t&&(t.textContent="ë³µì‚¬"),n.classList.remove("text-green-600")},2e3)}catch(o){console.error("å¤åˆ¶å¤±è´¥:",o);const s=document.createRange(),i=e.querySelector("code")||e;s.selectNodeContents(i);const n=window.getSelection();n.removeAllRanges(),n.addRange(s),t&&(t.textContent="ì„ íƒë¨"),setTimeout(()=>{t&&(t.textContent="ë³µì‚¬"),n.removeAllRanges()},2e3)}})}if(t){const d=t.querySelector(".collapse-icon"),c=t.querySelector(".collapse-text"),n=e.querySelector(".collapse-overlay");let s=e.querySelector("pre.chroma");s||(s=e.querySelector("pre"));const m=t.dataset.defaultState||"expanded",f=t.dataset.collapsed==="true",u=parseInt(t.dataset.autoCollapseLines)||30,h=parseInt(t.dataset.autoCollapseHeight)||400,p=parseInt(t.dataset.collapsedHeight)||120;let l=!1;function i(){const e=f||m==="collapsed"||a();e&&o(!0,!1)}function a(){if(s){const e=s.querySelectorAll(".line, .cl"),t=s.offsetHeight;return e.length>u||t>h}const t=e.offsetHeight;if(t>h)return!0;const n=e.textContent||e.innerText||"",o=n.split(`
`).length;return o>u}function o(s,o=!0){if(!n)return;l=s,s?(e.style.maxHeight=p+"px",e.style.overflow="hidden",n.style.opacity="1",n.style.pointerEvents="auto",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
</svg>`,c&&(c.textContent="í¼ì¹˜ê¸°"),t.title="í¼ì¹˜ê¸°"):(e.style.maxHeight="",e.style.overflow="",n.style.opacity="0",n.style.pointerEvents="none",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z"/></svg>`,c&&(c.textContent="ì ‘ê¸°"),t.title="ì ‘ê¸°"),o&&(e.style.transition="max-height 0.3s ease-out",setTimeout(()=>{e.style.transition=""},300))}function r(){o(!l,!0)}t.addEventListener("click",r),n&&n.addEventListener("click",()=>{l&&o(!1,!0)}),i()}})()</script><p><strong>ê²°ë¡  í•œ ì¤„ ìš”ì•½</strong>
HFReduce + HaiScaleê°€ íƒ‘ì¬ëœ <strong>Fire-Flyer 2(10 k PCIe A100)</strong> ëŠ” í†µì‹ Â·í•™ìŠµÂ·ë¹„ìš© ì§€í‘œì—ì„œ ê¸°ì¡´ NCCL/TorchÂ·DGX-A100 ëŒ€ë¹„ <strong>ìµœëŒ€ 5 Ã— ëŒ€ì—­í­, 2 Ã— í•™ìŠµ ì†ë„, +38 % ê°€ì„±ë¹„</strong>ë¥¼ ë‹¬ì„±í–ˆì§€ë§Œ, <strong>GEMM ì„±ëŠ¥ 83 %</strong>, DeepSeek-MoE 640 GPU íš¨ìœ¨ 76 %, HFReduce 8 GB/s í•œê³„ì²˜ëŸ¼ ëª‡ëª‡ ì˜ì—­ì—ì„œëŠ” SOTAë¥¼ ì™„ì „íˆ ë”°ë¼ì¡ì§€ ëª»í–ˆê³ , ì´ëŠ” <strong>CPU Root-Complex ëŒ€ì—­í­Â·NIC ë³‘ëª©</strong> ë“± ì•„í‚¤í…ì²˜ì  ì œì•½ìœ¼ë¡œ ì„¤ëª…ëœë‹¤.</p><hr><h2 id=1-ìˆ«ìë¡œ-ë³´ëŠ”-sotaëŒ€fire-flyer-2-ë¹„êµ>1. ìˆ«ìë¡œ ë³´ëŠ” SOTAâ€†ëŒ€â€†Fire-Flyer 2 ë¹„êµ</h2><table><thead><tr><th>êµ¬ë¶„</th><th>í•µì‹¬ ì§€í‘œ</th><th><strong>Fire-Flyer 2</strong></th><th>ë² ì´ìŠ¤ë¼ì¸ / SOTA</th><th>ìš°ìœ„(â–³)Â·ì—´ìœ„(â–½)</th></tr></thead><tbody><tr><td><strong>í†µì‹ </strong></td><td>All-Reduce BW (186 MiB)</td><td><strong>6.3 â€“ 8.1 GB/s</strong></td><td>NCCL 1.6 â€“ 4.8 GB/s</td><td><strong>â–³ ìµœëŒ€ 5 Ã—</strong></td></tr><tr><td><strong>CV ì•½í•œ ìŠ¤ì¼€ì¼ë§</strong></td><td>VGG16 32 â†’ 512 GPU ë³‘ë ¬íš¨ìœ¨</td><td><strong>88 %</strong></td><td>Torch DDP 46 %</td><td><strong>â–³ +42 pp (2 Ã— ë¹ ë¦„)</strong></td></tr><tr><td><strong>NLP ì•½í•œ ìŠ¤ì¼€ì¼ë§</strong></td><td>GPT-2-M 16 â†’ 128 GPU íš¨ìœ¨</td><td><strong>95 %</strong></td><td>Torch FSDP â‰ˆ 60 %</td><td><strong>â–³ +35 pp</strong></td></tr><tr><td><strong>LLM ê°•í•œ ìŠ¤ì¼€ì¼ë§</strong></td><td>LLaMA-13B 64 â†’ 512 GPU íš¨ìœ¨</td><td><strong>91 %</strong></td><td>Torch (ê°„ì ‘ ë¹„êµ) ë¯¸ê³µê°œ</td><td><strong>â–³ ê³ íš¨ìœ¨ ìœ ì§€</strong></td></tr><tr><td><strong>MoE ê°•í•œ ìŠ¤ì¼€ì¼ë§</strong></td><td>DeepSeek-MoE-16B 640 GPU íš¨ìœ¨</td><td><strong>76 %</strong> (320 GPU 93 %)</td><td>â€“</td><td><strong>â–½ íš¨ìœ¨ í•˜ë½</strong></td></tr><tr><td><strong>ë¹„ìš©Â·ì „ë ¥</strong></td><td>Cost-Perf Ratio</td><td><strong>1.38</strong></td><td>DGX-A100 1.00</td><td><strong>â–³ +38 %</strong></td></tr><tr><td><strong>Compute GEMM</strong></td><td>TF32/FP16 TFLOPS</td><td><strong>83 %</strong></td><td>DGX-A100 = 100 %</td><td><strong>â–½ â€“17 %</strong></td></tr><tr><td><strong>í†µì‹  ì´ë¡ ì¹˜ ëŒ€ë¹„</strong></td><td>HFReduce ì‹¤ì¸¡</td><td><strong>8 GB/s</strong></td><td>ì´ë¡  12 GB/s</td><td><strong>â–½ â€“33 %</strong> (CPU ë³‘ëª©)</td></tr></tbody></table><hr><h2 id=2-ìš°ì›”ì„±ì„-ê°€ì¥-ì˜-ë³´ì—¬ì£¼ëŠ”-í‚¬ëŸ¬-ìˆ«ì>2. ìš°ì›”ì„±ì„ ê°€ì¥ ì˜ ë³´ì—¬ì£¼ëŠ” â€˜í‚¬ëŸ¬ ìˆ«ìâ€™</h2><ol><li><strong>5 Ã— All-Reduce</strong>â€‚â€“â€‚HFReduceê°€ NCCLì„ 16 â€“ 1 440 GPU ì „ êµ¬ê°„ì—ì„œ 6.3 â€“ 8.1 GB/së¡œ ì••ë„í•´ PCIe ë³‘ëª©ì„ ì œê±°.</li><li><strong>2 Ã— VGG16 í•™ìŠµ ì†ë„</strong>â€‚â€“â€‚HaiScale DDPê°€ Torch DDPë³´ë‹¤ ì ˆë°˜ì˜ ì‹œê°„ì— 512 GPU í•™ìŠµì„ ëëƒ„.</li><li><strong>+38 % ê°€ì„±ë¹„</strong>â€‚â€“â€‚DGX-A100 ëŒ€ë¹„ ë™ì¼ ê·œëª¨ì—ì„œ êµ¬ì¶•ë¹„ 60 %, ì „ë ¥ 60 %ë¡œ 83 % ì„±ëŠ¥ì„ ë‚´ Cost-Perf 1.38 ë‹¬ì„±.</li></ol><hr><h2 id=3-ì„±ëŠ¥ì´-ë¯¸í¡í•˜ê±°ë‚˜-ê°œì„ -í­ì´-ì‘ì•˜ë˜-ì§€ì >3. ì„±ëŠ¥ì´ ë¯¸í¡í•˜ê±°ë‚˜ ê°œì„  í­ì´ ì‘ì•˜ë˜ ì§€ì </h2><table><thead><tr><th>í•­ëª©</th><th>ê´€ì¸¡ëœ í•œê³„</th><th>ì €ì ì„¤ëª…</th></tr></thead><tbody><tr><td><strong>GEMM 83 %</strong></td><td>SXM NVLink GPU ëŒ€ë¹„ 17 % ë‚®ì€ ë‹¨ì¼ GPU ì—°ì‚° ì„±ëŠ¥</td><td>PCIe ì¹´ë“œ ì „ë ¥Â·í´ëŸ­ í•œê³„ëŠ” ê°ìˆ˜í•˜ê³  <em>ëŒ€ì‹  ë¹„ìš©Â·ì „ë ¥ 40 % ì ˆê°</em>ì„ ì„ íƒ</td></tr><tr><td><strong>HFReduce 8 GB/s &lt; 12 GB/s</strong></td><td>DDR4-3200 320 GB/sÂ·ì•Œê³ ë¦¬ì¦˜ ìƒ ì´ë¡ ì¹˜ë³´ë‹¤ 33 % ë‚®ìŒ</td><td>AMD EPYC Rome CPU Root-Complexê°€ ë™ì‹œ ì–‘ë°©í–¥ 37 GB/së¡œ ë³‘ëª© â†’ NVLink-BridgeÂ·ì°¨ì„¸ëŒ€ Genoaë¡œ ì™„í™” ê°€ëŠ¥</td></tr><tr><td><strong>DeepSeek-MoE 640 GPU íš¨ìœ¨ 76 %</strong></td><td>320 GPUê¹Œì§€ëŠ” 93 %ì´ë‚˜ 640 GPUì—ì„œ í•˜ë½</td><td>ë…¸ë“œë‹¹ IB NIC í•œ ì¥ì´ë¼ Pipeline Parallel ë‹¨ê³„ì—ì„œ ë„¤íŠ¸ì›Œí¬ ê²½ìŸ ë°œìƒ; DP rank ìŠ¤íƒœê±°ë§ìœ¼ë¡œ ë¶€ë¶„ ì™„í™”</td></tr></tbody></table><hr><h2 id=4-ì •ë¦¬>4. ì •ë¦¬</h2><p>Fire-Flyer 2ì˜ ê°€ì¥ ê°•ë ¥í•œ ë¹„êµ í¬ì¸íŠ¸ëŠ” **â€˜í†µì‹  5 Ã— â†’ í•™ìŠµ 2 Ã— â†’ ê°€ì„±ë¹„ +38 %â€™**ì˜ ì§ì„  ì—°ê²° ê³ ë¦¬ë‹¤. ë°˜ë©´ <strong>PCIe ì¹´ë“œ í•œê³„Â·CPU ë£¨íŠ¸ ë²„ìŠ¤Â·ë‹¨ì¼ NIC ì„¤ê³„</strong> ë•Œë¬¸ì— ì¼ë¶€ ëª¨ë¸Â·ê·œëª¨ì—ì„œ íš¨ìœ¨ì´ ë–¨ì–´ì¡Œìœ¼ë©°, ì €ìë“¤ì€ <strong>NVLink ë¸Œë¦¬ì§€ ì¶”ê°€, ì°¨ì„¸ëŒ€ CPU, ë³‘ë ¬ ìŠ¤ì¼€ì¤„ ìµœì í™”</strong>ë¥¼ í›„ì† í•´ê²°ì±…ìœ¼ë¡œ ì œì‹œí•œë‹¤.</p><h1 id=í”„ë¡¬í”„íŠ¸-151-ì–¸ê¸‰ëœ-í•œê³„ì™€-ì ì¬ì -í•œê³„>í”„ë¡¬í”„íŠ¸ 1.5.1 (ì–¸ê¸‰ëœ í•œê³„ì™€ ì ì¬ì  í•œê³„)</h1><div class="code-block-container border-border bg-card my-6 overflow-hidden rounded-xl border shadow-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:shadow-md"><div class="code-block-header bg-muted/30 border-border flex items-center justify-between border-b px-4 py-3"><div class="flex items-center gap-2"><div class="text-muted-foreground flex-shrink-0"><svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4 4 4-4 4M6 16l-4-4 4-4"/></svg></div><span class="text-muted-foreground text-sm font-medium">PLAINTEXT</span></div><div class="flex items-center gap-2"><button class="collapse-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-11 data-default-state=expanded data-collapsed=false data-auto-collapse-lines=30 data-auto-collapse-height=400 data-collapsed-height=120 title=ì ‘ê¸° aria-label=ì ‘ê¸°>
<span class=collapse-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41 12 10.83l4.59 4.58L18 14l-6-6-6 6z"/></svg>
</span><span class="collapse-text hidden sm:inline">ì ‘ê¸°</span>
</button>
<button class="copy-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-11 title=ë³µì‚¬ aria-label=ë³µì‚¬>
<span class=copy-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/></svg>
</span><span class="copy-text hidden sm:inline">ë³µì‚¬</span></button></div></div><div class="code-block-content relative" id=code-11><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=ln>1</span><span class=cl>&#34;ì €ìë“¤ì´ ë…¼ë¬¸ì—ì„œ ëª…ì‹œì ìœ¼ë¡œ ì¸ì •í•œ í•œê³„ì , ì•½ì , ë˜ëŠ” ì‹¤íŒ¨ ì‚¬ë¡€(failure modes)ëŠ” ë¬´ì—‡ì¸ê°€? ë‹¤ìŒìœ¼ë¡œ, ë°©ë²•ë¡ ê³¼ ê²°ê³¼ì— ëŒ€í•œ ë‹¹ì‹ ì˜ ë¶„ì„ì„ ë°”íƒ•ìœ¼ë¡œ, ì €ìë“¤ì´ ì–¸ê¸‰í•˜ì§€ ì•Šì•˜ì„ ìˆ˜ ìˆëŠ” ì ì¬ì ì¸ í•œê³„ë‚˜ ì•½ì ì€ ë¬´ì—‡ì´ë¼ê³  ìƒê°í•˜ëŠ”ê°€? (ì˜ˆ: ê°•ë ¥í•œ ê°€ì •ì— ëŒ€í•œ ì˜ì¡´ì„±, í™•ì¥ì„± ë¬¸ì œ, ë†’ì€ ì—°ì‚° ë¹„ìš©, ì¼ë°˜í™”ì˜ í•œê³„, ì ì¬ì ì¸ ë¶€ì •ì  ì‚¬íšŒ ì˜í–¥ ë“±)&#34;</span></span></code></pre></div><div class="collapse-overlay to-card/90 pointer-events-none absolute inset-0 bg-gradient-to-b from-transparent via-transparent opacity-0 transition-opacity duration-300"><div class="text-muted-foreground bg-card/80 border-border/50 hover:bg-primary/10 hover:text-primary hover:border-primary/30 absolute bottom-4 left-1/2 -translate-x-1/2 cursor-pointer rounded-full border px-3 py-1.5 text-xs backdrop-blur-sm transition-all duration-200">í´ë¦­í•˜ì—¬ ë” ë³´ê¸°</div></div></div></div><script>(function(){const s="code-11",n=document.querySelector('.copy-code-btn[data-code-id="'+s+'"]'),t=document.querySelector('.collapse-code-btn[data-code-id="'+s+'"]'),e=document.getElementById(s);if(!e)return;if(n){const s=n.querySelector(".copy-icon"),t=n.querySelector(".copy-text");n.addEventListener("click",async function(){try{let o="";const i=e.querySelector(".lntd:last-child code");if(i)o=i.textContent||i.innerText;else{const t=e.querySelector("code");if(t){const e=t.querySelector(".ln");if(e){const e=t.querySelectorAll(".cl");if(e.length>0)o=Array.from(e).map(e=>{const t=e.textContent||e.innerText;return t.replace(/\n+$/,"")}).join(`
`).replace(/\n+$/,"");else{const e=t.textContent||t.innerText;o=e.replace(/^\d+/gm,"").replace(/^\s+/gm,"")}}else o=t.textContent||t.innerText}else o=e.textContent||e.innerText}o=o.trim(),await navigator.clipboard.writeText(o),s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
</svg>`,t&&(t.textContent="ë³µì‚¬ë¨"),n.classList.add("text-green-600"),setTimeout(()=>{s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
</svg>`,t&&(t.textContent="ë³µì‚¬"),n.classList.remove("text-green-600")},2e3)}catch(o){console.error("å¤åˆ¶å¤±è´¥:",o);const s=document.createRange(),i=e.querySelector("code")||e;s.selectNodeContents(i);const n=window.getSelection();n.removeAllRanges(),n.addRange(s),t&&(t.textContent="ì„ íƒë¨"),setTimeout(()=>{t&&(t.textContent="ë³µì‚¬"),n.removeAllRanges()},2e3)}})}if(t){const d=t.querySelector(".collapse-icon"),c=t.querySelector(".collapse-text"),n=e.querySelector(".collapse-overlay");let s=e.querySelector("pre.chroma");s||(s=e.querySelector("pre"));const m=t.dataset.defaultState||"expanded",f=t.dataset.collapsed==="true",u=parseInt(t.dataset.autoCollapseLines)||30,h=parseInt(t.dataset.autoCollapseHeight)||400,p=parseInt(t.dataset.collapsedHeight)||120;let l=!1;function i(){const e=f||m==="collapsed"||a();e&&o(!0,!1)}function a(){if(s){const e=s.querySelectorAll(".line, .cl"),t=s.offsetHeight;return e.length>u||t>h}const t=e.offsetHeight;if(t>h)return!0;const n=e.textContent||e.innerText||"",o=n.split(`
`).length;return o>u}function o(s,o=!0){if(!n)return;l=s,s?(e.style.maxHeight=p+"px",e.style.overflow="hidden",n.style.opacity="1",n.style.pointerEvents="auto",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
</svg>`,c&&(c.textContent="í¼ì¹˜ê¸°"),t.title="í¼ì¹˜ê¸°"):(e.style.maxHeight="",e.style.overflow="",n.style.opacity="0",n.style.pointerEvents="none",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z"/></svg>`,c&&(c.textContent="ì ‘ê¸°"),t.title="ì ‘ê¸°"),o&&(e.style.transition="max-height 0.3s ease-out",setTimeout(()=>{e.style.transition=""},300))}function r(){o(!l,!0)}t.addEventListener("click",r),n&&n.addEventListener("click",()=>{l&&o(!1,!0)}),i()}})()</script><p><strong>ê²°ë¡  ìš”ì•½ â€” Fire-Flyer 2ê°€ ì¸ì •í•œ í•œê³„ vs. ìš°ë¦¬ê°€ ë³´ëŠ” ì ì¬ì  í•œê³„</strong>
ì €ìë“¤ì€ <strong>CPUÂ·PCIe ë³‘ëª©(8 GB/s í•œê³„), ë‹¨ì¼ NICë¡œ ì¸í•œ íŒŒì´í”„ë¼ì¸ ì¶©ëŒ, NVLink-ê³„ GPU ì¥ì• , ì¼ë¶€ ëª¨ë¸(ëª¨ë‘-íˆ¬-ëª¨ë‘ í†µì‹ ) ì§€ì› ë¶€ì¡±</strong>ì„ ìŠ¤ìŠ¤ë¡œ ì¸ì •í•œë‹¤.
ì¶”ê°€ë¡œ ë¶„ì„í•´ ë³´ë©´ <strong>(i) PCIe A100 ìì²´ ì—°ì‚°ë ¥ ì €í•˜, (ii) CPU 24Ã— ë©”ëª¨ë¦¬ ì´ë™ìœ¼ë¡œ ì¸í•œ ì—ë„ˆì§€Â·ë°œì—´, (iii) ìµœì‹  GPU/CPU ì„¸ëŒ€Â·RoCE ì „í™˜ ë¦¬ìŠ¤í¬, (iv) ë°ì´í„°Â·í”„ë¼ì´ë²„ì‹œÂ·íƒ„ì†Œ ë°°ì¶œ</strong> ë“±ì˜ í•œê³„ê°€ ì ë³µí•´ ìˆë‹¤.</p><hr><h2 id=1-ë…¼ë¬¸ì´-ì§ì ‘-ì¸ì •í•œ-í•œê³„ì•½ì >1. ë…¼ë¬¸ì´ <strong>ì§ì ‘</strong> ì¸ì •í•œ í•œê³„Â·ì•½ì </h2><table><thead><tr><th>êµ¬ë¶„</th><th>ë‚´ìš©</th><th>ì„¸ë¶€ ì„¤ëª… & ê·¼ê±°</th></tr></thead><tbody><tr><td><strong>HFReduce ëŒ€ì—­í­ ìƒí•œ</strong></td><td>ì‹¤ì¸¡ <strong>â‰ˆ 8 GB/s &lt; ì´ë¡  12 GB/s</strong></td><td>D2H/H2DÂ·SIMD AddÂ·RDMA ê³¼ì •ì—ì„œ <strong>ë°ì´í„° 24 ë°°</strong> ë©”ëª¨ë¦¬ ì´ë™, EPYC Rome Root-Complex 37 GB/s ë³‘ëª© â‡’ â€œí…ŒìŠ¤íŠ¸ ê²°ê³¼ 8 GB/së§Œ ë‹¬ì„±â€</td></tr><tr><td><strong>ë‹¨ì¼ NIC â†’ PP ì¶©ëŒ</strong></td><td>ë…¸ë“œë‹¹ 8 GPUì— NIC 1ì¥ì´ë¼ Pipeline Parallel êµ¬ê°„ì—ì„œ ë„¤íŠ¸ì›Œí¬ ê²½í•©Â·íš¨ìœ¨ ì €í•˜</td><td>DP Rank Staggeringìœ¼ë¡œ ì™„í™”í•œë‹¤ê³  ê¸°ìˆ </td></tr><tr><td><strong>ëª¨ë‘-íˆ¬-ëª¨ë‘ í†µì‹  ì·¨ì•½</strong></td><td>MoE 640 GPUì„œ <strong>íš¨ìœ¨ 76 %</strong>; ì°¨ì„¸ëŒ€ ë…¸ë“œëŠ” <strong>1 GPU : 1 NIC</strong>ë¡œ ì„¤ê³„ ì¤‘</td><td>â€œë‹¤ìŒ ì„¸ëŒ€ëŠ” MoEì— í•„ìˆ˜ì ì¸ all-to-all ìœ„í•´ GPU:NIC 1:1â€</td></tr><tr><td><strong>GPU ì•ˆì •ì„±</strong></td><td>NVLink-Bridge ì¶”ê°€ ë’¤ì—ë„ GPU ì¥ì• ì˜ <strong>42.6 %ê°€ Xid-74</strong> ê³„ì—´</td><td>NVLink ê³ ì¥ë¥  ë…¼ì˜</td></tr><tr><td><strong>PCIe A100 ì—°ì‚°ë ¥ ì†ì‹¤</strong></td><td>TF32/FP16 <strong>83 %</strong> (= -17 %)</td><td>PCIe ì¹´ë“œ ì „ë ¥Â·í´ëŸ­ í•œê³„ ì¸ì •</td></tr></tbody></table><hr><h2 id=2-ì ì¬ì -í•œê³„-ë…¼ë¬¸ì—-ëª…ì‹œë˜ì§€-ì•Šì€-ë¶€ë¶„>2. <strong>ì ì¬ì </strong> í•œê³„ (ë…¼ë¬¸ì— ëª…ì‹œë˜ì§€ ì•Šì€ ë¶€ë¶„)</h2><table><thead><tr><th>ì˜ì—­</th><th>ì ì¬ ìœ„í—˜</th><th>ë…¼ë¦¬ì  ê·¼ê±°</th></tr></thead><tbody><tr><td><strong>ê³„ì‚°-í†µì‹  ë¶ˆê· í˜•</strong></td><td>GPU GEMM 83 % ìˆ˜ì¤€ì´ë¼ ëª¨ë¸ì´ <strong>ê³„ì‚° ì§€ë°°ì ì¼ ë•Œ ì„±ëŠ¥ â†“</strong></td><td>í†µì‹  ì´ë“ì´ ê³„ì‚°ëŸ‰ì„ ì¶©ë¶„íˆ ìƒì‡„ ëª»í•  ìˆ˜ ìˆìŒ</td></tr><tr><td><strong>CPU ì˜ì¡´ 24Ã— ë©”ëª¨ë¦¬ I/O</strong></td><td>> 300 GB/s DRAM íŠ¸ë˜í”½ â†’ <strong>ë°œì—´Â·ì „ë ¥ ì¦ê°€</strong>Â·ë…¸ë“œë‹¹ DIMM ì¥ì•  ê°€ëŠ¥ì„±</td><td>DRAM ì—ë„ˆì§€/ì‹ ë¢°ì„± ë¶€ë‹´, ECC Fault ê°€ëŠ¥ì„±</td></tr><tr><td><strong>ì„¸ëŒ€ ì—…ê·¸ë ˆì´ë“œ ë¦¬ìŠ¤í¬</strong></td><td>H100/B100Â·EPYC GenoaëŠ” PCIe 5.0Â·NVLink-C2C ë“± ì¸í„°ì»¤ë„¥íŠ¸ êµ¬ì¡°ê°€ ìƒì´ â†’ <strong>HFReduceÂ·2-ë‹¨ Fat-Tree ì¬íŠœë‹ í•„ìš”</strong></td><td>ë…¼ë¬¸ë„ Genoa Host-Bridge ì œì•½ ì–¸ê¸‰</td></tr><tr><td><strong>RoCE ì „í™˜</strong></td><td>ë¹„ìš© â†“ ëŒ€ì‹  PFCÂ·ECN íŠœë‹ ì‹¤íŒ¨ ë• HOL blocking â†‘</td><td>ë…¼ë¬¸ì´ â€œRoCE ê²€í†  ì¤‘â€ì´ë¼ ì„±ëŠ¥Â·ì‹ ë¢°ì„± ë¶ˆí™•ì‹¤</td></tr><tr><td><strong>ë³´ì•ˆÂ·í”„ë¼ì´ë²„ì‹œ</strong></td><td>ì €ë ´í•´ì§„ ì´ˆëŒ€ê·œëª¨ LLM í›ˆë ¨ì´ <strong>ëª¨ë¸ ë‚¨ìš©Â·ë°ì´í„° ìœ ì¶œ</strong>ì„ ê°€ì†í•  ìˆ˜ ìˆìŒ</td><td>í´ëŸ¬ìŠ¤í„°-ë ˆë²¨ ì ‘ê·¼ ì œì–´Â·ë°ì´í„° ê±°ë²„ë„ŒìŠ¤ ë³„ë„ ê¸°ìˆ  ì—†ìŒ</td></tr><tr><td><strong>ì ˆëŒ€ ì „ë ¥ ì†Œë¹„</strong></td><td>ì „ë ¥ 40 % ì ˆê°í•´ë„ 10 k GPU í´ëŸ¬ìŠ¤í„° <strong>â‰ˆ 3 MW</strong>; <strong>íƒ„ì†Œ ì¤‘ë¦½ ëª©í‘œì™€ ì¶©ëŒ</strong></td><td>ì§€ì—­ ì „ë ¥Â·ëƒ‰ê° ì¸í”„ë¼ ì˜ì¡´, ì¬ìƒì—ë„ˆì§€ í•„ìš”</td></tr></tbody></table><hr><h3 id=3-í•µì‹¬-ì‹œì‚¬ì >3. í•µì‹¬ ì‹œì‚¬ì </h3><ul><li><strong>ë³‘ëª©ì´ CPU/ë©”ëª¨ë¦¬/NICë¼ë©´ GPUë¥¼ ëŠ˜ë ¤ë„ íš¨ìœ¨ì€ ì¼ì • ì§€ì  ì´í›„ ê¸‰ë½</strong> â†’ ì°¨ì„¸ëŒ€ 1:1 NICÂ·PCIe 5.0Â·NVLink-C2Cë¥¼ ê³ ë ¤í•´ì•¼ í•œë‹¤.</li><li><strong>ì†Œí”„íŠ¸ì›¨ì–´-í•˜ë“œì›¨ì–´ co-designì€ ì§€ì†ì ìœ¼ë¡œ ê°±ì‹ </strong>ë˜ì–´ì•¼ í•˜ë©°, HFReduceÂ·HaiScaleê°€ ì°¨ì„¸ëŒ€ ë¶€í’ˆì—ì„œë„ ê°™ì€ ì´ë“ì„ ë³´ì¥í•˜ëŠ”ì§€ëŠ” ë¯¸ì§€ìˆ˜ë‹¤.</li><li><strong>ìš´ì˜ ê´€ì </strong>ì—ì„œëŠ” NVLink ì—ëŸ¬Â·DRAM íŠ¸ë˜í”½ìœ¼ë¡œ ì¸í•œ <strong>MTBF</strong>ë¥¼ ë©´ë°€íˆ ëª¨ë‹ˆí„°ë§í•˜ê³ , íŒŒì›ŒÂ·ì¿¨ë§Â·ë³´ì•ˆ ì •ì±…ì„ ë™ë°˜ ê°œì„ í•´ì•¼ í•œë‹¤.</li></ul><h1 id=í”„ë¡¬í”„íŠ¸-152-ë¯¸ë˜-ì—°êµ¬-ê¶¤ì >í”„ë¡¬í”„íŠ¸ 1.5.2 (ë¯¸ë˜ ì—°êµ¬ ê¶¤ì )</h1><div class="code-block-container border-border bg-card my-6 overflow-hidden rounded-xl border shadow-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:shadow-md"><div class="code-block-header bg-muted/30 border-border flex items-center justify-between border-b px-4 py-3"><div class="flex items-center gap-2"><div class="text-muted-foreground flex-shrink-0"><svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4 4 4-4 4M6 16l-4-4 4-4"/></svg></div><span class="text-muted-foreground text-sm font-medium">PLAINTEXT</span></div><div class="flex items-center gap-2"><button class="collapse-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-12 data-default-state=expanded data-collapsed=false data-auto-collapse-lines=30 data-auto-collapse-height=400 data-collapsed-height=120 title=ì ‘ê¸° aria-label=ì ‘ê¸°>
<span class=collapse-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41 12 10.83l4.59 4.58L18 14l-6-6-6 6z"/></svg>
</span><span class="collapse-text hidden sm:inline">ì ‘ê¸°</span>
</button>
<button class="copy-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-12 title=ë³µì‚¬ aria-label=ë³µì‚¬>
<span class=copy-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/></svg>
</span><span class="copy-text hidden sm:inline">ë³µì‚¬</span></button></div></div><div class="code-block-content relative" id=code-12><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=ln>1</span><span class=cl>&#34;ì €ìë“¤ì´ ì œì•ˆí•˜ëŠ” êµ¬ì²´ì ì¸ í–¥í›„ ì—°êµ¬ ë°©í–¥ì€ ë¬´ì—‡ì¸ê°€? ì´ ë…¼ë¬¸ì˜ í•œê³„ì ì„ ë°”íƒ•ìœ¼ë¡œ, ì´ ì—°êµ¬ë¥¼ ë°œì „ì‹œí‚¤ê±°ë‚˜ ì•½ì ì„ ê·¹ë³µí•˜ê¸° ìœ„í•´ ì¶”êµ¬í•  ìˆ˜ ìˆëŠ” ë‹¤ë¥¸ ë…¼ë¦¬ì ì¸ ë‹¤ìŒ ë‹¨ê³„ë‚˜ ëŒ€ì•ˆì ì¸ ì—°êµ¬ ë°©í–¥ì€ ë¬´ì—‡ì´ ìˆì„ê¹Œ?&#34;</span></span></code></pre></div><div class="collapse-overlay to-card/90 pointer-events-none absolute inset-0 bg-gradient-to-b from-transparent via-transparent opacity-0 transition-opacity duration-300"><div class="text-muted-foreground bg-card/80 border-border/50 hover:bg-primary/10 hover:text-primary hover:border-primary/30 absolute bottom-4 left-1/2 -translate-x-1/2 cursor-pointer rounded-full border px-3 py-1.5 text-xs backdrop-blur-sm transition-all duration-200">í´ë¦­í•˜ì—¬ ë” ë³´ê¸°</div></div></div></div><script>(function(){const s="code-12",n=document.querySelector('.copy-code-btn[data-code-id="'+s+'"]'),t=document.querySelector('.collapse-code-btn[data-code-id="'+s+'"]'),e=document.getElementById(s);if(!e)return;if(n){const s=n.querySelector(".copy-icon"),t=n.querySelector(".copy-text");n.addEventListener("click",async function(){try{let o="";const i=e.querySelector(".lntd:last-child code");if(i)o=i.textContent||i.innerText;else{const t=e.querySelector("code");if(t){const e=t.querySelector(".ln");if(e){const e=t.querySelectorAll(".cl");if(e.length>0)o=Array.from(e).map(e=>{const t=e.textContent||e.innerText;return t.replace(/\n+$/,"")}).join(`
`).replace(/\n+$/,"");else{const e=t.textContent||t.innerText;o=e.replace(/^\d+/gm,"").replace(/^\s+/gm,"")}}else o=t.textContent||t.innerText}else o=e.textContent||e.innerText}o=o.trim(),await navigator.clipboard.writeText(o),s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
</svg>`,t&&(t.textContent="ë³µì‚¬ë¨"),n.classList.add("text-green-600"),setTimeout(()=>{s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
</svg>`,t&&(t.textContent="ë³µì‚¬"),n.classList.remove("text-green-600")},2e3)}catch(o){console.error("å¤åˆ¶å¤±è´¥:",o);const s=document.createRange(),i=e.querySelector("code")||e;s.selectNodeContents(i);const n=window.getSelection();n.removeAllRanges(),n.addRange(s),t&&(t.textContent="ì„ íƒë¨"),setTimeout(()=>{t&&(t.textContent="ë³µì‚¬"),n.removeAllRanges()},2e3)}})}if(t){const d=t.querySelector(".collapse-icon"),c=t.querySelector(".collapse-text"),n=e.querySelector(".collapse-overlay");let s=e.querySelector("pre.chroma");s||(s=e.querySelector("pre"));const m=t.dataset.defaultState||"expanded",f=t.dataset.collapsed==="true",u=parseInt(t.dataset.autoCollapseLines)||30,h=parseInt(t.dataset.autoCollapseHeight)||400,p=parseInt(t.dataset.collapsedHeight)||120;let l=!1;function i(){const e=f||m==="collapsed"||a();e&&o(!0,!1)}function a(){if(s){const e=s.querySelectorAll(".line, .cl"),t=s.offsetHeight;return e.length>u||t>h}const t=e.offsetHeight;if(t>h)return!0;const n=e.textContent||e.innerText||"",o=n.split(`
`).length;return o>u}function o(s,o=!0){if(!n)return;l=s,s?(e.style.maxHeight=p+"px",e.style.overflow="hidden",n.style.opacity="1",n.style.pointerEvents="auto",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
</svg>`,c&&(c.textContent="í¼ì¹˜ê¸°"),t.title="í¼ì¹˜ê¸°"):(e.style.maxHeight="",e.style.overflow="",n.style.opacity="0",n.style.pointerEvents="none",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z"/></svg>`,c&&(c.textContent="ì ‘ê¸°"),t.title="ì ‘ê¸°"),o&&(e.style.transition="max-height 0.3s ease-out",setTimeout(()=>{e.style.transition=""},300))}function r(){o(!l,!0)}t.addEventListener("click",r),n&&n.addEventListener("click",()=>{l&&o(!1,!0)}),i()}})()</script><p><strong>TL;DR</strong>
ì €ìë“¤ì€ <em>Fire-Flyer 2</em>ì˜ í•œê³„(ëª¨ë‘-íˆ¬-ëª¨ë‘ í†µì‹ Â·CPU/PCIe ë³‘ëª©)ë¥¼ í•´ì†Œí•˜ê¸° ìœ„í•´ <strong>â‘  GPU:NIC 1 : 1 ë…¸ë“œ ì„¤ê³„, â‘¡ ë‹¤ì¤‘-í‰ë©´(Multi-Plane) Fat-Tree, â‘¢ RoCE ì „í™˜</strong>ì„ í¬í•¨í•œ ì°¨ì„¸ëŒ€ ì•„í‚¤í…ì²˜ë¥¼ ì¶”ì§„í•œë‹¤. ì´ì— ë”í•´ ë³¸ ë¶„ì„ì€ <strong>PCIe 5.0/CXLÂ·ë©”ëª¨ë¦¬ I/O ì ˆê°Â·ì—ë„ˆì§€/ë³´ì•ˆ ê±°ë²„ë„ŒìŠ¤</strong> ê°™ì€ í™•ì¥ ë°©í–¥ì„ ì œì•ˆí•œë‹¤.</p><hr><h2 id=1-ì €ìë“¤ì´-ì œì‹œí•œ-êµ¬ì²´ì -í–¥í›„-ì—°êµ¬-ê³¼ì œ>1. ì €ìë“¤ì´ ì œì‹œí•œ êµ¬ì²´ì  í–¥í›„ ì—°êµ¬ ê³¼ì œ</h2><table><thead><tr><th>ë²ˆí˜¸</th><th>ì œì•ˆ ë‚´ìš©</th><th>ë™ê¸° / ê¸°ëŒ€ íš¨ê³¼</th><th>ê·¼ê±°</th></tr></thead><tbody><tr><td><strong>A1</strong></td><td><strong>1 GPU : 1 NIC</strong> ë¹„ìœ¨ì˜ <em>Next-Gen PCIe Node</em></td><td>MoE LLMì˜ all-to-all í†µì‹  ë³‘ëª© í•´ì†Œ, DGX-H100/B100 ìˆ˜ì¤€ ë„¤íŠ¸ì›Œí¬ ëŒ€ì—­ í™•ë³´</td><td>â€œnext-gen nodes feature a 1:1 GPU to NIC ratio â€¦ designed for MoE LLM trainingâ€</td></tr><tr><td><strong>A2</strong></td><td><strong>Multi-Plane Two-Layer Fat-Tree</strong>(â‰¤ 4 Plane)</td><td>ìŠ¤ìœ„ì¹˜ ìˆ˜ ì¦ê°€ ì—†ì´ ìµœëŒ€ 32 768 GPU ìŠ¤ì¼€ì¼ ì§€ì›, ë§í¬ í˜¼ì¡ ë¶„ì‚°</td><td>â€œa 4-Plane Two-Layer Fat-Trees network can support up to 32,768 GPUsâ€</td></tr><tr><td><strong>A3</strong></td><td><strong>InfiniBand â†’ 400 Gb RoCE</strong> ìŠ¤ìœ„ì¹˜ë¡œ êµì²´</td><td>ë„¤íŠ¸ì›Œí¬ CAPEX ëŒ€í­ ì ˆê°, 128-port ìŠ¤ìœ„ì¹˜ 1 ëŒ€ë¡œ 400 Gb ë§í¬ ì œê³µ</td><td>â€œexploring the use of RoCE switches â€¦ which can significantly lower network expensesâ€</td></tr><tr><td><strong>A4</strong></td><td><strong>HFReduce + NVLink</strong> ìµœì í™”</td><td>PCIe A100ë„ 10 GB/s+ All-Reduce ë‹¬ì„±, CPU Root-Complex ë³‘ëª© ì™„í™”</td><td>â€œHFReduce with NVLink achieves â€¦ exceeding 10 GB/sâ€</td></tr><tr><td><strong>A5</strong></td><td><strong>ì°¨ì„¸ëŒ€ CPU(EPYC Genoa) ê²€ì¦</strong></td><td>PCIe 5.0Â·ë” ë„“ì€ Host Bridgeë¡œ 37 GB/s ì œí•œ í•´ì†Œ ê¸°ëŒ€</td><td>â€œnext-generation CPUs, such as EPYC Genoa, still face issuesâ€¦ we hope AMD will address thisâ€</td></tr></tbody></table><hr><h2 id=2-ë³¸-ë¶„ì„ì´-ì œì•ˆí•˜ëŠ”-ì¶”ê°€-ì—°êµ¬-ê¶¤ì >2. ë³¸ ë¶„ì„ì´ ì œì•ˆí•˜ëŠ” ì¶”ê°€ ì—°êµ¬ ê¶¤ì </h2><table><thead><tr><th>ì¶•</th><th>ì œì•ˆ ë°©í–¥</th><th>ê¸°ëŒ€ ì„±ê³¼ / í•´ê²°ë  í•œê³„</th></tr></thead><tbody><tr><td><strong>ì»´í“¨íŠ¸</strong></td><td><em>PCIe 5.0Â·CXL 3.0 Fabric</em> ì±„íƒ, L0s/L1 ASPM íŠœë‹</td><td>GPUâ†”CPU ì™•ë³µ ëŒ€ì—­ Ã—2, 24 Ã— ë©”ëª¨ë¦¬ I/Oì— ë”°ë¥¸ DRAM ì „ë ¥â†“</td></tr><tr><td><strong>í†µì‹  ì•Œê³ ë¦¬ì¦˜</strong></td><td>HFReduce v2: <strong>GPUâ†”GPU NVSwitch í”„ë¦¬-ë¦¬ë•ì…˜ + CPU íŒŒì´í”„ë¼ì¸ Split</strong></td><td>SIMT ì»¤ë„ 0 ê°œ ìœ ì§€í•˜ë©´ì„œ PCIe íŠ¸ë˜í”½ Â½ ì¶”ê°€ ì €ê°</td></tr><tr><td><strong>ë©”ëª¨ë¦¬/ìŠ¤í† ë¦¬ì§€</strong></td><td>CPU DRAM ëŒ€ì‹  <strong>DPU DMA â†’ ê³µìœ  HBM ë²„í¼</strong></td><td>24 Ã— DRAM ì´ë™ì— ë”°ë¥¸ ë°œì—´Â·ì‹ ë¢°ì„± ë¬¸ì œ ì™„í™”</td></tr><tr><td><strong>ë„¤íŠ¸ì›Œí¬</strong></td><td><strong>Adaptive All-to-All ìŠ¤ì¼€ì¤„ëŸ¬</strong> (Topology-aware Routing + Load Balancing)</td><td>MoE ëª¨ë¸ 640 GPU íš¨ìœ¨ 76 % â†’ 90 %+ ëª©í‘œ</td></tr><tr><td><strong>ìš´ì˜Â·ì§€ì†ê°€ëŠ¥ì„±</strong></td><td>ì¬ìƒì—ë„ˆì§€ ì—°ê³„ <strong>GPU-aware ì „ë ¥ ìº¡í•‘</strong>Â·ëƒ‰ê° ìµœì í™”</td><td>3 MWê¸‰ í´ëŸ¬ìŠ¤í„° ì ˆëŒ€ ì†Œë¹„ì „ë ¥â†“, ESG ê·œì œ ëŒ€ì‘</td></tr><tr><td><strong>ë³´ì•ˆ/ê±°ë²„ë„ŒìŠ¤</strong></td><td><strong>ë©€í‹°-í…Œë„ŒíŠ¸ RBAC + ë°ì´í„° íë¦„ ì¶”ì </strong> í†µí•©</td><td>ì €ë ´í•´ì§„ LLM í´ëŸ¬ìŠ¤í„°ì˜ ì•…ìš©Â·ë°ì´í„° ìœ ì¶œ ë°©ì§€</td></tr><tr><td><strong>ì†Œí”„íŠ¸ì›¨ì–´</strong></td><td><strong>ìë™ NIC/Fabric ì„ íƒê¸°</strong> (IB â†” RoCEÂ·CXL)</td><td>í•˜ë“œì›¨ì–´ ì´ì§ˆì„± ì¦ê°€ ì‹œ êµ¬ì„± ìë™í™”, ìš´ìš© ë³µì¡ë„ ê°ì†Œ</td></tr></tbody></table><hr><h2 id=3-ì •ë¦¬>3. ì •ë¦¬</h2><p><em>Fire-Flyer 2</em> íŒ€ì€ ì´ë¯¸ <strong>í•˜ë“œì›¨ì–´(1 GPU : 1 NIC)Â·ë„¤íŠ¸ì›Œí¬(Multi-Plane, RoCE)Â·í†µì‹ (NVLink HFReduce)</strong> ë¡œë“œë§µì„ ëª…í™•íˆ ë°í˜”ë‹¤.
í›„ì† ì—°êµ¬ëŠ” <strong>â‘  PCIe 5.0/CXL ê¸°ë°˜ ì „ì†¡ ê²½ë¡œ ì¬ì„¤ê³„, â‘¡ ëª¨ë‘-íˆ¬-ëª¨ë‘ ì§‘ì¤‘ ìµœì í™”, â‘¢ ì¹œí™˜ê²½Â·ë³´ì•ˆ ì§€í–¥ ìš´ì˜ê¸°ìˆ </strong>ë¡œ í™•ì¥ë˜ì–´ì•¼ í•˜ë©°, ì´ëŠ” ê³§ <strong>ì €ë¹„ìš©Â·ê³ íš¨ìœ¨ LLM í›ˆë ¨ ì¸í”„ë¼</strong>ì˜ ë‹¤ìŒ ë‹¨ê³„ ê²½ìŸë ¥ì´ ë  ê²ƒì´ë‹¤.</p><h1 id=êµ¬í˜„-ë°-ìì›>êµ¬í˜„ ë° ìì›</h1><div class="code-block-container border-border bg-card my-6 overflow-hidden rounded-xl border shadow-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:shadow-md"><div class="code-block-header bg-muted/30 border-border flex items-center justify-between border-b px-4 py-3"><div class="flex items-center gap-2"><div class="text-muted-foreground flex-shrink-0"><svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4 4 4-4 4M6 16l-4-4 4-4"/></svg></div><span class="text-muted-foreground text-sm font-medium">PLAINTEXT</span></div><div class="flex items-center gap-2"><button class="collapse-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-13 data-default-state=expanded data-collapsed=false data-auto-collapse-lines=30 data-auto-collapse-height=400 data-collapsed-height=120 title=ì ‘ê¸° aria-label=ì ‘ê¸°>
<span class=collapse-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41 12 10.83l4.59 4.58L18 14l-6-6-6 6z"/></svg>
</span><span class="collapse-text hidden sm:inline">ì ‘ê¸°</span>
</button>
<button class="copy-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-13 title=ë³µì‚¬ aria-label=ë³µì‚¬>
<span class=copy-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/></svg>
</span><span class="copy-text hidden sm:inline">ë³µì‚¬</span></button></div></div><div class="code-block-content relative" id=code-13><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=ln>1</span><span class=cl>&#34;í•µì‹¬ ì†Œí”„íŠ¸ì›¨ì–´ ì˜ì¡´ì„±(ì˜ˆ: CUDA, MPI, íŠ¹ì • ë¼ì´ë¸ŒëŸ¬ë¦¬)ì€ ë¬´ì—‡ì¸ê°€? í•™ìŠµ ë° ì¶”ë¡  ì¤‘ ì˜ˆìƒë˜ëŠ” ë©”ëª¨ë¦¬ ì ìœ ëŸ‰(GPUì˜ ê²½ìš° VRAM, CPUì˜ ê²½ìš° RAM)ì€ ì–¼ë§ˆì¸ê°€? ëª…ì‹œëœ í•˜ë“œì›¨ì–´ì—ì„œì˜ ì²˜ë¦¬ëŸ‰(throughput)ì€ ì–¼ë§ˆì¸ê°€(ì˜ˆ: images/sec, tokens/sec)? ì´ ì—°ì‚° ë¹„ìš©(ì˜ˆ: ì´ FLOPs ë˜ëŠ” Petaflop-days)ì— ëŒ€í•œ ìƒì„¸í•œ ë‚´ì—­ì„ ì œê³µí•´ ì¤˜.&#34;</span></span></code></pre></div><div class="collapse-overlay to-card/90 pointer-events-none absolute inset-0 bg-gradient-to-b from-transparent via-transparent opacity-0 transition-opacity duration-300"><div class="text-muted-foreground bg-card/80 border-border/50 hover:bg-primary/10 hover:text-primary hover:border-primary/30 absolute bottom-4 left-1/2 -translate-x-1/2 cursor-pointer rounded-full border px-3 py-1.5 text-xs backdrop-blur-sm transition-all duration-200">í´ë¦­í•˜ì—¬ ë” ë³´ê¸°</div></div></div></div><script>(function(){const s="code-13",n=document.querySelector('.copy-code-btn[data-code-id="'+s+'"]'),t=document.querySelector('.collapse-code-btn[data-code-id="'+s+'"]'),e=document.getElementById(s);if(!e)return;if(n){const s=n.querySelector(".copy-icon"),t=n.querySelector(".copy-text");n.addEventListener("click",async function(){try{let o="";const i=e.querySelector(".lntd:last-child code");if(i)o=i.textContent||i.innerText;else{const t=e.querySelector("code");if(t){const e=t.querySelector(".ln");if(e){const e=t.querySelectorAll(".cl");if(e.length>0)o=Array.from(e).map(e=>{const t=e.textContent||e.innerText;return t.replace(/\n+$/,"")}).join(`
`).replace(/\n+$/,"");else{const e=t.textContent||t.innerText;o=e.replace(/^\d+/gm,"").replace(/^\s+/gm,"")}}else o=t.textContent||t.innerText}else o=e.textContent||e.innerText}o=o.trim(),await navigator.clipboard.writeText(o),s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
</svg>`,t&&(t.textContent="ë³µì‚¬ë¨"),n.classList.add("text-green-600"),setTimeout(()=>{s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
</svg>`,t&&(t.textContent="ë³µì‚¬"),n.classList.remove("text-green-600")},2e3)}catch(o){console.error("å¤åˆ¶å¤±è´¥:",o);const s=document.createRange(),i=e.querySelector("code")||e;s.selectNodeContents(i);const n=window.getSelection();n.removeAllRanges(),n.addRange(s),t&&(t.textContent="ì„ íƒë¨"),setTimeout(()=>{t&&(t.textContent="ë³µì‚¬"),n.removeAllRanges()},2e3)}})}if(t){const d=t.querySelector(".collapse-icon"),c=t.querySelector(".collapse-text"),n=e.querySelector(".collapse-overlay");let s=e.querySelector("pre.chroma");s||(s=e.querySelector("pre"));const m=t.dataset.defaultState||"expanded",f=t.dataset.collapsed==="true",u=parseInt(t.dataset.autoCollapseLines)||30,h=parseInt(t.dataset.autoCollapseHeight)||400,p=parseInt(t.dataset.collapsedHeight)||120;let l=!1;function i(){const e=f||m==="collapsed"||a();e&&o(!0,!1)}function a(){if(s){const e=s.querySelectorAll(".line, .cl"),t=s.offsetHeight;return e.length>u||t>h}const t=e.offsetHeight;if(t>h)return!0;const n=e.textContent||e.innerText||"",o=n.split(`
`).length;return o>u}function o(s,o=!0){if(!n)return;l=s,s?(e.style.maxHeight=p+"px",e.style.overflow="hidden",n.style.opacity="1",n.style.pointerEvents="auto",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
</svg>`,c&&(c.textContent="í¼ì¹˜ê¸°"),t.title="í¼ì¹˜ê¸°"):(e.style.maxHeight="",e.style.overflow="",n.style.opacity="0",n.style.pointerEvents="none",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z"/></svg>`,c&&(c.textContent="ì ‘ê¸°"),t.title="ì ‘ê¸°"),o&&(e.style.transition="max-height 0.3s ease-out",setTimeout(()=>{e.style.transition=""},300))}function r(){o(!l,!0)}t.addEventListener("click",r),n&&n.addEventListener("click",()=>{l&&o(!1,!0)}),i()}})()</script><h3 id=í•œ-ì¤„-í•µì‹¬-ìš”ì•½>í•œ ì¤„ í•µì‹¬ ìš”ì•½</h3><p>Fire-Flyer 2ëŠ” <strong>PyTorch + HFReduce + HaiScale</strong> ì†Œí”„íŠ¸ì›¨ì–´ ìŠ¤íƒì„ A100 40 GB GPU Ã— 10 000(ë…¸ë“œë‹¹ 8) ìœ„ì— ì–¹ì–´, í•™ìŠµ ì‹œ GPU VRAM â‰ˆ 40 GB/ì¹´ë“œÂ·CPU RAM 512 GB/ë…¸ë“œ ì•ˆì—ì„œ <strong>6.3â€“8.1 GB/s All-Reduce, LLaMA-13B 91 % ë³‘ë ¬ íš¨ìœ¨, CodeLlama-7B ì¶”ë¡  30 k token/s</strong>ë¥¼ ë‹¬ì„±í•˜ë©°, í´ëŸ¬ìŠ¤í„° í”¼í¬ ì—°ì‚°ë ¥ì€ <strong>2.2 EFLOPS</strong>, 70 B ëª¨ë¸ 2 T token í”„ë¦¬-íŠ¸ë ˆì¸ ì‹œ ì•½ <strong>3 EFLOP-days</strong> ê·œëª¨ì˜ ê³„ì‚°ë¹„ë¥¼ ìš”êµ¬í•œë‹¤.</p><hr><h2 id=1-í•µì‹¬-ì†Œí”„íŠ¸ì›¨ì–´ë¼ì´ë¸ŒëŸ¬ë¦¬-ì˜ì¡´ì„±>1. í•µì‹¬ ì†Œí”„íŠ¸ì›¨ì–´/ë¼ì´ë¸ŒëŸ¬ë¦¬ ì˜ì¡´ì„±</h2><table><thead><tr><th>ë²”ì£¼</th><th>êµ¬ì„±ìš”ì†Œ</th><th>ë…¼ë¬¸ ê·¼ê±°</th></tr></thead><tbody><tr><td>DL í”„ë ˆì„ì›Œí¬</td><td><strong>PyTorch (â‰¥1.13)</strong> â€“ HydragenÂ·HaiScale ì „ë¶€ PyTorch API ì‚¬ìš©</td><td></td></tr><tr><td>í†µì‹  ë¼ì´ë¸ŒëŸ¬ë¦¬</td><td><strong>HFReduce</strong>(ìì²´) â€“ Double-Binary-Tree All-Reduce, GDRCopyÂ·ibverbs RDMA í™œìš©</td><td></td></tr><tr><td>NCCL ëŒ€ì²´</td><td><strong>HaiScale DDP/FSDP</strong> â€“ HFReduce ë°±ì—”ë“œ, PyTorch-DDP ëŒ€ë¹„ 2Ã— ë¹ ë¥¸ VGG16 í•™ìŠµ</td><td></td></tr><tr><td>CUDA/ë“œë¼ì´ë²„</td><td>PCIe-A100 ìš”êµ¬ ì‚¬í•­ì— ë”°ë¼ <strong>CUDA 11.x + NVIDIA OFED + GDRCopy</strong> (í…ìŠ¤íŠ¸ ë‚´ CUDA/Xid ì˜¤ë¥˜Â·GDRCopy ìµœì í™” ì–¸ê¸‰)</td><td></td></tr><tr><td>ê°€ì† ì»¤ë„</td><td><strong>flash-attn 2.3.6</strong>, Triton(xformers) ì»¤ë„ â€“ Hydragen êµ¬í˜„ì—ì„œ ì‚¬ìš©</td><td></td></tr><tr><td>íŒŒì¼ì‹œìŠ¤í…œ</td><td><strong>3FS</strong> ê³ ì† í”Œë˜ì‹œ DFS + 3FS-KV, Chain-Replication, RDMA WRITE ê¸°ë°˜</td><td></td></tr><tr><td>ìŠ¤ì¼€ì¤„ëŸ¬</td><td><strong>HAI Platform</strong> (ì‘ì—… ë‹¨ìœ„ GPU ì‹œê°„-ê³µìœ )</td><td></td></tr></tbody></table><hr><h2 id=2-ë©”ëª¨ë¦¬ì—°ì‚°-ìì›-ìš”êµ¬>2. ë©”ëª¨ë¦¬Â·ì—°ì‚° ìì› ìš”êµ¬</h2><table><thead><tr><th>ë‹¨ê³„</th><th>GPU VRAM/ì¹´ë“œ</th><th>CPU RAM/ë…¸ë“œ</th><th>ì£¼ìš” ì›ì¸</th><th>ê·¼ê±°</th></tr></thead><tbody><tr><td><strong>í•™ìŠµ (LLaMA-13B, seq 2048, global batch 4096)</strong></td><td>â‰ˆ 38 GB (íŒŒë¼ë¯¸í„° 13 GB + Optimizer/FSDP ë¶„í•  + Activation)</td><td>512 GB (16-ch DDR4-3200)</td><td>ëª¨ë¸Â·ì˜µí‹°ë§ˆì´ì €Â·ì•½ 2Ã— activation</td><td>ë…¸ë“œ HW ìŠ¤í™ , FSDP ì„¤ëª…</td></tr><tr><td><strong>ì¶”ë¡  (CodeLlama-34B, prefix 1 K)</strong></td><td>40 GB í•œê³„ ê·¼ì ‘ â€“ batch â‰¥ 128ì—ì„œ OOM í‘œì‹œ â€œXâ€</td><td>â€”</td><td>KV-Cache ë©”ëª¨ë¦¬</td><td>Hydragen í‘œ ê²°ê³¼</td></tr></tbody></table><blockquote class="border-primary bg-muted/30 hover:bg-muted/40 my-6 rounded-r-lg border-l-4 py-4 pr-4 pl-6 italic transition-all duration-200 ease-out hover:translate-x-1"><div class="prose prose-sm max-w-none"><p><em>Figure 3</em> ëŠ” GPT-3, PaLM ë“± íŒŒë¼ë¯¸í„° í¬ê¸°ì™€ í•„ìš” ë©”ëª¨ë¦¬ë¥¼ ì‹œê°í™”(ê° 1 TB HBM ìˆ˜ì¤€) .</p></div></blockquote><hr><h2 id=3-ì²˜ë¦¬ëŸ‰throughput-ì¸¡ì •ì¹˜>3. ì²˜ë¦¬ëŸ‰(Throughput) ì¸¡ì •ì¹˜</h2><h3 id=3-1-í†µì‹ all-reduce>3-1. í†µì‹ /All-Reduce</h3><p><em>186 MiB ê·¸ë˜ë””ì–¸íŠ¸, 8 Ã— A100 ë…¸ë“œ ê¸°ì¤€</em></p><table><thead><tr><th>ë¼ì´ë¸ŒëŸ¬ë¦¬</th><th>Bandwidth (GB/s)</th></tr></thead><tbody><tr><td><strong>HFReduce</strong></td><td><strong>6.3 â€“ 8.1</strong></td></tr><tr><td>NCCL (PCIe)</td><td>1.6 â€“ 4.8</td></tr></tbody></table><h3 id=3-2-ëª¨ë¸-í•™ìŠµ-ê°•í•œ-ìŠ¤ì¼€ì¼ë§>3-2. ëª¨ë¸ í•™ìŠµ ê°•í•œ ìŠ¤ì¼€ì¼ë§</h3><p><em>LLaMA-13B (seq 2048, batch 4096, PP 4)</em></p><table><thead><tr><th>GPU ìˆ˜</th><th>ìŠ¤í… íƒ€ì„ (s)</th><th>ë³‘ë ¬ íš¨ìœ¨</th></tr></thead><tbody><tr><td>64</td><td>64.1</td><td></td></tr><tr><td>128</td><td>32.5</td><td></td></tr><tr><td>256</td><td>17.4</td><td></td></tr><tr><td><strong>512</strong></td><td><strong>9.7</strong></td><td><strong>91 %</strong></td></tr></tbody></table><h3 id=3-3-llm-ì¶”ë¡ -hydragen-8--a100-40-gb>3-3. LLM ì¶”ë¡  (Hydragen, 8 Ã— A100 40 GB)</h3><p><em>CodeLlama-7B, ìƒì„± 128 token, prefix 1 K</em></p><table><thead><tr><th>Batch</th><th>FlashAttn-2</th><th>vLLM</th><th><strong>Hydragen</strong></th></tr></thead><tbody><tr><td>256</td><td>8.1 k tok/s</td><td>6.9 k</td><td><strong>13.3 k</strong></td></tr><tr><td>512</td><td>â€” (OOM)</td><td>â€”</td><td><strong>19.6 k</strong></td></tr><tr><td><strong>2048</strong></td><td>â€”</td><td>â€”</td><td><strong>30.1 k</strong></td></tr></tbody></table><p>â†’ ìµœëŒ€ <strong>32 Ã—</strong> vLLM ê°€ì†(13 B ëª¨ë¸ì—ì„œ ë³´ê³ )</p><hr><h2 id=4-ì´-ì—°ì‚°-ë¹„ìš©-flops--petaflop-days>4. ì´ ì—°ì‚° ë¹„ìš© (FLOPs & Petaflop-days)</h2><table><thead><tr><th>í•­ëª©</th><th>ìˆ˜ì¹˜</th><th>ì‚°ì¶œ ê·¼ê±°</th></tr></thead><tbody><tr><td><strong>í”¼í¬ FP16/GEMM</strong></td><td>220 TFLOPS / GPU (PCIe-A100)</td><td></td></tr><tr><td>í´ëŸ¬ìŠ¤í„° í”¼í¬</td><td>220 TFLOPS Ã— 10 000 = <strong>2.2 EFLOPS</strong></td><td></td></tr><tr><td>ì˜ˆ: LLaMA-70B, 2 T tokens</td><td>ì´ë¡  FLOPs â‰ˆ 6 Ã— ã€ˆíŒŒë¼ë¯¸í„°ã€‰Ã— ì‹œí€€ìŠ¤ 2048 Ã— í† í° â‰ˆ 6.0 e23 FLOPs â†’ <strong>â‰ˆ 3000 PFLOP-days</strong> @ 50 % MFU</td><td></td></tr><tr><td>ì „ë ¥(ë…¸ë“œ)</td><td>2.5 kW (PCIe) vs 4.2 kW (DGX)</td><td></td></tr></tbody></table><blockquote class="border-primary bg-muted/30 hover:bg-muted/40 my-6 rounded-r-lg border-l-4 py-4 pr-4 pl-6 italic transition-all duration-200 ease-out hover:translate-x-1"><div class="prose prose-sm max-w-none"><p>ì €ìë“¤ì€ ì „ì²´ í•™ìŠµ FLOPsë¥¼ ëª…ì‹œí•˜ì§€ ì•Šì•˜ìœ¼ë¯€ë¡œ, ìœ„ ê³„ì‚°ì€ ì¼ë°˜ì ì¸ Transformer ê³µì‹ê³¼ ë…¼ë¬¸-ì œì‹œ í”¼í¬ ì„±ëŠ¥ì„ ì´ìš©í•œ <strong>ë³´ìˆ˜ì  ì¶”ì •ì¹˜</strong>ë‹¤.</p></div></blockquote><hr><h2 id=5-ì •ë¦¬-1>5. ì •ë¦¬</h2><ul><li>Fire-Flyer 2ëŠ” <strong>ì €ë¹„ìš© PCIe-A100</strong> êµ¬ì„±ì„ <strong>HFReduce (í†µì‹ ) + HaiScale (ë³‘ë ¬í™”) + 3FS (ìŠ¤í† ë¦¬ì§€)</strong> ë¡œ ë¬¶ì–´, DGX-A100 ëŒ€ë¹„ <strong>ë¹„ìš© 40 % ì ˆê°, ì „ë ¥ 40 % ì ˆê°</strong>í•˜ë©´ì„œë„ TF32/FP16 ì„±ëŠ¥ì˜ **83 %**ë¥¼ ìœ ì§€í•œë‹¤.</li><li>í•™ìŠµ ì‹œ <strong>HFReduce</strong>ê°€ NCCL ë³‘ëª©(PCIe P2P ë¯¸ì§€ì›) ì„ íšŒí”¼í•˜ì—¬ 1.5â€“3 Ã— ëŒ€ì—­í­ì„ ì œê³µ, ëŒ€ê·œëª¨ LLaMA-13B í•™ìŠµì—ì„œ 91 % ìŠ¤ì¼€ì¼ë§ì„ í™•ì¸.</li><li>ì¶”ë¡  ì¸¡ë©´ì—ì„œëŠ” <strong>Hydragen</strong>ì´ ê³µìœ  í”„ë¦¬í”½ìŠ¤ í™œìš©ìœ¼ë¡œ ìµœëŒ€ <strong>32 Ã— í† í°/ì´ˆ</strong>ë¥¼ ë‹¬ì„±, GPU ë©”ëª¨ë¦¬ ì‚¬ìš© í•œê³„ë¥¼ ë„˜ì–´ì„œëŠ” ëŒ€í˜• ë°°ì¹˜-ì¶”ë¡ ì„ ê°€ëŠ¥ì¼€ í•œë‹¤.</li><li>ì „ì²´ 10 k GPU í´ëŸ¬ìŠ¤í„°ëŠ” <strong>2.2 EFLOPS í”¼í¬</strong>, ì´ˆëŒ€í˜• 70 B ëª¨ë¸ í•™ìŠµ ì‹œ <strong>ìˆ˜ EFLOP-days</strong> ë‹¨ìœ„ì˜ ì—°ì‚°ë¹„ê°€ ìš”êµ¬ë˜ë¯€ë¡œ, ê³ íš¨ìœ¨ í†µì‹ Â·ë©”ëª¨ë¦¬ ìµœì í™”ê°€ ê²½ì œì„±ì„ ì¢Œìš°í•œë‹¤.</li></ul><h1 id=í‰ê°€-ë°-ì§€í‘œ>í‰ê°€ ë° ì§€í‘œ</h1><div class="code-block-container border-border bg-card my-6 overflow-hidden rounded-xl border shadow-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:shadow-md"><div class="code-block-header bg-muted/30 border-border flex items-center justify-between border-b px-4 py-3"><div class="flex items-center gap-2"><div class="text-muted-foreground flex-shrink-0"><svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4 4 4-4 4M6 16l-4-4 4-4"/></svg></div><span class="text-muted-foreground text-sm font-medium">PLAINTEXT</span></div><div class="flex items-center gap-2"><button class="collapse-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-14 data-default-state=expanded data-collapsed=false data-auto-collapse-lines=30 data-auto-collapse-height=400 data-collapsed-height=120 title=ì ‘ê¸° aria-label=ì ‘ê¸°>
<span class=collapse-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41 12 10.83l4.59 4.58L18 14l-6-6-6 6z"/></svg>
</span><span class="collapse-text hidden sm:inline">ì ‘ê¸°</span>
</button>
<button class="copy-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-14 title=ë³µì‚¬ aria-label=ë³µì‚¬>
<span class=copy-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/></svg>
</span><span class="copy-text hidden sm:inline">ë³µì‚¬</span></button></div></div><div class="code-block-content relative" id=code-14><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=ln>1</span><span class=cl>&#34;í‰ê°€ë¥¼ ìœ„í•œ ì£¼ìš” ì§€í‘œëŠ” ë¬´ì—‡ì¸ê°€: ì§€ì—° ì‹œê°„(latency), ì²˜ë¦¬ëŸ‰(throughput), ì „ë ¥ ì†Œë¹„, ë˜ëŠ” ë¹„ìš© ëŒ€ë¹„ ì„±ëŠ¥? ì‹œìŠ¤í…œì€ ë” ë§ì€ ë°ì´í„°, ì‚¬ìš©ì, ë˜ëŠ” ì»´í“¨íŒ… ë…¸ë“œì— ë”°ë¼ ì–´ë–»ê²Œ í™•ì¥ë˜ëŠ”ê°€?&#34;</span></span></code></pre></div><div class="collapse-overlay to-card/90 pointer-events-none absolute inset-0 bg-gradient-to-b from-transparent via-transparent opacity-0 transition-opacity duration-300"><div class="text-muted-foreground bg-card/80 border-border/50 hover:bg-primary/10 hover:text-primary hover:border-primary/30 absolute bottom-4 left-1/2 -translate-x-1/2 cursor-pointer rounded-full border px-3 py-1.5 text-xs backdrop-blur-sm transition-all duration-200">í´ë¦­í•˜ì—¬ ë” ë³´ê¸°</div></div></div></div><script>(function(){const s="code-14",n=document.querySelector('.copy-code-btn[data-code-id="'+s+'"]'),t=document.querySelector('.collapse-code-btn[data-code-id="'+s+'"]'),e=document.getElementById(s);if(!e)return;if(n){const s=n.querySelector(".copy-icon"),t=n.querySelector(".copy-text");n.addEventListener("click",async function(){try{let o="";const i=e.querySelector(".lntd:last-child code");if(i)o=i.textContent||i.innerText;else{const t=e.querySelector("code");if(t){const e=t.querySelector(".ln");if(e){const e=t.querySelectorAll(".cl");if(e.length>0)o=Array.from(e).map(e=>{const t=e.textContent||e.innerText;return t.replace(/\n+$/,"")}).join(`
`).replace(/\n+$/,"");else{const e=t.textContent||t.innerText;o=e.replace(/^\d+/gm,"").replace(/^\s+/gm,"")}}else o=t.textContent||t.innerText}else o=e.textContent||e.innerText}o=o.trim(),await navigator.clipboard.writeText(o),s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
</svg>`,t&&(t.textContent="ë³µì‚¬ë¨"),n.classList.add("text-green-600"),setTimeout(()=>{s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
</svg>`,t&&(t.textContent="ë³µì‚¬"),n.classList.remove("text-green-600")},2e3)}catch(o){console.error("å¤åˆ¶å¤±è´¥:",o);const s=document.createRange(),i=e.querySelector("code")||e;s.selectNodeContents(i);const n=window.getSelection();n.removeAllRanges(),n.addRange(s),t&&(t.textContent="ì„ íƒë¨"),setTimeout(()=>{t&&(t.textContent="ë³µì‚¬"),n.removeAllRanges()},2e3)}})}if(t){const d=t.querySelector(".collapse-icon"),c=t.querySelector(".collapse-text"),n=e.querySelector(".collapse-overlay");let s=e.querySelector("pre.chroma");s||(s=e.querySelector("pre"));const m=t.dataset.defaultState||"expanded",f=t.dataset.collapsed==="true",u=parseInt(t.dataset.autoCollapseLines)||30,h=parseInt(t.dataset.autoCollapseHeight)||400,p=parseInt(t.dataset.collapsedHeight)||120;let l=!1;function i(){const e=f||m==="collapsed"||a();e&&o(!0,!1)}function a(){if(s){const e=s.querySelectorAll(".line, .cl"),t=s.offsetHeight;return e.length>u||t>h}const t=e.offsetHeight;if(t>h)return!0;const n=e.textContent||e.innerText||"",o=n.split(`
`).length;return o>u}function o(s,o=!0){if(!n)return;l=s,s?(e.style.maxHeight=p+"px",e.style.overflow="hidden",n.style.opacity="1",n.style.pointerEvents="auto",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
</svg>`,c&&(c.textContent="í¼ì¹˜ê¸°"),t.title="í¼ì¹˜ê¸°"):(e.style.maxHeight="",e.style.overflow="",n.style.opacity="0",n.style.pointerEvents="none",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z"/></svg>`,c&&(c.textContent="ì ‘ê¸°"),t.title="ì ‘ê¸°"),o&&(e.style.transition="max-height 0.3s ease-out",setTimeout(()=>{e.style.transition=""},300))}function r(){o(!l,!0)}t.addEventListener("click",r),n&&n.addEventListener("click",()=>{l&&o(!1,!0)}),i()}})()</script><p><strong>ìš”ì•½ í•œ ì¤„</strong>
Fire-Flyer 2ëŠ” <em>í†µì‹  ëŒ€ì—­í­ (8 GB/s) â†’ í•™ìŠµ ì²˜ë¦¬ëŸ‰Â·ë³‘ë ¬ íš¨ìœ¨ (ìµœëŒ€ 95 %) â†’ ë¹„ìš©Â·ì „ë ¥ ê°€ì„±ë¹„ (+38 %)</em> ì„¸ ì¶•ìœ¼ë¡œ ì„±ëŠ¥ì„ í‰ê°€í•˜ë©°, 10 000 GPUê¹Œì§€ <strong>ì•½í•œÂ·ê°•í•œ ìŠ¤ì¼€ì¼ ë‘˜ ë‹¤ ì„ í˜•ì— ê°€ê¹Œìš´ í™•ì¥ì„±</strong>ì„ ì…ì¦í–ˆë‹¤.</p><hr><h2 id=1-ë…¼ë¬¸ì—ì„œ-ì‚¬ìš©í•œ-í•µì‹¬-í‰ê°€ì§€í‘œ>1. ë…¼ë¬¸ì—ì„œ ì‚¬ìš©í•œ í•µì‹¬ í‰ê°€ì§€í‘œ</h2><table><thead><tr><th>ë²”ì£¼</th><th>ì§€í‘œ</th><th>ì •ì˜Â·ì¸¡ì •ë²•</th><th>ëŒ€í‘œ ìˆ˜ì¹˜</th></tr></thead><tbody><tr><td><strong>í†µì‹ </strong></td><td><strong>Inter-node All-Reduce BW (GB/s)</strong></td><td>186 MiB ê·¸ë˜ë””ì–¸íŠ¸ í•œ ë²ˆ ê°ì¶• ì‹œ ë…¸ë“œê°„ ì‹¤ì¸¡ ëŒ€ì—­í­</td><td><strong>6.3 â€“ 8.1 GB/s</strong> (HFReduce) vs 1.6 â€“ 4.8 (NCCL)</td></tr><tr><td><strong>í•™ìŠµ</strong></td><td><strong>Step Time / Parallel Efficiency</strong></td><td>ê³ ì •Â·ê°€ë³€ ë°°ì¹˜ ëª¨ë‘ì—ì„œ <code>baseline Ã— n / scaled</code></td><td>LLaMA-13B 512 GPU <strong>9.7 s, 91 %</strong></td></tr><tr><td></td><td><strong>Weak-Scaling Efficiency</strong></td><td>GPU ìˆ˜ â†‘, ì‘ì—…ëŸ‰ âˆ GPU</td><td>VGG16 32â†’512 GPU <strong>88 %</strong> íš¨ìœ¨ (Torch DDP 46 %)</td></tr><tr><td></td><td><strong>MFU (Model FLOPs Utilization)</strong></td><td>ê´€ì¸¡ FLOPs / ì´ë¡  í”¼í¬</td><td>ë…¼ë¬¸ í…ìŠ¤íŠ¸ì—ì„œ íš¨ìœ¨ í™•ë³´ ë°©ë²• ê¸°ìˆ </td></tr><tr><td><strong>ì‹œìŠ¤í…œ</strong></td><td><strong>Cost-Performance Ratio</strong></td><td>(TF32 ë˜ëŠ” FP16 GEMM ì„±ëŠ¥) / (ë…¸ë“œ ë¹„ìš©)Â·DGX=1</td><td><strong>1.38</strong> (ì„±ëŠ¥ 83 %, ë¹„ìš© 60 %)</td></tr><tr><td></td><td><strong>Power per Node (W)</strong></td><td>GPU+CPU+NIC ì „ì²´ ì†Œë¹„ì „ë ¥</td><td>2 500 W (DGX 4 200 W)</td></tr><tr><td></td><td><strong>ì „(å…¨)í´ëŸ¬ìŠ¤í„° ì „ë ¥ (MW)</strong></td><td>ë…¸ë“œÂ·ë„¤íŠ¸ì›Œí¬ í•©ì‚°</td><td><strong>â‰ˆ 3 MW &lt; 4 MW</strong></td></tr><tr><td></td><td><strong>CapExâ€”Switch Count</strong></td><td>10 k GPU êµ¬ì„±ì— í•„ìš”í•œ ìŠ¤ìœ„ì¹˜ ìˆ˜</td><td><strong>122</strong> (DGX A100 : 1 320)</td></tr><tr><td><strong>ì¶”ë¡ </strong></td><td><strong>Tokens /s</strong></td><td>CodeLlama 7B, 8Ã—A100</td><td><strong>30 k tok/s</strong> @ batch 2048 (Hydragen)</td></tr></tbody></table><hr><h2 id=2-ìŠ¤ì¼€ì¼-í™•ì¥ì„±-ë¶„ì„>2. ìŠ¤ì¼€ì¼ í™•ì¥ì„± ë¶„ì„</h2><table><thead><tr><th>ìŠ¤ì¼€ì¼ë§ ìœ í˜•</th><th>ì‹¤í—˜ ëŒ€ìƒÂ·ì¡°ê±´</th><th>ê²°ê³¼</th><th>í•´ì„</th></tr></thead><tbody><tr><td><strong>ì•½í•œ(W)</strong></td><td>VGG16 32â†’512 GPU</td><td>Torch DDP 46 % â†’ <strong>HFReduce 88 %</strong></td><td>í†µì‹  ë³‘ëª© ì œê±°ë¡œ ê³„ì‚°-í†µì‹  ì˜¤ë²„ë© ê·¹ëŒ€í™”</td></tr><tr><td></td><td>GPT-2-Medium 16â†’128 GPU</td><td><strong>95 %</strong> íš¨ìœ¨, Torch-FSDP ëŒ€ë¹„ 2Ã— ì†ë„</td><td></td></tr><tr><td><strong>ê°•í•œ(S)</strong></td><td>LLaMA-13B 64â†’512 GPU</td><td>Step 64.1 s â†’ <strong>9.7 s</strong>, íš¨ìœ¨ 91 %</td><td>ë…¸ë“œë‹¹ NIC 1ì¥ êµ¬ì¡°ì—ì„œë„ PP ì¶©ëŒ ì™„í™”</td></tr><tr><td></td><td>DeepSeek-MoE-16B 40â†’640 GPU</td><td>79.6 s â†’ <strong>6.5 s</strong>, íš¨ìœ¨ 76 % (320 GPU 93 %)</td><td>all-to-all ì§‘ì¤‘ ëª¨ë¸ì—ì„œ 1 NIC í•œê³„ ë…¸ì¶œ</td></tr><tr><td><strong>í†µì‹ </strong></td><td>HFReduce 16â†’1 440 GPU</td><td>6.3 â†’ 8.1 GB/s, ì„ í˜•ì— ê°€ê¹Œìš´ ìƒìŠ¹</td><td>Double-Binary-Treeê°€ íŠ¸ë¦¬ ê¹Šì´ ì¦ê°€ì— ìƒìˆ˜ ì „ì†¡ íšŸìˆ˜</td></tr><tr><td><strong>ë„¤íŠ¸ì›Œí¬ í† í´ë¡œì§€</strong></td><td>2-ë‹¨ Fat-Tree Ã— 2 ì¡´</td><td>í¬ë¡œìŠ¤-ì¡´ íŠ¸ë˜í”½ 1 ì‘ì—…ìœ¼ë¡œ ì œí•œ, 10 k GPU ì „ì—­ íƒœìŠ¤í¬ë„ ë¬´ì‚¬íˆ ì‹¤í–‰</td><td></td></tr></tbody></table><blockquote class="border-primary bg-muted/30 hover:bg-muted/40 my-6 rounded-r-lg border-l-4 py-4 pr-4 pl-6 italic transition-all duration-200 ease-out hover:translate-x-1"><div class="prose prose-sm max-w-none"><p><strong>ìš”ì </strong>â€‚HFReduce + HaiScale ìŠ¤íƒì€ ë…¸ë“œ ìˆ˜Â·GPU ìˆ˜ë¥¼ ìˆ˜ë°± â†’ ìˆ˜ì²œ ë‹¨ìœ„ë¡œ ëŠ˜ë ¤ë„ <strong>í†µì‹  BWÂ·í•™ìŠµ íš¨ìœ¨ì´ ì„œì„œíˆë§Œ ê°ì†Œ</strong>í•˜ë©°, ë¹„ìš©Â·ì „ë ¥Â·ìŠ¤ìœ„ì¹˜ ìˆ˜ëŠ” NVLink-DGX ëŒ€ë¹„ í° í­ìœ¼ë¡œ ì ˆê°ëœë‹¤.</p></div></blockquote><hr><h2 id=3-ë©”íŠ¸ë¦­ë³„-ì˜ì˜>3. ë©”íŠ¸ë¦­ë³„ ì˜ì˜</h2><ul><li><strong>Latency / Step Time</strong> â€“ ëª¨ë¸-ê·œëª¨ ê²°ì • ì‹œ ì§ì ‘ì ì¸ â€œì‹œê°„-ëŒ€-ì •ë‹µâ€ ì§€í‘œ. LLaMA-13B í•™ìŠµì„ 64 â†’ 512 GPUë¡œ ëŠ˜ë ¤ <strong>6.6Ã—</strong> ì†ë„ í–¥ìƒì„ ë‹¬ì„±í•˜ë©´ì„œë„ íš¨ìœ¨ 91 % ìœ ì§€ .</li><li><strong>Throughput</strong> â€“ HFReduceê°€ NCCLë³´ë‹¤ ìµœëŒ€ <strong>5Ã—</strong> ë†’ì€ All-Reduce BWë¥¼ ì œê³µ, ì „ì²´ íŒŒì´í”„ë¼ì¸ì—ì„œ ì²˜ë¦¬ëŸ‰(steps /s, tokens /s)ì„ ëŒì–´ì˜¬ë¦¼ .</li><li><strong>Power & Cost-Perf</strong> â€“ ë…¸ë“œë‹¹ 1 NIC, 2-ë‹¨ Fat-Tree ì„¤ê³„ ë•ë¶„ì— <strong>ì „ë ¥ 40 %â†“, Cost-Perf +38 %</strong> . ëŒ€ê·œëª¨ í•™ìŠµì—ì„œ ì „ê¸°ë£ŒÂ·CapExê°€ ì§ì ‘ ì ˆê°.</li><li><strong>Scalability</strong> â€“ ì•½í•œÂ·ê°•í•œ ìŠ¤ì¼€ì¼ ëª¨ë‘ 90 % ì „í›„ íš¨ìœ¨(Except MoE 640 GPU 76 %)ì„ ë‹¬ì„±í•´, ë°ì´í„°Â·ì‚¬ìš©ìÂ·GPU ìˆ˜ë¥¼ ëŠ˜ë ¤ë„ <strong>ì„ í˜• ê·¼ì‚¬ ì„±ëŠ¥</strong>ì„ ë³´ì¥.</li></ul><hr><h2 id=4-ì¢…í•©>4. ì¢…í•©</h2><p>Fire-Flyer 2ëŠ” <strong>í†µì‹ â†’í•™ìŠµâ†’ê²½ì œì„±</strong>ì˜ ì„¸ ì¸µìœ„ ì§€í‘œë¥¼ ì²´ê³„ì ìœ¼ë¡œ ì¸¡ì •í•˜ê³ , 10 k GPUê¹Œì§€ì˜ ì‹¤ì¸¡ ë°ì´í„°ë¥¼ í†µí•´ <strong>NVLink ì—†ì´ë„ ì´ˆëŒ€ê·œëª¨ LLM í•™ìŠµì´ ê°€ëŠ¥</strong>í•¨ì„ ìˆ˜ì¹˜ë¡œ ì¦ëª…í–ˆë‹¤. ì§€ì—° ì‹œê°„Â·ì²˜ë¦¬ëŸ‰Â·ì „ë ¥Â·ë¹„ìš© ëŒ€ë¹„ ì„±ëŠ¥ ëª¨ë‘ê°€ í‰ê°€ ëŒ€ìƒì´ë©°, íŠ¹íˆ <strong>Double-Binary-Tree HFReduce</strong> ë•ë¶„ì— ë…¸ë“œ ìˆ˜ê°€ ì»¤ì ¸ë„ ì„±ëŠ¥ ë¶•ê´´ ì—†ì´ í™•ì¥ëœë‹¤.</p></details></article></main><footer class="mx-auto max-w-4xl px-4 py-8"><div class="px-6 py-6"><nav class=mb-6><div class="flex flex-wrap items-center justify-center gap-1"><a href=/index.xml class="nav-link hover:text-primary hover:bg-primary/10 text-muted-foreground flex items-center gap-2 rounded-lg px-4 py-2 text-sm font-medium transition-all duration-300 hover:scale-105"><svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="RSS Feed"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 5c7.18.0 13 5.82 13 13M6 11a7 7 0 017 7m-6 0a1 1 0 11-2 0 1 1 0 012 0z"/></svg>
<span>RSS Feed</span></a></div></nav><div class="border-border mb-6 border-t"></div><div class="flex flex-col items-center justify-between gap-4 md:flex-row"><div class="text-muted-foreground text-sm"><p>&copy; 2025 Jaehun's Blog.
ëª¨ë“  ê¶Œë¦¬ ë³´ìœ .</p></div><div class="flex items-center gap-3"><a href=https://github.com/ryujaehun target=_blank rel="noopener noreferrer" class="text-muted-foreground hover:text-primary focus:ring-primary/20 rounded-lg p-1 transition-all duration-300 ease-out hover:scale-110 focus:ring-2 focus:outline-none" title=GitHub aria-label=GitHub><svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="GitHub"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"><path d="M15 22v-4a4.8 4.8.0 00-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35.0-3.5.0.0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35.0 3.5A5.4 5.4.0 004 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65S8.93 17.38 9 18v4"/><path d="M9 18c-4.51 2-5-2-7-2"/></g></svg>
</a><a href=https://www.linkedin.com/in/jaehunryu/ target=_blank rel="noopener noreferrer" class="text-muted-foreground hover:text-primary focus:ring-primary/20 rounded-lg p-1 transition-all duration-300 ease-out hover:scale-110 focus:ring-2 focus:outline-none" title=Linkedin aria-label=Linkedin><svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="Linkedin"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"><path d="M16 8a6 6 0 016 6v7h-4v-7a2 2 0 00-2-2 2 2 0 00-2 2v7h-4v-7a6 6 0 016-6M2 9h4v12H2z"/><circle cx="4" cy="4" r="2"/></g></svg>
</a><a href=mailto:jaehunryu@icloud.com class="text-muted-foreground hover:text-primary focus:ring-primary/20 rounded-lg p-1 transition-all duration-300 ease-out hover:scale-110 focus:ring-2 focus:outline-none" title=Email aria-label=Email><svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="Email"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22.0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5A2 2 0 003 7v10a2 2 0 002 2z"/></svg></a></div></div></div></footer><div id=dock class="pointer-events-none fixed bottom-4 left-1/2 z-[9999] w-fit -translate-x-1/2 translate-y-24 opacity-0 transition-all duration-300 ease-out sm:right-0 sm:left-0 sm:mx-auto sm:translate-x-0" role=toolbar aria-label="ë°”ë¡œê°€ê¸° ë„êµ¬ ëª¨ìŒ"><nav class="border-border bg-card/80 scrollbar-hide xs:px-3 xs:py-2 mx-auto flex max-w-[calc(100vw-2rem)] min-w-fit items-center justify-center overflow-x-auto rounded-2xl border px-4 py-3 shadow-lg backdrop-blur-sm sm:px-4 sm:py-3"><button id=dock-back class="text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 xs:px-2 xs:py-1.5 flex flex-shrink-0 items-center gap-2 rounded-lg px-3 py-2 text-sm font-medium transition-all duration-300 ease-out hover:-translate-y-0.5 hover:scale-105 focus:ring-2 focus:outline-none sm:px-3 sm:py-2" title=ë’¤ë¡œ aria-label=ë’¤ë¡œ>
<svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="m12 19-7-7 7-7"/><path d="M19 12H5"/></svg>
<span class="hidden sm:inline">ë’¤ë¡œ</span></button><div class="bg-border xs:mx-1 mx-2 h-6 w-px sm:mx-2"></div><button id=dock-toc class="text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 xs:px-2 xs:py-1.5 flex flex-shrink-0 items-center gap-2 rounded-lg px-3 py-2 text-sm font-medium transition-all duration-300 ease-out hover:-translate-y-0.5 hover:scale-105 focus:ring-2 focus:outline-none sm:px-3 sm:py-2" title=ëª©ì°¨ aria-label=ëª©ì°¨>
<svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><line x1="8" x2="21" y1="6" y2="6"/><line x1="8" x2="21" y1="12" y2="12"/><line x1="8" x2="21" y1="18" y2="18"/><line x1="3" x2="3.01" y1="6" y2="6"/><line x1="3" x2="3.01" y1="12" y2="12"/><line x1="3" x2="3.01" y1="18" y2="18"/></svg>
<span class="hidden sm:inline">ëª©ì°¨</span></button><div class="bg-border xs:mx-1 mx-2 h-6 w-px sm:mx-2"></div><button id=dock-search class="text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 xs:px-3 xs:py-1.5 flex flex-shrink-0 items-center gap-2 rounded-lg px-4 py-2 text-sm font-medium transition-all duration-300 ease-out hover:-translate-y-0.5 hover:scale-105 focus:ring-2 focus:outline-none sm:px-4 sm:py-2" title=ê²€ìƒ‰ aria-label=ê²€ìƒ‰>
<svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m21 21-6-6m2-5A7 7 0 113 10a7 7 0 0114 0z"/></svg>
<span class="hidden md:inline">ê²€ìƒ‰</span></button><div class="bg-border xs:mx-1 mx-2 h-6 w-px sm:mx-2"></div><button id=dock-top class="text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 xs:px-2 xs:py-1.5 flex flex-shrink-0 items-center gap-2 rounded-lg px-3 py-2 text-sm font-medium transition-all duration-300 ease-out hover:-translate-y-0.5 hover:scale-105 focus:ring-2 focus:outline-none sm:px-3 sm:py-2" title="ë§¨ ìœ„ë¡œ" aria-label="ë§¨ ìœ„ë¡œ">
<svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="m18 15-6-6-6 6"/></svg>
<span class="hidden sm:inline">ë§¨ ìœ„ë¡œ</span></button></nav></div><div id=toc-overlay class="pointer-events-none fixed inset-0 z-40 bg-black/50 opacity-0 backdrop-blur-sm transition-all duration-300" role=dialog aria-modal=true aria-labelledby=toc-title></div><div id=toc-card class="pointer-events-none fixed inset-4 z-50 flex w-auto scale-95 items-center justify-center opacity-0 transition-all duration-300 sm:inset-auto sm:top-1/2 sm:left-1/2 sm:block sm:w-full sm:max-w-md sm:-translate-x-1/2 sm:-translate-y-1/2" role=dialog aria-modal=true aria-labelledby=toc-title><div class="bg-card border-border w-full max-w-sm overflow-hidden rounded-xl border shadow-xl sm:max-w-md"><div class="border-border bg-muted/30 flex items-center justify-between border-b p-4"><div class="flex items-center gap-3"><svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><line x1="8" x2="21" y1="6" y2="6"/><line x1="8" x2="21" y1="12" y2="12"/><line x1="8" x2="21" y1="18" y2="18"/><line x1="3" x2="3.01" y1="6" y2="6"/><line x1="3" x2="3.01" y1="12" y2="12"/><line x1="3" x2="3.01" y1="18" y2="18"/></svg><h2 id=toc-title class="text-foreground text-lg font-semibold">ëª©ì°¨</h2></div><button id=toc-close class="text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 rounded-lg p-2 transition-all duration-200 ease-out hover:-translate-y-0.5 hover:scale-105 focus:ring-2 focus:outline-none" title=ë‹«ê¸° aria-label=ë‹«ê¸°>
<svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18 18 6M6 6l12 12"/></svg></button></div><div class="max-h-96 overflow-y-auto p-4"><nav id=toc-nav class=toc-scrollbar aria-label="ê¸€ ëª©ì°¨"><div id=toc-content><nav id=TableOfContents><ul><li><a href=#í•œ-ì¤„-ìš”ì•½-tldr>í•œ ì¤„ ìš”ì•½ (TL;DR)</a></li><li><a href=#í•µì‹¬-ì•„ì´ë””ì–´>í•µì‹¬ ì•„ì´ë””ì–´</a></li><li><a href=#ë°°ê²½-ê·¸ë“¤ì´-í•´ê²°í•œ-ë¬¸ì œ>ë°°ê²½: ê·¸ë“¤ì´ í•´ê²°í•œ ë¬¸ì œ</a></li><li><a href=#ìƒˆë¡œìš´-ì ‘ê·¼ë²•-fire-flyer-2--hfreduce>ìƒˆë¡œìš´ ì ‘ê·¼ë²•: <strong>Fire-Flyer 2 + HFReduce</strong></a></li><li><a href=#ì‘ë™-ì›ë¦¬-33-í”½ì…€-í† ì´-ì˜ˆì‹œ>ì‘ë™ ì›ë¦¬: 3Ã—3 í”½ì…€ í† ì´ ì˜ˆì‹œ</a></li><li><a href=#ì„±ëŠ¥-ê²€ì¦-ì£¼ìš”-ê²°ê³¼>ì„±ëŠ¥ ê²€ì¦: ì£¼ìš” ê²°ê³¼</a></li><li><a href=#ìš°ë¦¬ì˜-ê´€ì -ê°•ì -í•œê³„-ê·¸ë¦¬ê³ -ì´-ì—°êµ¬ê°€-ì¤‘ìš”í•œ-ì´ìœ >ìš°ë¦¬ì˜ ê´€ì : ê°•ì , í•œê³„, ê·¸ë¦¬ê³  ì´ ì—°êµ¬ê°€ ì¤‘ìš”í•œ ì´ìœ </a><ul><li><a href=#ê°•ì ->ê°•ì  ğŸŒŸ</a></li><li><a href=#í•œê³„->í•œê³„ âš ï¸</a></li><li><a href=#ì™œ-ì¤‘ìš”í•œê°€->ì™œ ì¤‘ìš”í•œê°€? ğŸš€</a></li></ul></li><li><a href=#ë‹¤ìŒ-ë‹¨ê³„ëŠ”>ë‹¤ìŒ ë‹¨ê³„ëŠ”?</a><ul><li><a href=#í† ê¸€ì„-í´ë¦­í•˜ë©´-ë…¼ë¬¸ì—-ëŒ€í•œ-ìì„¸í•œ-llm-ì§ˆì˜ì‘ë‹µ-ë‚´ìš©ì„-í™•ì¸í• -ìˆ˜-ìˆìŠµë‹ˆë‹¤>í† ê¸€ì„ í´ë¦­í•˜ë©´ ë…¼ë¬¸ì— ëŒ€í•œ ìì„¸í•œ LLM ì§ˆì˜ì‘ë‹µ ë‚´ìš©ì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</a></li></ul></li></ul><ul><li><a href=#1-í•µì‹¬-ì—°êµ¬-ê³µë°±-ë°-ë¯¸í•´ê²°-ì§ˆë¬¸>1. í•µì‹¬ ì—°êµ¬ ê³µë°± ë° ë¯¸í•´ê²° ì§ˆë¬¸</a></li><li><a href=#2-ë…¼ë¬¸-ë°œí‘œ-ì‹œì ì˜-ìµœì‹ -ê¸°ìˆ sota-ìš”ì•½>2. ë…¼ë¬¸ ë°œí‘œ ì‹œì ì˜ â€˜ìµœì‹  ê¸°ìˆ (SOTA)â€™ ìš”ì•½</a></li><li><a href=#3-fire-flyer-2ê°€-ë©”ìš´-ê³µë°±ì˜-ì˜ì˜-ìˆ«ìë¡œ-ë³´ëŠ”-ì¸ì‚¬ì´íŠ¸>3. Fire-Flyer 2ê°€ ë©”ìš´ ê³µë°±ì˜ ì˜ì˜ (ìˆ«ìë¡œ ë³´ëŠ” ì¸ì‚¬ì´íŠ¸)</a></li><li><a href=#4-ì™œ-ì´-ê³µë°±ì´-ì¤‘ìš”í–ˆë‚˜>4. ì™œ ì´ ê³µë°±ì´ ì¤‘ìš”í–ˆë‚˜?</a></li><li><a href=#5-ì •ë¦¬>5. ì •ë¦¬</a></li></ul><ul><li><a href=#ë…¼ë¬¸ì˜-1-3ìœ„-í•µì‹¬-ê¸°ì—¬>ë…¼ë¬¸ì˜ 1-3ìœ„ í•µì‹¬ ê¸°ì—¬</a></li></ul><ul><li><a href=#ì €ì-ê´€ì ì˜-ìš°ì›”ì„±-top-3>ì €ì ê´€ì ì˜ â€˜ìš°ì›”ì„±â€™ Top-3</a><ul><li><a href=#1-ë¹„ìš©ì „ë ¥-ì ˆê°ì˜-ë…¼ë¦¬>1. ë¹„ìš©Â·ì „ë ¥ ì ˆê°ì˜ ë…¼ë¦¬</a></li><li><a href=#2-í†µì‹ -ìŠ¤íƒ-ìš°ìœ„>2. í†µì‹  ìŠ¤íƒ ìš°ìœ„</a></li><li><a href=#3-ìŠ¤ì¼€ì¼ë§ìš´ì˜-ì•ˆì •ì„±>3. ìŠ¤ì¼€ì¼ë§Â·ìš´ì˜ ì•ˆì •ì„±</a></li></ul></li><li><a href=#í•œëˆˆì—-ë³´ëŠ”-ë¹„êµ-í‘œ>í•œëˆˆì— ë³´ëŠ” ë¹„êµ í‘œ</a><ul><li><a href=#ì •ë¦¬>ì •ë¦¬</a></li></ul></li></ul><ul><li><a href=#1-ìš©ì–´ë³€ìˆ˜-ì •ì˜>1. ìš©ì–´Â·ë³€ìˆ˜ ì •ì˜</a></li><li><a href=#2-hfreduce-4-ë‹¨ê³„-íŒŒì´í”„ë¼ì¸>2. HFReduce 4-ë‹¨ê³„ íŒŒì´í”„ë¼ì¸</a></li><li><a href=#3-toy-example--2-ë…¸ë“œ4-gpu3--3-í”½ì…€-ê·¸ë˜ë””ì–¸íŠ¸>3. <strong>Toy Example : 2 ë…¸ë“œÂ·4 GPUÂ·3 Ã— 3 í”½ì…€ ê·¸ë˜ë””ì–¸íŠ¸</strong></a><ul><li><a href=#31-ì´ˆê¸°-ìƒíƒœ>3.1 ì´ˆê¸° ìƒíƒœ</a></li><li><a href=#32-ë‹¨ê³„ë³„-íë¦„>3.2 ë‹¨ê³„ë³„ íë¦„</a></li></ul></li><li><a href=#4-double-binary-tree-all-reduce-ì‹œí€€ìŠ¤-2-ë…¸ë“œ-ì˜ˆ>4. Double-Binary-Tree All-Reduce ì‹œí€€ìŠ¤ (2 ë…¸ë“œ ì˜ˆ)</a></li><li><a href=#5-ì„±ëŠ¥-ìˆ«ìë¡œ-ë³´ëŠ”-íš¨ê³¼>5. ì„±ëŠ¥ ìˆ«ìë¡œ ë³´ëŠ” íš¨ê³¼</a></li><li><a href=#6-ì™œ-ì˜-ë˜ë‚˜--í•µì‹¬-ìµœì í™”-3-ê°€ì§€>6. ì™œ ì˜ ë˜ë‚˜? â€” í•µì‹¬ ìµœì í™” 3 ê°€ì§€</a></li><li><a href=#7-í•œëˆˆì—-ë³´ëŠ”-hfreduce-íŒŒì´í”„ë¼ì¸-vs-nccl-ìš”ì•½>7. í•œëˆˆì— ë³´ëŠ” HFReduce íŒŒì´í”„ë¼ì¸ vs NCCL (ìš”ì•½)</a></li></ul><ul><li><a href=#1-ë¬´ì—‡ì„-í•˜ëŠ”ê°€-ê¸°ëŠ¥>1. ë¬´ì—‡ì„ í•˜ëŠ”ê°€? (ê¸°ëŠ¥)</a></li><li><a href=#2-ì™œ-í•„ìˆ˜ì ì¸ê°€>2. ì™œ í•„ìˆ˜ì ì¸ê°€?</a></li></ul><ul><li><a href=#1-ì‹¤í—˜ì—ì„œ-ì‚¬ìš©í•œ-í•µì‹¬-ì„±ëŠ¥-ì§€í‘œ>1. ì‹¤í—˜ì—ì„œ ì‚¬ìš©í•œ í•µì‹¬ ì„±ëŠ¥ ì§€í‘œ</a></li><li><a href=#2-ì‚¬ìš©ëœ-ëª¨ë¸ë²¤ì¹˜ë§ˆí¬>2. ì‚¬ìš©ëœ ëª¨ë¸Â·ë²¤ì¹˜ë§ˆí¬</a></li><li><a href=#3-ì£¼ìš”-í‘œê·¸ë¦¼ë³„-ê²°ê³¼>3. ì£¼ìš” í‘œÂ·ê·¸ë¦¼ë³„ ê²°ê³¼</a><ul><li><a href=#3-1-í†µì‹ -ì„±ëŠ¥-figure-7>3-1. í†µì‹  ì„±ëŠ¥ (Figure 7)</a></li><li><a href=#3-2-ì•½í•œ-ìŠ¤ì¼€ì¼ë§-figure-8>3-2. ì•½í•œ ìŠ¤ì¼€ì¼ë§ (Figure 8)</a></li><li><a href=#3-3-ê°•í•œ-ìŠ¤ì¼€ì¼ë§-figure-9>3-3. ê°•í•œ ìŠ¤ì¼€ì¼ë§ (Figure 9)</a></li><li><a href=#3-4-ë¹„ìš©ì „ë ¥ì¸í”„ë¼-table-ii-iii>3-4. ë¹„ìš©Â·ì „ë ¥Â·ì¸í”„ë¼ (Table II, III)</a></li></ul></li><li><a href=#4-ì €ìë“¤ì´-ê°•ì¡°í•œ-ì„±ê³µ-ì¦ê±°>4. ì €ìë“¤ì´ ê°•ì¡°í•œ â€˜ì„±ê³µ ì¦ê±°â€™</a></li></ul><ul><li><a href=#1-ìˆ«ìë¡œ-ë³´ëŠ”-sotaëŒ€fire-flyer-2-ë¹„êµ>1. ìˆ«ìë¡œ ë³´ëŠ” SOTAâ€†ëŒ€â€†Fire-Flyer 2 ë¹„êµ</a></li><li><a href=#2-ìš°ì›”ì„±ì„-ê°€ì¥-ì˜-ë³´ì—¬ì£¼ëŠ”-í‚¬ëŸ¬-ìˆ«ì>2. ìš°ì›”ì„±ì„ ê°€ì¥ ì˜ ë³´ì—¬ì£¼ëŠ” â€˜í‚¬ëŸ¬ ìˆ«ìâ€™</a></li><li><a href=#3-ì„±ëŠ¥ì´-ë¯¸í¡í•˜ê±°ë‚˜-ê°œì„ -í­ì´-ì‘ì•˜ë˜-ì§€ì >3. ì„±ëŠ¥ì´ ë¯¸í¡í•˜ê±°ë‚˜ ê°œì„  í­ì´ ì‘ì•˜ë˜ ì§€ì </a></li><li><a href=#4-ì •ë¦¬>4. ì •ë¦¬</a></li></ul><ul><li><a href=#1-ë…¼ë¬¸ì´-ì§ì ‘-ì¸ì •í•œ-í•œê³„ì•½ì >1. ë…¼ë¬¸ì´ <strong>ì§ì ‘</strong> ì¸ì •í•œ í•œê³„Â·ì•½ì </a></li><li><a href=#2-ì ì¬ì -í•œê³„-ë…¼ë¬¸ì—-ëª…ì‹œë˜ì§€-ì•Šì€-ë¶€ë¶„>2. <strong>ì ì¬ì </strong> í•œê³„ (ë…¼ë¬¸ì— ëª…ì‹œë˜ì§€ ì•Šì€ ë¶€ë¶„)</a><ul><li><a href=#3-í•µì‹¬-ì‹œì‚¬ì >3. í•µì‹¬ ì‹œì‚¬ì </a></li></ul></li></ul><ul><li><a href=#1-ì €ìë“¤ì´-ì œì‹œí•œ-êµ¬ì²´ì -í–¥í›„-ì—°êµ¬-ê³¼ì œ>1. ì €ìë“¤ì´ ì œì‹œí•œ êµ¬ì²´ì  í–¥í›„ ì—°êµ¬ ê³¼ì œ</a></li><li><a href=#2-ë³¸-ë¶„ì„ì´-ì œì•ˆí•˜ëŠ”-ì¶”ê°€-ì—°êµ¬-ê¶¤ì >2. ë³¸ ë¶„ì„ì´ ì œì•ˆí•˜ëŠ” ì¶”ê°€ ì—°êµ¬ ê¶¤ì </a></li><li><a href=#3-ì •ë¦¬>3. ì •ë¦¬</a></li></ul><ul><li><ul><li><a href=#í•œ-ì¤„-í•µì‹¬-ìš”ì•½>í•œ ì¤„ í•µì‹¬ ìš”ì•½</a></li></ul></li><li><a href=#1-í•µì‹¬-ì†Œí”„íŠ¸ì›¨ì–´ë¼ì´ë¸ŒëŸ¬ë¦¬-ì˜ì¡´ì„±>1. í•µì‹¬ ì†Œí”„íŠ¸ì›¨ì–´/ë¼ì´ë¸ŒëŸ¬ë¦¬ ì˜ì¡´ì„±</a></li><li><a href=#2-ë©”ëª¨ë¦¬ì—°ì‚°-ìì›-ìš”êµ¬>2. ë©”ëª¨ë¦¬Â·ì—°ì‚° ìì› ìš”êµ¬</a></li><li><a href=#3-ì²˜ë¦¬ëŸ‰throughput-ì¸¡ì •ì¹˜>3. ì²˜ë¦¬ëŸ‰(Throughput) ì¸¡ì •ì¹˜</a><ul><li><a href=#3-1-í†µì‹ all-reduce>3-1. í†µì‹ /All-Reduce</a></li><li><a href=#3-2-ëª¨ë¸-í•™ìŠµ-ê°•í•œ-ìŠ¤ì¼€ì¼ë§>3-2. ëª¨ë¸ í•™ìŠµ ê°•í•œ ìŠ¤ì¼€ì¼ë§</a></li><li><a href=#3-3-llm-ì¶”ë¡ -hydragen-8--a100-40-gb>3-3. LLM ì¶”ë¡  (Hydragen, 8 Ã— A100 40 GB)</a></li></ul></li><li><a href=#4-ì´-ì—°ì‚°-ë¹„ìš©-flops--petaflop-days>4. ì´ ì—°ì‚° ë¹„ìš© (FLOPs & Petaflop-days)</a></li><li><a href=#5-ì •ë¦¬-1>5. ì •ë¦¬</a></li></ul><ul><li><a href=#1-ë…¼ë¬¸ì—ì„œ-ì‚¬ìš©í•œ-í•µì‹¬-í‰ê°€ì§€í‘œ>1. ë…¼ë¬¸ì—ì„œ ì‚¬ìš©í•œ í•µì‹¬ í‰ê°€ì§€í‘œ</a></li><li><a href=#2-ìŠ¤ì¼€ì¼-í™•ì¥ì„±-ë¶„ì„>2. ìŠ¤ì¼€ì¼ í™•ì¥ì„± ë¶„ì„</a></li><li><a href=#3-ë©”íŠ¸ë¦­ë³„-ì˜ì˜>3. ë©”íŠ¸ë¦­ë³„ ì˜ì˜</a></li><li><a href=#4-ì¢…í•©>4. ì¢…í•©</a></li></ul></nav></div></nav></div><div class="border-border bg-muted/20 border-t px-4 py-3"><div class="text-muted-foreground text-center text-xs"><span>ì œëª©ì„ í´ë¦­í•˜ë©´ í•´ë‹¹ ìœ„ì¹˜ë¡œ ì´ë™í•©ë‹ˆë‹¤</span></div></div></div></div><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.css integrity=sha384-5TcZemv2l/9On385z///+d7MSYlvIEw9FuZTIdZ14vJLqWphw7e7ZPuOiCHJcFCP crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.js integrity=sha384-cMkvdD8LoxVzGF/RPUKAcvmm49FQ0oxwDF3BGKtDXcEc+T1b2N+teh/OJfpU0jr6 crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/contrib/auto-render.min.js integrity=sha384-hCXGrW6PitJEwbkoStFjeJxv+fSOOQKOPbJxSfM6G5sWZjAyWhXiTIIAmQqnlLlh crossorigin=anonymous></script><script>function initKaTeX(){if(typeof renderMathInElement=="undefined"){setTimeout(initKaTeX,100);return}var e=[{display:!0,left:"$$",right:"$$"},{display:!1,left:"$",right:"$"}];renderMathInElement(document.body,{delimiters:e,throwOnError:!1,errorColor:"#cc0000",fleqn:!1,leqno:!1,trust:!1})}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",initKaTeX):initKaTeX()</script><div id=search-overlay class="pointer-events-none fixed inset-0 z-40 bg-black/50 opacity-0 transition-opacity duration-300"></div><div id=search-modal class="bg-card border-border pointer-events-none fixed top-1/2 left-1/2 z-50 max-h-[80vh] w-full max-w-2xl -translate-x-1/2 -translate-y-1/2 scale-95 transform overflow-hidden rounded-xl border opacity-0 shadow-xl transition-all duration-300"><div class="border-border flex items-center gap-3 border-b p-4"><div class="text-muted-foreground h-5 w-5 flex-shrink-0"><svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m21 21-6-6m2-5A7 7 0 113 10a7 7 0 0114 0z"/></svg></div><div class="relative flex-1"><button id=search-clear class="text-muted-foreground hover:text-foreground hover:bg-muted/50 pointer-events-none absolute top-1/2 left-0 z-10 h-5 w-5 -translate-y-1/2 rounded opacity-0 transition-all duration-200" title=ì§€ìš°ê¸° aria-label=ì§€ìš°ê¸°>
<svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18 18 6M6 6l12 12"/></svg>
</button>
<input id=search-input type=text placeholder="ê²Œì‹œê¸€ ê²€ìƒ‰..." class="text-foreground placeholder:text-muted-foreground w-full border-none bg-transparent pl-8 text-lg outline-none" autocomplete=off spellcheck=false></div><button id=search-close class="text-muted-foreground hover:text-foreground hover:bg-muted/50 flex h-6 w-6 items-center justify-center rounded-md p-0.5 transition-all duration-200" title=ë‹«ê¸° aria-label=ë‹«ê¸°>
<svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18 18 6M6 6l12 12"/></svg></button></div><div id=search-results class="max-h-96 overflow-y-auto"><div id=search-empty class="flex flex-col items-center justify-center py-12 text-center"><div class="bg-muted/50 mb-4 flex h-16 w-16 items-center justify-center rounded-full"><svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m21 21-6-6m2-5A7 7 0 113 10a7 7 0 0114 0z"/></svg></div><h3 class="text-foreground mb-2 text-lg font-semibold">ê²€ìƒ‰ ì‹œì‘</h3><p class="text-muted-foreground text-sm">ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•˜ì„¸ìš”</p></div><div id=search-loading class="flex hidden items-center justify-center py-8"><div class="mr-3 h-6 w-6 animate-spin rounded-full border-2 border-current border-t-transparent"></div><span class=text-muted-foreground>ê²€ìƒ‰ ì¤‘...</span></div><div id=search-no-results class="flex hidden flex-col items-center justify-center py-12 text-center"><div class="bg-muted/50 mb-4 flex h-16 w-16 items-center justify-center rounded-full"><svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h7"/></svg></div><h3 class="text-foreground mb-2 text-lg font-semibold">ê²€ìƒ‰ ê²°ê³¼ ì—†ìŒ</h3><p class="text-muted-foreground text-sm">ë‹¤ë¥¸ ê²€ìƒ‰ì–´ë¡œ ì‹œë„í•´ë³´ì„¸ìš”</p></div><div id=search-results-list class=hidden><div id=search-stats class="text-muted-foreground border-border border-b px-4 py-3 text-sm" data-template="%dê°œì˜ ê²°ê³¼ ì°¾ìŒ"></div><div id=search-items class="divide-border divide-y"></div></div></div><div class="border-border bg-muted/20 border-t px-4 py-3"><div class="text-muted-foreground flex items-center justify-between text-xs"><div class="flex items-center gap-2 md:gap-4"><div class="flex items-center gap-1"><kbd class="bg-muted border-border rounded border px-1.5 py-0.5 text-xs">â†‘â†“</kbd>
<span class="hidden sm:inline">ì´ë™</span></div><div class="flex items-center gap-1"><kbd class="bg-muted border-border rounded border px-1.5 py-0.5 text-xs">â†µ</kbd>
<span class="hidden sm:inline">ì„ íƒ</span></div><div class="flex items-center gap-1"><kbd class="bg-muted border-border rounded border px-1.5 py-0.5 text-xs">ESC</kbd>
<span class="hidden sm:inline">ë‹«ê¸°</span></div></div><div class="search-hint-desktop flex items-center gap-1"><kbd class="bg-muted border-border rounded border px-1.5 py-0.5 text-xs">âŒ˜K</kbd>
<span>ë‹¨ì¶•í‚¤</span></div></div></div></div></body></html>