<!doctype html><html lang=ko-kr data-theme=claude><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta http-equiv=X-UA-Compatible content="IE=edge"><title>Comet: Fine-grained Computation-communication Overlapping for Mixture-of-Experts | Jaehun's Blog</title><meta name=description content="ë…¼ë¬¸ ë§í¬
Q : ì´ ë…¼ë¬¸ì„ ì•„ì£¼ ìì„¸í•˜ê²Œ ì½ê³  ë…¼ë¬¸ì˜ ê°•ì ê³¼ ë…ì°½ì ì¸ ì§€ì ì„ ì„¤ëª…í•´ì£¼ê³  í•µì‹¬ ì•Œê³ ë¦¬ì¦˜ì„ ì˜ˆì‹œ ì…ë ¥ì„ ë“¤ì–´ì„œ ì „ì²´ì ì¸ ê³¼ì •ì„ ì„¤ëª…í•´ì¤˜ ì¶”ê°€ì ìœ¼ë¡œ ë…¼ë¬¸ì˜ í•œê³„ì ì— ëŒ€í•´ì„œë„ ì•Œë ¤ì¤˜ ë…¼ë¬¸ **&ldquo;Comet: Fine-grained..."><meta name=keywords content="ê°œë°œ,í”„ë¡œê·¸ë˜ë°,ì—ì„¸ì´"><meta name=author content><meta name=language content="ko"><meta name=robots content="index, follow"><link rel=canonical href=https://jaehun.me/ko/ko/posts/2025-04-14-paper-2502.19811v3/><link rel=icon type=image/svg+xml href=/favicon.svg><link rel=manifest href=/site.webmanifest><meta property="og:url" content="https://jaehun.me/ko/ko/posts/2025-04-14-paper-2502.19811v3/"><meta property="og:site_name" content="Jaehun's Blog"><meta property="og:title" content="Comet: Fine-grained Computation-communication Overlapping for Mixture-of-Experts"><meta property="og:description" content="ë…¼ë¬¸ ë§í¬
Q : ì´ ë…¼ë¬¸ì„ ì•„ì£¼ ìì„¸í•˜ê²Œ ì½ê³  ë…¼ë¬¸ì˜ ê°•ì ê³¼ ë…ì°½ì ì¸ ì§€ì ì„ ì„¤ëª…í•´ì£¼ê³  í•µì‹¬ ì•Œê³ ë¦¬ì¦˜ì„ ì˜ˆì‹œ ì…ë ¥ì„ ë“¤ì–´ì„œ ì „ì²´ì ì¸ ê³¼ì •ì„ ì„¤ëª…í•´ì¤˜ ì¶”ê°€ì ìœ¼ë¡œ ë…¼ë¬¸ì˜ í•œê³„ì ì— ëŒ€í•´ì„œë„ ì•Œë ¤ì¤˜ ë…¼ë¬¸ **â€œComet: Fine-grained Computation-communication Overlapping for Mixture-of-Expertsâ€**ëŠ” MoE ëª¨ë¸ì˜ í•µì‹¬ ë³‘ëª©ì¸ GPU ê°„ í†µì‹  ì§€ì—°ì„ fine-grained ìˆ˜ì¤€ì—ì„œ ì»´í“¨íŒ…ê³¼ í†µì‹ ì„ ì •êµí•˜ê²Œ ê²¹ì¹˜ë„ë¡ ì„¤ê³„í•¨ìœ¼ë¡œì¨ ì‹¤í–‰ ì„±ëŠ¥ì„ í¬ê²Œ ê°œì„ í•œ ByteDanceì˜ ì‹œìŠ¤í…œ ìµœì í™” ë…¼ë¬¸ì…ë‹ˆë‹¤."><meta property="og:locale" content="ko_kr"><meta property="og:type" content="article"><meta property="article:section" content="ko"><meta property="article:published_time" content="2025-04-14T00:00:00+00:00"><meta property="article:modified_time" content="2025-04-14T00:00:00+00:00"><meta property="og:image" content="https://jaehun.me/images/og-default.avif"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://jaehun.me/images/og-default.avif"><meta name=twitter:title content="Comet: Fine-grained Computation-communication Overlapping for Mixture-of-Experts"><meta name=twitter:description content="ë…¼ë¬¸ ë§í¬
Q : ì´ ë…¼ë¬¸ì„ ì•„ì£¼ ìì„¸í•˜ê²Œ ì½ê³  ë…¼ë¬¸ì˜ ê°•ì ê³¼ ë…ì°½ì ì¸ ì§€ì ì„ ì„¤ëª…í•´ì£¼ê³  í•µì‹¬ ì•Œê³ ë¦¬ì¦˜ì„ ì˜ˆì‹œ ì…ë ¥ì„ ë“¤ì–´ì„œ ì „ì²´ì ì¸ ê³¼ì •ì„ ì„¤ëª…í•´ì¤˜ ì¶”ê°€ì ìœ¼ë¡œ ë…¼ë¬¸ì˜ í•œê³„ì ì— ëŒ€í•´ì„œë„ ì•Œë ¤ì¤˜ ë…¼ë¬¸ **â€œComet: Fine-grained Computation-communication Overlapping for Mixture-of-Expertsâ€**ëŠ” MoE ëª¨ë¸ì˜ í•µì‹¬ ë³‘ëª©ì¸ GPU ê°„ í†µì‹  ì§€ì—°ì„ fine-grained ìˆ˜ì¤€ì—ì„œ ì»´í“¨íŒ…ê³¼ í†µì‹ ì„ ì •êµí•˜ê²Œ ê²¹ì¹˜ë„ë¡ ì„¤ê³„í•¨ìœ¼ë¡œì¨ ì‹¤í–‰ ì„±ëŠ¥ì„ í¬ê²Œ ê°œì„ í•œ ByteDanceì˜ ì‹œìŠ¤í…œ ìµœì í™” ë…¼ë¬¸ì…ë‹ˆë‹¤."><meta itemprop=name content="Comet: Fine-grained Computation-communication Overlapping for Mixture-of-Experts"><meta itemprop=description content="ë…¼ë¬¸ ë§í¬
Q : ì´ ë…¼ë¬¸ì„ ì•„ì£¼ ìì„¸í•˜ê²Œ ì½ê³  ë…¼ë¬¸ì˜ ê°•ì ê³¼ ë…ì°½ì ì¸ ì§€ì ì„ ì„¤ëª…í•´ì£¼ê³  í•µì‹¬ ì•Œê³ ë¦¬ì¦˜ì„ ì˜ˆì‹œ ì…ë ¥ì„ ë“¤ì–´ì„œ ì „ì²´ì ì¸ ê³¼ì •ì„ ì„¤ëª…í•´ì¤˜ ì¶”ê°€ì ìœ¼ë¡œ ë…¼ë¬¸ì˜ í•œê³„ì ì— ëŒ€í•´ì„œë„ ì•Œë ¤ì¤˜ ë…¼ë¬¸ **â€œComet: Fine-grained Computation-communication Overlapping for Mixture-of-Expertsâ€**ëŠ” MoE ëª¨ë¸ì˜ í•µì‹¬ ë³‘ëª©ì¸ GPU ê°„ í†µì‹  ì§€ì—°ì„ fine-grained ìˆ˜ì¤€ì—ì„œ ì»´í“¨íŒ…ê³¼ í†µì‹ ì„ ì •êµí•˜ê²Œ ê²¹ì¹˜ë„ë¡ ì„¤ê³„í•¨ìœ¼ë¡œì¨ ì‹¤í–‰ ì„±ëŠ¥ì„ í¬ê²Œ ê°œì„ í•œ ByteDanceì˜ ì‹œìŠ¤í…œ ìµœì í™” ë…¼ë¬¸ì…ë‹ˆë‹¤."><meta itemprop=datePublished content="2025-04-14T00:00:00+00:00"><meta itemprop=dateModified content="2025-04-14T00:00:00+00:00"><meta itemprop=wordCount content="11126"><meta itemprop=image content="https://jaehun.me/images/og-default.avif"><meta itemprop=keywords content="Paper-Review,With-Gpt"><script>window.HUGO_SEARCH_CONFIG={searchIndexURL:'"/ko/index.json"'}</script><script>window.HUGO_GALLERY_CONFIG={justified_gallery:!1,lightbox:!1,justified:"{}",lightbox_options:"{}"}</script><link rel=stylesheet href=/css/compiled.min.9165cace5b80a5be5daad6ea96eb2abc20a18a3f41d7fed7f0335b689fdf7883.css integrity="sha256-kWXKzluApb5dqtbqlusqvCChij9B1/7X8DNbaJ/feIM=" crossorigin=anonymous><link rel=stylesheet href=/css/chroma.min.491df36221f739b5948a747a0351f100ee7ccaaf466d9f46288bf06de1d59123.css integrity="sha256-SR3zYiH3ObWUinR6A1HxAO58yq9GbZ9GKIvwbeHVkSM=" crossorigin=anonymous><script src=/js/main.ba969e49a7a874e6938fe689a7dcaa00cb64cb4d429c2cf98d09bde512a16c6d.js integrity="sha256-upaeSaeodOaTj+aJp9yqAMtky01CnCz5jQm95RKhbG0=" crossorigin=anonymous></script><script src=/js/gumshoe.polyfills.min.js></script><script src=/js/toc.70654aebf0b738a78ae2df95297cc10ebc6e590f3c942dd1325fa852f50038b2.js integrity="sha256-cGVK6/C3OKeK4t+VKXzBDrxuWQ88lC3RMl+oUvUAOLI=" crossorigin=anonymous defer></script><script src=/js/search.de3eba3540834efb8328121784bff4774e06362412ee41eee665f5b4f987f393.js integrity="sha256-3j66NUCDTvuDKBIXhL/0d04GNiQS7kHu5mX1tPmH85M=" crossorigin=anonymous defer></script><script src=/js/dock.e02f422517e001d9fb6bea1e9e8b0e89e9d2e486ad4641f275bb3e36ce2ae79f.js integrity="sha256-4C9CJRfgAdn7a+oenosOienS5IatRkHydbs+Ns4q558=" crossorigin=anonymous defer></script><script>(function(){const e=localStorage.getItem("theme")||"system",n=localStorage.getItem("colorScheme")||"claude";document.documentElement.setAttribute("data-theme",n);function t(){e==="dark"||e==="system"&&window.matchMedia("(prefers-color-scheme: dark)").matches?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")}t(),e==="system"&&window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",t)})()</script></head><body class="bg-background text-foreground min-h-screen antialiased"><div id=reading-progress-container class="reading-progress-container pointer-events-none fixed top-0 right-0 left-0 z-50 transition-opacity duration-300 ease-out" data-height=3 data-smooth-scroll=true data-hide-on-complete=false><div class="reading-progress-bg w-full"></div><div id=reading-progress-bar class="from-primary to-primary/80 reading-progress-bar
transition-all duration-150 ease-out
absolute top-0 left-0 w-0 bg-gradient-to-r"></div></div><script>(function(){"use strict";const t=document.getElementById("reading-progress-container"),o=document.getElementById("reading-progress-bar");if(!t||!o)return;const a={smoothScroll:t.dataset.smoothScroll==="true",hideOnComplete:t.dataset.hideOnComplete==="true"};let n=!0,l=null;function r(){const t=window.pageYOffset||document.documentElement.scrollTop,n=document.documentElement.scrollHeight,s=window.innerHeight,e=n-s;return e<=0?0:Math.min(Math.max(t/e*100,0),100)}function c(){const e=r();o.style.width=e+"%",a.hideOnComplete&&e>=99.5?n&&(t.style.opacity="0",n=!1):n||(t.style.opacity="1",n=!0)}let s=!1;function e(){s||(requestAnimationFrame(()=>{c(),s=!1}),s=!0)}function i(){window.addEventListener("scroll",e,{passive:!0}),window.addEventListener("resize",e,{passive:!0}),document.addEventListener("visibilitychange",()=>{document.hidden||e()}),e(),window.addEventListener("beforeunload",()=>{window.removeEventListener("scroll",e),window.removeEventListener("resize",e)})}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",i):i()})()</script><header class="sticky top-0 z-50 mx-auto max-w-4xl px-4 py-6"><div class="border-border bg-card/80 flex items-center rounded-xl border px-6 py-4 shadow-sm backdrop-blur-sm"><div class="hidden w-full items-center md:flex"><div class="flex items-center"><a href=/ko/ class="flex h-10 w-10 items-center justify-center overflow-hidden rounded-full transition-transform duration-200 hover:scale-105" aria-label="Jaehun's Blog"><img src=/images/logo.svg alt="Jaehun's Blog" class="h-full w-full object-cover"></a></div><nav class="mx-8 flex flex-1 items-center justify-center"><div class="flex items-center space-x-1"><a href=/ko/ class="nav-link
text-muted-foreground hover:text-primary hover:bg-primary/10
focus:ring-primary/20 relative flex items-center gap-2 rounded-lg px-4 py-2 text-sm font-medium transition-all duration-300 ease-out hover:-translate-y-0.5 hover:scale-105 focus:ring-2 focus:outline-none"><svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="nav.posts"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 20H5a2 2 0 01-2-2V6a2 2 0 012-2h10a2 2 0 012 2v1m2 13a2 2 0 01-2-2V7m2 13a2 2 0 002-2V9a2 2 0 00-2-2h-2m-4-3H9M7 16h6M7 8h6v4H7V8z"/></svg>
<span>ê²Œì‹œê¸€
</span></a><a href=/ko/categories/ class="nav-link
text-muted-foreground hover:text-primary hover:bg-primary/10
focus:ring-primary/20 relative flex items-center gap-2 rounded-lg px-4 py-2 text-sm font-medium transition-all duration-300 ease-out hover:-translate-y-0.5 hover:scale-105 focus:ring-2 focus:outline-none"><svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="nav.categories"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"/></svg>
<span>ì¹´í…Œê³ ë¦¬
</span></a><a href=/ko/tags/ class="nav-link
text-muted-foreground hover:text-primary hover:bg-primary/10
focus:ring-primary/20 relative flex items-center gap-2 rounded-lg px-4 py-2 text-sm font-medium transition-all duration-300 ease-out hover:-translate-y-0.5 hover:scale-105 focus:ring-2 focus:outline-none"><svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="nav.tags"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 7h.01M7 3h5c.512.0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828.0l-7-7A1.994 1.994.0 013 12V7a4 4 0 014-4z"/></svg>
<span>íƒœê·¸
</span></a><a href=/ko/ class="nav-link
text-muted-foreground hover:text-primary hover:bg-primary/10
focus:ring-primary/20 relative flex items-center gap-2 rounded-lg px-4 py-2 text-sm font-medium transition-all duration-300 ease-out hover:-translate-y-0.5 hover:scale-105 focus:ring-2 focus:outline-none"><svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="nav.archives"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 8h14M5 8a2 2 0 110-4h14a2 2 0 110 4M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8m-9 4h4"/></svg>
<span>ì•„ì¹´ì´ë¸Œ</span></a></div></nav><div class="flex items-center space-x-2"><div class=relative><button id=language-toggle class="dropdown-toggle border-border bg-background text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex h-10 w-10 items-center justify-center rounded-lg border transition-all duration-300 ease-out hover:scale-105 focus:ring-2 focus:outline-none active:scale-95" data-dropdown-type=language aria-label="ì–¸ì–´ ë³€ê²½" aria-expanded=false aria-haspopup=true>
<svg class="h-5 w-5 relative z-10" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="ì–¸ì–´ ë³€ê²½"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m5 8 6 6m-7 0 6-6 2-3M2 5h12M7 2h1m14 20-5-10-5 10m2-4h6"/></svg></button><div id=language-dropdown class="dropdown-menu border-border bg-popover/95 absolute top-12 right-0 z-[60] hidden w-40 rounded-lg border p-1 shadow-lg backdrop-blur-sm transition-all duration-200 ease-out" data-dropdown-type=language role=menu aria-labelledby=language-toggle><a href=/ko/ class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none" role=menuitem aria-current=true><span class=font-medium>í•œêµ­ì–´</span></a><a href=/en/ class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none" role=menuitem><span class=font-medium>English</span></a></div></div><div class=relative><button id=color-scheme-toggle class="dropdown-toggle border-border bg-background text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex h-10 w-10 items-center justify-center rounded-lg border transition-all duration-300 ease-out hover:scale-105 focus:ring-2 focus:outline-none active:scale-95" data-dropdown-type=color-scheme aria-label="í…Œë§ˆ ë³€ê²½" aria-expanded=false aria-haspopup=true>
<svg class="h-5 w-5 relative z-10" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="í…Œë§ˆ ë³€ê²½"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zM21 5a2 2 0 00-2-2h-4a2 2 0 00-2 2v6a2 2 0 002 2h4a2 2 0 002-2V5z"/></svg></button><div id=color-scheme-dropdown class="dropdown-menu border-border bg-popover/95 absolute top-12 right-0 z-[60] hidden w-44 rounded-lg border p-1 shadow-lg backdrop-blur-sm transition-all duration-200 ease-out" data-dropdown-type=color-scheme><button data-color-scheme=claude class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Default</span></button><button data-color-scheme=default class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>White</span></button><button data-color-scheme=bumblebee class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Bumblebee</span></button><button data-color-scheme=emerald class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Emerald</span></button><button data-color-scheme=nord class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Nord</span></button><button data-color-scheme=sunset class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Sunset</span></button><button data-color-scheme=abyss class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Abyss</span></button><button data-color-scheme=dracula class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Dracula</span></button><button data-color-scheme=amethyst class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Amethyst</span></button><button data-color-scheme=slate class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Slate</span></button><button data-color-scheme=twitter class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Twitter</span></button></div></div><div class=relative><button id=theme-toggle class="dropdown-toggle border-border bg-background text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex h-10 w-10 items-center justify-center rounded-lg border transition-all duration-300 ease-out hover:scale-105 focus:ring-2 focus:outline-none active:scale-95" data-dropdown-type=theme aria-label="í…Œë§ˆ ë³€ê²½" aria-expanded=false aria-haspopup=true>
<svg class="h-5 w-5 sun-icon hidden relative z-10" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="ë¼ì´íŠ¸"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364-.707-.707M6.343 6.343l-.707-.707m12.728.0-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"/></svg>
<svg class="h-5 w-5 moon-icon hidden relative z-10" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="ë‹¤í¬"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003.0 0012 21a9.003 9.003.0 008.354-5.646z"/></svg>
<svg class="h-5 w-5 system-icon hidden relative z-10" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="ì‹œìŠ¤í…œ"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.75 17 9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5A2 2 0 003 5v10a2 2 0 002 2z"/></svg></button><div id=theme-dropdown class="dropdown-menu border-border bg-popover/95 absolute top-12 right-0 z-[60] hidden w-40 rounded-lg border p-1 shadow-lg backdrop-blur-sm transition-all duration-200 ease-out" data-dropdown-type=theme><button data-theme=light class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none">
<svg class="h-5 w-5 mr-3 h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="ë¼ì´íŠ¸"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364-.707-.707M6.343 6.343l-.707-.707m12.728.0-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"/></svg><span>ë¼ì´íŠ¸</span></button><button data-theme=dark class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none">
<svg class="h-5 w-5 mr-3 h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="ë‹¤í¬"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003.0 0012 21a9.003 9.003.0 008.354-5.646z"/></svg><span>ë‹¤í¬</span></button><button data-theme=system class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none">
<svg class="h-5 w-5 mr-3 h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="ì‹œìŠ¤í…œ"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.75 17 9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5A2 2 0 003 5v10a2 2 0 002 2z"/></svg><span>ì‹œìŠ¤í…œ</span></button></div></div></div></div><div class="flex w-full items-center justify-between md:hidden"><div class=relative><button id=mobile-menu-toggle class="dropdown-toggle border-border bg-background text-muted-foreground hover:bg-accent hover:text-foreground flex h-10 w-10 items-center justify-center rounded-lg border transition-colors duration-200" data-dropdown-type=mobile-menu aria-label=ë©”ë‰´ aria-expanded=false aria-haspopup=true>
<svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="ë©”ë‰´"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/></svg></button><div id=mobile-menu class="mobile-menu dropdown-menu border-border bg-popover/95 absolute top-12 left-0 z-[60] hidden w-80 max-w-[calc(100vw-2rem)] rounded-lg border p-1 shadow-lg backdrop-blur-sm transition-all duration-200 ease-out md:hidden" data-dropdown-type=mobile-menu role=menu aria-labelledby=mobile-menu-toggle><nav class="flex flex-col"><a href=/ko/ class="nav-link
text-muted-foreground hover:text-primary hover:bg-primary/10
focus:ring-primary/20 relative flex items-center gap-3 rounded-md px-4 py-3 text-sm font-medium transition-all duration-200 ease-out hover:translate-x-1 focus:ring-2 focus:outline-none" role=menuitem><svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="nav.posts"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 20H5a2 2 0 01-2-2V6a2 2 0 012-2h10a2 2 0 012 2v1m2 13a2 2 0 01-2-2V7m2 13a2 2 0 002-2V9a2 2 0 00-2-2h-2m-4-3H9M7 16h6M7 8h6v4H7V8z"/></svg>
<span>ê²Œì‹œê¸€
</span></a><a href=/ko/categories/ class="nav-link
text-muted-foreground hover:text-primary hover:bg-primary/10
focus:ring-primary/20 relative flex items-center gap-3 rounded-md px-4 py-3 text-sm font-medium transition-all duration-200 ease-out hover:translate-x-1 focus:ring-2 focus:outline-none" role=menuitem><svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="nav.categories"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"/></svg>
<span>ì¹´í…Œê³ ë¦¬
</span></a><a href=/ko/tags/ class="nav-link
text-muted-foreground hover:text-primary hover:bg-primary/10
focus:ring-primary/20 relative flex items-center gap-3 rounded-md px-4 py-3 text-sm font-medium transition-all duration-200 ease-out hover:translate-x-1 focus:ring-2 focus:outline-none" role=menuitem><svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="nav.tags"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 7h.01M7 3h5c.512.0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828.0l-7-7A1.994 1.994.0 013 12V7a4 4 0 014-4z"/></svg>
<span>íƒœê·¸
</span></a><a href=/ko/ class="nav-link
text-muted-foreground hover:text-primary hover:bg-primary/10
focus:ring-primary/20 relative flex items-center gap-3 rounded-md px-4 py-3 text-sm font-medium transition-all duration-200 ease-out hover:translate-x-1 focus:ring-2 focus:outline-none" role=menuitem><svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="nav.archives"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 8h14M5 8a2 2 0 110-4h14a2 2 0 110 4M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8m-9 4h4"/></svg>
<span>ì•„ì¹´ì´ë¸Œ</span></a></nav></div></div><div class="flex items-center space-x-2"><div class=relative><button id=language-toggle class="dropdown-toggle border-border bg-background text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex h-10 w-10 items-center justify-center rounded-lg border transition-all duration-300 ease-out hover:scale-105 focus:ring-2 focus:outline-none active:scale-95" data-dropdown-type=language aria-label="ì–¸ì–´ ë³€ê²½" aria-expanded=false aria-haspopup=true>
<svg class="h-5 w-5 relative z-10" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="ì–¸ì–´ ë³€ê²½"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m5 8 6 6m-7 0 6-6 2-3M2 5h12M7 2h1m14 20-5-10-5 10m2-4h6"/></svg></button><div id=language-dropdown class="dropdown-menu border-border bg-popover/95 absolute top-12 right-0 z-[60] hidden w-40 rounded-lg border p-1 shadow-lg backdrop-blur-sm transition-all duration-200 ease-out" data-dropdown-type=language role=menu aria-labelledby=language-toggle><a href=/ko/ class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none" role=menuitem aria-current=true><span class=font-medium>í•œêµ­ì–´</span></a><a href=/en/ class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none" role=menuitem><span class=font-medium>English</span></a></div></div><div class=relative><button id=color-scheme-toggle class="dropdown-toggle border-border bg-background text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex h-10 w-10 items-center justify-center rounded-lg border transition-all duration-300 ease-out hover:scale-105 focus:ring-2 focus:outline-none active:scale-95" data-dropdown-type=color-scheme aria-label="í…Œë§ˆ ë³€ê²½" aria-expanded=false aria-haspopup=true>
<svg class="h-5 w-5 relative z-10" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="í…Œë§ˆ ë³€ê²½"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zM21 5a2 2 0 00-2-2h-4a2 2 0 00-2 2v6a2 2 0 002 2h4a2 2 0 002-2V5z"/></svg></button><div id=color-scheme-dropdown class="dropdown-menu border-border bg-popover/95 absolute top-12 right-0 z-[60] hidden w-44 rounded-lg border p-1 shadow-lg backdrop-blur-sm transition-all duration-200 ease-out" data-dropdown-type=color-scheme><button data-color-scheme=claude class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Default</span></button><button data-color-scheme=default class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>White</span></button><button data-color-scheme=bumblebee class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Bumblebee</span></button><button data-color-scheme=emerald class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Emerald</span></button><button data-color-scheme=nord class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Nord</span></button><button data-color-scheme=sunset class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Sunset</span></button><button data-color-scheme=abyss class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Abyss</span></button><button data-color-scheme=dracula class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Dracula</span></button><button data-color-scheme=amethyst class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Amethyst</span></button><button data-color-scheme=slate class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Slate</span></button><button data-color-scheme=twitter class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Twitter</span></button></div></div><div class=relative><button id=theme-toggle class="dropdown-toggle border-border bg-background text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex h-10 w-10 items-center justify-center rounded-lg border transition-all duration-300 ease-out hover:scale-105 focus:ring-2 focus:outline-none active:scale-95" data-dropdown-type=theme aria-label="í…Œë§ˆ ë³€ê²½" aria-expanded=false aria-haspopup=true>
<svg class="h-5 w-5 sun-icon hidden relative z-10" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="ë¼ì´íŠ¸"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364-.707-.707M6.343 6.343l-.707-.707m12.728.0-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"/></svg>
<svg class="h-5 w-5 moon-icon hidden relative z-10" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="ë‹¤í¬"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003.0 0012 21a9.003 9.003.0 008.354-5.646z"/></svg>
<svg class="h-5 w-5 system-icon hidden relative z-10" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="ì‹œìŠ¤í…œ"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.75 17 9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5A2 2 0 003 5v10a2 2 0 002 2z"/></svg></button><div id=theme-dropdown class="dropdown-menu border-border bg-popover/95 absolute top-12 right-0 z-[60] hidden w-40 rounded-lg border p-1 shadow-lg backdrop-blur-sm transition-all duration-200 ease-out" data-dropdown-type=theme><button data-theme=light class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none">
<svg class="h-5 w-5 mr-3 h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="ë¼ì´íŠ¸"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364-.707-.707M6.343 6.343l-.707-.707m12.728.0-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"/></svg><span>ë¼ì´íŠ¸</span></button><button data-theme=dark class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none">
<svg class="h-5 w-5 mr-3 h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="ë‹¤í¬"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003.0 0012 21a9.003 9.003.0 008.354-5.646z"/></svg><span>ë‹¤í¬</span></button><button data-theme=system class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none">
<svg class="h-5 w-5 mr-3 h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="ì‹œìŠ¤í…œ"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.75 17 9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5A2 2 0 003 5v10a2 2 0 002 2z"/></svg><span>ì‹œìŠ¤í…œ</span></button></div></div></div></div></div></header><main class="mx-auto max-w-4xl px-4 py-6"><nav class="breadcrumb mb-4 md:mb-6 py-1" aria-label=ê²½ë¡œ><ol class="text-muted-foreground flex items-center space-x-1 md:space-x-2 text-sm overflow-x-auto whitespace-nowrap scrollbar-hide py-1"><li class=flex-shrink-0><a href=/ko/ class="text-muted-foreground hover:text-primary hover:bg-primary/10 flex items-center gap-0.5 md:gap-1 rounded-lg px-1 md:px-3 py-0.5 md:py-1.5 transition-all duration-200 ease-out hover:-translate-y-0.5 hover:scale-[1.02]"><svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="í™ˆ"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m3 12 2-2m0 0 7-7 7 7M5 10v10a1 1 0 001 1h3m10-11 2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"/></svg>
<span class="max-w-[4rem] md:max-w-none truncate">í™ˆ</span></a></li><li class="flex items-center gap-1 md:gap-2 min-w-0"><span class="text-muted-foreground/50 flex-shrink-0"><svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/></svg></span><div class="flex items-center gap-1 md:gap-2 min-w-0"><a href=/ko class="text-muted-foreground hover:text-primary hover:bg-primary/10 flex items-center gap-0.5 md:gap-1 rounded-lg px-1 md:px-3 py-0.5 md:py-1.5 transition-all duration-200 ease-out hover:-translate-y-0.5 hover:scale-[1.02] flex-shrink-0"><svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5A2 2 0 003 7z"/></svg>
<span class="max-w-[4rem] md:max-w-none truncate">Ko</span>
</a><span class="text-muted-foreground/50 flex-shrink-0"><svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/></svg></span>
<span class="text-foreground flex items-center gap-0.5 md:gap-1 font-medium min-w-0"><svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/></svg>
<span class="max-w-[8rem] md:max-w-[16rem] lg:max-w-none truncate">Comet: Fine-grained Computation-communication Overlapping for Mixture-of-Experts</span></span></div></li></ol></nav><header class=mb-8><h1 class="text-foreground mb-4 text-3xl font-bold md:text-4xl">Comet: Fine-grained Computation-communication Overlapping for Mixture-of-Experts</h1></header><article class="prose prose-neutral dark:prose-invert max-w-none"><p><a href=https://arxiv.org/abs/2502.19811v3>ë…¼ë¬¸ ë§í¬</a></p><h1 id=q--ì´-ë…¼ë¬¸ì„-ì•„ì£¼-ìì„¸í•˜ê²Œ-ì½ê³ -ë…¼ë¬¸ì˜-ê°•ì ê³¼-ë…ì°½ì ì¸-ì§€ì ì„-ì„¤ëª…í•´ì£¼ê³ -í•µì‹¬-ì•Œê³ ë¦¬ì¦˜ì„-ì˜ˆì‹œ-ì…ë ¥ì„-ë“¤ì–´ì„œ-ì „ì²´ì ì¸-ê³¼ì •ì„-ì„¤ëª…í•´ì¤˜-ì¶”ê°€ì ìœ¼ë¡œ-ë…¼ë¬¸ì˜-í•œê³„ì ì—-ëŒ€í•´ì„œë„-ì•Œë ¤ì¤˜>Q : ì´ ë…¼ë¬¸ì„ ì•„ì£¼ ìì„¸í•˜ê²Œ ì½ê³  ë…¼ë¬¸ì˜ ê°•ì ê³¼ ë…ì°½ì ì¸ ì§€ì ì„ ì„¤ëª…í•´ì£¼ê³  í•µì‹¬ ì•Œê³ ë¦¬ì¦˜ì„ ì˜ˆì‹œ ì…ë ¥ì„ ë“¤ì–´ì„œ ì „ì²´ì ì¸ ê³¼ì •ì„ ì„¤ëª…í•´ì¤˜ ì¶”ê°€ì ìœ¼ë¡œ ë…¼ë¬¸ì˜ í•œê³„ì ì— ëŒ€í•´ì„œë„ ì•Œë ¤ì¤˜</h1><p>ë…¼ë¬¸ **&ldquo;Comet: Fine-grained Computation-communication Overlapping for Mixture-of-Experts&rdquo;**ëŠ” MoE ëª¨ë¸ì˜ í•µì‹¬ ë³‘ëª©ì¸ GPU ê°„ í†µì‹  ì§€ì—°ì„ <strong>fine-grained ìˆ˜ì¤€ì—ì„œ ì»´í“¨íŒ…ê³¼ í†µì‹ ì„ ì •êµí•˜ê²Œ ê²¹ì¹˜ë„ë¡ ì„¤ê³„</strong>í•¨ìœ¼ë¡œì¨ ì‹¤í–‰ ì„±ëŠ¥ì„ í¬ê²Œ ê°œì„ í•œ ByteDanceì˜ ì‹œìŠ¤í…œ ìµœì í™” ë…¼ë¬¸ì…ë‹ˆë‹¤.</p><hr><h2 id=-ê²°ë¡ -ìš”ì•½>ğŸ“Œ ê²°ë¡  ìš”ì•½</h2><p><strong>Cometì€ ê¸°ì¡´ MoE ì‹œìŠ¤í…œ ëŒ€ë¹„ ìµœëŒ€ 1.96Ã— ë‹¨ì¼ ë ˆì´ì–´ ì†ë„ í–¥ìƒ, ì „ì²´ ëª¨ë¸ ê¸°ì¤€ í‰ê·  1.71Ã— ì†ë„ í–¥ìƒ</strong>ì„ ë‹¬ì„±í•˜ì˜€ìœ¼ë©°, ByteDanceì˜ 10,000+ GPU í´ëŸ¬ìŠ¤í„°ì— ìƒìš© ë°°í¬ë˜ì–´ ìˆ˜ë°±ë§Œ GPU ì‹œê°„ ì ˆê° íš¨ê³¼ë¥¼ ë³´ê³ í•¨.</p><table><thead><tr><th>ëª¨ë¸</th><th>ë¹„êµ ì‹œìŠ¤í…œ</th><th>ì†ë„ í–¥ìƒ ë°°ìœ¨</th></tr></thead><tbody><tr><td>ë‹¨ì¼ MoE Layer</td><td>Megatron-Cutlass ì™¸ 3ì¢…</td><td><strong>1.28Ã— ~ 2.37Ã—</strong></td></tr><tr><td>End-to-End</td><td>Megatron-Cutlass / TE / FasterMoE / Tutel</td><td><strong>1.71Ã— í‰ê·  (ìµœëŒ€ 44.4%)</strong></td></tr></tbody></table><hr><h2 id=-í•µì‹¬-ê¸°ì—¬-ë°-ë…ì°½ì„±>ğŸ§  í•µì‹¬ ê¸°ì—¬ ë° ë…ì°½ì„±</h2><table><thead><tr><th>ê¸°ì—¬ í•­ëª©</th><th>ì„¤ëª…</th></tr></thead><tbody><tr><td><strong>1. Shared Tensor ê¸°ë°˜ì˜ Data Dependency ë¶„ì„ ë° ì¬êµ¬ì„±</strong></td><td>í†µì‹ ê³¼ ì—°ì‚° ê°„ì˜ ë¯¸ì„¸ ë‹¨ìœ„ dependencyë¥¼ ì¶”ì¶œí•˜ì—¬ shared tensorë¥¼ M ë˜ëŠ” N ë°©í–¥ìœ¼ë¡œ ë‚˜ëˆ„ê³ , computation tile ë‹¨ìœ„ë¡œ reschedule</td></tr><tr><td><strong>2. Adaptive Thread Block Assignment</strong></td><td>GPU Thread Blockì„ í†µì‹ /ì—°ì‚°ìœ¼ë¡œ ë¶„ë¦¬í•œ í›„, workloadì— ë”°ë¼ ë¹„ìœ¨ì„ ë™ì ìœ¼ë¡œ ì¡°ì ˆí•˜ì—¬ latency concealment ê·¹ëŒ€í™”</td></tr><tr><td><strong>3. Fused Kernelì„ í†µí•œ intra-kernel pipelining</strong></td><td>ë³„ë„ kernel í˜¸ì¶œ ëŒ€ì‹  í•˜ë‚˜ì˜ kernel ë‚´ì—ì„œ í†µì‹ ê³¼ ì—°ì‚°ì„ thread block ìˆ˜ì¤€ì—ì„œ ë¶„ë¦¬í•´ fine-grained overlapping ì‹¤í˜„</td></tr><tr><td><strong>4. ì‹¤ìš©ì„± ë†’ì€ êµ¬í˜„ ë° ì‹¤ì œ í´ëŸ¬ìŠ¤í„° ì ìš©</strong></td><td>NVSHMEM ê¸°ë°˜ êµ¬í˜„, Megatron-LM í†µí•©, ë‹¤ì–‘í•œ ë³‘ë ¬ ì „ëµ(Tensor/Expert) ë° í”Œë«í¼(H800, L20) ëŒ€ì‘</td></tr></tbody></table><hr><h2 id=-í•µì‹¬-ì•Œê³ ë¦¬ì¦˜-ì„¤ëª…-ì˜ˆì‹œ-ê¸°ë°˜>ğŸ” í•µì‹¬ ì•Œê³ ë¦¬ì¦˜ ì„¤ëª… (ì˜ˆì‹œ ê¸°ë°˜)</h2><h3 id=ë¬¸ì œ-ìƒí™©>ë¬¸ì œ ìƒí™©:</h3><p>MoEì˜ Layer0ì—ì„œëŠ” ê° tokenì´ ì—¬ëŸ¬ expertë¡œ ë¶„ì‚°ë˜ì–´ GPU ê°„ í†µì‹  í•„ìš” â†’ GEMM ì‹¤í–‰ì€ tile ë‹¨ìœ„ (ì˜ˆ: 128Ã—128), í•˜ì§€ë§Œ í†µì‹ ì€ token ë‹¨ìœ„ â†’ <strong>granularity mismatch</strong> ë°œìƒ</p><hr><h3 id=ì˜ˆì‹œ-ì…ë ¥>ì˜ˆì‹œ ì…ë ¥:</h3><ul><li>ì´ í† í° ìˆ˜ ( M = 4096 ), ê° tokenì€ ( N = 4096 ) ì°¨ì›</li><li>top-k = 2 â†’ tokenë§ˆë‹¤ 2ê°œì˜ expertë¡œ ë¼ìš°íŒ…ë¨</li><li>Expert ìˆ˜ ( E = 8 ), GPU ìˆ˜ = 8 (expert parallelism)</li></ul><hr><h3 id=comet-ì²˜ë¦¬-íë¦„>Comet ì²˜ë¦¬ íë¦„:</h3><ol><li><p><strong>Shared Tensor Decompose</strong></p><ul><li>Layer0ì—ì„œëŠ” GEMMì˜ ì…ë ¥ì´ë¯€ë¡œ ( M ) ë°©í–¥(í† í° ë‹¨ìœ„)ìœ¼ë¡œ tensor ë¶„í•´</li><li>Layer1ì—ì„œëŠ” TopK reduce ê²°ê³¼ë¥¼ ë³´ë‚¼ ë•Œ ( N ) ë°©í–¥(embedding ì°¨ì›)ìœ¼ë¡œ ë¶„í•´</li></ul></li><li><p><strong>Reschedule: í†µì‹ -ì—°ì‚° íŒŒì´í”„ë¼ì¸ ì •ë ¬</strong></p><ul><li>ê° expertì˜ GEMM tileì´ ê°€ëŠ¥í•œ í•œ local tokenìœ¼ë¡œ ì‹œì‘ë˜ë„ë¡ token ì •ë ¬</li><li>Remote tokenì€ ë¹„ë™ê¸°ë¡œ ê°€ì ¸ì˜¤ë©´ì„œ ë‹¤ë¥¸ tile ì—°ì‚° ì§„í–‰</li></ul></li><li><p><strong>Adaptive Thread Block Assignment</strong></p><ul><li>GPU SMì— thread block ë°°ì • ì‹œ, í†µì‹  ì „ìš© / ì—°ì‚° ì „ìš© block ë¶„ë¦¬</li><li>Cometì€ ì…ë ¥ ê¸¸ì´, top-k, expert ìˆ˜ì— ë”°ë¼ ìµœì  ë¶„í• ë¹„ (e.g. í†µì‹ :ì—°ì‚° = 26:106)ë¥¼ ë™ì ìœ¼ë¡œ ì„ íƒ</li></ul></li><li><p><strong>Fine-grained Fused Kernel ì‹¤í–‰</strong></p><ul><li>í†µì‹  thread blockì€ async I/O (TMA ë“±)ë¡œ remote token ìˆ˜ì‹ </li><li>ì—°ì‚° thread blockì€ GroupGEMM tile ì‹¤í–‰</li><li>ê³µìœ  ë©”ëª¨ë¦¬ ê²½ìœ ë¡œ í†µì‹ -ì—°ì‚°ì„ ì•ˆì „í•˜ê²Œ ë™ê¸°í™”</li></ul></li></ol><hr><h2 id=-ì„±ëŠ¥-ë¶„ì„-ì‹¤í—˜-ê²°ê³¼>ğŸ§ª ì„±ëŠ¥ ë¶„ì„ (ì‹¤í—˜ ê²°ê³¼)</h2><table><thead><tr><th>ì‹¤í—˜ ì¡°ê±´</th><th>Cometì˜ ê°œì„  íš¨ê³¼</th></tr></thead><tbody><tr><td>Input Token ìˆ˜ ì¦ê°€ (2048â†’32768)</td><td>1.28Ã— ~ 2.37Ã— layer ì†ë„ ê°œì„ </td></tr><tr><td>top-k ë° expert ìˆ˜ ì¦ê°€</td><td>Tutel, FasterMoE ëŒ€ë¹„ 1.16Ã— ~ 1.83Ã— ì•ˆì •ì  ê°œì„ </td></tr><tr><td>GPU ê°„ ëŒ€ì—­í­ ì œì•½ (L20 í´ëŸ¬ìŠ¤í„°)</td><td>1.19Ã— ~ 1.46Ã— ê°œì„ , Cometì˜ ìœ ì—°ì„± ì…ì¦</td></tr><tr><td>Load imbalance ìƒí™© (token ë¶„í¬ std=0.05)</td><td>ì—¬ì „íˆ Cometì´ ìµœì € latency ìœ ì§€</td></tr></tbody></table><hr><h2 id=-í•œê³„ì -ë°-í–¥í›„-ë°©í–¥>âš ï¸ í•œê³„ì  ë° í–¥í›„ ë°©í–¥</h2><table><thead><tr><th>í•œê³„</th><th>ì„¤ëª…</th></tr></thead><tbody><tr><td><strong>NVSHMEM ì˜ì¡´ì„±</strong></td><td>ì €ìˆ˜ì¤€ í†µì‹  ë¼ì´ë¸ŒëŸ¬ë¦¬ ì‚¬ìš© â†’ ìœ ì§€ë³´ìˆ˜ ë° í˜¸í™˜ì„± ë¬¸ì œ ê°€ëŠ¥</td></tr><tr><td><strong>ì‹¤í–‰ ì „ profiling í•„ìš”</strong></td><td>ê° ëª¨ë¸ configë§ˆë‹¤ ìµœì  thread block ë¹„ìœ¨ì„ profiling í•´ì•¼ í•¨</td></tr><tr><td><strong>ì•„ì§ì€ MoE layerì— ì§‘ì¤‘</strong></td><td>attention, embedding ë“± ë‹¤ë¥¸ ì—°ì‚°ê³¼ í†µí•©ëœ end-to-end ì „ì²´ ìµœì í™”ëŠ” ë¯¸ì§„</td></tr></tbody></table><hr><h2 id=-ìš”ì•½>ğŸ’¡ ìš”ì•½</h2><p><strong>Cometì€ ê¸°ì¡´ coarse-grained pipelining ë°©ì‹ì˜ í•œê³„ë¥¼ ê·¹ë³µí•˜ê³ , fine-grained ìˆ˜ì¤€ì—ì„œ ì—°ì‚°ê³¼ í†µì‹ ì„ ì •êµí•˜ê²Œ ì¡°ìœ¨í•¨ìœ¼ë¡œì¨ MoEì˜ ë³‘ëª©ì„ êµ¬ì¡°ì ìœ¼ë¡œ í•´ê²°í•œ ê³ ì„±ëŠ¥ ì‹œìŠ¤í…œì…ë‹ˆë‹¤.</strong> íŠ¹íˆ, CUDA ì»¤ë„ ë ˆë²¨ì—ì„œì˜ í†µí•© ìŠ¤ì¼€ì¤„ë§ ë° ë™ì  ë¦¬ì†ŒìŠ¤ ë¶„ë°°ëŠ” ì¼ë°˜ì ì¸ kernel-level ë³‘ë ¬í™”ì—ì„œ êµ¬í˜„ì´ ì–´ë ¤ì› ë˜ ë¶€ë¶„ì„ íš¨ê³¼ì ìœ¼ë¡œ í•´ê²°í•œ ì ì—ì„œ ë†’ì€ ë…ì°½ì„±ê³¼ ì‹¤ìš©ì„±ì„ ì§€ë‹™ë‹ˆë‹¤.</p><h1 id=q--ë…¼ë¬¸ì˜-í•µì‹¬ì•Œê³ ë¦¬ì¦˜ì„-ì˜ˆì‹œë¥¼-ë“¤ì–´-ì•„ì£¼-ìì„¸í•˜ê²Œ-ì„¤ëª…í•´ì£¼ê³ -ì •ë¦¬í•´-ì¤˜>Q : ë…¼ë¬¸ì˜ í•µì‹¬ì•Œê³ ë¦¬ì¦˜ì„ ì˜ˆì‹œë¥¼ ë“¤ì–´ ì•„ì£¼ ìì„¸í•˜ê²Œ ì„¤ëª…í•´ì£¼ê³  ì •ë¦¬í•´ ì¤˜</h1><p>ì¢‹ìŠµë‹ˆë‹¤. ë…¼ë¬¸ <em>Comet: Fine-grained Computation-communication Overlapping for Mixture-of-Experts</em>ì˜ í•µì‹¬ ì•Œê³ ë¦¬ì¦˜ì€ í¬ê²Œ ë‘ ê°€ì§€ì…ë‹ˆë‹¤:</p><hr><h2 id=-í•µì‹¬-ì•Œê³ ë¦¬ì¦˜-êµ¬ì¡°-ìš”ì•½>ğŸ§© í•µì‹¬ ì•Œê³ ë¦¬ì¦˜ êµ¬ì¡° ìš”ì•½</h2><table><thead><tr><th>êµ¬ì„± ìš”ì†Œ</th><th>ì—­í• </th><th>í•µì‹¬ ì•„ì´ë””ì–´</th></tr></thead><tbody><tr><td>â‘  Shared Tensor ê¸°ë°˜ Dependency Resolving</td><td>í†µì‹ -ì—°ì‚° íŒŒì´í”„ë¼ì¸ ìµœì í™”</td><td>Tensor ë¶„í•´ + ì—°ì‚° ì¬ìŠ¤ì¼€ì¤„</td></tr><tr><td>â‘¡ Adaptive Workload Assignment</td><td>GPU ìì› íš¨ìœ¨í™”</td><td>Thread block ë¹„ìœ¨ì„ ë™ì ìœ¼ë¡œ ì¡°ì •</td></tr></tbody></table><hr><p>ì´ì œ ì‹¤ì œ ì˜ˆì‹œë¥¼ ê¸°ë°˜ìœ¼ë¡œ ê° ì•Œê³ ë¦¬ì¦˜ì´ ì–´ë–»ê²Œ ì‘ë™í•˜ëŠ”ì§€ ìì„¸íˆ ì„¤ëª…í•˜ê² ìŠµë‹ˆë‹¤.</p><hr><h2 id=-ì˜ˆì‹œ-ì„¤ì •>ğŸ” ì˜ˆì‹œ ì„¤ì •</h2><h3 id=ëª¨ë¸-ì„¤ì •>ëª¨ë¸ ì„¤ì •</h3><ul><li>Token ìˆ˜ ( M = 4096 ), ì„ë² ë”© ì°¨ì› ( N = 4096 )</li><li>Expert ìˆ˜ ( E = 4 ), top-k = 2</li><li>Expert parallelism: ê° GPUëŠ” 1ê°œì˜ expertë¥¼ ê°€ì§€ê³  ìˆìŒ (GPU0 ~ GPU3)</li><li>GEMM tile í¬ê¸° = 128 Ã— 128</li></ul><hr><h2 id=--shared-tensor-ê¸°ë°˜-dependency-resolving>ğŸ§  â‘  Shared Tensor ê¸°ë°˜ Dependency Resolving</h2><h3 id=-ëª©ì >ğŸ’¡ ëª©ì </h3><p>í†µì‹ ê³¼ ì—°ì‚°ì„ <strong>ë™ì‹œì— ì²˜ë¦¬</strong>í•˜ê¸° ìœ„í•´, ì—°ì‚°ì—ì„œ í•„ìš”í•œ ë°ì´í„°ê°€ ì¤€ë¹„ë˜ëŠ” ìˆœê°„ ë°”ë¡œ ì—°ì‚°ì„ ì‹œì‘í•˜ê²Œ ë§Œë“œëŠ” ê²ƒ</p><hr><h3 id=-moe-layer0ì˜-ì˜ˆ>ğŸ“Œ MoE Layer0ì˜ ì˜ˆ</h3><h4 id=-step-1-shared-tensor-ë¶„í•´-decompose>âœ… Step 1: Shared Tensor ë¶„í•´ (Decompose)</h4><ul><li>ê° tokenì€ top-2 expertë¡œ ë¼ìš°íŒ…ë¨ â†’ GPU ê°„ All-to-All í†µì‹  í•„ìš”</li><li>GEMM ì—°ì‚°ì€ ë³´í†µ 128ê°œì˜ token ë‹¨ìœ„ë¡œ tile ì—°ì‚°</li><li>ë”°ë¼ì„œ, <strong>shared tensorë¥¼ M ë°©í–¥(í† í° ë°©í–¥)</strong> ìœ¼ë¡œ ë¶„í•´<ul><li>ì˜ˆ: tensor shape = (4096 Ã— N), â†’ 32ê°œ ë¸”ë¡ (4096/128 = 32)</li></ul></li></ul><h4 id=-step-2-ì¬ìŠ¤ì¼€ì¤„-reschedule>âœ… Step 2: ì¬ìŠ¤ì¼€ì¤„ (Reschedule)</h4><ul><li>ê° expertëŠ” local + remote tokenì´ ì„ì—¬ ìˆìŒ</li><li>ë¨¼ì € <strong>local tokenë§Œ í¬í•¨ëœ tileë¶€í„° GEMM ì‹¤í–‰ ì‹œì‘</strong><ul><li>ì˜ˆ: GPU1ì˜ Expert1ì€ local token 0~127ì„ ë¨¼ì € ì²˜ë¦¬</li></ul></li><li>ê·¸ ì‚¬ì´ GPU1ì€ GPU0/GPU2ë¡œë¶€í„° í•„ìš”í•œ remote tokenì„ ë¹„ë™ê¸°ë¡œ ìˆ˜ì‹ </li></ul><p>â¡ï¸ ê²°ê³¼ì ìœ¼ë¡œ ì—°ì‚°ê³¼ í†µì‹ ì´ ìì—°ìŠ¤ëŸ½ê²Œ ê²¹ì¹¨ (overlap)</p><hr><h3 id=-moe-layer1ì˜-ì˜ˆ>ğŸ“Œ MoE Layer1ì˜ ì˜ˆ</h3><h4 id=-step-1-shared-tensor-ë¶„í•´-decompose-1>âœ… Step 1: Shared Tensor ë¶„í•´ (Decompose)</h4><ul><li>GEMM í›„ ê²°ê³¼ë¥¼ top-k reduceí•˜ì—¬ í†µì‹ í•¨ â†’ GEMM ê²°ê³¼ëŠ” (MÃ—N)</li><li>ReduceëŠ” tokenë¼ë¦¬ í•©ì¹˜ë¯€ë¡œ M ë°©í–¥ìœ¼ë¡œ ë¶„í•´ âŒ, ëŒ€ì‹  <strong>N ë°©í–¥ ë¶„í•´</strong> âœ”ï¸</li></ul><h4 id=-step-2-ì¬ìŠ¤ì¼€ì¤„>âœ… Step 2: ì¬ìŠ¤ì¼€ì¤„</h4><ul><li>GEMM ê²°ê³¼ëŠ” column-wiseë¡œ ì²˜ë¦¬ë˜ë©°</li><li><strong>ì•ë¶€ë¶„ N ì°¨ì›ì˜ columnë¶€í„° ë¨¼ì € ê³„ì‚°í•˜ê³  ë°”ë¡œ reduce+send</strong><ul><li>ì˜ˆ: column 0~127 ì™„ë£Œ â†’ ê³§ë°”ë¡œ All-to-All ì‹œì‘</li></ul></li></ul><p>â¡ï¸ ì—°ì‚° ëë‚  ë•Œê¹Œì§€ ê¸°ë‹¤ë¦¬ì§€ ì•Šê³ , ì•ë¶€ë¶„ë¶€í„° í†µì‹ ì„ ì‹œì‘í•  ìˆ˜ ìˆê²Œ ë¨</p><hr><h2 id=--adaptive-workload-assignment>ğŸ§  â‘¡ Adaptive Workload Assignment</h2><h3 id=-ëª©ì -1>ğŸ’¡ ëª©ì </h3><p>ì—°ì‚° thread blockê³¼ í†µì‹  thread blockì˜ <strong>ìˆ˜ëŸ‰ ë¹„ìœ¨</strong>ì„ ìë™ ì¡°ì •í•˜ì—¬ pipeline íš¨ìœ¨ ê·¹ëŒ€í™”</p><hr><h3 id=ì˜ˆì‹œ>ì˜ˆì‹œ</h3><ul><li>GPUì— 132ê°œì˜ SMì´ ìˆìŒ â†’ 132ê°œì˜ thread block ë°°ì¹˜ ê°€ëŠ¥</li><li>ê° kernel ì‹¤í–‰ ì‹œ, <code>nc</code>ê°œëŠ” í†µì‹ ìš© thread block, <code>np</code>ê°œëŠ” ì—°ì‚°ìš© thread block í• ë‹¹</li></ul><h4 id=ë¬¸ì œ-ì–´ë–¤-ë¹„ìœ¨ì´-ìµœì ì¼ê¹Œ>ë¬¸ì œ: ì–´ë–¤ ë¹„ìœ¨ì´ ìµœì ì¼ê¹Œ?</h4><h4 id=í•´ê²°>í•´ê²°:</h4><ul><li>ì‹¤í–‰ ì „ì— ë‹¤ì–‘í•œ ì…ë ¥ ê¸¸ì´ì™€ ëª¨ë¸ êµ¬ì„±ì— ë”°ë¼ profile ìˆ˜í–‰</li><li>ì˜ˆ: ( M=16384, TP=8 )ì´ë©´ â†’ ìµœì  <code>nc=26</code>, <code>np=106</code></li><li>ì´ ê°’ì„ metadataë¡œ ì €ì¥ â†’ ëŸ°íƒ€ì„ì— ë™ì ìœ¼ë¡œ ìµœì  ì»¤ë„ ì„ íƒ</li></ul><p>â¡ï¸ workloadë§ˆë‹¤ latency concealment ê·¹ëŒ€í™” (ì˜ˆ: í†µì‹ ê³¼ ì—°ì‚° latency ë¹„ìŠ·í•˜ê²Œ ë§ì¶¤)</p><hr><h2 id=-ì „ì²´-ì‹¤í–‰-íë¦„-ìš”ì•½>ğŸ¯ ì „ì²´ ì‹¤í–‰ íë¦„ ìš”ì•½</h2><div class="code-block-container border-border bg-card my-6 overflow-hidden rounded-xl border shadow-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:shadow-md"><div class="code-block-header bg-muted/30 border-border flex items-center justify-between border-b px-4 py-3"><div class="flex items-center gap-2"><div class="text-muted-foreground flex-shrink-0"><svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4 4 4-4 4M6 16l-4-4 4-4"/></svg></div><span class="text-muted-foreground text-sm font-medium">PLAINTEXT</span></div><div class="flex items-center gap-2"><button class="collapse-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-0 data-default-state=expanded data-collapsed=false data-auto-collapse-lines=30 data-auto-collapse-height=400 data-collapsed-height=120 title=ì ‘ê¸° aria-label=ì ‘ê¸°>
<span class=collapse-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41 12 10.83l4.59 4.58L18 14l-6-6-6 6z"/></svg>
</span><span class="collapse-text hidden sm:inline">ì ‘ê¸°</span>
</button>
<button class="copy-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-0 title=ë³µì‚¬ aria-label=ë³µì‚¬>
<span class=copy-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/></svg>
</span><span class="copy-text hidden sm:inline">ë³µì‚¬</span></button></div></div><div class="code-block-content relative" id=code-0><div class=highlight><pre tabindex=0 class=chroma><code class=language-plaintext data-lang=plaintext><span class=line><span class=ln> 1</span><span class=cl>[Input Tokens] â†’
</span></span><span class=line><span class=ln> 2</span><span class=cl>â‘  Shared Tensor ìƒì„± â†’
</span></span><span class=line><span class=ln> 3</span><span class=cl>â‘ -1 M/N ë°©í–¥ìœ¼ë¡œ ë¶„í•´ â†’
</span></span><span class=line><span class=ln> 4</span><span class=cl>â‘ -2 Token ì •ë ¬ ë° tile ë‹¨ìœ„ ì—°ì‚° ì¬ë°°ì—´ â†’
</span></span><span class=line><span class=ln> 5</span><span class=cl>â‘¡ Adaptive thread block ë¶„ë°° (e.g., nc=26, np=106) â†’
</span></span><span class=line><span class=ln> 6</span><span class=cl>â‘¢ Fused kernel ë‚´ì—ì„œ
</span></span><span class=line><span class=ln> 7</span><span class=cl>   â”œâ”€ í†µì‹  block: remote token ë¹„ë™ê¸° ìˆ˜ì‹ 
</span></span><span class=line><span class=ln> 8</span><span class=cl>   â””â”€ ì—°ì‚° block: local tokenë¶€í„° GEMM ì‹œì‘ â†’
</span></span><span class=line><span class=ln> 9</span><span class=cl>â‘£ ì—°ì‚° ê²°ê³¼ëŠ” ê³§ë°”ë¡œ column-wiseë¡œ reduce+send â†’
</span></span><span class=line><span class=ln>10</span><span class=cl>[Output Token]</span></span></code></pre></div><div class="collapse-overlay to-card/90 pointer-events-none absolute inset-0 bg-gradient-to-b from-transparent via-transparent opacity-0 transition-opacity duration-300"><div class="text-muted-foreground bg-card/80 border-border/50 hover:bg-primary/10 hover:text-primary hover:border-primary/30 absolute bottom-4 left-1/2 -translate-x-1/2 cursor-pointer rounded-full border px-3 py-1.5 text-xs backdrop-blur-sm transition-all duration-200">í´ë¦­í•˜ì—¬ ë” ë³´ê¸°</div></div></div></div><script>(function(){const s="code-0",n=document.querySelector('.copy-code-btn[data-code-id="'+s+'"]'),t=document.querySelector('.collapse-code-btn[data-code-id="'+s+'"]'),e=document.getElementById(s);if(!e)return;if(n){const s=n.querySelector(".copy-icon"),t=n.querySelector(".copy-text");n.addEventListener("click",async function(){try{let o="";const i=e.querySelector(".lntd:last-child code");if(i)o=i.textContent||i.innerText;else{const t=e.querySelector("code");if(t){const e=t.querySelector(".ln");if(e){const e=t.querySelectorAll(".cl");if(e.length>0)o=Array.from(e).map(e=>{const t=e.textContent||e.innerText;return t.replace(/\n+$/,"")}).join(`
`).replace(/\n+$/,"");else{const e=t.textContent||t.innerText;o=e.replace(/^\d+/gm,"").replace(/^\s+/gm,"")}}else o=t.textContent||t.innerText}else o=e.textContent||e.innerText}o=o.trim(),await navigator.clipboard.writeText(o),s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
</svg>`,t&&(t.textContent="ë³µì‚¬ë¨"),n.classList.add("text-green-600"),setTimeout(()=>{s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
</svg>`,t&&(t.textContent="ë³µì‚¬"),n.classList.remove("text-green-600")},2e3)}catch(o){console.error("å¤åˆ¶å¤±è´¥:",o);const s=document.createRange(),i=e.querySelector("code")||e;s.selectNodeContents(i);const n=window.getSelection();n.removeAllRanges(),n.addRange(s),t&&(t.textContent="ì„ íƒë¨"),setTimeout(()=>{t&&(t.textContent="ë³µì‚¬"),n.removeAllRanges()},2e3)}})}if(t){const d=t.querySelector(".collapse-icon"),c=t.querySelector(".collapse-text"),n=e.querySelector(".collapse-overlay");let s=e.querySelector("pre.chroma");s||(s=e.querySelector("pre"));const m=t.dataset.defaultState||"expanded",f=t.dataset.collapsed==="true",u=parseInt(t.dataset.autoCollapseLines)||30,h=parseInt(t.dataset.autoCollapseHeight)||400,p=parseInt(t.dataset.collapsedHeight)||120;let l=!1;function i(){const e=f||m==="collapsed"||a();e&&o(!0,!1)}function a(){if(s){const e=s.querySelectorAll(".line, .cl"),t=s.offsetHeight;return e.length>u||t>h}const t=e.offsetHeight;if(t>h)return!0;const n=e.textContent||e.innerText||"",o=n.split(`
`).length;return o>u}function o(s,o=!0){if(!n)return;l=s,s?(e.style.maxHeight=p+"px",e.style.overflow="hidden",n.style.opacity="1",n.style.pointerEvents="auto",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
</svg>`,c&&(c.textContent="í¼ì¹˜ê¸°"),t.title="í¼ì¹˜ê¸°"):(e.style.maxHeight="",e.style.overflow="",n.style.opacity="0",n.style.pointerEvents="none",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z"/></svg>`,c&&(c.textContent="ì ‘ê¸°"),t.title="ì ‘ê¸°"),o&&(e.style.transition="max-height 0.3s ease-out",setTimeout(()=>{e.style.transition=""},300))}function r(){o(!l,!0)}t.addEventListener("click",r),n&&n.addEventListener("click",()=>{l&&o(!1,!0)}),i()}})()</script><hr><h2 id=-ì‹œê°í™”-ìš”ì•½>ğŸ“Œ ì‹œê°í™” ìš”ì•½</h2><div class="code-block-container border-border bg-card my-6 overflow-hidden rounded-xl border shadow-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:shadow-md"><div class="code-block-header bg-muted/30 border-border flex items-center justify-between border-b px-4 py-3"><div class="flex items-center gap-2"><div class="text-muted-foreground flex-shrink-0"><svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4 4 4-4 4M6 16l-4-4 4-4"/></svg></div><span class="text-muted-foreground text-sm font-medium">PLAINTEXT</span></div><div class="flex items-center gap-2"><button class="collapse-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-1 data-default-state=expanded data-collapsed=false data-auto-collapse-lines=30 data-auto-collapse-height=400 data-collapsed-height=120 title=ì ‘ê¸° aria-label=ì ‘ê¸°>
<span class=collapse-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41 12 10.83l4.59 4.58L18 14l-6-6-6 6z"/></svg>
</span><span class="collapse-text hidden sm:inline">ì ‘ê¸°</span>
</button>
<button class="copy-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-1 title=ë³µì‚¬ aria-label=ë³µì‚¬>
<span class=copy-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/></svg>
</span><span class="copy-text hidden sm:inline">ë³µì‚¬</span></button></div></div><div class="code-block-content relative" id=code-1><div class=highlight><pre tabindex=0 class=chroma><code class=language-plaintext data-lang=plaintext><span class=line><span class=ln> 1</span><span class=cl>  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
</span></span><span class=line><span class=ln> 2</span><span class=cl>  â”‚ Remote I/O â”‚â—„â”€â”€â”€â”€â”€â”€â”€â–¶â”‚ Local GEMM â”‚
</span></span><span class=line><span class=ln> 3</span><span class=cl>  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</span></span><span class=line><span class=ln> 4</span><span class=cl>        â–²                      â–²
</span></span><span class=line><span class=ln> 5</span><span class=cl>        â”‚ Shared Tensor (ë¶„í•´/ì¬ì •ë ¬)
</span></span><span class=line><span class=ln> 6</span><span class=cl>        â–¼                      â–¼
</span></span><span class=line><span class=ln> 7</span><span class=cl>  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
</span></span><span class=line><span class=ln> 8</span><span class=cl>  â”‚    Fine-grained Overlapping     â”‚
</span></span><span class=line><span class=ln> 9</span><span class=cl>  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</span></span><span class=line><span class=ln>10</span><span class=cl>        â–²                      â–²
</span></span><span class=line><span class=ln>11</span><span class=cl>        â”‚                      â”‚
</span></span><span class=line><span class=ln>12</span><span class=cl>   [í†µì‹  Thread Block]    [ì—°ì‚° Thread Block]</span></span></code></pre></div><div class="collapse-overlay to-card/90 pointer-events-none absolute inset-0 bg-gradient-to-b from-transparent via-transparent opacity-0 transition-opacity duration-300"><div class="text-muted-foreground bg-card/80 border-border/50 hover:bg-primary/10 hover:text-primary hover:border-primary/30 absolute bottom-4 left-1/2 -translate-x-1/2 cursor-pointer rounded-full border px-3 py-1.5 text-xs backdrop-blur-sm transition-all duration-200">í´ë¦­í•˜ì—¬ ë” ë³´ê¸°</div></div></div></div><script>(function(){const s="code-1",n=document.querySelector('.copy-code-btn[data-code-id="'+s+'"]'),t=document.querySelector('.collapse-code-btn[data-code-id="'+s+'"]'),e=document.getElementById(s);if(!e)return;if(n){const s=n.querySelector(".copy-icon"),t=n.querySelector(".copy-text");n.addEventListener("click",async function(){try{let o="";const i=e.querySelector(".lntd:last-child code");if(i)o=i.textContent||i.innerText;else{const t=e.querySelector("code");if(t){const e=t.querySelector(".ln");if(e){const e=t.querySelectorAll(".cl");if(e.length>0)o=Array.from(e).map(e=>{const t=e.textContent||e.innerText;return t.replace(/\n+$/,"")}).join(`
`).replace(/\n+$/,"");else{const e=t.textContent||t.innerText;o=e.replace(/^\d+/gm,"").replace(/^\s+/gm,"")}}else o=t.textContent||t.innerText}else o=e.textContent||e.innerText}o=o.trim(),await navigator.clipboard.writeText(o),s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
</svg>`,t&&(t.textContent="ë³µì‚¬ë¨"),n.classList.add("text-green-600"),setTimeout(()=>{s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
</svg>`,t&&(t.textContent="ë³µì‚¬"),n.classList.remove("text-green-600")},2e3)}catch(o){console.error("å¤åˆ¶å¤±è´¥:",o);const s=document.createRange(),i=e.querySelector("code")||e;s.selectNodeContents(i);const n=window.getSelection();n.removeAllRanges(),n.addRange(s),t&&(t.textContent="ì„ íƒë¨"),setTimeout(()=>{t&&(t.textContent="ë³µì‚¬"),n.removeAllRanges()},2e3)}})}if(t){const d=t.querySelector(".collapse-icon"),c=t.querySelector(".collapse-text"),n=e.querySelector(".collapse-overlay");let s=e.querySelector("pre.chroma");s||(s=e.querySelector("pre"));const m=t.dataset.defaultState||"expanded",f=t.dataset.collapsed==="true",u=parseInt(t.dataset.autoCollapseLines)||30,h=parseInt(t.dataset.autoCollapseHeight)||400,p=parseInt(t.dataset.collapsedHeight)||120;let l=!1;function i(){const e=f||m==="collapsed"||a();e&&o(!0,!1)}function a(){if(s){const e=s.querySelectorAll(".line, .cl"),t=s.offsetHeight;return e.length>u||t>h}const t=e.offsetHeight;if(t>h)return!0;const n=e.textContent||e.innerText||"",o=n.split(`
`).length;return o>u}function o(s,o=!0){if(!n)return;l=s,s?(e.style.maxHeight=p+"px",e.style.overflow="hidden",n.style.opacity="1",n.style.pointerEvents="auto",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
</svg>`,c&&(c.textContent="í¼ì¹˜ê¸°"),t.title="í¼ì¹˜ê¸°"):(e.style.maxHeight="",e.style.overflow="",n.style.opacity="0",n.style.pointerEvents="none",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z"/></svg>`,c&&(c.textContent="ì ‘ê¸°"),t.title="ì ‘ê¸°"),o&&(e.style.transition="max-height 0.3s ease-out",setTimeout(()=>{e.style.transition=""},300))}function r(){o(!l,!0)}t.addEventListener("click",r),n&&n.addEventListener("click",()=>{l&&o(!1,!0)}),i()}})()</script><hr><h2 id=-ìš”ì•½-ì •ë¦¬>âœ… ìš”ì•½ ì •ë¦¬</h2><table><thead><tr><th>ì•Œê³ ë¦¬ì¦˜</th><th>ì„¤ëª…</th><th>ì£¼ìš” íš¨ê³¼</th></tr></thead><tbody><tr><td>Shared Tensor Dependency Resolving</td><td>í†µì‹ ê³¼ ì—°ì‚° ì‚¬ì´ì˜ ë°ì´í„° ì˜ì¡´ì„± í•´ì†Œ ìœ„í•´ tensorë¥¼ ë¶„í•´ ë° ì¬ìŠ¤ì¼€ì¤„</td><td>ë¯¸ì„¸ ë‹¨ìœ„ ì—°ì‚°-í†µì‹  overlap ì‹¤í˜„</td></tr><tr><td>Adaptive Workload Assignment</td><td>í†µì‹ /ì—°ì‚° thread blockì˜ ìˆ˜ë¥¼ ë™ì ìœ¼ë¡œ í• ë‹¹</td><td>SM í™œìš©ë„ ê·¹ëŒ€í™” + bubble ìµœì†Œí™”</td></tr><tr><td>Fused Kernel ì‹¤í–‰</td><td>í•˜ë‚˜ì˜ kernelì—ì„œ í†µì‹ ê³¼ ì—°ì‚°ì„ ë¶„ë¦¬ëœ thread blockìœ¼ë¡œ ë™ì‹œì— ì‹¤í–‰</td><td>ì»¤ë„ í˜¸ì¶œ ì˜¤ë²„í—¤ë“œ ì œê±°</td></tr></tbody></table><h1 id=q--ì´-ë…¼ë¬¸ì—ì„œ-ì œì‹œí•œ-ê²°ê³¼ë¥¼-ìì„¸í•˜ê²Œ-ë³´ê³ -ë‹¤ë¥¸-ë°©ë²•ë¡ ì—-ë¹„í•˜ì—¬-íŠ¹ì¶œë‚œ-ì ê³¼-ë…¼ë¬¸ì—ì„œ-ì œê¸°í•˜ëŠ”-ì–´ë– í•œ-ë°©ë²•ì´-ì´ëŸ¬í•œ-ê²°ê³¼ë¥¼-ë„ì¶œí•˜ê²Œ-ë˜ì—ˆëŠ”ì§€-ë…¼ë¬¸ì—ì„œ-ì œì‹œí•˜ëŠ”-ì´ìœ ì™€-ë„ˆì˜-ìƒê°ì„-ì•Œë ¤ì¤˜>Q : ì´ ë…¼ë¬¸ì—ì„œ ì œì‹œí•œ ê²°ê³¼ë¥¼ ìì„¸í•˜ê²Œ ë³´ê³  ë‹¤ë¥¸ ë°©ë²•ë¡ ì— ë¹„í•˜ì—¬ íŠ¹ì¶œë‚œ ì ê³¼ ë…¼ë¬¸ì—ì„œ ì œê¸°í•˜ëŠ” ì–´ë– í•œ ë°©ë²•ì´ ì´ëŸ¬í•œ ê²°ê³¼ë¥¼ ë„ì¶œí•˜ê²Œ ë˜ì—ˆëŠ”ì§€ ë…¼ë¬¸ì—ì„œ ì œì‹œí•˜ëŠ” ì´ìœ ì™€ ë„ˆì˜ ìƒê°ì„ ì•Œë ¤ì¤˜</h1><p>ë…¼ë¬¸ **&ldquo;Comet: Fine-grained Computation-communication Overlapping for Mixture-of-Experts&rdquo;**ëŠ” ê¸°ì¡´ MoE ì‹œìŠ¤í…œë“¤ê³¼ ë¹„êµí•˜ì—¬ <strong>ì„±ëŠ¥ í–¥ìƒí­ì´ ì¼ê´€ë˜ê³  í¬ë©°</strong>, ê·¸ ì›ì¸ì„ <strong>ì•„í‚¤í…ì²˜ ì°¨ì›ì˜ ì •ë°€í•œ ë³‘ë ¬ì„±ê³¼ ë¦¬ì†ŒìŠ¤ ë°°ë¶„ ì „ëµ</strong>ì—ì„œ ì°¾ìŠµë‹ˆë‹¤. ì•„ë˜ì—ì„œëŠ” Cometì´ <strong>êµ¬ì²´ì ìœ¼ë¡œ ì–´ë–¤ ì‹¤í—˜ ì¡°ê±´ì—ì„œ ì–¼ë§ˆë‚˜ ë›°ì–´ë‚œ ì„±ëŠ¥ì„ ë³´ì˜€ëŠ”ì§€</strong>, ê·¸ë¦¬ê³  <strong>ì–´ë–¤ ë©”ì»¤ë‹ˆì¦˜ì´ ì„±ëŠ¥ í–¥ìƒì„ ìœ ë„í–ˆëŠ”ì§€</strong>, ë§ˆì§€ë§‰ìœ¼ë¡œ ì´ì— ëŒ€í•œ ì œ ìƒê°ê¹Œì§€ ì¢…í•©ì ìœ¼ë¡œ ì •ë¦¬í•˜ê² ìŠµë‹ˆë‹¤.</p><hr><h2 id=-ì‹¤í—˜-ê²°ê³¼-ìš”ì•½-ìˆ˜ì¹˜ë¡œ-ë³´ëŠ”-cometì˜-ê°•ì >âœ… ì‹¤í—˜ ê²°ê³¼ ìš”ì•½: ìˆ˜ì¹˜ë¡œ ë³´ëŠ” Cometì˜ ê°•ì </h2><h3 id=1--end-to-end-ëª¨ë¸-ì„±ëŠ¥-ë¹„êµ>1. ğŸ“ˆ End-to-End ëª¨ë¸ ì„±ëŠ¥ ë¹„êµ</h3><table><thead><tr><th>ëª¨ë¸</th><th>ë¹„êµ ëŒ€ìƒ</th><th>Comet ì„±ëŠ¥ í–¥ìƒ</th></tr></thead><tbody><tr><td>Mixtral-8x7B, Qwen2-MoE, Phi-3.5-MoE</td><td>Megatron-Cutlass</td><td><strong>34.1% ê°ì†Œ</strong></td></tr><tr><td></td><td>Megatron-TE</td><td><strong>42.6% ê°ì†Œ</strong></td></tr><tr><td></td><td>FasterMoE</td><td><strong>44.4% ê°ì†Œ</strong></td></tr><tr><td></td><td>Tutel</td><td><strong>31.8% ê°ì†Œ</strong></td></tr></tbody></table><h3 id=2--ë‹¨ì¼-moe-layer-ì„±ëŠ¥>2. ğŸ” ë‹¨ì¼ MoE Layer ì„±ëŠ¥</h3><table><thead><tr><th>Input Token ìˆ˜</th><th>Comet vs. Baseline</th><th>í–¥ìƒ í­</th></tr></thead><tbody><tr><td>M = 2048~32768</td><td>Megatron-TE ì™¸ 3ì¢…</td><td><strong>1.28Ã— ~ 2.37Ã—</strong></td></tr></tbody></table><h3 id=3--í†µì‹ -overlap-íš¨ê³¼>3. ğŸ¯ í†µì‹  Overlap íš¨ê³¼</h3><table><thead><tr><th>ì‹œìŠ¤í…œ</th><th>í†µì‹  latency ì€ë‹‰ë¥ </th></tr></thead><tbody><tr><td><strong>Comet</strong></td><td><strong>86.5%</strong></td></tr><tr><td>Tutel</td><td>68.6%</td></tr><tr><td>FasterMoE</td><td>29.2%</td></tr><tr><td>Megatron ê³„ì—´</td><td>0% (overlap ì—†ìŒ)</td></tr></tbody></table><hr><h2 id=-cometì´-íŠ¹ì¶œë‚¬ë˜-ì´ìœ -ë…¼ë¬¸ì—ì„œ-ì œì‹œí•œ-ì£¼ì¥>ğŸ” Cometì´ íŠ¹ì¶œë‚¬ë˜ ì´ìœ  (ë…¼ë¬¸ì—ì„œ ì œì‹œí•œ ì£¼ì¥)</h2><h3 id=-1-fine-grained-ìˆ˜ì¤€ì—ì„œì˜-ì—°ì‚°í†µì‹ -ë³‘ë ¬í™”>ğŸ¯ 1. Fine-grained ìˆ˜ì¤€ì—ì„œì˜ ì—°ì‚°/í†µì‹  ë³‘ë ¬í™”</h3><ul><li>ê¸°ì¡´ ë°©ë²•(FasterMoE, Tutel)ì€ kernel-level ìˆ˜ì¤€ì—ì„œ coarseí•˜ê²Œ ê²¹ì¹˜ê±°ë‚˜ ìˆ˜ë™ pipeliningë§Œ ì œê³µ</li><li>â†’ Cometì€ shared tensorë¥¼ token ë‹¨ìœ„ë¡œ ë¶„í•´ í›„, tile granularityë¡œ ì—°ì‚° ì¬ìŠ¤ì¼€ì¤„</li><li>âœ… íš¨ê³¼: <strong>ì „ë¡€ ì—†ëŠ” ìˆ˜ì¤€ì˜ latency hiding</strong></li></ul><h3 id=-2-fused-kernel-ë‚´-thread-block-specialization>ğŸ¯ 2. Fused kernel ë‚´ thread block specialization</h3><ul><li>í†µì‹ ê³¼ ì—°ì‚°ì„ ë™ì¼ kernel ë‚´ thread blockìœ¼ë¡œ ì™„ì „íˆ ë¶„ë¦¬í•˜ì—¬ SM ê°„ ë¦¬ì†ŒìŠ¤ ì¶©ëŒ ë°©ì§€</li><li>âœ… íš¨ê³¼: <strong>CUDA kernel í˜¸ì¶œ ì˜¤ë²„í—¤ë“œ ì œê±° + ë™ì‹œ ì‹¤í–‰ ë³´ì¥</strong></li></ul><h3 id=-3-adaptive-workload-assignment>ğŸ¯ 3. Adaptive workload assignment</h3><ul><li>ì…ë ¥ ê¸¸ì´, expert ìˆ˜, top-k ë“± ë‹¤ì–‘í•œ ìƒí™©ì— ë”°ë¼ thread block ë¹„ìœ¨ ë™ì ìœ¼ë¡œ ì¡°ì •</li><li>âœ… íš¨ê³¼: <strong>ë‹¤ì–‘í•œ configì—ì„œ consistently ìš°ìˆ˜í•œ ì„±ëŠ¥</strong></li></ul><h3 id=-4-host-scheduling-ì œê±°>ğŸ¯ 4. Host scheduling ì œê±°</h3><ul><li>FasterMoE, Tutelì€ ì „ë¬¸ê°€ë§ˆë‹¤ kernelì„ ìƒì„±í•´ì•¼ í•´ì„œ ì‘ì€ expert ìˆ˜ì—ì„œëŠ” ì˜¤ë²„í—¤ë“œ ì‹¬ê°</li><li>Cometì€ fused kernel ë‚´ë¶€ì—ì„œ ìì²´ ìŠ¤ì¼€ì¤„ë§ ìˆ˜í–‰</li><li>âœ… íš¨ê³¼: <strong>ì‘ì€ ì…ë ¥ì—ì„œë„ ì„±ëŠ¥ ì €í•˜ ì—†ìŒ</strong></li></ul><hr><h2 id=-ë‚´-ìƒê°-cometì´-ì™œ-ì°¨ë³„ì ì¸ê°€>ğŸ§  ë‚´ ìƒê°: Cometì´ ì™œ ì°¨ë³„ì ì¸ê°€?</h2><table><thead><tr><th>ê´€ì </th><th>ê¸°ì¡´ ë°©ì‹</th><th>Comet</th></tr></thead><tbody><tr><td>ë³‘ë ¬ granularity</td><td>ì „ë¬¸ê°€ë³„/ë°°ì¹˜ë³„</td><td><strong>tile/token ë‹¨ìœ„ (fine-grained)</strong></td></tr><tr><td>í†µì‹  ì—°ì‚° í†µí•©</td><td>ë³„ë„ kernel</td><td><strong>fused kernel ë‚´ë¶€ ë³‘ë ¬ thread block</strong></td></tr><tr><td>runtime adaptiveness</td><td>ì—†ìŒ ë˜ëŠ” ê³ ì •</td><td><strong>ë™ì  thread block ì¡°ì ˆ</strong></td></tr><tr><td>ì‹¤ì§ˆì  latency ì€ë‹‰</td><td>ë¯¸í¡</td><td><strong>86% ì´ìƒ ì€ë‹‰</strong></td></tr></tbody></table><h3 id=-í•µì‹¬-í†µì°°>ğŸ“Œ í•µì‹¬ í†µì°°:</h3><p>ê¸°ì¡´ ì‹œìŠ¤í…œë“¤ì´ ë‹¨ìˆœíˆ í†µì‹  ì‹œì ì„ ë‹¹ê¸°ê±°ë‚˜ ì—°ì‚°ì„ block-wiseë¡œ ë‚˜ëˆ„ëŠ” ìˆ˜ì¤€ì— ê·¸ì³¤ë‹¤ë©´, <strong>Cometì€ CUDA kernel ì„¤ê³„ ì°¨ì›ì—ì„œ ë¬¸ì œë¥¼ ë‹¤ì‹œ ì •ì˜í•¨ìœ¼ë¡œì¨ ë³‘ëª©ì„ í•´ê²°</strong>í•¨. ì´ëŠ” ë‹¨ìˆœí•œ ê¸°ë²•ì˜ ì¡°í•©ì´ ì•„ë‹ˆë¼, **â€œì—°ì‚° ë‹¨ìœ„ì™€ í†µì‹  ë‹¨ìœ„ ê°„ granularity mismatchë¥¼ í•´ê²°í•˜ëŠ” êµ¬ì¡°ì  ì ‘ê·¼â€**ìœ¼ë¡œ ë³¼ ìˆ˜ ìˆìŒ.</p><hr><h2 id=-í–¥í›„-í™•ì¥-ê°€ëŠ¥ì„±>ğŸ’¬ í–¥í›„ í™•ì¥ ê°€ëŠ¥ì„±</h2><p>ë…¼ë¬¸ì—ì„œ ì–¸ê¸‰ëœ ê²ƒì²˜ëŸ¼, ì´ êµ¬ì¡°ëŠ” TVMì´ë‚˜ Triton ê°™ì€ ì»´íŒŒì¼ëŸ¬ ë°±ì—”ë“œë¡œ í™•ì¥ ê°€ëŠ¥í•˜ë©°, ì‹¤ì œ <strong>&ldquo;token dispatch-aware kernel fusion&rdquo;</strong> ê°™ì€ ê°œë…ì„ ë„ì…í•˜ë©´ ë” ì¼ë°˜ì ì¸ sparse ëª¨ë¸(ì˜ˆ: sparse MLP, Switch Transformer ë“±)ì—ë„ ì ìš© ê°€ëŠ¥í•¨.</p><hr><h2 id=-ìš”ì•½-ì •ë¦¬-1>âœ… ìš”ì•½ ì •ë¦¬</h2><table><thead><tr><th>í•­ëª©</th><th>ë‚´ìš©</th></tr></thead><tbody><tr><td>ì„±ëŠ¥</td><td>ìµœëŒ€ 2.37Ã— ì†ë„ í–¥ìƒ, í†µì‹  latency 86.5% ì€ë‹‰</td></tr><tr><td>êµ¬ì¡°ì  ì°¨ë³„ì </td><td>shared tensor ì¬êµ¬ì„± + fused kernel ë³‘ë ¬í™”</td></tr><tr><td>í•µì‹¬ ë©”ì»¤ë‹ˆì¦˜</td><td>fine-grained dependency resolving + adaptive thread block assignment</td></tr><tr><td>ë‚´ ê²¬í•´</td><td>ë‹¨ìˆœí•œ pipeliningì´ ì•„ë‹Œ, GPU ì»¤ë„ ìŠ¤ì¼€ì¤„ë§ì˜ êµ¬ì¡°ì  ìµœì í™”</td></tr></tbody></table><h1 id=q-ì´-ë…¼ë¬¸ì—ì„œ-ì œì‹œëœ-ë°©ë²•ì„-ìˆ˜ë„-ì½”ë“œë¡œ-ì„¤ëª…ì„-í•´ì£¼ì—ˆìœ¼ë©´í•´-êµ¬ì²´ì ì¸-ì£¼ì„ì´-ì¶”ê°€ê°€-ë˜ë©´-ì¢‹ì„ê²ƒ-ê°™ì•„>Q :ì´ ë…¼ë¬¸ì—ì„œ ì œì‹œëœ ë°©ë²•ì„ ìˆ˜ë„ ì½”ë“œë¡œ ì„¤ëª…ì„ í•´ì£¼ì—ˆìœ¼ë©´í•´ êµ¬ì²´ì ì¸ ì£¼ì„ì´ ì¶”ê°€ê°€ ë˜ë©´ ì¢‹ì„ê²ƒ ê°™ì•„</h1><p>ì•„ë˜ëŠ” <strong>Comet ë…¼ë¬¸</strong>ì˜ í•µì‹¬ ì•Œê³ ë¦¬ì¦˜ì„ ë°˜ì˜í•œ **ìˆ˜ë„ ì½”ë“œ (pseudocode)**ì…ë‹ˆë‹¤. êµ¬ì¡°ì ìœ¼ë¡œëŠ” ë‘ í•µì‹¬ êµ¬ì„±ì¸:</p><ol><li><strong>Shared Tensor ê¸°ë°˜ Dependency Resolving (ë¶„í•´ ë° ì¬ìŠ¤ì¼€ì¤„ë§)</strong></li><li><strong>Adaptive Workload Assignment (thread block ë¹„ìœ¨ ì¡°ì •)</strong></li></ol><p>ì„ ì¤‘ì‹¬ìœ¼ë¡œ êµ¬ì„±í–ˆìœ¼ë©°, GPUì˜ SM ë‹¨ìœ„ ì‹¤í–‰ì„ ì¶”ìƒí™”í•˜ì—¬ <code>launch_kernel()</code>ë¡œ í‘œí˜„í•˜ê³  CUDA ìŠ¤íƒ€ì¼ì˜ thread block ì—­í• ë„ êµ¬ì²´ì ìœ¼ë¡œ ì£¼ì„ìœ¼ë¡œ ì„¤ëª…í•©ë‹ˆë‹¤.</p><hr><h3 id=-1-ì£¼ìš”-ë°ì´í„°-êµ¬ì¡°-ì •ì˜>ğŸ“¦ 1. ì£¼ìš” ë°ì´í„° êµ¬ì¡° ì •ì˜</h3><div class="code-block-container border-border bg-card my-6 overflow-hidden rounded-xl border shadow-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:shadow-md"><div class="code-block-header bg-muted/30 border-border flex items-center justify-between border-b px-4 py-3"><div class="flex items-center gap-2"><div class="text-muted-foreground flex-shrink-0"><svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4 4 4-4 4M6 16l-4-4 4-4"/></svg></div><span class="text-muted-foreground text-sm font-medium">PYTHON</span></div><div class="flex items-center gap-2"><button class="collapse-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-2 data-default-state=expanded data-collapsed=false data-auto-collapse-lines=30 data-auto-collapse-height=400 data-collapsed-height=120 title=ì ‘ê¸° aria-label=ì ‘ê¸°>
<span class=collapse-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41 12 10.83l4.59 4.58L18 14l-6-6-6 6z"/></svg>
</span><span class="collapse-text hidden sm:inline">ì ‘ê¸°</span>
</button>
<button class="copy-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-2 title=ë³µì‚¬ aria-label=ë³µì‚¬>
<span class=copy-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/></svg>
</span><span class="copy-text hidden sm:inline">ë³µì‚¬</span></button></div></div><div class="code-block-content relative" id=code-2><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=ln>1</span><span class=cl><span class=c1># SharedTensor: í†µì‹ -ì—°ì‚° ì‚¬ì´ì˜ ê³µìœ  ë²„í¼</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=k>class</span> <span class=nc>SharedTensor</span><span class=p>:</span>
</span></span><span class=line><span class=ln>3</span><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>shape</span><span class=p>):</span>  <span class=c1># shape = (M, N)</span>
</span></span><span class=line><span class=ln>4</span><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>data</span> <span class=o>=</span> <span class=n>zeros</span><span class=p>(</span><span class=n>shape</span><span class=p>)</span>
</span></span><span class=line><span class=ln>5</span><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>lock</span> <span class=o>=</span> <span class=n>Lock</span><span class=p>()</span>  <span class=c1># fine-grained access ê´€ë¦¬ìš©</span></span></span></code></pre></div><div class="collapse-overlay to-card/90 pointer-events-none absolute inset-0 bg-gradient-to-b from-transparent via-transparent opacity-0 transition-opacity duration-300"><div class="text-muted-foreground bg-card/80 border-border/50 hover:bg-primary/10 hover:text-primary hover:border-primary/30 absolute bottom-4 left-1/2 -translate-x-1/2 cursor-pointer rounded-full border px-3 py-1.5 text-xs backdrop-blur-sm transition-all duration-200">í´ë¦­í•˜ì—¬ ë” ë³´ê¸°</div></div></div></div><script>(function(){const s="code-2",n=document.querySelector('.copy-code-btn[data-code-id="'+s+'"]'),t=document.querySelector('.collapse-code-btn[data-code-id="'+s+'"]'),e=document.getElementById(s);if(!e)return;if(n){const s=n.querySelector(".copy-icon"),t=n.querySelector(".copy-text");n.addEventListener("click",async function(){try{let o="";const i=e.querySelector(".lntd:last-child code");if(i)o=i.textContent||i.innerText;else{const t=e.querySelector("code");if(t){const e=t.querySelector(".ln");if(e){const e=t.querySelectorAll(".cl");if(e.length>0)o=Array.from(e).map(e=>{const t=e.textContent||e.innerText;return t.replace(/\n+$/,"")}).join(`
`).replace(/\n+$/,"");else{const e=t.textContent||t.innerText;o=e.replace(/^\d+/gm,"").replace(/^\s+/gm,"")}}else o=t.textContent||t.innerText}else o=e.textContent||e.innerText}o=o.trim(),await navigator.clipboard.writeText(o),s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
</svg>`,t&&(t.textContent="ë³µì‚¬ë¨"),n.classList.add("text-green-600"),setTimeout(()=>{s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
</svg>`,t&&(t.textContent="ë³µì‚¬"),n.classList.remove("text-green-600")},2e3)}catch(o){console.error("å¤åˆ¶å¤±è´¥:",o);const s=document.createRange(),i=e.querySelector("code")||e;s.selectNodeContents(i);const n=window.getSelection();n.removeAllRanges(),n.addRange(s),t&&(t.textContent="ì„ íƒë¨"),setTimeout(()=>{t&&(t.textContent="ë³µì‚¬"),n.removeAllRanges()},2e3)}})}if(t){const d=t.querySelector(".collapse-icon"),c=t.querySelector(".collapse-text"),n=e.querySelector(".collapse-overlay");let s=e.querySelector("pre.chroma");s||(s=e.querySelector("pre"));const m=t.dataset.defaultState||"expanded",f=t.dataset.collapsed==="true",u=parseInt(t.dataset.autoCollapseLines)||30,h=parseInt(t.dataset.autoCollapseHeight)||400,p=parseInt(t.dataset.collapsedHeight)||120;let l=!1;function i(){const e=f||m==="collapsed"||a();e&&o(!0,!1)}function a(){if(s){const e=s.querySelectorAll(".line, .cl"),t=s.offsetHeight;return e.length>u||t>h}const t=e.offsetHeight;if(t>h)return!0;const n=e.textContent||e.innerText||"",o=n.split(`
`).length;return o>u}function o(s,o=!0){if(!n)return;l=s,s?(e.style.maxHeight=p+"px",e.style.overflow="hidden",n.style.opacity="1",n.style.pointerEvents="auto",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
</svg>`,c&&(c.textContent="í¼ì¹˜ê¸°"),t.title="í¼ì¹˜ê¸°"):(e.style.maxHeight="",e.style.overflow="",n.style.opacity="0",n.style.pointerEvents="none",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z"/></svg>`,c&&(c.textContent="ì ‘ê¸°"),t.title="ì ‘ê¸°"),o&&(e.style.transition="max-height 0.3s ease-out",setTimeout(()=>{e.style.transition=""},300))}function r(){o(!l,!0)}t.addEventListener("click",r),n&&n.addEventListener("click",()=>{l&&o(!1,!0)}),i()}})()</script><hr><h3 id=-2-dependency-resolving-shared-tensor-ë¶„í•´--ì¬ìŠ¤ì¼€ì¤„>ğŸ”„ 2. Dependency Resolving: shared tensor ë¶„í•´ + ì¬ìŠ¤ì¼€ì¤„</h3><div class="code-block-container border-border bg-card my-6 overflow-hidden rounded-xl border shadow-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:shadow-md"><div class="code-block-header bg-muted/30 border-border flex items-center justify-between border-b px-4 py-3"><div class="flex items-center gap-2"><div class="text-muted-foreground flex-shrink-0"><svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4 4 4-4 4M6 16l-4-4 4-4"/></svg></div><span class="text-muted-foreground text-sm font-medium">PYTHON</span></div><div class="flex items-center gap-2"><button class="collapse-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-3 data-default-state=expanded data-collapsed=false data-auto-collapse-lines=30 data-auto-collapse-height=400 data-collapsed-height=120 title=ì ‘ê¸° aria-label=ì ‘ê¸°>
<span class=collapse-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41 12 10.83l4.59 4.58L18 14l-6-6-6 6z"/></svg>
</span><span class="collapse-text hidden sm:inline">ì ‘ê¸°</span>
</button>
<button class="copy-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-3 title=ë³µì‚¬ aria-label=ë³µì‚¬>
<span class=copy-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/></svg>
</span><span class="copy-text hidden sm:inline">ë³µì‚¬</span></button></div></div><div class="code-block-content relative" id=code-3><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=ln> 1</span><span class=cl><span class=k>def</span> <span class=nf>decompose_and_reschedule</span><span class=p>(</span><span class=n>shared_tensor</span><span class=p>,</span> <span class=n>layer_type</span><span class=p>):</span>
</span></span><span class=line><span class=ln> 2</span><span class=cl>    <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=ln> 3</span><span class=cl><span class=s2>    shared_tensor: í†µì‹ ê³¼ ì—°ì‚° ì‚¬ì´ì˜ ë²„í¼
</span></span></span><span class=line><span class=ln> 4</span><span class=cl><span class=s2>    layer_type: &#34;layer0&#34; or &#34;layer1&#34; (í†µì‹ -ì—°ì‚° or ì—°ì‚°-í†µì‹ )
</span></span></span><span class=line><span class=ln> 5</span><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=ln> 6</span><span class=cl>    <span class=k>if</span> <span class=n>layer_type</span> <span class=o>==</span> <span class=s2>&#34;layer0&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=ln> 7</span><span class=cl>        <span class=c1># Layer0: GEMMì´ consumer â†’ token dimension(M)ì„ ë”°ë¼ ë¶„í•´</span>
</span></span><span class=line><span class=ln> 8</span><span class=cl>        <span class=n>chunks</span> <span class=o>=</span> <span class=n>split_tensor</span><span class=p>(</span><span class=n>shared_tensor</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=s1>&#39;M&#39;</span><span class=p>,</span> <span class=n>chunk_size</span><span class=o>=</span><span class=mi>128</span><span class=p>)</span>  <span class=c1># GEMM tile ê¸°ì¤€</span>
</span></span><span class=line><span class=ln> 9</span><span class=cl>        <span class=c1># local ìš°ì„  ì‹¤í–‰ì„ ìœ„í•œ í† í° ì •ë ¬ (source GPU ê¸°ì¤€)</span>
</span></span><span class=line><span class=ln>10</span><span class=cl>        <span class=n>sorted_chunks</span> <span class=o>=</span> <span class=n>sort_by_source_rank</span><span class=p>(</span><span class=n>chunks</span><span class=p>)</span>
</span></span><span class=line><span class=ln>11</span><span class=cl>        <span class=k>return</span> <span class=n>sorted_chunks</span>
</span></span><span class=line><span class=ln>12</span><span class=cl>
</span></span><span class=line><span class=ln>13</span><span class=cl>    <span class=k>elif</span> <span class=n>layer_type</span> <span class=o>==</span> <span class=s2>&#34;layer1&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=ln>14</span><span class=cl>        <span class=c1># Layer1: Top-K Reduceê°€ consumer â†’ embedding dimension(N) ë”°ë¼ ë¶„í•´</span>
</span></span><span class=line><span class=ln>15</span><span class=cl>        <span class=n>chunks</span> <span class=o>=</span> <span class=n>split_tensor</span><span class=p>(</span><span class=n>shared_tensor</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=s1>&#39;N&#39;</span><span class=p>,</span> <span class=n>chunk_size</span><span class=o>=</span><span class=mi>128</span><span class=p>)</span>
</span></span><span class=line><span class=ln>16</span><span class=cl>        <span class=k>return</span> <span class=n>chunks</span></span></span></code></pre></div><div class="collapse-overlay to-card/90 pointer-events-none absolute inset-0 bg-gradient-to-b from-transparent via-transparent opacity-0 transition-opacity duration-300"><div class="text-muted-foreground bg-card/80 border-border/50 hover:bg-primary/10 hover:text-primary hover:border-primary/30 absolute bottom-4 left-1/2 -translate-x-1/2 cursor-pointer rounded-full border px-3 py-1.5 text-xs backdrop-blur-sm transition-all duration-200">í´ë¦­í•˜ì—¬ ë” ë³´ê¸°</div></div></div></div><script>(function(){const s="code-3",n=document.querySelector('.copy-code-btn[data-code-id="'+s+'"]'),t=document.querySelector('.collapse-code-btn[data-code-id="'+s+'"]'),e=document.getElementById(s);if(!e)return;if(n){const s=n.querySelector(".copy-icon"),t=n.querySelector(".copy-text");n.addEventListener("click",async function(){try{let o="";const i=e.querySelector(".lntd:last-child code");if(i)o=i.textContent||i.innerText;else{const t=e.querySelector("code");if(t){const e=t.querySelector(".ln");if(e){const e=t.querySelectorAll(".cl");if(e.length>0)o=Array.from(e).map(e=>{const t=e.textContent||e.innerText;return t.replace(/\n+$/,"")}).join(`
`).replace(/\n+$/,"");else{const e=t.textContent||t.innerText;o=e.replace(/^\d+/gm,"").replace(/^\s+/gm,"")}}else o=t.textContent||t.innerText}else o=e.textContent||e.innerText}o=o.trim(),await navigator.clipboard.writeText(o),s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
</svg>`,t&&(t.textContent="ë³µì‚¬ë¨"),n.classList.add("text-green-600"),setTimeout(()=>{s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
</svg>`,t&&(t.textContent="ë³µì‚¬"),n.classList.remove("text-green-600")},2e3)}catch(o){console.error("å¤åˆ¶å¤±è´¥:",o);const s=document.createRange(),i=e.querySelector("code")||e;s.selectNodeContents(i);const n=window.getSelection();n.removeAllRanges(),n.addRange(s),t&&(t.textContent="ì„ íƒë¨"),setTimeout(()=>{t&&(t.textContent="ë³µì‚¬"),n.removeAllRanges()},2e3)}})}if(t){const d=t.querySelector(".collapse-icon"),c=t.querySelector(".collapse-text"),n=e.querySelector(".collapse-overlay");let s=e.querySelector("pre.chroma");s||(s=e.querySelector("pre"));const m=t.dataset.defaultState||"expanded",f=t.dataset.collapsed==="true",u=parseInt(t.dataset.autoCollapseLines)||30,h=parseInt(t.dataset.autoCollapseHeight)||400,p=parseInt(t.dataset.collapsedHeight)||120;let l=!1;function i(){const e=f||m==="collapsed"||a();e&&o(!0,!1)}function a(){if(s){const e=s.querySelectorAll(".line, .cl"),t=s.offsetHeight;return e.length>u||t>h}const t=e.offsetHeight;if(t>h)return!0;const n=e.textContent||e.innerText||"",o=n.split(`
`).length;return o>u}function o(s,o=!0){if(!n)return;l=s,s?(e.style.maxHeight=p+"px",e.style.overflow="hidden",n.style.opacity="1",n.style.pointerEvents="auto",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
</svg>`,c&&(c.textContent="í¼ì¹˜ê¸°"),t.title="í¼ì¹˜ê¸°"):(e.style.maxHeight="",e.style.overflow="",n.style.opacity="0",n.style.pointerEvents="none",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z"/></svg>`,c&&(c.textContent="ì ‘ê¸°"),t.title="ì ‘ê¸°"),o&&(e.style.transition="max-height 0.3s ease-out",setTimeout(()=>{e.style.transition=""},300))}function r(){o(!l,!0)}t.addEventListener("click",r),n&&n.addEventListener("click",()=>{l&&o(!1,!0)}),i()}})()</script><hr><h3 id=-3-adaptive-thread-block-assignment>âš™ï¸ 3. Adaptive Thread Block Assignment</h3><div class="code-block-container border-border bg-card my-6 overflow-hidden rounded-xl border shadow-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:shadow-md"><div class="code-block-header bg-muted/30 border-border flex items-center justify-between border-b px-4 py-3"><div class="flex items-center gap-2"><div class="text-muted-foreground flex-shrink-0"><svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4 4 4-4 4M6 16l-4-4 4-4"/></svg></div><span class="text-muted-foreground text-sm font-medium">PYTHON</span></div><div class="flex items-center gap-2"><button class="collapse-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-4 data-default-state=expanded data-collapsed=false data-auto-collapse-lines=30 data-auto-collapse-height=400 data-collapsed-height=120 title=ì ‘ê¸° aria-label=ì ‘ê¸°>
<span class=collapse-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41 12 10.83l4.59 4.58L18 14l-6-6-6 6z"/></svg>
</span><span class="collapse-text hidden sm:inline">ì ‘ê¸°</span>
</button>
<button class="copy-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-4 title=ë³µì‚¬ aria-label=ë³µì‚¬>
<span class=copy-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/></svg>
</span><span class="copy-text hidden sm:inline">ë³µì‚¬</span></button></div></div><div class="code-block-content relative" id=code-4><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=ln> 1</span><span class=cl><span class=k>def</span> <span class=nf>select_optimal_thread_block_config</span><span class=p>(</span><span class=n>M</span><span class=p>,</span> <span class=n>N</span><span class=p>,</span> <span class=n>topk</span><span class=p>,</span> <span class=n>TP</span><span class=p>,</span> <span class=n>EP</span><span class=p>):</span>
</span></span><span class=line><span class=ln> 2</span><span class=cl>    <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=ln> 3</span><span class=cl><span class=s2>    ì…ë ¥ í¬ê¸° ë° ëª¨ë¸ ì„¤ì •ì— ë”°ë¼ ìµœì ì˜ thread block ë¹„ìœ¨ ì„ íƒ
</span></span></span><span class=line><span class=ln> 4</span><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=ln> 5</span><span class=cl>    <span class=n>key</span> <span class=o>=</span> <span class=p>(</span><span class=n>M</span><span class=p>,</span> <span class=n>topk</span><span class=p>,</span> <span class=n>TP</span><span class=p>,</span> <span class=n>EP</span><span class=p>)</span>
</span></span><span class=line><span class=ln> 6</span><span class=cl>    <span class=k>if</span> <span class=n>key</span> <span class=ow>in</span> <span class=n>PROFILED_CONFIG</span><span class=p>:</span>
</span></span><span class=line><span class=ln> 7</span><span class=cl>        <span class=k>return</span> <span class=n>PROFILED_CONFIG</span><span class=p>[</span><span class=n>key</span><span class=p>]</span>  <span class=c1># ì‚¬ì „ í”„ë¡œíŒŒì¼ë§ëœ ë©”íƒ€ë°ì´í„°</span>
</span></span><span class=line><span class=ln> 8</span><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=ln> 9</span><span class=cl>        <span class=c1># ê¸°ë³¸ fallback</span>
</span></span><span class=line><span class=ln>10</span><span class=cl>        <span class=n>total_blocks</span> <span class=o>=</span> <span class=mi>132</span>  <span class=c1># Hopper ê¸°ì¤€</span>
</span></span><span class=line><span class=ln>11</span><span class=cl>        <span class=n>nc</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=mf>0.2</span> <span class=o>*</span> <span class=n>total_blocks</span><span class=p>)</span>  <span class=c1># í†µì‹ ìš©</span>
</span></span><span class=line><span class=ln>12</span><span class=cl>        <span class=n>np</span> <span class=o>=</span> <span class=n>total_blocks</span> <span class=o>-</span> <span class=n>nc</span>       <span class=c1># ì—°ì‚°ìš©</span>
</span></span><span class=line><span class=ln>13</span><span class=cl>        <span class=k>return</span> <span class=n>nc</span><span class=p>,</span> <span class=n>np</span></span></span></code></pre></div><div class="collapse-overlay to-card/90 pointer-events-none absolute inset-0 bg-gradient-to-b from-transparent via-transparent opacity-0 transition-opacity duration-300"><div class="text-muted-foreground bg-card/80 border-border/50 hover:bg-primary/10 hover:text-primary hover:border-primary/30 absolute bottom-4 left-1/2 -translate-x-1/2 cursor-pointer rounded-full border px-3 py-1.5 text-xs backdrop-blur-sm transition-all duration-200">í´ë¦­í•˜ì—¬ ë” ë³´ê¸°</div></div></div></div><script>(function(){const s="code-4",n=document.querySelector('.copy-code-btn[data-code-id="'+s+'"]'),t=document.querySelector('.collapse-code-btn[data-code-id="'+s+'"]'),e=document.getElementById(s);if(!e)return;if(n){const s=n.querySelector(".copy-icon"),t=n.querySelector(".copy-text");n.addEventListener("click",async function(){try{let o="";const i=e.querySelector(".lntd:last-child code");if(i)o=i.textContent||i.innerText;else{const t=e.querySelector("code");if(t){const e=t.querySelector(".ln");if(e){const e=t.querySelectorAll(".cl");if(e.length>0)o=Array.from(e).map(e=>{const t=e.textContent||e.innerText;return t.replace(/\n+$/,"")}).join(`
`).replace(/\n+$/,"");else{const e=t.textContent||t.innerText;o=e.replace(/^\d+/gm,"").replace(/^\s+/gm,"")}}else o=t.textContent||t.innerText}else o=e.textContent||e.innerText}o=o.trim(),await navigator.clipboard.writeText(o),s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
</svg>`,t&&(t.textContent="ë³µì‚¬ë¨"),n.classList.add("text-green-600"),setTimeout(()=>{s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
</svg>`,t&&(t.textContent="ë³µì‚¬"),n.classList.remove("text-green-600")},2e3)}catch(o){console.error("å¤åˆ¶å¤±è´¥:",o);const s=document.createRange(),i=e.querySelector("code")||e;s.selectNodeContents(i);const n=window.getSelection();n.removeAllRanges(),n.addRange(s),t&&(t.textContent="ì„ íƒë¨"),setTimeout(()=>{t&&(t.textContent="ë³µì‚¬"),n.removeAllRanges()},2e3)}})}if(t){const d=t.querySelector(".collapse-icon"),c=t.querySelector(".collapse-text"),n=e.querySelector(".collapse-overlay");let s=e.querySelector("pre.chroma");s||(s=e.querySelector("pre"));const m=t.dataset.defaultState||"expanded",f=t.dataset.collapsed==="true",u=parseInt(t.dataset.autoCollapseLines)||30,h=parseInt(t.dataset.autoCollapseHeight)||400,p=parseInt(t.dataset.collapsedHeight)||120;let l=!1;function i(){const e=f||m==="collapsed"||a();e&&o(!0,!1)}function a(){if(s){const e=s.querySelectorAll(".line, .cl"),t=s.offsetHeight;return e.length>u||t>h}const t=e.offsetHeight;if(t>h)return!0;const n=e.textContent||e.innerText||"",o=n.split(`
`).length;return o>u}function o(s,o=!0){if(!n)return;l=s,s?(e.style.maxHeight=p+"px",e.style.overflow="hidden",n.style.opacity="1",n.style.pointerEvents="auto",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
</svg>`,c&&(c.textContent="í¼ì¹˜ê¸°"),t.title="í¼ì¹˜ê¸°"):(e.style.maxHeight="",e.style.overflow="",n.style.opacity="0",n.style.pointerEvents="none",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z"/></svg>`,c&&(c.textContent="ì ‘ê¸°"),t.title="ì ‘ê¸°"),o&&(e.style.transition="max-height 0.3s ease-out",setTimeout(()=>{e.style.transition=""},300))}function r(){o(!l,!0)}t.addEventListener("click",r),n&&n.addEventListener("click",()=>{l&&o(!1,!0)}),i()}})()</script><hr><h3 id=-4-fused-kernel-ì‹¤í–‰-ì»¤ë„-ë‚´ë¶€-ë™ì‘-ì¶”ìƒí™”>ğŸš€ 4. Fused Kernel ì‹¤í–‰ (ì»¤ë„ ë‚´ë¶€ ë™ì‘ ì¶”ìƒí™”)</h3><div class="code-block-container border-border bg-card my-6 overflow-hidden rounded-xl border shadow-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:shadow-md"><div class="code-block-header bg-muted/30 border-border flex items-center justify-between border-b px-4 py-3"><div class="flex items-center gap-2"><div class="text-muted-foreground flex-shrink-0"><svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4 4 4-4 4M6 16l-4-4 4-4"/></svg></div><span class="text-muted-foreground text-sm font-medium">PYTHON</span></div><div class="flex items-center gap-2"><button class="collapse-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-5 data-default-state=expanded data-collapsed=false data-auto-collapse-lines=30 data-auto-collapse-height=400 data-collapsed-height=120 title=ì ‘ê¸° aria-label=ì ‘ê¸°>
<span class=collapse-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41 12 10.83l4.59 4.58L18 14l-6-6-6 6z"/></svg>
</span><span class="collapse-text hidden sm:inline">ì ‘ê¸°</span>
</button>
<button class="copy-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-5 title=ë³µì‚¬ aria-label=ë³µì‚¬>
<span class=copy-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/></svg>
</span><span class="copy-text hidden sm:inline">ë³µì‚¬</span></button></div></div><div class="code-block-content relative" id=code-5><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=ln> 1</span><span class=cl><span class=k>def</span> <span class=nf>launch_comet_fused_kernel</span><span class=p>(</span><span class=n>shared_tensor</span><span class=p>,</span> <span class=n>layer_type</span><span class=p>,</span> <span class=n>nc</span><span class=p>,</span> <span class=n>np</span><span class=p>):</span>
</span></span><span class=line><span class=ln> 2</span><span class=cl>    <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=ln> 3</span><span class=cl><span class=s2>    í•˜ë‚˜ì˜ CUDA ì»¤ë„ ë‚´ë¶€ì—ì„œ í†µì‹  thread blockê³¼ ì—°ì‚° thread blockì„ ë™ì‹œì— ì‹¤í–‰
</span></span></span><span class=line><span class=ln> 4</span><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=ln> 5</span><span class=cl>    <span class=c1># ê° thread blockì€ ì•„ë˜ì™€ ê°™ì€ ë™ì‘ì„ í•¨</span>
</span></span><span class=line><span class=ln> 6</span><span class=cl>    <span class=n>parallel_for</span> <span class=n>block_id</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>nc</span> <span class=o>+</span> <span class=n>np</span><span class=p>):</span>
</span></span><span class=line><span class=ln> 7</span><span class=cl>
</span></span><span class=line><span class=ln> 8</span><span class=cl>        <span class=k>if</span> <span class=n>block_id</span> <span class=o>&lt;</span> <span class=n>nc</span><span class=p>:</span>
</span></span><span class=line><span class=ln> 9</span><span class=cl>            <span class=c1># ğŸ”´ í†µì‹ ìš© thread block</span>
</span></span><span class=line><span class=ln>10</span><span class=cl>            <span class=k>while</span> <span class=ow>not</span> <span class=n>all_required_chunks_ready</span><span class=p>(</span><span class=n>shared_tensor</span><span class=p>):</span>
</span></span><span class=line><span class=ln>11</span><span class=cl>                <span class=n>data</span> <span class=o>=</span> <span class=n>remote_fetch_next_token</span><span class=p>()</span>
</span></span><span class=line><span class=ln>12</span><span class=cl>                <span class=n>write_to_shared_tensor</span><span class=p>(</span><span class=n>shared_tensor</span><span class=p>,</span> <span class=n>data</span><span class=p>)</span>
</span></span><span class=line><span class=ln>13</span><span class=cl>
</span></span><span class=line><span class=ln>14</span><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=ln>15</span><span class=cl>            <span class=c1># ğŸ”µ ì—°ì‚°ìš© thread block (GEMM or Reduce)</span>
</span></span><span class=line><span class=ln>16</span><span class=cl>            <span class=n>chunks</span> <span class=o>=</span> <span class=n>get_ready_chunks</span><span class=p>(</span><span class=n>shared_tensor</span><span class=p>,</span> <span class=n>block_id</span><span class=p>)</span>
</span></span><span class=line><span class=ln>17</span><span class=cl>            <span class=k>for</span> <span class=n>chunk</span> <span class=ow>in</span> <span class=n>chunks</span><span class=p>:</span>
</span></span><span class=line><span class=ln>18</span><span class=cl>                <span class=k>if</span> <span class=n>layer_type</span> <span class=o>==</span> <span class=s2>&#34;layer0&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=ln>19</span><span class=cl>                    <span class=n>result</span> <span class=o>=</span> <span class=n>group_gemm</span><span class=p>(</span><span class=n>chunk</span><span class=p>)</span>
</span></span><span class=line><span class=ln>20</span><span class=cl>                <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=ln>21</span><span class=cl>                    <span class=n>result</span> <span class=o>=</span> <span class=n>topk_reduce_and_scatter</span><span class=p>(</span><span class=n>chunk</span><span class=p>)</span>
</span></span><span class=line><span class=ln>22</span><span class=cl>                <span class=n>write_output</span><span class=p>(</span><span class=n>result</span><span class=p>)</span></span></span></code></pre></div><div class="collapse-overlay to-card/90 pointer-events-none absolute inset-0 bg-gradient-to-b from-transparent via-transparent opacity-0 transition-opacity duration-300"><div class="text-muted-foreground bg-card/80 border-border/50 hover:bg-primary/10 hover:text-primary hover:border-primary/30 absolute bottom-4 left-1/2 -translate-x-1/2 cursor-pointer rounded-full border px-3 py-1.5 text-xs backdrop-blur-sm transition-all duration-200">í´ë¦­í•˜ì—¬ ë” ë³´ê¸°</div></div></div></div><script>(function(){const s="code-5",n=document.querySelector('.copy-code-btn[data-code-id="'+s+'"]'),t=document.querySelector('.collapse-code-btn[data-code-id="'+s+'"]'),e=document.getElementById(s);if(!e)return;if(n){const s=n.querySelector(".copy-icon"),t=n.querySelector(".copy-text");n.addEventListener("click",async function(){try{let o="";const i=e.querySelector(".lntd:last-child code");if(i)o=i.textContent||i.innerText;else{const t=e.querySelector("code");if(t){const e=t.querySelector(".ln");if(e){const e=t.querySelectorAll(".cl");if(e.length>0)o=Array.from(e).map(e=>{const t=e.textContent||e.innerText;return t.replace(/\n+$/,"")}).join(`
`).replace(/\n+$/,"");else{const e=t.textContent||t.innerText;o=e.replace(/^\d+/gm,"").replace(/^\s+/gm,"")}}else o=t.textContent||t.innerText}else o=e.textContent||e.innerText}o=o.trim(),await navigator.clipboard.writeText(o),s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
</svg>`,t&&(t.textContent="ë³µì‚¬ë¨"),n.classList.add("text-green-600"),setTimeout(()=>{s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
</svg>`,t&&(t.textContent="ë³µì‚¬"),n.classList.remove("text-green-600")},2e3)}catch(o){console.error("å¤åˆ¶å¤±è´¥:",o);const s=document.createRange(),i=e.querySelector("code")||e;s.selectNodeContents(i);const n=window.getSelection();n.removeAllRanges(),n.addRange(s),t&&(t.textContent="ì„ íƒë¨"),setTimeout(()=>{t&&(t.textContent="ë³µì‚¬"),n.removeAllRanges()},2e3)}})}if(t){const d=t.querySelector(".collapse-icon"),c=t.querySelector(".collapse-text"),n=e.querySelector(".collapse-overlay");let s=e.querySelector("pre.chroma");s||(s=e.querySelector("pre"));const m=t.dataset.defaultState||"expanded",f=t.dataset.collapsed==="true",u=parseInt(t.dataset.autoCollapseLines)||30,h=parseInt(t.dataset.autoCollapseHeight)||400,p=parseInt(t.dataset.collapsedHeight)||120;let l=!1;function i(){const e=f||m==="collapsed"||a();e&&o(!0,!1)}function a(){if(s){const e=s.querySelectorAll(".line, .cl"),t=s.offsetHeight;return e.length>u||t>h}const t=e.offsetHeight;if(t>h)return!0;const n=e.textContent||e.innerText||"",o=n.split(`
`).length;return o>u}function o(s,o=!0){if(!n)return;l=s,s?(e.style.maxHeight=p+"px",e.style.overflow="hidden",n.style.opacity="1",n.style.pointerEvents="auto",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
</svg>`,c&&(c.textContent="í¼ì¹˜ê¸°"),t.title="í¼ì¹˜ê¸°"):(e.style.maxHeight="",e.style.overflow="",n.style.opacity="0",n.style.pointerEvents="none",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z"/></svg>`,c&&(c.textContent="ì ‘ê¸°"),t.title="ì ‘ê¸°"),o&&(e.style.transition="max-height 0.3s ease-out",setTimeout(()=>{e.style.transition=""},300))}function r(){o(!l,!0)}t.addEventListener("click",r),n&&n.addEventListener("click",()=>{l&&o(!1,!0)}),i()}})()</script><hr><h3 id=-ì „ì²´-ì‹¤í–‰-íë¦„-ì •ë¦¬>ğŸ§  ì „ì²´ ì‹¤í–‰ íë¦„ ì •ë¦¬</h3><div class="code-block-container border-border bg-card my-6 overflow-hidden rounded-xl border shadow-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:shadow-md"><div class="code-block-header bg-muted/30 border-border flex items-center justify-between border-b px-4 py-3"><div class="flex items-center gap-2"><div class="text-muted-foreground flex-shrink-0"><svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4 4 4-4 4M6 16l-4-4 4-4"/></svg></div><span class="text-muted-foreground text-sm font-medium">PYTHON</span></div><div class="flex items-center gap-2"><button class="collapse-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-6 data-default-state=expanded data-collapsed=false data-auto-collapse-lines=30 data-auto-collapse-height=400 data-collapsed-height=120 title=ì ‘ê¸° aria-label=ì ‘ê¸°>
<span class=collapse-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41 12 10.83l4.59 4.58L18 14l-6-6-6 6z"/></svg>
</span><span class="collapse-text hidden sm:inline">ì ‘ê¸°</span>
</button>
<button class="copy-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-6 title=ë³µì‚¬ aria-label=ë³µì‚¬>
<span class=copy-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/></svg>
</span><span class="copy-text hidden sm:inline">ë³µì‚¬</span></button></div></div><div class="code-block-content relative" id=code-6><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=ln> 1</span><span class=cl><span class=k>def</span> <span class=nf>run_comet_pipeline</span><span class=p>(</span><span class=n>M</span><span class=p>,</span> <span class=n>N</span><span class=p>,</span> <span class=n>topk</span><span class=p>,</span> <span class=n>TP</span><span class=p>,</span> <span class=n>EP</span><span class=p>,</span> <span class=n>layer_type</span><span class=p>):</span>
</span></span><span class=line><span class=ln> 2</span><span class=cl>    <span class=c1># Step 1: Shared tensor ì¤€ë¹„</span>
</span></span><span class=line><span class=ln> 3</span><span class=cl>    <span class=n>shared_tensor</span> <span class=o>=</span> <span class=n>SharedTensor</span><span class=p>((</span><span class=n>M</span> <span class=o>*</span> <span class=n>topk</span><span class=p>,</span> <span class=n>N</span><span class=p>))</span>
</span></span><span class=line><span class=ln> 4</span><span class=cl>
</span></span><span class=line><span class=ln> 5</span><span class=cl>    <span class=c1># Step 2: Shared tensor ë¶„í•´ ë° ì¬ì •ë ¬</span>
</span></span><span class=line><span class=ln> 6</span><span class=cl>    <span class=n>chunks</span> <span class=o>=</span> <span class=n>decompose_and_reschedule</span><span class=p>(</span><span class=n>shared_tensor</span><span class=p>,</span> <span class=n>layer_type</span><span class=p>)</span>
</span></span><span class=line><span class=ln> 7</span><span class=cl>
</span></span><span class=line><span class=ln> 8</span><span class=cl>    <span class=c1># Step 3: ìµœì  thread block ìˆ˜ ê³„ì‚°</span>
</span></span><span class=line><span class=ln> 9</span><span class=cl>    <span class=n>nc</span><span class=p>,</span> <span class=n>np</span> <span class=o>=</span> <span class=n>select_optimal_thread_block_config</span><span class=p>(</span><span class=n>M</span><span class=p>,</span> <span class=n>N</span><span class=p>,</span> <span class=n>topk</span><span class=p>,</span> <span class=n>TP</span><span class=p>,</span> <span class=n>EP</span><span class=p>)</span>
</span></span><span class=line><span class=ln>10</span><span class=cl>
</span></span><span class=line><span class=ln>11</span><span class=cl>    <span class=c1># Step 4: ì»¤ë„ ì‹¤í–‰ (í†µì‹ /ì—°ì‚° ë³‘ë ¬ ìˆ˜í–‰)</span>
</span></span><span class=line><span class=ln>12</span><span class=cl>    <span class=n>launch_comet_fused_kernel</span><span class=p>(</span><span class=n>shared_tensor</span><span class=p>,</span> <span class=n>layer_type</span><span class=p>,</span> <span class=n>nc</span><span class=p>,</span> <span class=n>np</span><span class=p>)</span></span></span></code></pre></div><div class="collapse-overlay to-card/90 pointer-events-none absolute inset-0 bg-gradient-to-b from-transparent via-transparent opacity-0 transition-opacity duration-300"><div class="text-muted-foreground bg-card/80 border-border/50 hover:bg-primary/10 hover:text-primary hover:border-primary/30 absolute bottom-4 left-1/2 -translate-x-1/2 cursor-pointer rounded-full border px-3 py-1.5 text-xs backdrop-blur-sm transition-all duration-200">í´ë¦­í•˜ì—¬ ë” ë³´ê¸°</div></div></div></div><script>(function(){const s="code-6",n=document.querySelector('.copy-code-btn[data-code-id="'+s+'"]'),t=document.querySelector('.collapse-code-btn[data-code-id="'+s+'"]'),e=document.getElementById(s);if(!e)return;if(n){const s=n.querySelector(".copy-icon"),t=n.querySelector(".copy-text");n.addEventListener("click",async function(){try{let o="";const i=e.querySelector(".lntd:last-child code");if(i)o=i.textContent||i.innerText;else{const t=e.querySelector("code");if(t){const e=t.querySelector(".ln");if(e){const e=t.querySelectorAll(".cl");if(e.length>0)o=Array.from(e).map(e=>{const t=e.textContent||e.innerText;return t.replace(/\n+$/,"")}).join(`
`).replace(/\n+$/,"");else{const e=t.textContent||t.innerText;o=e.replace(/^\d+/gm,"").replace(/^\s+/gm,"")}}else o=t.textContent||t.innerText}else o=e.textContent||e.innerText}o=o.trim(),await navigator.clipboard.writeText(o),s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
</svg>`,t&&(t.textContent="ë³µì‚¬ë¨"),n.classList.add("text-green-600"),setTimeout(()=>{s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
</svg>`,t&&(t.textContent="ë³µì‚¬"),n.classList.remove("text-green-600")},2e3)}catch(o){console.error("å¤åˆ¶å¤±è´¥:",o);const s=document.createRange(),i=e.querySelector("code")||e;s.selectNodeContents(i);const n=window.getSelection();n.removeAllRanges(),n.addRange(s),t&&(t.textContent="ì„ íƒë¨"),setTimeout(()=>{t&&(t.textContent="ë³µì‚¬"),n.removeAllRanges()},2e3)}})}if(t){const d=t.querySelector(".collapse-icon"),c=t.querySelector(".collapse-text"),n=e.querySelector(".collapse-overlay");let s=e.querySelector("pre.chroma");s||(s=e.querySelector("pre"));const m=t.dataset.defaultState||"expanded",f=t.dataset.collapsed==="true",u=parseInt(t.dataset.autoCollapseLines)||30,h=parseInt(t.dataset.autoCollapseHeight)||400,p=parseInt(t.dataset.collapsedHeight)||120;let l=!1;function i(){const e=f||m==="collapsed"||a();e&&o(!0,!1)}function a(){if(s){const e=s.querySelectorAll(".line, .cl"),t=s.offsetHeight;return e.length>u||t>h}const t=e.offsetHeight;if(t>h)return!0;const n=e.textContent||e.innerText||"",o=n.split(`
`).length;return o>u}function o(s,o=!0){if(!n)return;l=s,s?(e.style.maxHeight=p+"px",e.style.overflow="hidden",n.style.opacity="1",n.style.pointerEvents="auto",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
</svg>`,c&&(c.textContent="í¼ì¹˜ê¸°"),t.title="í¼ì¹˜ê¸°"):(e.style.maxHeight="",e.style.overflow="",n.style.opacity="0",n.style.pointerEvents="none",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z"/></svg>`,c&&(c.textContent="ì ‘ê¸°"),t.title="ì ‘ê¸°"),o&&(e.style.transition="max-height 0.3s ease-out",setTimeout(()=>{e.style.transition=""},300))}function r(){o(!l,!0)}t.addEventListener("click",r),n&&n.addEventListener("click",()=>{l&&o(!1,!0)}),i()}})()</script><hr><h2 id=-ì£¼ì„-ìš”ì•½-í¬ì¸íŠ¸>âœ… ì£¼ì„ ìš”ì•½ í¬ì¸íŠ¸</h2><ul><li><code>decompose_and_reschedule()</code>ëŠ” í†µì‹ ê³¼ ì—°ì‚° ì‚¬ì´ì˜ granularity mismatchë¥¼ í•´ì†Œ</li><li><code>select_optimal_thread_block_config()</code>ëŠ” workload ë§ì¶¤í˜• thread block ë¹„ìœ¨ ì œê³µ</li><li><code>launch_comet_fused_kernel()</code>ì€ í•˜ë‚˜ì˜ fused kernelì—ì„œ <strong>thread block ë‹¨ìœ„ë¡œ ì—­í•  ë¶„ë¦¬</strong><ul><li><code>block_id &lt; nc</code>: í†µì‹  ì „ìš© thread block (NVSHMEM ê¸°ë°˜ I/O)</li><li><code>block_id >= nc</code>: ì—°ì‚° ì „ìš© thread block (CUTLASS ê¸°ë°˜ GEMM, Top-K Reduce ë“±)</li></ul></li></ul><hr><p>ì´ êµ¬ì¡°ëŠ” <strong>CUDA GPU programming abstraction</strong>ê³¼ <strong>ë…¼ë¬¸ ì„¤ê³„ íë¦„</strong>ì„ ì •í™•íˆ ëŒ€ì‘ì‹œí‚¤ë©°, í–¥í›„ Tritonì´ë‚˜ TVMìœ¼ë¡œ êµ¬í˜„ ì‹œì—ë„ ê·¸ëŒ€ë¡œ ë§µí•‘ ê°€ëŠ¥í•œ ìˆ˜ì¤€ìœ¼ë¡œ ì„¤ê³„ë˜ì—ˆìŠµë‹ˆë‹¤.</p><h1 id=q--ì´-ë…¼ë¬¸ì˜-ì…ë ¥ë°ì´í„°ì™€-ì¶”ë¡ -ê³¼ì •ì—-ëŒ€í•´ì„œ-ì˜ˆì‹œë¥¼-ë“¤ì–´-ì•„ì£¼-ìì„¸í•˜ê²Œ-ì„¤ëª…í•´-ì£¼ê² ë‹ˆ-ì¶”ê°€ì ìœ¼ë¡œ-ëª¨ë¸ì•„í‚¤í…ì²˜ì˜-êµ¬ì„±-ë°-ëª¨ë¸ì„-êµ¬ì„±í•˜ëŠ”-ì—°ì‚°ê³¼-ë©”ëª¨ë¦¬-ìš”êµ¬ëŸ‰-ì»´í“¨íŒ…-ìš”êµ¬ëŸ‰-ëŒ€í•´ì„œë„-ì„¤ëª…í•´ì¤˜>Q : ì´ ë…¼ë¬¸ì˜ ì…ë ¥ë°ì´í„°ì™€ ì¶”ë¡  ê³¼ì •ì— ëŒ€í•´ì„œ ì˜ˆì‹œë¥¼ ë“¤ì–´ ì•„ì£¼ ìì„¸í•˜ê²Œ ì„¤ëª…í•´ ì£¼ê² ë‹ˆ? ì¶”ê°€ì ìœ¼ë¡œ ëª¨ë¸ì•„í‚¤í…ì²˜ì˜ êµ¬ì„± ë° ëª¨ë¸ì„ êµ¬ì„±í•˜ëŠ” ì—°ì‚°ê³¼ ë©”ëª¨ë¦¬ ìš”êµ¬ëŸ‰ ì»´í“¨íŒ… ìš”êµ¬ëŸ‰ ëŒ€í•´ì„œë„ ì„¤ëª…í•´ì¤˜</h1><p>ì¢‹ìŠµë‹ˆë‹¤. ì´ ë…¼ë¬¸ì¸ <strong>Comet</strong>ì€ Mixture-of-Experts (MoE) ê¸°ë°˜ ëŒ€í˜• ëª¨ë¸ì—ì„œì˜ <strong>ì¶”ë¡ (inference)</strong> ë˜ëŠ” <strong>í•™ìŠµ ê³¼ì •ì—ì„œ ë°œìƒí•˜ëŠ” GPU ê°„ í†µì‹  ë³‘ëª©ì„ í•´ì†Œ</strong>í•˜ê¸° ìœ„í•œ ì‹œìŠ¤í…œì  ìµœì í™”ë¥¼ ë‹¤ë£¹ë‹ˆë‹¤. ì§ˆë¬¸í•˜ì‹  ë‚´ìš©ì„ ê¸°ì¤€ìœ¼ë¡œ ë‹¤ìŒê³¼ ê°™ì´ ì„¤ëª…í•˜ê² ìŠµë‹ˆë‹¤:</p><hr><h2 id=1--ì˜ˆì‹œ-ê¸°ë°˜-ì…ë ¥-ë°ì´í„°ì™€-ì¶”ë¡ -ê³¼ì •>1. ğŸ“¥ ì˜ˆì‹œ ê¸°ë°˜ ì…ë ¥ ë°ì´í„°ì™€ ì¶”ë¡  ê³¼ì •</h2><h3 id=-ì˜ˆì‹œ-mixtral-8x7b-ëª¨ë¸-ê¸°ì¤€-ë…¼ë¬¸-ì‹¤í—˜-ëŒ€ìƒ>ğŸ“Œ ì˜ˆì‹œ: Mixtral-8x7B ëª¨ë¸ ê¸°ì¤€ (ë…¼ë¬¸ ì‹¤í—˜ ëŒ€ìƒ)</h3><table><thead><tr><th>í•­ëª©</th><th>ê°’</th></tr></thead><tbody><tr><td>Input token ìˆ˜ ( M )</td><td>8192</td></tr><tr><td>Embedding dimension ( N )</td><td>4096</td></tr><tr><td>Hidden size ( K )</td><td>14336</td></tr><tr><td>Expert ìˆ˜ ( E )</td><td>8</td></tr><tr><td>Top-k routing</td><td>2 (ê° tokenì€ 2ê°œì˜ expertì— ì „ë‹¬)</td></tr></tbody></table><hr><h3 id=-ì¶”ë¡ -ì „ì²˜ë¦¬-ë°-ë¼ìš°íŒ…-token-routing>ğŸ” ì¶”ë¡  ì „ì²˜ë¦¬ ë° ë¼ìš°íŒ… (Token Routing)</h3><ol><li><strong>Input</strong>: 8192 tokens â†’ [8192, 4096] í¬ê¸°ì˜ ì…ë ¥ í…ì„œ</li><li><strong>Gating</strong>:<ul><li>ê° tokenì€ top-2 expertë¡œ ë¼ìš°íŒ…ë¨ â†’ ì´ 16384ê°œ tokenì´ expertì— ì „ë‹¬ë¨</li><li>ì‹¤ì œ routingì€ gate ë„¤íŠ¸ì›Œí¬(ì‘ì€ MLP)ê°€ softmax í›„ top-2 ì„ íƒ</li></ul></li><li><strong>All-to-All í†µì‹ </strong>:<ul><li>ExpertëŠ” ì—¬ëŸ¬ GPUì— ë¶„ì‚°ë˜ì–´ ìˆìŒ â†’ ê° GPUëŠ” ìì‹ ì—ê²Œ ë¼ìš°íŒ…ëœ tokenë§Œ ë°›ìŒ</li></ul></li></ol><hr><h3 id=-expert-computation-moe-layer-0>ğŸ§  Expert Computation (MoE Layer 0)</h3><p>ê° expertëŠ” ì¼ë°˜ì ì¸ FFN êµ¬ì¡°:</p><div class="code-block-container border-border bg-card my-6 overflow-hidden rounded-xl border shadow-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:shadow-md"><div class="code-block-header bg-muted/30 border-border flex items-center justify-between border-b px-4 py-3"><div class="flex items-center gap-2"><div class="text-muted-foreground flex-shrink-0"><svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4 4 4-4 4M6 16l-4-4 4-4"/></svg></div><span class="text-muted-foreground text-sm font-medium">TEXT</span></div><div class="flex items-center gap-2"><button class="collapse-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-7 data-default-state=expanded data-collapsed=false data-auto-collapse-lines=30 data-auto-collapse-height=400 data-collapsed-height=120 title=ì ‘ê¸° aria-label=ì ‘ê¸°>
<span class=collapse-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41 12 10.83l4.59 4.58L18 14l-6-6-6 6z"/></svg>
</span><span class="collapse-text hidden sm:inline">ì ‘ê¸°</span>
</button>
<button class="copy-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-7 title=ë³µì‚¬ aria-label=ë³µì‚¬>
<span class=copy-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/></svg>
</span><span class="copy-text hidden sm:inline">ë³µì‚¬</span></button></div></div><div class="code-block-content relative" id=code-7><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln>1</span><span class=cl>GEMM1: [token, 4096] Ã— [4096, 14336] â†’ [token, 14336]
</span></span><span class=line><span class=ln>2</span><span class=cl>Activation: GELU or ReLU
</span></span><span class=line><span class=ln>3</span><span class=cl>GEMM2: [token, 14336] Ã— [14336, 4096] â†’ [token, 4096]</span></span></code></pre></div><div class="collapse-overlay to-card/90 pointer-events-none absolute inset-0 bg-gradient-to-b from-transparent via-transparent opacity-0 transition-opacity duration-300"><div class="text-muted-foreground bg-card/80 border-border/50 hover:bg-primary/10 hover:text-primary hover:border-primary/30 absolute bottom-4 left-1/2 -translate-x-1/2 cursor-pointer rounded-full border px-3 py-1.5 text-xs backdrop-blur-sm transition-all duration-200">í´ë¦­í•˜ì—¬ ë” ë³´ê¸°</div></div></div></div><script>(function(){const s="code-7",n=document.querySelector('.copy-code-btn[data-code-id="'+s+'"]'),t=document.querySelector('.collapse-code-btn[data-code-id="'+s+'"]'),e=document.getElementById(s);if(!e)return;if(n){const s=n.querySelector(".copy-icon"),t=n.querySelector(".copy-text");n.addEventListener("click",async function(){try{let o="";const i=e.querySelector(".lntd:last-child code");if(i)o=i.textContent||i.innerText;else{const t=e.querySelector("code");if(t){const e=t.querySelector(".ln");if(e){const e=t.querySelectorAll(".cl");if(e.length>0)o=Array.from(e).map(e=>{const t=e.textContent||e.innerText;return t.replace(/\n+$/,"")}).join(`
`).replace(/\n+$/,"");else{const e=t.textContent||t.innerText;o=e.replace(/^\d+/gm,"").replace(/^\s+/gm,"")}}else o=t.textContent||t.innerText}else o=e.textContent||e.innerText}o=o.trim(),await navigator.clipboard.writeText(o),s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
</svg>`,t&&(t.textContent="ë³µì‚¬ë¨"),n.classList.add("text-green-600"),setTimeout(()=>{s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
</svg>`,t&&(t.textContent="ë³µì‚¬"),n.classList.remove("text-green-600")},2e3)}catch(o){console.error("å¤åˆ¶å¤±è´¥:",o);const s=document.createRange(),i=e.querySelector("code")||e;s.selectNodeContents(i);const n=window.getSelection();n.removeAllRanges(),n.addRange(s),t&&(t.textContent="ì„ íƒë¨"),setTimeout(()=>{t&&(t.textContent="ë³µì‚¬"),n.removeAllRanges()},2e3)}})}if(t){const d=t.querySelector(".collapse-icon"),c=t.querySelector(".collapse-text"),n=e.querySelector(".collapse-overlay");let s=e.querySelector("pre.chroma");s||(s=e.querySelector("pre"));const m=t.dataset.defaultState||"expanded",f=t.dataset.collapsed==="true",u=parseInt(t.dataset.autoCollapseLines)||30,h=parseInt(t.dataset.autoCollapseHeight)||400,p=parseInt(t.dataset.collapsedHeight)||120;let l=!1;function i(){const e=f||m==="collapsed"||a();e&&o(!0,!1)}function a(){if(s){const e=s.querySelectorAll(".line, .cl"),t=s.offsetHeight;return e.length>u||t>h}const t=e.offsetHeight;if(t>h)return!0;const n=e.textContent||e.innerText||"",o=n.split(`
`).length;return o>u}function o(s,o=!0){if(!n)return;l=s,s?(e.style.maxHeight=p+"px",e.style.overflow="hidden",n.style.opacity="1",n.style.pointerEvents="auto",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
</svg>`,c&&(c.textContent="í¼ì¹˜ê¸°"),t.title="í¼ì¹˜ê¸°"):(e.style.maxHeight="",e.style.overflow="",n.style.opacity="0",n.style.pointerEvents="none",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z"/></svg>`,c&&(c.textContent="ì ‘ê¸°"),t.title="ì ‘ê¸°"),o&&(e.style.transition="max-height 0.3s ease-out",setTimeout(()=>{e.style.transition=""},300))}function r(){o(!l,!0)}t.addEventListener("click",r),n&&n.addEventListener("click",()=>{l&&o(!1,!0)}),i()}})()</script><ul><li><code>token</code>ì€ GPUë³„ë¡œ ë¶„ì‚°ë¨ (e.g., GPU0ì€ 3000ê°œ, GPU1ì€ 1500ê°œ ë“±)</li><li>ì´ ì—°ì‚°ì€ ëª¨ë“  expertì— ëŒ€í•´ ë³‘ë ¬ì ìœ¼ë¡œ ìˆ˜í–‰ë¨ (Grouped GEMM)</li></ul><hr><h3 id=-ê²°ê³¼-ë³‘í•©-moe-layer-1>ğŸ“¤ ê²°ê³¼ ë³‘í•© (MoE Layer 1)</h3><ul><li>ê° expertì˜ ì¶œë ¥ì€ ë‹¤ì‹œ All-to-Allë¡œ ì „ì†¡ë˜ì–´ ì›ë˜ token ìœ„ì¹˜ë¡œ ê²°í•©ë¨</li><li>Top-k reduction ìˆ˜í–‰:<ul><li>ê° tokenì˜ ë‘ expert ì¶œë ¥ â†’ gating score ê¸°ë°˜ weighted sum</li><li>ìµœì¢… output shape: [8192, 4096]</li></ul></li></ul><hr><h2 id=2--ëª¨ë¸-ì•„í‚¤í…ì²˜-êµ¬ì„±-comet-ê´€ì >2. ğŸ—ï¸ ëª¨ë¸ ì•„í‚¤í…ì²˜ êµ¬ì„± (Comet ê´€ì )</h2><h3 id=ì „ì²´-êµ¬ì¡°-1-transformer-block-ê¸°ì¤€>ì „ì²´ êµ¬ì¡° (1 Transformer block ê¸°ì¤€)</h3><div class="code-block-container border-border bg-card my-6 overflow-hidden rounded-xl border shadow-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:shadow-md"><div class="code-block-header bg-muted/30 border-border flex items-center justify-between border-b px-4 py-3"><div class="flex items-center gap-2"><div class="text-muted-foreground flex-shrink-0"><svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4 4 4-4 4M6 16l-4-4 4-4"/></svg></div><span class="text-muted-foreground text-sm font-medium">TEXT</span></div><div class="flex items-center gap-2"><button class="collapse-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-8 data-default-state=expanded data-collapsed=false data-auto-collapse-lines=30 data-auto-collapse-height=400 data-collapsed-height=120 title=ì ‘ê¸° aria-label=ì ‘ê¸°>
<span class=collapse-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41 12 10.83l4.59 4.58L18 14l-6-6-6 6z"/></svg>
</span><span class="collapse-text hidden sm:inline">ì ‘ê¸°</span>
</button>
<button class="copy-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-8 title=ë³µì‚¬ aria-label=ë³µì‚¬>
<span class=copy-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/></svg>
</span><span class="copy-text hidden sm:inline">ë³µì‚¬</span></button></div></div><div class="code-block-content relative" id=code-8><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln> 1</span><span class=cl>Input Embedding
</span></span><span class=line><span class=ln> 2</span><span class=cl>   â†“
</span></span><span class=line><span class=ln> 3</span><span class=cl>Multi-Head Self Attention
</span></span><span class=line><span class=ln> 4</span><span class=cl>   â†“
</span></span><span class=line><span class=ln> 5</span><span class=cl>LayerNorm
</span></span><span class=line><span class=ln> 6</span><span class=cl>   â†“
</span></span><span class=line><span class=ln> 7</span><span class=cl>MoE Layer
</span></span><span class=line><span class=ln> 8</span><span class=cl>  â”œâ”€ Dispatch (token â†’ expert)
</span></span><span class=line><span class=ln> 9</span><span class=cl>  â”œâ”€ Expert FFNs (GEMM1 + Activation + GEMM2)
</span></span><span class=line><span class=ln>10</span><span class=cl>  â””â”€ Combine (Top-k reduction)
</span></span><span class=line><span class=ln>11</span><span class=cl>   â†“
</span></span><span class=line><span class=ln>12</span><span class=cl>LayerNorm
</span></span><span class=line><span class=ln>13</span><span class=cl>   â†“
</span></span><span class=line><span class=ln>14</span><span class=cl>Output</span></span></code></pre></div><div class="collapse-overlay to-card/90 pointer-events-none absolute inset-0 bg-gradient-to-b from-transparent via-transparent opacity-0 transition-opacity duration-300"><div class="text-muted-foreground bg-card/80 border-border/50 hover:bg-primary/10 hover:text-primary hover:border-primary/30 absolute bottom-4 left-1/2 -translate-x-1/2 cursor-pointer rounded-full border px-3 py-1.5 text-xs backdrop-blur-sm transition-all duration-200">í´ë¦­í•˜ì—¬ ë” ë³´ê¸°</div></div></div></div><script>(function(){const s="code-8",n=document.querySelector('.copy-code-btn[data-code-id="'+s+'"]'),t=document.querySelector('.collapse-code-btn[data-code-id="'+s+'"]'),e=document.getElementById(s);if(!e)return;if(n){const s=n.querySelector(".copy-icon"),t=n.querySelector(".copy-text");n.addEventListener("click",async function(){try{let o="";const i=e.querySelector(".lntd:last-child code");if(i)o=i.textContent||i.innerText;else{const t=e.querySelector("code");if(t){const e=t.querySelector(".ln");if(e){const e=t.querySelectorAll(".cl");if(e.length>0)o=Array.from(e).map(e=>{const t=e.textContent||e.innerText;return t.replace(/\n+$/,"")}).join(`
`).replace(/\n+$/,"");else{const e=t.textContent||t.innerText;o=e.replace(/^\d+/gm,"").replace(/^\s+/gm,"")}}else o=t.textContent||t.innerText}else o=e.textContent||e.innerText}o=o.trim(),await navigator.clipboard.writeText(o),s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
</svg>`,t&&(t.textContent="ë³µì‚¬ë¨"),n.classList.add("text-green-600"),setTimeout(()=>{s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
</svg>`,t&&(t.textContent="ë³µì‚¬"),n.classList.remove("text-green-600")},2e3)}catch(o){console.error("å¤åˆ¶å¤±è´¥:",o);const s=document.createRange(),i=e.querySelector("code")||e;s.selectNodeContents(i);const n=window.getSelection();n.removeAllRanges(),n.addRange(s),t&&(t.textContent="ì„ íƒë¨"),setTimeout(()=>{t&&(t.textContent="ë³µì‚¬"),n.removeAllRanges()},2e3)}})}if(t){const d=t.querySelector(".collapse-icon"),c=t.querySelector(".collapse-text"),n=e.querySelector(".collapse-overlay");let s=e.querySelector("pre.chroma");s||(s=e.querySelector("pre"));const m=t.dataset.defaultState||"expanded",f=t.dataset.collapsed==="true",u=parseInt(t.dataset.autoCollapseLines)||30,h=parseInt(t.dataset.autoCollapseHeight)||400,p=parseInt(t.dataset.collapsedHeight)||120;let l=!1;function i(){const e=f||m==="collapsed"||a();e&&o(!0,!1)}function a(){if(s){const e=s.querySelectorAll(".line, .cl"),t=s.offsetHeight;return e.length>u||t>h}const t=e.offsetHeight;if(t>h)return!0;const n=e.textContent||e.innerText||"",o=n.split(`
`).length;return o>u}function o(s,o=!0){if(!n)return;l=s,s?(e.style.maxHeight=p+"px",e.style.overflow="hidden",n.style.opacity="1",n.style.pointerEvents="auto",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
</svg>`,c&&(c.textContent="í¼ì¹˜ê¸°"),t.title="í¼ì¹˜ê¸°"):(e.style.maxHeight="",e.style.overflow="",n.style.opacity="0",n.style.pointerEvents="none",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z"/></svg>`,c&&(c.textContent="ì ‘ê¸°"),t.title="ì ‘ê¸°"),o&&(e.style.transition="max-height 0.3s ease-out",setTimeout(()=>{e.style.transition=""},300))}function r(){o(!l,!0)}t.addEventListener("click",r),n&&n.addEventListener("click",()=>{l&&o(!1,!0)}),i()}})()</script><blockquote class="border-primary bg-muted/30 hover:bg-muted/40 my-6 rounded-r-lg border-l-4 py-4 pr-4 pl-6 italic transition-all duration-200 ease-out hover:translate-x-1"><div class="prose prose-sm max-w-none"><p>ì´ ì¤‘ Cometì€ <strong>MoE Layerì—ë§Œ ì§‘ì¤‘</strong>í•˜ì—¬ í†µì‹ -ì—°ì‚° ë³‘ë ¬í™”ë¥¼ ìˆ˜í–‰í•©ë‹ˆë‹¤.</p></div></blockquote><hr><h2 id=3--ì—°ì‚°ëŸ‰computational-cost-ë¶„ì„>3. ğŸ“Š ì—°ì‚°ëŸ‰(Computational Cost) ë¶„ì„</h2><h3 id=-moe-layer-ê¸°ì¤€-í•œ-expertì˜-ffn>âœ… MoE Layer ê¸°ì¤€: í•œ expertì˜ FFN</h3><table><thead><tr><th>ì—°ì‚°</th><th>í˜•íƒœ</th><th>FLOPs ê³„ì‚°</th></tr></thead><tbody><tr><td>GEMM1</td><td>[T, 4096] Ã— [4096, 14336]</td><td>( 2 \times T \times 4096 \times 14336 )</td></tr><tr><td>GELU</td><td>[T, 14336]</td><td>ì•½ ( 10 \times T \times 14336 )</td></tr><tr><td>GEMM2</td><td>[T, 14336] Ã— [14336, 4096]</td><td>( 2 \times T \times 14336 \times 4096 )</td></tr><tr><td><strong>í•©ê³„</strong></td><td></td><td>ì•½ ( 2 \times T \times 4096 \times 14336 \times 2 ) FLOPs</td></tr></tbody></table><ul><li>( T ): í•´ë‹¹ expertì— ë¼ìš°íŒ…ëœ token ìˆ˜</li><li>ì˜ˆ: GPUë‹¹ í‰ê·  T = 2048ì´ë©´, ì•½ 480 GFLOPs per expert</li></ul><hr><h2 id=4--ë©”ëª¨ë¦¬-ìš”êµ¬ëŸ‰>4. ğŸ§  ë©”ëª¨ë¦¬ ìš”êµ¬ëŸ‰</h2><h3 id=shared-tensor-í¬ê¸°>Shared Tensor í¬ê¸°</h3><blockquote class="border-primary bg-muted/30 hover:bg-muted/40 my-6 rounded-r-lg border-l-4 py-4 pr-4 pl-6 italic transition-all duration-200 ease-out hover:translate-x-1"><div class="prose prose-sm max-w-none"><p>shared tensorëŠ” GEMM ì…ë ¥/ì¶œë ¥ ë° í†µì‹ ì„ ìœ„í•œ ë²„í¼ì…ë‹ˆë‹¤.</p></div></blockquote><ul><li>MoE Layer0: ( M \times \text{topk} \times N )<ul><li>ì˜ˆ: ( 8192 \times 2 \times 4096 \times 2 ) Bytes (BF16) â‰ˆ <strong>128MB</strong></li></ul></li><li>MoE Layer1: GEMM ì¶œë ¥ í›„ reduce ëŒ€ìƒ â†’ ë™ì¼ í¬ê¸°</li></ul><p><strong>â†’ ì´ ì•½ 256MBì˜ ë²„í¼ í•„ìš”</strong>, ì´ëŠ” <strong>NVSHMEMì„ í†µí•´ ëª¨ë“  GPUì—ì„œ ê³µìœ ë¨</strong></p><hr><h2 id=5--cometì—ì„œì˜-ìµœì í™”-ìš”ì†Œ-ë°˜ì˜>5. ğŸ§© Cometì—ì„œì˜ ìµœì í™” ìš”ì†Œ ë°˜ì˜</h2><table><thead><tr><th>ì²˜ë¦¬ ë‹¨ê³„</th><th>Cometì—ì„œì˜ ìµœì í™” ë°©ë²•</th><th>íš¨ê³¼</th></tr></thead><tbody><tr><td>Dispatch</td><td>Shared Tensor ê¸°ë°˜ M ë°©í–¥ ë¶„í•´ + í† í° ì¬ë°°ì¹˜</td><td>í†µì‹  ì‹œì‘ê³¼ ì—°ì‚° ë³‘ë ¬í™” ê°€ëŠ¥</td></tr><tr><td>GEMM ì‹¤í–‰</td><td>GroupGEMM â†’ tile ìš°ì„ ìˆœìœ„ ì¬ìŠ¤ì¼€ì¤„</td><td>local token tile ìš°ì„  ì‹¤í–‰ìœ¼ë¡œ overlap ì¦ê°€</td></tr><tr><td>Combine</td><td>N ë°©í–¥ ë¶„í•´ â†’ column-wise GEMM ì²˜ë¦¬</td><td>ì—°ì‚° ì¼ë¶€ ëë‚˜ìë§ˆì í†µì‹  ê°€ëŠ¥</td></tr><tr><td>í†µì‹  & ì—°ì‚°</td><td>í†µì‹ /ì—°ì‚° thread block ë¶„ë¦¬ (fused kernel)</td><td>CUDA scheduling ì˜¤ë²„í—¤ë“œ ì œê±°</td></tr></tbody></table><hr><h2 id=-ì •ë¦¬-ìš”ì•½>âœ… ì •ë¦¬ ìš”ì•½</h2><table><thead><tr><th>í•­ëª©</th><th>ë‚´ìš©</th></tr></thead><tbody><tr><td>ì…ë ¥ ë°ì´í„°</td><td>[8192, 4096] token embedding</td></tr><tr><td>ë¼ìš°íŒ… ë°©ì‹</td><td>top-2 expert routing (gate ê¸°ë°˜)</td></tr><tr><td>ì£¼ìš” ì—°ì‚°</td><td>GEMM1 + Activation + GEMM2 + Top-k Combine</td></tr><tr><td>FLOPs</td><td>ì•½ 2.4 TFLOPs (ëª¨ë“  expert ì²˜ë¦¬ ì‹œ)</td></tr><tr><td>ë©”ëª¨ë¦¬ ìš”êµ¬ëŸ‰</td><td>Shared Tensor 256MB (BF16 ê¸°ì¤€)</td></tr><tr><td>Comet íš¨ê³¼</td><td>í†µì‹ -ì—°ì‚° fine-grained overlap + ì»¤ë„ ë‚´ ìŠ¤ì¼€ì¤„ë§ìœ¼ë¡œ 1.7Ã—~2Ã— ì†ë„ í–¥ìƒ</td></tr></tbody></table><h1 id=q--ì´-ë…¼ë¬¸ì˜-í•œê³„ë¥¼-ê·¹ë³µí•˜ê¸°-ìœ„í•œ-ë°©ë²•ìœ¼ë¡œ-ì–´ë–¤-ì—°êµ¬íë¦„ì´-ìˆëŠ”ì§€-ì •ë¦¬í•´ì„œ-ìì„¸í•˜ê²Œ-ì„¤ëª…í•´-ì¤˜>Q : ì´ ë…¼ë¬¸ì˜ í•œê³„ë¥¼ ê·¹ë³µí•˜ê¸° ìœ„í•œ ë°©ë²•ìœ¼ë¡œ ì–´ë–¤ ì—°êµ¬íë¦„ì´ ìˆëŠ”ì§€ ì •ë¦¬í•´ì„œ ìì„¸í•˜ê²Œ ì„¤ëª…í•´ ì¤˜</h1><p>ì¢‹ìŠµë‹ˆë‹¤. ì´ ë…¼ë¬¸ <strong>Comet</strong>ì€ Mixture-of-Experts(MoE) êµ¬ì¡°ì—ì„œ <strong>fine-grained ìˆ˜ì¤€ì˜ í†µì‹ -ì—°ì‚° overlap</strong>ì„ êµ¬í˜„í•˜ì—¬ ê¸°ì¡´ ë°©ë²•ì˜ coarse-grained pipelining í•œê³„ë¥¼ ê·¹ë³µí–ˆìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ, ì—¬ì „íˆ ëª‡ ê°€ì§€ <strong>êµ¬ì¡°ì , ì‹œìŠ¤í…œì  í•œê³„</strong>ê°€ ì¡´ì¬í•˜ë©°, ì´ëŸ¬í•œ í•œê³„ë¥¼ ê·¹ë³µí•˜ë ¤ëŠ” ì—°êµ¬ë“¤ì€ ë‹¤ì–‘í•œ ë°©í–¥ìœ¼ë¡œ ë°œì „í•˜ê³  ìˆìŠµë‹ˆë‹¤.</p><hr><h2 id=-cometì˜-ì£¼ìš”-í•œê³„-ìš”ì•½>âœ… Cometì˜ ì£¼ìš” í•œê³„ ìš”ì•½</h2><table><thead><tr><th>ë²”ì£¼</th><th>í•œê³„ì </th><th>ì„¤ëª…</th></tr></thead><tbody><tr><td><strong>1. í†µì‹  ë¼ì´ë¸ŒëŸ¬ë¦¬ ì¢…ì†ì„±</strong></td><td>NVSHMEM</td><td>ë‚®ì€ ìˆ˜ì¤€ì˜ GPU ì§ì ‘í†µì‹  APIë¡œ, í”Œë«í¼ ë…ë¦½ì„±/ìœ ì§€ë³´ìˆ˜ ì–´ë ¤ì›€</td></tr><tr><td><strong>2. ì»´íŒŒì¼ëŸ¬ ìµœì í™” ë¶€ì¬</strong></td><td>ìˆ˜ì‘ì—… ì»¤ë„ íŠœë‹</td><td>ì»´íŒŒì¼ëŸ¬ ê¸°ë°˜ì˜ ìë™í™”ëœ tile ë¶„í•´/ìŠ¤ì¼€ì¤„ë§ì´ ì—†ìŒ</td></tr><tr><td><strong>3. attention ë“± íƒ€ ì—°ì‚°ê³¼ì˜ í†µí•© ë¶€ì¬</strong></td><td>ë²”ìš©ì„± ì œí•œ</td><td>MoE ì—°ì‚° ì™¸ì˜ dense blockì— ëŒ€í•œ latency overlapì€ ê³ ë ¤ë˜ì§€ ì•ŠìŒ</td></tr><tr><td><strong>4. ì‹¤í–‰ ì „ profiling í•„ìš”</strong></td><td>static optimal block config</td><td>ì…ë ¥/í•˜ë“œì›¨ì–´ê°€ ë‹¬ë¼ì§€ë©´ profiling ì¬í•„ìš” â†’ ì‹¤ì‹œê°„ ì ì‘ ì–´ë ¤ì›€</td></tr></tbody></table><hr><h2 id=-í•œê³„-ê·¹ë³µì„-ìœ„í•œ-ì—°êµ¬-íë¦„ë³„-ì •ë¦¬>ğŸ” í•œê³„ ê·¹ë³µì„ ìœ„í•œ ì—°êµ¬ íë¦„ë³„ ì •ë¦¬</h2><h3 id=-1-ì»´íŒŒì¼ëŸ¬-ê¸°ë°˜-ìë™í™”-tvm-triton-unity>ğŸ§  [1] ì»´íŒŒì¼ëŸ¬ ê¸°ë°˜ ìë™í™”: TVM, Triton, Unity</h3><table><thead><tr><th>ì ‘ê·¼ë²•</th><th>ì„¤ëª…</th></tr></thead><tbody><tr><td><strong>Triton-based Fused MoE Kernels</strong></td><td>ì—°ì‚°ì fusion + ë©”ëª¨ë¦¬ ê´€ë¦¬ ìë™í™”</td></tr><tr><td><strong>TVM</strong></td><td>dependency-aware scheduling + cost model ê¸°ë°˜ autotuning</td></tr><tr><td><strong>Unity</strong> (Meta, 2024)</td><td>ëª¨ë¸ í‘œí˜„-ì»´íŒŒì¼-ìŠ¤ì¼€ì¤„ë§ ì „ì²´ ìë™í™” íŒŒì´í”„ë¼ì¸ êµ¬ì¶•</td></tr></tbody></table><p><strong>í•µì‹¬ ê¸°ì—¬</strong>:<br>Cometì˜ shared tensor ë¶„ì„ ë° reschedule ê³¼ì •ì„ <strong>ìë™ìœ¼ë¡œ ì¶”ë¡  ë° ì»¤ë„ ìƒì„±</strong><br>â†’ ì‚¬ëŒì´ hand-tuneí•œ ì»¤ë„ë³´ë‹¤ ë” íš¨ìœ¨ì ì¸ layout & scheduleì„ ì œì•ˆ ê°€ëŠ¥</p><p>ğŸ”— ëŒ€í‘œ ì—°êµ¬:</p><ul><li><strong>Unity: AI compiler for unified model optimization</strong> (Meta, 2024)</li><li><strong>TrMoE: Triton-based sparse expert execution</strong> (ICLR 2025 under review)</li></ul><hr><h3 id=-2-ë„¤íŠ¸ì›Œí¬í† í´ë¡œì§€-ìµœì í™”-hierarchical-all-to-all--topology-aware-scheduling>ğŸŒ [2] ë„¤íŠ¸ì›Œí¬/í† í´ë¡œì§€ ìµœì í™”: Hierarchical All-to-All & Topology-aware Scheduling</h3><table><thead><tr><th>ì ‘ê·¼ë²•</th><th>ì„¤ëª…</th></tr></thead><tbody><tr><td><strong>2D Hierarchical All-to-All</strong></td><td>intra-node / inter-node ë¶„ë¦¬ í›„ íš¨ìœ¨ì  í†µì‹ </td></tr><tr><td><strong>Topology-aware token dispatch</strong></td><td>bandwidthì— ë”°ë¼ routing ìµœì í™” (Hotspot ë°©ì§€)</td></tr></tbody></table><p><strong>í•µì‹¬ ê¸°ì—¬</strong>:<br>NVSHMEMì„ ì‚¬ìš©í•˜ëŠ” fine-grained í†µì‹ ì˜ í•œê³„ë¥¼ <strong>í†µì‹  ìŠ¤ì¼€ì¤„ë§ ê³„ì¸µì—ì„œ ì™„í™”</strong><br>â†’ ë” í° í´ëŸ¬ìŠ¤í„°ì— ì ì‘ ê°€ëŠ¥</p><p>ğŸ”— ëŒ€í‘œ ì—°êµ¬:</p><ul><li><strong>Tutel (2023)</strong> â€“ Hierarchical All2All + adaptive MoE</li><li><strong>HetuMoE (2022)</strong> â€“ íŠ¸ë˜í”½ì„ ê· í˜•ìˆê²Œ ë¶„ì‚°ì‹œì¼œ í†µì‹  ë³‘ëª© ì™„í™”</li></ul><hr><h3 id=-3-onlineruntime-ì¬êµ¬ì„±-dynamic-expert-scheduling--adaptive-routing>ğŸ”„ [3] Online/Runtime ì¬êµ¬ì„±: Dynamic Expert Scheduling & Adaptive Routing</h3><table><thead><tr><th>ì ‘ê·¼ë²•</th><th>ì„¤ëª…</th></tr></thead><tbody><tr><td><strong>Dynamic Expert Pruning / Dropout</strong></td><td>ì‹¤í–‰ ì‹œì ì— ë¶€í•˜ ê¸°ë°˜ìœ¼ë¡œ expert í™œì„±í™”</td></tr><tr><td><strong>Expert Affinity Routing</strong></td><td>í†µì‹ ëŸ‰ ìµœì†Œí™” ë°©í–¥ìœ¼ë¡œ routing ë™ì  ì¡°ì ˆ</td></tr><tr><td><strong>Latency-aware Kernel Dispatcher</strong></td><td>ì…ë ¥ token ìˆ˜ì— ë”°ë¼ fused kernel ë™ì  ì„ íƒ</td></tr></tbody></table><p><strong>í•µì‹¬ ê¸°ì—¬</strong>:<br>Cometì˜ static profiling ì˜ì¡´ì„±ì„ í•´ê²°í•˜ê³  <strong>ì‹¤ì‹œê°„ workloadì— ì ì‘</strong><br>â†’ workload imbalanceë‚˜ token skewì—ë„ ê°•ê±´</p><p>ğŸ”— ëŒ€í‘œ ì—°êµ¬:</p><ul><li><strong>Gating Dropout (ICML 2022)</strong> â€“ MoE í†µì‹ ëŸ‰ ê°ì†Œ</li><li><strong>SparTA (Sparse Transformer Autotuner)</strong> â€“ online tile tuning</li></ul><hr><h3 id=-4-ë‹¤ë¥¸-ì—°ì‚°ìì™€ì˜-í†µí•©-attention-moe-fusion-cross-block-scheduling>ğŸ”€ [4] ë‹¤ë¥¸ ì—°ì‚°ìì™€ì˜ í†µí•©: Attention-MoE Fusion, Cross-block Scheduling</h3><table><thead><tr><th>ì ‘ê·¼ë²•</th><th>ì„¤ëª…</th></tr></thead><tbody><tr><td><strong>Fused Attention + MoE Block</strong></td><td>ì—°ì†ëœ attention â†’ MoE blockì„ fused kernelë¡œ ì‹¤í–‰</td></tr><tr><td><strong>Pipeline-aware compiler</strong></td><td>ì—°ì‚°ì ê°„ dep graphë¥¼ global scheduling</td></tr></tbody></table><p><strong>í•µì‹¬ ê¸°ì—¬</strong>:<br>í˜„ì¬ MoE layerë§Œ targetìœ¼ë¡œ í•˜ëŠ” Cometì„ <strong>ëª¨ë¸ ì „ì²´ ìˆ˜ì¤€ìœ¼ë¡œ í™•ì¥</strong></p><p>ğŸ”— ëŒ€í‘œ ì—°êµ¬:</p><ul><li><strong>PipeMoE (INFOCOM 2023)</strong> â€“ MoE operator ê°„ full-path pipeline êµ¬ì„±</li><li><strong>Flux (ByteDance, 2024)</strong> â€“ MoE ì™¸ ì—°ì‚°ê¹Œì§€ fused kernel êµ¬ì„±</li></ul><hr><h2 id=-ë¹„êµ-ìš”ì•½-í…Œì´ë¸”-ì—°êµ¬-íë¦„ë³„-íŠ¹ì§•>ğŸ“Œ ë¹„êµ ìš”ì•½ í…Œì´ë¸”: ì—°êµ¬ íë¦„ë³„ íŠ¹ì§•</h2><table><thead><tr><th>ì—°êµ¬ íë¦„</th><th>í•´ê²° ëŒ€ìƒ</th><th>ëŒ€í‘œ ê¸°ìˆ </th><th>ê¸°ëŒ€ íš¨ê³¼</th></tr></thead><tbody><tr><td>Compiler ê¸°ë°˜ ìë™í™”</td><td>ìˆ˜ì‘ì—… ì»¤ë„ ìµœì í™”</td><td>Triton, TVM, Unity</td><td>êµ¬ì¡°ì  ì¬í˜„ì„±ê³¼ í™•ì¥ì„±</td></tr><tr><td>í†µì‹  ìµœì í™”</td><td>í†µì‹ ëŸ‰/latency</td><td>Hierarchical All2All</td><td>ë” í° í´ëŸ¬ìŠ¤í„° ëŒ€ì‘</td></tr><tr><td>Runtime ì ì‘</td><td>Static tuning</td><td>Gating Dropout, SparTA</td><td>ì…ë ¥ ë³€í™”ì— ìœ ì—°</td></tr><tr><td>ì „ì²´ ëª¨ë¸ í†µí•©</td><td>ì—°ì‚°ì ê°„ ê²½ê³„</td><td>PipeMoE, Flux</td><td>ëª¨ë¸ ìˆ˜ì¤€ latency ìµœì í™”</td></tr></tbody></table><hr><h2 id=-ì •ë¦¬>âœ… ì •ë¦¬</h2><ul><li><strong>Comet</strong>ì€ MoE êµ¬ì¡° ë‚´ í†µì‹ -ì—°ì‚° ë³‘ëª©ì„ <strong>fine-grained pipelining + fused kernel</strong> ë°©ì‹ìœ¼ë¡œ í•´ê²°í•œ ìµœì²¨ë‹¨ ì‹œìŠ¤í…œì´ì§€ë§Œ, <strong>ì»´íŒŒì¼ëŸ¬ ì§€ì› ë¶€ì¬, í†µì‹  ì¶”ìƒí™” ì œí•œ, ì „ì²´ ëª¨ë¸ í†µí•© ë¶€ì¡±</strong> ë“±ì˜ êµ¬ì¡°ì  í•œê³„ê°€ ìˆìŠµë‹ˆë‹¤.</li><li>ì´ë¥¼ ê·¹ë³µí•˜ê¸° ìœ„í•œ ì—°êµ¬ëŠ” ì•„ë˜ì™€ ê°™ì€ íë¦„ìœ¼ë¡œ í™•ì¥ ì¤‘ì…ë‹ˆë‹¤:<ol><li><strong>ì»´íŒŒì¼ëŸ¬ ê¸°ë°˜ ìë™í™” (Triton/TVM/Unity)</strong></li><li><strong>ë„¤íŠ¸ì›Œí¬ aware í†µì‹  ìµœì í™” (Tutel, HetuMoE)</strong></li><li><strong>ë™ì  ì‹¤í–‰ ì ì‘ (SparTA, Gating Dropout)</strong></li><li><strong>ëª¨ë¸ ì „ì²´ ì—°ì‚° í†µí•© (PipeMoE, Flux)</strong></li></ol></li></ul><p>ê° íë¦„ì€ <strong>Cometì˜ ì¥ì ì„ ìœ ì§€í•˜ë©´ì„œë„ í™•ì¥ì„±ê³¼ ì‹¤ì‹œê°„ì„±, ë²”ìš©ì„± ì¸¡ë©´ì—ì„œ ë” í° ë°œì „ ê°€ëŠ¥ì„±</strong>ì„ ì—´ì–´ì£¼ê³  ìˆìŠµë‹ˆë‹¤.</p><h1 id=q--cometì´-ê¸°ì¡´-moe-ì‹œìŠ¤í…œfastermoe-tutel-ë“±-ëŒ€ë¹„-fine-grained-overlappingì„-ì‹¤í˜„í•˜ê¸°-ìœ„í•´-ì–´ë–¤-granularity-level-ìµœì í™”ë¥¼-ì ìš©í–ˆìœ¼ë©°-ì´ë¡œ-ì¸í•´-ì–´ë– í•œ-êµ¬ì¡°ì -trade-offê°€-ë°œìƒí•˜ëŠ”ê°€>Q : Cometì´ ê¸°ì¡´ MoE ì‹œìŠ¤í…œ(FasterMoE, Tutel ë“±) ëŒ€ë¹„ fine-grained overlappingì„ ì‹¤í˜„í•˜ê¸° ìœ„í•´ ì–´ë–¤ granularity-level ìµœì í™”ë¥¼ ì ìš©í–ˆìœ¼ë©°, ì´ë¡œ ì¸í•´ ì–´ë– í•œ êµ¬ì¡°ì  trade-offê°€ ë°œìƒí•˜ëŠ”ê°€?</h1><p>ì¢‹ì€ ì§ˆë¬¸ì…ë‹ˆë‹¤. <strong>Cometì´ ê¸°ì¡´ MoE ì‹œìŠ¤í…œ(FasterMoE, Tutel ë“±)ê³¼ ë¹„êµí•´ ê°€ì¥ ê·¼ë³¸ì ìœ¼ë¡œ ì°¨ë³„í™”ë˜ëŠ” ì ì€ granularity ìˆ˜ì¤€ì—ì„œì˜ ì •êµí•œ ìµœì í™”</strong>ì…ë‹ˆë‹¤. ì•„ë˜ì—ì„œ êµ¬ì²´ì ìœ¼ë¡œ ì–´ë–¤ ìˆ˜ì¤€ì—ì„œ fine-grained overlappingì„ ì ìš©í–ˆëŠ”ì§€, ê·¸ë¦¬ê³  ê·¸ì— ë”°ë¼ ìƒê¸°ëŠ” êµ¬ì¡°ì  trade-offëŠ” ë¬´ì—‡ì¸ì§€ ì •ë¦¬í•´ë“œë¦½ë‹ˆë‹¤.</p><hr><h2 id=-cometì˜-granularity-level-ìµœì í™”>âœ… Cometì˜ granularity-level ìµœì í™”</h2><h3 id=1-ê¸°ì¡´-ì‹œìŠ¤í…œì˜-í•œê³„-coarse-grained-overlap>1. ê¸°ì¡´ ì‹œìŠ¤í…œì˜ í•œê³„ (Coarse-Grained Overlap)</h3><table><thead><tr><th>ì‹œìŠ¤í…œ</th><th>ê²¹ì¹¨ ìˆ˜ì¤€</th><th>ë‹¨ì </th></tr></thead><tbody><tr><td><strong>FasterMoE</strong></td><td>expert ë‹¨ìœ„ pipelining</td><td>ì‘ì€ expert ì²˜ë¦¬ ì‹œ kernel launch ì˜¤ë²„í—¤ë“œ ì»¤ì§</td></tr><tr><td><strong>Tutel</strong></td><td>token group ë‹¨ìœ„ pipelining</td><td>Heuristic scheduling â†’ ì‹¤ì œ ì¢…ì†ì„± ë°˜ì˜ ì–´ë ¤ì›€</td></tr></tbody></table><p>ì´ë“¤ì€ í†µì‹ ê³¼ ì—°ì‚°ì„ <strong>ë³„ë„ì˜ kernelë¡œ ë‚˜ëˆ„ì–´ coarseí•˜ê²Œ ë³‘ë ¬ ì‹¤í–‰</strong>í•˜ë©°,
kernel ê°„ ì˜¤ë²„í—¤ë“œ, ì¢…ì†ì„± ë¯¸ìŠ¤ë§¤ì¹˜ ë“±ìœ¼ë¡œ <strong>latency hidingì´ ì œí•œì </strong>ì„</p><hr><h3 id=2-cometì˜-fine-grained-overlapping-ë°©ì‹>2. Cometì˜ fine-grained overlapping ë°©ì‹</h3><table><thead><tr><th>í•­ëª©</th><th>Cometì˜ ì ‘ê·¼</th></tr></thead><tbody><tr><td><strong>Tensor ë¶„í•´ ë‹¨ìœ„</strong></td><td>token dimension(M), embedding dimension(N) ë°©í–¥ ë¶„í•´</td></tr><tr><td><strong>Execution granularity</strong></td><td>GroupGEMM tile (e.g., 128Ã—128) ìˆ˜ì¤€ì—ì„œ ì¬ìŠ¤ì¼€ì¤„ë§</td></tr><tr><td><strong>Kernel ì‹¤í–‰ ë‹¨ìœ„</strong></td><td>í•˜ë‚˜ì˜ <strong>fused kernel ë‚´ë¶€ì—ì„œ í†µì‹ /ì—°ì‚° thread block ë¶„ë¦¬</strong></td></tr><tr><td><strong>ì—°ì‚° ìˆœì„œ</strong></td><td>token ì†ŒìŠ¤ rank ê¸°ì¤€ ì •ë ¬ â†’ <strong>local token tile ìš°ì„  ì‹¤í–‰</strong></td></tr></tbody></table><p>â¡ï¸ ì´ë ‡ê²Œ í•˜ì—¬ í†µì‹ ì´ ì™„ë£Œëœ ì¼ë¶€ ë°ì´í„°ê°€ <strong>ì¦‰ì‹œ ì—°ì‚°ì— ë“¤ì–´ê°ˆ ìˆ˜ ìˆëŠ” path</strong> í™•ë³´</p><hr><h2 id=-êµ¬ì¡°ì -trade-off>âš ï¸ êµ¬ì¡°ì  trade-off</h2><h3 id=1-ì»¤ë„-ë³µì¡ë„-ì¦ê°€-ë°-êµ¬í˜„-ë¶€ë‹´>1. ì»¤ë„ ë³µì¡ë„ ì¦ê°€ ë° êµ¬í˜„ ë¶€ë‹´</h3><ul><li>Fused kernelì€ í†µì‹ /ì—°ì‚° thread block ê°„ì˜ <strong>ë™ê¸°í™”, shared memory í• ë‹¹, warp ê²½ìŸ</strong> ë“±ì„ ì„¸ë°€í•˜ê²Œ ì œì–´í•´ì•¼ í•¨</li><li>â†’ ì¼ë°˜ì ì¸ CUTLASS GEMMì´ë‚˜ ê¸°ì¡´ NCCL ì‚¬ìš©ë³´ë‹¤ <strong>low-level CUDA ì„¤ê³„ ë¶€ë‹´ ì¦ê°€</strong></li></ul><h3 id=2-í•˜ë“œì›¨ì–´-ì¢…ì†ì„±-ì¦ê°€>2. í•˜ë“œì›¨ì–´ ì¢…ì†ì„± ì¦ê°€</h3><ul><li>Hopper GPUì—ì„œëŠ” TMA/Tensor Core ë“±ì„ íš¨ìœ¨ì ìœ¼ë¡œ í™œìš©í•˜ì§€ë§Œ, **ë‹¤ë¥¸ GPU ì•„í‚¤í…ì²˜(Ampere, Volta)**ì—ì„œëŠ” ì´ì ì´ ì œí•œë  ìˆ˜ ìˆìŒ</li><li>íŠ¹íˆ NVSHMEMì€ ëª¨ë“  í´ëŸ¬ìŠ¤í„° í™˜ê²½ì—ì„œ ì§€ì›ë˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¯€ë¡œ <strong>ì´ì‹ì„± ë¬¸ì œ</strong> ë°œìƒ</li></ul><h3 id=3-ì»´íŒŒì¼ëŸ¬-ìµœì í™”ì™€ì˜-í†µí•©-ì–´ë ¤ì›€>3. ì»´íŒŒì¼ëŸ¬ ìµœì í™”ì™€ì˜ í†µí•© ì–´ë ¤ì›€</h3><ul><li>shared tensorì˜ ë¶„í•´/ì¬ë°°ì¹˜ëŠ” í˜„ì¬ ìˆ˜ì‘ì—…ìœ¼ë¡œ ìµœì í™”ë¨ â†’ <strong>ì»´íŒŒì¼ëŸ¬ê°€ ì¸ì§€í•˜ê³  ìµœì í™”í•˜ê¸° ì–´ë ¤ì›€</strong></li><li>TVM, Triton ë“±ê³¼ ì—°ë™ ì‹œ <strong>ì˜ì¡´ì„± ì¶”ë¡ ì´ ê¹Œë‹¤ë¡œì›€</strong></li></ul><hr><h2 id=-ìš”ì•½-1>ğŸ” ìš”ì•½</h2><table><thead><tr><th>í•­ëª©</th><th>ê¸°ì¡´ ë°©ë²•</th><th>Comet</th></tr></thead><tbody><tr><td>Overlap ë‹¨ìœ„</td><td>expert/kernel</td><td>token/tile</td></tr><tr><td>ì‹¤í–‰ ë°©ì‹</td><td>ë³‘ë ¬ ì»¤ë„ ì‹¤í–‰</td><td>fused kernel ë‚´ë¶€ thread block ë³‘ë ¬</td></tr><tr><td>ì¥ì </td><td>êµ¬í˜„ ë‹¨ìˆœ, ì¼ë¶€ overlap</td><td><strong>ì •ë°€í•œ latency hiding (86% ì€ë‹‰)</strong></td></tr><tr><td>ë‹¨ì </td><td>overlap ì œí•œì </td><td><strong>ì„¤ê³„ ë³µì¡ì„±, ì´ì‹ì„±, ì»´íŒŒì¼ëŸ¬ í†µí•©ì„± ë¬¸ì œ</strong></td></tr></tbody></table><hr><p>ê²°ë¡ ì ìœ¼ë¡œ, Cometì€ granularityë¥¼ token-level ë° tile-levelë¡œ ëŒì–´ì˜¬ë¦° ë•ë¶„ì— <strong>MoEì˜ í†µì‹  ë³‘ëª©ì„ ê·¼ë³¸ì ìœ¼ë¡œ í•´ì†Œ</strong>í•˜ì§€ë§Œ, <strong>ì´ì™€ ë§ë¬¼ë ¤ ì»¤ë„ ì„¤ê³„ ë° ì‹œìŠ¤í…œ í†µí•© ì¸¡ë©´ì—ì„œ ë³µì¡ì„±ê³¼ ì´ì‹ì„±ì— ëŒ€í•œ trade-off</strong>ë¥¼ ê°ìˆ˜í•´ì•¼ í•˜ëŠ” êµ¬ì¡°ì…ë‹ˆë‹¤. ì´ ì ì„ í›„ì† ì—°êµ¬ì—ì„œëŠ” <strong>ì»´íŒŒì¼ëŸ¬ í†µí•©ì´ë‚˜ runtime adaptation ë°©ì‹ìœ¼ë¡œ í•´ê²°í•˜ë ¤ëŠ” íë¦„</strong>ì´ ìˆìŠµë‹ˆë‹¤.</p><h1 id=q--shared-tensor-ê¸°ë°˜-dependency-resolving-ê³¼ì •ì—ì„œ-mê³¼-n-ë°©í–¥-ë¶„í•´ë¥¼-ì‚¬ìš©í•˜ëŠ”-ê¸°ì¤€ì€-ë¬´ì—‡ì´ë©°-ì´ë¥¼-ë‹¤ë¥¸-ì—°ì‚°ìì˜ˆ-attention-layernormì—ë„-ì¼ë°˜í™”í•˜ë ¤ë©´-ì–´ë–¤-ì œì•½ì´-ë°œìƒí•˜ëŠ”ê°€>Q : Shared Tensor ê¸°ë°˜ dependency resolving ê³¼ì •ì—ì„œ Mê³¼ N ë°©í–¥ ë¶„í•´ë¥¼ ì‚¬ìš©í•˜ëŠ” ê¸°ì¤€ì€ ë¬´ì—‡ì´ë©°, ì´ë¥¼ ë‹¤ë¥¸ ì—°ì‚°ì(ì˜ˆ: Attention, LayerNorm)ì—ë„ ì¼ë°˜í™”í•˜ë ¤ë©´ ì–´ë–¤ ì œì•½ì´ ë°œìƒí•˜ëŠ”ê°€?</h1><p>ë§¤ìš° ì¤‘ìš”í•œ ì§ˆë¬¸ì…ë‹ˆë‹¤. <strong>Cometì˜ í•µì‹¬ ê¸°ìˆ ì¸ Shared Tensor ê¸°ë°˜ dependency resolving</strong>ì€ **&ldquo;ì–´ë–¤ ë°©í–¥ìœ¼ë¡œ tensorë¥¼ ë¶„í•´í•  ê²ƒì¸ê°€?&rdquo;**ì— ë”°ë¼ overlapping ì„±ëŠ¥ì´ í¬ê²Œ ì¢Œìš°ë˜ë©°, ì´ë¥¼ ë‹¤ë¥¸ ì—°ì‚°ì(ì˜ˆ: Attention, LayerNorm ë“±)ë¡œ í™•ì¥í•˜ë ¤ë©´ <strong>ì—°ì‚°ìì˜ ì…ì¶œë ¥ í˜•íƒœ ë° ë°ì´í„° ì˜ì¡´ì„± êµ¬ì¡°</strong>ì— ëŒ€í•œ ê¹Šì€ ì´í•´ê°€ í•„ìš”í•©ë‹ˆë‹¤.</p><hr><h2 id=-1-cometì—ì„œ-mn-ë°©í–¥-ë¶„í•´-ê¸°ì¤€>âœ… 1. Cometì—ì„œ M/N ë°©í–¥ ë¶„í•´ ê¸°ì¤€</h2><h3 id=shared-tensorì˜-ì—­í• >Shared Tensorì˜ ì—­í• </h3><ul><li><strong>í†µì‹ ê³¼ ì—°ì‚° ì‚¬ì´</strong>ì—ì„œ ë°ì´í„°ë¥¼ ì—°ê²°í•˜ëŠ” <strong>producer-consumer buffer</strong></li><li>overlappingì„ ìœ„í•´ì„  <strong>ë‘ ì—°ì‚°ì´ ë…ë¦½ì ìœ¼ë¡œ ì ‘ê·¼ ê°€ëŠ¥í•œ ë°©í–¥</strong>ìœ¼ë¡œ ë¶„í•´ë˜ì–´ì•¼ í•¨</li></ul><hr><h3 id=moe-layer-0-all-to-all--gemm>MoE Layer 0 (All-to-All â†’ GEMM)</h3><table><thead><tr><th>í•­ëª©</th><th>ì„¤ëª…</th></tr></thead><tbody><tr><td>Producer</td><td>í†µì‹  (All-to-All)</td></tr><tr><td>Consumer</td><td>GEMM1 (FFNì˜ ì²« ë²ˆì§¸ ì—°ì‚°)</td></tr><tr><td>Shared Tensor shape</td><td>((M \times \text{topk}, N))</td></tr><tr><td>ë¶„í•´ ë°©í–¥</td><td><strong>M ë°©í–¥ (í† í° ë‹¨ìœ„)</strong></td></tr></tbody></table><p><strong>ì´ìœ </strong>:</p><ul><li>GEMMì€ row-wise ë³‘ë ¬í™” â†’ ê° tokenì€ ë…ë¦½ì ìœ¼ë¡œ ê³„ì‚° ê°€ëŠ¥</li><li>ë”°ë¼ì„œ, <strong>M ì°¨ì›ì„ ë”°ë¼ ë¶„í•´í•˜ë©´ consumer(GEMM)ê°€ ë¶€ë¶„ì ìœ¼ë¡œ ë¨¼ì € ì‹¤í–‰ ê°€ëŠ¥</strong></li><li>ì´ë¡œ ì¸í•´ í†µì‹ ëœ ì¼ë¶€ tokenë§Œ ë„ì°©í•´ë„ ì—°ì‚°ì´ ì‹œì‘ë¨</li></ul><hr><h3 id=moe-layer-1-gemm2--combine>MoE Layer 1 (GEMM2 â†’ Combine)</h3><table><thead><tr><th>í•­ëª©</th><th>ì„¤ëª…</th></tr></thead><tbody><tr><td>Producer</td><td>GEMM2 (FFNì˜ ë‘ ë²ˆì§¸ ì—°ì‚°)</td></tr><tr><td>Consumer</td><td>Top-k Combine + All-to-All</td></tr><tr><td>Shared Tensor shape</td><td>ë™ì¼: ((M \times \text{topk}, N))</td></tr><tr><td>ë¶„í•´ ë°©í–¥</td><td><strong>N ë°©í–¥ (ì„ë² ë”© ì°¨ì›)</strong></td></tr></tbody></table><p><strong>ì´ìœ </strong>:</p><ul><li>Top-k Combineì€ token ë‹¨ìœ„ë¡œ <strong>M ë°©í–¥ reduce</strong> ì—°ì‚°</li><li>ì´ ê²½ìš° <strong>M ë°©í–¥ì€ inter-dependent</strong> â†’ ë¶„í•´ ë¶ˆê°€</li><li>ëŒ€ì‹ , <strong>N ì°¨ì›ì€ token ë‚´ë¶€ ì°¨ì›ì´ë¯€ë¡œ ë…ë¦½ì </strong> â†’ ì—°ì‚° ì¼ë¶€ ì™„ë£Œ ì‹œ ê³§ë°”ë¡œ í†µì‹  ê°€ëŠ¥</li></ul><hr><h2 id=-2-ì¼ë°˜í™”-ì‹œ-ê¸°ì¤€>âœ… 2. ì¼ë°˜í™” ì‹œ ê¸°ì¤€</h2><p>ë‹¤ë¥¸ ì—°ì‚°ìì— ì´ ë°©ì‹ì„ ì ìš©í•˜ë ¤ë©´ <strong>ë‹¤ìŒ ê¸°ì¤€</strong>ì„ ë”°ì ¸ì•¼ í•©ë‹ˆë‹¤:</p><table><thead><tr><th>íŒë‹¨ ê¸°ì¤€</th><th>ì˜ë¯¸</th><th>ì˜ˆì‹œ</th></tr></thead><tbody><tr><td><strong>ì—°ì‚°ìì˜ access pattern</strong></td><td>ì–´ë–¤ ì°¨ì›ì„ ê¸°ì¤€ìœ¼ë¡œ ë³‘ë ¬í™”í•˜ëŠ”ê°€?</td><td>Attention â†’ QK^T: head-wise, seq-wise</td></tr><tr><td><strong>ì˜ì¡´ì„± ë°©í–¥</strong></td><td>ì–´ëŠ ì°¨ì›ì´ ë…ë¦½ì ì´ê³ , ì–´ëŠ ì°¨ì›ì´ ì¢…ì†ì ì¸ê°€?</td><td>LayerNorm â†’ feature(N) ì¢…ì†, token(M) ë…ë¦½</td></tr><tr><td><strong>output consumption timing</strong></td><td>ì¶œë ¥ì´ ì–¸ì œë¶€í„° ë‹¤ìŒ ì—°ì‚°ì— ì†Œë¹„ ê°€ëŠ¥í•œê°€?</td><td>Residual add: ì „ì²´ ì™„ë£Œ í•„ìš” â†’ overlap ì–´ë ¤ì›€</td></tr></tbody></table><hr><h2 id=-3-ì—°ì‚°ìë³„-ì ìš©-ê°€ëŠ¥ì„±ê³¼-ì œì•½>âœ… 3. ì—°ì‚°ìë³„ ì ìš© ê°€ëŠ¥ì„±ê³¼ ì œì•½</h2><h3 id=-self-attention-qkt-softmax-v-ê³±>ğŸ§  Self-Attention (QK^T, softmax, V ê³±)</h3><table><thead><tr><th>ì—°ì‚°</th><th>ê°€ëŠ¥ ì—¬ë¶€</th><th>ì œì•½</th></tr></thead><tbody><tr><td>QK^T (dot-product)</td><td>ë¶€ë¶„ì ìœ¼ë¡œ ê°€ëŠ¥</td><td><code>seq_i</code>ì™€ <code>seq_j</code> ê°„ ì˜ì¡´ì„± ì¡´ì¬ â†’ <strong>Mê³¼ Mì˜ ìƒí˜¸ì°¸ì¡°</strong></td></tr><tr><td>softmax</td><td>âŒ</td><td>ì „ì²´ query sequence í•„ìš” â†’ non-overlappable</td></tr><tr><td>V ê³±</td><td>ê°€ëŠ¥ (tile ë‹¨ìœ„)</td><td><code>softmax(QK)</code>ê°€ ì™„ë£Œë˜ì–´ì•¼ ì‹œì‘ ê°€ëŠ¥</td></tr></tbody></table><p>â¡ï¸ <strong>Attentionì€ token ê°„ ì˜ì¡´ì„±ì´ ìˆì–´ M ë¶„í•´ê°€ ì–´ë ¤ìš°ë©°, V ê³± ë‹¨ê³„ë§Œ ì¼ë¶€ ì ìš© ê°€ëŠ¥</strong></p><hr><h3 id=-layernorm>ğŸ§ª LayerNorm</h3><table><thead><tr><th>ì—°ì‚°</th><th>ê°€ëŠ¥ ì—¬ë¶€</th><th>ì œì•½</th></tr></thead><tbody><tr><td>Mean, Var ê³„ì‚°</td><td>ë¶ˆê°€ëŠ¥ (ì „ì²´ feature í•„ìš”)</td><td>N ì°¨ì› reduction í•„ìš”</td></tr><tr><td>ì •ê·œí™” ê³„ì‚°</td><td>ë¶€ë¶„ ì ìš© ê°€ëŠ¥</td><td>N ë°©í–¥ ë³‘ë ¬ ê°€ëŠ¥í•˜ë‚˜, <strong>ì˜ë¯¸ ìˆëŠ” overlappingì€ ì–´ë ¤ì›€</strong></td></tr></tbody></table><p>â¡ï¸ LayerNormì€ outputì„ ìƒì„±í•˜ê¸° ìœ„í•´ **ì „ì²´ feature vector(N)**ê°€ í•„ìš”í•˜ê¸° ë•Œë¬¸ì— overlapping ìì²´ê°€ ì–´ë ¤ì›€</p><hr><h2 id=-ìš”ì•½-ì •ë¦¬-2>âœ… ìš”ì•½ ì •ë¦¬</h2><table><thead><tr><th>ì—°ì‚°ì</th><th>ê°€ëŠ¥ ë¶„í•´ ë°©í–¥</th><th>ê°€ëŠ¥í•œ overlapping ë‹¨ê³„</th><th>ì œì•½ ì‚¬í•­</th></tr></thead><tbody><tr><td>GEMM</td><td>M (row-wise)</td><td>Early computation by tile</td><td>ì—†ìŒ</td></tr><tr><td>Combine (TopK)</td><td>N (column-wise)</td><td>Early reduce + send</td><td>M ì¢…ì†ì„±</td></tr><tr><td>Attention</td><td>ì¼ë¶€ M, ì¼ë¶€ head</td><td>V ê³± ì •ë„</td><td>query-key ê°„ ìƒí˜¸ì°¸ì¡°</td></tr><tr><td>LayerNorm</td><td>ê±°ì˜ ë¶ˆê°€</td><td>ì—†ìŒ</td><td>feature ì „ì²´ í•„ìš”</td></tr></tbody></table><hr><h2 id=-ê²°ë¡ >ğŸ“Œ ê²°ë¡ </h2><p>Cometì˜ M/N ë°©í–¥ ë¶„í•´ ê¸°ì¤€ì€ ë‹¤ìŒê³¼ ê°™ì€ <strong>ì›ì¹™ì  íŒë‹¨</strong>ì— ê¸°ë°˜í•©ë‹ˆë‹¤:</p><ol><li><strong>Consumer ì—°ì‚°ìê°€ ì–´ë–¤ ì°¨ì›ì„ ë³‘ë ¬í™”í•˜ëŠ”ê°€?</strong></li><li><strong>Shared tensor ë‚´ì—ì„œ ë…ë¦½ì ìœ¼ë¡œ ì ‘ê·¼ ê°€ëŠ¥í•œ ì°¨ì›ì´ ì¡´ì¬í•˜ëŠ”ê°€?</strong></li><li><strong>ê·¸ ì°¨ì›ìœ¼ë¡œ tensorë¥¼ ë¶„í•´í–ˆì„ ë•Œ ê²°ê³¼ê°€ ì¼ê´€ì„±ì„ ìœ ì§€í•˜ëŠ”ê°€?</strong></li></ol><p>ì´ë¥¼ ë‹¤ë¥¸ ì—°ì‚°ìì— ì¼ë°˜í™”í•˜ê¸° ìœ„í•´ì„œëŠ” <strong>ì—°ì‚°ìì˜ ë‚´ë¶€ ë°ì´í„° ì˜ì¡´ì„± ëª¨ë¸ë§</strong>ê³¼ <strong>tile-level schedulerì˜ ë³´í¸í™”</strong>ê°€ í•„ìˆ˜ì´ë©°, ì´ëŸ¬í•œ generalizationì€ ì•ìœ¼ë¡œì˜ ì»´íŒŒì¼ëŸ¬ ê¸°ë°˜ ì ‘ê·¼(TVM, Unity ë“±)ì—ì„œ ì¤‘ìš”í•œ ë°©í–¥ì´ ë  ê²ƒì…ë‹ˆë‹¤.</p><h1 id=q--adaptive-thread-block-assignmentì—ì„œ-profiling-ê¸°ë°˜ìœ¼ë¡œ-ìµœì -block-ë¹„ìœ¨ì„-ì„ íƒí•˜ëŠ”-ë°©ì‹ì´-cometì˜-ì‹¤ì‹œê°„ì„±ì´ë‚˜-ë²”ìš©ì„±ì—-ë¯¸ì¹˜ëŠ”-ì˜í–¥ì„-ì¤„ì´ê³ ì-í• -ë•Œ-ì–´ë– í•œ-online-scheduling-ê¸°ë²•ì´-ë³´ì™„ì ìœ¼ë¡œ-ì ìš©ë -ìˆ˜-ìˆì„ê¹Œ>Q : Adaptive thread block assignmentì—ì„œ profiling ê¸°ë°˜ìœ¼ë¡œ ìµœì  block ë¹„ìœ¨ì„ ì„ íƒí•˜ëŠ” ë°©ì‹ì´ Cometì˜ ì‹¤ì‹œê°„ì„±ì´ë‚˜ ë²”ìš©ì„±ì— ë¯¸ì¹˜ëŠ” ì˜í–¥ì„ ì¤„ì´ê³ ì í•  ë•Œ, ì–´ë– í•œ online scheduling ê¸°ë²•ì´ ë³´ì™„ì ìœ¼ë¡œ ì ìš©ë  ìˆ˜ ìˆì„ê¹Œ?</h1><p>ì´ ì§ˆë¬¸ì€ <strong>Cometì˜ Adaptive Thread Block Assignment</strong>ì˜ í•µì‹¬ í•œê³„ë¥¼ ì§€ì í•˜ëŠ” ë§¤ìš° ì˜ˆë¦¬í•œ ì§ˆë¬¸ì…ë‹ˆë‹¤. Cometì€ í˜„ì¬ **ì‚¬ì „ profiling ê¸°ë°˜(static metadata)**ìœ¼ë¡œ ìµœì  <code>nc:nc</code> (í†µì‹ :ì—°ì‚° thread block ë¹„ìœ¨)ë¥¼ ì„ íƒí•˜ê¸° ë•Œë¬¸ì—, **ì‹¤ì‹œê°„ì„±(real-time adaptability)**ê³¼ <strong>ë²”ìš©ì„±(generalizability)</strong> ì¸¡ë©´ì—ì„œ ì œì•½ì´ ìˆìŠµë‹ˆë‹¤.</p><hr><h2 id=-ë¬¸ì œ-ìš”ì•½-ì™œ-ë¬¸ì œê°€-ë˜ëŠ”ê°€>âœ… ë¬¸ì œ ìš”ì•½: ì™œ ë¬¸ì œê°€ ë˜ëŠ”ê°€?</h2><table><thead><tr><th>í•­ëª©</th><th>ë¬¸ì œì </th></tr></thead><tbody><tr><td><strong>ì‹¤ì‹œê°„ì„± ê²°ì—¬</strong></td><td>ìƒˆë¡œìš´ ì…ë ¥ í¬ê¸°(M), top-k, í•˜ë“œì›¨ì–´ í™˜ê²½ ë“± ë°”ë€” ë•Œë§ˆë‹¤ profiling ì¬ìˆ˜í–‰ í•„ìš”</td></tr><tr><td><strong>ë²”ìš©ì„± ë¶€ì¡±</strong></td><td>ë‹¤ë¥¸ ëª¨ë¸ì´ë‚˜ dynamic routing ì •ì±…ì— ëŒ€í•´ ì„±ëŠ¥ ë³´ì¥ ì–´ë ¤ì›€</td></tr><tr><td><strong>ëª¨ë¸ ì¼ë°˜í™” í•œê³„</strong></td><td>Cometì€ MoEì˜ FFN êµ¬ì¡°ì— ìµœì í™” â†’ ë‹¤ë¥¸ êµ¬ì¡°(ì˜ˆ: depth-wise conv)ì—ì„œ ì–´ë ¤ì›€</td></tr></tbody></table><hr><h2 id=-í•´ê²°-ë°©í–¥-online-scheduling-ê¸°ë²•-ì ìš©>âœ… í•´ê²° ë°©í–¥: Online Scheduling ê¸°ë²• ì ìš©</h2><p>ì•„ë˜ëŠ” ì‹¤ì‹œê°„ ì ì‘ì„±ì„ ë†’ì´ê¸° ìœ„í•´ ì ìš© ê°€ëŠ¥í•œ <strong>Online Scheduling ê¸°ë²• 3ê°€ì§€</strong>ì™€ ê·¸ íŠ¹ì§•ì…ë‹ˆë‹¤.</p><hr><h3 id=1--reinforcement-learning-ê¸°ë°˜-thread-block-íŠœë„ˆ-runtime-auto-tuner>1. ğŸ” Reinforcement Learning ê¸°ë°˜ Thread Block íŠœë„ˆ (Runtime Auto-Tuner)</h3><p>| ê°œë… | í™˜ê²½ ìƒíƒœ(state)ë¥¼ ì…ë ¥ìœ¼ë¡œ ë°›ê³ , thread block ë¹„ìœ¨ì„ actionìœ¼ë¡œ ì„ íƒ â†’ rewardëŠ” latency |
| ì…ë ¥ | í˜„ì¬ ì…ë ¥ token ìˆ˜(M), expert ìˆ˜(E), top-k, device ID, previous latency |
| ë°©ë²• | Bandit / PPO / DQN ê¸°ë°˜ ì •ì±… í•™ìŠµ (ì‹¬ì§€ì–´ lightweight modelë„ ê°€ëŠ¥) |
| ì¥ì  | ì‹¤ì‹œê°„ ì ì‘ + í™˜ê²½ ë³€í™”ì— ê°•ê±´ |
| ë‹¨ì  | ì´ˆê¸° í•™ìŠµ ë¹„ìš©, cold-start ë¬¸ì œ</p><p><strong>ì˜ˆì‹œ</strong>:</p><ul><li>ì²« ë²ˆì§¸ 100 step ë™ì•ˆ íƒìƒ‰ (explore)</li><li>ì´í›„ ë¹ ë¥´ê²Œ best config ì„ íƒ</li><li>latencyì— ë”°ë¼ reward ì¡°ì •</li></ul><p>ğŸ”— ê´€ë ¨ ì‚¬ë¡€:</p><ul><li><strong>AutoTVM (TVM)</strong>, <strong>SparTA (Sparse Transformer Auto-tuner)</strong></li></ul><hr><h3 id=2--lightweight-heuristic-rule--í”¼ë“œë°±-ë³´ì •-latency-ratio-tuning>2. ğŸ“Š Lightweight Heuristic Rule + í”¼ë“œë°± ë³´ì • (Latency Ratio Tuning)</h3><p>| ê°œë… | í†µì‹  ì—°ì‚° latencyë¥¼ runtimeì—ì„œ ì‹¤ì¸¡ â†’ ì¼ì • ë¹„ìœ¨ ì°¨ì´ë§Œí¼ thread block ìˆ˜ ì¬ì¡°ì • |
| ìˆ˜ì‹ ì˜ˆì‹œ |</p><div class="code-block-container border-border bg-card my-6 overflow-hidden rounded-xl border shadow-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:shadow-md"><div class="code-block-header bg-muted/30 border-border flex items-center justify-between border-b px-4 py-3"><div class="flex items-center gap-2"><div class="text-muted-foreground flex-shrink-0"><svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4 4 4-4 4M6 16l-4-4 4-4"/></svg></div><span class="text-muted-foreground text-sm font-medium">PLAINTEXT</span></div><div class="flex items-center gap-2"><button class="collapse-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-9 data-default-state=expanded data-collapsed=false data-auto-collapse-lines=30 data-auto-collapse-height=400 data-collapsed-height=120 title=ì ‘ê¸° aria-label=ì ‘ê¸°>
<span class=collapse-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41 12 10.83l4.59 4.58L18 14l-6-6-6 6z"/></svg>
</span><span class="collapse-text hidden sm:inline">ì ‘ê¸°</span>
</button>
<button class="copy-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-9 title=ë³µì‚¬ aria-label=ë³µì‚¬>
<span class=copy-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/></svg>
</span><span class="copy-text hidden sm:inline">ë³µì‚¬</span></button></div></div><div class="code-block-content relative" id=code-9><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=ln>1</span><span class=cl>if latency_comm &gt; latency_comp:
</span></span><span class=line><span class=ln>2</span><span class=cl>    nc += Î”
</span></span><span class=line><span class=ln>3</span><span class=cl>    np -= Î”
</span></span><span class=line><span class=ln>4</span><span class=cl>else:
</span></span><span class=line><span class=ln>5</span><span class=cl>    np += Î”
</span></span><span class=line><span class=ln>6</span><span class=cl>    nc -= Î”</span></span></code></pre></div><div class="collapse-overlay to-card/90 pointer-events-none absolute inset-0 bg-gradient-to-b from-transparent via-transparent opacity-0 transition-opacity duration-300"><div class="text-muted-foreground bg-card/80 border-border/50 hover:bg-primary/10 hover:text-primary hover:border-primary/30 absolute bottom-4 left-1/2 -translate-x-1/2 cursor-pointer rounded-full border px-3 py-1.5 text-xs backdrop-blur-sm transition-all duration-200">í´ë¦­í•˜ì—¬ ë” ë³´ê¸°</div></div></div></div><script>(function(){const s="code-9",n=document.querySelector('.copy-code-btn[data-code-id="'+s+'"]'),t=document.querySelector('.collapse-code-btn[data-code-id="'+s+'"]'),e=document.getElementById(s);if(!e)return;if(n){const s=n.querySelector(".copy-icon"),t=n.querySelector(".copy-text");n.addEventListener("click",async function(){try{let o="";const i=e.querySelector(".lntd:last-child code");if(i)o=i.textContent||i.innerText;else{const t=e.querySelector("code");if(t){const e=t.querySelector(".ln");if(e){const e=t.querySelectorAll(".cl");if(e.length>0)o=Array.from(e).map(e=>{const t=e.textContent||e.innerText;return t.replace(/\n+$/,"")}).join(`
`).replace(/\n+$/,"");else{const e=t.textContent||t.innerText;o=e.replace(/^\d+/gm,"").replace(/^\s+/gm,"")}}else o=t.textContent||t.innerText}else o=e.textContent||e.innerText}o=o.trim(),await navigator.clipboard.writeText(o),s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
</svg>`,t&&(t.textContent="ë³µì‚¬ë¨"),n.classList.add("text-green-600"),setTimeout(()=>{s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
</svg>`,t&&(t.textContent="ë³µì‚¬"),n.classList.remove("text-green-600")},2e3)}catch(o){console.error("å¤åˆ¶å¤±è´¥:",o);const s=document.createRange(),i=e.querySelector("code")||e;s.selectNodeContents(i);const n=window.getSelection();n.removeAllRanges(),n.addRange(s),t&&(t.textContent="ì„ íƒë¨"),setTimeout(()=>{t&&(t.textContent="ë³µì‚¬"),n.removeAllRanges()},2e3)}})}if(t){const d=t.querySelector(".collapse-icon"),c=t.querySelector(".collapse-text"),n=e.querySelector(".collapse-overlay");let s=e.querySelector("pre.chroma");s||(s=e.querySelector("pre"));const m=t.dataset.defaultState||"expanded",f=t.dataset.collapsed==="true",u=parseInt(t.dataset.autoCollapseLines)||30,h=parseInt(t.dataset.autoCollapseHeight)||400,p=parseInt(t.dataset.collapsedHeight)||120;let l=!1;function i(){const e=f||m==="collapsed"||a();e&&o(!0,!1)}function a(){if(s){const e=s.querySelectorAll(".line, .cl"),t=s.offsetHeight;return e.length>u||t>h}const t=e.offsetHeight;if(t>h)return!0;const n=e.textContent||e.innerText||"",o=n.split(`
`).length;return o>u}function o(s,o=!0){if(!n)return;l=s,s?(e.style.maxHeight=p+"px",e.style.overflow="hidden",n.style.opacity="1",n.style.pointerEvents="auto",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
</svg>`,c&&(c.textContent="í¼ì¹˜ê¸°"),t.title="í¼ì¹˜ê¸°"):(e.style.maxHeight="",e.style.overflow="",n.style.opacity="0",n.style.pointerEvents="none",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z"/></svg>`,c&&(c.textContent="ì ‘ê¸°"),t.title="ì ‘ê¸°"),o&&(e.style.transition="max-height 0.3s ease-out",setTimeout(()=>{e.style.transition=""},300))}function r(){o(!l,!0)}t.addEventListener("click",r),n&&n.addEventListener("click",()=>{l&&o(!1,!0)}),i()}})()</script><p>| ì¥ì  | ë§¤ìš° ê²½ëŸ‰ + ë¹ ë¥¸ ì ìš© ê°€ëŠ¥ |
| ë‹¨ì  | feedback loop tuningì´ ì•ˆì •ì ì´ì§€ ì•Šì„ ìˆ˜ ìˆìŒ</p><p><strong>ì ìš© ë°©ì‹</strong>:</p><ul><li>ê° MoE layer ì‹œì‘ ì‹œ latency ì˜ˆì¸¡</li><li>ì»¤ë„ launch ì§ì „ shared memory/warp ìˆ˜ ê³ ë ¤í•´ thread block ì¡°ì •</li></ul><p>ğŸ”— ê´€ë ¨ ì‚¬ë¡€:</p><ul><li>Flux (ByteDance internal)</li><li>Optimus-CC: Heuristic communication partitioning</li></ul><hr><h3 id=3--predictive-performance-modeling-dynamic-cost-model>3. ğŸ“ˆ Predictive Performance Modeling (Dynamic Cost Model)</h3><p>| ê°œë… | í•™ìŠµëœ ëª¨ë¸ì„ í†µí•´ ì…ë ¥ íŒŒë¼ë¯¸í„° ê¸°ë°˜ìœ¼ë¡œ block ë¹„ìœ¨ ì˜ˆì¸¡ |
| í•™ìŠµ ëŒ€ìƒ | ì…ë ¥ ê¸¸ì´ M, expert ë¶€í•˜ ë¶„í¬ std, top-k, í•˜ë“œì›¨ì–´ ì •ë³´ |
| ëª¨ë¸ ì¢…ë¥˜ | Linear Regression / Gradient Boosted Trees / Lightweight NN |
| ì¥ì  | ë§¤ìš° ë¹ ë¥´ê³  ì •í™•ë„ ë†’ìŒ (í•œ ë²ˆë§Œ í•™ìŠµí•˜ë©´ ë¨) |
| ë‹¨ì  | ëª¨ë¸ êµ¬ì¡° ë°”ë€” ê²½ìš° ì¬í•™ìŠµ í•„ìš”</p><p><strong>êµ¬í˜„ ë°©ì‹</strong>:</p><ul><li>ë‹¤ì–‘í•œ configì— ëŒ€í•´ ì˜¤í”„ë¼ì¸ latency log ìˆ˜ì§‘</li><li>ì´í›„ ì‹¤í–‰ ì‹œ, í•´ë‹¹ inputì— ë§ëŠ” <code>nc/np</code> ì˜ˆì¸¡</li></ul><p>ğŸ”— ê´€ë ¨ ì‚¬ë¡€:</p><ul><li>GShard / Unity compilerì˜ auto-partitioning cost model</li></ul><hr><h2 id=-ìš”ì•½-ë¹„êµí‘œ>ğŸ“Œ ìš”ì•½ ë¹„êµí‘œ</h2><table><thead><tr><th>ë°©ì‹</th><th>ì‹¤ì‹œê°„ì„±</th><th>ì •í™•ë„</th><th>êµ¬í˜„ ë‚œì´ë„</th><th>ë³´ì™„ ê°€ëŠ¥ì„±</th></tr></thead><tbody><tr><td>RL ê¸°ë°˜ íŠœë‹</td><td>â˜…â˜…â˜…â˜…â˜†</td><td>â˜…â˜…â˜…â˜…â˜†</td><td>â˜…â˜…â˜…â˜…â˜†</td><td>ìµœê³  ìˆ˜ì¤€ ì ì‘ì„±</td></tr><tr><td>Heuristic + Feedback</td><td>â˜…â˜…â˜…â˜…â˜…</td><td>â˜…â˜…â˜†â˜†â˜†</td><td>â˜…â˜…â˜†â˜†â˜†</td><td>ë¹ ë¥¸ ì ìš©, ê°„ë‹¨</td></tr><tr><td>Predictive ëª¨ë¸ë§</td><td>â˜…â˜…â˜…â˜…â˜†</td><td>â˜…â˜…â˜…â˜…â˜†</td><td>â˜…â˜…â˜…â˜†â˜†</td><td>ì ë‹¹í•œ íŠ¸ë ˆì´ë“œì˜¤í”„</td></tr></tbody></table><hr><h2 id=-ì¶”ì²œ-hybrid-ë°©ì‹>âœ… ì¶”ì²œ: Hybrid ë°©ì‹</h2><ul><li><strong>ì´ˆê¸° ì‹¤í–‰ì—ëŠ” Predictive ëª¨ë¸ + Heuristic ë³´ì •</strong></li><li>ì´í›„ ìì£¼ ì“°ì´ëŠ” configì—ëŠ” RL ê¸°ë°˜ íŠœë„ˆë¥¼ í•™ìŠµ</li></ul><p>â†’ ì´ˆê¸° latencyëŠ” ë‚®ì¶”ê³ , ì¥ê¸°ì ìœ¼ë¡œ <strong>ì‹¤í–‰ í™˜ê²½ ë³€í™”ì— ì ì‘ ê°€ëŠ¥</strong>í•œ êµ¬ì¡° í™•ë³´</p><hr><h2 id=-ê²°ë¡ -1>âœ… ê²°ë¡ </h2><p><strong>Cometì˜ static profiling ê¸°ë°˜ thread block assignmentëŠ” ê³ ì •ëœ configì—ì„œëŠ” ë§¤ìš° ê°•ë ¥í•˜ì§€ë§Œ,</strong> ë™ì  í™˜ê²½/ëª¨ë¸ êµ¬ì¡°/ì…ë ¥ ë³€ë™ì—ëŠ” ë¯¼ê°í•©ë‹ˆë‹¤. ì´ë¥¼ ê·¹ë³µí•˜ê¸° ìœ„í•´ì„œëŠ”:</p><ol><li>RL ê¸°ë°˜ auto-tuner (ê°•ë ¥í•˜ì§€ë§Œ ë³µì¡)</li><li>Heuristic feedback loop (ê°„ë‹¨í•˜ê³  ë¹ ë¦„)</li><li>Cost model ê¸°ë°˜ prediction (ì„±ëŠ¥ ì˜ˆì¸¡ ì •í™•)</li></ol><p>ì„ ì¡°í•©í•œ <strong>ì‹¤ì‹œê°„ hybrid thread block scheduler</strong>ê°€ ê°€ì¥ í˜„ì‹¤ì ì´ë©° íš¨ê³¼ì ì¸ ëŒ€ì•ˆì…ë‹ˆë‹¤. ì´ëŸ¬í•œ ë°©ì‹ì€ Cometì„ ë” ë„“ì€ ë²”ìœ„ì˜ ëª¨ë¸ê³¼ ìƒí™©ì— ì ìš© ê°€ëŠ¥í•œ <strong>ë²”ìš© MoE ì‹œìŠ¤í…œ</strong>ìœ¼ë¡œ í™•ì¥í•˜ëŠ” ë° í•µì‹¬ ê¸°ì—¬ë¥¼ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p></article></main><footer class="mx-auto max-w-4xl px-4 py-8"><div class="px-6 py-6"><nav class=mb-6><div class="flex flex-wrap items-center justify-center gap-1"><a href=/index.xml class="nav-link hover:text-primary hover:bg-primary/10 text-muted-foreground flex items-center gap-2 rounded-lg px-4 py-2 text-sm font-medium transition-all duration-300 hover:scale-105"><svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="RSS Feed"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 5c7.18.0 13 5.82 13 13M6 11a7 7 0 017 7m-6 0a1 1 0 11-2 0 1 1 0 012 0z"/></svg>
<span>RSS Feed</span></a></div></nav><div class="border-border mb-6 border-t"></div><div class="flex flex-col items-center justify-between gap-4 md:flex-row"><div class="text-muted-foreground text-sm"><p>&copy; 2025 Jaehun's Blog.
ëª¨ë“  ê¶Œë¦¬ ë³´ìœ .</p></div><div class="flex items-center gap-3"><a href=https://github.com/ryujaehun target=_blank rel="noopener noreferrer" class="text-muted-foreground hover:text-primary focus:ring-primary/20 rounded-lg p-1 transition-all duration-300 ease-out hover:scale-110 focus:ring-2 focus:outline-none" title=GitHub aria-label=GitHub><svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="GitHub"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"><path d="M15 22v-4a4.8 4.8.0 00-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35.0-3.5.0.0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35.0 3.5A5.4 5.4.0 004 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65S8.93 17.38 9 18v4"/><path d="M9 18c-4.51 2-5-2-7-2"/></g></svg>
</a><a href=https://www.linkedin.com/in/jaehunryu/ target=_blank rel="noopener noreferrer" class="text-muted-foreground hover:text-primary focus:ring-primary/20 rounded-lg p-1 transition-all duration-300 ease-out hover:scale-110 focus:ring-2 focus:outline-none" title=Linkedin aria-label=Linkedin><svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="Linkedin"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"><path d="M16 8a6 6 0 016 6v7h-4v-7a2 2 0 00-2-2 2 2 0 00-2 2v7h-4v-7a6 6 0 016-6M2 9h4v12H2z"/><circle cx="4" cy="4" r="2"/></g></svg>
</a><a href=mailto:jaehunryu@icloud.com class="text-muted-foreground hover:text-primary focus:ring-primary/20 rounded-lg p-1 transition-all duration-300 ease-out hover:scale-110 focus:ring-2 focus:outline-none" title=Email aria-label=Email><svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="Email"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22.0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5A2 2 0 003 7v10a2 2 0 002 2z"/></svg></a></div></div></div></footer><div id=dock class="pointer-events-none fixed bottom-4 left-1/2 z-[9999] w-fit -translate-x-1/2 translate-y-24 opacity-0 transition-all duration-300 ease-out sm:right-0 sm:left-0 sm:mx-auto sm:translate-x-0" role=toolbar aria-label="ë°”ë¡œê°€ê¸° ë„êµ¬ ëª¨ìŒ"><nav class="border-border bg-card/80 scrollbar-hide xs:px-3 xs:py-2 mx-auto flex max-w-[calc(100vw-2rem)] min-w-fit items-center justify-center overflow-x-auto rounded-2xl border px-4 py-3 shadow-lg backdrop-blur-sm sm:px-4 sm:py-3"><button id=dock-back class="text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 xs:px-2 xs:py-1.5 flex flex-shrink-0 items-center gap-2 rounded-lg px-3 py-2 text-sm font-medium transition-all duration-300 ease-out hover:-translate-y-0.5 hover:scale-105 focus:ring-2 focus:outline-none sm:px-3 sm:py-2" title=ë’¤ë¡œ aria-label=ë’¤ë¡œ>
<svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="m12 19-7-7 7-7"/><path d="M19 12H5"/></svg>
<span class="hidden sm:inline">ë’¤ë¡œ</span></button><div class="bg-border xs:mx-1 mx-2 h-6 w-px sm:mx-2"></div><button id=dock-toc class="text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 xs:px-2 xs:py-1.5 flex flex-shrink-0 items-center gap-2 rounded-lg px-3 py-2 text-sm font-medium transition-all duration-300 ease-out hover:-translate-y-0.5 hover:scale-105 focus:ring-2 focus:outline-none sm:px-3 sm:py-2" title=ëª©ì°¨ aria-label=ëª©ì°¨>
<svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><line x1="8" x2="21" y1="6" y2="6"/><line x1="8" x2="21" y1="12" y2="12"/><line x1="8" x2="21" y1="18" y2="18"/><line x1="3" x2="3.01" y1="6" y2="6"/><line x1="3" x2="3.01" y1="12" y2="12"/><line x1="3" x2="3.01" y1="18" y2="18"/></svg>
<span class="hidden sm:inline">ëª©ì°¨</span></button><div class="bg-border xs:mx-1 mx-2 h-6 w-px sm:mx-2"></div><button id=dock-search class="text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 xs:px-3 xs:py-1.5 flex flex-shrink-0 items-center gap-2 rounded-lg px-4 py-2 text-sm font-medium transition-all duration-300 ease-out hover:-translate-y-0.5 hover:scale-105 focus:ring-2 focus:outline-none sm:px-4 sm:py-2" title=ê²€ìƒ‰ aria-label=ê²€ìƒ‰>
<svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m21 21-6-6m2-5A7 7 0 113 10a7 7 0 0114 0z"/></svg>
<span class="hidden md:inline">ê²€ìƒ‰</span></button><div class="bg-border xs:mx-1 mx-2 h-6 w-px sm:mx-2"></div><button id=dock-top class="text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 xs:px-2 xs:py-1.5 flex flex-shrink-0 items-center gap-2 rounded-lg px-3 py-2 text-sm font-medium transition-all duration-300 ease-out hover:-translate-y-0.5 hover:scale-105 focus:ring-2 focus:outline-none sm:px-3 sm:py-2" title="ë§¨ ìœ„ë¡œ" aria-label="ë§¨ ìœ„ë¡œ">
<svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="m18 15-6-6-6 6"/></svg>
<span class="hidden sm:inline">ë§¨ ìœ„ë¡œ</span></button></nav></div><div id=toc-overlay class="pointer-events-none fixed inset-0 z-40 bg-black/50 opacity-0 backdrop-blur-sm transition-all duration-300" role=dialog aria-modal=true aria-labelledby=toc-title></div><div id=toc-card class="pointer-events-none fixed inset-4 z-50 flex w-auto scale-95 items-center justify-center opacity-0 transition-all duration-300 sm:inset-auto sm:top-1/2 sm:left-1/2 sm:block sm:w-full sm:max-w-md sm:-translate-x-1/2 sm:-translate-y-1/2" role=dialog aria-modal=true aria-labelledby=toc-title><div class="bg-card border-border w-full max-w-sm overflow-hidden rounded-xl border shadow-xl sm:max-w-md"><div class="border-border bg-muted/30 flex items-center justify-between border-b p-4"><div class="flex items-center gap-3"><svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><line x1="8" x2="21" y1="6" y2="6"/><line x1="8" x2="21" y1="12" y2="12"/><line x1="8" x2="21" y1="18" y2="18"/><line x1="3" x2="3.01" y1="6" y2="6"/><line x1="3" x2="3.01" y1="12" y2="12"/><line x1="3" x2="3.01" y1="18" y2="18"/></svg><h2 id=toc-title class="text-foreground text-lg font-semibold">ëª©ì°¨</h2></div><button id=toc-close class="text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 rounded-lg p-2 transition-all duration-200 ease-out hover:-translate-y-0.5 hover:scale-105 focus:ring-2 focus:outline-none" title=ë‹«ê¸° aria-label=ë‹«ê¸°>
<svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18 18 6M6 6l12 12"/></svg></button></div><div class="max-h-96 overflow-y-auto p-4"><nav id=toc-nav class=toc-scrollbar aria-label="ê¸€ ëª©ì°¨"><div id=toc-content><nav id=TableOfContents><ul><li><a href=#-ê²°ë¡ -ìš”ì•½>ğŸ“Œ ê²°ë¡  ìš”ì•½</a></li><li><a href=#-í•µì‹¬-ê¸°ì—¬-ë°-ë…ì°½ì„±>ğŸ§  í•µì‹¬ ê¸°ì—¬ ë° ë…ì°½ì„±</a></li><li><a href=#-í•µì‹¬-ì•Œê³ ë¦¬ì¦˜-ì„¤ëª…-ì˜ˆì‹œ-ê¸°ë°˜>ğŸ” í•µì‹¬ ì•Œê³ ë¦¬ì¦˜ ì„¤ëª… (ì˜ˆì‹œ ê¸°ë°˜)</a><ul><li><a href=#ë¬¸ì œ-ìƒí™©>ë¬¸ì œ ìƒí™©:</a></li><li><a href=#ì˜ˆì‹œ-ì…ë ¥>ì˜ˆì‹œ ì…ë ¥:</a></li><li><a href=#comet-ì²˜ë¦¬-íë¦„>Comet ì²˜ë¦¬ íë¦„:</a></li></ul></li><li><a href=#-ì„±ëŠ¥-ë¶„ì„-ì‹¤í—˜-ê²°ê³¼>ğŸ§ª ì„±ëŠ¥ ë¶„ì„ (ì‹¤í—˜ ê²°ê³¼)</a></li><li><a href=#-í•œê³„ì -ë°-í–¥í›„-ë°©í–¥>âš ï¸ í•œê³„ì  ë° í–¥í›„ ë°©í–¥</a></li><li><a href=#-ìš”ì•½>ğŸ’¡ ìš”ì•½</a></li></ul><ul><li><a href=#-í•µì‹¬-ì•Œê³ ë¦¬ì¦˜-êµ¬ì¡°-ìš”ì•½>ğŸ§© í•µì‹¬ ì•Œê³ ë¦¬ì¦˜ êµ¬ì¡° ìš”ì•½</a></li><li><a href=#-ì˜ˆì‹œ-ì„¤ì •>ğŸ” ì˜ˆì‹œ ì„¤ì •</a><ul><li><a href=#ëª¨ë¸-ì„¤ì •>ëª¨ë¸ ì„¤ì •</a></li></ul></li><li><a href=#--shared-tensor-ê¸°ë°˜-dependency-resolving>ğŸ§  â‘  Shared Tensor ê¸°ë°˜ Dependency Resolving</a><ul><li><a href=#-ëª©ì >ğŸ’¡ ëª©ì </a></li><li><a href=#-moe-layer0ì˜-ì˜ˆ>ğŸ“Œ MoE Layer0ì˜ ì˜ˆ</a><ul><li><a href=#-step-1-shared-tensor-ë¶„í•´-decompose>âœ… Step 1: Shared Tensor ë¶„í•´ (Decompose)</a></li><li><a href=#-step-2-ì¬ìŠ¤ì¼€ì¤„-reschedule>âœ… Step 2: ì¬ìŠ¤ì¼€ì¤„ (Reschedule)</a></li></ul></li><li><a href=#-moe-layer1ì˜-ì˜ˆ>ğŸ“Œ MoE Layer1ì˜ ì˜ˆ</a><ul><li><a href=#-step-1-shared-tensor-ë¶„í•´-decompose-1>âœ… Step 1: Shared Tensor ë¶„í•´ (Decompose)</a></li><li><a href=#-step-2-ì¬ìŠ¤ì¼€ì¤„>âœ… Step 2: ì¬ìŠ¤ì¼€ì¤„</a></li></ul></li></ul></li><li><a href=#--adaptive-workload-assignment>ğŸ§  â‘¡ Adaptive Workload Assignment</a><ul><li><a href=#-ëª©ì -1>ğŸ’¡ ëª©ì </a></li><li><a href=#ì˜ˆì‹œ>ì˜ˆì‹œ</a><ul><li><a href=#ë¬¸ì œ-ì–´ë–¤-ë¹„ìœ¨ì´-ìµœì ì¼ê¹Œ>ë¬¸ì œ: ì–´ë–¤ ë¹„ìœ¨ì´ ìµœì ì¼ê¹Œ?</a></li><li><a href=#í•´ê²°>í•´ê²°:</a></li></ul></li></ul></li><li><a href=#-ì „ì²´-ì‹¤í–‰-íë¦„-ìš”ì•½>ğŸ¯ ì „ì²´ ì‹¤í–‰ íë¦„ ìš”ì•½</a></li><li><a href=#-ì‹œê°í™”-ìš”ì•½>ğŸ“Œ ì‹œê°í™” ìš”ì•½</a></li><li><a href=#-ìš”ì•½-ì •ë¦¬>âœ… ìš”ì•½ ì •ë¦¬</a></li></ul><ul><li><a href=#-ì‹¤í—˜-ê²°ê³¼-ìš”ì•½-ìˆ˜ì¹˜ë¡œ-ë³´ëŠ”-cometì˜-ê°•ì >âœ… ì‹¤í—˜ ê²°ê³¼ ìš”ì•½: ìˆ˜ì¹˜ë¡œ ë³´ëŠ” Cometì˜ ê°•ì </a><ul><li><a href=#1--end-to-end-ëª¨ë¸-ì„±ëŠ¥-ë¹„êµ>1. ğŸ“ˆ End-to-End ëª¨ë¸ ì„±ëŠ¥ ë¹„êµ</a></li><li><a href=#2--ë‹¨ì¼-moe-layer-ì„±ëŠ¥>2. ğŸ” ë‹¨ì¼ MoE Layer ì„±ëŠ¥</a></li><li><a href=#3--í†µì‹ -overlap-íš¨ê³¼>3. ğŸ¯ í†µì‹  Overlap íš¨ê³¼</a></li></ul></li><li><a href=#-cometì´-íŠ¹ì¶œë‚¬ë˜-ì´ìœ -ë…¼ë¬¸ì—ì„œ-ì œì‹œí•œ-ì£¼ì¥>ğŸ” Cometì´ íŠ¹ì¶œë‚¬ë˜ ì´ìœ  (ë…¼ë¬¸ì—ì„œ ì œì‹œí•œ ì£¼ì¥)</a><ul><li><a href=#-1-fine-grained-ìˆ˜ì¤€ì—ì„œì˜-ì—°ì‚°í†µì‹ -ë³‘ë ¬í™”>ğŸ¯ 1. Fine-grained ìˆ˜ì¤€ì—ì„œì˜ ì—°ì‚°/í†µì‹  ë³‘ë ¬í™”</a></li><li><a href=#-2-fused-kernel-ë‚´-thread-block-specialization>ğŸ¯ 2. Fused kernel ë‚´ thread block specialization</a></li><li><a href=#-3-adaptive-workload-assignment>ğŸ¯ 3. Adaptive workload assignment</a></li><li><a href=#-4-host-scheduling-ì œê±°>ğŸ¯ 4. Host scheduling ì œê±°</a></li></ul></li><li><a href=#-ë‚´-ìƒê°-cometì´-ì™œ-ì°¨ë³„ì ì¸ê°€>ğŸ§  ë‚´ ìƒê°: Cometì´ ì™œ ì°¨ë³„ì ì¸ê°€?</a><ul><li><a href=#-í•µì‹¬-í†µì°°>ğŸ“Œ í•µì‹¬ í†µì°°:</a></li></ul></li><li><a href=#-í–¥í›„-í™•ì¥-ê°€ëŠ¥ì„±>ğŸ’¬ í–¥í›„ í™•ì¥ ê°€ëŠ¥ì„±</a></li><li><a href=#-ìš”ì•½-ì •ë¦¬-1>âœ… ìš”ì•½ ì •ë¦¬</a></li></ul><ul><li><ul><li><a href=#-1-ì£¼ìš”-ë°ì´í„°-êµ¬ì¡°-ì •ì˜>ğŸ“¦ 1. ì£¼ìš” ë°ì´í„° êµ¬ì¡° ì •ì˜</a></li><li><a href=#-2-dependency-resolving-shared-tensor-ë¶„í•´--ì¬ìŠ¤ì¼€ì¤„>ğŸ”„ 2. Dependency Resolving: shared tensor ë¶„í•´ + ì¬ìŠ¤ì¼€ì¤„</a></li><li><a href=#-3-adaptive-thread-block-assignment>âš™ï¸ 3. Adaptive Thread Block Assignment</a></li><li><a href=#-4-fused-kernel-ì‹¤í–‰-ì»¤ë„-ë‚´ë¶€-ë™ì‘-ì¶”ìƒí™”>ğŸš€ 4. Fused Kernel ì‹¤í–‰ (ì»¤ë„ ë‚´ë¶€ ë™ì‘ ì¶”ìƒí™”)</a></li><li><a href=#-ì „ì²´-ì‹¤í–‰-íë¦„-ì •ë¦¬>ğŸ§  ì „ì²´ ì‹¤í–‰ íë¦„ ì •ë¦¬</a></li></ul></li><li><a href=#-ì£¼ì„-ìš”ì•½-í¬ì¸íŠ¸>âœ… ì£¼ì„ ìš”ì•½ í¬ì¸íŠ¸</a></li></ul><ul><li><a href=#1--ì˜ˆì‹œ-ê¸°ë°˜-ì…ë ¥-ë°ì´í„°ì™€-ì¶”ë¡ -ê³¼ì •>1. ğŸ“¥ ì˜ˆì‹œ ê¸°ë°˜ ì…ë ¥ ë°ì´í„°ì™€ ì¶”ë¡  ê³¼ì •</a><ul><li><a href=#-ì˜ˆì‹œ-mixtral-8x7b-ëª¨ë¸-ê¸°ì¤€-ë…¼ë¬¸-ì‹¤í—˜-ëŒ€ìƒ>ğŸ“Œ ì˜ˆì‹œ: Mixtral-8x7B ëª¨ë¸ ê¸°ì¤€ (ë…¼ë¬¸ ì‹¤í—˜ ëŒ€ìƒ)</a></li><li><a href=#-ì¶”ë¡ -ì „ì²˜ë¦¬-ë°-ë¼ìš°íŒ…-token-routing>ğŸ” ì¶”ë¡  ì „ì²˜ë¦¬ ë° ë¼ìš°íŒ… (Token Routing)</a></li><li><a href=#-expert-computation-moe-layer-0>ğŸ§  Expert Computation (MoE Layer 0)</a></li><li><a href=#-ê²°ê³¼-ë³‘í•©-moe-layer-1>ğŸ“¤ ê²°ê³¼ ë³‘í•© (MoE Layer 1)</a></li></ul></li><li><a href=#2--ëª¨ë¸-ì•„í‚¤í…ì²˜-êµ¬ì„±-comet-ê´€ì >2. ğŸ—ï¸ ëª¨ë¸ ì•„í‚¤í…ì²˜ êµ¬ì„± (Comet ê´€ì )</a><ul><li><a href=#ì „ì²´-êµ¬ì¡°-1-transformer-block-ê¸°ì¤€>ì „ì²´ êµ¬ì¡° (1 Transformer block ê¸°ì¤€)</a></li></ul></li><li><a href=#3--ì—°ì‚°ëŸ‰computational-cost-ë¶„ì„>3. ğŸ“Š ì—°ì‚°ëŸ‰(Computational Cost) ë¶„ì„</a><ul><li><a href=#-moe-layer-ê¸°ì¤€-í•œ-expertì˜-ffn>âœ… MoE Layer ê¸°ì¤€: í•œ expertì˜ FFN</a></li></ul></li><li><a href=#4--ë©”ëª¨ë¦¬-ìš”êµ¬ëŸ‰>4. ğŸ§  ë©”ëª¨ë¦¬ ìš”êµ¬ëŸ‰</a><ul><li><a href=#shared-tensor-í¬ê¸°>Shared Tensor í¬ê¸°</a></li></ul></li><li><a href=#5--cometì—ì„œì˜-ìµœì í™”-ìš”ì†Œ-ë°˜ì˜>5. ğŸ§© Cometì—ì„œì˜ ìµœì í™” ìš”ì†Œ ë°˜ì˜</a></li><li><a href=#-ì •ë¦¬-ìš”ì•½>âœ… ì •ë¦¬ ìš”ì•½</a></li></ul><ul><li><a href=#-cometì˜-ì£¼ìš”-í•œê³„-ìš”ì•½>âœ… Cometì˜ ì£¼ìš” í•œê³„ ìš”ì•½</a></li><li><a href=#-í•œê³„-ê·¹ë³µì„-ìœ„í•œ-ì—°êµ¬-íë¦„ë³„-ì •ë¦¬>ğŸ” í•œê³„ ê·¹ë³µì„ ìœ„í•œ ì—°êµ¬ íë¦„ë³„ ì •ë¦¬</a><ul><li><a href=#-1-ì»´íŒŒì¼ëŸ¬-ê¸°ë°˜-ìë™í™”-tvm-triton-unity>ğŸ§  [1] ì»´íŒŒì¼ëŸ¬ ê¸°ë°˜ ìë™í™”: TVM, Triton, Unity</a></li><li><a href=#-2-ë„¤íŠ¸ì›Œí¬í† í´ë¡œì§€-ìµœì í™”-hierarchical-all-to-all--topology-aware-scheduling>ğŸŒ [2] ë„¤íŠ¸ì›Œí¬/í† í´ë¡œì§€ ìµœì í™”: Hierarchical All-to-All & Topology-aware Scheduling</a></li><li><a href=#-3-onlineruntime-ì¬êµ¬ì„±-dynamic-expert-scheduling--adaptive-routing>ğŸ”„ [3] Online/Runtime ì¬êµ¬ì„±: Dynamic Expert Scheduling & Adaptive Routing</a></li><li><a href=#-4-ë‹¤ë¥¸-ì—°ì‚°ìì™€ì˜-í†µí•©-attention-moe-fusion-cross-block-scheduling>ğŸ”€ [4] ë‹¤ë¥¸ ì—°ì‚°ìì™€ì˜ í†µí•©: Attention-MoE Fusion, Cross-block Scheduling</a></li></ul></li><li><a href=#-ë¹„êµ-ìš”ì•½-í…Œì´ë¸”-ì—°êµ¬-íë¦„ë³„-íŠ¹ì§•>ğŸ“Œ ë¹„êµ ìš”ì•½ í…Œì´ë¸”: ì—°êµ¬ íë¦„ë³„ íŠ¹ì§•</a></li><li><a href=#-ì •ë¦¬>âœ… ì •ë¦¬</a></li></ul><ul><li><a href=#-cometì˜-granularity-level-ìµœì í™”>âœ… Cometì˜ granularity-level ìµœì í™”</a><ul><li><a href=#1-ê¸°ì¡´-ì‹œìŠ¤í…œì˜-í•œê³„-coarse-grained-overlap>1. ê¸°ì¡´ ì‹œìŠ¤í…œì˜ í•œê³„ (Coarse-Grained Overlap)</a></li><li><a href=#2-cometì˜-fine-grained-overlapping-ë°©ì‹>2. Cometì˜ fine-grained overlapping ë°©ì‹</a></li></ul></li><li><a href=#-êµ¬ì¡°ì -trade-off>âš ï¸ êµ¬ì¡°ì  trade-off</a><ul><li><a href=#1-ì»¤ë„-ë³µì¡ë„-ì¦ê°€-ë°-êµ¬í˜„-ë¶€ë‹´>1. ì»¤ë„ ë³µì¡ë„ ì¦ê°€ ë° êµ¬í˜„ ë¶€ë‹´</a></li><li><a href=#2-í•˜ë“œì›¨ì–´-ì¢…ì†ì„±-ì¦ê°€>2. í•˜ë“œì›¨ì–´ ì¢…ì†ì„± ì¦ê°€</a></li><li><a href=#3-ì»´íŒŒì¼ëŸ¬-ìµœì í™”ì™€ì˜-í†µí•©-ì–´ë ¤ì›€>3. ì»´íŒŒì¼ëŸ¬ ìµœì í™”ì™€ì˜ í†µí•© ì–´ë ¤ì›€</a></li></ul></li><li><a href=#-ìš”ì•½-1>ğŸ” ìš”ì•½</a></li></ul><ul><li><a href=#-1-cometì—ì„œ-mn-ë°©í–¥-ë¶„í•´-ê¸°ì¤€>âœ… 1. Cometì—ì„œ M/N ë°©í–¥ ë¶„í•´ ê¸°ì¤€</a><ul><li><a href=#shared-tensorì˜-ì—­í• >Shared Tensorì˜ ì—­í• </a></li><li><a href=#moe-layer-0-all-to-all--gemm>MoE Layer 0 (All-to-All â†’ GEMM)</a></li><li><a href=#moe-layer-1-gemm2--combine>MoE Layer 1 (GEMM2 â†’ Combine)</a></li></ul></li><li><a href=#-2-ì¼ë°˜í™”-ì‹œ-ê¸°ì¤€>âœ… 2. ì¼ë°˜í™” ì‹œ ê¸°ì¤€</a></li><li><a href=#-3-ì—°ì‚°ìë³„-ì ìš©-ê°€ëŠ¥ì„±ê³¼-ì œì•½>âœ… 3. ì—°ì‚°ìë³„ ì ìš© ê°€ëŠ¥ì„±ê³¼ ì œì•½</a><ul><li><a href=#-self-attention-qkt-softmax-v-ê³±>ğŸ§  Self-Attention (QK^T, softmax, V ê³±)</a></li><li><a href=#-layernorm>ğŸ§ª LayerNorm</a></li></ul></li><li><a href=#-ìš”ì•½-ì •ë¦¬-2>âœ… ìš”ì•½ ì •ë¦¬</a></li><li><a href=#-ê²°ë¡ >ğŸ“Œ ê²°ë¡ </a></li></ul><ul><li><a href=#-ë¬¸ì œ-ìš”ì•½-ì™œ-ë¬¸ì œê°€-ë˜ëŠ”ê°€>âœ… ë¬¸ì œ ìš”ì•½: ì™œ ë¬¸ì œê°€ ë˜ëŠ”ê°€?</a></li><li><a href=#-í•´ê²°-ë°©í–¥-online-scheduling-ê¸°ë²•-ì ìš©>âœ… í•´ê²° ë°©í–¥: Online Scheduling ê¸°ë²• ì ìš©</a><ul><li><a href=#1--reinforcement-learning-ê¸°ë°˜-thread-block-íŠœë„ˆ-runtime-auto-tuner>1. ğŸ” Reinforcement Learning ê¸°ë°˜ Thread Block íŠœë„ˆ (Runtime Auto-Tuner)</a></li><li><a href=#2--lightweight-heuristic-rule--í”¼ë“œë°±-ë³´ì •-latency-ratio-tuning>2. ğŸ“Š Lightweight Heuristic Rule + í”¼ë“œë°± ë³´ì • (Latency Ratio Tuning)</a></li><li><a href=#3--predictive-performance-modeling-dynamic-cost-model>3. ğŸ“ˆ Predictive Performance Modeling (Dynamic Cost Model)</a></li></ul></li><li><a href=#-ìš”ì•½-ë¹„êµí‘œ>ğŸ“Œ ìš”ì•½ ë¹„êµí‘œ</a></li><li><a href=#-ì¶”ì²œ-hybrid-ë°©ì‹>âœ… ì¶”ì²œ: Hybrid ë°©ì‹</a></li><li><a href=#-ê²°ë¡ -1>âœ… ê²°ë¡ </a></li></ul></nav></div></nav></div><div class="border-border bg-muted/20 border-t px-4 py-3"><div class="text-muted-foreground text-center text-xs"><span>ì œëª©ì„ í´ë¦­í•˜ë©´ í•´ë‹¹ ìœ„ì¹˜ë¡œ ì´ë™í•©ë‹ˆë‹¤</span></div></div></div></div><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.css integrity=sha384-5TcZemv2l/9On385z///+d7MSYlvIEw9FuZTIdZ14vJLqWphw7e7ZPuOiCHJcFCP crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.js integrity=sha384-cMkvdD8LoxVzGF/RPUKAcvmm49FQ0oxwDF3BGKtDXcEc+T1b2N+teh/OJfpU0jr6 crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/contrib/auto-render.min.js integrity=sha384-hCXGrW6PitJEwbkoStFjeJxv+fSOOQKOPbJxSfM6G5sWZjAyWhXiTIIAmQqnlLlh crossorigin=anonymous></script><script>function initKaTeX(){if(typeof renderMathInElement=="undefined"){setTimeout(initKaTeX,100);return}var e=[{display:!0,left:"$$",right:"$$"},{display:!1,left:"$",right:"$"}];renderMathInElement(document.body,{delimiters:e,throwOnError:!1,errorColor:"#cc0000",fleqn:!1,leqno:!1,trust:!1})}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",initKaTeX):initKaTeX()</script><div id=search-overlay class="pointer-events-none fixed inset-0 z-40 bg-black/50 opacity-0 transition-opacity duration-300"></div><div id=search-modal class="bg-card border-border pointer-events-none fixed top-1/2 left-1/2 z-50 max-h-[80vh] w-full max-w-2xl -translate-x-1/2 -translate-y-1/2 scale-95 transform overflow-hidden rounded-xl border opacity-0 shadow-xl transition-all duration-300"><div class="border-border flex items-center gap-3 border-b p-4"><div class="text-muted-foreground h-5 w-5 flex-shrink-0"><svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m21 21-6-6m2-5A7 7 0 113 10a7 7 0 0114 0z"/></svg></div><div class="relative flex-1"><button id=search-clear class="text-muted-foreground hover:text-foreground hover:bg-muted/50 pointer-events-none absolute top-1/2 left-0 z-10 h-5 w-5 -translate-y-1/2 rounded opacity-0 transition-all duration-200" title=ì§€ìš°ê¸° aria-label=ì§€ìš°ê¸°>
<svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18 18 6M6 6l12 12"/></svg>
</button>
<input id=search-input type=text placeholder="ê²Œì‹œê¸€ ê²€ìƒ‰..." class="text-foreground placeholder:text-muted-foreground w-full border-none bg-transparent pl-8 text-lg outline-none" autocomplete=off spellcheck=false></div><button id=search-close class="text-muted-foreground hover:text-foreground hover:bg-muted/50 flex h-6 w-6 items-center justify-center rounded-md p-0.5 transition-all duration-200" title=ë‹«ê¸° aria-label=ë‹«ê¸°>
<svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18 18 6M6 6l12 12"/></svg></button></div><div id=search-results class="max-h-96 overflow-y-auto"><div id=search-empty class="flex flex-col items-center justify-center py-12 text-center"><div class="bg-muted/50 mb-4 flex h-16 w-16 items-center justify-center rounded-full"><svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m21 21-6-6m2-5A7 7 0 113 10a7 7 0 0114 0z"/></svg></div><h3 class="text-foreground mb-2 text-lg font-semibold">ê²€ìƒ‰ ì‹œì‘</h3><p class="text-muted-foreground text-sm">ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•˜ì„¸ìš”</p></div><div id=search-loading class="flex hidden items-center justify-center py-8"><div class="mr-3 h-6 w-6 animate-spin rounded-full border-2 border-current border-t-transparent"></div><span class=text-muted-foreground>ê²€ìƒ‰ ì¤‘...</span></div><div id=search-no-results class="flex hidden flex-col items-center justify-center py-12 text-center"><div class="bg-muted/50 mb-4 flex h-16 w-16 items-center justify-center rounded-full"><svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h7"/></svg></div><h3 class="text-foreground mb-2 text-lg font-semibold">ê²€ìƒ‰ ê²°ê³¼ ì—†ìŒ</h3><p class="text-muted-foreground text-sm">ë‹¤ë¥¸ ê²€ìƒ‰ì–´ë¡œ ì‹œë„í•´ë³´ì„¸ìš”</p></div><div id=search-results-list class=hidden><div id=search-stats class="text-muted-foreground border-border border-b px-4 py-3 text-sm" data-template="%dê°œì˜ ê²°ê³¼ ì°¾ìŒ"></div><div id=search-items class="divide-border divide-y"></div></div></div><div class="border-border bg-muted/20 border-t px-4 py-3"><div class="text-muted-foreground flex items-center justify-between text-xs"><div class="flex items-center gap-2 md:gap-4"><div class="flex items-center gap-1"><kbd class="bg-muted border-border rounded border px-1.5 py-0.5 text-xs">â†‘â†“</kbd>
<span class="hidden sm:inline">ì´ë™</span></div><div class="flex items-center gap-1"><kbd class="bg-muted border-border rounded border px-1.5 py-0.5 text-xs">â†µ</kbd>
<span class="hidden sm:inline">ì„ íƒ</span></div><div class="flex items-center gap-1"><kbd class="bg-muted border-border rounded border px-1.5 py-0.5 text-xs">ESC</kbd>
<span class="hidden sm:inline">ë‹«ê¸°</span></div></div><div class="search-hint-desktop flex items-center gap-1"><kbd class="bg-muted border-border rounded border px-1.5 py-0.5 text-xs">âŒ˜K</kbd>
<span>ë‹¨ì¶•í‚¤</span></div></div></div></div></body></html>