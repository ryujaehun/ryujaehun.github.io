<!doctype html><html lang=ko-kr data-theme=claude><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta http-equiv=X-UA-Compatible content="IE=edge"><title>Balancing Pipeline Parallelism with Vocabulary Parallelism | Jaehun's Blog</title><meta name=description content="ë…¼ë¬¸ ë§í¬
Q : ì´ ë…¼ë¬¸ì„ ì•„ì£¼ ìì„¸í•˜ê²Œ ì½ê³  ë…¼ë¬¸ì˜ ê°•ì ê³¼ ë…ì°½ì ì¸ ì§€ì ì„ ì„¤ëª…í•´ì£¼ê³  í•µì‹¬ ì•Œê³ ë¦¬ì¦˜ì„ ì˜ˆì‹œ ì…ë ¥ì„ ë“¤ì–´ì„œ ì „ì²´ì ì¸ ê³¼ì •ì„ ì„¤ëª…í•´ì¤˜ ì¶”ê°€ì ìœ¼ë¡œ ë…¼ë¬¸ì˜ í•œê³„ì ì— ëŒ€í•´ì„œë„ ì•Œë ¤ì¤˜ ë…¼ë¬¸ì˜ í•µì‹¬ ë‚´ìš©ì„ ìš”ì•½í•˜ë©´ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.
ê²°ë¡  ìš”ì•½ ì´ ë…¼ë¬¸ì€ íŒŒì´í”„ë¼..."><meta name=keywords content="ê°œë°œ,í”„ë¡œê·¸ë˜ë°,ì—ì„¸ì´"><meta name=author content><meta name=language content="ko"><meta name=robots content="index, follow"><link rel=canonical href=https://jaehun.me/ko/ko/posts/2025-03-17-paper-2411.05288/><link rel=icon type=image/svg+xml href=/favicon.svg><link rel=manifest href=/site.webmanifest><meta property="og:url" content="https://jaehun.me/ko/ko/posts/2025-03-17-paper-2411.05288/"><meta property="og:site_name" content="Jaehun's Blog"><meta property="og:title" content="Balancing Pipeline Parallelism with Vocabulary Parallelism"><meta property="og:description" content="ë…¼ë¬¸ ë§í¬
Q : ì´ ë…¼ë¬¸ì„ ì•„ì£¼ ìì„¸í•˜ê²Œ ì½ê³  ë…¼ë¬¸ì˜ ê°•ì ê³¼ ë…ì°½ì ì¸ ì§€ì ì„ ì„¤ëª…í•´ì£¼ê³  í•µì‹¬ ì•Œê³ ë¦¬ì¦˜ì„ ì˜ˆì‹œ ì…ë ¥ì„ ë“¤ì–´ì„œ ì „ì²´ì ì¸ ê³¼ì •ì„ ì„¤ëª…í•´ì¤˜ ì¶”ê°€ì ìœ¼ë¡œ ë…¼ë¬¸ì˜ í•œê³„ì ì— ëŒ€í•´ì„œë„ ì•Œë ¤ì¤˜ ë…¼ë¬¸ì˜ í•µì‹¬ ë‚´ìš©ì„ ìš”ì•½í•˜ë©´ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤."><meta property="og:locale" content="ko_kr"><meta property="og:type" content="article"><meta property="article:section" content="ko"><meta property="article:published_time" content="2025-03-17T00:00:00+00:00"><meta property="article:modified_time" content="2025-03-17T00:00:00+00:00"><meta property="og:image" content="https://jaehun.me/images/og-default.avif"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://jaehun.me/images/og-default.avif"><meta name=twitter:title content="Balancing Pipeline Parallelism with Vocabulary Parallelism"><meta name=twitter:description content="ë…¼ë¬¸ ë§í¬
Q : ì´ ë…¼ë¬¸ì„ ì•„ì£¼ ìì„¸í•˜ê²Œ ì½ê³  ë…¼ë¬¸ì˜ ê°•ì ê³¼ ë…ì°½ì ì¸ ì§€ì ì„ ì„¤ëª…í•´ì£¼ê³  í•µì‹¬ ì•Œê³ ë¦¬ì¦˜ì„ ì˜ˆì‹œ ì…ë ¥ì„ ë“¤ì–´ì„œ ì „ì²´ì ì¸ ê³¼ì •ì„ ì„¤ëª…í•´ì¤˜ ì¶”ê°€ì ìœ¼ë¡œ ë…¼ë¬¸ì˜ í•œê³„ì ì— ëŒ€í•´ì„œë„ ì•Œë ¤ì¤˜ ë…¼ë¬¸ì˜ í•µì‹¬ ë‚´ìš©ì„ ìš”ì•½í•˜ë©´ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤."><meta itemprop=name content="Balancing Pipeline Parallelism with Vocabulary Parallelism"><meta itemprop=description content="ë…¼ë¬¸ ë§í¬
Q : ì´ ë…¼ë¬¸ì„ ì•„ì£¼ ìì„¸í•˜ê²Œ ì½ê³  ë…¼ë¬¸ì˜ ê°•ì ê³¼ ë…ì°½ì ì¸ ì§€ì ì„ ì„¤ëª…í•´ì£¼ê³  í•µì‹¬ ì•Œê³ ë¦¬ì¦˜ì„ ì˜ˆì‹œ ì…ë ¥ì„ ë“¤ì–´ì„œ ì „ì²´ì ì¸ ê³¼ì •ì„ ì„¤ëª…í•´ì¤˜ ì¶”ê°€ì ìœ¼ë¡œ ë…¼ë¬¸ì˜ í•œê³„ì ì— ëŒ€í•´ì„œë„ ì•Œë ¤ì¤˜ ë…¼ë¬¸ì˜ í•µì‹¬ ë‚´ìš©ì„ ìš”ì•½í•˜ë©´ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤."><meta itemprop=datePublished content="2025-03-17T00:00:00+00:00"><meta itemprop=dateModified content="2025-03-17T00:00:00+00:00"><meta itemprop=wordCount content="17449"><meta itemprop=image content="https://jaehun.me/images/og-default.avif"><meta itemprop=keywords content="Paper-Review,With-Gpt"><script>window.HUGO_SEARCH_CONFIG={searchIndexURL:'"/ko/index.json"'}</script><script>window.HUGO_GALLERY_CONFIG={justified_gallery:!1,lightbox:!1,justified:"{}",lightbox_options:"{}"}</script><link rel=stylesheet href=/css/compiled.min.9165cace5b80a5be5daad6ea96eb2abc20a18a3f41d7fed7f0335b689fdf7883.css integrity="sha256-kWXKzluApb5dqtbqlusqvCChij9B1/7X8DNbaJ/feIM=" crossorigin=anonymous><link rel=stylesheet href=/css/chroma.min.491df36221f739b5948a747a0351f100ee7ccaaf466d9f46288bf06de1d59123.css integrity="sha256-SR3zYiH3ObWUinR6A1HxAO58yq9GbZ9GKIvwbeHVkSM=" crossorigin=anonymous><script src=/js/main.ba969e49a7a874e6938fe689a7dcaa00cb64cb4d429c2cf98d09bde512a16c6d.js integrity="sha256-upaeSaeodOaTj+aJp9yqAMtky01CnCz5jQm95RKhbG0=" crossorigin=anonymous></script><script src=/js/gumshoe.polyfills.min.js></script><script src=/js/toc.70654aebf0b738a78ae2df95297cc10ebc6e590f3c942dd1325fa852f50038b2.js integrity="sha256-cGVK6/C3OKeK4t+VKXzBDrxuWQ88lC3RMl+oUvUAOLI=" crossorigin=anonymous defer></script><script src=/js/search.de3eba3540834efb8328121784bff4774e06362412ee41eee665f5b4f987f393.js integrity="sha256-3j66NUCDTvuDKBIXhL/0d04GNiQS7kHu5mX1tPmH85M=" crossorigin=anonymous defer></script><script src=/js/dock.e02f422517e001d9fb6bea1e9e8b0e89e9d2e486ad4641f275bb3e36ce2ae79f.js integrity="sha256-4C9CJRfgAdn7a+oenosOienS5IatRkHydbs+Ns4q558=" crossorigin=anonymous defer></script><script>(function(){const e=localStorage.getItem("theme")||"system",n=localStorage.getItem("colorScheme")||"claude";document.documentElement.setAttribute("data-theme",n);function t(){e==="dark"||e==="system"&&window.matchMedia("(prefers-color-scheme: dark)").matches?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")}t(),e==="system"&&window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",t)})()</script></head><body class="bg-background text-foreground min-h-screen antialiased"><div id=reading-progress-container class="reading-progress-container pointer-events-none fixed top-0 right-0 left-0 z-50 transition-opacity duration-300 ease-out" data-height=3 data-smooth-scroll=true data-hide-on-complete=false><div class="reading-progress-bg w-full"></div><div id=reading-progress-bar class="from-primary to-primary/80 reading-progress-bar
transition-all duration-150 ease-out
absolute top-0 left-0 w-0 bg-gradient-to-r"></div></div><script>(function(){"use strict";const t=document.getElementById("reading-progress-container"),o=document.getElementById("reading-progress-bar");if(!t||!o)return;const a={smoothScroll:t.dataset.smoothScroll==="true",hideOnComplete:t.dataset.hideOnComplete==="true"};let n=!0,l=null;function r(){const t=window.pageYOffset||document.documentElement.scrollTop,n=document.documentElement.scrollHeight,s=window.innerHeight,e=n-s;return e<=0?0:Math.min(Math.max(t/e*100,0),100)}function c(){const e=r();o.style.width=e+"%",a.hideOnComplete&&e>=99.5?n&&(t.style.opacity="0",n=!1):n||(t.style.opacity="1",n=!0)}let s=!1;function e(){s||(requestAnimationFrame(()=>{c(),s=!1}),s=!0)}function i(){window.addEventListener("scroll",e,{passive:!0}),window.addEventListener("resize",e,{passive:!0}),document.addEventListener("visibilitychange",()=>{document.hidden||e()}),e(),window.addEventListener("beforeunload",()=>{window.removeEventListener("scroll",e),window.removeEventListener("resize",e)})}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",i):i()})()</script><header class="sticky top-0 z-50 mx-auto max-w-4xl px-4 py-6"><div class="border-border bg-card/80 flex items-center rounded-xl border px-6 py-4 shadow-sm backdrop-blur-sm"><div class="hidden w-full items-center md:flex"><div class="flex items-center"><a href=/ko/ class="flex h-10 w-10 items-center justify-center overflow-hidden rounded-full transition-transform duration-200 hover:scale-105" aria-label="Jaehun's Blog"><img src=/images/logo.svg alt="Jaehun's Blog" class="h-full w-full object-cover"></a></div><nav class="mx-8 flex flex-1 items-center justify-center"><div class="flex items-center space-x-1"><a href=/ko/ class="nav-link
text-muted-foreground hover:text-primary hover:bg-primary/10
focus:ring-primary/20 relative flex items-center gap-2 rounded-lg px-4 py-2 text-sm font-medium transition-all duration-300 ease-out hover:-translate-y-0.5 hover:scale-105 focus:ring-2 focus:outline-none"><svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="nav.posts"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 20H5a2 2 0 01-2-2V6a2 2 0 012-2h10a2 2 0 012 2v1m2 13a2 2 0 01-2-2V7m2 13a2 2 0 002-2V9a2 2 0 00-2-2h-2m-4-3H9M7 16h6M7 8h6v4H7V8z"/></svg>
<span>ê²Œì‹œê¸€
</span></a><a href=/ko/categories/ class="nav-link
text-muted-foreground hover:text-primary hover:bg-primary/10
focus:ring-primary/20 relative flex items-center gap-2 rounded-lg px-4 py-2 text-sm font-medium transition-all duration-300 ease-out hover:-translate-y-0.5 hover:scale-105 focus:ring-2 focus:outline-none"><svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="nav.categories"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"/></svg>
<span>ì¹´í…Œê³ ë¦¬
</span></a><a href=/ko/tags/ class="nav-link
text-muted-foreground hover:text-primary hover:bg-primary/10
focus:ring-primary/20 relative flex items-center gap-2 rounded-lg px-4 py-2 text-sm font-medium transition-all duration-300 ease-out hover:-translate-y-0.5 hover:scale-105 focus:ring-2 focus:outline-none"><svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="nav.tags"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 7h.01M7 3h5c.512.0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828.0l-7-7A1.994 1.994.0 013 12V7a4 4 0 014-4z"/></svg>
<span>íƒœê·¸
</span></a><a href=/ko/ class="nav-link
text-muted-foreground hover:text-primary hover:bg-primary/10
focus:ring-primary/20 relative flex items-center gap-2 rounded-lg px-4 py-2 text-sm font-medium transition-all duration-300 ease-out hover:-translate-y-0.5 hover:scale-105 focus:ring-2 focus:outline-none"><svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="nav.archives"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 8h14M5 8a2 2 0 110-4h14a2 2 0 110 4M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8m-9 4h4"/></svg>
<span>ì•„ì¹´ì´ë¸Œ</span></a></div></nav><div class="flex items-center space-x-2"><div class=relative><button id=language-toggle class="dropdown-toggle border-border bg-background text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex h-10 w-10 items-center justify-center rounded-lg border transition-all duration-300 ease-out hover:scale-105 focus:ring-2 focus:outline-none active:scale-95" data-dropdown-type=language aria-label="ì–¸ì–´ ë³€ê²½" aria-expanded=false aria-haspopup=true>
<svg class="h-5 w-5 relative z-10" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="ì–¸ì–´ ë³€ê²½"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m5 8 6 6m-7 0 6-6 2-3M2 5h12M7 2h1m14 20-5-10-5 10m2-4h6"/></svg></button><div id=language-dropdown class="dropdown-menu border-border bg-popover/95 absolute top-12 right-0 z-[60] hidden w-40 rounded-lg border p-1 shadow-lg backdrop-blur-sm transition-all duration-200 ease-out" data-dropdown-type=language role=menu aria-labelledby=language-toggle><a href=/ko/ class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none" role=menuitem aria-current=true><span class=font-medium>í•œêµ­ì–´</span></a><a href=/en/ class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none" role=menuitem><span class=font-medium>English</span></a></div></div><div class=relative><button id=color-scheme-toggle class="dropdown-toggle border-border bg-background text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex h-10 w-10 items-center justify-center rounded-lg border transition-all duration-300 ease-out hover:scale-105 focus:ring-2 focus:outline-none active:scale-95" data-dropdown-type=color-scheme aria-label="í…Œë§ˆ ë³€ê²½" aria-expanded=false aria-haspopup=true>
<svg class="h-5 w-5 relative z-10" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="í…Œë§ˆ ë³€ê²½"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zM21 5a2 2 0 00-2-2h-4a2 2 0 00-2 2v6a2 2 0 002 2h4a2 2 0 002-2V5z"/></svg></button><div id=color-scheme-dropdown class="dropdown-menu border-border bg-popover/95 absolute top-12 right-0 z-[60] hidden w-44 rounded-lg border p-1 shadow-lg backdrop-blur-sm transition-all duration-200 ease-out" data-dropdown-type=color-scheme><button data-color-scheme=claude class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Default</span></button><button data-color-scheme=default class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>White</span></button><button data-color-scheme=bumblebee class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Bumblebee</span></button><button data-color-scheme=emerald class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Emerald</span></button><button data-color-scheme=nord class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Nord</span></button><button data-color-scheme=sunset class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Sunset</span></button><button data-color-scheme=abyss class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Abyss</span></button><button data-color-scheme=dracula class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Dracula</span></button><button data-color-scheme=amethyst class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Amethyst</span></button><button data-color-scheme=slate class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Slate</span></button><button data-color-scheme=twitter class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Twitter</span></button></div></div><div class=relative><button id=theme-toggle class="dropdown-toggle border-border bg-background text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex h-10 w-10 items-center justify-center rounded-lg border transition-all duration-300 ease-out hover:scale-105 focus:ring-2 focus:outline-none active:scale-95" data-dropdown-type=theme aria-label="í…Œë§ˆ ë³€ê²½" aria-expanded=false aria-haspopup=true>
<svg class="h-5 w-5 sun-icon hidden relative z-10" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="ë¼ì´íŠ¸"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364-.707-.707M6.343 6.343l-.707-.707m12.728.0-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"/></svg>
<svg class="h-5 w-5 moon-icon hidden relative z-10" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="ë‹¤í¬"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003.0 0012 21a9.003 9.003.0 008.354-5.646z"/></svg>
<svg class="h-5 w-5 system-icon hidden relative z-10" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="ì‹œìŠ¤í…œ"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.75 17 9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5A2 2 0 003 5v10a2 2 0 002 2z"/></svg></button><div id=theme-dropdown class="dropdown-menu border-border bg-popover/95 absolute top-12 right-0 z-[60] hidden w-40 rounded-lg border p-1 shadow-lg backdrop-blur-sm transition-all duration-200 ease-out" data-dropdown-type=theme><button data-theme=light class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none">
<svg class="h-5 w-5 mr-3 h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="ë¼ì´íŠ¸"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364-.707-.707M6.343 6.343l-.707-.707m12.728.0-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"/></svg><span>ë¼ì´íŠ¸</span></button><button data-theme=dark class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none">
<svg class="h-5 w-5 mr-3 h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="ë‹¤í¬"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003.0 0012 21a9.003 9.003.0 008.354-5.646z"/></svg><span>ë‹¤í¬</span></button><button data-theme=system class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none">
<svg class="h-5 w-5 mr-3 h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="ì‹œìŠ¤í…œ"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.75 17 9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5A2 2 0 003 5v10a2 2 0 002 2z"/></svg><span>ì‹œìŠ¤í…œ</span></button></div></div></div></div><div class="flex w-full items-center justify-between md:hidden"><div class=relative><button id=mobile-menu-toggle class="dropdown-toggle border-border bg-background text-muted-foreground hover:bg-accent hover:text-foreground flex h-10 w-10 items-center justify-center rounded-lg border transition-colors duration-200" data-dropdown-type=mobile-menu aria-label=ë©”ë‰´ aria-expanded=false aria-haspopup=true>
<svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="ë©”ë‰´"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/></svg></button><div id=mobile-menu class="mobile-menu dropdown-menu border-border bg-popover/95 absolute top-12 left-0 z-[60] hidden w-80 max-w-[calc(100vw-2rem)] rounded-lg border p-1 shadow-lg backdrop-blur-sm transition-all duration-200 ease-out md:hidden" data-dropdown-type=mobile-menu role=menu aria-labelledby=mobile-menu-toggle><nav class="flex flex-col"><a href=/ko/ class="nav-link
text-muted-foreground hover:text-primary hover:bg-primary/10
focus:ring-primary/20 relative flex items-center gap-3 rounded-md px-4 py-3 text-sm font-medium transition-all duration-200 ease-out hover:translate-x-1 focus:ring-2 focus:outline-none" role=menuitem><svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="nav.posts"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 20H5a2 2 0 01-2-2V6a2 2 0 012-2h10a2 2 0 012 2v1m2 13a2 2 0 01-2-2V7m2 13a2 2 0 002-2V9a2 2 0 00-2-2h-2m-4-3H9M7 16h6M7 8h6v4H7V8z"/></svg>
<span>ê²Œì‹œê¸€
</span></a><a href=/ko/categories/ class="nav-link
text-muted-foreground hover:text-primary hover:bg-primary/10
focus:ring-primary/20 relative flex items-center gap-3 rounded-md px-4 py-3 text-sm font-medium transition-all duration-200 ease-out hover:translate-x-1 focus:ring-2 focus:outline-none" role=menuitem><svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="nav.categories"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"/></svg>
<span>ì¹´í…Œê³ ë¦¬
</span></a><a href=/ko/tags/ class="nav-link
text-muted-foreground hover:text-primary hover:bg-primary/10
focus:ring-primary/20 relative flex items-center gap-3 rounded-md px-4 py-3 text-sm font-medium transition-all duration-200 ease-out hover:translate-x-1 focus:ring-2 focus:outline-none" role=menuitem><svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="nav.tags"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 7h.01M7 3h5c.512.0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828.0l-7-7A1.994 1.994.0 013 12V7a4 4 0 014-4z"/></svg>
<span>íƒœê·¸
</span></a><a href=/ko/ class="nav-link
text-muted-foreground hover:text-primary hover:bg-primary/10
focus:ring-primary/20 relative flex items-center gap-3 rounded-md px-4 py-3 text-sm font-medium transition-all duration-200 ease-out hover:translate-x-1 focus:ring-2 focus:outline-none" role=menuitem><svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="nav.archives"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 8h14M5 8a2 2 0 110-4h14a2 2 0 110 4M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8m-9 4h4"/></svg>
<span>ì•„ì¹´ì´ë¸Œ</span></a></nav></div></div><div class="flex items-center space-x-2"><div class=relative><button id=language-toggle class="dropdown-toggle border-border bg-background text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex h-10 w-10 items-center justify-center rounded-lg border transition-all duration-300 ease-out hover:scale-105 focus:ring-2 focus:outline-none active:scale-95" data-dropdown-type=language aria-label="ì–¸ì–´ ë³€ê²½" aria-expanded=false aria-haspopup=true>
<svg class="h-5 w-5 relative z-10" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="ì–¸ì–´ ë³€ê²½"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m5 8 6 6m-7 0 6-6 2-3M2 5h12M7 2h1m14 20-5-10-5 10m2-4h6"/></svg></button><div id=language-dropdown class="dropdown-menu border-border bg-popover/95 absolute top-12 right-0 z-[60] hidden w-40 rounded-lg border p-1 shadow-lg backdrop-blur-sm transition-all duration-200 ease-out" data-dropdown-type=language role=menu aria-labelledby=language-toggle><a href=/ko/ class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none" role=menuitem aria-current=true><span class=font-medium>í•œêµ­ì–´</span></a><a href=/en/ class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none" role=menuitem><span class=font-medium>English</span></a></div></div><div class=relative><button id=color-scheme-toggle class="dropdown-toggle border-border bg-background text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex h-10 w-10 items-center justify-center rounded-lg border transition-all duration-300 ease-out hover:scale-105 focus:ring-2 focus:outline-none active:scale-95" data-dropdown-type=color-scheme aria-label="í…Œë§ˆ ë³€ê²½" aria-expanded=false aria-haspopup=true>
<svg class="h-5 w-5 relative z-10" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="í…Œë§ˆ ë³€ê²½"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zM21 5a2 2 0 00-2-2h-4a2 2 0 00-2 2v6a2 2 0 002 2h4a2 2 0 002-2V5z"/></svg></button><div id=color-scheme-dropdown class="dropdown-menu border-border bg-popover/95 absolute top-12 right-0 z-[60] hidden w-44 rounded-lg border p-1 shadow-lg backdrop-blur-sm transition-all duration-200 ease-out" data-dropdown-type=color-scheme><button data-color-scheme=claude class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Default</span></button><button data-color-scheme=default class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>White</span></button><button data-color-scheme=bumblebee class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Bumblebee</span></button><button data-color-scheme=emerald class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Emerald</span></button><button data-color-scheme=nord class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Nord</span></button><button data-color-scheme=sunset class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Sunset</span></button><button data-color-scheme=abyss class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Abyss</span></button><button data-color-scheme=dracula class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Dracula</span></button><button data-color-scheme=amethyst class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Amethyst</span></button><button data-color-scheme=slate class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Slate</span></button><button data-color-scheme=twitter class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Twitter</span></button></div></div><div class=relative><button id=theme-toggle class="dropdown-toggle border-border bg-background text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex h-10 w-10 items-center justify-center rounded-lg border transition-all duration-300 ease-out hover:scale-105 focus:ring-2 focus:outline-none active:scale-95" data-dropdown-type=theme aria-label="í…Œë§ˆ ë³€ê²½" aria-expanded=false aria-haspopup=true>
<svg class="h-5 w-5 sun-icon hidden relative z-10" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="ë¼ì´íŠ¸"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364-.707-.707M6.343 6.343l-.707-.707m12.728.0-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"/></svg>
<svg class="h-5 w-5 moon-icon hidden relative z-10" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="ë‹¤í¬"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003.0 0012 21a9.003 9.003.0 008.354-5.646z"/></svg>
<svg class="h-5 w-5 system-icon hidden relative z-10" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="ì‹œìŠ¤í…œ"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.75 17 9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5A2 2 0 003 5v10a2 2 0 002 2z"/></svg></button><div id=theme-dropdown class="dropdown-menu border-border bg-popover/95 absolute top-12 right-0 z-[60] hidden w-40 rounded-lg border p-1 shadow-lg backdrop-blur-sm transition-all duration-200 ease-out" data-dropdown-type=theme><button data-theme=light class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none">
<svg class="h-5 w-5 mr-3 h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="ë¼ì´íŠ¸"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364-.707-.707M6.343 6.343l-.707-.707m12.728.0-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"/></svg><span>ë¼ì´íŠ¸</span></button><button data-theme=dark class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none">
<svg class="h-5 w-5 mr-3 h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="ë‹¤í¬"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003.0 0012 21a9.003 9.003.0 008.354-5.646z"/></svg><span>ë‹¤í¬</span></button><button data-theme=system class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none">
<svg class="h-5 w-5 mr-3 h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="ì‹œìŠ¤í…œ"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.75 17 9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5A2 2 0 003 5v10a2 2 0 002 2z"/></svg><span>ì‹œìŠ¤í…œ</span></button></div></div></div></div></div></header><main class="mx-auto max-w-4xl px-4 py-6"><nav class="breadcrumb mb-4 md:mb-6 py-1" aria-label=ê²½ë¡œ><ol class="text-muted-foreground flex items-center space-x-1 md:space-x-2 text-sm overflow-x-auto whitespace-nowrap scrollbar-hide py-1"><li class=flex-shrink-0><a href=/ko/ class="text-muted-foreground hover:text-primary hover:bg-primary/10 flex items-center gap-0.5 md:gap-1 rounded-lg px-1 md:px-3 py-0.5 md:py-1.5 transition-all duration-200 ease-out hover:-translate-y-0.5 hover:scale-[1.02]"><svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="í™ˆ"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m3 12 2-2m0 0 7-7 7 7M5 10v10a1 1 0 001 1h3m10-11 2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"/></svg>
<span class="max-w-[4rem] md:max-w-none truncate">í™ˆ</span></a></li><li class="flex items-center gap-1 md:gap-2 min-w-0"><span class="text-muted-foreground/50 flex-shrink-0"><svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/></svg></span><div class="flex items-center gap-1 md:gap-2 min-w-0"><a href=/ko class="text-muted-foreground hover:text-primary hover:bg-primary/10 flex items-center gap-0.5 md:gap-1 rounded-lg px-1 md:px-3 py-0.5 md:py-1.5 transition-all duration-200 ease-out hover:-translate-y-0.5 hover:scale-[1.02] flex-shrink-0"><svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5A2 2 0 003 7z"/></svg>
<span class="max-w-[4rem] md:max-w-none truncate">Ko</span>
</a><span class="text-muted-foreground/50 flex-shrink-0"><svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/></svg></span>
<span class="text-foreground flex items-center gap-0.5 md:gap-1 font-medium min-w-0"><svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/></svg>
<span class="max-w-[8rem] md:max-w-[16rem] lg:max-w-none truncate">Balancing Pipeline Parallelism with Vocabulary Parallelism</span></span></div></li></ol></nav><header class=mb-8><h1 class="text-foreground mb-4 text-3xl font-bold md:text-4xl">Balancing Pipeline Parallelism with Vocabulary Parallelism</h1></header><article class="prose prose-neutral dark:prose-invert max-w-none"><p><a href=https://arxiv.org/abs/2411.05288>ë…¼ë¬¸ ë§í¬</a></p><h1 id=q--ì´-ë…¼ë¬¸ì„-ì•„ì£¼-ìì„¸í•˜ê²Œ-ì½ê³ -ë…¼ë¬¸ì˜-ê°•ì ê³¼-ë…ì°½ì ì¸-ì§€ì ì„-ì„¤ëª…í•´ì£¼ê³ -í•µì‹¬-ì•Œê³ ë¦¬ì¦˜ì„-ì˜ˆì‹œ-ì…ë ¥ì„-ë“¤ì–´ì„œ-ì „ì²´ì ì¸-ê³¼ì •ì„-ì„¤ëª…í•´ì¤˜-ì¶”ê°€ì ìœ¼ë¡œ-ë…¼ë¬¸ì˜-í•œê³„ì ì—-ëŒ€í•´ì„œë„-ì•Œë ¤ì¤˜>Q : ì´ ë…¼ë¬¸ì„ ì•„ì£¼ ìì„¸í•˜ê²Œ ì½ê³  ë…¼ë¬¸ì˜ ê°•ì ê³¼ ë…ì°½ì ì¸ ì§€ì ì„ ì„¤ëª…í•´ì£¼ê³  í•µì‹¬ ì•Œê³ ë¦¬ì¦˜ì„ ì˜ˆì‹œ ì…ë ¥ì„ ë“¤ì–´ì„œ ì „ì²´ì ì¸ ê³¼ì •ì„ ì„¤ëª…í•´ì¤˜ ì¶”ê°€ì ìœ¼ë¡œ ë…¼ë¬¸ì˜ í•œê³„ì ì— ëŒ€í•´ì„œë„ ì•Œë ¤ì¤˜</h1><p>ë…¼ë¬¸ì˜ í•µì‹¬ ë‚´ìš©ì„ ìš”ì•½í•˜ë©´ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.</p><h2 id=ê²°ë¡ -ìš”ì•½>ê²°ë¡  ìš”ì•½</h2><p>ì´ ë…¼ë¬¸ì€ íŒŒì´í”„ë¼ì¸ ë³‘ë ¬í™”(Pipeline Parallelism, PP)ë¥¼ ì‚¬ìš©í•˜ëŠ” Transformer ëª¨ë¸ í•™ìŠµ ì‹œ, ì…ë ¥ ë° ì¶œë ¥ Embedding ë ˆì´ì–´ì˜ ì—°ì‚°ê³¼ ë©”ëª¨ë¦¬ ë¶ˆê· í˜• ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•œ â€˜Vocabulary Parallelismâ€™ì„ ì œì•ˆí•˜ì—¬ ì„±ëŠ¥ì„ ê°œì„ í–ˆìŠµë‹ˆë‹¤. ì´ë¥¼ í†µí•´ ê¸°ì¡´ ë°©ì‹ ëŒ€ë¹„ ì²˜ë¦¬ ì†ë„ë¥¼ 5~51%ê¹Œì§€ ê°œì„ í–ˆê³ , íŠ¹íˆ í° ì–´íœ˜ ì‚¬ì´ì¦ˆ(Vocabulary size)ì¼ ë•Œ ìµœê³  ì„±ëŠ¥ì„ ë‹¬ì„±í–ˆìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ êµ¬í˜„ ìƒ GPU ê°„ ì¶”ê°€ì ì¸ í†µì‹ ì´ ë¶ˆê°€í”¼í•˜ë©°, ì¼ì • ë¶€ë¶„ Activation Memoryì˜ ì¦ê°€ê°€ ë°œìƒí•©ë‹ˆë‹¤.</p><h2 id=ë…¼ë¬¸ì˜-ê°•ì -ë°-ë…ì°½ì ì¸-ì§€ì >ë…¼ë¬¸ì˜ ê°•ì  ë° ë…ì°½ì ì¸ ì§€ì </h2><ul><li><strong>ê¸°ì¡´ PPì˜ ë³‘ëª© ì›ì¸</strong>ì„ ëª…í™•íˆ ì œì‹œí•˜ì˜€ìœ¼ë©°, Vocabulary Layerë¡œ ì¸í•œ ì—°ì‚°ê³¼ ë©”ëª¨ë¦¬ì˜ ë¶ˆê· í˜• ë¬¸ì œë¥¼ êµ¬ì²´ì ì¸ ìˆ˜ì¹˜ë¥¼ ë“¤ì–´ ì„¤ëª…í•˜ì˜€ìŠµë‹ˆë‹¤. (Gemma2 9B ëª¨ë¸ì—ì„œëŠ” Vocabulary Layerì˜ ê³„ì‚°ê³¼ ë©”ëª¨ë¦¬ê°€ Transformer Layerë³´ë‹¤ ìµœëŒ€ 5ë°° ë” ë†’ë‹¤ê³  ì œì‹œí•˜ì˜€ìŒ)</li><li><strong>&ldquo;Vocabulary Parallelism&rdquo; ì´ë¼ëŠ” ìƒˆë¡œìš´ ë³‘ë ¬í™” ë°©ì‹ì„ ì œì•ˆ</strong>í•˜ì—¬ ê° ë””ë°”ì´ìŠ¤ì—ì„œì˜ ì—°ì‚°ê³¼ ë©”ëª¨ë¦¬ ê· í˜•ì„ ë‹¬ì„±í•¨ê³¼ ë™ì‹œì—, ê¸°ì¡´ì˜ Activation Memory ê· í˜• ê¸°ë²•(V-Half ë“±)ê³¼ í†µí•©í•˜ì—¬ ì™„ë²½í•œ ê· í˜•ì„ ë‹¬ì„±í•˜ì˜€ìŠµë‹ˆë‹¤.</li><li><strong>ì‹¤í—˜ì ìœ¼ë¡œ ìµœëŒ€ 51%ì˜ ì„±ëŠ¥ í–¥ìƒ</strong>ì„ ì´ë£¨ì—ˆìœ¼ë©°, íŠ¹íˆ Vocabulary í¬ê¸°ê°€ í´ìˆ˜ë¡ ì„±ëŠ¥ ì´ë“ì´ ëšœë ·í•˜ê²Œ ë‚˜íƒ€ë‚¬ìŠµë‹ˆë‹¤.</li></ul><p>| ë³‘ë ¬í™” ë°©ì‹ | Memory ê· í˜• | Throughput í–¥ìƒë¥ (%) | Peak Memory |
| &mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash; | &mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&ndash; | &mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&ndash; |
| Baseline (ê¸°ì¡´ PP) | âŒ | 0% (ê¸°ì¤€) |
| Redistribute Layers | ë¶€ë¶„ì  (ë¶ˆì™„ì „) | 8<del>33% ì„±ëŠ¥ ê°ì†Œ |
| Interlaced (TP ë°©ì‹ ë³‘ë ¬í™”) | âŒ (Activation Memory 1.5ë°° ì¦ê°€) | ìµœëŒ€ 8% ì„±ëŠ¥ ê°œì„  |
| <strong>Vocabulary Parallelism (ë³¸ ë…¼ë¬¸)</strong> | âœ… (ì™„ë²½ ê· í˜• ë‹¬ì„± ê°€ëŠ¥) | **5</del>51% ì„±ëŠ¥ ì¦ê°€** |</p><ul><li>GitHubë¥¼ í†µí•´ êµ¬í˜„ì„ ê³µê°œí•˜ì—¬ ì ‘ê·¼ì„±ì„ ë†’ì˜€ìŠµë‹ˆë‹¤ (<a href=https://github.com/sail-sg/VocabularyParallelism>https://github.com/sail-sg/VocabularyParallelism</a>).</li></ul><hr><h2 id=í•µì‹¬-ì•Œê³ ë¦¬ì¦˜-ì„¤ëª…-ì˜ˆì‹œ-ì…ë ¥ê³¼-í•¨ê»˜>í•µì‹¬ ì•Œê³ ë¦¬ì¦˜ ì„¤ëª… (ì˜ˆì‹œ ì…ë ¥ê³¼ í•¨ê»˜)</h2><p>ë…¼ë¬¸ì—ì„œ ì œì•ˆí•œ <strong>Vocabulary Parallelism</strong> í•µì‹¬ ì•Œê³ ë¦¬ì¦˜(íŠ¹íˆ ìµœì í™”ëœ ë‹¨ì¼ ì¥ë²½ ë°©ì‹ì¸ Algorithm 2)ì„ ì˜ˆì‹œ ì…ë ¥ì„ ë“¤ì–´ ì„¤ëª…í•©ë‹ˆë‹¤.</p><h3 id=ì˜ˆì‹œ-ì„¤ì •>ì˜ˆì‹œ ì„¤ì •</h3><ul><li>Vocabulary í¬ê¸°: (V = 8) (ê°„ëµí™”ë¥¼ ìœ„í•œ ì‘ì€ ìˆ˜ì¹˜)</li><li>Pipeline Device ìˆ˜(p): 4</li><li>Batch Size ( bs = 1 ), Hidden Size(h) = 4ë¡œ ì˜ˆì‹œ</li><li>ë§ˆì§€ë§‰ Transformer ì¶œë ¥ ê°’ (X), Embedding weights (W) ì˜ˆì‹œ:</li></ul><div class="code-block-container border-border bg-card my-6 overflow-hidden rounded-xl border shadow-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:shadow-md"><div class="code-block-header bg-muted/30 border-border flex items-center justify-between border-b px-4 py-3"><div class="flex items-center gap-2"><div class="text-muted-foreground flex-shrink-0"><svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4 4 4-4 4M6 16l-4-4 4-4"/></svg></div><span class="text-muted-foreground text-sm font-medium">PLAINTEXT</span></div><div class="flex items-center gap-2"><button class="collapse-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-0 data-default-state=expanded data-collapsed=false data-auto-collapse-lines=30 data-auto-collapse-height=400 data-collapsed-height=120 title=ì ‘ê¸° aria-label=ì ‘ê¸°>
<span class=collapse-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41 12 10.83l4.59 4.58L18 14l-6-6-6 6z"/></svg>
</span><span class="collapse-text hidden sm:inline">ì ‘ê¸°</span>
</button>
<button class="copy-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-0 title=ë³µì‚¬ aria-label=ë³µì‚¬>
<span class=copy-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/></svg>
</span><span class="copy-text hidden sm:inline">ë³µì‚¬</span></button></div></div><div class="code-block-content relative" id=code-0><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=ln>1</span><span class=cl>X = [[0.1, 0.2, 0.3, 0.4]]
</span></span><span class=line><span class=ln>2</span><span class=cl>W (partitioned) = 4 devicesë¡œ ë‚˜ëˆ„ì–´ ê° Deviceê°€ Wì˜ ì¼ë¶€ë¶„ë§Œ ê°€ì§:
</span></span><span class=line><span class=ln>3</span><span class=cl>- Device 1: W1 (size: [2,4])
</span></span><span class=line><span class=ln>4</span><span class=cl>- Device 2: W2
</span></span><span class=line><span class=ln>5</span><span class=cl>- Device 3: W3
</span></span><span class=line><span class=ln>6</span><span class=cl>- Device 4: W (ì „ì²´ ì–´íœ˜ í¬ê¸°(V)ë¥¼ 4ë¡œ ë‚˜ëˆ ì„œ ê° ë””ë°”ì´ìŠ¤ì— ê· ë“± ë¶„í• )</span></span></code></pre></div><div class="collapse-overlay to-card/90 pointer-events-none absolute inset-0 bg-gradient-to-b from-transparent via-transparent opacity-0 transition-opacity duration-300"><div class="text-muted-foreground bg-card/80 border-border/50 hover:bg-primary/10 hover:text-primary hover:border-primary/30 absolute bottom-4 left-1/2 -translate-x-1/2 cursor-pointer rounded-full border px-3 py-1.5 text-xs backdrop-blur-sm transition-all duration-200">í´ë¦­í•˜ì—¬ ë” ë³´ê¸°</div></div></div></div><script>(function(){const s="code-0",n=document.querySelector('.copy-code-btn[data-code-id="'+s+'"]'),t=document.querySelector('.collapse-code-btn[data-code-id="'+s+'"]'),e=document.getElementById(s);if(!e)return;if(n){const s=n.querySelector(".copy-icon"),t=n.querySelector(".copy-text");n.addEventListener("click",async function(){try{let o="";const i=e.querySelector(".lntd:last-child code");if(i)o=i.textContent||i.innerText;else{const t=e.querySelector("code");if(t){const e=t.querySelector(".ln");if(e){const e=t.querySelectorAll(".cl");if(e.length>0)o=Array.from(e).map(e=>{const t=e.textContent||e.innerText;return t.replace(/\n+$/,"")}).join(`
`).replace(/\n+$/,"");else{const e=t.textContent||t.innerText;o=e.replace(/^\d+/gm,"").replace(/^\s+/gm,"")}}else o=t.textContent||t.innerText}else o=e.textContent||e.innerText}o=o.trim(),await navigator.clipboard.writeText(o),s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
</svg>`,t&&(t.textContent="ë³µì‚¬ë¨"),n.classList.add("text-green-600"),setTimeout(()=>{s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
</svg>`,t&&(t.textContent="ë³µì‚¬"),n.classList.remove("text-green-600")},2e3)}catch(o){console.error("å¤åˆ¶å¤±è´¥:",o);const s=document.createRange(),i=e.querySelector("code")||e;s.selectNodeContents(i);const n=window.getSelection();n.removeAllRanges(),n.addRange(s),t&&(t.textContent="ì„ íƒë¨"),setTimeout(()=>{t&&(t.textContent="ë³µì‚¬"),n.removeAllRanges()},2e3)}})}if(t){const d=t.querySelector(".collapse-icon"),c=t.querySelector(".collapse-text"),n=e.querySelector(".collapse-overlay");let s=e.querySelector("pre.chroma");s||(s=e.querySelector("pre"));const m=t.dataset.defaultState||"expanded",f=t.dataset.collapsed==="true",u=parseInt(t.dataset.autoCollapseLines)||30,h=parseInt(t.dataset.autoCollapseHeight)||400,p=parseInt(t.dataset.collapsedHeight)||120;let l=!1;function i(){const e=f||m==="collapsed"||a();e&&o(!0,!1)}function a(){if(s){const e=s.querySelectorAll(".line, .cl"),t=s.offsetHeight;return e.length>u||t>h}const t=e.offsetHeight;if(t>h)return!0;const n=e.textContent||e.innerText||"",o=n.split(`
`).length;return o>u}function o(s,o=!0){if(!n)return;l=s,s?(e.style.maxHeight=p+"px",e.style.overflow="hidden",n.style.opacity="1",n.style.pointerEvents="auto",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
</svg>`,c&&(c.textContent="í¼ì¹˜ê¸°"),t.title="í¼ì¹˜ê¸°"):(e.style.maxHeight="",e.style.overflow="",n.style.opacity="0",n.style.pointerEvents="none",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z"/></svg>`,c&&(c.textContent="ì ‘ê¸°"),t.title="ì ‘ê¸°"),o&&(e.style.transition="max-height 0.3s ease-out",setTimeout(()=>{e.style.transition=""},300))}function r(){o(!l,!0)}t.addEventListener("click",r),n&&n.addEventListener("click",()=>{l&&o(!1,!0)}),i()}})()</script><h3 id=ì „ì²´-ê³¼ì •-forward--backward>ì „ì²´ ê³¼ì • (Forward â†’ Backward)</h3><ol><li><p><strong>Forward ë‹¨ê³„</strong></p><ul><li>ê° DeviceëŠ” ( Y = X \times W^T )ë¥¼ ë…ë¦½ì ìœ¼ë¡œ ê³„ì‚° (ìì‹ ì˜ Vocab partitionì— ëŒ€í•´ ìˆ˜í–‰)</li><li>ê° ë””ë°”ì´ìŠ¤ ë³„ ë¡œì»¬ë¡œ ìµœëŒ€ê°’ (m&rsquo;), í•© (sum&rsquo;) ê³„ì‚° í›„, ë¡œì»¬ Softmax ê°’ (softmax&rsquo;) ìƒì„±</li><li>ëª¨ë“  Deviceì—ì„œ <code>AllReduce</code> ìˆ˜í–‰ìœ¼ë¡œ global max((m_i)), sum((sum_i)) ê³„ì‚°</li><li>ê¸€ë¡œë²Œ softmax ê³„ì‚°: ë¡œì»¬ softmax ê²°ê³¼ë¥¼ ì „ì—­ í†µì‹  ê²°ê³¼ì™€ ê²°í•© (local â†’ global scaling)</li></ul></li><li><p><strong>Backward ë‹¨ê³„ ìµœì í™”</strong></p><ul><li>(âˆ‡X), (âˆ‡W)ë¥¼ ìœ„í•œ ì¤‘ê°„ê°’ ë¯¸ë¦¬ ê³„ì‚°(A, Bë¡œ í‘œì‹œ)</li><li>Softmaxì—ì„œ ì „ì—­ìœ¼ë¡œ ê³„ì‚°ëœ mi, sumië¥¼ ì‚¬ìš©í•˜ì—¬ í†µì‹  ì™„ë£Œ í›„ì— (âˆ‡X)ë¥¼ ìµœì¢… ê³„ì‚°í•¨ìœ¼ë¡œì¨, ìµœì ì˜ í•œ ë²ˆì˜ í†µì‹  ë°°ë¦¬ì–´(AllReduce)ë§Œ ìˆ˜í–‰í•˜ì—¬ Activation Memory ì˜¤ë²„í—¤ë“œë¥¼ ìµœì†Œí™”</li></ul></li></ol><table><thead><tr><th>ë‹¨ê³„</th><th>ì‘ì—…</th><th>ì—°ì‚° ì˜ˆì‹œ</th></tr></thead><tbody><tr><td>Forward</td><td>ë¡œì»¬ ì—°ì‚°</td><td>(Y = X W^T), local max, sum</td></tr><tr><td>Forward</td><td>All-Reduce</td><td>ê¸€ë¡œë²Œ max, sum ê³„ì‚°</td></tr><tr><td>Forward</td><td>ê¸€ë¡œë²Œ ì—°ì‚°</td><td>global softmax ê³„ì‚°</td></tr><tr><td>Backward</td><td>ë¡œì»¬ ì—°ì‚° (ì‚¬ì „)</td><td>A = softmax&rsquo; Ã— W, B = G W</td></tr><tr><td>Backward</td><td>All-Reduce</td><td>global sum, max í†µì‹  (Backwardì—ì„œ ì¬í™œìš©)</td></tr><tr><td>Backward</td><td>ê¸€ë¡œë²Œ ì—°ì‚°</td><td>(âˆ‡X), (âˆ‡W) ìµœì¢… ê³„ì‚°</td></tr></tbody></table><p>ìœ„ ê³¼ì •ì—ì„œ, ë…¼ë¬¸ì€ All-Reduce í†µì‹ ì„ 3íšŒì—ì„œ 1~2íšŒë¡œ ìµœì í™”í•˜ì—¬ ë©”ëª¨ë¦¬ ë° ì†ë„ë¥¼ ê°œì„ í–ˆìŠµë‹ˆë‹¤.</p><hr><h2 id=ë…¼ë¬¸ì˜-í•œê³„ì >ë…¼ë¬¸ì˜ í•œê³„ì </h2><ul><li><strong>Communication Overhead</strong>: ë³‘ë ¬í™” ê³¼ì •ì—ì„œ ì¶”ê°€ì ì¸ ì „ì—­ í†µì‹ (AllReduce)ì´ ë¶ˆê°€í”¼í•˜ë¯€ë¡œ GPU ìˆ˜ê°€ ëŠ˜ì–´ë‚ ìˆ˜ë¡ ë¹„ì„ í˜•ì  overhead ì¦ê°€(16 GPUsì—ì„œëŠ” ì´ìƒì ì¸ linear scaling ëŒ€ë¹„ 80% íš¨ìœ¨, 32 GPUsì—ì„œ 75%ë¡œ ê°ì†Œ)ê°€ ë°œìƒí•©ë‹ˆë‹¤.</li><li><strong>Input Layerì˜ íš¨ìœ¨ì„± í•œê³„</strong>: Input LayerëŠ” ìƒëŒ€ì ìœ¼ë¡œ íš¨ìœ¨ì ì´ì§€ ì•Šê²Œ ë³‘ë ¬í™”ë˜ì–´, ë””ë°”ì´ìŠ¤ ìˆ˜ê°€ ë§ì„ìˆ˜ë¡ linear scaling ëŒ€ë¹„ throughput íš¨ìœ¨ì´ í¬ê²Œ ë–¨ì–´ì§(32 GPUì—ì„œëŠ” linear ëŒ€ë¹„ ì•½ 8%~15% ìˆ˜ì¤€ìœ¼ë¡œ íš¨ìœ¨ ê°ì†Œ).</li><li><strong>Activation Memory ì¦ê°€</strong>: Optimizationì—ë„ ë¶ˆêµ¬í•˜ê³  ì¼ë¶€ Activation memoryëŠ” ì¦ê°€í•˜ë©°, í° ëª¨ë¸ì´ë‚˜ ê¸´ ì‹œí€€ìŠ¤ ê¸¸ì´ì— ë”°ë¼ ë©”ëª¨ë¦¬ ì¦ê°€ê°€ ë¶€ë‹´ìœ¼ë¡œ ì‘ìš©í•  ìˆ˜ ìˆìŒ.</li></ul><table><thead><tr><th>í•œê³„ì  í•­ëª©</th><th>ë¬¸ì œì </th><th>ê°œì„  ê°€ëŠ¥ì„±</th></tr></thead><tbody><tr><td>í†µì‹  Overhead</td><td>ë†’ìŒ (All-reduce í•„ìˆ˜)</td><td>í†µì‹  í”„ë¡œí† ì½œ ìµœì í™” í•„ìš”</td></tr><tr><td>Input Layer ì„±ëŠ¥</td><td>ì €í•˜ë¨ (íš¨ìœ¨ ë‚®ìŒ)</td><td>ë³‘ë ¬í™” ì „ëµ ê°œì„  í•„ìš”</td></tr><tr><td>Activation Memory</td><td>ì†Œí­ ì¦ê°€</td><td>íš¨ìœ¨ì  ë©”ëª¨ë¦¬ ê´€ë¦¬ í•„ìš”</td></tr></tbody></table><hr><p>ì •ë¦¬í•˜ë©´, ë…¼ë¬¸ì€ ê¸°ì¡´ PPì˜ Vocabulary Layer ë³‘ëª© í˜„ìƒì„ ëª…í™•íˆ ë¶„ì„í•˜ê³  ìƒˆë¡œìš´ Vocabulary Parallelism ê¸°ë²•ìœ¼ë¡œ ë¬¸ì œë¥¼ í•´ê²°í•˜ì—¬ ìµœëŒ€ 51%ì˜ throughput í–¥ìƒì„ ì´ë£¨ì—ˆìœ¼ë‚˜, ì—¬ì „íˆ ì¶”ê°€ì ì¸ í†µì‹  ë¹„ìš©ê³¼ Activation Memory ì¦ê°€ë¼ëŠ” ì œí•œì ì„ í•´ê²°í•  ì—¬ì§€ê°€ ë‚¨ì•„ìˆìŠµë‹ˆë‹¤.</p><h1 id=q--ë…¼ë¬¸ì˜-í•µì‹¬ì•Œê³ ë¦¬ì¦˜ì„-ì˜ˆì‹œë¥¼-ë“¤ì–´-ì•„ì£¼-ìì„¸í•˜ê²Œ-ì„¤ëª…í•´ì£¼ê³ -ì •ë¦¬í•´-ì¤˜>Q : ë…¼ë¬¸ì˜ í•µì‹¬ì•Œê³ ë¦¬ì¦˜ì„ ì˜ˆì‹œë¥¼ ë“¤ì–´ ì•„ì£¼ ìì„¸í•˜ê²Œ ì„¤ëª…í•´ì£¼ê³  ì •ë¦¬í•´ ì¤˜</h1><p>ë…¼ë¬¸ì˜ í•µì‹¬ ì•Œê³ ë¦¬ì¦˜ì€ <strong>Vocabulary Parallelism</strong>ì´ë©°, íŠ¹íˆ ì¶œë ¥ì¸µ(Output Layer)ì„ ì¤‘ì‹¬ìœ¼ë¡œ ì´ë£¨ì–´ì§„ ë³‘ë ¬í™” ë° ìµœì í™” ê¸°ë²•ì´ í•µì‹¬ì…ë‹ˆë‹¤. ë‹¤ìŒì€ ë…¼ë¬¸ì˜ í•µì‹¬ ì•Œê³ ë¦¬ì¦˜ì„ êµ¬ì²´ì  ì˜ˆì‹œì™€ í•¨ê»˜ ì•„ì£¼ ìƒì„¸í•˜ê²Œ ì„¤ëª…í•œ ë‚´ìš©ì…ë‹ˆë‹¤.</p><hr><h2 id=-1-ì•Œê³ ë¦¬ì¦˜-ê°œìš”>ğŸ“Œ 1. ì•Œê³ ë¦¬ì¦˜ ê°œìš”</h2><p>Vocabulary Parallelismì€ íŒŒì´í”„ë¼ì¸ ë³‘ë ¬í™”(Pipeline Parallelism, PP) ì‹œ ë°œìƒí•˜ëŠ” **ì…ì¶œë ¥ì¸µ(Vocabulary Layer)**ì˜ ì—°ì‚° ë° ë©”ëª¨ë¦¬ ë¶ˆê· í˜•ì„ í•´ê²°í•˜ê¸° ìœ„í•´, <strong>ì…ì¶œë ¥ì¸µì„ ëª¨ë“  Pipeline Deviceì— ê³ ë¥´ê²Œ ë¶„ì‚°ì‹œí‚¤ëŠ”</strong> ë°©ì‹ì…ë‹ˆë‹¤.</p><p>íŠ¹íˆ, ì¶œë ¥ì¸µì€ í¬ê²Œ ë‹¤ìŒê³¼ ê°™ì€ ê³¼ì •ì„ ê±°ì¹©ë‹ˆë‹¤.</p><ul><li><p><strong>Forward ì—°ì‚°</strong>:<br>[
Y = XW^T,\quad softmax(Y_{ij})=\frac{e^{Y_{ij}-m_i}}{\sum_{k} e^{Y_{ik}-m_i}}
\quad\text{(ë‹¨, (m_i=\max_{k}Y_{ik}))}
]</p></li><li><p><strong>Backward ì—°ì‚°</strong>: Cross-Entropy Loss ì‚¬ìš© ì‹œ Gradients ê³„ì‚°
[
\nabla X = (softmax(Y)-G)W,\quad\nabla W=(softmax(Y)-G)^T X
]</p></li></ul><p>ì´ ê³¼ì •ì—ì„œ **í†µì‹ (All-Reduce)**ì´ í•„ìš”í•˜ë©°, ë…¼ë¬¸ì€ ì´ë¥¼ <strong>íš¨ìœ¨ì ìœ¼ë¡œ ë°°ì¹˜í•˜ì—¬ ì„±ëŠ¥ì„ ìµœì í™”</strong>í•©ë‹ˆë‹¤.</p><hr><h2 id=-ì•Œê³ ë¦¬ì¦˜-ìµœì í™”-ê³¼ì •-êµ¬ì²´ì ì¸-ì˜ˆì‹œì™€-í•¨ê»˜>ğŸ“Œ ì•Œê³ ë¦¬ì¦˜ ìµœì í™” ê³¼ì • (êµ¬ì²´ì ì¸ ì˜ˆì‹œì™€ í•¨ê»˜)</h2><p>ì•„ë˜ëŠ” ë…¼ë¬¸ì´ ì œì•ˆí•œ **ìµœì í™”ëœ ë‹¨ì¼ Communication Barrier ë°©ì‹(Algorithm 2)**ì„ ì˜ˆì‹œ ì…ë ¥ì„ ë“¤ì–´ì„œ ì„¤ëª…í•œ ê²ƒì…ë‹ˆë‹¤.</p><h3 id=-ì˜ˆì‹œ-ìƒí™©-ì„¤ì •>âœ… ì˜ˆì‹œ ìƒí™© ì„¤ì •</h3><ul><li>Pipeline Device ìˆ˜(p): 4ê°œ</li><li>Vocab Size(V): 8ê°œ(ê° Device ë‹¹ 2ê°œì”© ë¶„ì‚°)</li><li>Hidden Size(h): 4, Batch Size(b): 1ê°œ (ë§ˆì´í¬ë¡œ ë°°ì¹˜ 1ê°œ)</li><li>ë§ˆì§€ë§‰ Transformer ì¶œë ¥ (X) ë²¡í„° í¬ê¸°: [1,4]</li><li>Embedding Weight(W): [8,4] â†’ Deviceë³„ë¡œ 2ê°œì”© ë¶„í• </li></ul><h4 id=-ì˜ˆì‹œ-ì…ë ¥ê°’>ğŸ”¹ ì˜ˆì‹œ ì…ë ¥ê°’</h4><ul><li><p>ë§ˆì§€ë§‰ Transformer ì¶œë ¥ (X):
[
X = [0.1, 0.2, 0.3, 0.4] \quad [1\times4]
]</p></li><li><p>Embedding Matrix (W) (ì´ 8 vocab â†’ 4ê°œë¡œ ë¶„í• )</p></li></ul><div class="code-block-container border-border bg-card my-6 overflow-hidden rounded-xl border shadow-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:shadow-md"><div class="code-block-header bg-muted/30 border-border flex items-center justify-between border-b px-4 py-3"><div class="flex items-center gap-2"><div class="text-muted-foreground flex-shrink-0"><svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4 4 4-4 4M6 16l-4-4 4-4"/></svg></div><span class="text-muted-foreground text-sm font-medium">PLAINTEXT</span></div><div class="flex items-center gap-2"><button class="collapse-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-1 data-default-state=expanded data-collapsed=false data-auto-collapse-lines=30 data-auto-collapse-height=400 data-collapsed-height=120 title=ì ‘ê¸° aria-label=ì ‘ê¸°>
<span class=collapse-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41 12 10.83l4.59 4.58L18 14l-6-6-6 6z"/></svg>
</span><span class="collapse-text hidden sm:inline">ì ‘ê¸°</span>
</button>
<button class="copy-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-1 title=ë³µì‚¬ aria-label=ë³µì‚¬>
<span class=copy-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/></svg>
</span><span class="copy-text hidden sm:inline">ë³µì‚¬</span></button></div></div><div class="code-block-content relative" id=code-1><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=ln>1</span><span class=cl>W(Device 1) = [[0.1, 0.0, 0.2, 0.1],
</span></span><span class=line><span class=ln>2</span><span class=cl>              [0.0, 0.2, 0.4, 0.1]]
</span></span><span class=line><span class=ln>3</span><span class=cl>
</span></span><span class=line><span class=ln>4</span><span class=cl>W(Device 2~4ë„ ê°ê° ë¹„ìŠ·í•œ í˜•íƒœë¡œ ë³„ë„ partitionìœ¼ë¡œ ì €ì¥ë¨)</span></span></code></pre></div><div class="collapse-overlay to-card/90 pointer-events-none absolute inset-0 bg-gradient-to-b from-transparent via-transparent opacity-0 transition-opacity duration-300"><div class="text-muted-foreground bg-card/80 border-border/50 hover:bg-primary/10 hover:text-primary hover:border-primary/30 absolute bottom-4 left-1/2 -translate-x-1/2 cursor-pointer rounded-full border px-3 py-1.5 text-xs backdrop-blur-sm transition-all duration-200">í´ë¦­í•˜ì—¬ ë” ë³´ê¸°</div></div></div></div><script>(function(){const s="code-1",n=document.querySelector('.copy-code-btn[data-code-id="'+s+'"]'),t=document.querySelector('.collapse-code-btn[data-code-id="'+s+'"]'),e=document.getElementById(s);if(!e)return;if(n){const s=n.querySelector(".copy-icon"),t=n.querySelector(".copy-text");n.addEventListener("click",async function(){try{let o="";const i=e.querySelector(".lntd:last-child code");if(i)o=i.textContent||i.innerText;else{const t=e.querySelector("code");if(t){const e=t.querySelector(".ln");if(e){const e=t.querySelectorAll(".cl");if(e.length>0)o=Array.from(e).map(e=>{const t=e.textContent||e.innerText;return t.replace(/\n+$/,"")}).join(`
`).replace(/\n+$/,"");else{const e=t.textContent||t.innerText;o=e.replace(/^\d+/gm,"").replace(/^\s+/gm,"")}}else o=t.textContent||t.innerText}else o=e.textContent||e.innerText}o=o.trim(),await navigator.clipboard.writeText(o),s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
</svg>`,t&&(t.textContent="ë³µì‚¬ë¨"),n.classList.add("text-green-600"),setTimeout(()=>{s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
</svg>`,t&&(t.textContent="ë³µì‚¬"),n.classList.remove("text-green-600")},2e3)}catch(o){console.error("å¤åˆ¶å¤±è´¥:",o);const s=document.createRange(),i=e.querySelector("code")||e;s.selectNodeContents(i);const n=window.getSelection();n.removeAllRanges(),n.addRange(s),t&&(t.textContent="ì„ íƒë¨"),setTimeout(()=>{t&&(t.textContent="ë³µì‚¬"),n.removeAllRanges()},2e3)}})}if(t){const d=t.querySelector(".collapse-icon"),c=t.querySelector(".collapse-text"),n=e.querySelector(".collapse-overlay");let s=e.querySelector("pre.chroma");s||(s=e.querySelector("pre"));const m=t.dataset.defaultState||"expanded",f=t.dataset.collapsed==="true",u=parseInt(t.dataset.autoCollapseLines)||30,h=parseInt(t.dataset.autoCollapseHeight)||400,p=parseInt(t.dataset.collapsedHeight)||120;let l=!1;function i(){const e=f||m==="collapsed"||a();e&&o(!0,!1)}function a(){if(s){const e=s.querySelectorAll(".line, .cl"),t=s.offsetHeight;return e.length>u||t>h}const t=e.offsetHeight;if(t>h)return!0;const n=e.textContent||e.innerText||"",o=n.split(`
`).length;return o>u}function o(s,o=!0){if(!n)return;l=s,s?(e.style.maxHeight=p+"px",e.style.overflow="hidden",n.style.opacity="1",n.style.pointerEvents="auto",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
</svg>`,c&&(c.textContent="í¼ì¹˜ê¸°"),t.title="í¼ì¹˜ê¸°"):(e.style.maxHeight="",e.style.overflow="",n.style.opacity="0",n.style.pointerEvents="none",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z"/></svg>`,c&&(c.textContent="ì ‘ê¸°"),t.title="ì ‘ê¸°"),o&&(e.style.transition="max-height 0.3s ease-out",setTimeout(()=>{e.style.transition=""},300))}function r(){o(!l,!0)}t.addEventListener("click",r),n&&n.addEventListener("click",()=>{l&&o(!1,!0)}),i()}})()</script><h3 id=-ë‹¨ê³„ë³„-ê³„ì‚°-ê³¼ì •-algorithm-2-ì ìš©>âœ… ë‹¨ê³„ë³„ ê³„ì‚° ê³¼ì • (Algorithm 2 ì ìš©)</h3><hr><h2 id=-forward-phase>â–¶ï¸ [Forward Phase]</h2><h3 id=-ê°-deviceì—ì„œ-ë…ë¦½ì -logits-ê³„ì‚°>â‘  ê° Deviceì—ì„œ ë…ë¦½ì  Logits ê³„ì‚°</h3><p>ê° Deviceì—ì„œ ( Y = X W^T )ë¥¼ ìˆ˜í–‰:</p><ul><li>Device 1ì˜ ì˜ˆì‹œ:
[
Y_{Device1} = X \times W_1^T
= [0.1,0.2,0.3,0.4] \begin{bmatrix}0.1&amp;0.2\0.2&amp;0.1\0.1&amp;0.3\0.1&amp;0.4\end{bmatrix}
= [0.1\times0.1+0.2\times0.2+0.3\times0.1+0.4\times0.1,\quad\cdots]
]</li></ul><p>ì´ë ‡ê²Œ ê° ë””ë°”ì´ìŠ¤ë³„ë¡œ Vocab Partitionì— ë”°ë¼ ê³„ì‚°ë¨.</p><p>ê° ë””ë°”ì´ìŠ¤ëŠ” ìì‹ ì˜ ë¶€ë¶„ì§‘í•©ì— ëŒ€í•´ì„œë§Œ ê²°ê³¼ ì‚°ì¶œí•¨.</p><h3 id=-local-max-ë°-sum-ê³„ì‚°>â‘¡ Local max ë° sum ê³„ì‚°</h3><p>ê° DeviceëŠ” ìê¸° Partitionì˜ ë¡œì»¬ maxì™€ sumì„ ê³„ì‚°í•©ë‹ˆë‹¤.</p><div class="code-block-container border-border bg-card my-6 overflow-hidden rounded-xl border shadow-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:shadow-md"><div class="code-block-header bg-muted/30 border-border flex items-center justify-between border-b px-4 py-3"><div class="flex items-center gap-2"><div class="text-muted-foreground flex-shrink-0"><svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4 4 4-4 4M6 16l-4-4 4-4"/></svg></div><span class="text-muted-foreground text-sm font-medium">PLAINTEXT</span></div><div class="flex items-center gap-2"><button class="collapse-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-2 data-default-state=expanded data-collapsed=false data-auto-collapse-lines=30 data-auto-collapse-height=400 data-collapsed-height=120 title=ì ‘ê¸° aria-label=ì ‘ê¸°>
<span class=collapse-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41 12 10.83l4.59 4.58L18 14l-6-6-6 6z"/></svg>
</span><span class="collapse-text hidden sm:inline">ì ‘ê¸°</span>
</button>
<button class="copy-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-2 title=ë³µì‚¬ aria-label=ë³µì‚¬>
<span class=copy-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/></svg>
</span><span class="copy-text hidden sm:inline">ë³µì‚¬</span></button></div></div><div class="code-block-content relative" id=code-2><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=ln>1</span><span class=cl>ì˜ˆì‹œ (Device 1):
</span></span><span class=line><span class=ln>2</span><span class=cl>Y_local = [0.12, 0.19]
</span></span><span class=line><span class=ln>3</span><span class=cl>m&#39; = max(Y_local) = 0.19
</span></span><span class=line><span class=ln>4</span><span class=cl>sum&#39; = exp(0.12-0.19)+exp(0.19-0.19) â‰ˆ 1.9326</span></span></code></pre></div><div class="collapse-overlay to-card/90 pointer-events-none absolute inset-0 bg-gradient-to-b from-transparent via-transparent opacity-0 transition-opacity duration-300"><div class="text-muted-foreground bg-card/80 border-border/50 hover:bg-primary/10 hover:text-primary hover:border-primary/30 absolute bottom-4 left-1/2 -translate-x-1/2 cursor-pointer rounded-full border px-3 py-1.5 text-xs backdrop-blur-sm transition-all duration-200">í´ë¦­í•˜ì—¬ ë” ë³´ê¸°</div></div></div></div><script>(function(){const s="code-2",n=document.querySelector('.copy-code-btn[data-code-id="'+s+'"]'),t=document.querySelector('.collapse-code-btn[data-code-id="'+s+'"]'),e=document.getElementById(s);if(!e)return;if(n){const s=n.querySelector(".copy-icon"),t=n.querySelector(".copy-text");n.addEventListener("click",async function(){try{let o="";const i=e.querySelector(".lntd:last-child code");if(i)o=i.textContent||i.innerText;else{const t=e.querySelector("code");if(t){const e=t.querySelector(".ln");if(e){const e=t.querySelectorAll(".cl");if(e.length>0)o=Array.from(e).map(e=>{const t=e.textContent||e.innerText;return t.replace(/\n+$/,"")}).join(`
`).replace(/\n+$/,"");else{const e=t.textContent||t.innerText;o=e.replace(/^\d+/gm,"").replace(/^\s+/gm,"")}}else o=t.textContent||t.innerText}else o=e.textContent||e.innerText}o=o.trim(),await navigator.clipboard.writeText(o),s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
</svg>`,t&&(t.textContent="ë³µì‚¬ë¨"),n.classList.add("text-green-600"),setTimeout(()=>{s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
</svg>`,t&&(t.textContent="ë³µì‚¬"),n.classList.remove("text-green-600")},2e3)}catch(o){console.error("å¤åˆ¶å¤±è´¥:",o);const s=document.createRange(),i=e.querySelector("code")||e;s.selectNodeContents(i);const n=window.getSelection();n.removeAllRanges(),n.addRange(s),t&&(t.textContent="ì„ íƒë¨"),setTimeout(()=>{t&&(t.textContent="ë³µì‚¬"),n.removeAllRanges()},2e3)}})}if(t){const d=t.querySelector(".collapse-icon"),c=t.querySelector(".collapse-text"),n=e.querySelector(".collapse-overlay");let s=e.querySelector("pre.chroma");s||(s=e.querySelector("pre"));const m=t.dataset.defaultState||"expanded",f=t.dataset.collapsed==="true",u=parseInt(t.dataset.autoCollapseLines)||30,h=parseInt(t.dataset.autoCollapseHeight)||400,p=parseInt(t.dataset.collapsedHeight)||120;let l=!1;function i(){const e=f||m==="collapsed"||a();e&&o(!0,!1)}function a(){if(s){const e=s.querySelectorAll(".line, .cl"),t=s.offsetHeight;return e.length>u||t>h}const t=e.offsetHeight;if(t>h)return!0;const n=e.textContent||e.innerText||"",o=n.split(`
`).length;return o>u}function o(s,o=!0){if(!n)return;l=s,s?(e.style.maxHeight=p+"px",e.style.overflow="hidden",n.style.opacity="1",n.style.pointerEvents="auto",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
</svg>`,c&&(c.textContent="í¼ì¹˜ê¸°"),t.title="í¼ì¹˜ê¸°"):(e.style.maxHeight="",e.style.overflow="",n.style.opacity="0",n.style.pointerEvents="none",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z"/></svg>`,c&&(c.textContent="ì ‘ê¸°"),t.title="ì ‘ê¸°"),o&&(e.style.transition="max-height 0.3s ease-out",setTimeout(()=>{e.style.transition=""},300))}function r(){o(!l,!0)}t.addEventListener("click",r),n&&n.addEventListener("click",()=>{l&&o(!1,!0)}),i()}})()</script><h3 id=-softmax-ê³„ì‚°-localë§Œ-ê³ ë ¤í•œ-softmax>â‘¡ softmax&rsquo; ê³„ì‚° (Localë§Œ ê³ ë ¤í•œ softmax)</h3><p>ê° DeviceëŠ” ì „ì—­ ê²°ê³¼ë¥¼ ëª¨ë¥´ë¯€ë¡œ ì¼ë‹¨ Local softmaxë¥¼ êµ¬í•©ë‹ˆë‹¤.</p><div class="code-block-container border-border bg-card my-6 overflow-hidden rounded-xl border shadow-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:shadow-md"><div class="code-block-header bg-muted/30 border-border flex items-center justify-between border-b px-4 py-3"><div class="flex items-center gap-2"><div class="text-muted-foreground flex-shrink-0"><svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4 4 4-4 4M6 16l-4-4 4-4"/></svg></div><span class="text-muted-foreground text-sm font-medium">PLAINTEXT</span></div><div class="flex items-center gap-2"><button class="collapse-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-3 data-default-state=expanded data-collapsed=false data-auto-collapse-lines=30 data-auto-collapse-height=400 data-collapsed-height=120 title=ì ‘ê¸° aria-label=ì ‘ê¸°>
<span class=collapse-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41 12 10.83l4.59 4.58L18 14l-6-6-6 6z"/></svg>
</span><span class="collapse-text hidden sm:inline">ì ‘ê¸°</span>
</button>
<button class="copy-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-3 title=ë³µì‚¬ aria-label=ë³µì‚¬>
<span class=copy-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/></svg>
</span><span class="copy-text hidden sm:inline">ë³µì‚¬</span></button></div></div><div class="code-block-content relative" id=code-3><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=ln>1</span><span class=cl>softmax&#39;(Y_local) = [exp(0.12-0.19), exp(0.19-0.19)] / sum&#39;
</span></span><span class=line><span class=ln>2</span><span class=cl>â‰ˆ [0.482, 0.518]</span></span></code></pre></div><div class="collapse-overlay to-card/90 pointer-events-none absolute inset-0 bg-gradient-to-b from-transparent via-transparent opacity-0 transition-opacity duration-300"><div class="text-muted-foreground bg-card/80 border-border/50 hover:bg-primary/10 hover:text-primary hover:border-primary/30 absolute bottom-4 left-1/2 -translate-x-1/2 cursor-pointer rounded-full border px-3 py-1.5 text-xs backdrop-blur-sm transition-all duration-200">í´ë¦­í•˜ì—¬ ë” ë³´ê¸°</div></div></div></div><script>(function(){const s="code-3",n=document.querySelector('.copy-code-btn[data-code-id="'+s+'"]'),t=document.querySelector('.collapse-code-btn[data-code-id="'+s+'"]'),e=document.getElementById(s);if(!e)return;if(n){const s=n.querySelector(".copy-icon"),t=n.querySelector(".copy-text");n.addEventListener("click",async function(){try{let o="";const i=e.querySelector(".lntd:last-child code");if(i)o=i.textContent||i.innerText;else{const t=e.querySelector("code");if(t){const e=t.querySelector(".ln");if(e){const e=t.querySelectorAll(".cl");if(e.length>0)o=Array.from(e).map(e=>{const t=e.textContent||e.innerText;return t.replace(/\n+$/,"")}).join(`
`).replace(/\n+$/,"");else{const e=t.textContent||t.innerText;o=e.replace(/^\d+/gm,"").replace(/^\s+/gm,"")}}else o=t.textContent||t.innerText}else o=e.textContent||e.innerText}o=o.trim(),await navigator.clipboard.writeText(o),s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
</svg>`,t&&(t.textContent="ë³µì‚¬ë¨"),n.classList.add("text-green-600"),setTimeout(()=>{s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
</svg>`,t&&(t.textContent="ë³µì‚¬"),n.classList.remove("text-green-600")},2e3)}catch(o){console.error("å¤åˆ¶å¤±è´¥:",o);const s=document.createRange(),i=e.querySelector("code")||e;s.selectNodeContents(i);const n=window.getSelection();n.removeAllRanges(),n.addRange(s),t&&(t.textContent="ì„ íƒë¨"),setTimeout(()=>{t&&(t.textContent="ë³µì‚¬"),n.removeAllRanges()},2e3)}})}if(t){const d=t.querySelector(".collapse-icon"),c=t.querySelector(".collapse-text"),n=e.querySelector(".collapse-overlay");let s=e.querySelector("pre.chroma");s||(s=e.querySelector("pre"));const m=t.dataset.defaultState||"expanded",f=t.dataset.collapsed==="true",u=parseInt(t.dataset.autoCollapseLines)||30,h=parseInt(t.dataset.autoCollapseHeight)||400,p=parseInt(t.dataset.collapsedHeight)||120;let l=!1;function i(){const e=f||m==="collapsed"||a();e&&o(!0,!1)}function a(){if(s){const e=s.querySelectorAll(".line, .cl"),t=s.offsetHeight;return e.length>u||t>h}const t=e.offsetHeight;if(t>h)return!0;const n=e.textContent||e.innerText||"",o=n.split(`
`).length;return o>u}function o(s,o=!0){if(!n)return;l=s,s?(e.style.maxHeight=p+"px",e.style.overflow="hidden",n.style.opacity="1",n.style.pointerEvents="auto",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
</svg>`,c&&(c.textContent="í¼ì¹˜ê¸°"),t.title="í¼ì¹˜ê¸°"):(e.style.maxHeight="",e.style.overflow="",n.style.opacity="0",n.style.pointerEvents="none",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z"/></svg>`,c&&(c.textContent="ì ‘ê¸°"),t.title="ì ‘ê¸°"),o&&(e.style.transition="max-height 0.3s ease-out",setTimeout(()=>{e.style.transition=""},300))}function r(){o(!l,!0)}t.addEventListener("click",r),n&&n.addEventListener("click",()=>{l&&o(!1,!0)}),i()}})()</script><h3 id=-ê¸€ë¡œë²Œ-í†µì‹ -all-reduce-í›„-ì •í™•í•œ-softmax-ê³„ì‚°>â‘¡ ê¸€ë¡œë²Œ í†µì‹  (All-Reduce) í›„ ì •í™•í•œ softmax ê³„ì‚°</h3><p>ëª¨ë“  DeviceëŠ” All-Reduceë¡œ ì „ì—­ ìµœëŒ€ê°’(m) ë° ì „ì—­ í•©(sum)ì„ ê³„ì‚°í•©ë‹ˆë‹¤.</p><div class="code-block-container border-border bg-card my-6 overflow-hidden rounded-xl border shadow-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:shadow-md"><div class="code-block-header bg-muted/30 border-border flex items-center justify-between border-b px-4 py-3"><div class="flex items-center gap-2"><div class="text-muted-foreground flex-shrink-0"><svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4 4 4-4 4M6 16l-4-4 4-4"/></svg></div><span class="text-muted-foreground text-sm font-medium">PLAINTEXT</span></div><div class="flex items-center gap-2"><button class="collapse-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-4 data-default-state=expanded data-collapsed=false data-auto-collapse-lines=30 data-auto-collapse-height=400 data-collapsed-height=120 title=ì ‘ê¸° aria-label=ì ‘ê¸°>
<span class=collapse-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41 12 10.83l4.59 4.58L18 14l-6-6-6 6z"/></svg>
</span><span class="collapse-text hidden sm:inline">ì ‘ê¸°</span>
</button>
<button class="copy-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-4 title=ë³µì‚¬ aria-label=ë³µì‚¬>
<span class=copy-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/></svg>
</span><span class="copy-text hidden sm:inline">ë³µì‚¬</span></button></div></div><div class="code-block-content relative" id=code-4><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=ln>1</span><span class=cl>ì˜ˆì‹œ:
</span></span><span class=line><span class=ln>2</span><span class=cl>m = AllReduce_max([0.19, device2_m&#39;, device3 m&#39;, device4 m&#39;])
</span></span><span class=line><span class=ln>3</span><span class=cl>sum = AllReduce_sum(ê° deviceì˜ sum&#39; Ã— exp(m&#39;-m))</span></span></code></pre></div><div class="collapse-overlay to-card/90 pointer-events-none absolute inset-0 bg-gradient-to-b from-transparent via-transparent opacity-0 transition-opacity duration-300"><div class="text-muted-foreground bg-card/80 border-border/50 hover:bg-primary/10 hover:text-primary hover:border-primary/30 absolute bottom-4 left-1/2 -translate-x-1/2 cursor-pointer rounded-full border px-3 py-1.5 text-xs backdrop-blur-sm transition-all duration-200">í´ë¦­í•˜ì—¬ ë” ë³´ê¸°</div></div></div></div><script>(function(){const s="code-4",n=document.querySelector('.copy-code-btn[data-code-id="'+s+'"]'),t=document.querySelector('.collapse-code-btn[data-code-id="'+s+'"]'),e=document.getElementById(s);if(!e)return;if(n){const s=n.querySelector(".copy-icon"),t=n.querySelector(".copy-text");n.addEventListener("click",async function(){try{let o="";const i=e.querySelector(".lntd:last-child code");if(i)o=i.textContent||i.innerText;else{const t=e.querySelector("code");if(t){const e=t.querySelector(".ln");if(e){const e=t.querySelectorAll(".cl");if(e.length>0)o=Array.from(e).map(e=>{const t=e.textContent||e.innerText;return t.replace(/\n+$/,"")}).join(`
`).replace(/\n+$/,"");else{const e=t.textContent||t.innerText;o=e.replace(/^\d+/gm,"").replace(/^\s+/gm,"")}}else o=t.textContent||t.innerText}else o=e.textContent||e.innerText}o=o.trim(),await navigator.clipboard.writeText(o),s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
</svg>`,t&&(t.textContent="ë³µì‚¬ë¨"),n.classList.add("text-green-600"),setTimeout(()=>{s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
</svg>`,t&&(t.textContent="ë³µì‚¬"),n.classList.remove("text-green-600")},2e3)}catch(o){console.error("å¤åˆ¶å¤±è´¥:",o);const s=document.createRange(),i=e.querySelector("code")||e;s.selectNodeContents(i);const n=window.getSelection();n.removeAllRanges(),n.addRange(s),t&&(t.textContent="ì„ íƒë¨"),setTimeout(()=>{t&&(t.textContent="ë³µì‚¬"),n.removeAllRanges()},2e3)}})}if(t){const d=t.querySelector(".collapse-icon"),c=t.querySelector(".collapse-text"),n=e.querySelector(".collapse-overlay");let s=e.querySelector("pre.chroma");s||(s=e.querySelector("pre"));const m=t.dataset.defaultState||"expanded",f=t.dataset.collapsed==="true",u=parseInt(t.dataset.autoCollapseLines)||30,h=parseInt(t.dataset.autoCollapseHeight)||400,p=parseInt(t.dataset.collapsedHeight)||120;let l=!1;function i(){const e=f||m==="collapsed"||a();e&&o(!0,!1)}function a(){if(s){const e=s.querySelectorAll(".line, .cl"),t=s.offsetHeight;return e.length>u||t>h}const t=e.offsetHeight;if(t>h)return!0;const n=e.textContent||e.innerText||"",o=n.split(`
`).length;return o>u}function o(s,o=!0){if(!n)return;l=s,s?(e.style.maxHeight=p+"px",e.style.overflow="hidden",n.style.opacity="1",n.style.pointerEvents="auto",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
</svg>`,c&&(c.textContent="í¼ì¹˜ê¸°"),t.title="í¼ì¹˜ê¸°"):(e.style.maxHeight="",e.style.overflow="",n.style.opacity="0",n.style.pointerEvents="none",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z"/></svg>`,c&&(c.textContent="ì ‘ê¸°"),t.title="ì ‘ê¸°"),o&&(e.style.transition="max-height 0.3s ease-out",setTimeout(()=>{e.style.transition=""},300))}function r(){o(!l,!0)}t.addEventListener("click",r),n&&n.addEventListener("click",()=>{l&&o(!1,!0)}),i()}})()</script><ul><li>ì´í›„ ê° DeviceëŠ” ì „ì—­ softmaxë¥¼ ê³„ì‚°:
[
softmax(Y_{global})=softmax&rsquo;(Y_{local})\times\frac{sum&rsquo;\times e^{m&rsquo;-m}}{sum}
]</li></ul><hr><h2 id=-backward-phase>â—€ï¸ [Backward Phase]</h2><h3 id=-backward-gradient-ê³„ì‚°ì„-ìœ„í•œ-ì¤‘ê°„ê°’-ë¯¸ë¦¬-ê³„ì‚°>â‘  backward Gradient ê³„ì‚°ì„ ìœ„í•œ ì¤‘ê°„ê°’ ë¯¸ë¦¬ ê³„ì‚°</h3><ul><li>ê° Deviceì—ì„œ ë¯¸ë¦¬ ë‹¤ìŒ ê°’ì„ ì¤€ë¹„í•©ë‹ˆë‹¤:</li></ul><div class="code-block-container border-border bg-card my-6 overflow-hidden rounded-xl border shadow-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:shadow-md"><div class="code-block-header bg-muted/30 border-border flex items-center justify-between border-b px-4 py-3"><div class="flex items-center gap-2"><div class="text-muted-foreground flex-shrink-0"><svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4 4 4-4 4M6 16l-4-4 4-4"/></svg></div><span class="text-muted-foreground text-sm font-medium">PLAINTEXT</span></div><div class="flex items-center gap-2"><button class="collapse-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-5 data-default-state=expanded data-collapsed=false data-auto-collapse-lines=30 data-auto-collapse-height=400 data-collapsed-height=120 title=ì ‘ê¸° aria-label=ì ‘ê¸°>
<span class=collapse-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41 12 10.83l4.59 4.58L18 14l-6-6-6 6z"/></svg>
</span><span class="collapse-text hidden sm:inline">ì ‘ê¸°</span>
</button>
<button class="copy-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-5 title=ë³µì‚¬ aria-label=ë³µì‚¬>
<span class=copy-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/></svg>
</span><span class="copy-text hidden sm:inline">ë³µì‚¬</span></button></div></div><div class="code-block-content relative" id=code-5><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=ln>1</span><span class=cl>A = softmax&#39;(Y_local) Ã— W_local
</span></span><span class=line><span class=ln>2</span><span class=cl>B = GW (label one-hot Gê°€ ì •í•´ì§„ ìƒíƒœì—ì„œ GWë¥¼ ë¯¸ë¦¬ ê³„ì‚°)</span></span></code></pre></div><div class="collapse-overlay to-card/90 pointer-events-none absolute inset-0 bg-gradient-to-b from-transparent via-transparent opacity-0 transition-opacity duration-300"><div class="text-muted-foreground bg-card/80 border-border/50 hover:bg-primary/10 hover:text-primary hover:border-primary/30 absolute bottom-4 left-1/2 -translate-x-1/2 cursor-pointer rounded-full border px-3 py-1.5 text-xs backdrop-blur-sm transition-all duration-200">í´ë¦­í•˜ì—¬ ë” ë³´ê¸°</div></div></div></div><script>(function(){const s="code-5",n=document.querySelector('.copy-code-btn[data-code-id="'+s+'"]'),t=document.querySelector('.collapse-code-btn[data-code-id="'+s+'"]'),e=document.getElementById(s);if(!e)return;if(n){const s=n.querySelector(".copy-icon"),t=n.querySelector(".copy-text");n.addEventListener("click",async function(){try{let o="";const i=e.querySelector(".lntd:last-child code");if(i)o=i.textContent||i.innerText;else{const t=e.querySelector("code");if(t){const e=t.querySelector(".ln");if(e){const e=t.querySelectorAll(".cl");if(e.length>0)o=Array.from(e).map(e=>{const t=e.textContent||e.innerText;return t.replace(/\n+$/,"")}).join(`
`).replace(/\n+$/,"");else{const e=t.textContent||t.innerText;o=e.replace(/^\d+/gm,"").replace(/^\s+/gm,"")}}else o=t.textContent||t.innerText}else o=e.textContent||e.innerText}o=o.trim(),await navigator.clipboard.writeText(o),s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
</svg>`,t&&(t.textContent="ë³µì‚¬ë¨"),n.classList.add("text-green-600"),setTimeout(()=>{s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
</svg>`,t&&(t.textContent="ë³µì‚¬"),n.classList.remove("text-green-600")},2e3)}catch(o){console.error("å¤åˆ¶å¤±è´¥:",o);const s=document.createRange(),i=e.querySelector("code")||e;s.selectNodeContents(i);const n=window.getSelection();n.removeAllRanges(),n.addRange(s),t&&(t.textContent="ì„ íƒë¨"),setTimeout(()=>{t&&(t.textContent="ë³µì‚¬"),n.removeAllRanges()},2e3)}})}if(t){const d=t.querySelector(".collapse-icon"),c=t.querySelector(".collapse-text"),n=e.querySelector(".collapse-overlay");let s=e.querySelector("pre.chroma");s||(s=e.querySelector("pre"));const m=t.dataset.defaultState||"expanded",f=t.dataset.collapsed==="true",u=parseInt(t.dataset.autoCollapseLines)||30,h=parseInt(t.dataset.autoCollapseHeight)||400,p=parseInt(t.dataset.collapsedHeight)||120;let l=!1;function i(){const e=f||m==="collapsed"||a();e&&o(!0,!1)}function a(){if(s){const e=s.querySelectorAll(".line, .cl"),t=s.offsetHeight;return e.length>u||t>h}const t=e.offsetHeight;if(t>h)return!0;const n=e.textContent||e.innerText||"",o=n.split(`
`).length;return o>u}function o(s,o=!0){if(!n)return;l=s,s?(e.style.maxHeight=p+"px",e.style.overflow="hidden",n.style.opacity="1",n.style.pointerEvents="auto",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
</svg>`,c&&(c.textContent="í¼ì¹˜ê¸°"),t.title="í¼ì¹˜ê¸°"):(e.style.maxHeight="",e.style.overflow="",n.style.opacity="0",n.style.pointerEvents="none",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z"/></svg>`,c&&(c.textContent="ì ‘ê¸°"),t.title="ì ‘ê¸°"),o&&(e.style.transition="max-height 0.3s ease-out",setTimeout(()=>{e.style.transition=""},300))}function r(){o(!l,!0)}t.addEventListener("click",r),n&&n.addEventListener("click",()=>{l&&o(!1,!0)}),i()}})()</script><h3 id=-all-reduce-í†µì‹ ìœ¼ë¡œ-ì •í™•í•œ-gradient-ê³„ì‚°>â‘¡ All-Reduce í†µì‹ ìœ¼ë¡œ ì •í™•í•œ gradient ê³„ì‚°</h3><ul><li><p>All-Reduceë¡œ ì „ì—­ max(m), sum(sum)ì„ ë°›ì•„ì„œ ì •í™•í•œ Gradientë¥¼ ê³„ì‚°í•©ë‹ˆë‹¤.</p></li><li><p>ê·¸ í›„, ê¸€ë¡œë²Œ ì •í™•í•œ GradientëŠ” ë¯¸ë¦¬ ê³„ì‚°í•œ ì¤‘ê°„ê°’ìœ¼ë¡œë¶€í„° ë¹ ë¥´ê²Œ ê³„ì‚°ë©ë‹ˆë‹¤.</p></li><li><p>ì •í™•í•œ Gradient ê³„ì‚° ì˜ˆì‹œ:</p></li></ul><div class="code-block-container border-border bg-card my-6 overflow-hidden rounded-xl border shadow-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:shadow-md"><div class="code-block-header bg-muted/30 border-border flex items-center justify-between border-b px-4 py-3"><div class="flex items-center gap-2"><div class="text-muted-foreground flex-shrink-0"><svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4 4 4-4 4M6 16l-4-4 4-4"/></svg></div><span class="text-muted-foreground text-sm font-medium">PLAINTEXT</span></div><div class="flex items-center gap-2"><button class="collapse-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-6 data-default-state=expanded data-collapsed=false data-auto-collapse-lines=30 data-auto-collapse-height=400 data-collapsed-height=120 title=ì ‘ê¸° aria-label=ì ‘ê¸°>
<span class=collapse-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41 12 10.83l4.59 4.58L18 14l-6-6-6 6z"/></svg>
</span><span class="collapse-text hidden sm:inline">ì ‘ê¸°</span>
</button>
<button class="copy-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-6 title=ë³µì‚¬ aria-label=ë³µì‚¬>
<span class=copy-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/></svg>
</span><span class="copy-text hidden sm:inline">ë³µì‚¬</span></button></div></div><div class="code-block-content relative" id=code-6><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=ln>1</span><span class=cl>âˆ‡X = (softmax&#39;(Y)W) Ã— (sum&#39; Ã— e^(m&#39;-m) / sum) - GW</span></span></code></pre></div><div class="collapse-overlay to-card/90 pointer-events-none absolute inset-0 bg-gradient-to-b from-transparent via-transparent opacity-0 transition-opacity duration-300"><div class="text-muted-foreground bg-card/80 border-border/50 hover:bg-primary/10 hover:text-primary hover:border-primary/30 absolute bottom-4 left-1/2 -translate-x-1/2 cursor-pointer rounded-full border px-3 py-1.5 text-xs backdrop-blur-sm transition-all duration-200">í´ë¦­í•˜ì—¬ ë” ë³´ê¸°</div></div></div></div><script>(function(){const s="code-6",n=document.querySelector('.copy-code-btn[data-code-id="'+s+'"]'),t=document.querySelector('.collapse-code-btn[data-code-id="'+s+'"]'),e=document.getElementById(s);if(!e)return;if(n){const s=n.querySelector(".copy-icon"),t=n.querySelector(".copy-text");n.addEventListener("click",async function(){try{let o="";const i=e.querySelector(".lntd:last-child code");if(i)o=i.textContent||i.innerText;else{const t=e.querySelector("code");if(t){const e=t.querySelector(".ln");if(e){const e=t.querySelectorAll(".cl");if(e.length>0)o=Array.from(e).map(e=>{const t=e.textContent||e.innerText;return t.replace(/\n+$/,"")}).join(`
`).replace(/\n+$/,"");else{const e=t.textContent||t.innerText;o=e.replace(/^\d+/gm,"").replace(/^\s+/gm,"")}}else o=t.textContent||t.innerText}else o=e.textContent||e.innerText}o=o.trim(),await navigator.clipboard.writeText(o),s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
</svg>`,t&&(t.textContent="ë³µì‚¬ë¨"),n.classList.add("text-green-600"),setTimeout(()=>{s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
</svg>`,t&&(t.textContent="ë³µì‚¬"),n.classList.remove("text-green-600")},2e3)}catch(o){console.error("å¤åˆ¶å¤±è´¥:",o);const s=document.createRange(),i=e.querySelector("code")||e;s.selectNodeContents(i);const n=window.getSelection();n.removeAllRanges(),n.addRange(s),t&&(t.textContent="ì„ íƒë¨"),setTimeout(()=>{t&&(t.textContent="ë³µì‚¬"),n.removeAllRanges()},2e3)}})}if(t){const d=t.querySelector(".collapse-icon"),c=t.querySelector(".collapse-text"),n=e.querySelector(".collapse-overlay");let s=e.querySelector("pre.chroma");s||(s=e.querySelector("pre"));const m=t.dataset.defaultState||"expanded",f=t.dataset.collapsed==="true",u=parseInt(t.dataset.autoCollapseLines)||30,h=parseInt(t.dataset.autoCollapseHeight)||400,p=parseInt(t.dataset.collapsedHeight)||120;let l=!1;function i(){const e=f||m==="collapsed"||a();e&&o(!0,!1)}function a(){if(s){const e=s.querySelectorAll(".line, .cl"),t=s.offsetHeight;return e.length>u||t>h}const t=e.offsetHeight;if(t>h)return!0;const n=e.textContent||e.innerText||"",o=n.split(`
`).length;return o>u}function o(s,o=!0){if(!n)return;l=s,s?(e.style.maxHeight=p+"px",e.style.overflow="hidden",n.style.opacity="1",n.style.pointerEvents="auto",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
</svg>`,c&&(c.textContent="í¼ì¹˜ê¸°"),t.title="í¼ì¹˜ê¸°"):(e.style.maxHeight="",e.style.overflow="",n.style.opacity="0",n.style.pointerEvents="none",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z"/></svg>`,c&&(c.textContent="ì ‘ê¸°"),t.title="ì ‘ê¸°"),o&&(e.style.transition="max-height 0.3s ease-out",setTimeout(()=>{e.style.transition=""},300))}function r(){o(!l,!0)}t.addEventListener("click",r),n&&n.addEventListener("click",()=>{l&&o(!1,!0)}),i()}})()</script><ul><li>ì´í›„ (\nabla W=(softmax(Y)-G)^T X)ëŠ” Transformer Backwardì™€ ë¬´ê´€í•˜ë¯€ë¡œ ë’¤ë¡œ ë¯¸ë£° ìˆ˜ ìˆì–´ Pipeline Bubbleì„ ìµœì†Œí™”í•©ë‹ˆë‹¤.</li></ul><hr><h2 id=-ì•Œê³ ë¦¬ì¦˜-2ì˜-ì¥ì ê³¼-íš¨ê³¼>ğŸ“Œ ì•Œê³ ë¦¬ì¦˜ 2ì˜ ì¥ì ê³¼ íš¨ê³¼</h2><ul><li><p><strong>í†µì‹  íšŸìˆ˜ ê°ì†Œ</strong>:</p><table><thead><tr><th>ë¹„êµ ë°©ì‹</th><th>Communication Barrier ìˆ˜</th><th>Activation Memory Overhead</th></tr></thead><tbody><tr><td>ê¸°ì¡´ ë°©ì‹</td><td>3íšŒ</td><td>ë†’ìŒ</td></tr><tr><td>Algorithm 1</td><td>2íšŒ</td><td>ì¤‘ê°„ ìˆ˜ì¤€</td></tr><tr><td>Algorithm 2(ìµœì )</td><td><strong>1íšŒ</strong></td><td>ë‚®ìŒ</td></tr></tbody></table></li><li><p><strong>Memory Usage ë° Throughput í–¥ìƒ</strong>:</p><ul><li>PPì˜ ì „ì²´ ì—°ì‚° ì„±ëŠ¥(MFU) ìµœëŒ€ <strong>51% ê°œì„ </strong></li><li>Memory ì‚¬ìš©ëŸ‰ ìµœëŒ€ 50% ê°ì†Œ (32 GPUs, 256k vocab ê¸°ì¤€)</li></ul></li></ul><hr><h2 id=-ìµœì¢…-ì •ë¦¬>ğŸš© ìµœì¢… ì •ë¦¬</h2><table><thead><tr><th>ê³¼ì •</th><th>ë‚´ìš© ë° íš¨ê³¼</th></tr></thead><tbody><tr><td>í•µì‹¬ ë¬¸ì œì </td><td>ê¸°ì¡´ PPì—ì„œ Vocabulary layerì˜ ì‹¬ê°í•œ ë¶ˆê· í˜• ë°œìƒ</td></tr><tr><td>ì œì•ˆ ë°©ë²•</td><td>Vocabulary Parallelismìœ¼ë¡œ ëª¨ë“  Deviceì— ê· ë“± ë¶„ì‚°</td></tr><tr><td>ìµœì í™” ì•Œê³ ë¦¬ì¦˜</td><td>Softmax ê³„ì‚°ì˜ All-Reduceë¥¼ ìµœì†Œí™”í•˜ì—¬ ì—°ì‚° ë° í†µì‹  ë¹„ìš© ê°ì†Œ</td></tr><tr><td>ê²°ê³¼ì  íš¨ê³¼</td><td>throughput ìµœëŒ€ 51% ì¦ê°€, peak memory usage ê· í˜• ìœ ì§€</td></tr></tbody></table><p>ì´ ë…¼ë¬¸ì˜ ì•Œê³ ë¦¬ì¦˜ì€ PPì˜ ì£¼ìš” ë³‘ëª©(ì…ì¶œë ¥ì¸µ) ë¬¸ì œë¥¼ ëª…í™•íˆ í•´ê²°í•˜ì—¬, ë†’ì€ íš¨ìœ¨ê³¼ ë©”ëª¨ë¦¬ ê· í˜•ì„±ì„ ë‹¬ì„±í–ˆë‹¤ëŠ” ì ì—ì„œ ë…ì°½ì ì´ë©° ì‹¤ì œì ìœ¼ë¡œ ìœ ìš©í•©ë‹ˆë‹¤.</p><h1 id=q--ì´-ë…¼ë¬¸ì—ì„œ-ì‚¬ìš©í•˜ëŠ”-ë°©ë²•ì„-í•™ìŠµí•˜ê¸°-ìœ„í•˜ì—¬-ì–´ë–¤-ë°ì´í„°ì…‹ì´-í•„ìš”í• ê¹Œ-ê·¸ë¦¬ê³ -ì–´ë–»ê²Œ-í•™ìŠµì„-ì§„í–‰í•˜ë©´-ë ì§€-ì˜ˆì‹œë¥¼-ë“¤ì–´ì„œ-ì•„ì£¼-ìì„¸í•˜ê²Œ-ì„¤ëª…í•´ì¤˜>Q : ì´ ë…¼ë¬¸ì—ì„œ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ì„ í•™ìŠµí•˜ê¸° ìœ„í•˜ì—¬ ì–´ë–¤ ë°ì´í„°ì…‹ì´ í•„ìš”í• ê¹Œ? ê·¸ë¦¬ê³  ì–´ë–»ê²Œ í•™ìŠµì„ ì§„í–‰í•˜ë©´ ë ì§€ ì˜ˆì‹œë¥¼ ë“¤ì–´ì„œ ì•„ì£¼ ìì„¸í•˜ê²Œ ì„¤ëª…í•´ì¤˜</h1><p>ì´ ë…¼ë¬¸ì—ì„œ ì œì•ˆëœ ë°©ë²•ì€ <strong>Transformer ê¸°ë°˜ì˜ ê±°ëŒ€ ì–¸ì–´ ëª¨ë¸(Large Language Model, LLM)</strong> ì„ í•™ìŠµí•  ë•Œì˜ <strong>Pipeline Parallelism ë° Vocabulary Parallelism</strong> ì„ ìµœì í™”í•˜ê¸° ìœ„í•œ ê¸°ìˆ ì…ë‹ˆë‹¤. ë”°ë¼ì„œ ë…¼ë¬¸ì˜ ë°©ë²•ì„ í•™ìŠµí•˜ê³  ì‹¤ì œë¡œ ê²€ì¦í•˜ë ¤ë©´ Transformer ê¸°ë°˜ ì–¸ì–´ ëª¨ë¸ í•™ìŠµì— ì£¼ë¡œ ì‚¬ìš©í•˜ëŠ” <strong>ëŒ€ê·œëª¨ ìì—°ì–´ ë°ì´í„°ì…‹</strong>ì´ í•„ìš”í•©ë‹ˆë‹¤.</p><p>ì•„ë˜ì—ì„œ í•„ìš” ë°ì´í„°ì…‹ ë° ë°ì´í„°ì…‹ì„ ì´ìš©í•œ í•™ìŠµ ë°©ë²•ì„ ìƒì„¸íˆ ì„¤ëª…í•˜ê² ìŠµë‹ˆë‹¤.</p><hr><h2 id=-1-í•„ìš”í•œ-ë°ì´í„°ì…‹ì˜-íŠ¹ì§•>âœ… 1. í•„ìš”í•œ ë°ì´í„°ì…‹ì˜ íŠ¹ì§•</h2><p>ì´ ê¸°ìˆ ì˜ íš¨ê³¼ì ì¸ ê²€ì¦ì„ ìœ„í•´ì„œëŠ” ë‹¤ìŒê³¼ ê°™ì€ ì¡°ê±´ì„ ì¶©ì¡±í•˜ëŠ” ë°ì´í„°ì…‹ì´ í•„ìš”í•©ë‹ˆë‹¤.</p><ul><li>ëŒ€ê·œëª¨(ìµœì†Œ ìˆ˜ì‹­ GB ì´ìƒ), ìˆ˜ì–µ~ìˆ˜ì²œì–µ ê°œ ì´ìƒì˜ Tokenìœ¼ë¡œ êµ¬ì„±ëœ ë°ì´í„°ì…‹</li><li>Token ìˆ˜ê°€ ë§ì„ìˆ˜ë¡ ë…¼ë¬¸ì—ì„œ ì œì•ˆí•œ ë³‘ë ¬í™”ì˜ ì„±ëŠ¥ ì°¨ì´ë¥¼ ëª…í™•íˆ ë³¼ ìˆ˜ ìˆìŒ</li><li>ë‹¤ì–‘í•œ ì–´íœ˜ë¥¼ í¬í•¨í•˜ëŠ” ë°ì´í„°ì…‹(ë…¼ë¬¸ì˜ í•µì‹¬ì€ vocabulary ë³‘ë ¬í™”ë¡œ, ì–´íœ˜ í¬ê¸°ê°€ í´ìˆ˜ë¡ ì„±ëŠ¥ ë¹„êµê°€ ìš©ì´)</li></ul><hr><h2 id=ì¶”ì²œí•˜ëŠ”-ëŒ€í‘œì -ë°ì´í„°ì…‹-ì˜ˆì‹œ>ì¶”ì²œí•˜ëŠ” ëŒ€í‘œì  ë°ì´í„°ì…‹ ì˜ˆì‹œ</h2><table><thead><tr><th>ë°ì´í„°ì…‹</th><th>ê·œëª¨</th><th>íŠ¹ì§•</th></tr></thead><tbody><tr><td>C4 (Colossal Clean Crawled Corpus)</td><td>ì•½ 800GB, 1800ì–µ í† í°</td><td>ì¼ë°˜ì ì¸ ì›¹ í…ìŠ¤íŠ¸ ë°ì´í„°</td></tr><tr><td>The Pile</td><td>ì•½ 825GB, ì•½ 2100ì–µ í† í°</td><td>GitHub, Books, ë…¼ë¬¸, ì›¹ í˜ì´ì§€ ë“± í˜¼í•©</td></tr><tr><td>OSCAR</td><td>ì•½ 1.2TB ì´ìƒ</td><td>ì—¬ëŸ¬ ì–¸ì–´ë¡œ ëœ ëŒ€ê·œëª¨ ì›¹ í¬ë¡¤ë§ ë°ì´í„°</td></tr><tr><td>Wikipedia + BookCorpus</td><td>ì•½ 4ì–µ í† í° ì´ìƒ</td><td>Wikipedia ë¬¸ì„œ, ë„ì„œ ë“± ë‹¤ì–‘</td></tr><tr><td>C4-ko, ë‚˜ë¬´ìœ„í‚¤</td><td>ì•½ 40~300ì–µ í† í° ì´ìƒ</td><td>í•œêµ­ì–´ íŠ¹í™” ì–¸ì–´ëª¨ë¸ í•™ìŠµìš© ëŒ€ìš©ëŸ‰ ë°ì´í„°</td></tr></tbody></table><h3 id=-ë°ì´í„°ì…‹ì˜-ëŒ€í‘œ-ì˜ˆì‹œ-ë¹„êµ>ğŸ“ ë°ì´í„°ì…‹ì˜ ëŒ€í‘œ ì˜ˆì‹œ ë¹„êµ</h3><table><thead><tr><th>ë°ì´í„°ì…‹ëª…</th><th>í† í° ìˆ˜</th><th>ì–¸ì–´</th><th>ë°ì´í„° ì¶œì²˜</th></tr></thead><tbody><tr><td>C4</td><td>~1800ì–µ</td><td>ì˜ì–´ ì¤‘ì‹¬</td><td>ì›¹ í˜ì´ì§€</td></tr><tr><td>The Pile</td><td>~2100ì–µ</td><td>ì˜ì–´ ì¤‘ì‹¬</td><td>ë‹¤ì–‘í•œ ì†ŒìŠ¤ í˜¼í•©</td></tr><tr><td>OSCAR</td><td>ìˆ˜ì²œì–µ ì´ìƒ</td><td>ë‹¤êµ­ì–´ ì§€ì›</td><td>ì›¹ í¬ë¡¤ë§</td></tr><tr><td>Wikipedia + BookCorpus</td><td>ì•½ 1300ì–µ~</td><td>ì£¼ë¡œ ì˜ì–´</td><td>ìœ„í‚¤í”¼ë””ì•„, ì±…</td></tr><tr><td>OSCAR</td><td>ìˆ˜ì²œì–µ ì´ìƒ</td><td>ë‹¤êµ­ì–´ ì§€ì›</td><td>ì›¹ í˜ì´ì§€</td></tr></tbody></table><hr><h2 id=-ë…¼ë¬¸ì˜-ë°©ë²•ì„-ì ìš©í•œ-í•™ìŠµ-ì ˆì°¨>âœ… ë…¼ë¬¸ì˜ ë°©ë²•ì„ ì ìš©í•œ í•™ìŠµ ì ˆì°¨</h2><p>ë‹¤ìŒì€ ë…¼ë¬¸ì—ì„œ ì œì•ˆí•œ <strong>Vocabulary Parallelism</strong>ì„ ì‹¤ì œë¡œ ì ìš©í•˜ì—¬ Transformer ì–¸ì–´ëª¨ë¸ì„ í•™ìŠµí•˜ëŠ” ì „ë°˜ì ì¸ ì ˆì°¨ì…ë‹ˆë‹¤.</p><h3 id=--ë°ì´í„°ì…‹-ì¤€ë¹„-preprocessing>ğŸš© â‘  ë°ì´í„°ì…‹ ì¤€ë¹„ (Preprocessing)</h3><ul><li>ë°ì´í„°ì…‹ ì „ì²˜ë¦¬(í† í¬ë‚˜ì´ì§•, Cleaning)</li><li>BPE ë˜ëŠ” SentencePieceë¥¼ í†µí•œ Vocabulary êµ¬ì¶•</li><li>ë°ì´í„°ì…‹ì„ Tokenization í›„ ì €ì¥</li></ul><p><strong>ì˜ˆì‹œ ë°ì´í„° (í† í°í™” í›„)</strong></p><div class="code-block-container border-border bg-card my-6 overflow-hidden rounded-xl border shadow-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:shadow-md"><div class="code-block-header bg-muted/30 border-border flex items-center justify-between border-b px-4 py-3"><div class="flex items-center gap-2"><div class="text-muted-foreground flex-shrink-0"><svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4 4 4-4 4M6 16l-4-4 4-4"/></svg></div><span class="text-muted-foreground text-sm font-medium">PLAINTEXT</span></div><div class="flex items-center gap-2"><button class="collapse-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-7 data-default-state=expanded data-collapsed=false data-auto-collapse-lines=30 data-auto-collapse-height=400 data-collapsed-height=120 title=ì ‘ê¸° aria-label=ì ‘ê¸°>
<span class=collapse-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41 12 10.83l4.59 4.58L18 14l-6-6-6 6z"/></svg>
</span><span class="collapse-text hidden sm:inline">ì ‘ê¸°</span>
</button>
<button class="copy-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-7 title=ë³µì‚¬ aria-label=ë³µì‚¬>
<span class=copy-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/></svg>
</span><span class="copy-text hidden sm:inline">ë³µì‚¬</span></button></div></div><div class="code-block-content relative" id=code-7><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=ln>1</span><span class=cl>Input Text : &#34;Parallelism improves training throughput.&#34;
</span></span><span class=line><span class=ln>2</span><span class=cl>Tokenized ê²°ê³¼ ì˜ˆì‹œ (vocab size=32K):
</span></span><span class=line><span class=ln>3</span><span class=cl>[1312, 520, 1024, 23312, 2412, 25]</span></span></code></pre></div><div class="collapse-overlay to-card/90 pointer-events-none absolute inset-0 bg-gradient-to-b from-transparent via-transparent opacity-0 transition-opacity duration-300"><div class="text-muted-foreground bg-card/80 border-border/50 hover:bg-primary/10 hover:text-primary hover:border-primary/30 absolute bottom-4 left-1/2 -translate-x-1/2 cursor-pointer rounded-full border px-3 py-1.5 text-xs backdrop-blur-sm transition-all duration-200">í´ë¦­í•˜ì—¬ ë” ë³´ê¸°</div></div></div></div><script>(function(){const s="code-7",n=document.querySelector('.copy-code-btn[data-code-id="'+s+'"]'),t=document.querySelector('.collapse-code-btn[data-code-id="'+s+'"]'),e=document.getElementById(s);if(!e)return;if(n){const s=n.querySelector(".copy-icon"),t=n.querySelector(".copy-text");n.addEventListener("click",async function(){try{let o="";const i=e.querySelector(".lntd:last-child code");if(i)o=i.textContent||i.innerText;else{const t=e.querySelector("code");if(t){const e=t.querySelector(".ln");if(e){const e=t.querySelectorAll(".cl");if(e.length>0)o=Array.from(e).map(e=>{const t=e.textContent||e.innerText;return t.replace(/\n+$/,"")}).join(`
`).replace(/\n+$/,"");else{const e=t.textContent||t.innerText;o=e.replace(/^\d+/gm,"").replace(/^\s+/gm,"")}}else o=t.textContent||t.innerText}else o=e.textContent||e.innerText}o=o.trim(),await navigator.clipboard.writeText(o),s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
</svg>`,t&&(t.textContent="ë³µì‚¬ë¨"),n.classList.add("text-green-600"),setTimeout(()=>{s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
</svg>`,t&&(t.textContent="ë³µì‚¬"),n.classList.remove("text-green-600")},2e3)}catch(o){console.error("å¤åˆ¶å¤±è´¥:",o);const s=document.createRange(),i=e.querySelector("code")||e;s.selectNodeContents(i);const n=window.getSelection();n.removeAllRanges(),n.addRange(s),t&&(t.textContent="ì„ íƒë¨"),setTimeout(()=>{t&&(t.textContent="ë³µì‚¬"),n.removeAllRanges()},2e3)}})}if(t){const d=t.querySelector(".collapse-icon"),c=t.querySelector(".collapse-text"),n=e.querySelector(".collapse-overlay");let s=e.querySelector("pre.chroma");s||(s=e.querySelector("pre"));const m=t.dataset.defaultState||"expanded",f=t.dataset.collapsed==="true",u=parseInt(t.dataset.autoCollapseLines)||30,h=parseInt(t.dataset.autoCollapseHeight)||400,p=parseInt(t.dataset.collapsedHeight)||120;let l=!1;function i(){const e=f||m==="collapsed"||a();e&&o(!0,!1)}function a(){if(s){const e=s.querySelectorAll(".line, .cl"),t=s.offsetHeight;return e.length>u||t>h}const t=e.offsetHeight;if(t>h)return!0;const n=e.textContent||e.innerText||"",o=n.split(`
`).length;return o>u}function o(s,o=!0){if(!n)return;l=s,s?(e.style.maxHeight=p+"px",e.style.overflow="hidden",n.style.opacity="1",n.style.pointerEvents="auto",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
</svg>`,c&&(c.textContent="í¼ì¹˜ê¸°"),t.title="í¼ì¹˜ê¸°"):(e.style.maxHeight="",e.style.overflow="",n.style.opacity="0",n.style.pointerEvents="none",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z"/></svg>`,c&&(c.textContent="ì ‘ê¸°"),t.title="ì ‘ê¸°"),o&&(e.style.transition="max-height 0.3s ease-out",setTimeout(()=>{e.style.transition=""},300))}function r(){o(!l,!0)}t.addEventListener("click",r),n&&n.addEventListener("click",()=>{l&&o(!1,!0)}),i()}})()</script><hr><h3 id=--ëª¨ë¸-êµ¬ì„±-ë°-í™˜ê²½-ì„¤ì •>ğŸš© â‘¡ ëª¨ë¸ êµ¬ì„± ë° í™˜ê²½ ì„¤ì •</h3><p>ë…¼ë¬¸ì—ì„œ ì„¤ì •í•œ íŒŒë¼ë¯¸í„°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì˜ˆì‹œ ëª¨ë¸ êµ¬ì„±:</p><table><thead><tr><th>í•­ëª©</th><th>ì˜ˆì‹œ ê°’</th></tr></thead><tbody><tr><td>Pipeline Device ìˆ˜</td><td>8, 16, 32 GPUs ë“±</td></tr><tr><td>ëª¨ë¸ í¬ê¸°</td><td>ì•½ 4B~30B (ì˜ˆì‹œ: 7B, 16B, 30B ëª¨ë¸)</td></tr><tr><td>Layer ìˆ˜</td><td>32~64</td></tr><tr><td>Hidden size</td><td>4096~6144</td></tr><tr><td>Attention heads</td><td>32~48</td></tr><tr><td>Sequence Length</td><td>2048~4096</td></tr><tr><td>Vocabulary Size</td><td>32K~256K</td></tr></tbody></table><p>GPUëŠ” ë…¼ë¬¸ì—ì„œ ì‚¬ìš©í•œ NVIDIA A100 80GB ë“± ê³ ì„±ëŠ¥ GPUë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ê¶Œì¥ë©ë‹ˆë‹¤.</p><hr><h3 id=--vocabulary-layer-ë³‘ë ¬í™”-ì ìš©-ë…¼ë¬¸-ì•Œê³ ë¦¬ì¦˜-ì ìš©>ğŸš© â‘¢ Vocabulary Layer ë³‘ë ¬í™” ì ìš© (ë…¼ë¬¸ ì•Œê³ ë¦¬ì¦˜ ì ìš©)</h3><p>ë…¼ë¬¸ì—ì„œ ì œì•ˆí•œ ì•Œê³ ë¦¬ì¦˜(Algorithm 2)ì€ ë‹¤ìŒê³¼ ê°™ì´ ë™ì‘í•©ë‹ˆë‹¤.</p><blockquote class="border-primary bg-muted/30 hover:bg-muted/40 my-6 rounded-r-lg border-l-4 py-4 pr-4 pl-6 italic transition-all duration-200 ease-out hover:translate-x-1"><div class="prose prose-sm max-w-none"><p><strong>[ì˜ˆì‹œ: 4ê°œì˜ Pipeline Deviceì—ì„œ Vocab size 8ë¡œ ë‚˜ëˆˆ ìƒí™©]</strong></p></div></blockquote><ul><li>ì›ë˜ ê° DeviceëŠ” ìì‹ ì˜ Vocabulary Partitionì„ ê³„ì‚°</li><li>Forward ë‹¨ê³„ì—ì„œ Logits ê³„ì‚° ë° softmax ë¡œì»¬ ê³„ì‚° í›„ All-Reduce ìˆ˜í–‰</li><li>ìµœì í™”ë¥¼ í†µí•´ All-Reduceë¥¼ ìµœì†Œí™”í•˜ì—¬ softmax ìµœì¢… ê³„ì‚°</li><li>Backward ë‹¨ê³„ëŠ” ë¯¸ë¦¬ ì¤€ë¹„ëœ ì¤‘ê°„ ê°’ì„ ì´ìš©í•˜ì—¬ ìµœì¢… Gradientsë¥¼ íš¨ìœ¨ì ìœ¼ë¡œ ê³„ì‚° í›„ í•œë²ˆì˜ Communicationìœ¼ë¡œ ì™„ë£Œ</li></ul><hr><h3 id=--í•™ìŠµ-ë‹¨ê³„-í›ˆë ¨-ë°˜ë³µ-ê³¼ì •>ğŸš© â‘¢ í•™ìŠµ ë‹¨ê³„ (í›ˆë ¨ ë°˜ë³µ ê³¼ì •)</h3><p>í•™ìŠµì€ Microbatchë¡œ ë‚˜ëˆ„ì–´ ì§„í–‰ë©ë‹ˆë‹¤. ë…¼ë¬¸ì˜ Pipeline ìŠ¤ì¼€ì¤„ë§ ë°©ë²•(V-Half ë˜ëŠ” 1F1B)ì„ ì´ìš©í•˜ì—¬ ë°ì´í„°ë¥¼ ë³‘ë ¬ ì²˜ë¦¬í•©ë‹ˆë‹¤.</p><p>ì˜ˆì‹œ) 1F1B ê¸°ë°˜ í•™ìŠµ ì§„í–‰ ì˜ˆì‹œ:</p><ul><li>ê° deviceì—ì„œ forwardì™€ backward passê°€ ì—°ì†í•´ì„œ ì§„í–‰ë©ë‹ˆë‹¤.</li><li>Vocabulary Parallelismì´ ì ìš©ëœ í™˜ê²½ì—ì„œëŠ” ê° pass ì‚¬ì´ì— Vocabulary Layer ì—°ì‚°(<code>S</code>, <code>T</code> pass)ì„ ë°°ì¹˜í•˜ì—¬ ê³„ì‚° ë° ë©”ëª¨ë¦¬ ë°¸ëŸ°ìŠ¤ë¥¼ ì´ë£¹ë‹ˆë‹¤.</li></ul><div class="code-block-container border-border bg-card my-6 overflow-hidden rounded-xl border shadow-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:shadow-md"><div class="code-block-header bg-muted/30 border-border flex items-center justify-between border-b px-4 py-3"><div class="flex items-center gap-2"><div class="text-muted-foreground flex-shrink-0"><svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4 4 4-4 4M6 16l-4-4 4-4"/></svg></div><span class="text-muted-foreground text-sm font-medium">PLAINTEXT</span></div><div class="flex items-center gap-2"><button class="collapse-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-8 data-default-state=expanded data-collapsed=false data-auto-collapse-lines=30 data-auto-collapse-height=400 data-collapsed-height=120 title=ì ‘ê¸° aria-label=ì ‘ê¸°>
<span class=collapse-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41 12 10.83l4.59 4.58L18 14l-6-6-6 6z"/></svg>
</span><span class="collapse-text hidden sm:inline">ì ‘ê¸°</span>
</button>
<button class="copy-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-8 title=ë³µì‚¬ aria-label=ë³µì‚¬>
<span class=copy-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/></svg>
</span><span class="copy-text hidden sm:inline">ë³µì‚¬</span></button></div></div><div class="code-block-content relative" id=code-8><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=ln>1</span><span class=cl>[Device 1 ì˜ˆì‹œ ìŠ¤ì¼€ì¤„]
</span></span><span class=line><span class=ln>2</span><span class=cl>Microbatch #1 forward â†’ vocab ì—°ì‚° â†’ transformer ì—°ì‚° â†’ backward ì—°ì‚° â†’ ë‹¤ìŒ microbatch...</span></span></code></pre></div><div class="collapse-overlay to-card/90 pointer-events-none absolute inset-0 bg-gradient-to-b from-transparent via-transparent opacity-0 transition-opacity duration-300"><div class="text-muted-foreground bg-card/80 border-border/50 hover:bg-primary/10 hover:text-primary hover:border-primary/30 absolute bottom-4 left-1/2 -translate-x-1/2 cursor-pointer rounded-full border px-3 py-1.5 text-xs backdrop-blur-sm transition-all duration-200">í´ë¦­í•˜ì—¬ ë” ë³´ê¸°</div></div></div></div><script>(function(){const s="code-8",n=document.querySelector('.copy-code-btn[data-code-id="'+s+'"]'),t=document.querySelector('.collapse-code-btn[data-code-id="'+s+'"]'),e=document.getElementById(s);if(!e)return;if(n){const s=n.querySelector(".copy-icon"),t=n.querySelector(".copy-text");n.addEventListener("click",async function(){try{let o="";const i=e.querySelector(".lntd:last-child code");if(i)o=i.textContent||i.innerText;else{const t=e.querySelector("code");if(t){const e=t.querySelector(".ln");if(e){const e=t.querySelectorAll(".cl");if(e.length>0)o=Array.from(e).map(e=>{const t=e.textContent||e.innerText;return t.replace(/\n+$/,"")}).join(`
`).replace(/\n+$/,"");else{const e=t.textContent||t.innerText;o=e.replace(/^\d+/gm,"").replace(/^\s+/gm,"")}}else o=t.textContent||t.innerText}else o=e.textContent||e.innerText}o=o.trim(),await navigator.clipboard.writeText(o),s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
</svg>`,t&&(t.textContent="ë³µì‚¬ë¨"),n.classList.add("text-green-600"),setTimeout(()=>{s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
</svg>`,t&&(t.textContent="ë³µì‚¬"),n.classList.remove("text-green-600")},2e3)}catch(o){console.error("å¤åˆ¶å¤±è´¥:",o);const s=document.createRange(),i=e.querySelector("code")||e;s.selectNodeContents(i);const n=window.getSelection();n.removeAllRanges(),n.addRange(s),t&&(t.textContent="ì„ íƒë¨"),setTimeout(()=>{t&&(t.textContent="ë³µì‚¬"),n.removeAllRanges()},2e3)}})}if(t){const d=t.querySelector(".collapse-icon"),c=t.querySelector(".collapse-text"),n=e.querySelector(".collapse-overlay");let s=e.querySelector("pre.chroma");s||(s=e.querySelector("pre"));const m=t.dataset.defaultState||"expanded",f=t.dataset.collapsed==="true",u=parseInt(t.dataset.autoCollapseLines)||30,h=parseInt(t.dataset.autoCollapseHeight)||400,p=parseInt(t.dataset.collapsedHeight)||120;let l=!1;function i(){const e=f||m==="collapsed"||a();e&&o(!0,!1)}function a(){if(s){const e=s.querySelectorAll(".line, .cl"),t=s.offsetHeight;return e.length>u||t>h}const t=e.offsetHeight;if(t>h)return!0;const n=e.textContent||e.innerText||"",o=n.split(`
`).length;return o>u}function o(s,o=!0){if(!n)return;l=s,s?(e.style.maxHeight=p+"px",e.style.overflow="hidden",n.style.opacity="1",n.style.pointerEvents="auto",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
</svg>`,c&&(c.textContent="í¼ì¹˜ê¸°"),t.title="í¼ì¹˜ê¸°"):(e.style.maxHeight="",e.style.overflow="",n.style.opacity="0",n.style.pointerEvents="none",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z"/></svg>`,c&&(c.textContent="ì ‘ê¸°"),t.title="ì ‘ê¸°"),o&&(e.style.transition="max-height 0.3s ease-out",setTimeout(()=>{e.style.transition=""},300))}function r(){o(!l,!0)}t.addEventListener("click",r),n&&n.addEventListener("click",()=>{l&&o(!1,!0)}),i()}})()</script><hr><h3 id=--í•™ìŠµ-í‰ê°€-throughput-ë°-ë©”ëª¨ë¦¬-ê· í˜•ì„±-í™•ì¸>ğŸš© â‘£ í•™ìŠµ í‰ê°€ (Throughput ë° ë©”ëª¨ë¦¬ ê· í˜•ì„± í™•ì¸)</h3><p>ë…¼ë¬¸ì—ì„œ ì¤‘ì ì ìœ¼ë¡œ í‰ê°€í•œ ë‘ ê°€ì§€ ì§€í‘œë¥¼ ì¸¡ì •í•©ë‹ˆë‹¤.</p><ul><li><p><strong>Throughput (MFU, ëª¨ë¸ FLOPs Utilization) ì¸¡ì •</strong>:</p><ul><li>ì‹¤ì œ GPU ì‚¬ìš©ë¥ ì„ ì¸¡ì •í•˜ì—¬ ì—°ì‚°íš¨ìœ¨ì„± ê²€ì¦.</li><li>baseline ëŒ€ë¹„ ë…¼ë¬¸ ë°©ì‹ì˜ throughput ì¦ê°€ í™•ì¸ (5~51%)</li></ul></li><li><p><strong>Peak Memory ì‚¬ìš©ëŸ‰ ì¸¡ì •</strong>:</p><ul><li>ê° GPU ë³„ Peak Memory ì‚¬ìš©ëŸ‰ì„ ì¸¡ì •í•˜ì—¬ ë©”ëª¨ë¦¬ ê· í˜•ì„± í™•ì¸.</li><li>ë…¼ë¬¸ì˜ ë°©ì‹ì´ ë©”ëª¨ë¦¬ë¥¼ ì–¼ë§ˆë‚˜ ê· í˜• ìˆê²Œ ë°°ë¶„í–ˆëŠ”ì§€ í™•ì¸.</li></ul></li></ul><hr><h2 id=-í•µì‹¬-ì•Œê³ ë¦¬ì¦˜ì„-ìœ„í•œ-ìµœì¢…ì -ìš”ì•½-ì •ë¦¬-ì˜ˆì‹œ-ê¸°ë°˜>âœ… í•µì‹¬ ì•Œê³ ë¦¬ì¦˜ì„ ìœ„í•œ ìµœì¢…ì  ìš”ì•½ ì •ë¦¬ (ì˜ˆì‹œ ê¸°ë°˜)</h2><table><thead><tr><th>ë‹¨ê³„</th><th>ì‘ì—…</th><th>ì£¼ìš” íŠ¹ì§• ë° íš¨ê³¼</th></tr></thead><tbody><tr><td>ë°ì´í„° ì¤€ë¹„</td><td>ëŒ€ê·œëª¨ í…ìŠ¤íŠ¸ ë°ì´í„°ì…‹(C4, The Pile ë“±)</td><td>ë³‘ë ¬í™” ìµœì í™”ë¥¼ ìœ„í•´ í° vocab í•„ìˆ˜</td></tr><tr><td>ëª¨ë¸ ì„¤ì •</td><td>Transformer ê¸°ë°˜ ëª¨ë¸ êµ¬ì¶•</td><td>íŒŒë¼ë¯¸í„°ê°€ ë§ê³  ê¸´ Sequence lengthì¼ìˆ˜ë¡ íš¨ê³¼ì </td></tr><tr><td>ë³‘ë ¬í™” ë°©ì‹</td><td>Vocabulary Parallelism</td><td>Vocab Layer ë³‘ë ¬í™”í•˜ì—¬ PPì˜ ë‹¨ì ì„ í•´ê²°</td></tr><tr><td>í‰ê°€</td><td>Throughput, Peak Memory ì¸¡ì •</td><td>ë³‘ë ¬í™” íš¨ê³¼ì„± ê²€ì¦ (ë…¼ë¬¸ì—ì„œëŠ” ìµœëŒ€ 51% ì„±ëŠ¥ í–¥ìƒ ë‹¬ì„±)</td></tr></tbody></table><p>ìœ„ ê³¼ì •ì„ ê±°ì³ ë…¼ë¬¸ì˜ ë°©ë²•ì„ ì ìš©í•œ í•™ìŠµì„ íš¨ê³¼ì ìœ¼ë¡œ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p><h1 id=q--ì´-ë…¼ë¬¸ì—ì„œ-ì œì‹œí•œ-ê²°ê³¼ë¥¼-ìì„¸í•˜ê²Œ-ë³´ê³ -ë‹¤ë¥¸-ë°©ë²•ë¡ ì—-ë¹„í•˜ì—¬-íŠ¹ì¶œë‚œ-ì ê³¼-ë…¼ë¬¸ì—ì„œ-ì œê¸°í•˜ëŠ”-ì–´ë– í•œ-ë°©ë²•ì´-ì´ëŸ¬í•œ-ê²°ê³¼ë¥¼-ë„ì¶œí•˜ê²Œ-ë˜ì—ˆëŠ”ì§€-ë…¼ë¬¸ì—ì„œ-ì œì‹œí•˜ëŠ”-ì´ìœ ì™€-ë„ˆì˜-ìƒê°ì„-ì•Œë ¤ì¤˜>Q : ì´ ë…¼ë¬¸ì—ì„œ ì œì‹œí•œ ê²°ê³¼ë¥¼ ìì„¸í•˜ê²Œ ë³´ê³  ë‹¤ë¥¸ ë°©ë²•ë¡ ì— ë¹„í•˜ì—¬ íŠ¹ì¶œë‚œ ì ê³¼ ë…¼ë¬¸ì—ì„œ ì œê¸°í•˜ëŠ” ì–´ë– í•œ ë°©ë²•ì´ ì´ëŸ¬í•œ ê²°ê³¼ë¥¼ ë„ì¶œí•˜ê²Œ ë˜ì—ˆëŠ”ì§€ ë…¼ë¬¸ì—ì„œ ì œì‹œí•˜ëŠ” ì´ìœ ì™€ ë„ˆì˜ ìƒê°ì„ ì•Œë ¤ì¤˜</h1><p>ë‹¤ìŒì€ ë…¼ë¬¸ì—ì„œ ì œì‹œí•œ ê²°ê³¼ì˜ <strong>ì •ëŸ‰ì  ë¶„ì„</strong>ê³¼ <strong>ì´ ë…¼ë¬¸ì˜ ë°©ë²•ì´ ê°€ì§€ëŠ” ë…ì°½ì„±ê³¼ ê°•ì </strong>, ê·¸ë¦¬ê³  ì´ë¥¼ ë’·ë°›ì¹¨í•˜ëŠ” í•µì‹¬ ì´ìœ ë¥¼ ì••ì¶•ì ìœ¼ë¡œ ì •ë¦¬í•œ ê²ƒì…ë‹ˆë‹¤.</p><hr><h2 id=-ê²°ë¡ ë¶€í„°-ì••ì¶•ì ìœ¼ë¡œ-ì •ë¦¬í•˜ë©´>ğŸ“Œ ê²°ë¡ ë¶€í„° ì••ì¶•ì ìœ¼ë¡œ ì •ë¦¬í•˜ë©´:</h2><ul><li>ë…¼ë¬¸ì—ì„œ ì œì•ˆí•œ **Vocabulary Parallelism(VP)**ì€ Transformer ëª¨ë¸ í•™ìŠµì˜ íŒŒì´í”„ë¼ì¸ ë³‘ë ¬í™”(PP)ì—ì„œ ë°œìƒí•˜ëŠ” ì…ì¶œë ¥ Embedding ì¸µìœ¼ë¡œ ì¸í•œ <strong>ì—°ì‚°ê³¼ ë©”ëª¨ë¦¬ ë¶ˆê· í˜• ë¬¸ì œë¥¼ í•´ê²°</strong>í–ˆìŠµë‹ˆë‹¤.</li><li>ê¸°ì¡´ ë°©ì‹ ëŒ€ë¹„ <strong>Throughput(ì²˜ë¦¬ì†ë„)ê°€ ìµœëŒ€ 51% ì¦ê°€</strong>í•˜ê³ , <strong>Peak Memory</strong>ëŠ” í¬ê²Œ ê°ì†Œí•˜ì—¬ ëª¨ë¸ í•™ìŠµì˜ ì„±ëŠ¥ê³¼ íš¨ìœ¨ì„±ì„ í¬ê²Œ ë†’ì˜€ìŠµë‹ˆë‹¤.</li></ul><hr><h2 id=-ì‹¤í—˜-ê²°ê³¼-ì •ëŸ‰ì -ë¹„êµ-ë…¼ë¬¸-ì‹¤í—˜-ê²°ê³¼-ì¸ìš©>ğŸ“Œ ì‹¤í—˜ ê²°ê³¼ ì •ëŸ‰ì  ë¹„êµ (ë…¼ë¬¸ ì‹¤í—˜ ê²°ê³¼ ì¸ìš©)</h2><p>ë…¼ë¬¸ì˜ ì‹¤í—˜ ê²°ê³¼ë¥¼ ëª…í™•íˆ ë³´ì—¬ì£¼ëŠ” ëŒ€í‘œì  ì˜ˆì‹œ (ëª¨ë¸ ì•½ 21B, Sequence length 4096):</p><table><thead><tr><th>ë°©ë²•</th><th>Vocabulary Size</th><th>Throughput (MFU, %)</th><th>Peak Memory(GB)</th></tr></thead><tbody><tr><td>Baseline (ê¸°ì¡´ PP)</td><td>32K</td><td>52.80%</td><td>34.11GB</td></tr><tr><td>Baseline (ê¸°ì¡´ PP)</td><td>256K</td><td>19.99%</td><td>46.77GB</td></tr><tr><td><strong>Vocabulary Parallelism</strong></td><td>32K</td><td><strong>57.70% (ì•½ 9.3%â†‘)</strong></td><td>30.85GB (â†“3.26GB)</td></tr><tr><td><strong>Vocabulary Parallelism</strong></td><td>256K</td><td><strong>57.80%</strong> (143%â†‘)</td><td><strong>15.02GB (ì•½ 68% ê°ì†Œ)</strong></td></tr></tbody></table><p>ìœ„ í‘œì—ì„œ í™•ì¸í•  ìˆ˜ ìˆë“¯ì´, ë…¼ë¬¸ì˜ ë°©ë²•ì€ ì–´íœ˜(Vocab) í¬ê¸°ê°€ ì»¤ì§ˆìˆ˜ë¡ ì„±ëŠ¥ ê°œì„ í­ì´ ë§¤ìš° ë‘ë“œëŸ¬ì§‘ë‹ˆë‹¤.</p><hr><h2 id=-ë…¼ë¬¸ì˜-ë°©ë²•ì´-ê°€ì§€ëŠ”-ê°•ì ê³¼-ë…ì°½ì„±>ğŸ“Œ ë…¼ë¬¸ì˜ ë°©ë²•ì´ ê°€ì§€ëŠ” ê°•ì ê³¼ ë…ì°½ì„±</h2><p>ì´ ë…¼ë¬¸ì˜ ë…ì°½ì ì´ê³  íŠ¹ì¶œë‚œ ì ì€ <strong>ê¸°ì¡´ì˜ íŒŒì´í”„ë¼ì¸ ë³‘ë ¬í™” ë°©ì‹ì´ ê°€ì§€ê³  ìˆë˜ ì–´íœ˜ì¸µ(Vocabulary Layer)ì˜ ë¶ˆê· í˜• ë¬¸ì œë¥¼ íš¨ê³¼ì ìœ¼ë¡œ í•´ê²°í•œ ì </strong>ì…ë‹ˆë‹¤.</p><p>ë…¼ë¬¸ì˜ ì œì•ˆ ë°©ë²•ì€ í¬ê²Œ ë‹¤ìŒ ì„¸ ê°€ì§€ í•µì‹¬ ì „ëµì„ ì‚¬ìš©í–ˆìŠµë‹ˆë‹¤.</p><h3 id=-1-vocabulary-parallelismì„-í†µí•œ-ë¶ˆê· í˜•-í•´ì†Œ>ğŸ”¸ (1) Vocabulary Parallelismì„ í†µí•œ ë¶ˆê· í˜• í•´ì†Œ</h3><ul><li>ê¸°ì¡´ PPì—ì„œëŠ” <strong>ì²« ë²ˆì§¸ Deviceì— Input Layer</strong>, <strong>ë§ˆì§€ë§‰ Deviceì— Output Layer</strong>ê°€ ì§‘ì¤‘ì ìœ¼ë¡œ ìœ„ì¹˜í•˜ì—¬ ì‹¬ê°í•œ ì—°ì‚°ê³¼ ë©”ëª¨ë¦¬ ë¶ˆê· í˜•ì´ ìˆì—ˆìŠµë‹ˆë‹¤.</li><li>ë…¼ë¬¸ì€ ì–´íœ˜ ì¸µì„ ëª¨ë“  Pipeline Deviceì— <strong>ê· ë“±í•˜ê²Œ ë‚˜ëˆ  ë¶„ì‚°</strong>í•˜ì—¬ ê· í˜•ì„ ë§ì·„ìŠµë‹ˆë‹¤.</li></ul><table><thead><tr><th>ë°©ë²•</th><th>Memory ê· í˜• ì—¬ë¶€</th><th>Pipeline Bubble í˜„ìƒ</th></tr></thead><tbody><tr><td>ê¸°ì¡´ PP</td><td>ë¶ˆê· í˜• (ì²«/ë§ˆì§€ë§‰ Deviceì— í¸ì¤‘)</td><td>ì‹¬ê° (ë²„ë¸” í˜„ìƒ å¤š)</td></tr><tr><td>Vocabulary Parallelism</td><td>âœ… ê· í˜• ë‹¬ì„±</td><td>âœ… ìµœì†Œí™”</td></tr></tbody></table><hr><h2 id=-í•µì‹¬-ì•Œê³ ë¦¬ì¦˜ì˜-ì„±ëŠ¥-í–¥ìƒì„-ê°€ì ¸ì˜¨-ì£¼ìš”-ìµœì í™”-ê¸°ë²•-algorithm-2>ğŸ“Œ í•µì‹¬ ì•Œê³ ë¦¬ì¦˜ì˜ ì„±ëŠ¥ í–¥ìƒì„ ê°€ì ¸ì˜¨ ì£¼ìš” ìµœì í™” ê¸°ë²• (Algorithm 2)</h2><p>ë…¼ë¬¸ì—ì„œ ì œì‹œëœ ìµœì í™” ê¸°ë²•ì€ ë‹¤ìŒê³¼ ê°™ì€ íŠ¹ì§•ì„ ê°€ì§€ë©° ì„±ëŠ¥ ê°œì„ ì„ ì´ëŒì—ˆìŠµë‹ˆë‹¤.</p><ul><li><strong>Communication Barrier ìµœì†Œí™”</strong> (3íšŒ â†’ 1íšŒ)<ul><li>Forward, Backwardì—ì„œ Softmax ê³„ì‚°ì„ ìœ„í•œ ì „ì—­ All-Reduce ì—°ì‚°(Communication Barrier)ì„ ìµœì†Œí™”í•˜ì—¬ Activation Memory ì‚¬ìš©ëŸ‰ì„ ìµœì í™”í–ˆìŠµë‹ˆë‹¤.</li></ul></li><li><strong>Overlapping Communication & Computation</strong><ul><li>ê³„ì‚°ê³¼ ì „ì—­ í†µì‹ ì„ ì„œë¡œ ë‹¤ë¥¸ CUDA Streamì—ì„œ ìˆ˜í–‰í•˜ì—¬ ë³‘ëª©ì„ ìµœì†Œí™”í•˜ê³  GPU utilization ê·¹ëŒ€í™”í•˜ì˜€ìŠµë‹ˆë‹¤.</li></ul></li></ul><p><strong>ìµœì í™” ê¸°ë²•ì˜ ì˜ˆì‹œì  ìš”ì•½ (ë‹¨ì¼ Microbatch ì˜ˆì‹œ):</strong></p><table><thead><tr><th>ë‹¨ê³„</th><th>ê¸°ì¡´ ë°©ì‹</th><th>Algorithm 2 ìµœì í™” ë°©ì‹</th></tr></thead><tbody><tr><td>Forward ì—°ì‚°</td><td>ë¡œì»¬ Logits â†’ AllReduce 2íšŒ</td><td>ë¡œì»¬ ê³„ì‚° í›„, All-Reduce ìµœì†Œí™”(1íšŒ)</td></tr><tr><td>Backward ì—°ì‚°</td><td>í†µì‹  ë°°ë¦¬ì–´ê°€ 2íšŒ ì¶”ê°€ ë°œìƒ</td><td>ë¯¸ë¦¬ ì¤‘ê°„ê°’ ê³„ì‚° í›„ 1íšŒë¡œ ìµœì†Œí™”</td></tr></tbody></table><p>â†’ ê²°ê³¼ì ìœ¼ë¡œ ì—°ì‚°, ë©”ëª¨ë¦¬, í†µì‹  ëª¨ë“  ì¸¡ë©´ì—ì„œ ìµœì ì˜ íš¨ìœ¨ì„±ì„ ë‹¬ì„±í•˜ì˜€ìŠµë‹ˆë‹¤.</p><hr><h2 id=-ë…¼ë¬¸ì˜-ë…ì°½ì -ë°©ë²•ì˜-ì„±ëŠ¥-ìš°ìœ„-ì´ìœ -ë¶„ì„-í•µì‹¬-ê·¼ê±°>ğŸ“Œ ë…¼ë¬¸ì˜ ë…ì°½ì  ë°©ë²•ì˜ ì„±ëŠ¥ ìš°ìœ„ ì´ìœ  ë¶„ì„ (í•µì‹¬ ê·¼ê±°)</h2><p>ë…¼ë¬¸ì—ì„œ ì œì•ˆí•œ ë°©ì‹ì´ ìš°ìˆ˜í•œ ì´ìœ ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:</p><ol><li><p><strong>ê· í˜•í™”ëœ ì—°ì‚°ê³¼ ë©”ëª¨ë¦¬ ë¶€í•˜</strong></p><ul><li>ëª¨ë“  Deviceê°€ ì—°ì‚°ëŸ‰ì„ ê³ ë¥´ê²Œ ë¶„ë‹´í•´, ê¸°ì¡´ ë³‘ë ¬í™” ë°©ë²•(1F1B, V-Half)ë³´ë‹¤ Pipeline bubble ìµœì†Œí™”</li><li>ì‹¤ì œ ë…¼ë¬¸ì—ì„œ <strong>Pipeline bubbleë¡œ ì¸í•œ GPU ìœ íœ´ìœ¨(idle)ì„ 11% ì´ìƒ ê°ì†Œ</strong>ì‹œí‚¤ëŠ” ê²°ê³¼ ì œì‹œ.</li></ul></li><li><p><strong>íš¨ìœ¨ì ì¸ Activation Memory ê´€ë¦¬</strong></p><ul><li>ê¸°ì¡´ ë°©ì‹ì€ synchronous barrierë¡œ ì¸í•´ Peak activation memoryê°€ ìµœëŒ€ 1.5ë°° ì¦ê°€í–ˆë˜ ë¬¸ì œë¥¼ Vocabulary parallelism ê¸°ë²•ì„ í†µí•´ ì†Œí­ì˜ ì¦ê°€(ìµœëŒ€ microbatch 1~2ê°œ ìˆ˜ì¤€)ë¡œ ìµœì†Œí™”ì‹œí‚´.</li></ul></li><li><p><strong>Generalized Scheduling Integration</strong></p><ul><li>ê¸°ì¡´ì˜ Pipeline Schedule êµ¬ì¡°(1F1B, V-Half)ë¥¼ ë³€í˜• ì—†ì´ ë°”ë¡œ í™œìš© ê°€ëŠ¥í•˜ì—¬, ì‰½ê²Œ ê¸°ì¡´ í™˜ê²½ì— ì ìš© ê°€ëŠ¥í•˜ê³ , <strong>ë²”ìš©ì„±ì´ ë†’ìŒ</strong>.</li></ul></li></ol><hr><h2 id=-ê·¸ëŸ¬ë‚˜-ì¡´ì¬í•˜ëŠ”-í•œê³„ì ê³¼-ê°œì„ -í•„ìš”ì„±>ğŸ“Œ ê·¸ëŸ¬ë‚˜ ì¡´ì¬í•˜ëŠ” í•œê³„ì ê³¼ ê°œì„  í•„ìš”ì„±</h2><ul><li><strong>ì¶”ê°€ì ì¸ Communication Overhead ë°œìƒ</strong><ul><li>AllReduceë¥¼ í”¼í•  ìˆ˜ ì—†ìœ¼ë©°, GPU ìˆ˜ê°€ ì¦ê°€í• ìˆ˜ë¡ Overheadê°€ ë¹„ì„ í˜•ì ìœ¼ë¡œ ì¦ê°€ (8â†’32 GPUë¡œ ì¦ê°€ ì‹œ, íš¨ìœ¨ì„± ì•½ 91% â†’ 75%ë¡œ í•˜ë½).</li></ul></li><li><strong>Input Layer ë³‘ë ¬í™” í•œê³„ì </strong><ul><li>Input Layerì˜ ë³‘ë ¬í™” íš¨ìœ¨ì„±ì´ ë‚®ì•„(ìµœëŒ€ 8.35%ë¡œ íš¨ìœ¨ í•˜ë½), ì¶”ê°€ì ì¸ ê°œì„  í•„ìš”.</li></ul></li><li><strong>Activation Memory ì¦ê°€ì˜ ì—¬ì§€ ì¡´ì¬</strong><ul><li>Activation Memoryê°€ ë‹¤ì†Œ ì¦ê°€í•˜ëŠ” ë‹¨ì (ìµœëŒ€ Microbatch 2ê°œë§Œí¼ ì¦ê°€)ì´ ìˆì§€ë§Œ, ì „ì²´ ë©”ëª¨ë¦¬ ê· í˜• ì¸¡ë©´ì—ì„œëŠ” ê°œì„ ë¨.</li></ul></li></ul><hr><h2 id=-ìµœì¢…-ì •ë¦¬-ë…¼ë¬¸ì˜-ê¸°ìˆ ì -ìš°ìˆ˜ì„±-ìš”ì•½>ğŸ” ìµœì¢… ì •ë¦¬: ë…¼ë¬¸ì˜ ê¸°ìˆ ì  ìš°ìˆ˜ì„± ìš”ì•½</h2><table><thead><tr><th>í‰ê°€ ê¸°ì¤€</th><th>Vocabulary Parallelism</th><th>ê¸°ì¡´ ë°©ë²•(Baseline PP)</th><th>ë¹„ê³ </th></tr></thead><tbody><tr><td>ì„±ëŠ¥ í–¥ìƒ</td><td>ìµœëŒ€ <strong>51% í–¥ìƒ</strong></td><td>ê¸°ì¤€ì </td><td>í° ì„±ëŠ¥ ìš°ìœ„</td></tr><tr><td>Pipeline Bubble ê°ì†Œ</td><td>ìµœì†Œí™”(11% idle â†“)</td><td>ë†’ìŒ</td><td>ëª…í™•í•œ ì¥ì </td></tr><tr><td>Activation Memory ê· í˜•ì„±</td><td>ì™„ë²½ ê· í˜•ì— ê°€ê¹Œì›€</td><td>ë¶ˆê· í˜• ì‹¬ê°</td><td>í° ê°œì„ </td></tr><tr><td>Communication Overhead</td><td>ì¡´ì¬ (AllReduce í•„ìˆ˜)</td><td>ì ìŒ</td><td>ë‹¨ì  (ê°œì„  í•„ìš”)</td></tr></tbody></table><hr><h2 id=-ìµœì¢…-ê²°ë¡ ê³¼-ë…ì°½ì„±ì˜-í•µì‹¬-ì´ìœ >ğŸ¯ ìµœì¢… ê²°ë¡ ê³¼ ë…ì°½ì„±ì˜ í•µì‹¬ ì´ìœ </h2><p>ì´ ë…¼ë¬¸ì´ ë†’ì€ ì„±ëŠ¥ì„ ë‹¬ì„±í•œ ê°€ì¥ ë³¸ì§ˆì  ì´ìœ ëŠ”:</p><blockquote class="border-primary bg-muted/30 hover:bg-muted/40 my-6 rounded-r-lg border-l-4 py-4 pr-4 pl-6 italic transition-all duration-200 ease-out hover:translate-x-1"><div class="prose prose-sm max-w-none"><p>&ldquo;<strong>ì—°ì‚° ë° ë©”ëª¨ë¦¬ì˜ ë¶ˆê· í˜• ë¬¸ì œë¥¼ íš¨ê³¼ì ìœ¼ë¡œ í•´ê²°í•˜ê³ , Communication barrierë¥¼ ìµœì†Œí™”í•˜ì—¬ GPU utilizationì„ ìµœì í™”í–ˆê¸° ë•Œë¬¸</strong>&ldquo;ì…ë‹ˆë‹¤.</p></div></blockquote><p>ì¦‰, ê¸°ì¡´ PPì˜ ëª…í™•í•œ ë¬¸ì œì ì„ ì •í™•íˆ ì¸ì§€í•˜ê³ , ê·¼ë³¸ì ì´ê³  ì²´ê³„ì ì¸ ìµœì í™” ê¸°ë²•ìœ¼ë¡œ ë¬¸ì œë¥¼ í•´ê²°í•œ ì ì´ ì„±ëŠ¥ í–¥ìƒì˜ ì£¼ëœ ì´ìœ ì´ë©°, ì´ëŠ” ì‹¤í—˜ì ìœ¼ë¡œ ëª…í™•íˆ ì¦ëª…ë˜ì—ˆìŠµë‹ˆë‹¤.</p><hr><h2 id=-ì¶”ê°€-ì—°êµ¬-ë°-ê°œì„ -ê°€ëŠ¥ì„±>ğŸ“Œ ì¶”ê°€ ì—°êµ¬ ë° ê°œì„  ê°€ëŠ¥ì„±</h2><p>ì•ìœ¼ë¡œ ì¶”ê°€ ì—°êµ¬ ê³¼ì œëŠ”:</p><ul><li>Input Layer ë³‘ë ¬í™” íš¨ìœ¨ ê°œì„ </li><li>ë‹¤ì¤‘ GPU í™˜ê²½ì—ì„œ ì¶”ê°€ì ì¸ communication overheadì˜ ë” ì„¸ë¶€ì ì¸ ìµœì í™”</li><li>Multimodal Modelì´ë‚˜ ì´ˆì¥ê¸° context modelì— í™•ì¥ ì ìš©</li></ul><p>ë“±ì´ ë  ê²ƒì…ë‹ˆë‹¤.</p><p>ê²°ë¡ ì ìœ¼ë¡œ, ì´ ë…¼ë¬¸ì˜ ì œì•ˆ ë°©ì‹ì€ í˜„ì¡´ Pipeline ë³‘ë ¬í™”ì˜ ë¬¸ì œë¥¼ ì°½ì˜ì ìœ¼ë¡œ í•´ê²°í•œ <strong>íš¨ìœ¨ì ì´ê³  ë…ì°½ì ì¸ ì ‘ê·¼ë²•</strong>ì´ë¼ê³  í‰ê°€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p><h1 id=q--ì´-ë…¼ë¬¸ì—ì„œ-ì œì‹œëœ-ë°©ë²•ì„-ì‹¤ì œë¡œ-ì‚¬ìš©í•˜ë ¤ë©´-ê¸°ì¡´-ë°©ë²•ì—ì„œ-ì–´ë– í•œ-êµ¬í˜„ì´-ì¶”ê°€ì ìœ¼ë¡œ-í•„ìš”í•˜ê³ -ì´ëŸ¬í•œ-êµ¬í˜„ì—-ì†Œëª¨ë˜ëŠ”-ê³µìˆ˜-ë°-ì—°ì‚°ì—-í•„ìš”í•œ-ì»´í“¨íŒ…-ìì›ì˜-í¬ê¸°ì—-ëŒ€í•´ì„œ-ê³„ì‚°í•´ì¤„-ìˆ˜-ìˆê² ë‹ˆ>Q : ì´ ë…¼ë¬¸ì—ì„œ ì œì‹œëœ ë°©ë²•ì„ ì‹¤ì œë¡œ ì‚¬ìš©í•˜ë ¤ë©´ ê¸°ì¡´ ë°©ë²•ì—ì„œ ì–´ë– í•œ êµ¬í˜„ì´ ì¶”ê°€ì ìœ¼ë¡œ í•„ìš”í•˜ê³  ì´ëŸ¬í•œ êµ¬í˜„ì— ì†Œëª¨ë˜ëŠ” ê³µìˆ˜ ë° ì—°ì‚°ì— í•„ìš”í•œ ì»´í“¨íŒ… ìì›ì˜ í¬ê¸°ì— ëŒ€í•´ì„œ ê³„ì‚°í•´ì¤„ ìˆ˜ ìˆê² ë‹ˆ?</h1><p>ë‹¤ìŒì€ ë…¼ë¬¸ì˜ ë°©ë²•(<strong>Vocabulary Parallelism</strong>)ì„ ì‹¤ì œë¡œ êµ¬í˜„í•  ë•Œ ì¶”ê°€ë¡œ í•„ìš”í•œ êµ¬í˜„ ì‘ì—…ì„ <strong>êµ¬ì²´ì ìœ¼ë¡œ ì„¤ëª…</strong>í•˜ê³ , ì´ë•Œ ë°œìƒí•˜ëŠ” **ì¶”ê°€ì  ë¹„ìš©(êµ¬í˜„ ë° ìì›)**ì„ ì •ëŸ‰ì Â·ì •ì„±ì ìœ¼ë¡œ ìƒì„¸íˆ ë¶„ì„í•œ ë‚´ìš©ì…ë‹ˆë‹¤.</p><hr><h1 id=-ê²°ë¡ -ìš”ì•½-ì¶”ê°€-êµ¬í˜„--ë¹„ìš©>ğŸ“Œ ê²°ë¡  ìš”ì•½ (ì¶”ê°€ êµ¬í˜„ & ë¹„ìš©)</h1><table><thead><tr><th>êµ¬í˜„ ì¶”ê°€ ì‘ì—…</th><th>ë‚œì´ë„(ìƒì¤‘í•˜)</th><th>ë¹„ìš© ë° ì˜í–¥ ìš”ì•½</th></tr></thead><tbody><tr><td>Vocabulary Partitioning êµ¬í˜„</td><td>ì¤‘ê°„</td><td>GPU ì—°ì‚° íš¨ìœ¨ ì¼ë¶€ ì €í•˜(ì•½ 8~20%)</td></tr><tr><td>All-Reduce ìµœì í™” (CUDA & NCCL ì‚¬ìš©)</td><td>ì¤‘ê°„~ë†’ìŒ</td><td>GPU ê°„ í†µì‹  ì¶”ê°€ (ì•½ 11% ì‹œê°„ ì˜¤ë²„í—¤ë“œ ë°œìƒ ê°€ëŠ¥)</td></tr><tr><td>CUDA Stream ë³‘ë ¬í™”(Overlap êµ¬í˜„)</td><td>ë†’ìŒ</td><td>êµ¬í˜„ ë‚œì´ë„ ë†’ìŒ (ì—”ì§€ë‹ˆì–´ë§ ë³µì¡ì„± ì¦ê°€)</td></tr><tr><td>Activation ë©”ëª¨ë¦¬ ê´€ë¦¬ ê¸°ë²• ì¶”ê°€ êµ¬í˜„</td><td>ì¤‘ê°„</td><td>Peak Activation Memory ì¦ê°€ (ìµœëŒ€ Microbatch 2ê°œë¶„ëŸ‰ ì¶”ê°€)</td></tr></tbody></table><hr><h2 id=1-êµ¬í˜„-ë‹¨ê³„ë³„-í•„ìˆ˜-ì‘ì—…-ë°-ë‚œì´ë„-ì •ë¦¬>1ï¸âƒ£ êµ¬í˜„ ë‹¨ê³„ë³„ í•„ìˆ˜ ì‘ì—… ë° ë‚œì´ë„ ì •ë¦¬</h2><table><thead><tr><th>êµ¬í˜„ ë‹¨ê³„</th><th>êµ¬ì²´ì  ë‚´ìš©</th><th>ë‚œì´ë„</th></tr></thead><tbody><tr><td><strong>Vocabulary ë¶„í•  êµ¬í˜„</strong></td><td>Input/Output Embedding ì¸µì„ ëª¨ë“  ë””ë°”ì´ìŠ¤ì— ë¶„ì‚° êµ¬í˜„</td><td>ì¤‘</td></tr><tr><td><strong>All-Reduce ìµœì í™”</strong></td><td>NCCL ê¸°ë°˜ All-Reduce í†µì‹  êµ¬í˜„ ë° Overlapping ìµœì í™”</td><td>ì¤‘~ìƒ</td></tr><tr><td><strong>CUDA stream í™œìš©í•œ ë³‘ë ¬í™”</strong></td><td>í†µì‹ ê³¼ ì—°ì‚°ì˜ ë³‘ë ¬í™”, GPU ì‘ì—… í ê´€ë¦¬</td><td>ë†’ìŒ</td></tr><tr><td><strong>Scheduling</strong></td><td>Pipeline Parallel schedulingì„ Vocabulary Parallelismê³¼ í†µí•©</td><td>ì¤‘</td></tr></tbody></table><ul><li>ì „ì²´ì ìœ¼ë¡œ ë†’ì€ ìˆ˜ì¤€ì˜ ë”¥ëŸ¬ë‹ê³¼ GPU ë³‘ë ¬í™” ì§€ì‹ì´ ìš”êµ¬ë©ë‹ˆë‹¤.</li></ul><hr><h2 id=-ì¶”ê°€ì ìœ¼ë¡œ-ìš”êµ¬ë˜ëŠ”-ë¹„ìš©-ì •ëŸ‰ì -ë¶„ì„>ğŸ“Œ ì¶”ê°€ì ìœ¼ë¡œ ìš”êµ¬ë˜ëŠ” ë¹„ìš© ì •ëŸ‰ì  ë¶„ì„</h2><h3 id=--ì¶”ê°€-êµ¬í˜„-ë¹„ìš©-computational-cost>âœ… â‘  ì¶”ê°€ êµ¬í˜„ ë¹„ìš© (Computational Cost)</h3><p>ë…¼ë¬¸ì˜ Vocabulary Parallelismì„ êµ¬í˜„ ì‹œ ë‹¤ìŒê³¼ ê°™ì€ ì¶”ê°€ì ì¸ ì—°ì‚° ë¹„ìš©ì´ ë°œìƒí•©ë‹ˆë‹¤.</p><ul><li><strong>Vocabulary Layer ì—°ì‚°ì„ ë³‘ë ¬í™”í•˜ë©´ Kernel íš¨ìœ¨ì„± ì €í•˜</strong> (FLOPs í™œìš©ë¥  ê°ì†Œ)</li><li>ë…¼ë¬¸ì˜ ì‹¤í—˜ìƒì—ì„œ ì¸¡ì •ëœ ì—°ì‚° íš¨ìœ¨ì„±(FLOPs Utilization, MFU)ì˜ ê°ì†ŒëŠ” ë‹¤ìŒê³¼ ê°™ìŒ:</li></ul><table><thead><tr><th>GPU ìˆ˜</th><th>Layer</th><th>Linear ëŒ€ë¹„ Throughput íš¨ìœ¨</th></tr></thead><tbody><tr><td>8 GPUs</td><td>Output Layer</td><td>86.72~91.29%</td></tr><tr><td>16 GPUs</td><td>Output Layer</td><td>79.84~88.02%</td></tr><tr><td>32 GPUs</td><td>Output Layer</td><td>75.93~85.24%</td></tr><tr><td>32 GPUs</td><td>Input Layer</td><td><strong>8.35~15.18%ë¡œ ë§¤ìš° ì €í•˜</strong></td></tr></tbody></table><ul><li>Output LayerëŠ” ê±°ì˜ ì„ í˜• í™•ì¥ì— ê°€ê¹Œìš°ë‚˜, Input LayerëŠ” ë³‘ë ¬í™” íš¨ìœ¨ì´ ë§¤ìš° ë–¨ì–´ì§‘ë‹ˆë‹¤.</li><li>ë”°ë¼ì„œ Input Layerì˜ ì¶”ê°€ì ì¸ íš¨ìœ¨ ê°œì„ ì´ í•„ìš”í•©ë‹ˆë‹¤.</li></ul><hr><h3 id=--í†µì‹ -ë¹„ìš©-communication-overhead>âœ… â‘¡ í†µì‹  ë¹„ìš© (Communication Overhead)</h3><ul><li>ë…¼ë¬¸ì˜ ë°©ì‹ì€ ìµœì†Œ 1~2íšŒ ì „ì—­ í†µì‹ (All-Reduce)ì„ ì¶”ê°€ë¡œ ìˆ˜í–‰í•©ë‹ˆë‹¤.</li><li>ì‹¤í—˜ì ìœ¼ë¡œ ì „ì—­ í†µì‹ ì€ ì „ì²´ í•™ìŠµ ì‹œê°„ì˜ ì•½ 11% ì •ë„ì˜ ì˜¤ë²„í—¤ë“œë¥¼ ìœ ë°œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li></ul><table><thead><tr><th>ì¶”ê°€ Communication</th><th>Overhead (End-to-End training time ì¦ê°€ìœ¨)</th></tr></thead><tbody><tr><td>All-Reduce (forward ë° backward í†µí•©)</td><td>ì•½ 11%</td></tr></tbody></table><ul><li>íŠ¹íˆ multi-node í™˜ê²½ì—ì„œëŠ” ë” ë‘ë“œëŸ¬ì§€ê²Œ ë‚˜íƒ€ë‚  ìˆ˜ ìˆìœ¼ë©°, ì´ ë¹„ìš©ì€ GPU í´ëŸ¬ìŠ¤í„° í™˜ê²½(ì˜ˆ: InfiniBand/RoCE ë„¤íŠ¸ì›Œí¬)ì— ë”°ë¼ ë‹¬ë¼ì§‘ë‹ˆë‹¤.</li></ul><hr><h3 id=--ì¶”ê°€-activation-memory-ë¹„ìš©>âœ… â‘¢ ì¶”ê°€ Activation Memory ë¹„ìš©</h3><ul><li>ë…¼ë¬¸ì—ì„œ ìµœì í™” ì•Œê³ ë¦¬ì¦˜ 2ëŠ” Activation Memory ì¦ê°€ë¥¼ ìµœëŒ€ microbatch 2ê°œ ë¶„ëŸ‰ìœ¼ë¡œ ì œí•œí•©ë‹ˆë‹¤.</li><li>ê¸°ì¡´ 1F1B ëŒ€ë¹„ Activation MemoryëŠ” ìµœëŒ€ 2 microbatch ì¶”ê°€ ìš”êµ¬ë©ë‹ˆë‹¤.</li></ul><table><thead><tr><th>ì•Œê³ ë¦¬ì¦˜</th><th>ì¶”ê°€ Activation Memory (Microbatch ìˆ˜ ê¸°ì¤€)</th></tr></thead><tbody><tr><td>ê¸°ì¡´ PP</td><td>ê¸°ì¤€ (0 ì¶”ê°€ ë©”ëª¨ë¦¬)</td></tr><tr><td>Interlaced (TPë°©ì‹ ë³‘ë ¬í™”)</td><td>ê¸°ì¡´ ëŒ€ë¹„ 1.5ë°°</td></tr><tr><td><strong>Vocabulary Parallelism</strong></td><td>ê¸°ì¡´ ëŒ€ë¹„ microbatch 1~2ê°œ ì¶”ê°€</td></tr></tbody></table><hr><h2 id=-ì‹¤ì œ-í•™ìŠµ-ì˜ˆì‹œë¥¼-í†µí•œ-ë¹„ìš©-ì˜ˆì¸¡>ğŸ“Œ ì‹¤ì œ í•™ìŠµ ì˜ˆì‹œë¥¼ í†µí•œ ë¹„ìš© ì˜ˆì¸¡</h2><p>ì˜ˆì‹œ) 32ê°œì˜ A100 GPUë¥¼ ì‚¬ìš©í•˜ì—¬ ì•½ 21B GPT ëª¨ë¸ í•™ìŠµ</p><p>| í•­ëª© | ê¸°ì¡´ PP (baseline) | Vocabulary Parallelism | ì¶”ê°€ë¹„ìš© |
| &mdash;&mdash;&mdash;&mdash;&mdash;&mdash; | &mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&ndash; | &mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&ndash; |
| GPU ìˆ˜ | 32 GPUs | 32 GPUs | ë™ì¼ |
| Peak Memory(GPUë‹¹) | 73GB (Baseline, 256K Vocab) | 49GB (<strong>34% ë©”ëª¨ë¦¬ ì ˆì•½</strong>) |
| Throughput(MFU%) | 21.63% (Baseline, 256K Vocab) | 57.80% (<strong>167% ì„±ëŠ¥ ì¦ê°€</strong>) |
| Activation Memory | Baseline (1F1B) | ìµœëŒ€ microbatch 1~2 ì¶”ê°€ (~ìˆ˜ GB ì´ë‚´) |</p><p>ì¦‰, ì „ì²´ì ì¸ GPU ì‚¬ìš© ë¹„ìš© ë° ì—°ì‚° ì„±ëŠ¥ ê°œì„ ìœ¼ë¡œ ì¸í•´, ì¶”ê°€ì ì¸ ì—°ì‚° ë° í†µì‹  overheadê°€ ìˆë”ë¼ë„ ì „ì²´ì ìœ¼ë¡œ í° ì´ë“ì„ ì–»ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p><hr><h2 id=-ì •ë¦¬-ë°-ìµœì¢…ì ì¸-ì¡°ì–¸>ğŸ“Œ ì •ë¦¬ ë° ìµœì¢…ì ì¸ ì¡°ì–¸</h2><table><thead><tr><th>ì¶”ê°€ ìš”ì†Œ</th><th>ë¹„ìš© ìˆ˜ì¤€</th><th>ê°œì„  ê°€ëŠ¥ì„±</th></tr></thead><tbody><tr><td>êµ¬í˜„ ë‚œì´ë„</td><td>ì¤‘~ë†’ìŒ</td><td>âœ… ì»¤ë®¤ë‹ˆí‹° ì½”ë“œ(GitHub ê³µê°œ)ë¥¼ í™œìš©í•´ ë‚®ì¶œ ìˆ˜ ìˆìŒ</td></tr><tr><td>GPU íš¨ìœ¨ì„± ì €í•˜</td><td>ì‘ìŒ (ì•½ 10~20%)</td><td>âœ… CUDA Kernel ìµœì í™”ë¡œ ê°œì„  ê°€ëŠ¥</td></tr><tr><td>í†µì‹  ë¹„ìš©</td><td>ì¤‘ê°„ (ìµœëŒ€ 11%)</td><td>âœ… í†µì‹  ê³ ë„í™”(NCCL íŠœë‹, GPUDirect RDMA)ë¡œ ìµœì†Œí™” ê°€ëŠ¥</td></tr><tr><td>ë©”ëª¨ë¦¬ ì¦ê°€</td><td>ë‚®ìŒ</td><td>âœ… microbatch scheduling ê°œì„ ìœ¼ë¡œ ì¶”ê°€ ì ˆê° ê°€ëŠ¥</td></tr></tbody></table><p>ì´ëŸ¬í•œ ì¶”ê°€ ë¹„ìš©ì€ ë…¼ë¬¸ì˜ ë°©ë²•ì´ ê°€ì§€ëŠ” <strong>51%ì˜ Throughput ì„±ëŠ¥ ê°œì„ </strong>ê³¼ <strong>ë©”ëª¨ë¦¬ì˜ ê· í˜•ì  ë¶„ì‚° íš¨ê³¼</strong>ë¼ëŠ” í° ì´ë“ì„ ê³ ë ¤í•˜ë©´ ì¶©ë¶„íˆ ìƒì‡„ ê°€ëŠ¥í•œ ìˆ˜ì¤€ì…ë‹ˆë‹¤.</p><p>ì¶”í›„ êµ¬í˜„í•  ë•ŒëŠ” ë‹¤ìŒì„ ê³ ë ¤í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:</p><ul><li><strong>ì´ë¯¸ ê³µê°œëœ GitHub ì½”ë“œ</strong>ë¥¼ ì ê·¹ í™œìš©(<a href=https://github.com/sail-sg/VocabularyParallelism>VocabularyParallelism Github</a>)</li><li>Input Layer ë³‘ë ¬í™”ë¥¼ ë” íš¨ìœ¨ì ìœ¼ë¡œ ê°œì„ í•˜ì—¬ ì¶”ê°€ì ì¸ ì„±ëŠ¥ í–¥ìƒ</li><li>GPUê°„ í†µì‹ ì„ ìœ„í•œ RDMA ë° NCCL ìµœì í™”ë¡œ ì¶”ê°€ Overhead ìµœì†Œí™”</li></ul><p>ìµœì¢…ì ìœ¼ë¡œ, ì´ ë…¼ë¬¸ì˜ ë°©ë²•ì€ ì¶”ê°€ ë¹„ìš© ëŒ€ë¹„ ë§¤ìš° ê°€ì¹˜ ìˆëŠ” ì ‘ê·¼ë²•ì´ë¼ê³  ê²°ë¡ ì§€ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p><h1 id=q--ì´-ë…¼ë¬¸ì˜-ì…ë ¥ë°ì´í„°ì™€-ì¶”ë¡ -ê³¼ì •ì—-ëŒ€í•´ì„œ-ì˜ˆì‹œë¥¼-ë“¤ì–´-ì•„ì£¼-ìì„¸í•˜ê²Œ-ì„¤ëª…í•´-ì£¼ê² ë‹ˆ-ì¶”ê°€ì ìœ¼ë¡œ-ëª¨ë¸ì•„í‚¤í…ì²˜ì˜-êµ¬ì„±-ë°-ëª¨ë¸ì„-êµ¬ì„±í•˜ëŠ”-ì—°ì‚°ê³¼-ë©”ëª¨ë¦¬-ìš”êµ¬ëŸ‰-ì»´í“¨íŒ…-ìš”êµ¬ëŸ‰-ëŒ€í•´ì„œë„-ì„¤ëª…í•´ì¤˜>Q : ì´ ë…¼ë¬¸ì˜ ì…ë ¥ë°ì´í„°ì™€ ì¶”ë¡  ê³¼ì •ì— ëŒ€í•´ì„œ ì˜ˆì‹œë¥¼ ë“¤ì–´ ì•„ì£¼ ìì„¸í•˜ê²Œ ì„¤ëª…í•´ ì£¼ê² ë‹ˆ? ì¶”ê°€ì ìœ¼ë¡œ ëª¨ë¸ì•„í‚¤í…ì²˜ì˜ êµ¬ì„± ë° ëª¨ë¸ì„ êµ¬ì„±í•˜ëŠ” ì—°ì‚°ê³¼ ë©”ëª¨ë¦¬ ìš”êµ¬ëŸ‰ ì»´í“¨íŒ… ìš”êµ¬ëŸ‰ ëŒ€í•´ì„œë„ ì„¤ëª…í•´ì¤˜</h1><p>ë‹¤ìŒì€ ë…¼ë¬¸ì˜ ë°©ë²•(<strong>Vocabulary Parallelism</strong>)ì—ì„œ ì‚¬ìš©ë˜ëŠ” <strong>ì…ë ¥ ë°ì´í„°ì˜ í˜•ì‹ê³¼ ì˜ˆì‹œ</strong>, ê·¸ë¦¬ê³  êµ¬ì²´ì ì¸ <strong>ëª¨ë¸ êµ¬ì¡° ë° í•™ìŠµ ê³¼ì •</strong>ì„ ë§¤ìš° ìƒì„¸í•˜ê²Œ ì„¤ëª…í•©ë‹ˆë‹¤.</p><hr><h1 id=-1-ì…ë ¥-ë°ì´í„°-í˜•ì‹-ë°-ì˜ˆì‹œ>ğŸ”‘ 1. ì…ë ¥ ë°ì´í„° í˜•ì‹ ë° ì˜ˆì‹œ</h1><p>ë³¸ ë…¼ë¬¸ì˜ ë°©ë²•ì€ <strong>Transformer ê¸°ë°˜ì˜ ëŒ€ê·œëª¨ ì–¸ì–´ëª¨ë¸(LLM)</strong> ì„ í•™ìŠµí•˜ê±°ë‚˜ fine-tuningí•  ë•Œ ì‚¬ìš©ë©ë‹ˆë‹¤. ë”°ë¼ì„œ ì…ë ¥ ë°ì´í„°ëŠ” ì¼ë°˜ì ì¸ ì–¸ì–´ëª¨ë¸ ë°ì´í„° í˜•ì‹ê³¼ ê°™ìŠµë‹ˆë‹¤.</p><h3 id=-ì˜ˆì‹œ-ì…ë ¥-ë°ì´í„°>âœ… ì˜ˆì‹œ ì…ë ¥ ë°ì´í„°:</h3><div class="code-block-container border-border bg-card my-6 overflow-hidden rounded-xl border shadow-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:shadow-md"><div class="code-block-header bg-muted/30 border-border flex items-center justify-between border-b px-4 py-3"><div class="flex items-center gap-2"><div class="text-muted-foreground flex-shrink-0"><svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4 4 4-4 4M6 16l-4-4 4-4"/></svg></div><span class="text-muted-foreground text-sm font-medium">PLAINTEXT</span></div><div class="flex items-center gap-2"><button class="collapse-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-9 data-default-state=expanded data-collapsed=false data-auto-collapse-lines=30 data-auto-collapse-height=400 data-collapsed-height=120 title=ì ‘ê¸° aria-label=ì ‘ê¸°>
<span class=collapse-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41 12 10.83l4.59 4.58L18 14l-6-6-6 6z"/></svg>
</span><span class="collapse-text hidden sm:inline">ì ‘ê¸°</span>
</button>
<button class="copy-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-9 title=ë³µì‚¬ aria-label=ë³µì‚¬>
<span class=copy-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/></svg>
</span><span class="copy-text hidden sm:inline">ë³µì‚¬</span></button></div></div><div class="code-block-content relative" id=code-9><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=ln> 1</span><span class=cl>í…ìŠ¤íŠ¸ ë¬¸ì¥ : &#34;Pipeline parallelism optimizes training speed.&#34;
</span></span><span class=line><span class=ln> 2</span><span class=cl>â†“ í† í°í™” í›„ (BPE í˜¹ì€ SentencePiece ë°©ì‹, vocab size ì˜ˆì‹œ: 32K)
</span></span><span class=line><span class=ln> 3</span><span class=cl>Token IDs : [112, 532, 8423, 1305, 88, 245]
</span></span><span class=line><span class=ln> 4</span><span class=cl>
</span></span><span class=line><span class=ln> 5</span><span class=cl>Batch ë°ì´í„° í˜•íƒœ ì˜ˆì‹œ (Sequence Length = 8, Batch size = 2):
</span></span><span class=line><span class=ln> 6</span><span class=cl>Input Batch:
</span></span><span class=line><span class=ln> 7</span><span class=cl>[
</span></span><span class=line><span class=ln> 8</span><span class=cl>  [112, 532, 8423, 1305, 88, 245, 0, 0],  # Padding ì ìš©
</span></span><span class=line><span class=ln> 9</span><span class=cl>  [102, 4021, 23, 43, 255, 765, 122, 3]
</span></span><span class=line><span class=ln>10</span><span class=cl>]</span></span></code></pre></div><div class="collapse-overlay to-card/90 pointer-events-none absolute inset-0 bg-gradient-to-b from-transparent via-transparent opacity-0 transition-opacity duration-300"><div class="text-muted-foreground bg-card/80 border-border/50 hover:bg-primary/10 hover:text-primary hover:border-primary/30 absolute bottom-4 left-1/2 -translate-x-1/2 cursor-pointer rounded-full border px-3 py-1.5 text-xs backdrop-blur-sm transition-all duration-200">í´ë¦­í•˜ì—¬ ë” ë³´ê¸°</div></div></div></div><script>(function(){const s="code-9",n=document.querySelector('.copy-code-btn[data-code-id="'+s+'"]'),t=document.querySelector('.collapse-code-btn[data-code-id="'+s+'"]'),e=document.getElementById(s);if(!e)return;if(n){const s=n.querySelector(".copy-icon"),t=n.querySelector(".copy-text");n.addEventListener("click",async function(){try{let o="";const i=e.querySelector(".lntd:last-child code");if(i)o=i.textContent||i.innerText;else{const t=e.querySelector("code");if(t){const e=t.querySelector(".ln");if(e){const e=t.querySelectorAll(".cl");if(e.length>0)o=Array.from(e).map(e=>{const t=e.textContent||e.innerText;return t.replace(/\n+$/,"")}).join(`
`).replace(/\n+$/,"");else{const e=t.textContent||t.innerText;o=e.replace(/^\d+/gm,"").replace(/^\s+/gm,"")}}else o=t.textContent||t.innerText}else o=e.textContent||e.innerText}o=o.trim(),await navigator.clipboard.writeText(o),s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
</svg>`,t&&(t.textContent="ë³µì‚¬ë¨"),n.classList.add("text-green-600"),setTimeout(()=>{s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
</svg>`,t&&(t.textContent="ë³µì‚¬"),n.classList.remove("text-green-600")},2e3)}catch(o){console.error("å¤åˆ¶å¤±è´¥:",o);const s=document.createRange(),i=e.querySelector("code")||e;s.selectNodeContents(i);const n=window.getSelection();n.removeAllRanges(),n.addRange(s),t&&(t.textContent="ì„ íƒë¨"),setTimeout(()=>{t&&(t.textContent="ë³µì‚¬"),n.removeAllRanges()},2e3)}})}if(t){const d=t.querySelector(".collapse-icon"),c=t.querySelector(".collapse-text"),n=e.querySelector(".collapse-overlay");let s=e.querySelector("pre.chroma");s||(s=e.querySelector("pre"));const m=t.dataset.defaultState||"expanded",f=t.dataset.collapsed==="true",u=parseInt(t.dataset.autoCollapseLines)||30,h=parseInt(t.dataset.autoCollapseHeight)||400,p=parseInt(t.dataset.collapsedHeight)||120;let l=!1;function i(){const e=f||m==="collapsed"||a();e&&o(!0,!1)}function a(){if(s){const e=s.querySelectorAll(".line, .cl"),t=s.offsetHeight;return e.length>u||t>h}const t=e.offsetHeight;if(t>h)return!0;const n=e.textContent||e.innerText||"",o=n.split(`
`).length;return o>u}function o(s,o=!0){if(!n)return;l=s,s?(e.style.maxHeight=p+"px",e.style.overflow="hidden",n.style.opacity="1",n.style.pointerEvents="auto",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
</svg>`,c&&(c.textContent="í¼ì¹˜ê¸°"),t.title="í¼ì¹˜ê¸°"):(e.style.maxHeight="",e.style.overflow="",n.style.opacity="0",n.style.pointerEvents="none",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z"/></svg>`,c&&(c.textContent="ì ‘ê¸°"),t.title="ì ‘ê¸°"),o&&(e.style.transition="max-height 0.3s ease-out",setTimeout(()=>{e.style.transition=""},300))}function r(){o(!l,!0)}t.addEventListener("click",r),n&&n.addEventListener("click",()=>{l&&o(!1,!0)}),i()}})()</script><ul><li>ì‹¤ì œ ì‚¬ìš© ì‹œ ìˆ˜ë°±~ìˆ˜ì²œì–µ ê°œ ì´ìƒì˜ í† í° ë°ì´í„°ì…‹ì„ ì´ìš©í•´ ëŒ€ê·œëª¨ ë³‘ë ¬ ì²˜ë¦¬ë¥¼ ìˆ˜í–‰í•©ë‹ˆë‹¤.</li></ul><hr><h1 id=-2-ëª¨ë¸-ì•„í‚¤í…ì²˜-êµ¬ì„±-ë°-íŒŒë¼ë¯¸í„°-ì„¤ì •-ì˜ˆì‹œ>ğŸ”‘ 2. ëª¨ë¸ ì•„í‚¤í…ì²˜ êµ¬ì„± ë° íŒŒë¼ë¯¸í„° ì„¤ì • ì˜ˆì‹œ</h1><p>ë…¼ë¬¸ì—ì„œ ì‹¤í—˜í•œ êµ¬ì²´ì  ëª¨ë¸ êµ¬ì„±ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:</p><table><thead><tr><th>í•­ëª©</th><th>ë…¼ë¬¸ì—ì„œ ì œì•ˆëœ ì‹¤í—˜ ì˜ˆì‹œ ê°’</th></tr></thead><tbody><tr><td>Model Size</td><td>ì•½ 4B ~ 30B</td></tr><tr><td>Pipeline Devices ìˆ˜</td><td>8, 16, 32</td></tr><tr><td>Transformer Layers ìˆ˜</td><td>32 ~ 64</td></tr><tr><td>Hidden Dimension</td><td>4096~6144</td></tr><tr><td>Attention Heads ìˆ˜</td><td>32~48</td></tr><tr><td>Sequence ê¸¸ì´</td><td>2048~4096</td></tr><tr><td>Vocabulary Size</td><td>32K, 64K, 128K, 256K</td></tr></tbody></table><hr><h1 id=-3-í•µì‹¬-ì•Œê³ ë¦¬ì¦˜-vocabulary-parallelism-í•™ìŠµ-ê³¼ì •ì˜-ë‹¨ê³„ë³„-ì˜ˆì‹œ-ìƒì„¸-ì„¤ëª…>ğŸ”‘ 3. í•µì‹¬ ì•Œê³ ë¦¬ì¦˜ (Vocabulary Parallelism) í•™ìŠµ ê³¼ì •ì˜ ë‹¨ê³„ë³„ ì˜ˆì‹œ ìƒì„¸ ì„¤ëª…</h1><p>Vocabulary Parallelismì€ ì…ë ¥ê³¼ ì¶œë ¥ ë ˆì´ì–´ë¥¼ ëª¨ë“  Pipeline Deviceë¡œ ë‚˜ëˆ„ì–´ ì—°ì‚°ì„ ë³‘ë ¬í™”í•©ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, Pipeline Device 4ê°œë¡œ êµ¬ì„±ëœ ëª¨ë¸ì—ì„œ Output Layer ë³‘ë ¬í™”ì˜ ì˜ˆì‹œë¥¼ ë“¤ì–´ ì„¤ëª…í•˜ë©´ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.</p><h3 id=-ì˜ˆì‹œ-ëª¨ë¸-í™˜ê²½-ì„¤ì •>ğŸš© ì˜ˆì‹œ ëª¨ë¸ í™˜ê²½ ì„¤ì •</h3><ul><li>Pipeline Device ìˆ˜: 4ê°œ (Device 0,1,2,3)</li><li>Vocabulary í¬ê¸°: 8ê°œ (í¸ì˜ìƒ ê°„ì†Œí™”, ì‹¤ì œëŠ” ìˆ˜ë§Œ~ìˆ˜ì‹­ë§Œê°œ)</li><li>Hidden size: 4, Sequence Length: 1, Batch size: 1 (ë§ˆì´í¬ë¡œë°°ì¹˜ ë‹¨ìœ„ ì—°ì‚°)</li></ul><h4 id=-ì˜ˆì‹œ-ì…ë ¥-ë°-embedding-weight-êµ¬ì„±>ğŸ”¸ ì˜ˆì‹œ ì…ë ¥ ë° Embedding Weight êµ¬ì„±</h4><div class="code-block-container border-border bg-card my-6 overflow-hidden rounded-xl border shadow-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:shadow-md"><div class="code-block-header bg-muted/30 border-border flex items-center justify-between border-b px-4 py-3"><div class="flex items-center gap-2"><div class="text-muted-foreground flex-shrink-0"><svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4 4 4-4 4M6 16l-4-4 4-4"/></svg></div><span class="text-muted-foreground text-sm font-medium">PLAINTEXT</span></div><div class="flex items-center gap-2"><button class="collapse-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-10 data-default-state=expanded data-collapsed=false data-auto-collapse-lines=30 data-auto-collapse-height=400 data-collapsed-height=120 title=ì ‘ê¸° aria-label=ì ‘ê¸°>
<span class=collapse-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41 12 10.83l4.59 4.58L18 14l-6-6-6 6z"/></svg>
</span><span class="collapse-text hidden sm:inline">ì ‘ê¸°</span>
</button>
<button class="copy-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-10 title=ë³µì‚¬ aria-label=ë³µì‚¬>
<span class=copy-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/></svg>
</span><span class="copy-text hidden sm:inline">ë³µì‚¬</span></button></div></div><div class="code-block-content relative" id=code-10><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=ln>1</span><span class=cl>ë§ˆì§€ë§‰ Transformer Layerì˜ ì¶œë ¥ X:
</span></span><span class=line><span class=ln>2</span><span class=cl>X = [[0.1, 0.2, 0.3, 0.4]]   (shape: [1,4])
</span></span><span class=line><span class=ln>3</span><span class=cl>
</span></span><span class=line><span class=ln>4</span><span class=cl>Embedding Weight(W) (4ê°œ ë””ë°”ì´ìŠ¤ë¡œ ë¶„í• , ê° ë””ë°”ì´ìŠ¤ë§ˆë‹¤ 2ê°œì˜ ë‹¨ì–´ Embedding ë³´ìœ )
</span></span><span class=line><span class=ln>5</span><span class=cl>Device 0: W[0:2,:], Device 1: W[2:4,:], Device 2: W[4:6,:], Device 3: W[6:8,:]</span></span></code></pre></div><div class="collapse-overlay to-card/90 pointer-events-none absolute inset-0 bg-gradient-to-b from-transparent via-transparent opacity-0 transition-opacity duration-300"><div class="text-muted-foreground bg-card/80 border-border/50 hover:bg-primary/10 hover:text-primary hover:border-primary/30 absolute bottom-4 left-1/2 -translate-x-1/2 cursor-pointer rounded-full border px-3 py-1.5 text-xs backdrop-blur-sm transition-all duration-200">í´ë¦­í•˜ì—¬ ë” ë³´ê¸°</div></div></div></div><script>(function(){const s="code-10",n=document.querySelector('.copy-code-btn[data-code-id="'+s+'"]'),t=document.querySelector('.collapse-code-btn[data-code-id="'+s+'"]'),e=document.getElementById(s);if(!e)return;if(n){const s=n.querySelector(".copy-icon"),t=n.querySelector(".copy-text");n.addEventListener("click",async function(){try{let o="";const i=e.querySelector(".lntd:last-child code");if(i)o=i.textContent||i.innerText;else{const t=e.querySelector("code");if(t){const e=t.querySelector(".ln");if(e){const e=t.querySelectorAll(".cl");if(e.length>0)o=Array.from(e).map(e=>{const t=e.textContent||e.innerText;return t.replace(/\n+$/,"")}).join(`
`).replace(/\n+$/,"");else{const e=t.textContent||t.innerText;o=e.replace(/^\d+/gm,"").replace(/^\s+/gm,"")}}else o=t.textContent||t.innerText}else o=e.textContent||e.innerText}o=o.trim(),await navigator.clipboard.writeText(o),s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
</svg>`,t&&(t.textContent="ë³µì‚¬ë¨"),n.classList.add("text-green-600"),setTimeout(()=>{s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
</svg>`,t&&(t.textContent="ë³µì‚¬"),n.classList.remove("text-green-600")},2e3)}catch(o){console.error("å¤åˆ¶å¤±è´¥:",o);const s=document.createRange(),i=e.querySelector("code")||e;s.selectNodeContents(i);const n=window.getSelection();n.removeAllRanges(),n.addRange(s),t&&(t.textContent="ì„ íƒë¨"),setTimeout(()=>{t&&(t.textContent="ë³µì‚¬"),n.removeAllRanges()},2e3)}})}if(t){const d=t.querySelector(".collapse-icon"),c=t.querySelector(".collapse-text"),n=e.querySelector(".collapse-overlay");let s=e.querySelector("pre.chroma");s||(s=e.querySelector("pre"));const m=t.dataset.defaultState||"expanded",f=t.dataset.collapsed==="true",u=parseInt(t.dataset.autoCollapseLines)||30,h=parseInt(t.dataset.autoCollapseHeight)||400,p=parseInt(t.dataset.collapsedHeight)||120;let l=!1;function i(){const e=f||m==="collapsed"||a();e&&o(!0,!1)}function a(){if(s){const e=s.querySelectorAll(".line, .cl"),t=s.offsetHeight;return e.length>u||t>h}const t=e.offsetHeight;if(t>h)return!0;const n=e.textContent||e.innerText||"",o=n.split(`
`).length;return o>u}function o(s,o=!0){if(!n)return;l=s,s?(e.style.maxHeight=p+"px",e.style.overflow="hidden",n.style.opacity="1",n.style.pointerEvents="auto",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
</svg>`,c&&(c.textContent="í¼ì¹˜ê¸°"),t.title="í¼ì¹˜ê¸°"):(e.style.maxHeight="",e.style.overflow="",n.style.opacity="0",n.style.pointerEvents="none",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z"/></svg>`,c&&(c.textContent="ì ‘ê¸°"),t.title="ì ‘ê¸°"),o&&(e.style.transition="max-height 0.3s ease-out",setTimeout(()=>{e.style.transition=""},300))}function r(){o(!l,!0)}t.addEventListener("click",r),n&&n.addEventListener("click",()=>{l&&o(!1,!0)}),i()}})()</script><hr><h1 id=-4-ì „ì²´ì ì¸-í•™ìŠµforward--backward-ê³¼ì •-ì˜ˆì‹œ>ğŸ”‘ 4. ì „ì²´ì ì¸ í•™ìŠµ(Forward â†’ Backward) ê³¼ì • ì˜ˆì‹œ</h1><h2 id=-forward-ë‹¨ê³„>â–¶ï¸ Forward ë‹¨ê³„</h2><h3 id=1-logits-y-ê³„ì‚°-ê°-ë””ë°”ì´ìŠ¤-ë…ë¦½ì -ìˆ˜í–‰>(1) Logits (Y) ê³„ì‚° (ê° ë””ë°”ì´ìŠ¤ ë…ë¦½ì  ìˆ˜í–‰)</h3><ul><li>ê° Deviceì—ì„œ ìì‹ ì˜ Vocab partitionì— ëŒ€í•´:
[
Y = X W^T
]</li></ul><p>ì˜ˆì‹œ:</p><div class="code-block-container border-border bg-card my-6 overflow-hidden rounded-xl border shadow-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:shadow-md"><div class="code-block-header bg-muted/30 border-border flex items-center justify-between border-b px-4 py-3"><div class="flex items-center gap-2"><div class="text-muted-foreground flex-shrink-0"><svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4 4 4-4 4M6 16l-4-4 4-4"/></svg></div><span class="text-muted-foreground text-sm font-medium">PLAINTEXT</span></div><div class="flex items-center gap-2"><button class="collapse-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-11 data-default-state=expanded data-collapsed=false data-auto-collapse-lines=30 data-auto-collapse-height=400 data-collapsed-height=120 title=ì ‘ê¸° aria-label=ì ‘ê¸°>
<span class=collapse-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41 12 10.83l4.59 4.58L18 14l-6-6-6 6z"/></svg>
</span><span class="collapse-text hidden sm:inline">ì ‘ê¸°</span>
</button>
<button class="copy-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-11 title=ë³µì‚¬ aria-label=ë³µì‚¬>
<span class=copy-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/></svg>
</span><span class="copy-text hidden sm:inline">ë³µì‚¬</span></button></div></div><div class="code-block-content relative" id=code-11><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=ln>1</span><span class=cl>Device 0:
</span></span><span class=line><span class=ln>2</span><span class=cl>X = [0.1,0.2,0.3,0.4]
</span></span><span class=line><span class=ln>3</span><span class=cl>W(Device 0) = [[0.1, 0.0, 0.2, 0.1],
</span></span><span class=line><span class=ln>4</span><span class=cl>               [0.0, 0.2, 0.4, 0.1]]
</span></span><span class=line><span class=ln>5</span><span class=cl>
</span></span><span class=line><span class=ln>6</span><span class=cl>Y_Device0 = X W_Device0^T
</span></span><span class=line><span class=ln>7</span><span class=cl>          = [[0.1Ã—0.1+0.2Ã—0+0.3Ã—0.2+0.4Ã—0.1, ...]]
</span></span><span class=line><span class=ln>8</span><span class=cl>          = [[0.1, 0.18]] (ì˜ˆì‹œê°’)</span></span></code></pre></div><div class="collapse-overlay to-card/90 pointer-events-none absolute inset-0 bg-gradient-to-b from-transparent via-transparent opacity-0 transition-opacity duration-300"><div class="text-muted-foreground bg-card/80 border-border/50 hover:bg-primary/10 hover:text-primary hover:border-primary/30 absolute bottom-4 left-1/2 -translate-x-1/2 cursor-pointer rounded-full border px-3 py-1.5 text-xs backdrop-blur-sm transition-all duration-200">í´ë¦­í•˜ì—¬ ë” ë³´ê¸°</div></div></div></div><script>(function(){const s="code-11",n=document.querySelector('.copy-code-btn[data-code-id="'+s+'"]'),t=document.querySelector('.collapse-code-btn[data-code-id="'+s+'"]'),e=document.getElementById(s);if(!e)return;if(n){const s=n.querySelector(".copy-icon"),t=n.querySelector(".copy-text");n.addEventListener("click",async function(){try{let o="";const i=e.querySelector(".lntd:last-child code");if(i)o=i.textContent||i.innerText;else{const t=e.querySelector("code");if(t){const e=t.querySelector(".ln");if(e){const e=t.querySelectorAll(".cl");if(e.length>0)o=Array.from(e).map(e=>{const t=e.textContent||e.innerText;return t.replace(/\n+$/,"")}).join(`
`).replace(/\n+$/,"");else{const e=t.textContent||t.innerText;o=e.replace(/^\d+/gm,"").replace(/^\s+/gm,"")}}else o=t.textContent||t.innerText}else o=e.textContent||e.innerText}o=o.trim(),await navigator.clipboard.writeText(o),s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
</svg>`,t&&(t.textContent="ë³µì‚¬ë¨"),n.classList.add("text-green-600"),setTimeout(()=>{s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
</svg>`,t&&(t.textContent="ë³µì‚¬"),n.classList.remove("text-green-600")},2e3)}catch(o){console.error("å¤åˆ¶å¤±è´¥:",o);const s=document.createRange(),i=e.querySelector("code")||e;s.selectNodeContents(i);const n=window.getSelection();n.removeAllRanges(),n.addRange(s),t&&(t.textContent="ì„ íƒë¨"),setTimeout(()=>{t&&(t.textContent="ë³µì‚¬"),n.removeAllRanges()},2e3)}})}if(t){const d=t.querySelector(".collapse-icon"),c=t.querySelector(".collapse-text"),n=e.querySelector(".collapse-overlay");let s=e.querySelector("pre.chroma");s||(s=e.querySelector("pre"));const m=t.dataset.defaultState||"expanded",f=t.dataset.collapsed==="true",u=parseInt(t.dataset.autoCollapseLines)||30,h=parseInt(t.dataset.autoCollapseHeight)||400,p=parseInt(t.dataset.collapsedHeight)||120;let l=!1;function i(){const e=f||m==="collapsed"||a();e&&o(!0,!1)}function a(){if(s){const e=s.querySelectorAll(".line, .cl"),t=s.offsetHeight;return e.length>u||t>h}const t=e.offsetHeight;if(t>h)return!0;const n=e.textContent||e.innerText||"",o=n.split(`
`).length;return o>u}function o(s,o=!0){if(!n)return;l=s,s?(e.style.maxHeight=p+"px",e.style.overflow="hidden",n.style.opacity="1",n.style.pointerEvents="auto",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
</svg>`,c&&(c.textContent="í¼ì¹˜ê¸°"),t.title="í¼ì¹˜ê¸°"):(e.style.maxHeight="",e.style.overflow="",n.style.opacity="0",n.style.pointerEvents="none",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z"/></svg>`,c&&(c.textContent="ì ‘ê¸°"),t.title="ì ‘ê¸°"),o&&(e.style.transition="max-height 0.3s ease-out",setTimeout(()=>{e.style.transition=""},300))}function r(){o(!l,!0)}t.addEventListener("click",r),n&&n.addEventListener("click",()=>{l&&o(!1,!0)}),i()}})()</script><p>(ë‹¤ë¥¸ ë””ë°”ì´ìŠ¤ë„ ê°ê° ê³„ì‚° ìˆ˜í–‰)</p><h3 id=2-local-ìµœëŒ€ê°’ê³¼-í•©-ê³„ì‚°-ë°-local-softmax-ê³„ì‚°>(2) Local ìµœëŒ€ê°’ê³¼ í•© ê³„ì‚° ë° Local Softmax ê³„ì‚°</h3><div class="code-block-container border-border bg-card my-6 overflow-hidden rounded-xl border shadow-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:shadow-md"><div class="code-block-header bg-muted/30 border-border flex items-center justify-between border-b px-4 py-3"><div class="flex items-center gap-2"><div class="text-muted-foreground flex-shrink-0"><svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4 4 4-4 4M6 16l-4-4 4-4"/></svg></div><span class="text-muted-foreground text-sm font-medium">PLAINTEXT</span></div><div class="flex items-center gap-2"><button class="collapse-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-12 data-default-state=expanded data-collapsed=false data-auto-collapse-lines=30 data-auto-collapse-height=400 data-collapsed-height=120 title=ì ‘ê¸° aria-label=ì ‘ê¸°>
<span class=collapse-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41 12 10.83l4.59 4.58L18 14l-6-6-6 6z"/></svg>
</span><span class="collapse-text hidden sm:inline">ì ‘ê¸°</span>
</button>
<button class="copy-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-12 title=ë³µì‚¬ aria-label=ë³µì‚¬>
<span class=copy-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/></svg>
</span><span class="copy-text hidden sm:inline">ë³µì‚¬</span></button></div></div><div class="code-block-content relative" id=code-12><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=ln>1</span><span class=cl>m&#39; = max(Y_Device0) = 0.18
</span></span><span class=line><span class=ln>2</span><span class=cl>sum&#39; = exp(0.1-0.18)+exp(0.18-0.18)=1.923 (ì˜ˆì‹œ)
</span></span><span class=line><span class=ln>3</span><span class=cl>Local Softmax_Device0 = [0.48, 0.52] (ì„ì‹œ ê°’)</span></span></code></pre></div><div class="collapse-overlay to-card/90 pointer-events-none absolute inset-0 bg-gradient-to-b from-transparent via-transparent opacity-0 transition-opacity duration-300"><div class="text-muted-foreground bg-card/80 border-border/50 hover:bg-primary/10 hover:text-primary hover:border-primary/30 absolute bottom-4 left-1/2 -translate-x-1/2 cursor-pointer rounded-full border px-3 py-1.5 text-xs backdrop-blur-sm transition-all duration-200">í´ë¦­í•˜ì—¬ ë” ë³´ê¸°</div></div></div></div><script>(function(){const s="code-12",n=document.querySelector('.copy-code-btn[data-code-id="'+s+'"]'),t=document.querySelector('.collapse-code-btn[data-code-id="'+s+'"]'),e=document.getElementById(s);if(!e)return;if(n){const s=n.querySelector(".copy-icon"),t=n.querySelector(".copy-text");n.addEventListener("click",async function(){try{let o="";const i=e.querySelector(".lntd:last-child code");if(i)o=i.textContent||i.innerText;else{const t=e.querySelector("code");if(t){const e=t.querySelector(".ln");if(e){const e=t.querySelectorAll(".cl");if(e.length>0)o=Array.from(e).map(e=>{const t=e.textContent||e.innerText;return t.replace(/\n+$/,"")}).join(`
`).replace(/\n+$/,"");else{const e=t.textContent||t.innerText;o=e.replace(/^\d+/gm,"").replace(/^\s+/gm,"")}}else o=t.textContent||t.innerText}else o=e.textContent||e.innerText}o=o.trim(),await navigator.clipboard.writeText(o),s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
</svg>`,t&&(t.textContent="ë³µì‚¬ë¨"),n.classList.add("text-green-600"),setTimeout(()=>{s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
</svg>`,t&&(t.textContent="ë³µì‚¬"),n.classList.remove("text-green-600")},2e3)}catch(o){console.error("å¤åˆ¶å¤±è´¥:",o);const s=document.createRange(),i=e.querySelector("code")||e;s.selectNodeContents(i);const n=window.getSelection();n.removeAllRanges(),n.addRange(s),t&&(t.textContent="ì„ íƒë¨"),setTimeout(()=>{t&&(t.textContent="ë³µì‚¬"),n.removeAllRanges()},2e3)}})}if(t){const d=t.querySelector(".collapse-icon"),c=t.querySelector(".collapse-text"),n=e.querySelector(".collapse-overlay");let s=e.querySelector("pre.chroma");s||(s=e.querySelector("pre"));const m=t.dataset.defaultState||"expanded",f=t.dataset.collapsed==="true",u=parseInt(t.dataset.autoCollapseLines)||30,h=parseInt(t.dataset.autoCollapseHeight)||400,p=parseInt(t.dataset.collapsedHeight)||120;let l=!1;function i(){const e=f||m==="collapsed"||a();e&&o(!0,!1)}function a(){if(s){const e=s.querySelectorAll(".line, .cl"),t=s.offsetHeight;return e.length>u||t>h}const t=e.offsetHeight;if(t>h)return!0;const n=e.textContent||e.innerText||"",o=n.split(`
`).length;return o>u}function o(s,o=!0){if(!n)return;l=s,s?(e.style.maxHeight=p+"px",e.style.overflow="hidden",n.style.opacity="1",n.style.pointerEvents="auto",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
</svg>`,c&&(c.textContent="í¼ì¹˜ê¸°"),t.title="í¼ì¹˜ê¸°"):(e.style.maxHeight="",e.style.overflow="",n.style.opacity="0",n.style.pointerEvents="none",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z"/></svg>`,c&&(c.textContent="ì ‘ê¸°"),t.title="ì ‘ê¸°"),o&&(e.style.transition="max-height 0.3s ease-out",setTimeout(()=>{e.style.transition=""},300))}function r(){o(!l,!0)}t.addEventListener("click",r),n&&n.addEventListener("click",()=>{l&&o(!1,!0)}),i()}})()</script><h3 id=3-global-all-reduceë¥¼-í†µí•´-ê¸€ë¡œë²Œ-softmax-ê³„ì‚°>(3) Global All-Reduceë¥¼ í†µí•´ ê¸€ë¡œë²Œ softmax ê³„ì‚°</h3><ul><li>ëª¨ë“  Deviceê°€ ì°¸ì—¬í•˜ì—¬ All-Reduceë¡œ ì „ì—­ ìµœëŒ€ê°’(m), í•©(sum) ê³„ì‚°</li><li>ì „ì—­ softmax ê³„ì‚°:</li></ul><div class="code-block-container border-border bg-card my-6 overflow-hidden rounded-xl border shadow-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:shadow-md"><div class="code-block-header bg-muted/30 border-border flex items-center justify-between border-b px-4 py-3"><div class="flex items-center gap-2"><div class="text-muted-foreground flex-shrink-0"><svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4 4 4-4 4M6 16l-4-4 4-4"/></svg></div><span class="text-muted-foreground text-sm font-medium">PLAINTEXT</span></div><div class="flex items-center gap-2"><button class="collapse-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-13 data-default-state=expanded data-collapsed=false data-auto-collapse-lines=30 data-auto-collapse-height=400 data-collapsed-height=120 title=ì ‘ê¸° aria-label=ì ‘ê¸°>
<span class=collapse-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41 12 10.83l4.59 4.58L18 14l-6-6-6 6z"/></svg>
</span><span class="collapse-text hidden sm:inline">ì ‘ê¸°</span>
</button>
<button class="copy-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-13 title=ë³µì‚¬ aria-label=ë³µì‚¬>
<span class=copy-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/></svg>
</span><span class="copy-text hidden sm:inline">ë³µì‚¬</span></button></div></div><div class="code-block-content relative" id=code-13><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=ln>1</span><span class=cl>softmax_global = Local_softmax Ã— (sum&#39;Ã—exp(m&#39;-m))/sum</span></span></code></pre></div><div class="collapse-overlay to-card/90 pointer-events-none absolute inset-0 bg-gradient-to-b from-transparent via-transparent opacity-0 transition-opacity duration-300"><div class="text-muted-foreground bg-card/80 border-border/50 hover:bg-primary/10 hover:text-primary hover:border-primary/30 absolute bottom-4 left-1/2 -translate-x-1/2 cursor-pointer rounded-full border px-3 py-1.5 text-xs backdrop-blur-sm transition-all duration-200">í´ë¦­í•˜ì—¬ ë” ë³´ê¸°</div></div></div></div><script>(function(){const s="code-13",n=document.querySelector('.copy-code-btn[data-code-id="'+s+'"]'),t=document.querySelector('.collapse-code-btn[data-code-id="'+s+'"]'),e=document.getElementById(s);if(!e)return;if(n){const s=n.querySelector(".copy-icon"),t=n.querySelector(".copy-text");n.addEventListener("click",async function(){try{let o="";const i=e.querySelector(".lntd:last-child code");if(i)o=i.textContent||i.innerText;else{const t=e.querySelector("code");if(t){const e=t.querySelector(".ln");if(e){const e=t.querySelectorAll(".cl");if(e.length>0)o=Array.from(e).map(e=>{const t=e.textContent||e.innerText;return t.replace(/\n+$/,"")}).join(`
`).replace(/\n+$/,"");else{const e=t.textContent||t.innerText;o=e.replace(/^\d+/gm,"").replace(/^\s+/gm,"")}}else o=t.textContent||t.innerText}else o=e.textContent||e.innerText}o=o.trim(),await navigator.clipboard.writeText(o),s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
</svg>`,t&&(t.textContent="ë³µì‚¬ë¨"),n.classList.add("text-green-600"),setTimeout(()=>{s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
</svg>`,t&&(t.textContent="ë³µì‚¬"),n.classList.remove("text-green-600")},2e3)}catch(o){console.error("å¤åˆ¶å¤±è´¥:",o);const s=document.createRange(),i=e.querySelector("code")||e;s.selectNodeContents(i);const n=window.getSelection();n.removeAllRanges(),n.addRange(s),t&&(t.textContent="ì„ íƒë¨"),setTimeout(()=>{t&&(t.textContent="ë³µì‚¬"),n.removeAllRanges()},2e3)}})}if(t){const d=t.querySelector(".collapse-icon"),c=t.querySelector(".collapse-text"),n=e.querySelector(".collapse-overlay");let s=e.querySelector("pre.chroma");s||(s=e.querySelector("pre"));const m=t.dataset.defaultState||"expanded",f=t.dataset.collapsed==="true",u=parseInt(t.dataset.autoCollapseLines)||30,h=parseInt(t.dataset.autoCollapseHeight)||400,p=parseInt(t.dataset.collapsedHeight)||120;let l=!1;function i(){const e=f||m==="collapsed"||a();e&&o(!0,!1)}function a(){if(s){const e=s.querySelectorAll(".line, .cl"),t=s.offsetHeight;return e.length>u||t>h}const t=e.offsetHeight;if(t>h)return!0;const n=e.textContent||e.innerText||"",o=n.split(`
`).length;return o>u}function o(s,o=!0){if(!n)return;l=s,s?(e.style.maxHeight=p+"px",e.style.overflow="hidden",n.style.opacity="1",n.style.pointerEvents="auto",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
</svg>`,c&&(c.textContent="í¼ì¹˜ê¸°"),t.title="í¼ì¹˜ê¸°"):(e.style.maxHeight="",e.style.overflow="",n.style.opacity="0",n.style.pointerEvents="none",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z"/></svg>`,c&&(c.textContent="ì ‘ê¸°"),t.title="ì ‘ê¸°"),o&&(e.style.transition="max-height 0.3s ease-out",setTimeout(()=>{e.style.transition=""},300))}function r(){o(!l,!0)}t.addEventListener("click",r),n&&n.addEventListener("click",()=>{l&&o(!1,!0)}),i()}})()</script><p>ì´ ê³¼ì •ì„ í†µí•´ softmax ê²°ê³¼ê°€ ì •í™•í•˜ê²Œ ê³„ì‚°ë©ë‹ˆë‹¤.</p><hr><h2 id=-backward-ë‹¨ê³„>â—€ï¸ Backward ë‹¨ê³„</h2><h3 id=1-ì¤‘ê°„ê°’-ì‚¬ì „-ê³„ì‚°-local>(1) ì¤‘ê°„ê°’ ì‚¬ì „ ê³„ì‚° (Local)</h3><ul><li>ê° DeviceëŠ” Gradientsë¥¼ ìœ„í•œ ì¤‘ê°„ê°’ ê³„ì‚°(A, B í–‰ë ¬ ì‚¬ì „ ì¤€ë¹„)</li></ul><h3 id=2-ìµœì¢…-gradients-ê³„ì‚°all-reduce-ìˆ˜í–‰-í›„>(2) ìµœì¢… Gradients ê³„ì‚°(All-Reduce ìˆ˜í–‰ í›„)</h3><ul><li>í•œë²ˆì˜ Communication í›„ ì „ì²´ Gradientê°€ ë¹ ë¥´ê²Œ ê³„ì‚°ë©ë‹ˆë‹¤.</li><li>ìµœì¢… Gradient ê³„ì‚°:</li></ul><div class="code-block-container border-border bg-card my-6 overflow-hidden rounded-xl border shadow-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:shadow-md"><div class="code-block-header bg-muted/30 border-border flex items-center justify-between border-b px-4 py-3"><div class="flex items-center gap-2"><div class="text-muted-foreground flex-shrink-0"><svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4 4 4-4 4M6 16l-4-4 4-4"/></svg></div><span class="text-muted-foreground text-sm font-medium">PLAINTEXT</span></div><div class="flex items-center gap-2"><button class="collapse-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-14 data-default-state=expanded data-collapsed=false data-auto-collapse-lines=30 data-auto-collapse-height=400 data-collapsed-height=120 title=ì ‘ê¸° aria-label=ì ‘ê¸°>
<span class=collapse-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41 12 10.83l4.59 4.58L18 14l-6-6-6 6z"/></svg>
</span><span class="collapse-text hidden sm:inline">ì ‘ê¸°</span>
</button>
<button class="copy-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-14 title=ë³µì‚¬ aria-label=ë³µì‚¬>
<span class=copy-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/></svg>
</span><span class="copy-text hidden sm:inline">ë³µì‚¬</span></button></div></div><div class="code-block-content relative" id=code-14><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=ln>1</span><span class=cl>âˆ‡X = (softmax&#39;(Y)W) Ã— (sum&#39; Ã— exp(m&#39;-m)/sum) - GW</span></span></code></pre></div><div class="collapse-overlay to-card/90 pointer-events-none absolute inset-0 bg-gradient-to-b from-transparent via-transparent opacity-0 transition-opacity duration-300"><div class="text-muted-foreground bg-card/80 border-border/50 hover:bg-primary/10 hover:text-primary hover:border-primary/30 absolute bottom-4 left-1/2 -translate-x-1/2 cursor-pointer rounded-full border px-3 py-1.5 text-xs backdrop-blur-sm transition-all duration-200">í´ë¦­í•˜ì—¬ ë” ë³´ê¸°</div></div></div></div><script>(function(){const s="code-14",n=document.querySelector('.copy-code-btn[data-code-id="'+s+'"]'),t=document.querySelector('.collapse-code-btn[data-code-id="'+s+'"]'),e=document.getElementById(s);if(!e)return;if(n){const s=n.querySelector(".copy-icon"),t=n.querySelector(".copy-text");n.addEventListener("click",async function(){try{let o="";const i=e.querySelector(".lntd:last-child code");if(i)o=i.textContent||i.innerText;else{const t=e.querySelector("code");if(t){const e=t.querySelector(".ln");if(e){const e=t.querySelectorAll(".cl");if(e.length>0)o=Array.from(e).map(e=>{const t=e.textContent||e.innerText;return t.replace(/\n+$/,"")}).join(`
`).replace(/\n+$/,"");else{const e=t.textContent||t.innerText;o=e.replace(/^\d+/gm,"").replace(/^\s+/gm,"")}}else o=t.textContent||t.innerText}else o=e.textContent||e.innerText}o=o.trim(),await navigator.clipboard.writeText(o),s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
</svg>`,t&&(t.textContent="ë³µì‚¬ë¨"),n.classList.add("text-green-600"),setTimeout(()=>{s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
</svg>`,t&&(t.textContent="ë³µì‚¬"),n.classList.remove("text-green-600")},2e3)}catch(o){console.error("å¤åˆ¶å¤±è´¥:",o);const s=document.createRange(),i=e.querySelector("code")||e;s.selectNodeContents(i);const n=window.getSelection();n.removeAllRanges(),n.addRange(s),t&&(t.textContent="ì„ íƒë¨"),setTimeout(()=>{t&&(t.textContent="ë³µì‚¬"),n.removeAllRanges()},2e3)}})}if(t){const d=t.querySelector(".collapse-icon"),c=t.querySelector(".collapse-text"),n=e.querySelector(".collapse-overlay");let s=e.querySelector("pre.chroma");s||(s=e.querySelector("pre"));const m=t.dataset.defaultState||"expanded",f=t.dataset.collapsed==="true",u=parseInt(t.dataset.autoCollapseLines)||30,h=parseInt(t.dataset.autoCollapseHeight)||400,p=parseInt(t.dataset.collapsedHeight)||120;let l=!1;function i(){const e=f||m==="collapsed"||a();e&&o(!0,!1)}function a(){if(s){const e=s.querySelectorAll(".line, .cl"),t=s.offsetHeight;return e.length>u||t>h}const t=e.offsetHeight;if(t>h)return!0;const n=e.textContent||e.innerText||"",o=n.split(`
`).length;return o>u}function o(s,o=!0){if(!n)return;l=s,s?(e.style.maxHeight=p+"px",e.style.overflow="hidden",n.style.opacity="1",n.style.pointerEvents="auto",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
</svg>`,c&&(c.textContent="í¼ì¹˜ê¸°"),t.title="í¼ì¹˜ê¸°"):(e.style.maxHeight="",e.style.overflow="",n.style.opacity="0",n.style.pointerEvents="none",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z"/></svg>`,c&&(c.textContent="ì ‘ê¸°"),t.title="ì ‘ê¸°"),o&&(e.style.transition="max-height 0.3s ease-out",setTimeout(()=>{e.style.transition=""},300))}function r(){o(!l,!0)}t.addEventListener("click",r),n&&n.addEventListener("click",()=>{l&&o(!1,!0)}),i()}})()</script><hr><h1 id=-5-ëª¨ë¸-ì—°ì‚°-ë°-ë©”ëª¨ë¦¬-ìš”êµ¬ëŸ‰-ë¶„ì„>ğŸ”‘ 5. ëª¨ë¸ ì—°ì‚° ë° ë©”ëª¨ë¦¬ ìš”êµ¬ëŸ‰ ë¶„ì„</h1><p>ë…¼ë¬¸ì—ì„œ ì œì‹œëœ ìˆ˜ì¹˜ ê¸°ë°˜ ë¶„ì„ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.</p><table><thead><tr><th>Layer ìœ í˜•</th><th>Computational Cost (FLOPs)</th><th>Parameter Memory</th></tr></thead><tbody><tr><td>Transformer</td><td>( b \times s \times h \times (72h + 12s) )</td><td>(24h^2)</td></tr><tr><td>Input Layer</td><td>( 3 b \times s \times h )</td><td>(2hV)</td></tr><tr><td>Output Layer</td><td>( 6 b \times s \times h \times V )</td><td>(2hV)</td></tr></tbody></table><ul><li>(b) : batch size, (s) : sequence ê¸¸ì´, (h) : hidden dimension, (V): vocab size</li><li>Output layerì˜ ì—°ì‚°ëŸ‰ì´ íŠ¹íˆ ë§¤ìš° í¼(Transformer ëŒ€ë¹„ ìˆ˜ ë°°~ìˆ˜ì‹­ ë°°)</li></ul><h3 id=ì˜ˆì‹œ-ì—°ì‚°ëŸ‰-ê³„ì‚°-ì˜ˆ-7b-ëª¨ë¸-seq-2048-vocab-256k>ì˜ˆì‹œ ì—°ì‚°ëŸ‰ ê³„ì‚° (ì˜ˆ: 7B ëª¨ë¸, seq 2048, vocab 256K)</h3><ul><li>Hidden size((h)) : 4096</li><li>Vocab((V)): 256000</li><li>Sequence length((s)): 2048</li></ul><p>Output Layerì˜ ê³„ì‚°ëŸ‰ ì˜ˆì‹œ:</p><div class="code-block-container border-border bg-card my-6 overflow-hidden rounded-xl border shadow-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:shadow-md"><div class="code-block-header bg-muted/30 border-border flex items-center justify-between border-b px-4 py-3"><div class="flex items-center gap-2"><div class="text-muted-foreground flex-shrink-0"><svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4 4 4-4 4M6 16l-4-4 4-4"/></svg></div><span class="text-muted-foreground text-sm font-medium">PLAINTEXT</span></div><div class="flex items-center gap-2"><button class="collapse-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-15 data-default-state=expanded data-collapsed=false data-auto-collapse-lines=30 data-auto-collapse-height=400 data-collapsed-height=120 title=ì ‘ê¸° aria-label=ì ‘ê¸°>
<span class=collapse-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41 12 10.83l4.59 4.58L18 14l-6-6-6 6z"/></svg>
</span><span class="collapse-text hidden sm:inline">ì ‘ê¸°</span>
</button>
<button class="copy-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-15 title=ë³µì‚¬ aria-label=ë³µì‚¬>
<span class=copy-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/></svg>
</span><span class="copy-text hidden sm:inline">ë³µì‚¬</span></button></div></div><div class="code-block-content relative" id=code-15><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=ln>1</span><span class=cl>FLOPs â‰ˆ 6 Ã— (1 batch) Ã— 2048 Ã— 4096 Ã— 256000 â‰ˆ 1.29e13 FLOPs
</span></span><span class=line><span class=ln>2</span><span class=cl>Parameter Memory â‰ˆ 2 Ã— 4096 Ã— 256000 Ã— 2 bytes (FP16) â‰ˆ 4GB</span></span></code></pre></div><div class="collapse-overlay to-card/90 pointer-events-none absolute inset-0 bg-gradient-to-b from-transparent via-transparent opacity-0 transition-opacity duration-300"><div class="text-muted-foreground bg-card/80 border-border/50 hover:bg-primary/10 hover:text-primary hover:border-primary/30 absolute bottom-4 left-1/2 -translate-x-1/2 cursor-pointer rounded-full border px-3 py-1.5 text-xs backdrop-blur-sm transition-all duration-200">í´ë¦­í•˜ì—¬ ë” ë³´ê¸°</div></div></div></div><script>(function(){const s="code-15",n=document.querySelector('.copy-code-btn[data-code-id="'+s+'"]'),t=document.querySelector('.collapse-code-btn[data-code-id="'+s+'"]'),e=document.getElementById(s);if(!e)return;if(n){const s=n.querySelector(".copy-icon"),t=n.querySelector(".copy-text");n.addEventListener("click",async function(){try{let o="";const i=e.querySelector(".lntd:last-child code");if(i)o=i.textContent||i.innerText;else{const t=e.querySelector("code");if(t){const e=t.querySelector(".ln");if(e){const e=t.querySelectorAll(".cl");if(e.length>0)o=Array.from(e).map(e=>{const t=e.textContent||e.innerText;return t.replace(/\n+$/,"")}).join(`
`).replace(/\n+$/,"");else{const e=t.textContent||t.innerText;o=e.replace(/^\d+/gm,"").replace(/^\s+/gm,"")}}else o=t.textContent||t.innerText}else o=e.textContent||e.innerText}o=o.trim(),await navigator.clipboard.writeText(o),s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
</svg>`,t&&(t.textContent="ë³µì‚¬ë¨"),n.classList.add("text-green-600"),setTimeout(()=>{s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
</svg>`,t&&(t.textContent="ë³µì‚¬"),n.classList.remove("text-green-600")},2e3)}catch(o){console.error("å¤åˆ¶å¤±è´¥:",o);const s=document.createRange(),i=e.querySelector("code")||e;s.selectNodeContents(i);const n=window.getSelection();n.removeAllRanges(),n.addRange(s),t&&(t.textContent="ì„ íƒë¨"),setTimeout(()=>{t&&(t.textContent="ë³µì‚¬"),n.removeAllRanges()},2e3)}})}if(t){const d=t.querySelector(".collapse-icon"),c=t.querySelector(".collapse-text"),n=e.querySelector(".collapse-overlay");let s=e.querySelector("pre.chroma");s||(s=e.querySelector("pre"));const m=t.dataset.defaultState||"expanded",f=t.dataset.collapsed==="true",u=parseInt(t.dataset.autoCollapseLines)||30,h=parseInt(t.dataset.autoCollapseHeight)||400,p=parseInt(t.dataset.collapsedHeight)||120;let l=!1;function i(){const e=f||m==="collapsed"||a();e&&o(!0,!1)}function a(){if(s){const e=s.querySelectorAll(".line, .cl"),t=s.offsetHeight;return e.length>u||t>h}const t=e.offsetHeight;if(t>h)return!0;const n=e.textContent||e.innerText||"",o=n.split(`
`).length;return o>u}function o(s,o=!0){if(!n)return;l=s,s?(e.style.maxHeight=p+"px",e.style.overflow="hidden",n.style.opacity="1",n.style.pointerEvents="auto",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
</svg>`,c&&(c.textContent="í¼ì¹˜ê¸°"),t.title="í¼ì¹˜ê¸°"):(e.style.maxHeight="",e.style.overflow="",n.style.opacity="0",n.style.pointerEvents="none",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z"/></svg>`,c&&(c.textContent="ì ‘ê¸°"),t.title="ì ‘ê¸°"),o&&(e.style.transition="max-height 0.3s ease-out",setTimeout(()=>{e.style.transition=""},300))}function r(){o(!l,!0)}t.addEventListener("click",r),n&&n.addEventListener("click",()=>{l&&o(!1,!0)}),i()}})()</script><ul><li>ì´ëŠ” ë‹¨ì¼ microbatch ê¸°ì¤€ìœ¼ë¡œë„ ì—°ì‚°ì´ ë§¤ìš° ë§ìœ¼ë©°, PPìƒì—ì„œ ë¶ˆê· í˜• ë¬¸ì œê°€ ë§¤ìš° í´ ìˆ˜ ìˆìŒì„ ë³´ì—¬ì¤ë‹ˆë‹¤.</li></ul><hr><h1 id=-ê²°ë¡ -ë°-ì „ì²´-ì •ë¦¬>ğŸš© ê²°ë¡  ë° ì „ì²´ ì •ë¦¬</h1><p>ì´ ë…¼ë¬¸ì˜ Vocabulary Parallelismì€ í° Vocabulary Sizeë¥¼ ì‚¬ìš©í•˜ëŠ” ê±°ëŒ€ ì–¸ì–´ëª¨ë¸ í•™ìŠµ ì‹œ í•„ìˆ˜ì ì¸ ë°©ë²•ì…ë‹ˆë‹¤.</p><table><thead><tr><th>í•µì‹¬</th><th>ìš”ì•½</th></tr></thead><tbody><tr><td>ì…ë ¥ ë°ì´í„°</td><td>ì¼ë°˜ì ì¸ ëŒ€ê·œëª¨ í† í°í™” í…ìŠ¤íŠ¸ ë°ì´í„°</td></tr><tr><td>ëª¨ë¸ êµ¬ì„±</td><td>Transformer ê¸°ë°˜ ê±°ëŒ€ ëª¨ë¸</td></tr><tr><td>ì¶”ë¡  ê³¼ì •</td><td>PPê¸°ë°˜ Forward-Backward, ì–´íœ˜ì¸µ ë³‘ë ¬í™”</td></tr><tr><td>ì¶”ê°€ êµ¬í˜„ í•„ìš”</td><td>Embeddingì¸µ ë¶„í•  ë° ìµœì í™”ëœ í†µì‹ (All-Reduce)</td></tr><tr><td>ì—°ì‚° & ë©”ëª¨ë¦¬</td><td>ì–´íœ˜ì¸µ ë³‘ë ¬í™”ë¡œ ì—°ì‚° ë° ë©”ëª¨ë¦¬ ë¶€í•˜ ê· ë“± ë¶„ì‚°</td></tr></tbody></table><p>ì´ ë°©ë²•ì€ íŠ¹íˆ Vocab sizeê°€ í° ëª¨ë¸ í•™ìŠµì—ì„œ í•„ìˆ˜ì ì´ë©°, í° ì„±ëŠ¥ í–¥ìƒì„ ì œê³µí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p><h1 id=q--ì´-ë…¼ë¬¸ì˜-í•œê³„ë¥¼-ê·¹ë³µí•˜ê¸°-ìœ„í•œ-ë°©ë²•ìœ¼ë¡œ-ì–´ë–¤-ì—°êµ¬íë¦„ì´-ìˆëŠ”ì§€-ì •ë¦¬í•´ì„œ-ìì„¸í•˜ê²Œ-ì„¤ëª…í•´-ì¤˜>Q : ì´ ë…¼ë¬¸ì˜ í•œê³„ë¥¼ ê·¹ë³µí•˜ê¸° ìœ„í•œ ë°©ë²•ìœ¼ë¡œ ì–´ë–¤ ì—°êµ¬íë¦„ì´ ìˆëŠ”ì§€ ì •ë¦¬í•´ì„œ ìì„¸í•˜ê²Œ ì„¤ëª…í•´ ì¤˜</h1><p>ì´ ë…¼ë¬¸ì˜ ì œì•ˆ ë°©ë²•(Vocabulary Parallelism)ì€ Transformer ê¸°ë°˜ì˜ ëŒ€ê·œëª¨ ì–¸ì–´ëª¨ë¸ í•™ìŠµ ì‹œ ë°œìƒí•˜ëŠ” <strong>Vocabulary Layerì˜ ì—°ì‚°ê³¼ ë©”ëª¨ë¦¬ ë¶ˆê· í˜• ë¬¸ì œ</strong>ë¥¼ ë§¤ìš° íš¨ê³¼ì ìœ¼ë¡œ í•´ê²°í•˜ì˜€ìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ ì—¬ì „íˆ ì¡´ì¬í•˜ëŠ” í•œê³„ì ê³¼ ì´ë¥¼ ê·¹ë³µí•˜ê¸° ìœ„í•œ ì¶”ê°€ì  ì—°êµ¬ ë°©í–¥ì´ ì¡´ì¬í•©ë‹ˆë‹¤.</p><p>ë‹¤ìŒì€ ì´ ë…¼ë¬¸ì˜ í•œê³„ì ê³¼ ì´ë¥¼ ê·¹ë³µí•˜ê¸° ìœ„í•œ ìµœì‹  ì—°êµ¬ íë¦„ê³¼ í–¥í›„ ì—°êµ¬ë°©í–¥ì„ <strong>êµ¬ì²´ì ìœ¼ë¡œ ë¶„ì„í•˜ê³  ìƒì„¸íˆ ì •ë¦¬</strong>í•œ ê²ƒì…ë‹ˆë‹¤.</p><hr><h2 id=-ë…¼ë¬¸ì˜-í•œê³„ì -ëª…í™•í•œ-ì •ë¦¬>ğŸš© ë…¼ë¬¸ì˜ í•œê³„ì  (ëª…í™•í•œ ì •ë¦¬)</h2><table><thead><tr><th>ë¬¸ì œì </th><th>êµ¬ì²´ì  ë‚´ìš©</th></tr></thead><tbody><tr><td><strong>Communication Overhead</strong></td><td>Vocabulary Parallelismì—ì„œ í•„ìˆ˜ì ì¸ <strong>All-Reduce</strong>ë¡œ ì¸í•œ ì¶”ê°€ í†µì‹  ë¹„ìš©</td></tr><tr><td><strong>Input Layerì˜ ë‚®ì€ íš¨ìœ¨ì„±</strong></td><td>Input Layerì˜ ë³‘ë ¬í™” íš¨ìœ¨ì„±ì´ Output Layerë³´ë‹¤ í˜„ì €íˆ ë–¨ì–´ì§ (ìµœëŒ€ ì•½ 8.35%)</td></tr><tr><td><strong>Activation Memory Overhead</strong></td><td>ìµœì†Œí™”í–ˆìœ¼ë‚˜, ì—¬ì „íˆ <strong>ì¶”ê°€ì ì¸ Activation memory</strong> í•„ìš”</td></tr></tbody></table><hr><h1 id=-ë…¼ë¬¸ì˜-í•œê³„-ê·¹ë³µì„-ìœ„í•œ-ìµœì‹ -ì—°êµ¬-ë°©í–¥-ë°-ì ‘ê·¼ë²•>ğŸ› ï¸ ë…¼ë¬¸ì˜ í•œê³„ ê·¹ë³µì„ ìœ„í•œ ìµœì‹  ì—°êµ¬ ë°©í–¥ ë° ì ‘ê·¼ë²•</h1><p>ì´ëŸ¬í•œ í•œê³„ë¥¼ ê·¹ë³µí•˜ê¸° ìœ„í•´ ë‹¤ìŒê³¼ ê°™ì€ ì„¸ ê°€ì§€ ì£¼ìš” ì—°êµ¬ ë°©í–¥ì´ ì£¼ëª©ë°›ê³  ìˆìŠµë‹ˆë‹¤.</p><hr><h2 id=-ì—°êµ¬ë°©í–¥-1-í†µì‹ -ìµœì í™”-ê¸°ìˆ communication-optimization>ğŸ’¡ [ì—°êµ¬ë°©í–¥ 1] í†µì‹  ìµœì í™” ê¸°ìˆ (Communication Optimization)</h2><p><strong>ë¬¸ì œì </strong></p><ul><li>Vocabulary Parallelismì—ì„œì˜ ì¦ì€ <strong>All-Reduce í†µì‹ </strong>ì´ ì„±ëŠ¥ ë³‘ëª© ìœ ë°œ (ë…¼ë¬¸ì—ì„œë„ ì´ë¡œ ì¸í•œ GPU Idle timeì´ 11% ìˆ˜ì¤€ìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìŒ).</li></ul><p><strong>í•´ê²°ë°©ì•ˆ</strong></p><ul><li><strong>í†µì‹  ì••ì¶•(Compression)</strong> ë° ìµœì í™” ê¸°ìˆ  ì ìš©(All-Reduce ë¹„ìš© ê²½ê°)</li><li><strong>ë¹„ë™ê¸°ì‹(Asynchronous)</strong> í†µì‹  ì „ëµì˜ ë„ì… ê°€ëŠ¥ì„± ê²€í† </li><li><strong>Hierarchical All-Reduce</strong>(ê³„ì¸µì  í†µì‹ )ë‚˜ <strong>NCCLì˜ ìµœì í™”</strong> ì ìš© ê°€ëŠ¥</li></ul><p><strong>ìµœì‹  ì—°êµ¬ì‚¬ë¡€</strong></p><ul><li>Microsoftì˜ ZeRO-Infinity, DeepSpeed (Rajbhandari et al.)ê°€ ëŒ€í‘œì : Hierarchical All-Reduce ë° Non-blocking ë°©ì‹ ì ìš©ì„ í†µí•œ í†µì‹  ë¹„ìš© ìµœì†Œí™” (ìµœëŒ€ 2~4ë°° í†µì‹  ì†ë„ í–¥ìƒ)</li></ul><hr><h2 id=-ì—°êµ¬ë°©í–¥-2-input-layer-ë³‘ë ¬í™”-ê°œì„ -ì—°êµ¬>ğŸ’¡ [ì—°êµ¬ë°©í–¥ 2] Input Layer ë³‘ë ¬í™” ê°œì„  ì—°êµ¬</h2><p><strong>ë¬¸ì œì </strong></p><ul><li>Output LayerëŠ” ë¹„êµì  ì˜ ë³‘ë ¬í™”ë˜ì—ˆìœ¼ë‚˜ Input Layer íš¨ìœ¨ì€ ì—¬ì „íˆ ë–¨ì–´ì§(ë…¼ë¬¸ì—ì„œ ìµœëŒ€ 8.35%ë¡œ íš¨ìœ¨ ì €í•˜)</li></ul><p><strong>í•´ê²° ì ‘ê·¼ë²•</strong></p><ul><li>Input Layer ê³„ì‚° êµ¬ì¡°ë¥¼ <strong>Kernel Fusion</strong>, CUDA ì»¤ë„ ìµœì í™”ë¡œ ë³‘ëª©í˜„ìƒ ìµœì†Œí™”</li><li>Input Embeddingì„ <strong>Sparse ì—°ì‚°ìœ¼ë¡œ ëŒ€ì²´</strong>í•˜ì—¬ ë©”ëª¨ë¦¬ ì ‘ê·¼ê³¼ ê³„ì‚°ëŸ‰ ê°ì†Œ ê°€ëŠ¥ì„± ëª¨ìƒ‰</li><li>Embedding Layerì™€ Transformer ì—°ì‚°ì„ <strong>ì ê·¹ì  ì˜¤ë²„ë©</strong>ì‹œì¼œ íš¨ìœ¨ ê°œì„ </li></ul><p><strong>ìµœì‹  ì—°êµ¬ì‚¬ë¡€</strong></p><ul><li><strong>DeepSpeed-Ulysses(2024)</strong><br>ì…ë ¥ ì„ë² ë”© ì²˜ë¦¬ ìµœì í™”ë¡œ íš¨ìœ¨ í–¥ìƒ ì—°êµ¬</li><li><strong>Fused Embedding ê¸°ë²• (ì˜ˆ: NVIDIA FasterTransformer)</strong><br>CUDA ì»¤ë„ ìˆ˜ì¤€ì—ì„œ Embedding ì—°ì‚°ì„ í†µí•©í•´ ë©”ëª¨ë¦¬ ì ‘ê·¼ ë° ë³‘ë ¬ íš¨ìœ¨ ê°œì„ </li></ul><hr><h2 id=-ì—°êµ¬ë°©í–¥-3-activation-memory-ì‚¬ìš©ëŸ‰-ì¶”ê°€-ê²½ê°>ğŸ’¡ [ì—°êµ¬ë°©í–¥ 3] Activation Memory ì‚¬ìš©ëŸ‰ ì¶”ê°€ ê²½ê°</h2><p><strong>ë¬¸ì œì </strong></p><ul><li>ì—¬ì „íˆ ì†Œí­ì˜ Activation Memory ì¦ê°€ ì¡´ì¬(Microbatch 1~2ê°œ ë§Œí¼)</li></ul><p><strong>í•´ê²° ì ‘ê·¼ë²•</strong></p><ul><li>**Activation Recomputation (ì¬ê³„ì‚° ê¸°ë²•)**ì˜ ì¶”ê°€ ìµœì í™”<br>ì¼ë¶€ í™œì„±í™”ë¥¼ ì €ì¥í•˜ì§€ ì•Šê³  í•„ìš”í•  ë•Œ ë‹¤ì‹œ ê³„ì‚°í•´ ë©”ëª¨ë¦¬ ì ˆì•½</li><li><strong>Selective Offloading</strong>: ì¤‘ìš”í•˜ì§€ ì•Šì€ í™œì„±í™” ë©”ëª¨ë¦¬ë¥¼ Hostë‚˜ SSDë¡œ ì¼ë¶€ ì´ì „í•˜ì—¬ Peak GPU ë©”ëª¨ë¦¬ ë¶€ë‹´ì„ ë” ì¤„ì´ëŠ” ì—°êµ¬ ê°€ëŠ¥ì„±</li></ul><p><strong>ìµœì‹  ì—°êµ¬ì‚¬ë¡€</strong></p><ul><li><strong>ZeRO-Offload(DeepSpeed)</strong><br>í™œì„±í™” ë©”ëª¨ë¦¬ ì¼ë¶€ë¥¼ CPUë¡œ offloadí•˜ì—¬ GPU ë©”ëª¨ë¦¬ íš¨ìœ¨ì„ ë†’ì´ëŠ” ì—°êµ¬(ìµœëŒ€ ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ 50% ì¶”ê°€ ì ˆì•½ ê°€ëŠ¥)</li><li><strong>FlashAttention (Stanford)</strong><br>Activation ì¬ê³„ì‚°ê³¼ ë©”ëª¨ë¦¬ ìµœì í™”ë¡œ Transformer í™œì„±í™” ë©”ëª¨ë¦¬ ìµœëŒ€ 10ë°° ì ˆì•½ ì„±ê³µ</li></ul><hr><h2 id=ì—°êµ¬ë°©í–¥-3-vocabulary-layerë¥¼-ìœ„í•œ-íš¨ìœ¨ì -cuda-kernel-fusion-ì—°êµ¬>ğŸ’¡[ì—°êµ¬ë°©í–¥ 3] Vocabulary Layerë¥¼ ìœ„í•œ íš¨ìœ¨ì  CUDA Kernel Fusion ì—°êµ¬</h2><p><strong>ë¬¸ì œì </strong></p><ul><li>ê¸°ì¡´ Vocabulary Parallelismì—ì„œ softmax ë° matmul ì—°ì‚°ì´ ë³„ë„ì˜ ë‹¨ê³„ë¡œ ë¶„ë¦¬ë˜ì–´ ì¶”ê°€ì ì¸ GPU ë©”ëª¨ë¦¬ ì½ê¸°/ì“°ê¸° ì˜¤ë²„í—¤ë“œ ì¡´ì¬</li></ul><p><strong>í•´ê²° ì ‘ê·¼ë²•</strong></p><ul><li><strong>Forward-Backward CUDA ì»¤ë„ Fusion</strong><br>Forwardì™€ Backward ì—°ì‚°ì„ ê²°í•©í•œ CUDA kernelì„ ê°œë°œí•˜ì—¬ ì¤‘ê°„ Activationì„ ë©”ëª¨ë¦¬ì— ì €ì¥í•˜ì§€ ì•Šê³  GPU ë‚´ì—ì„œ ë°”ë¡œ í™œìš©í•˜ì—¬ ì„±ëŠ¥ ë° ë©”ëª¨ë¦¬ íš¨ìœ¨ì„± í–¥ìƒ</li></ul><p><strong>ìµœì‹  ì—°êµ¬ì‚¬ë¡€</strong></p><ul><li><strong>FlashAttention(2022)</strong><br>attention ì—°ì‚°ì˜ forward-backward ì—°ì‚°ì„ fusioní•˜ì—¬ ë©”ëª¨ë¦¬ overhead ìµœì†Œí™”. ì–´íœ˜ì¸µì—ë„ ìœ ì‚¬í•œ kernel fusionì´ ì ìš© ê°€ëŠ¥í•¨.</li></ul><hr><h2 id=-ìµœì‹ -ì—°êµ¬-íë¦„-ë°-ì „ë§-ì¢…í•©-ì •ë¦¬-í•œëˆˆì—-ë³´ê¸°-ì‰¬ìš´-í…Œì´ë¸”ë¡œ-ì •ë¦¬>ğŸ“Œ ìµœì‹  ì—°êµ¬ íë¦„ ë° ì „ë§ ì¢…í•© ì •ë¦¬ (í•œëˆˆì— ë³´ê¸° ì‰¬ìš´ í…Œì´ë¸”ë¡œ ì •ë¦¬)</h2><table><thead><tr><th>ì—°êµ¬ ë°©í–¥</th><th>ì£¼ìš” ê¸°ìˆ </th><th>íš¨ê³¼ (ê¸°ëŒ€ ê²°ê³¼)</th><th>ëŒ€í‘œì  ì—°êµ¬ ì‚¬ë¡€</th></tr></thead><tbody><tr><td><strong>í†µì‹  ìµœì í™”</strong></td><td>Hierarchical All-Reduce, ë¹„ë™ê¸° í†µì‹ </td><td>Communication Overhead ìµœì†Œí™” (ì•½ 10~20% ê°œì„ )</td><td>NCCL, Horovod, Megatron-LM</td></tr><tr><td><strong>ì…ë ¥ì¸µ ë³‘ë ¬í™” ê°œì„ </strong></td><td>Fused CUDA Embedding, Overlap ìµœì í™”</td><td>Input Layer íš¨ìœ¨ì„± í–¥ìƒ (ìµœì†Œ 20% ì´ìƒ ê°œì„  ê°€ëŠ¥ì„±)</td><td>FasterTransformer, DeepSpeed-Ulysses</td></tr><tr><td><strong>Activation ë©”ëª¨ë¦¬ ì ˆì•½</strong></td><td>Activation Recomputation, Selective offloading</td><td>Activation Memory ê°ì†Œ (ìµœëŒ€ 50% ì´ìƒ ê°œì„  ê°€ëŠ¥)</td><td>FlashAttention, DeepSpeed ZeRO</td></tr><tr><td><strong>CUDA kernel fusion</strong></td><td>Forward/Backward ì—°ì‚° ê²°í•© Fusion</td><td>ì„±ëŠ¥ ë° ë©”ëª¨ë¦¬ íš¨ìœ¨ì„± ëŒ€í­ ì¦ê°€ (20~50% ì„±ëŠ¥ ê°œì„ )</td><td>FlashAttention</td></tr></tbody></table><hr><h2 id=-ê²°ë¡ -ë°-ë„ˆì˜-ìƒê°-ì¢…í•©ì -ì˜ê²¬>ğŸ“Œ ê²°ë¡  ë° ë„ˆì˜ ìƒê° (ì¢…í•©ì  ì˜ê²¬)</h2><p>ì´ ë…¼ë¬¸ì—ì„œ ì œì•ˆëœ <strong>Vocabulary Parallelism</strong>ì€ í˜„ì¡´í•˜ëŠ” Pipeline ë³‘ë ¬í™” ê¸°ìˆ ì˜ ëª…í™•í•œ í•œê³„ë¥¼ ë›°ì–´ë‚œ ìˆ˜ì¤€ìœ¼ë¡œ í•´ê²°í•˜ì˜€ìœ¼ë‚˜, ì¶”ê°€ì ì¸ í†µì‹  ì˜¤ë²„í—¤ë“œì™€ ì…ë ¥ì¸µì˜ íš¨ìœ¨ ë¬¸ì œ, Activation memory ë¹„ìš©ì´ë¼ëŠ” í•œê³„ë¥¼ ë‚¨ê²¼ìŠµë‹ˆë‹¤.</p><p>ì´ëŸ¬í•œ í•œê³„ì ì€ ìœ„ì—ì„œ ì œì‹œí•œ ìµœì‹  ì—°êµ¬ ë°©í–¥ì„ í†µí•´ ì¶©ë¶„íˆ ê·¹ë³µ ê°€ëŠ¥ì„±ì´ ì¡´ì¬í•˜ë©°, íŠ¹íˆ ë‹¤ìŒê³¼ ê°™ì€ ê°œì„ ì´ ê°€ì¥ ìœ ë§í•˜ë‹¤ê³  ë´…ë‹ˆë‹¤.</p><ul><li><strong>Activation Recomputationì„ í†µí•œ Memory ê°œì„ </strong></li><li><strong>CUDA kernel Fusionì„ í†µí•œ ì—°ì‚° ìµœì í™”</strong></li><li><strong>ê³„ì¸µì Â·ë¹„ë™ê¸°ì  í†µì‹ ê¸°ë²•ì„ ì´ìš©í•œ í†µì‹  ì˜¤ë²„í—¤ë“œ ê°ì†Œ</strong></li></ul><p>ì´ëŸ¬í•œ ì—°êµ¬ê°€ ì¶”ê°€ë¡œ ê²°í•©ëœë‹¤ë©´, ë³¸ ë…¼ë¬¸ì˜ ë°©ë²•ë¡ ì´ ê°€ì§€ëŠ” ì„±ëŠ¥ ìš°ìœ„ì™€ íš¨ìœ¨ì„±ì„ ë”ìš± í™•ì¥í•˜ì—¬ ëŒ€ê·œëª¨ Transformer ëª¨ë¸ í•™ìŠµ ì‹œ ì‹¤ì§ˆì ìœ¼ë¡œ ë§¤ìš° ìœ ìš©í•œ í‘œì¤€ ê¸°ìˆ ë¡œ ìë¦¬ ì¡ì„ ìˆ˜ ìˆì„ ê²ƒì…ë‹ˆë‹¤.</p><h1 id=q--vocabulary-parallelismì´-ê¸°ì¡´ì˜-pipeline-parallelismpp-ë°©ì‹ì—ì„œ-ë°œìƒí•˜ëŠ”-ì—°ì‚°-ë°-ë©”ëª¨ë¦¬-ë¶ˆê· í˜•-ë¬¸ì œë¥¼-ì–´ë–»ê²Œ-í•´ê²°í•˜ëŠ”ì§€-ê·¸ë¦¬ê³ -ì´ë¥¼-í†µí•´-throughputê³¼-peak-memoryê°€-ì–´ë–»ê²Œ-ê°œì„ ë˜ëŠ”ì§€ë¥¼-ì„¤ëª…í•˜ì‹œì˜¤>Q : Vocabulary Parallelismì´ ê¸°ì¡´ì˜ Pipeline Parallelism(PP) ë°©ì‹ì—ì„œ ë°œìƒí•˜ëŠ” ì—°ì‚° ë° ë©”ëª¨ë¦¬ ë¶ˆê· í˜• ë¬¸ì œë¥¼ ì–´ë–»ê²Œ í•´ê²°í•˜ëŠ”ì§€, ê·¸ë¦¬ê³  ì´ë¥¼ í†µí•´ Throughputê³¼ Peak Memoryê°€ ì–´ë–»ê²Œ ê°œì„ ë˜ëŠ”ì§€ë¥¼ ì„¤ëª…í•˜ì‹œì˜¤.</h1><h2 id=vocabulary-parallelismì´-ê¸°ì¡´-pipeline-parallelismppì˜-ë¬¸ì œë¥¼-í•´ê²°í•˜ëŠ”-ë°©ì‹>Vocabulary Parallelismì´ ê¸°ì¡´ Pipeline Parallelism(PP)ì˜ ë¬¸ì œë¥¼ í•´ê²°í•˜ëŠ” ë°©ì‹</h2><h3 id=1-ê¸°ì¡´-pipeline-parallelismppì˜-ì—°ì‚°-ë°-ë©”ëª¨ë¦¬-ë¶ˆê· í˜•-ë¬¸ì œ>1ï¸âƒ£ ê¸°ì¡´ Pipeline Parallelism(PP)ì˜ ì—°ì‚° ë° ë©”ëª¨ë¦¬ ë¶ˆê· í˜• ë¬¸ì œ</h3><p>PPëŠ” ëŒ€ê·œëª¨ Transformer ëª¨ë¸ì„ ì—¬ëŸ¬ GPUë¡œ ë‚˜ëˆ„ì–´ í•™ìŠµí•  ë•Œ, ê° GPUê°€ ëª¨ë¸ì˜ ì¼ë¶€ ë ˆì´ì–´ë¥¼ ë‹´ë‹¹í•˜ì—¬ ìˆœì°¨ì ìœ¼ë¡œ ì—°ì‚°í•˜ëŠ” ë°©ì‹ì´ë‹¤.<br>ê·¸ëŸ¬ë‚˜, ê¸°ì¡´ PP ë°©ì‹ì—ì„œëŠ” ë‹¤ìŒê³¼ ê°™ì€ <strong>ì—°ì‚° ë° ë©”ëª¨ë¦¬ ë¶ˆê· í˜•</strong> ë¬¸ì œê°€ ë°œìƒí•œë‹¤.</p><h4 id=-1-vocabulary-layerê°€-íŠ¹ì •-gpuì—-ì§‘ì¤‘ë˜ì–´-ë°œìƒí•˜ëŠ”-ë¬¸ì œ>ğŸ”¹ (1) Vocabulary Layerê°€ íŠ¹ì • GPUì— ì§‘ì¤‘ë˜ì–´ ë°œìƒí•˜ëŠ” ë¬¸ì œ</h4><ul><li>ì¼ë°˜ì ìœ¼ë¡œ <strong>ì²« ë²ˆì§¸ GPUì—ëŠ” Input Embedding Layer</strong>, <strong>ë§ˆì§€ë§‰ GPUì—ëŠ” Output Softmax Layer</strong>ê°€ ë°°ì •ëœë‹¤.</li><li>Output LayerëŠ” ì–´íœ˜ í¬ê¸°(Vocabulary Size)ì— ë¹„ë¡€í•˜ì—¬ ë§¤ìš° í° ì—°ì‚°ëŸ‰ê³¼ ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ì„ ìš”êµ¬í•œë‹¤.</li><li>Transformer LayerëŠ” ë¹„êµì  ê· ë“±í•˜ê²Œ ë¶„ë°°ë˜ì§€ë§Œ, <strong>Output LayerëŠ” ë§ˆì§€ë§‰ GPUì— ì§‘ì¤‘ë˜ì–´ í° ê³„ì‚° ë¶€í•˜ ë°œìƒ</strong>.</li></ul><h4 id=-2-pipeline-bubble-ë¬¸ì œ>ğŸ”¹ (2) Pipeline Bubble ë¬¸ì œ</h4><ul><li>PPì—ì„œëŠ” Forward ë° Backward ì—°ì‚°ì´ ìˆœì°¨ì ìœ¼ë¡œ ì§„í–‰ë˜ëŠ”ë°, Output Layerì— ë¶€í•˜ê°€ ì§‘ì¤‘ë˜ë©´ì„œ ì¼ë¶€ GPUëŠ” ìœ íœ´ ìƒíƒœ(Idle)ë¡œ ëŒ€ê¸°í•´ì•¼ í•˜ëŠ” <strong>Pipeline Bubble</strong> í˜„ìƒì´ ë°œìƒí•œë‹¤.</li><li>íŠ¹íˆ, Output Layerì˜ ì—°ì‚°ì´ Transformer Layerë³´ë‹¤ í›¨ì”¬ í¬ë©´ ë§ˆì§€ë§‰ GPUê°€ ì˜¤ë˜ ê±¸ë ¤ì„œ ë‹¤ë¥¸ GPUë“¤ì´ ëŒ€ê¸°í•´ì•¼ í•˜ëŠ” ìƒí™©ì´ ìƒê¸´ë‹¤.</li><li>Vocabulary Sizeê°€ í´ìˆ˜ë¡ ì´ ë¬¸ì œê°€ ì‹¬ê°í•´ì§€ë©°, <strong>Throughput(ì´ˆë‹¹ ì—°ì‚°ëŸ‰)ì´ ê¸‰ê²©íˆ ì €í•˜ë¨</strong>.</li></ul><h4 id=-3-ë©”ëª¨ë¦¬-ë¶ˆê· í˜•>ğŸ”¹ (3) ë©”ëª¨ë¦¬ ë¶ˆê· í˜•</h4><ul><li>Output LayerëŠ” í° Vocabulary Sizeë¡œ ì¸í•´ <strong>ë‹¤ë¥¸ Layerë³´ë‹¤ í›¨ì”¬ ë” ë§ì€ Parameter Memoryë¥¼ ì°¨ì§€</strong>í•œë‹¤.</li><li>ë§ˆì§€ë§‰ GPUì—ë§Œ ì–´íœ˜ì¸µ ì—°ì‚°ì´ ì§‘ì¤‘ë˜ë©´ì„œ íŠ¹ì • GPUì—ì„œë§Œ ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ì´ ê¸‰ì¦í•˜ì—¬ <strong>ëª¨ë¸ í•™ìŠµì´ ë³‘ëª©(Bottleneck) í˜„ìƒ</strong>ì„ ì´ˆë˜í•œë‹¤.</li></ul><hr><h3 id=2-vocabulary-parallelismì´-ë¬¸ì œë¥¼-í•´ê²°í•˜ëŠ”-ë°©ì‹>2ï¸âƒ£ Vocabulary Parallelismì´ ë¬¸ì œë¥¼ í•´ê²°í•˜ëŠ” ë°©ì‹</h3><p>ë…¼ë¬¸ì—ì„œëŠ” ì´ëŸ¬í•œ ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ <strong>Vocabulary Parallelism</strong>ì„ ë„ì…í•˜ì—¬ Output Layerì˜ ì—°ì‚°ê³¼ ë©”ëª¨ë¦¬ë¥¼ ì—¬ëŸ¬ GPUì— <strong>ê· ë“±í•˜ê²Œ ë¶„ë°°</strong>í•˜ì˜€ë‹¤.</p><h4 id=-1-vocabulary-layerë¥¼-ëª¨ë“ -gpuì—-ê· ë“±-ë¶„ì‚°>âœ… (1) Vocabulary Layerë¥¼ ëª¨ë“  GPUì— ê· ë“± ë¶„ì‚°</h4><ul><li>Output Layer(Softmax ë° MatMul ì—°ì‚°)ë¥¼ ì—¬ëŸ¬ GPUì— ê±¸ì³ì„œ <strong>ê· ë“±í•˜ê²Œ ë¶„í• </strong>.</li><li>ì˜ˆë¥¼ ë“¤ì–´, <strong>Vocab Sizeê°€ 256Kì´ê³  GPUê°€ 8ê°œë¼ë©´, ê° GPUëŠ” 32K Vocabularyë§Œ ì²˜ë¦¬</strong>í•˜ë„ë¡ í•¨.</li><li>ì¦‰, <strong>ê° GPUê°€ ì¼ë¶€ ì–´íœ˜(Token)ì— ëŒ€í•œ ì—°ì‚°ë§Œ ìˆ˜í–‰</strong>í•˜ê³ , ì´í›„ <strong>All-Reduceë¥¼ í†µí•´ ìµœì¢… ê²°ê³¼ë¥¼ í†µí•©</strong>í•˜ëŠ” ë°©ì‹.</li></ul><h4 id=-2-ì—°ì‚°-ê· í˜•-ìœ ì§€-ë°-pipeline-bubble-ìµœì†Œí™”>âœ… (2) ì—°ì‚° ê· í˜• ìœ ì§€ ë° Pipeline Bubble ìµœì†Œí™”</h4><ul><li>ê¸°ì¡´ ë°©ì‹ì—ì„œëŠ” ë§ˆì§€ë§‰ GPUì—ë§Œ ì§‘ì¤‘ëœ ì—°ì‚°ì„ ì—¬ëŸ¬ GPUë¡œ ë¶„ì‚°ì‹œì¼œ, <strong>ëª¨ë“  GPUê°€ ìœ ì‚¬í•œ ì—°ì‚° ë¶€í•˜ë¥¼ ê°–ë„ë¡ ì¡°ì •</strong>.</li><li>ì´ë¥¼ í†µí•´ ì¼ë¶€ GPUê°€ ê³¼ë¶€í•˜ë¡œ ì¸í•´ Pipeline Bubbleì´ ë°œìƒí•˜ëŠ” ë¬¸ì œë¥¼ ì™„í™”í•˜ê³ , <strong>Throughputì„ ìµœì í™”</strong>í•¨.</li></ul><h4 id=-3-ë©”ëª¨ë¦¬-ì‚¬ìš©ëŸ‰-ê· í˜•í™”>âœ… (3) ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ê· í˜•í™”</h4><ul><li>Output Layerê°€ ë§ˆì§€ë§‰ GPUì— ì§‘ì¤‘ë˜ì—ˆë˜ ê¸°ì¡´ ë°©ì‹ê³¼ ë‹¬ë¦¬, Vocabulary Layerë¥¼ ë‚˜ëˆ„ì–´ ì €ì¥í•˜ë¯€ë¡œ <strong>ê° GPUì˜ Parameter Memory ì‚¬ìš©ëŸ‰ì´ ê· ë“±í•´ì§</strong>.</li><li>ì´ë¥¼ í†µí•´ <strong>íŠ¹ì • GPUì—ì„œ ë°œìƒí•˜ëŠ” ë©”ëª¨ë¦¬ ë³‘ëª©ì„ í•´ì†Œ</strong>í•˜ì—¬ ëª¨ë¸ í¬ê¸° í™•ì¥ì´ ìš©ì´í•´ì§.</li></ul><hr><h3 id=3-vocabulary-parallelism-ì ìš©-ì‹œ-ì„±ëŠ¥-ê°œì„ -íš¨ê³¼>3ï¸âƒ£ Vocabulary Parallelism ì ìš© ì‹œ ì„±ëŠ¥ ê°œì„  íš¨ê³¼</h3><p>ë…¼ë¬¸ì—ì„œëŠ” ì‹¤í—˜ì„ í†µí•´ <strong>Throughput(ì—°ì‚° ì†ë„)ê³¼ Peak Memory(ìµœëŒ€ ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰)ê°€ í¬ê²Œ ê°œì„ ë¨</strong>ì„ ë³´ì˜€ë‹¤.</p><h4 id=-1-throughput-í–¥ìƒ-íš¨ê³¼>ğŸš€ (1) Throughput í–¥ìƒ íš¨ê³¼</h4><ul><li>ê¸°ì¡´ ë°©ì‹(Baseline PP)ì—ì„œëŠ” Vocabulary Sizeê°€ ì»¤ì§ˆìˆ˜ë¡ **Throughput(MFU, ëª¨ë¸ FLOPs Utilization)**ì´ ê¸‰ê²©íˆ ê°ì†Œí•˜ì˜€ë‹¤.</li><li>ë°˜ë©´, Vocabulary Parallelismì„ ì ìš©í•œ ê²½ìš°, GPU ê°„ ì—°ì‚°ì´ ê· ë“±í•´ì§€ë©´ì„œ <strong>Throughputì´ ìµœëŒ€ 51% í–¥ìƒ</strong>ë˜ì—ˆë‹¤.</li></ul><h5 id=-ì‹¤í—˜-ë°ì´í„°-throughput-ê°œì„ -íš¨ê³¼>ğŸ“Œ ì‹¤í—˜ ë°ì´í„° (Throughput ê°œì„  íš¨ê³¼)</h5><table><thead><tr><th>ë°©ë²•</th><th>Vocabulary Size</th><th>Throughput (MFU, %)</th></tr></thead><tbody><tr><td><strong>Baseline PP</strong></td><td>32K</td><td>52.80%</td></tr><tr><td><strong>Baseline PP</strong></td><td>256K</td><td>19.99%</td></tr><tr><td><strong>Vocabulary Parallelism</strong></td><td>32K</td><td><strong>57.70% (+9.3%)</strong></td></tr><tr><td><strong>Vocabulary Parallelism</strong></td><td>256K</td><td><strong>57.80% (+143%)</strong></td></tr></tbody></table><p><strong>ê²°ë¡ </strong>:<br>â†’ ê¸°ì¡´ PPëŠ” Vocabulary Sizeê°€ ì¦ê°€í• ìˆ˜ë¡ Throughputì´ ê¸‰ê°í•˜ì§€ë§Œ, Vocabulary Parallelism ì ìš© ì‹œ <strong>Vocab í¬ê¸°ì™€ ë¬´ê´€í•˜ê²Œ ì¼ì •í•œ ì„±ëŠ¥ ìœ ì§€ ê°€ëŠ¥</strong>.</p><hr><h4 id=-2-peak-memory-ì‚¬ìš©ëŸ‰-ì ˆê°-íš¨ê³¼>ğŸ’¾ (2) Peak Memory ì‚¬ìš©ëŸ‰ ì ˆê° íš¨ê³¼</h4><ul><li>ê¸°ì¡´ PPì—ì„œëŠ” Output Layerê°€ ë§ˆì§€ë§‰ GPUì— ëª°ë ¤ì„œ íŠ¹ì • GPUì˜ <strong>Memory ì‚¬ìš©ëŸ‰ì´ ë§¤ìš° ë†’ìŒ</strong>.</li><li>Vocabulary Parallelismì€ <strong>Output Layerë¥¼ ì—¬ëŸ¬ GPUì— ê· ë“± ë°°ì¹˜</strong>í•˜ì—¬, íŠ¹ì • GPUì— ì§‘ì¤‘ëœ ë©”ëª¨ë¦¬ ë¶€í•˜ë¥¼ í•´ì†Œí•¨.</li><li>ê²°ê³¼ì ìœ¼ë¡œ, <strong>Peak Memory ì‚¬ìš©ëŸ‰ì´ ìµœëŒ€ 50% ê°ì†Œ</strong>.</li></ul><h5 id=-ì‹¤í—˜-ë°ì´í„°-peak-memory-ì ˆê°-íš¨ê³¼>ğŸ“Œ ì‹¤í—˜ ë°ì´í„° (Peak Memory ì ˆê° íš¨ê³¼)</h5><table><thead><tr><th>ë°©ë²•</th><th>Vocabulary Size</th><th>Peak Memory (GB)</th></tr></thead><tbody><tr><td><strong>Baseline PP</strong></td><td>256K</td><td>46.77GB</td></tr><tr><td><strong>Vocabulary Parallelism</strong></td><td>256K</td><td><strong>15.02GB (ì•½ 68% ê°ì†Œ)</strong></td></tr></tbody></table><p><strong>ê²°ë¡ </strong>:<br>â†’ Output Layer ë©”ëª¨ë¦¬ë¥¼ ë¶„ì‚°í•˜ì—¬ <strong>íŠ¹ì • GPUì˜ Memory ì‚¬ìš©ëŸ‰ì„ 68% ì ˆê°</strong>, ë©”ëª¨ë¦¬ ë³‘ëª© í•´ì†Œ.</p><hr><h3 id=4-ì •ë¦¬-ë°-ê²°ë¡ >4ï¸âƒ£ ì •ë¦¬ ë° ê²°ë¡ </h3><table><thead><tr><th>ë¬¸ì œì </th><th>ê¸°ì¡´ PP ë°©ì‹(Baseline)</th><th>Vocabulary Parallelism ì ìš© ì‹œ ê°œì„  íš¨ê³¼</th></tr></thead><tbody><tr><td>ì—°ì‚° ë¶€í•˜ ë¶ˆê· í˜•</td><td>Output Layerê°€ ë§ˆì§€ë§‰ GPUì— ì§‘ì¤‘</td><td>ëª¨ë“  GPUì— Vocabulary Layer ê· ë“± ë¶„ì‚°</td></tr><tr><td>Pipeline Bubble</td><td>ë§ˆì§€ë§‰ GPUì—ì„œ ê³¼ë¶€í•˜ ë°œìƒ, GPU Idle ì‹œê°„ ì¦ê°€</td><td>ì—°ì‚°ì´ ê· ë“±í•´ì ¸ Pipeline Bubble ìµœì†Œí™”</td></tr><tr><td>Memory ë¶ˆê· í˜•</td><td>ë§ˆì§€ë§‰ GPUì—ì„œ Peak Memory ê¸‰ì¦</td><td>ëª¨ë“  GPUì˜ Memory ì‚¬ìš©ëŸ‰ ê· ë“±</td></tr><tr><td>Throughput (FLOPs Utilization)</td><td>Vocabulary í¬ê¸°ê°€ ì»¤ì§ˆìˆ˜ë¡ ê¸‰ê²©íˆ ì €í•˜</td><td><strong>ìµœëŒ€ 51% ì„±ëŠ¥ í–¥ìƒ</strong></td></tr><tr><td>Peak Memory ì‚¬ìš©ëŸ‰</td><td>íŠ¹ì • GPUì—ì„œ ë†’ì€ ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰</td><td><strong>ìµœëŒ€ 68% ë©”ëª¨ë¦¬ ì ˆê°</strong></td></tr></tbody></table><p><strong>ìµœì¢… ê²°ë¡ </strong>:<br>â†’ <strong>Vocabulary Parallelismì€ ê¸°ì¡´ PPì˜ ê·¼ë³¸ì ì¸ ì—°ì‚° ë° ë©”ëª¨ë¦¬ ë¶ˆê· í˜• ë¬¸ì œë¥¼ í•´ê²°í•˜ì—¬, LLM í•™ìŠµì˜ íš¨ìœ¨ì„±ì„ í¬ê²Œ í–¥ìƒì‹œí‚¤ëŠ” ê¸°ë²•ì´ë‹¤.</strong></p><h1 id=q--ë³¸-ë…¼ë¬¸ì—ì„œ-ì œì•ˆí•˜ëŠ”-algorithm-2ìµœì í™”ëœ-ë‹¨ì¼-communication-barrier-ë°©ì‹ê°€-ê¸°ì¡´-ë°©ë²•naive-ë°©ì‹-algorithm-1-ëŒ€ë¹„-ì—°ì‚°-ë°-í†µì‹ -ë¹„ìš©ì„-ì–´ë–»ê²Œ-ê°ì†Œì‹œí‚¤ëŠ”ì§€-ìˆ˜ì‹ê³¼-ì˜ˆì‹œë¥¼-ë“¤ì–´-ì„¤ëª…í•˜ì‹œì˜¤>Q : ë³¸ ë…¼ë¬¸ì—ì„œ ì œì•ˆí•˜ëŠ” Algorithm 2(ìµœì í™”ëœ ë‹¨ì¼ Communication Barrier ë°©ì‹)ê°€ ê¸°ì¡´ ë°©ë²•(naive ë°©ì‹, Algorithm 1) ëŒ€ë¹„ ì—°ì‚° ë° í†µì‹  ë¹„ìš©ì„ ì–´ë–»ê²Œ ê°ì†Œì‹œí‚¤ëŠ”ì§€ ìˆ˜ì‹ê³¼ ì˜ˆì‹œë¥¼ ë“¤ì–´ ì„¤ëª…í•˜ì‹œì˜¤.</h1><h2 id=-algorithm-2ìµœì í™”ëœ-ë‹¨ì¼-communication-barrier-ë°©ì‹-vs-ê¸°ì¡´-naive-ë°©ì‹algorithm-1>ğŸ“Œ Algorithm 2(ìµœì í™”ëœ ë‹¨ì¼ Communication Barrier ë°©ì‹) vs. ê¸°ì¡´ naive ë°©ì‹(Algorithm 1)</h2><p>ë³¸ ë…¼ë¬¸ì—ì„œëŠ” <strong>Output Layerì˜ Softmax ë° Gradient ì—°ì‚°ì„ ë³‘ë ¬í™”í•˜ë©´ì„œë„ í†µì‹  ë¹„ìš©ì„ ì¤„ì´ê¸° ìœ„í•´</strong> Algorithm 2ë¥¼ ì œì•ˆí–ˆë‹¤.<br>Algorithm 2ëŠ” ê¸°ì¡´ naive ë°©ì‹(Algorithm 1) ëŒ€ë¹„ <strong>í†µì‹  íšŸìˆ˜(Communication Barrier)ë¥¼ ìµœì†Œí™”í•˜ì—¬ ì—°ì‚° ë° ë©”ëª¨ë¦¬ ë¹„ìš©ì„ í¬ê²Œ ì¤„ì¸ë‹¤.</strong><br>ë‹¤ìŒì€ <strong>Algorithm 2ê°€ ê¸°ì¡´ ë°©ë²• ëŒ€ë¹„ ì–´ë–»ê²Œ ì—°ì‚° ë° í†µì‹  ë¹„ìš©ì„ ê°ì†Œì‹œí‚¤ëŠ”ì§€</strong>ë¥¼ <strong>ìˆ˜ì‹ê³¼ ì˜ˆì‹œë¥¼ í†µí•´ ìì„¸íˆ ì„¤ëª…</strong>í•œë‹¤.</p><hr><h2 id=1-ê¸°ì¡´-naive-ë°©ì‹-algorithm-1ì˜-ë¬¸ì œì >1ï¸âƒ£ ê¸°ì¡´ naive ë°©ì‹ (Algorithm 1)ì˜ ë¬¸ì œì </h2><h3 id=-ê¸°ì¡´-ë°©ì‹-algorithm-1-ì˜-ì—°ì‚°-íë¦„>ğŸ”¹ ê¸°ì¡´ ë°©ì‹ (Algorithm 1) ì˜ ì—°ì‚° íë¦„</h3><p>ê¸°ì¡´ naive ë°©ì‹ì—ì„œëŠ” <strong>Softmax ì—°ì‚°ì„ ìœ„í•´ 3ë²ˆì˜ All-Reduce í†µì‹ ì´ í•„ìš”</strong>í–ˆë‹¤.<br>ì¦‰, <strong>ê° GPUê°€ Vocabulary Layerì˜ ì¼ë¶€ë§Œ ê³„ì‚°í•˜ê³ , Softmax ë° Backwardë¥¼ ìœ„í•´ ì„œë¡œ ë°ì´í„°ë¥¼ ê³µìœ í•´ì•¼ í•¨</strong>.</p><ul><li><p><strong>Forward ì—°ì‚°</strong><br>[
Y = X W^T
]</p><ul><li>(X) : Transformer Layer ì¶œë ¥ ê°’ ((b \times h))</li><li>(W) : Embedding ê°€ì¤‘ì¹˜ ((V \times h))</li><li>(Y) : Output Logits ((b \times V))</li></ul></li><li><p><strong>Softmax ê³„ì‚° (3ë‹¨ê³„ í†µì‹  í¬í•¨)</strong></p><ol><li><strong>Max ê³„ì‚°ì„ ìœ„í•œ All-Reduce (Barrier 1)</strong><ul><li>Local ìµœëŒ€ê°’ (m&rsquo;<em>i = \max</em>{k} Y_{ik}) ê³„ì‚° í›„,<br>[
m_i = \text{AllReduce} (m&rsquo;_i)
]</li></ul></li><li><strong>Sum ê³„ì‚°ì„ ìœ„í•œ All-Reduce (Barrier 2)</strong><ul><li>Softmaxì˜ ë¶„ëª¨ ê³„ì‚°:<br>[
s&rsquo;<em>i = \sum_k e^{Y</em>{ik} - m_i}
]
[
s_i = \text{AllReduce} (s&rsquo;_i)
]</li></ul></li><li><strong>Gradient ì „íŒŒë¥¼ ìœ„í•œ All-Reduce (Barrier 3)</strong><ul><li>Backwardì—ì„œ (âˆ‡X) ì—…ë°ì´íŠ¸ ì‹œ ì¶”ê°€ì ì¸ í†µì‹  í•„ìš”<br>[
âˆ‡X = \text{AllReduce} (âˆ‡X&rsquo;)
]</li></ul></li></ol></li></ul><h4 id=-ë¬¸ì œì >ğŸš¨ ë¬¸ì œì :</h4><ol><li><strong>ì´ 3ë²ˆì˜ All-Reduce í†µì‹  ë°œìƒ</strong> â†’ <strong>í†µì‹  ë¹„ìš© ì¦ê°€</strong></li><li><strong>Softmax ì—°ì‚°ì—ì„œ GPU ê°„ ë™ê¸°í™”ê°€ ë§ì•„ ì„±ëŠ¥ ì €í•˜</strong></li><li><strong>Activation Memory ì‚¬ìš© ì¦ê°€</strong> (í†µì‹  ëŒ€ê¸° ì¤‘ ì¶”ê°€ ì €ì¥ ê³µê°„ í•„ìš”)</li></ol><hr><h2 id=2-algorithm-2ìµœì í™”ëœ-ë‹¨ì¼-communication-barrier-ë°©ì‹ì˜-ê°œì„ >2ï¸âƒ£ Algorithm 2(ìµœì í™”ëœ ë‹¨ì¼ Communication Barrier ë°©ì‹)ì˜ ê°œì„ </h2><p>Algorithm 2ëŠ” ê¸°ì¡´ ë°©ì‹ì—ì„œ ë°œìƒí•˜ëŠ” <strong>3ë²ˆì˜ Communication Barrierë¥¼ 1ë²ˆìœ¼ë¡œ ì¤„ì´ëŠ” ìµœì í™” ê¸°ë²•</strong>ì´ë‹¤.</p><h3 id=-algorithm-2ì˜-ì—°ì‚°-íë¦„>ğŸ”¹ Algorithm 2ì˜ ì—°ì‚° íë¦„</h3><ol><li><p><strong>Local Softmax ê³„ì‚° (GPU ë‚´ ì—°ì‚°, í†µì‹  ì—†ìŒ)</strong><br>[
m&rsquo;<em>i = \max</em>{k} Y_{ik}
]
[
s&rsquo;<em>i = \sum_k e^{Y</em>{ik} - m&rsquo;_i}
]</p></li><li><p><strong>All-Reduceë¥¼ í•œ ë²ˆë§Œ ìˆ˜í–‰ (Barrier 1)</strong></p><ul><li>ê¸°ì¡´ naive ë°©ì‹ì—ì„œëŠ” Max, Sum, Gradient ê°ê°ì— ëŒ€í•´ All-Reduceë¥¼ ìˆ˜í–‰í–ˆì§€ë§Œ, Algorithm 2ì—ì„œëŠ” <strong>Maxì™€ Sumì„ ë¯¸ë¦¬ ë¡œì»¬ì—ì„œ ê³„ì‚°í•œ í›„, í•œ ë²ˆì˜ All-Reduceë¡œ í•´ê²°</strong>.
[
(m_i, s_i) = \text{AllReduce} (m&rsquo;_i, s&rsquo;_i)
]</li></ul></li><li><p><strong>ìµœì í™”ëœ Backward ì—°ì‚° (ê³„ì‚°ëŸ‰ ìµœì†Œí™”)</strong></p><ul><li>Softmax ì—°ì‚° í›„ <strong>Gradientë¥¼ ë¯¸ë¦¬ ê³„ì‚°</strong>í•´ ë¶ˆí•„ìš”í•œ ì¶”ê°€ í†µì‹  ì œê±°.
[
âˆ‡X = (softmax&rsquo;(Y)W) Ã— \frac{s&rsquo;_i e^{m&rsquo;_i - m_i}}{s_i} - GW
]</li></ul></li><li><p><strong>Weight GradientëŠ” ë’¤ë¡œ ë¯¸ë£° ìˆ˜ ìˆìŒ</strong></p><ul><li>(\nabla W) ì—°ì‚°ì€ ë‹¤ë¥¸ Layerì— ì˜í–¥ì„ ì£¼ì§€ ì•Šìœ¼ë¯€ë¡œ, ì¶”ê°€ì ì¸ Synchronization ì—†ì´ ë§ˆì§€ë§‰ì— ìˆ˜í–‰ ê°€ëŠ¥.</li></ul></li></ol><hr><h2 id=3-ìˆ˜ì‹ê³¼-ì˜ˆì‹œë¥¼-í†µí•œ-ë¹„êµ-ë¶„ì„>3ï¸âƒ£ ìˆ˜ì‹ê³¼ ì˜ˆì‹œë¥¼ í†µí•œ ë¹„êµ ë¶„ì„</h2><h3 id=-ì˜ˆì‹œ-4ê°œì˜-gpuì—ì„œ-output-layerì˜-ì—°ì‚°ì„-ë¶„í• í•˜ëŠ”-ê²½ìš°>ğŸ“Œ ì˜ˆì‹œ: 4ê°œì˜ GPUì—ì„œ Output Layerì˜ ì—°ì‚°ì„ ë¶„í• í•˜ëŠ” ê²½ìš°</h3><h4 id=1-ê¸°ì¡´-ë°©ì‹-algorithm-1ì˜-ì—°ì‚°-ê³¼ì •><strong>(1) ê¸°ì¡´ ë°©ì‹ (Algorithm 1)ì˜ ì—°ì‚° ê³¼ì •</strong></h4><ul><li>(V = 8), GPU ìˆ˜ = 4 â†’ ê° GPUëŠ” 2ê°œì˜ Vocabulary Tokenì„ ë‹´ë‹¹</li><li>Forward ì—°ì‚°ì„ ë§ˆì¹œ í›„ Softmax ê³„ì‚°ì„ ìœ„í•œ <strong>3ë²ˆì˜ í†µì‹  ìˆ˜í–‰</strong></li></ul><table><thead><tr><th>ë‹¨ê³„</th><th>ì—°ì‚° ë°©ì‹</th><th>í†µì‹  ë¹„ìš© (All-Reduce)</th></tr></thead><tbody><tr><td>Forward</td><td>(Y = X W^T)</td><td>ì—†ìŒ</td></tr><tr><td>Softmax max</td><td>(m&rsquo;<em>i = \max_k Y</em>{ik})</td><td><strong>Barrier 1</strong></td></tr><tr><td>Softmax sum</td><td>(s&rsquo;<em>i = \sum_k e^{Y</em>{ik} - m_i})</td><td><strong>Barrier 2</strong></td></tr><tr><td>Softmax normalize</td><td>(softmax(Y))</td><td>ì—†ìŒ</td></tr><tr><td>Backward</td><td>(âˆ‡X = (softmax(Y) - G) W)</td><td><strong>Barrier 3</strong></td></tr></tbody></table><h4 id=2-algorithm-2ì˜-ì—°ì‚°-ê³¼ì •><strong>(2) Algorithm 2ì˜ ì—°ì‚° ê³¼ì •</strong></h4><ul><li>ë™ì¼í•œ Vocab ë¶„í•  ìƒí™©ì—ì„œ <strong>í•œ ë²ˆì˜ í†µì‹ ìœ¼ë¡œ í•´ê²°</strong></li></ul><table><thead><tr><th>ë‹¨ê³„</th><th>ì—°ì‚° ë°©ì‹</th><th>í†µì‹  ë¹„ìš© (All-Reduce)</th></tr></thead><tbody><tr><td>Forward</td><td>(Y = X W^T)</td><td>ì—†ìŒ</td></tr><tr><td>Softmax max & sum</td><td>(m&rsquo;_i, s&rsquo;_i) ê³„ì‚° í›„ All-Reduce</td><td><strong>Barrier 1 (í†µí•©)</strong></td></tr><tr><td>Softmax normalize</td><td>(softmax(Y))</td><td>ì—†ìŒ</td></tr><tr><td>Backward</td><td>(âˆ‡X) ì—…ë°ì´íŠ¸</td><td>ì—†ìŒ (ë¯¸ë¦¬ ê³„ì‚°)</td></tr></tbody></table><h4 id=-ê²°ê³¼-ë¹„êµ>ğŸš€ <strong>ê²°ê³¼ ë¹„êµ</strong></h4><ul><li>ê¸°ì¡´ ë°©ì‹: <strong>ì´ 3ë²ˆì˜ í†µì‹ </strong></li><li>Algorithm 2: <strong>ë‹¨ 1ë²ˆì˜ í†µì‹ ìœ¼ë¡œ ëª¨ë“  ì—°ì‚° í•´ê²°</strong></li><li><strong>GPU ê°„ ë™ê¸°í™” ì‹œê°„ ê°ì†Œ â†’ ì „ì²´ì ì¸ í•™ìŠµ ì†ë„ ìµœëŒ€ 51% í–¥ìƒ</strong></li></ul><hr><h2 id=4-algorithm-2ì˜-ì„±ëŠ¥-í–¥ìƒ-íš¨ê³¼-ë¶„ì„>4ï¸âƒ£ Algorithm 2ì˜ ì„±ëŠ¥ í–¥ìƒ íš¨ê³¼ ë¶„ì„</h2><h3 id=1-communication-overhead-ê°ì†Œ><strong>(1) Communication Overhead ê°ì†Œ</strong></h3><ul><li>ê¸°ì¡´ ë°©ì‹(naive)ì€ <strong>3ë²ˆì˜ All-Reduceë¥¼ ìˆ˜í–‰í•´ì•¼ í•˜ë¯€ë¡œ, í†µì‹  ë³‘ëª©ì´ ë°œìƒ</strong></li><li>Algorithm 2ëŠ” <strong>í•œ ë²ˆì˜ All-Reduceë¡œ ëª¨ë“  Softmax ë° Gradient ì—°ì‚°ì„ í•´ê²°</strong><br>â†’ <strong>í†µì‹  ë¹„ìš© ìµœëŒ€ 3ë°° ì ˆê°</strong></li></ul><h3 id=2-memory-usage-ì ˆê°><strong>(2) Memory Usage ì ˆê°</strong></h3><ul><li>ê¸°ì¡´ ë°©ì‹ì€ <strong>ê° ë‹¨ê³„ë§ˆë‹¤ Activation ì €ì¥ì´ í•„ìš”</strong>í•˜ì—¬ ë©”ëª¨ë¦¬ ì†Œë¹„ê°€ í¼</li><li>Algorithm 2ëŠ” <strong>Softmax ì¤‘ê°„ ê²°ê³¼ë¥¼ ì €ì¥í•˜ì§€ ì•Šê³  ì¦‰ì‹œ ì—°ì‚°</strong><br>â†’ <strong>Activation Memory ì‚¬ìš©ëŸ‰ ê°ì†Œ (ìµœëŒ€ Microbatch 1~2ê°œ ì ˆì•½)</strong></li></ul><h3 id=3-throughputflops-utilization-ì¦ê°€><strong>(3) Throughput(FLOPs Utilization) ì¦ê°€</strong></h3><ul><li>ê¸°ì¡´ ë°©ì‹ì€ All-Reduceê°€ ë§ì•„ <strong>GPUê°€ ì—°ì‚°ì„ ëŒ€ê¸°í•˜ëŠ” ì‹œê°„ì´ ì¦ê°€</strong></li><li>Algorithm 2ëŠ” ì—°ì‚°ê³¼ í†µì‹ ì„ ìµœì í™”í•˜ì—¬ <strong>GPU Utilizationì„ ê·¹ëŒ€í™”</strong><br>â†’ <strong>ë…¼ë¬¸ ì‹¤í—˜ ê²°ê³¼, Throughput ìµœëŒ€ 51% ì¦ê°€</strong></li></ul><hr><h2 id=5-ê²°ë¡ -ìµœì í™”-íš¨ê³¼-ìš”ì•½>5ï¸âƒ£ ê²°ë¡  (ìµœì í™” íš¨ê³¼ ìš”ì•½)</h2><table><thead><tr><th>ë¹„êµ í•­ëª©</th><th>ê¸°ì¡´ ë°©ì‹ (Algorithm 1)</th><th><strong>ìµœì í™”ëœ ë°©ì‹ (Algorithm 2)</strong></th></tr></thead><tbody><tr><td>Communication Barrier</td><td><strong>3ë²ˆ (Max, Sum, Gradient)</strong></td><td><strong>1ë²ˆ (Max + Sum)</strong></td></tr><tr><td>Memory ì‚¬ìš©ëŸ‰</td><td>ë†’ìŒ (ì¤‘ê°„ ê²°ê³¼ ì €ì¥ í•„ìš”)</td><td>ê°ì†Œ (ì¦‰ì‹œ ì—°ì‚°ìœ¼ë¡œ ì €ì¥ ìµœì†Œí™”)</td></tr><tr><td>Throughput (FLOPs Utilization)</td><td>ë‚®ìŒ (GPU Idle ì‹œê°„ ì¦ê°€)</td><td><strong>ìµœëŒ€ 51% ì„±ëŠ¥ í–¥ìƒ</strong></td></tr><tr><td>Activation Memory</td><td>ë†’ìŒ</td><td><strong>ìµœëŒ€ Microbatch 2ê°œ ì ˆê°</strong></td></tr></tbody></table><p>â†’ <strong>Algorithm 2ëŠ” ê¸°ì¡´ ë°©ì‹ ëŒ€ë¹„ í†µì‹  ì˜¤ë²„í—¤ë“œë¥¼ 3ë°° ì ˆê°í•˜ê³ , ì „ì²´ ì—°ì‚° ì†ë„ë¥¼ 51% ê°œì„ í•˜ëŠ” ìµœì í™”ëœ ë°©ë²•ì´ë‹¤.</strong></p><h1 id=q--ë…¼ë¬¸ì—ì„œ-ì œì‹œí•œ-ë°©ë²•ì˜-í•œê³„ì communication-overhead-input-layer-íš¨ìœ¨-ë¬¸ì œ-activation-memory-ì¦ê°€ì„-ê·¹ë³µí•˜ê¸°-ìœ„í•œ-ìµœì‹ -ì—°êµ¬-ë°©í–¥ê³¼-ì´ë¥¼-ì ìš©í–ˆì„-ë•Œ-ê¸°ëŒ€í• -ìˆ˜-ìˆëŠ”-ì„±ëŠ¥-í–¥ìƒì„-êµ¬ì²´ì ìœ¼ë¡œ-ë…¼í•˜ì‹œì˜¤>Q : ë…¼ë¬¸ì—ì„œ ì œì‹œí•œ ë°©ë²•ì˜ í•œê³„ì (Communication Overhead, Input Layer íš¨ìœ¨ ë¬¸ì œ, Activation Memory ì¦ê°€)ì„ ê·¹ë³µí•˜ê¸° ìœ„í•œ ìµœì‹  ì—°êµ¬ ë°©í–¥ê³¼ ì´ë¥¼ ì ìš©í–ˆì„ ë•Œ ê¸°ëŒ€í•  ìˆ˜ ìˆëŠ” ì„±ëŠ¥ í–¥ìƒì„ êµ¬ì²´ì ìœ¼ë¡œ ë…¼í•˜ì‹œì˜¤.</h1><h2 id=-ë…¼ë¬¸ì—ì„œ-ì œì‹œí•œ-ë°©ë²•ì˜-í•œê³„ì -ë°-ê·¹ë³µì„-ìœ„í•œ-ìµœì‹ -ì—°êµ¬-ë°©í–¥>ğŸ“Œ ë…¼ë¬¸ì—ì„œ ì œì‹œí•œ ë°©ë²•ì˜ í•œê³„ì  ë° ê·¹ë³µì„ ìœ„í•œ ìµœì‹  ì—°êµ¬ ë°©í–¥</h2><p>ë³¸ ë…¼ë¬¸ì—ì„œ ì œì‹œí•œ **Vocabulary Parallelism(VP)**ì€ <strong>Pipeline Parallelism(PP)ì—ì„œ ë°œìƒí•˜ëŠ” ì—°ì‚° ë° ë©”ëª¨ë¦¬ ë¶ˆê· í˜• ë¬¸ì œë¥¼ íš¨ê³¼ì ìœ¼ë¡œ í•´ê²°</strong>í•˜ì˜€ì§€ë§Œ, ë‹¤ìŒê³¼ ê°™ì€ í•œê³„ì ì´ ë‚¨ì•„ ìˆë‹¤.</p><table><thead><tr><th>í•œê³„ì </th><th>ì›ì¸</th><th>ì˜í–¥</th></tr></thead><tbody><tr><td><strong>1. Communication Overhead</strong></td><td>Vocabulary Parallelismì€ Softmax ì—°ì‚°ì„ ìœ„í•´ <strong>All-Reduce í†µì‹ ì´ í•„ìˆ˜ì </strong></td><td>GPU ê°„ í†µì‹  ë³‘ëª©ìœ¼ë¡œ í•™ìŠµ ì†ë„ ì €í•˜</td></tr><tr><td><strong>2. Input Layer ë³‘ë ¬í™” íš¨ìœ¨ ë¬¸ì œ</strong></td><td>Output LayerëŠ” ë³‘ë ¬í™”ê°€ ì˜ ë˜ì§€ë§Œ, Input Layerì˜ íš¨ìœ¨ì„±ì€ ìƒëŒ€ì ìœ¼ë¡œ ë‚®ìŒ</td><td>í•™ìŠµ ê³¼ì •ì—ì„œ ë³‘ë ¬í™”ì˜ íš¨ê³¼ê°€ ì œí•œë¨</td></tr><tr><td><strong>3. Activation Memory ì¦ê°€</strong></td><td>Softmax ì—°ì‚°ì„ ìœ„í•œ ì¤‘ê°„ í™œì„±í™” ê°’ì´ ì¦ê°€í•˜ì—¬ ì¶”ê°€ì ì¸ ë©”ëª¨ë¦¬ í•„ìš”</td><td>Large Batch í•™ìŠµ ì‹œ GPU ë©”ëª¨ë¦¬ ë¶€ì¡± ë°œìƒ</td></tr></tbody></table><p>ì´ëŸ¬í•œ í•œê³„ë¥¼ ê·¹ë³µí•˜ê¸° ìœ„í•´ <strong>ìµœì‹  ì—°êµ¬ ë°©í–¥</strong>ì„ ë¶„ì„í•˜ê³ , ê°ê°ì„ ì ìš©í–ˆì„ ë•Œì˜ <strong>ê¸°ëŒ€ ì„±ëŠ¥ í–¥ìƒ íš¨ê³¼</strong>ë¥¼ ë…¼ì˜í•œë‹¤.</p><hr><h1 id=-1-communication-overhead-í•´ê²°ì„-ìœ„í•œ-ìµœì‹ -ì—°êµ¬>ğŸš€ 1ï¸âƒ£ Communication Overhead í•´ê²°ì„ ìœ„í•œ ìµœì‹  ì—°êµ¬</h1><h3 id=-ë¬¸ì œ-ë¶„ì„>ğŸ“Œ ë¬¸ì œ ë¶„ì„</h3><ul><li><strong>Vocabulary Parallelismì—ì„œëŠ” Softmax ì—°ì‚°ì„ ìœ„í•´ í•„ìˆ˜ì ì¸ All-Reduce í†µì‹ ì´ ë°œìƒ</strong>í•¨.</li><li>íŠ¹íˆ <strong>GPU ìˆ˜ê°€ ì¦ê°€í• ìˆ˜ë¡ í†µì‹  ì˜¤ë²„í—¤ë“œê°€ ë¹„ì„ í˜•ì ìœ¼ë¡œ ì¦ê°€</strong>í•˜ì—¬ íš¨ìœ¨ì„±ì´ ë–¨ì–´ì§.</li><li>ë…¼ë¬¸ ì‹¤í—˜ ê²°ê³¼, <strong>All-Reduceë¡œ ì¸í•´ ì „ì²´ í•™ìŠµ ì‹œê°„ì˜ 11%ê°€ Idle Timeìœ¼ë¡œ ë‚­ë¹„ë¨</strong>.</li></ul><h3 id=-í•´ê²°-ë°©ì•ˆ---ë¹„ë™ê¸°ì‹asynchronous-í†µì‹ -ì ìš©>âœ… í•´ê²° ë°©ì•ˆ â‘  : ë¹„ë™ê¸°ì‹(Asynchronous) í†µì‹  ì ìš©</h3><ul><li>ê¸°ì¡´ì˜ All-ReduceëŠ” <strong>ë™ê¸°ì‹(Synchronous) í†µì‹  ë°©ì‹</strong>ìœ¼ë¡œ, ëª¨ë“  GPUê°€ ë°ì´í„°ë¥¼ êµí™˜í•  ë•Œê¹Œì§€ ê¸°ë‹¤ë ¤ì•¼ í•¨.</li><li>ìµœì‹  ì—°êµ¬ì—ì„œëŠ” <strong>ë¹„ë™ê¸°ì‹(Asynchronous) All-Reduce</strong>ë¥¼ ì ìš©í•˜ì—¬ **ê³„ì‚°ê³¼ í†µì‹ ì„ ê²¹ì³ ìˆ˜í–‰(Overlapping)**í•˜ëŠ” ë°©ì•ˆì„ ì œì•ˆ.</li><li>ì´ë¥¼ ì ìš©í•˜ë©´ <strong>Pipeline Bubbleì„ ì¤„ì´ê³ , GPU ì‚¬ìš©ë¥ ì„ ë†’ì¼ ìˆ˜ ìˆìŒ</strong>.</li></ul><h4 id=-ê¸°ëŒ€-íš¨ê³¼>ğŸ”¹ ê¸°ëŒ€ íš¨ê³¼</h4><table><thead><tr><th>í•­ëª©</th><th>ê¸°ì¡´ ë°©ì‹</th><th>ë¹„ë™ê¸° í†µì‹  ì ìš© ì‹œ ì˜ˆìƒ íš¨ê³¼</th></tr></thead><tbody><tr><td><strong>GPU Idle Time</strong></td><td>11%</td><td><strong>5% ì´í•˜ë¡œ ê°ì†Œ</strong></td></tr><tr><td><strong>Throughput (MFU, FLOPs Utilization)</strong></td><td>57.8% (32 GPU)</td><td><strong>63<del>68% ì˜ˆìƒ (+10</del>15% ì¦ê°€)</strong></td></tr></tbody></table><hr><h3 id=-í•´ê²°-ë°©ì•ˆ---hierarchical-all-reduce-ê³„ì¸µì -í†µì‹ >âœ… í•´ê²° ë°©ì•ˆ â‘¡ : Hierarchical All-Reduce (ê³„ì¸µì  í†µì‹ )</h3><ul><li><strong>NCCL ë° Horovod</strong>ì™€ ê°™ì€ ìµœì‹  ë¶„ì‚° í•™ìŠµ í”„ë ˆì„ì›Œí¬ì—ì„œëŠ” <strong>Hierarchical All-Reduce</strong>ë¥¼ ì ìš©í•˜ì—¬ <strong>ë…¸ë“œ ë‚´ í†µì‹ ê³¼ ë…¸ë“œ ê°„ í†µì‹ ì„ ë¶„ë¦¬</strong>í•  ìˆ˜ ìˆìŒ.</li><li>ê¸°ì¡´ì—ëŠ” <strong>ëª¨ë“  GPUê°€ All-Reduceë¥¼ ìˆ˜í–‰í•´ì•¼ í–ˆì§€ë§Œ</strong>, ì´ ë°©ë²•ì„ ì ìš©í•˜ë©´ <strong>ê° ë…¸ë“œ(ì„œë²„)ì—ì„œ ë¨¼ì € Partial Reduceë¥¼ ìˆ˜í–‰í•œ í›„, ìµœì¢…ì ìœ¼ë¡œ ë…¸ë“œ ê°„ í†µì‹ ì„ ìˆ˜í–‰</strong>.</li><li>ì´ëŠ” <strong>íŠ¹íˆ 32ê°œ ì´ìƒì˜ GPUë¥¼ ì‚¬ìš©í•  ë•Œ íš¨ê³¼ì </strong>ì´ë©°, í†µì‹  ë³‘ëª©ì„ ì¤„ì¼ ìˆ˜ ìˆìŒ.</li></ul><h4 id=-ê¸°ëŒ€-íš¨ê³¼-1>ğŸ”¹ ê¸°ëŒ€ íš¨ê³¼</h4><table><thead><tr><th>í•­ëª©</th><th>ê¸°ì¡´ ë°©ì‹</th><th>Hierarchical All-Reduce ì ìš© ì‹œ ì˜ˆìƒ íš¨ê³¼</th></tr></thead><tbody><tr><td><strong>All-Reduce Latency</strong></td><td>100% (ê¸°ì¤€)</td><td><strong>ìµœëŒ€ 50% ë‹¨ì¶•</strong></td></tr><tr><td><strong>í†µì‹  ì˜¤ë²„í—¤ë“œ ë¹„ìœ¨</strong></td><td>11%</td><td><strong>5~6%ë¡œ ì ˆë°˜ ê°ì†Œ</strong></td></tr><tr><td><strong>ì „ì²´ í•™ìŠµ ì†ë„</strong></td><td>1.0x</td><td><strong>1.2~1.5x ê°€ì† íš¨ê³¼</strong></td></tr></tbody></table><hr><h1 id=-2-input-layer-ë³‘ë ¬í™”-íš¨ìœ¨-ë¬¸ì œ-í•´ê²°>ğŸš€ 2ï¸âƒ£ Input Layer ë³‘ë ¬í™” íš¨ìœ¨ ë¬¸ì œ í•´ê²°</h1><h3 id=-ë¬¸ì œ-ë¶„ì„-1>ğŸ“Œ ë¬¸ì œ ë¶„ì„</h3><ul><li>Output LayerëŠ” Vocabulary Parallelismì„ í†µí•´ íš¨ê³¼ì ìœ¼ë¡œ ë¶„ì‚°ë˜ì—ˆì§€ë§Œ, <strong>Input LayerëŠ” ì—¬ì „íˆ GPU íš¨ìœ¨ì„±ì´ ë‚®ìŒ</strong>.</li><li>ë…¼ë¬¸ ì‹¤í—˜ ê²°ê³¼, <strong>Input Layer ë³‘ë ¬í™” íš¨ìœ¨ì´ 32 GPU í™˜ê²½ì—ì„œ 8.35%ê¹Œì§€ ë‚®ì•„ì§€ëŠ” ë¬¸ì œ</strong>ê°€ ë°œìƒ.</li></ul><h3 id=-í•´ê²°-ë°©ì•ˆ---fused-embedding-kernel-ì ìš©>âœ… í•´ê²° ë°©ì•ˆ â‘  : Fused Embedding Kernel ì ìš©</h3><ul><li>NVIDIA FasterTransformerì—ì„œëŠ” **Embedding ì—°ì‚°ì„ CUDA Kernel ìˆ˜ì¤€ì—ì„œ ìµœì í™”(Fused Kernel ì ìš©)**í•˜ì—¬ <strong>GPU ë©”ëª¨ë¦¬ ì ‘ê·¼ì„ ìµœì†Œí™”</strong>í•˜ëŠ” ì—°êµ¬ë¥¼ ì§„í–‰.</li><li>ì´ ê¸°ë²•ì„ ì ìš©í•˜ë©´ <strong>Embedding Lookup, MatMul ì—°ì‚°ì„ í•˜ë‚˜ì˜ Kernelì—ì„œ ì²˜ë¦¬</strong>í•˜ì—¬ <strong>ë©”ëª¨ë¦¬ ë³‘ëª©ì„ ì¤„ì´ê³  ë³‘ë ¬í™”ë¥¼ ê·¹ëŒ€í™”</strong>í•  ìˆ˜ ìˆìŒ.</li></ul><h4 id=-ê¸°ëŒ€-íš¨ê³¼-2>ğŸ”¹ ê¸°ëŒ€ íš¨ê³¼</h4><table><thead><tr><th>í•­ëª©</th><th>ê¸°ì¡´ ë°©ì‹</th><th>Fused Embedding Kernel ì ìš© ì‹œ ì˜ˆìƒ íš¨ê³¼</th></tr></thead><tbody><tr><td><strong>Input Layer ì²˜ë¦¬ ì†ë„</strong></td><td>8.35% (ë¹„íš¨ìœ¨ì )</td><td><strong>ìµœëŒ€ 30%+ ì˜ˆìƒ (ì•½ 3.6ë°° ê°œì„ )</strong></td></tr><tr><td><strong>GPU Utilization</strong></td><td>ë‚®ìŒ (Input Layerì—ì„œ ë³‘ëª© ë°œìƒ)</td><td><strong>ì „ì²´ì ì¸ GPU Utilization ì¦ê°€</strong></td></tr><tr><td><strong>ì „ì²´ í•™ìŠµ ì†ë„ í–¥ìƒ</strong></td><td>1.0x</td><td><strong>1.1~1.3x ê°œì„  ê°€ëŠ¥</strong></td></tr></tbody></table><hr><h3 id=-í•´ê²°-ë°©ì•ˆ---mixed-precision-í™œìš©-fp16--int8>âœ… í•´ê²° ë°©ì•ˆ â‘¡ : Mixed Precision í™œìš© (FP16 & INT8)</h3><ul><li>Input Embedding LayerëŠ” **Floating-Point ì—°ì‚°(FP32)**ì„ ë§ì´ í¬í•¨í•˜ê³  ìˆì–´ ì—°ì‚°ì´ ëŠë¦¼.</li><li>ìµœê·¼ ì—°êµ¬ì—ì„œëŠ” <strong>Mixed Precision (FP16 & INT8 Quantization)</strong> ê¸°ë²•ì„ ì ìš©í•˜ì—¬ <strong>ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ì„ ì¤„ì´ê³  ì—°ì‚° ì†ë„ë¥¼ ë†’ì´ëŠ” ë°©ë²•</strong>ì´ ì œì•ˆë¨.</li><li><strong>DeepSpeed ZeRO-Offload</strong> ë° <strong>NVIDIA TensorRT</strong> ê¸°ë°˜ìœ¼ë¡œ <strong>FP16 ë° INT8 Quantizationì„ ì ìš©í•˜ë©´, ì—°ì‚° ì†ë„ê°€ 2~4ë°° ì¦ê°€ ê°€ëŠ¥</strong>.</li></ul><h4 id=-ê¸°ëŒ€-íš¨ê³¼-3>ğŸ”¹ ê¸°ëŒ€ íš¨ê³¼</h4><table><thead><tr><th>í•­ëª©</th><th>ê¸°ì¡´ ë°©ì‹</th><th>Mixed Precision ì ìš© ì‹œ ì˜ˆìƒ íš¨ê³¼</th></tr></thead><tbody><tr><td><strong>Input Embedding ì—°ì‚° ì†ë„</strong></td><td>1.0x</td><td><strong>1.8~3.5x ì†ë„ í–¥ìƒ</strong></td></tr><tr><td><strong>Memory ì‚¬ìš©ëŸ‰</strong></td><td>100% (FP32)</td><td><strong>50% ê°ì†Œ (FP16)</strong></td></tr><tr><td><strong>ì „ì²´ Throughput í–¥ìƒ</strong></td><td>1.0x</td><td><strong>1.2~1.5x ì˜ˆìƒ</strong></td></tr></tbody></table><hr><h1 id=-3-activation-memory-ì¦ê°€-ë¬¸ì œ-í•´ê²°>ğŸš€ 3ï¸âƒ£ Activation Memory ì¦ê°€ ë¬¸ì œ í•´ê²°</h1><h3 id=-ë¬¸ì œ-ë¶„ì„-2>ğŸ“Œ ë¬¸ì œ ë¶„ì„</h3><ul><li>Algorithm 2ë¥¼ ì ìš©í•´ë„ Softmax ì—°ì‚° ê³¼ì •ì—ì„œ <strong>Activation Memoryê°€ Microbatch 1~2ê°œ ë¶„ëŸ‰ë§Œí¼ ì¦ê°€</strong>í•˜ëŠ” ë¬¸ì œê°€ ìˆìŒ.</li><li>ì´ëŠ” <strong>Large Batch í•™ìŠµ ì‹œ GPU ë©”ëª¨ë¦¬ ë¶€ì¡±ì„ ì´ˆë˜</strong>í•  ê°€ëŠ¥ì„±ì´ ìˆìŒ.</li></ul><h3 id=-í•´ê²°-ë°©ì•ˆ---activation-recomputation-ì ìš©-gradient-checkpointing>âœ… í•´ê²° ë°©ì•ˆ â‘  : Activation Recomputation ì ìš© (Gradient Checkpointing)</h3><ul><li><strong>Activation Recomputation</strong> ê¸°ë²•ì€ <strong>ì¤‘ê°„ Activationì„ ì €ì¥í•˜ì§€ ì•Šê³ , í•„ìš”í•  ë•Œ ë‹¤ì‹œ ê³„ì‚°í•˜ëŠ” ë°©ì‹</strong>ìœ¼ë¡œ ë©”ëª¨ë¦¬ë¥¼ ì ˆì•½í•˜ëŠ” ê¸°ìˆ .</li><li>íŠ¹íˆ <strong>FlashAttention</strong>(Stanford ì—°êµ¬ì§„)ì´ ì œì•ˆí•œ ë°©ì‹ì—ì„œëŠ” <strong>Softmax ê³¼ì •ì—ì„œë„ Activationì„ ì €ì¥í•˜ì§€ ì•Šê³  í•„ìš”í•  ë•Œ ì¬ê³„ì‚°í•˜ëŠ” ë°©ì‹</strong>ì„ ì ìš©í•˜ì—¬ <strong>ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ì„ ìµœëŒ€ 90% ì ˆì•½</strong>í•  ìˆ˜ ìˆìŒ.</li></ul><h4 id=-ê¸°ëŒ€-íš¨ê³¼-4>ğŸ”¹ ê¸°ëŒ€ íš¨ê³¼</h4><table><thead><tr><th>í•­ëª©</th><th>ê¸°ì¡´ ë°©ì‹</th><th>Activation Recomputation ì ìš© ì‹œ ì˜ˆìƒ íš¨ê³¼</th></tr></thead><tbody><tr><td><strong>Activation Memory ì‚¬ìš©ëŸ‰</strong></td><td>ë†’ìŒ</td><td><strong>ìµœëŒ€ 50% ê°ì†Œ ê°€ëŠ¥</strong></td></tr><tr><td><strong>GPU Memory ìš”êµ¬ëŸ‰</strong></td><td>100%</td><td><strong>70% ìˆ˜ì¤€ìœ¼ë¡œ ê°ì†Œ ê°€ëŠ¥</strong></td></tr><tr><td><strong>ì „ì²´ í•™ìŠµ ì†ë„ ì˜í–¥</strong></td><td>ì†ë„ ì €í•˜ ê°€ëŠ¥ (ì¬ê³„ì‚° í•„ìš”)</td><td><strong>Microbatch Scalingì„ í†µí•´ ìœ ì§€ ê°€ëŠ¥</strong></td></tr></tbody></table><hr><h1 id=-ìµœì¢…-ê²°ë¡ -ìµœì‹ -ì—°êµ¬-ì ìš©-ì‹œ-ê¸°ëŒ€-ì„±ëŠ¥-í–¥ìƒ-ìš”ì•½>ğŸ† ìµœì¢… ê²°ë¡ : ìµœì‹  ì—°êµ¬ ì ìš© ì‹œ ê¸°ëŒ€ ì„±ëŠ¥ í–¥ìƒ ìš”ì•½</h1><table><thead><tr><th>ì—°êµ¬ ë°©í–¥</th><th>í•´ê²° ë°©ë²•</th><th>ì˜ˆìƒ ì„±ëŠ¥ í–¥ìƒ</th></tr></thead><tbody><tr><td><strong>í†µì‹  ìµœì í™”</strong></td><td>ë¹„ë™ê¸° All-Reduce, Hierarchical All-Reduce</td><td><strong>GPU Idle Time 11% â†’ 5%, Throughput 10~15% ì¦ê°€</strong></td></tr><tr><td><strong>Input Layer ìµœì í™”</strong></td><td>Fused Embedding Kernel, Mixed Precision</td><td><strong>Input Layer ë³‘ë ¬ íš¨ìœ¨ 8.35% â†’ 30%+, ì „ì²´ í•™ìŠµ ì†ë„ 1.3ë°° ì¦ê°€</strong></td></tr><tr><td><strong>Activation Memory ê°ì†Œ</strong></td><td>FlashAttention, Activation Recomputation</td><td><strong>Memory ì‚¬ìš©ëŸ‰ ìµœëŒ€ 50% ì ˆê°, Large Batch Training ê°€ëŠ¥</strong></td></tr></tbody></table><p><strong>ê²°ë¡ :</strong><br>ë³¸ ë…¼ë¬¸ì˜ Vocabulary Parallelism ê¸°ë²•ì€ ë§¤ìš° ê°•ë ¥í•œ ì„±ëŠ¥ ìµœì í™” ë°©ë²•ì´ì§€ë§Œ, ìµœì‹  ì—°êµ¬ ë°©í–¥ì„ ê²°í•©í•˜ë©´ <strong>ìµœëŒ€ 1.5ë°° ì´ìƒì˜ ì¶”ê°€ì ì¸ í•™ìŠµ ì†ë„ í–¥ìƒê³¼ ë©”ëª¨ë¦¬ ì ˆê°ì´ ê°€ëŠ¥</strong>í•˜ë‹¤. ì´ë¥¼ í†µí•´ ë”ìš± <strong>ëŒ€ê·œëª¨ ëª¨ë¸ì„ íš¨ê³¼ì ìœ¼ë¡œ í•™ìŠµí•  ìˆ˜ ìˆëŠ” í™˜ê²½</strong>ì´ ì¡°ì„±ë  ê²ƒì´ë‹¤.</p></article></main><footer class="mx-auto max-w-4xl px-4 py-8"><div class="px-6 py-6"><nav class=mb-6><div class="flex flex-wrap items-center justify-center gap-1"><a href=/index.xml class="nav-link hover:text-primary hover:bg-primary/10 text-muted-foreground flex items-center gap-2 rounded-lg px-4 py-2 text-sm font-medium transition-all duration-300 hover:scale-105"><svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="RSS Feed"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 5c7.18.0 13 5.82 13 13M6 11a7 7 0 017 7m-6 0a1 1 0 11-2 0 1 1 0 012 0z"/></svg>
<span>RSS Feed</span></a></div></nav><div class="border-border mb-6 border-t"></div><div class="flex flex-col items-center justify-between gap-4 md:flex-row"><div class="text-muted-foreground text-sm"><p>&copy; 2025 Jaehun's Blog.
ëª¨ë“  ê¶Œë¦¬ ë³´ìœ .</p></div><div class="flex items-center gap-3"><a href=https://github.com/ryujaehun target=_blank rel="noopener noreferrer" class="text-muted-foreground hover:text-primary focus:ring-primary/20 rounded-lg p-1 transition-all duration-300 ease-out hover:scale-110 focus:ring-2 focus:outline-none" title=GitHub aria-label=GitHub><svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="GitHub"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"><path d="M15 22v-4a4.8 4.8.0 00-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35.0-3.5.0.0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35.0 3.5A5.4 5.4.0 004 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65S8.93 17.38 9 18v4"/><path d="M9 18c-4.51 2-5-2-7-2"/></g></svg>
</a><a href=https://www.linkedin.com/in/jaehunryu/ target=_blank rel="noopener noreferrer" class="text-muted-foreground hover:text-primary focus:ring-primary/20 rounded-lg p-1 transition-all duration-300 ease-out hover:scale-110 focus:ring-2 focus:outline-none" title=Linkedin aria-label=Linkedin><svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="Linkedin"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"><path d="M16 8a6 6 0 016 6v7h-4v-7a2 2 0 00-2-2 2 2 0 00-2 2v7h-4v-7a6 6 0 016-6M2 9h4v12H2z"/><circle cx="4" cy="4" r="2"/></g></svg>
</a><a href=mailto:jaehunryu@icloud.com class="text-muted-foreground hover:text-primary focus:ring-primary/20 rounded-lg p-1 transition-all duration-300 ease-out hover:scale-110 focus:ring-2 focus:outline-none" title=Email aria-label=Email><svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="Email"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22.0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5A2 2 0 003 7v10a2 2 0 002 2z"/></svg></a></div></div></div></footer><div id=dock class="pointer-events-none fixed bottom-4 left-1/2 z-[9999] w-fit -translate-x-1/2 translate-y-24 opacity-0 transition-all duration-300 ease-out sm:right-0 sm:left-0 sm:mx-auto sm:translate-x-0" role=toolbar aria-label="ë°”ë¡œê°€ê¸° ë„êµ¬ ëª¨ìŒ"><nav class="border-border bg-card/80 scrollbar-hide xs:px-3 xs:py-2 mx-auto flex max-w-[calc(100vw-2rem)] min-w-fit items-center justify-center overflow-x-auto rounded-2xl border px-4 py-3 shadow-lg backdrop-blur-sm sm:px-4 sm:py-3"><button id=dock-back class="text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 xs:px-2 xs:py-1.5 flex flex-shrink-0 items-center gap-2 rounded-lg px-3 py-2 text-sm font-medium transition-all duration-300 ease-out hover:-translate-y-0.5 hover:scale-105 focus:ring-2 focus:outline-none sm:px-3 sm:py-2" title=ë’¤ë¡œ aria-label=ë’¤ë¡œ>
<svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="m12 19-7-7 7-7"/><path d="M19 12H5"/></svg>
<span class="hidden sm:inline">ë’¤ë¡œ</span></button><div class="bg-border xs:mx-1 mx-2 h-6 w-px sm:mx-2"></div><button id=dock-toc class="text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 xs:px-2 xs:py-1.5 flex flex-shrink-0 items-center gap-2 rounded-lg px-3 py-2 text-sm font-medium transition-all duration-300 ease-out hover:-translate-y-0.5 hover:scale-105 focus:ring-2 focus:outline-none sm:px-3 sm:py-2" title=ëª©ì°¨ aria-label=ëª©ì°¨>
<svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><line x1="8" x2="21" y1="6" y2="6"/><line x1="8" x2="21" y1="12" y2="12"/><line x1="8" x2="21" y1="18" y2="18"/><line x1="3" x2="3.01" y1="6" y2="6"/><line x1="3" x2="3.01" y1="12" y2="12"/><line x1="3" x2="3.01" y1="18" y2="18"/></svg>
<span class="hidden sm:inline">ëª©ì°¨</span></button><div class="bg-border xs:mx-1 mx-2 h-6 w-px sm:mx-2"></div><button id=dock-search class="text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 xs:px-3 xs:py-1.5 flex flex-shrink-0 items-center gap-2 rounded-lg px-4 py-2 text-sm font-medium transition-all duration-300 ease-out hover:-translate-y-0.5 hover:scale-105 focus:ring-2 focus:outline-none sm:px-4 sm:py-2" title=ê²€ìƒ‰ aria-label=ê²€ìƒ‰>
<svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m21 21-6-6m2-5A7 7 0 113 10a7 7 0 0114 0z"/></svg>
<span class="hidden md:inline">ê²€ìƒ‰</span></button><div class="bg-border xs:mx-1 mx-2 h-6 w-px sm:mx-2"></div><button id=dock-top class="text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 xs:px-2 xs:py-1.5 flex flex-shrink-0 items-center gap-2 rounded-lg px-3 py-2 text-sm font-medium transition-all duration-300 ease-out hover:-translate-y-0.5 hover:scale-105 focus:ring-2 focus:outline-none sm:px-3 sm:py-2" title="ë§¨ ìœ„ë¡œ" aria-label="ë§¨ ìœ„ë¡œ">
<svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="m18 15-6-6-6 6"/></svg>
<span class="hidden sm:inline">ë§¨ ìœ„ë¡œ</span></button></nav></div><div id=toc-overlay class="pointer-events-none fixed inset-0 z-40 bg-black/50 opacity-0 backdrop-blur-sm transition-all duration-300" role=dialog aria-modal=true aria-labelledby=toc-title></div><div id=toc-card class="pointer-events-none fixed inset-4 z-50 flex w-auto scale-95 items-center justify-center opacity-0 transition-all duration-300 sm:inset-auto sm:top-1/2 sm:left-1/2 sm:block sm:w-full sm:max-w-md sm:-translate-x-1/2 sm:-translate-y-1/2" role=dialog aria-modal=true aria-labelledby=toc-title><div class="bg-card border-border w-full max-w-sm overflow-hidden rounded-xl border shadow-xl sm:max-w-md"><div class="border-border bg-muted/30 flex items-center justify-between border-b p-4"><div class="flex items-center gap-3"><svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><line x1="8" x2="21" y1="6" y2="6"/><line x1="8" x2="21" y1="12" y2="12"/><line x1="8" x2="21" y1="18" y2="18"/><line x1="3" x2="3.01" y1="6" y2="6"/><line x1="3" x2="3.01" y1="12" y2="12"/><line x1="3" x2="3.01" y1="18" y2="18"/></svg><h2 id=toc-title class="text-foreground text-lg font-semibold">ëª©ì°¨</h2></div><button id=toc-close class="text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 rounded-lg p-2 transition-all duration-200 ease-out hover:-translate-y-0.5 hover:scale-105 focus:ring-2 focus:outline-none" title=ë‹«ê¸° aria-label=ë‹«ê¸°>
<svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18 18 6M6 6l12 12"/></svg></button></div><div class="max-h-96 overflow-y-auto p-4"><nav id=toc-nav class=toc-scrollbar aria-label="ê¸€ ëª©ì°¨"><div id=toc-content><nav id=TableOfContents><ul><li><a href=#ê²°ë¡ -ìš”ì•½>ê²°ë¡  ìš”ì•½</a></li><li><a href=#ë…¼ë¬¸ì˜-ê°•ì -ë°-ë…ì°½ì ì¸-ì§€ì >ë…¼ë¬¸ì˜ ê°•ì  ë° ë…ì°½ì ì¸ ì§€ì </a></li><li><a href=#í•µì‹¬-ì•Œê³ ë¦¬ì¦˜-ì„¤ëª…-ì˜ˆì‹œ-ì…ë ¥ê³¼-í•¨ê»˜>í•µì‹¬ ì•Œê³ ë¦¬ì¦˜ ì„¤ëª… (ì˜ˆì‹œ ì…ë ¥ê³¼ í•¨ê»˜)</a><ul><li><a href=#ì˜ˆì‹œ-ì„¤ì •>ì˜ˆì‹œ ì„¤ì •</a></li><li><a href=#ì „ì²´-ê³¼ì •-forward--backward>ì „ì²´ ê³¼ì • (Forward â†’ Backward)</a></li></ul></li><li><a href=#ë…¼ë¬¸ì˜-í•œê³„ì >ë…¼ë¬¸ì˜ í•œê³„ì </a></li></ul><ul><li><a href=#-1-ì•Œê³ ë¦¬ì¦˜-ê°œìš”>ğŸ“Œ 1. ì•Œê³ ë¦¬ì¦˜ ê°œìš”</a></li><li><a href=#-ì•Œê³ ë¦¬ì¦˜-ìµœì í™”-ê³¼ì •-êµ¬ì²´ì ì¸-ì˜ˆì‹œì™€-í•¨ê»˜>ğŸ“Œ ì•Œê³ ë¦¬ì¦˜ ìµœì í™” ê³¼ì • (êµ¬ì²´ì ì¸ ì˜ˆì‹œì™€ í•¨ê»˜)</a><ul><li><a href=#-ì˜ˆì‹œ-ìƒí™©-ì„¤ì •>âœ… ì˜ˆì‹œ ìƒí™© ì„¤ì •</a><ul><li><a href=#-ì˜ˆì‹œ-ì…ë ¥ê°’>ğŸ”¹ ì˜ˆì‹œ ì…ë ¥ê°’</a></li></ul></li><li><a href=#-ë‹¨ê³„ë³„-ê³„ì‚°-ê³¼ì •-algorithm-2-ì ìš©>âœ… ë‹¨ê³„ë³„ ê³„ì‚° ê³¼ì • (Algorithm 2 ì ìš©)</a></li></ul></li><li><a href=#-forward-phase>â–¶ï¸ [Forward Phase]</a><ul><li><a href=#-ê°-deviceì—ì„œ-ë…ë¦½ì -logits-ê³„ì‚°>â‘  ê° Deviceì—ì„œ ë…ë¦½ì  Logits ê³„ì‚°</a></li><li><a href=#-local-max-ë°-sum-ê³„ì‚°>â‘¡ Local max ë° sum ê³„ì‚°</a></li><li><a href=#-softmax-ê³„ì‚°-localë§Œ-ê³ ë ¤í•œ-softmax>â‘¡ softmax&rsquo; ê³„ì‚° (Localë§Œ ê³ ë ¤í•œ softmax)</a></li><li><a href=#-ê¸€ë¡œë²Œ-í†µì‹ -all-reduce-í›„-ì •í™•í•œ-softmax-ê³„ì‚°>â‘¡ ê¸€ë¡œë²Œ í†µì‹  (All-Reduce) í›„ ì •í™•í•œ softmax ê³„ì‚°</a></li></ul></li><li><a href=#-backward-phase>â—€ï¸ [Backward Phase]</a><ul><li><a href=#-backward-gradient-ê³„ì‚°ì„-ìœ„í•œ-ì¤‘ê°„ê°’-ë¯¸ë¦¬-ê³„ì‚°>â‘  backward Gradient ê³„ì‚°ì„ ìœ„í•œ ì¤‘ê°„ê°’ ë¯¸ë¦¬ ê³„ì‚°</a></li><li><a href=#-all-reduce-í†µì‹ ìœ¼ë¡œ-ì •í™•í•œ-gradient-ê³„ì‚°>â‘¡ All-Reduce í†µì‹ ìœ¼ë¡œ ì •í™•í•œ gradient ê³„ì‚°</a></li></ul></li><li><a href=#-ì•Œê³ ë¦¬ì¦˜-2ì˜-ì¥ì ê³¼-íš¨ê³¼>ğŸ“Œ ì•Œê³ ë¦¬ì¦˜ 2ì˜ ì¥ì ê³¼ íš¨ê³¼</a></li><li><a href=#-ìµœì¢…-ì •ë¦¬>ğŸš© ìµœì¢… ì •ë¦¬</a></li></ul><ul><li><a href=#-1-í•„ìš”í•œ-ë°ì´í„°ì…‹ì˜-íŠ¹ì§•>âœ… 1. í•„ìš”í•œ ë°ì´í„°ì…‹ì˜ íŠ¹ì§•</a></li><li><a href=#ì¶”ì²œí•˜ëŠ”-ëŒ€í‘œì -ë°ì´í„°ì…‹-ì˜ˆì‹œ>ì¶”ì²œí•˜ëŠ” ëŒ€í‘œì  ë°ì´í„°ì…‹ ì˜ˆì‹œ</a><ul><li><a href=#-ë°ì´í„°ì…‹ì˜-ëŒ€í‘œ-ì˜ˆì‹œ-ë¹„êµ>ğŸ“ ë°ì´í„°ì…‹ì˜ ëŒ€í‘œ ì˜ˆì‹œ ë¹„êµ</a></li></ul></li><li><a href=#-ë…¼ë¬¸ì˜-ë°©ë²•ì„-ì ìš©í•œ-í•™ìŠµ-ì ˆì°¨>âœ… ë…¼ë¬¸ì˜ ë°©ë²•ì„ ì ìš©í•œ í•™ìŠµ ì ˆì°¨</a><ul><li><a href=#--ë°ì´í„°ì…‹-ì¤€ë¹„-preprocessing>ğŸš© â‘  ë°ì´í„°ì…‹ ì¤€ë¹„ (Preprocessing)</a></li><li><a href=#--ëª¨ë¸-êµ¬ì„±-ë°-í™˜ê²½-ì„¤ì •>ğŸš© â‘¡ ëª¨ë¸ êµ¬ì„± ë° í™˜ê²½ ì„¤ì •</a></li><li><a href=#--vocabulary-layer-ë³‘ë ¬í™”-ì ìš©-ë…¼ë¬¸-ì•Œê³ ë¦¬ì¦˜-ì ìš©>ğŸš© â‘¢ Vocabulary Layer ë³‘ë ¬í™” ì ìš© (ë…¼ë¬¸ ì•Œê³ ë¦¬ì¦˜ ì ìš©)</a></li><li><a href=#--í•™ìŠµ-ë‹¨ê³„-í›ˆë ¨-ë°˜ë³µ-ê³¼ì •>ğŸš© â‘¢ í•™ìŠµ ë‹¨ê³„ (í›ˆë ¨ ë°˜ë³µ ê³¼ì •)</a></li><li><a href=#--í•™ìŠµ-í‰ê°€-throughput-ë°-ë©”ëª¨ë¦¬-ê· í˜•ì„±-í™•ì¸>ğŸš© â‘£ í•™ìŠµ í‰ê°€ (Throughput ë° ë©”ëª¨ë¦¬ ê· í˜•ì„± í™•ì¸)</a></li></ul></li><li><a href=#-í•µì‹¬-ì•Œê³ ë¦¬ì¦˜ì„-ìœ„í•œ-ìµœì¢…ì -ìš”ì•½-ì •ë¦¬-ì˜ˆì‹œ-ê¸°ë°˜>âœ… í•µì‹¬ ì•Œê³ ë¦¬ì¦˜ì„ ìœ„í•œ ìµœì¢…ì  ìš”ì•½ ì •ë¦¬ (ì˜ˆì‹œ ê¸°ë°˜)</a></li></ul><ul><li><a href=#-ê²°ë¡ ë¶€í„°-ì••ì¶•ì ìœ¼ë¡œ-ì •ë¦¬í•˜ë©´>ğŸ“Œ ê²°ë¡ ë¶€í„° ì••ì¶•ì ìœ¼ë¡œ ì •ë¦¬í•˜ë©´:</a></li><li><a href=#-ì‹¤í—˜-ê²°ê³¼-ì •ëŸ‰ì -ë¹„êµ-ë…¼ë¬¸-ì‹¤í—˜-ê²°ê³¼-ì¸ìš©>ğŸ“Œ ì‹¤í—˜ ê²°ê³¼ ì •ëŸ‰ì  ë¹„êµ (ë…¼ë¬¸ ì‹¤í—˜ ê²°ê³¼ ì¸ìš©)</a></li><li><a href=#-ë…¼ë¬¸ì˜-ë°©ë²•ì´-ê°€ì§€ëŠ”-ê°•ì ê³¼-ë…ì°½ì„±>ğŸ“Œ ë…¼ë¬¸ì˜ ë°©ë²•ì´ ê°€ì§€ëŠ” ê°•ì ê³¼ ë…ì°½ì„±</a><ul><li><a href=#-1-vocabulary-parallelismì„-í†µí•œ-ë¶ˆê· í˜•-í•´ì†Œ>ğŸ”¸ (1) Vocabulary Parallelismì„ í†µí•œ ë¶ˆê· í˜• í•´ì†Œ</a></li></ul></li><li><a href=#-í•µì‹¬-ì•Œê³ ë¦¬ì¦˜ì˜-ì„±ëŠ¥-í–¥ìƒì„-ê°€ì ¸ì˜¨-ì£¼ìš”-ìµœì í™”-ê¸°ë²•-algorithm-2>ğŸ“Œ í•µì‹¬ ì•Œê³ ë¦¬ì¦˜ì˜ ì„±ëŠ¥ í–¥ìƒì„ ê°€ì ¸ì˜¨ ì£¼ìš” ìµœì í™” ê¸°ë²• (Algorithm 2)</a></li><li><a href=#-ë…¼ë¬¸ì˜-ë…ì°½ì -ë°©ë²•ì˜-ì„±ëŠ¥-ìš°ìœ„-ì´ìœ -ë¶„ì„-í•µì‹¬-ê·¼ê±°>ğŸ“Œ ë…¼ë¬¸ì˜ ë…ì°½ì  ë°©ë²•ì˜ ì„±ëŠ¥ ìš°ìœ„ ì´ìœ  ë¶„ì„ (í•µì‹¬ ê·¼ê±°)</a></li><li><a href=#-ê·¸ëŸ¬ë‚˜-ì¡´ì¬í•˜ëŠ”-í•œê³„ì ê³¼-ê°œì„ -í•„ìš”ì„±>ğŸ“Œ ê·¸ëŸ¬ë‚˜ ì¡´ì¬í•˜ëŠ” í•œê³„ì ê³¼ ê°œì„  í•„ìš”ì„±</a></li><li><a href=#-ìµœì¢…-ì •ë¦¬-ë…¼ë¬¸ì˜-ê¸°ìˆ ì -ìš°ìˆ˜ì„±-ìš”ì•½>ğŸ” ìµœì¢… ì •ë¦¬: ë…¼ë¬¸ì˜ ê¸°ìˆ ì  ìš°ìˆ˜ì„± ìš”ì•½</a></li><li><a href=#-ìµœì¢…-ê²°ë¡ ê³¼-ë…ì°½ì„±ì˜-í•µì‹¬-ì´ìœ >ğŸ¯ ìµœì¢… ê²°ë¡ ê³¼ ë…ì°½ì„±ì˜ í•µì‹¬ ì´ìœ </a></li><li><a href=#-ì¶”ê°€-ì—°êµ¬-ë°-ê°œì„ -ê°€ëŠ¥ì„±>ğŸ“Œ ì¶”ê°€ ì—°êµ¬ ë° ê°œì„  ê°€ëŠ¥ì„±</a></li></ul><ul><li><a href=#1-êµ¬í˜„-ë‹¨ê³„ë³„-í•„ìˆ˜-ì‘ì—…-ë°-ë‚œì´ë„-ì •ë¦¬>1ï¸âƒ£ êµ¬í˜„ ë‹¨ê³„ë³„ í•„ìˆ˜ ì‘ì—… ë° ë‚œì´ë„ ì •ë¦¬</a></li><li><a href=#-ì¶”ê°€ì ìœ¼ë¡œ-ìš”êµ¬ë˜ëŠ”-ë¹„ìš©-ì •ëŸ‰ì -ë¶„ì„>ğŸ“Œ ì¶”ê°€ì ìœ¼ë¡œ ìš”êµ¬ë˜ëŠ” ë¹„ìš© ì •ëŸ‰ì  ë¶„ì„</a><ul><li><a href=#--ì¶”ê°€-êµ¬í˜„-ë¹„ìš©-computational-cost>âœ… â‘  ì¶”ê°€ êµ¬í˜„ ë¹„ìš© (Computational Cost)</a></li><li><a href=#--í†µì‹ -ë¹„ìš©-communication-overhead>âœ… â‘¡ í†µì‹  ë¹„ìš© (Communication Overhead)</a></li><li><a href=#--ì¶”ê°€-activation-memory-ë¹„ìš©>âœ… â‘¢ ì¶”ê°€ Activation Memory ë¹„ìš©</a></li></ul></li><li><a href=#-ì‹¤ì œ-í•™ìŠµ-ì˜ˆì‹œë¥¼-í†µí•œ-ë¹„ìš©-ì˜ˆì¸¡>ğŸ“Œ ì‹¤ì œ í•™ìŠµ ì˜ˆì‹œë¥¼ í†µí•œ ë¹„ìš© ì˜ˆì¸¡</a></li><li><a href=#-ì •ë¦¬-ë°-ìµœì¢…ì ì¸-ì¡°ì–¸>ğŸ“Œ ì •ë¦¬ ë° ìµœì¢…ì ì¸ ì¡°ì–¸</a></li></ul><ul><li><ul><li><a href=#-ì˜ˆì‹œ-ì…ë ¥-ë°ì´í„°>âœ… ì˜ˆì‹œ ì…ë ¥ ë°ì´í„°:</a></li></ul></li></ul><ul><li><ul><li><a href=#-ì˜ˆì‹œ-ëª¨ë¸-í™˜ê²½-ì„¤ì •>ğŸš© ì˜ˆì‹œ ëª¨ë¸ í™˜ê²½ ì„¤ì •</a><ul><li><a href=#-ì˜ˆì‹œ-ì…ë ¥-ë°-embedding-weight-êµ¬ì„±>ğŸ”¸ ì˜ˆì‹œ ì…ë ¥ ë° Embedding Weight êµ¬ì„±</a></li></ul></li></ul></li></ul><ul><li><a href=#-forward-ë‹¨ê³„>â–¶ï¸ Forward ë‹¨ê³„</a><ul><li><a href=#1-logits-y-ê³„ì‚°-ê°-ë””ë°”ì´ìŠ¤-ë…ë¦½ì -ìˆ˜í–‰>(1) Logits (Y) ê³„ì‚° (ê° ë””ë°”ì´ìŠ¤ ë…ë¦½ì  ìˆ˜í–‰)</a></li><li><a href=#2-local-ìµœëŒ€ê°’ê³¼-í•©-ê³„ì‚°-ë°-local-softmax-ê³„ì‚°>(2) Local ìµœëŒ€ê°’ê³¼ í•© ê³„ì‚° ë° Local Softmax ê³„ì‚°</a></li><li><a href=#3-global-all-reduceë¥¼-í†µí•´-ê¸€ë¡œë²Œ-softmax-ê³„ì‚°>(3) Global All-Reduceë¥¼ í†µí•´ ê¸€ë¡œë²Œ softmax ê³„ì‚°</a></li></ul></li><li><a href=#-backward-ë‹¨ê³„>â—€ï¸ Backward ë‹¨ê³„</a><ul><li><a href=#1-ì¤‘ê°„ê°’-ì‚¬ì „-ê³„ì‚°-local>(1) ì¤‘ê°„ê°’ ì‚¬ì „ ê³„ì‚° (Local)</a></li><li><a href=#2-ìµœì¢…-gradients-ê³„ì‚°all-reduce-ìˆ˜í–‰-í›„>(2) ìµœì¢… Gradients ê³„ì‚°(All-Reduce ìˆ˜í–‰ í›„)</a></li></ul></li></ul><ul><li><ul><li><a href=#ì˜ˆì‹œ-ì—°ì‚°ëŸ‰-ê³„ì‚°-ì˜ˆ-7b-ëª¨ë¸-seq-2048-vocab-256k>ì˜ˆì‹œ ì—°ì‚°ëŸ‰ ê³„ì‚° (ì˜ˆ: 7B ëª¨ë¸, seq 2048, vocab 256K)</a></li></ul></li></ul><ul><li><a href=#-ë…¼ë¬¸ì˜-í•œê³„ì -ëª…í™•í•œ-ì •ë¦¬>ğŸš© ë…¼ë¬¸ì˜ í•œê³„ì  (ëª…í™•í•œ ì •ë¦¬)</a></li></ul><ul><li><a href=#-ì—°êµ¬ë°©í–¥-1-í†µì‹ -ìµœì í™”-ê¸°ìˆ communication-optimization>ğŸ’¡ [ì—°êµ¬ë°©í–¥ 1] í†µì‹  ìµœì í™” ê¸°ìˆ (Communication Optimization)</a></li><li><a href=#-ì—°êµ¬ë°©í–¥-2-input-layer-ë³‘ë ¬í™”-ê°œì„ -ì—°êµ¬>ğŸ’¡ [ì—°êµ¬ë°©í–¥ 2] Input Layer ë³‘ë ¬í™” ê°œì„  ì—°êµ¬</a></li><li><a href=#-ì—°êµ¬ë°©í–¥-3-activation-memory-ì‚¬ìš©ëŸ‰-ì¶”ê°€-ê²½ê°>ğŸ’¡ [ì—°êµ¬ë°©í–¥ 3] Activation Memory ì‚¬ìš©ëŸ‰ ì¶”ê°€ ê²½ê°</a></li><li><a href=#ì—°êµ¬ë°©í–¥-3-vocabulary-layerë¥¼-ìœ„í•œ-íš¨ìœ¨ì -cuda-kernel-fusion-ì—°êµ¬>ğŸ’¡[ì—°êµ¬ë°©í–¥ 3] Vocabulary Layerë¥¼ ìœ„í•œ íš¨ìœ¨ì  CUDA Kernel Fusion ì—°êµ¬</a></li><li><a href=#-ìµœì‹ -ì—°êµ¬-íë¦„-ë°-ì „ë§-ì¢…í•©-ì •ë¦¬-í•œëˆˆì—-ë³´ê¸°-ì‰¬ìš´-í…Œì´ë¸”ë¡œ-ì •ë¦¬>ğŸ“Œ ìµœì‹  ì—°êµ¬ íë¦„ ë° ì „ë§ ì¢…í•© ì •ë¦¬ (í•œëˆˆì— ë³´ê¸° ì‰¬ìš´ í…Œì´ë¸”ë¡œ ì •ë¦¬)</a></li><li><a href=#-ê²°ë¡ -ë°-ë„ˆì˜-ìƒê°-ì¢…í•©ì -ì˜ê²¬>ğŸ“Œ ê²°ë¡  ë° ë„ˆì˜ ìƒê° (ì¢…í•©ì  ì˜ê²¬)</a></li></ul><ul><li><a href=#vocabulary-parallelismì´-ê¸°ì¡´-pipeline-parallelismppì˜-ë¬¸ì œë¥¼-í•´ê²°í•˜ëŠ”-ë°©ì‹>Vocabulary Parallelismì´ ê¸°ì¡´ Pipeline Parallelism(PP)ì˜ ë¬¸ì œë¥¼ í•´ê²°í•˜ëŠ” ë°©ì‹</a><ul><li><a href=#1-ê¸°ì¡´-pipeline-parallelismppì˜-ì—°ì‚°-ë°-ë©”ëª¨ë¦¬-ë¶ˆê· í˜•-ë¬¸ì œ>1ï¸âƒ£ ê¸°ì¡´ Pipeline Parallelism(PP)ì˜ ì—°ì‚° ë° ë©”ëª¨ë¦¬ ë¶ˆê· í˜• ë¬¸ì œ</a><ul><li><a href=#-1-vocabulary-layerê°€-íŠ¹ì •-gpuì—-ì§‘ì¤‘ë˜ì–´-ë°œìƒí•˜ëŠ”-ë¬¸ì œ>ğŸ”¹ (1) Vocabulary Layerê°€ íŠ¹ì • GPUì— ì§‘ì¤‘ë˜ì–´ ë°œìƒí•˜ëŠ” ë¬¸ì œ</a></li><li><a href=#-2-pipeline-bubble-ë¬¸ì œ>ğŸ”¹ (2) Pipeline Bubble ë¬¸ì œ</a></li><li><a href=#-3-ë©”ëª¨ë¦¬-ë¶ˆê· í˜•>ğŸ”¹ (3) ë©”ëª¨ë¦¬ ë¶ˆê· í˜•</a></li></ul></li><li><a href=#2-vocabulary-parallelismì´-ë¬¸ì œë¥¼-í•´ê²°í•˜ëŠ”-ë°©ì‹>2ï¸âƒ£ Vocabulary Parallelismì´ ë¬¸ì œë¥¼ í•´ê²°í•˜ëŠ” ë°©ì‹</a><ul><li><a href=#-1-vocabulary-layerë¥¼-ëª¨ë“ -gpuì—-ê· ë“±-ë¶„ì‚°>âœ… (1) Vocabulary Layerë¥¼ ëª¨ë“  GPUì— ê· ë“± ë¶„ì‚°</a></li><li><a href=#-2-ì—°ì‚°-ê· í˜•-ìœ ì§€-ë°-pipeline-bubble-ìµœì†Œí™”>âœ… (2) ì—°ì‚° ê· í˜• ìœ ì§€ ë° Pipeline Bubble ìµœì†Œí™”</a></li><li><a href=#-3-ë©”ëª¨ë¦¬-ì‚¬ìš©ëŸ‰-ê· í˜•í™”>âœ… (3) ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ê· í˜•í™”</a></li></ul></li><li><a href=#3-vocabulary-parallelism-ì ìš©-ì‹œ-ì„±ëŠ¥-ê°œì„ -íš¨ê³¼>3ï¸âƒ£ Vocabulary Parallelism ì ìš© ì‹œ ì„±ëŠ¥ ê°œì„  íš¨ê³¼</a><ul><li><a href=#-1-throughput-í–¥ìƒ-íš¨ê³¼>ğŸš€ (1) Throughput í–¥ìƒ íš¨ê³¼</a></li><li><a href=#-2-peak-memory-ì‚¬ìš©ëŸ‰-ì ˆê°-íš¨ê³¼>ğŸ’¾ (2) Peak Memory ì‚¬ìš©ëŸ‰ ì ˆê° íš¨ê³¼</a></li></ul></li><li><a href=#4-ì •ë¦¬-ë°-ê²°ë¡ >4ï¸âƒ£ ì •ë¦¬ ë° ê²°ë¡ </a></li></ul></li></ul><ul><li><a href=#-algorithm-2ìµœì í™”ëœ-ë‹¨ì¼-communication-barrier-ë°©ì‹-vs-ê¸°ì¡´-naive-ë°©ì‹algorithm-1>ğŸ“Œ Algorithm 2(ìµœì í™”ëœ ë‹¨ì¼ Communication Barrier ë°©ì‹) vs. ê¸°ì¡´ naive ë°©ì‹(Algorithm 1)</a></li><li><a href=#1-ê¸°ì¡´-naive-ë°©ì‹-algorithm-1ì˜-ë¬¸ì œì >1ï¸âƒ£ ê¸°ì¡´ naive ë°©ì‹ (Algorithm 1)ì˜ ë¬¸ì œì </a><ul><li><a href=#-ê¸°ì¡´-ë°©ì‹-algorithm-1-ì˜-ì—°ì‚°-íë¦„>ğŸ”¹ ê¸°ì¡´ ë°©ì‹ (Algorithm 1) ì˜ ì—°ì‚° íë¦„</a><ul><li><a href=#-ë¬¸ì œì >ğŸš¨ ë¬¸ì œì :</a></li></ul></li></ul></li><li><a href=#2-algorithm-2ìµœì í™”ëœ-ë‹¨ì¼-communication-barrier-ë°©ì‹ì˜-ê°œì„ >2ï¸âƒ£ Algorithm 2(ìµœì í™”ëœ ë‹¨ì¼ Communication Barrier ë°©ì‹)ì˜ ê°œì„ </a><ul><li><a href=#-algorithm-2ì˜-ì—°ì‚°-íë¦„>ğŸ”¹ Algorithm 2ì˜ ì—°ì‚° íë¦„</a></li></ul></li><li><a href=#3-ìˆ˜ì‹ê³¼-ì˜ˆì‹œë¥¼-í†µí•œ-ë¹„êµ-ë¶„ì„>3ï¸âƒ£ ìˆ˜ì‹ê³¼ ì˜ˆì‹œë¥¼ í†µí•œ ë¹„êµ ë¶„ì„</a><ul><li><a href=#-ì˜ˆì‹œ-4ê°œì˜-gpuì—ì„œ-output-layerì˜-ì—°ì‚°ì„-ë¶„í• í•˜ëŠ”-ê²½ìš°>ğŸ“Œ ì˜ˆì‹œ: 4ê°œì˜ GPUì—ì„œ Output Layerì˜ ì—°ì‚°ì„ ë¶„í• í•˜ëŠ” ê²½ìš°</a><ul><li><a href=#1-ê¸°ì¡´-ë°©ì‹-algorithm-1ì˜-ì—°ì‚°-ê³¼ì •><strong>(1) ê¸°ì¡´ ë°©ì‹ (Algorithm 1)ì˜ ì—°ì‚° ê³¼ì •</strong></a></li><li><a href=#2-algorithm-2ì˜-ì—°ì‚°-ê³¼ì •><strong>(2) Algorithm 2ì˜ ì—°ì‚° ê³¼ì •</strong></a></li><li><a href=#-ê²°ê³¼-ë¹„êµ>ğŸš€ <strong>ê²°ê³¼ ë¹„êµ</strong></a></li></ul></li></ul></li><li><a href=#4-algorithm-2ì˜-ì„±ëŠ¥-í–¥ìƒ-íš¨ê³¼-ë¶„ì„>4ï¸âƒ£ Algorithm 2ì˜ ì„±ëŠ¥ í–¥ìƒ íš¨ê³¼ ë¶„ì„</a><ul><li><a href=#1-communication-overhead-ê°ì†Œ><strong>(1) Communication Overhead ê°ì†Œ</strong></a></li><li><a href=#2-memory-usage-ì ˆê°><strong>(2) Memory Usage ì ˆê°</strong></a></li><li><a href=#3-throughputflops-utilization-ì¦ê°€><strong>(3) Throughput(FLOPs Utilization) ì¦ê°€</strong></a></li></ul></li><li><a href=#5-ê²°ë¡ -ìµœì í™”-íš¨ê³¼-ìš”ì•½>5ï¸âƒ£ ê²°ë¡  (ìµœì í™” íš¨ê³¼ ìš”ì•½)</a></li></ul><ul><li><a href=#-ë…¼ë¬¸ì—ì„œ-ì œì‹œí•œ-ë°©ë²•ì˜-í•œê³„ì -ë°-ê·¹ë³µì„-ìœ„í•œ-ìµœì‹ -ì—°êµ¬-ë°©í–¥>ğŸ“Œ ë…¼ë¬¸ì—ì„œ ì œì‹œí•œ ë°©ë²•ì˜ í•œê³„ì  ë° ê·¹ë³µì„ ìœ„í•œ ìµœì‹  ì—°êµ¬ ë°©í–¥</a></li></ul><ul><li><ul><li><a href=#-ë¬¸ì œ-ë¶„ì„>ğŸ“Œ ë¬¸ì œ ë¶„ì„</a></li><li><a href=#-í•´ê²°-ë°©ì•ˆ---ë¹„ë™ê¸°ì‹asynchronous-í†µì‹ -ì ìš©>âœ… í•´ê²° ë°©ì•ˆ â‘  : ë¹„ë™ê¸°ì‹(Asynchronous) í†µì‹  ì ìš©</a><ul><li><a href=#-ê¸°ëŒ€-íš¨ê³¼>ğŸ”¹ ê¸°ëŒ€ íš¨ê³¼</a></li></ul></li><li><a href=#-í•´ê²°-ë°©ì•ˆ---hierarchical-all-reduce-ê³„ì¸µì -í†µì‹ >âœ… í•´ê²° ë°©ì•ˆ â‘¡ : Hierarchical All-Reduce (ê³„ì¸µì  í†µì‹ )</a><ul><li><a href=#-ê¸°ëŒ€-íš¨ê³¼-1>ğŸ”¹ ê¸°ëŒ€ íš¨ê³¼</a></li></ul></li></ul></li></ul><ul><li><ul><li><a href=#-ë¬¸ì œ-ë¶„ì„-1>ğŸ“Œ ë¬¸ì œ ë¶„ì„</a></li><li><a href=#-í•´ê²°-ë°©ì•ˆ---fused-embedding-kernel-ì ìš©>âœ… í•´ê²° ë°©ì•ˆ â‘  : Fused Embedding Kernel ì ìš©</a><ul><li><a href=#-ê¸°ëŒ€-íš¨ê³¼-2>ğŸ”¹ ê¸°ëŒ€ íš¨ê³¼</a></li></ul></li><li><a href=#-í•´ê²°-ë°©ì•ˆ---mixed-precision-í™œìš©-fp16--int8>âœ… í•´ê²° ë°©ì•ˆ â‘¡ : Mixed Precision í™œìš© (FP16 & INT8)</a><ul><li><a href=#-ê¸°ëŒ€-íš¨ê³¼-3>ğŸ”¹ ê¸°ëŒ€ íš¨ê³¼</a></li></ul></li></ul></li></ul><ul><li><ul><li><a href=#-ë¬¸ì œ-ë¶„ì„-2>ğŸ“Œ ë¬¸ì œ ë¶„ì„</a></li><li><a href=#-í•´ê²°-ë°©ì•ˆ---activation-recomputation-ì ìš©-gradient-checkpointing>âœ… í•´ê²° ë°©ì•ˆ â‘  : Activation Recomputation ì ìš© (Gradient Checkpointing)</a><ul><li><a href=#-ê¸°ëŒ€-íš¨ê³¼-4>ğŸ”¹ ê¸°ëŒ€ íš¨ê³¼</a></li></ul></li></ul></li></ul></nav></div></nav></div><div class="border-border bg-muted/20 border-t px-4 py-3"><div class="text-muted-foreground text-center text-xs"><span>ì œëª©ì„ í´ë¦­í•˜ë©´ í•´ë‹¹ ìœ„ì¹˜ë¡œ ì´ë™í•©ë‹ˆë‹¤</span></div></div></div></div><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.css integrity=sha384-5TcZemv2l/9On385z///+d7MSYlvIEw9FuZTIdZ14vJLqWphw7e7ZPuOiCHJcFCP crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.js integrity=sha384-cMkvdD8LoxVzGF/RPUKAcvmm49FQ0oxwDF3BGKtDXcEc+T1b2N+teh/OJfpU0jr6 crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/contrib/auto-render.min.js integrity=sha384-hCXGrW6PitJEwbkoStFjeJxv+fSOOQKOPbJxSfM6G5sWZjAyWhXiTIIAmQqnlLlh crossorigin=anonymous></script><script>function initKaTeX(){if(typeof renderMathInElement=="undefined"){setTimeout(initKaTeX,100);return}var e=[{display:!0,left:"$$",right:"$$"},{display:!1,left:"$",right:"$"}];renderMathInElement(document.body,{delimiters:e,throwOnError:!1,errorColor:"#cc0000",fleqn:!1,leqno:!1,trust:!1})}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",initKaTeX):initKaTeX()</script><div id=search-overlay class="pointer-events-none fixed inset-0 z-40 bg-black/50 opacity-0 transition-opacity duration-300"></div><div id=search-modal class="bg-card border-border pointer-events-none fixed top-1/2 left-1/2 z-50 max-h-[80vh] w-full max-w-2xl -translate-x-1/2 -translate-y-1/2 scale-95 transform overflow-hidden rounded-xl border opacity-0 shadow-xl transition-all duration-300"><div class="border-border flex items-center gap-3 border-b p-4"><div class="text-muted-foreground h-5 w-5 flex-shrink-0"><svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m21 21-6-6m2-5A7 7 0 113 10a7 7 0 0114 0z"/></svg></div><div class="relative flex-1"><button id=search-clear class="text-muted-foreground hover:text-foreground hover:bg-muted/50 pointer-events-none absolute top-1/2 left-0 z-10 h-5 w-5 -translate-y-1/2 rounded opacity-0 transition-all duration-200" title=ì§€ìš°ê¸° aria-label=ì§€ìš°ê¸°>
<svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18 18 6M6 6l12 12"/></svg>
</button>
<input id=search-input type=text placeholder="ê²Œì‹œê¸€ ê²€ìƒ‰..." class="text-foreground placeholder:text-muted-foreground w-full border-none bg-transparent pl-8 text-lg outline-none" autocomplete=off spellcheck=false></div><button id=search-close class="text-muted-foreground hover:text-foreground hover:bg-muted/50 flex h-6 w-6 items-center justify-center rounded-md p-0.5 transition-all duration-200" title=ë‹«ê¸° aria-label=ë‹«ê¸°>
<svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18 18 6M6 6l12 12"/></svg></button></div><div id=search-results class="max-h-96 overflow-y-auto"><div id=search-empty class="flex flex-col items-center justify-center py-12 text-center"><div class="bg-muted/50 mb-4 flex h-16 w-16 items-center justify-center rounded-full"><svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m21 21-6-6m2-5A7 7 0 113 10a7 7 0 0114 0z"/></svg></div><h3 class="text-foreground mb-2 text-lg font-semibold">ê²€ìƒ‰ ì‹œì‘</h3><p class="text-muted-foreground text-sm">ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•˜ì„¸ìš”</p></div><div id=search-loading class="flex hidden items-center justify-center py-8"><div class="mr-3 h-6 w-6 animate-spin rounded-full border-2 border-current border-t-transparent"></div><span class=text-muted-foreground>ê²€ìƒ‰ ì¤‘...</span></div><div id=search-no-results class="flex hidden flex-col items-center justify-center py-12 text-center"><div class="bg-muted/50 mb-4 flex h-16 w-16 items-center justify-center rounded-full"><svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h7"/></svg></div><h3 class="text-foreground mb-2 text-lg font-semibold">ê²€ìƒ‰ ê²°ê³¼ ì—†ìŒ</h3><p class="text-muted-foreground text-sm">ë‹¤ë¥¸ ê²€ìƒ‰ì–´ë¡œ ì‹œë„í•´ë³´ì„¸ìš”</p></div><div id=search-results-list class=hidden><div id=search-stats class="text-muted-foreground border-border border-b px-4 py-3 text-sm" data-template="%dê°œì˜ ê²°ê³¼ ì°¾ìŒ"></div><div id=search-items class="divide-border divide-y"></div></div></div><div class="border-border bg-muted/20 border-t px-4 py-3"><div class="text-muted-foreground flex items-center justify-between text-xs"><div class="flex items-center gap-2 md:gap-4"><div class="flex items-center gap-1"><kbd class="bg-muted border-border rounded border px-1.5 py-0.5 text-xs">â†‘â†“</kbd>
<span class="hidden sm:inline">ì´ë™</span></div><div class="flex items-center gap-1"><kbd class="bg-muted border-border rounded border px-1.5 py-0.5 text-xs">â†µ</kbd>
<span class="hidden sm:inline">ì„ íƒ</span></div><div class="flex items-center gap-1"><kbd class="bg-muted border-border rounded border px-1.5 py-0.5 text-xs">ESC</kbd>
<span class="hidden sm:inline">ë‹«ê¸°</span></div></div><div class="search-hint-desktop flex items-center gap-1"><kbd class="bg-muted border-border rounded border px-1.5 py-0.5 text-xs">âŒ˜K</kbd>
<span>ë‹¨ì¶•í‚¤</span></div></div></div></div></body></html>