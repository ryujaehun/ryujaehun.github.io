<!doctype html><html lang=ko-kr data-theme=claude><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta http-equiv=X-UA-Compatible content="IE=edge"><title>DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models | Jaehun's Blog</title><meta name=description content="ë…¼ë¬¸ ë§í¬
DeepSeekMoE ì •ë¦¬ â€“ Dense ì„±ëŠ¥ì„ 40 % FLOPsë¡œ ëŒì–´ë‚¸ â€˜ì„¸ë¶„í™”-ì „ë¬¸ê°€â€™ íŠ¸ë¦­ í•œ ì¤„ ìš”ì•½ (TL;DR) Fine-Grained Expert Segmentation (FGES) + Shared Experts (SEI) ë¡œ FFN-MoE..."><meta name=keywords content="2401.06066v1,"><meta name=author content><meta name=language content="ko"><meta name=robots content="index, follow"><link rel=canonical href=https://jaehun.me/ko/ko/posts/2025-06-29-paper-2401.06066v1/><link rel=icon type=image/svg+xml href=/favicon.svg><link rel=manifest href=/site.webmanifest><meta property="og:url" content="https://jaehun.me/ko/ko/posts/2025-06-29-paper-2401.06066v1/"><meta property="og:site_name" content="Jaehun's Blog"><meta property="og:title" content="DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><meta property="og:description" content="ë…¼ë¬¸ ë§í¬
DeepSeekMoE ì •ë¦¬ â€“ Dense ì„±ëŠ¥ì„ 40 % FLOPsë¡œ ëŒì–´ë‚¸ â€˜ì„¸ë¶„í™”-ì „ë¬¸ê°€â€™ íŠ¸ë¦­ í•œ ì¤„ ìš”ì•½ (TL;DR) Fine-Grained Expert Segmentation (FGES) + Shared Experts (SEI) ë¡œ FFN-MoEë¥¼ ì¬ì„¤ê³„í•œ DeepSeekMoEëŠ” ë™ì¼ FLOPsì—ì„œ Dense ìƒí•œì„ ì˜ 95 %â†‘ ì„±ëŠ¥ì„ ë‹¬ì„±í•˜ê³ , 16 B ëª¨ë¸ ê¸°ì¤€ LLaMA-2 7 Bì™€ ë™ê¸‰ í’ˆì§ˆì„ ì—°ì‚°ëŸ‰ 0.4Ã— ë¡œ êµ¬í˜„í•œë‹¤."><meta property="og:locale" content="ko_kr"><meta property="og:type" content="article"><meta property="article:section" content="ko"><meta property="article:published_time" content="2025-06-29T00:00:00+00:00"><meta property="article:modified_time" content="2025-06-29T00:00:00+00:00"><meta property="article:tag" content="2401.06066v1"><meta property="og:image" content="https://jaehun.me/images/og-default.avif"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://jaehun.me/images/og-default.avif"><meta name=twitter:title content="DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><meta name=twitter:description content="ë…¼ë¬¸ ë§í¬
DeepSeekMoE ì •ë¦¬ â€“ Dense ì„±ëŠ¥ì„ 40 % FLOPsë¡œ ëŒì–´ë‚¸ â€˜ì„¸ë¶„í™”-ì „ë¬¸ê°€â€™ íŠ¸ë¦­ í•œ ì¤„ ìš”ì•½ (TL;DR) Fine-Grained Expert Segmentation (FGES) + Shared Experts (SEI) ë¡œ FFN-MoEë¥¼ ì¬ì„¤ê³„í•œ DeepSeekMoEëŠ” ë™ì¼ FLOPsì—ì„œ Dense ìƒí•œì„ ì˜ 95 %â†‘ ì„±ëŠ¥ì„ ë‹¬ì„±í•˜ê³ , 16 B ëª¨ë¸ ê¸°ì¤€ LLaMA-2 7 Bì™€ ë™ê¸‰ í’ˆì§ˆì„ ì—°ì‚°ëŸ‰ 0.4Ã— ë¡œ êµ¬í˜„í•œë‹¤."><meta itemprop=name content="DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models"><meta itemprop=description content="ë…¼ë¬¸ ë§í¬
DeepSeekMoE ì •ë¦¬ â€“ Dense ì„±ëŠ¥ì„ 40 % FLOPsë¡œ ëŒì–´ë‚¸ â€˜ì„¸ë¶„í™”-ì „ë¬¸ê°€â€™ íŠ¸ë¦­ í•œ ì¤„ ìš”ì•½ (TL;DR) Fine-Grained Expert Segmentation (FGES) + Shared Experts (SEI) ë¡œ FFN-MoEë¥¼ ì¬ì„¤ê³„í•œ DeepSeekMoEëŠ” ë™ì¼ FLOPsì—ì„œ Dense ìƒí•œì„ ì˜ 95 %â†‘ ì„±ëŠ¥ì„ ë‹¬ì„±í•˜ê³ , 16 B ëª¨ë¸ ê¸°ì¤€ LLaMA-2 7 Bì™€ ë™ê¸‰ í’ˆì§ˆì„ ì—°ì‚°ëŸ‰ 0.4Ã— ë¡œ êµ¬í˜„í•œë‹¤."><meta itemprop=datePublished content="2025-06-29T00:00:00+00:00"><meta itemprop=dateModified content="2025-06-29T00:00:00+00:00"><meta itemprop=wordCount content="17659"><meta itemprop=image content="https://jaehun.me/images/og-default.avif"><meta itemprop=keywords content="2401.06066v1"><script>window.HUGO_SEARCH_CONFIG={searchIndexURL:'"/ko/index.json"'}</script><script>window.HUGO_GALLERY_CONFIG={justified_gallery:!1,lightbox:!1,justified:"{}",lightbox_options:"{}"}</script><link rel=stylesheet href=/css/compiled.min.9165cace5b80a5be5daad6ea96eb2abc20a18a3f41d7fed7f0335b689fdf7883.css integrity="sha256-kWXKzluApb5dqtbqlusqvCChij9B1/7X8DNbaJ/feIM=" crossorigin=anonymous><link rel=stylesheet href=/css/chroma.min.491df36221f739b5948a747a0351f100ee7ccaaf466d9f46288bf06de1d59123.css integrity="sha256-SR3zYiH3ObWUinR6A1HxAO58yq9GbZ9GKIvwbeHVkSM=" crossorigin=anonymous><script src=/js/main.ba969e49a7a874e6938fe689a7dcaa00cb64cb4d429c2cf98d09bde512a16c6d.js integrity="sha256-upaeSaeodOaTj+aJp9yqAMtky01CnCz5jQm95RKhbG0=" crossorigin=anonymous></script><script src=/js/gumshoe.polyfills.min.js></script><script src=/js/toc.70654aebf0b738a78ae2df95297cc10ebc6e590f3c942dd1325fa852f50038b2.js integrity="sha256-cGVK6/C3OKeK4t+VKXzBDrxuWQ88lC3RMl+oUvUAOLI=" crossorigin=anonymous defer></script><script src=/js/search.de3eba3540834efb8328121784bff4774e06362412ee41eee665f5b4f987f393.js integrity="sha256-3j66NUCDTvuDKBIXhL/0d04GNiQS7kHu5mX1tPmH85M=" crossorigin=anonymous defer></script><script src=/js/dock.e02f422517e001d9fb6bea1e9e8b0e89e9d2e486ad4641f275bb3e36ce2ae79f.js integrity="sha256-4C9CJRfgAdn7a+oenosOienS5IatRkHydbs+Ns4q558=" crossorigin=anonymous defer></script><script>(function(){const e=localStorage.getItem("theme")||"system",n=localStorage.getItem("colorScheme")||"claude";document.documentElement.setAttribute("data-theme",n);function t(){e==="dark"||e==="system"&&window.matchMedia("(prefers-color-scheme: dark)").matches?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")}t(),e==="system"&&window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",t)})()</script></head><body class="bg-background text-foreground min-h-screen antialiased"><div id=reading-progress-container class="reading-progress-container pointer-events-none fixed top-0 right-0 left-0 z-50 transition-opacity duration-300 ease-out" data-height=3 data-smooth-scroll=true data-hide-on-complete=false><div class="reading-progress-bg w-full"></div><div id=reading-progress-bar class="from-primary to-primary/80 reading-progress-bar
transition-all duration-150 ease-out
absolute top-0 left-0 w-0 bg-gradient-to-r"></div></div><script>(function(){"use strict";const t=document.getElementById("reading-progress-container"),o=document.getElementById("reading-progress-bar");if(!t||!o)return;const a={smoothScroll:t.dataset.smoothScroll==="true",hideOnComplete:t.dataset.hideOnComplete==="true"};let n=!0,l=null;function r(){const t=window.pageYOffset||document.documentElement.scrollTop,n=document.documentElement.scrollHeight,s=window.innerHeight,e=n-s;return e<=0?0:Math.min(Math.max(t/e*100,0),100)}function c(){const e=r();o.style.width=e+"%",a.hideOnComplete&&e>=99.5?n&&(t.style.opacity="0",n=!1):n||(t.style.opacity="1",n=!0)}let s=!1;function e(){s||(requestAnimationFrame(()=>{c(),s=!1}),s=!0)}function i(){window.addEventListener("scroll",e,{passive:!0}),window.addEventListener("resize",e,{passive:!0}),document.addEventListener("visibilitychange",()=>{document.hidden||e()}),e(),window.addEventListener("beforeunload",()=>{window.removeEventListener("scroll",e),window.removeEventListener("resize",e)})}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",i):i()})()</script><header class="sticky top-0 z-50 mx-auto max-w-4xl px-4 py-6"><div class="border-border bg-card/80 flex items-center rounded-xl border px-6 py-4 shadow-sm backdrop-blur-sm"><div class="hidden w-full items-center md:flex"><div class="flex items-center"><a href=/ko/ class="flex h-10 w-10 items-center justify-center overflow-hidden rounded-full transition-transform duration-200 hover:scale-105" aria-label="Jaehun's Blog"><img src=/images/logo.svg alt="Jaehun's Blog" class="h-full w-full object-cover"></a></div><nav class="mx-8 flex flex-1 items-center justify-center"><div class="flex items-center space-x-1"><a href=/ko/ class="nav-link
text-muted-foreground hover:text-primary hover:bg-primary/10
focus:ring-primary/20 relative flex items-center gap-2 rounded-lg px-4 py-2 text-sm font-medium transition-all duration-300 ease-out hover:-translate-y-0.5 hover:scale-105 focus:ring-2 focus:outline-none"><svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="nav.posts"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 20H5a2 2 0 01-2-2V6a2 2 0 012-2h10a2 2 0 012 2v1m2 13a2 2 0 01-2-2V7m2 13a2 2 0 002-2V9a2 2 0 00-2-2h-2m-4-3H9M7 16h6M7 8h6v4H7V8z"/></svg>
<span>ê²Œì‹œê¸€
</span></a><a href=/ko/categories/ class="nav-link
text-muted-foreground hover:text-primary hover:bg-primary/10
focus:ring-primary/20 relative flex items-center gap-2 rounded-lg px-4 py-2 text-sm font-medium transition-all duration-300 ease-out hover:-translate-y-0.5 hover:scale-105 focus:ring-2 focus:outline-none"><svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="nav.categories"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"/></svg>
<span>ì¹´í…Œê³ ë¦¬
</span></a><a href=/ko/tags/ class="nav-link
text-muted-foreground hover:text-primary hover:bg-primary/10
focus:ring-primary/20 relative flex items-center gap-2 rounded-lg px-4 py-2 text-sm font-medium transition-all duration-300 ease-out hover:-translate-y-0.5 hover:scale-105 focus:ring-2 focus:outline-none"><svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="nav.tags"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 7h.01M7 3h5c.512.0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828.0l-7-7A1.994 1.994.0 013 12V7a4 4 0 014-4z"/></svg>
<span>íƒœê·¸
</span></a><a href=/ko/ class="nav-link
text-muted-foreground hover:text-primary hover:bg-primary/10
focus:ring-primary/20 relative flex items-center gap-2 rounded-lg px-4 py-2 text-sm font-medium transition-all duration-300 ease-out hover:-translate-y-0.5 hover:scale-105 focus:ring-2 focus:outline-none"><svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="nav.archives"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 8h14M5 8a2 2 0 110-4h14a2 2 0 110 4M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8m-9 4h4"/></svg>
<span>ì•„ì¹´ì´ë¸Œ</span></a></div></nav><div class="flex items-center space-x-2"><div class=relative><button id=language-toggle class="dropdown-toggle border-border bg-background text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex h-10 w-10 items-center justify-center rounded-lg border transition-all duration-300 ease-out hover:scale-105 focus:ring-2 focus:outline-none active:scale-95" data-dropdown-type=language aria-label="ì–¸ì–´ ë³€ê²½" aria-expanded=false aria-haspopup=true>
<svg class="h-5 w-5 relative z-10" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="ì–¸ì–´ ë³€ê²½"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m5 8 6 6m-7 0 6-6 2-3M2 5h12M7 2h1m14 20-5-10-5 10m2-4h6"/></svg></button><div id=language-dropdown class="dropdown-menu border-border bg-popover/95 absolute top-12 right-0 z-[60] hidden w-40 rounded-lg border p-1 shadow-lg backdrop-blur-sm transition-all duration-200 ease-out" data-dropdown-type=language role=menu aria-labelledby=language-toggle><a href=/ko/ class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none" role=menuitem aria-current=true><span class=font-medium>í•œêµ­ì–´</span></a><a href=/en/ class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none" role=menuitem><span class=font-medium>English</span></a></div></div><div class=relative><button id=color-scheme-toggle class="dropdown-toggle border-border bg-background text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex h-10 w-10 items-center justify-center rounded-lg border transition-all duration-300 ease-out hover:scale-105 focus:ring-2 focus:outline-none active:scale-95" data-dropdown-type=color-scheme aria-label="í…Œë§ˆ ë³€ê²½" aria-expanded=false aria-haspopup=true>
<svg class="h-5 w-5 relative z-10" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="í…Œë§ˆ ë³€ê²½"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zM21 5a2 2 0 00-2-2h-4a2 2 0 00-2 2v6a2 2 0 002 2h4a2 2 0 002-2V5z"/></svg></button><div id=color-scheme-dropdown class="dropdown-menu border-border bg-popover/95 absolute top-12 right-0 z-[60] hidden w-44 rounded-lg border p-1 shadow-lg backdrop-blur-sm transition-all duration-200 ease-out" data-dropdown-type=color-scheme><button data-color-scheme=claude class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Default</span></button><button data-color-scheme=default class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>White</span></button><button data-color-scheme=bumblebee class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Bumblebee</span></button><button data-color-scheme=emerald class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Emerald</span></button><button data-color-scheme=nord class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Nord</span></button><button data-color-scheme=sunset class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Sunset</span></button><button data-color-scheme=abyss class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Abyss</span></button><button data-color-scheme=dracula class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Dracula</span></button><button data-color-scheme=amethyst class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Amethyst</span></button><button data-color-scheme=slate class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Slate</span></button><button data-color-scheme=twitter class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Twitter</span></button></div></div><div class=relative><button id=theme-toggle class="dropdown-toggle border-border bg-background text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex h-10 w-10 items-center justify-center rounded-lg border transition-all duration-300 ease-out hover:scale-105 focus:ring-2 focus:outline-none active:scale-95" data-dropdown-type=theme aria-label="í…Œë§ˆ ë³€ê²½" aria-expanded=false aria-haspopup=true>
<svg class="h-5 w-5 sun-icon hidden relative z-10" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="ë¼ì´íŠ¸"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364-.707-.707M6.343 6.343l-.707-.707m12.728.0-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"/></svg>
<svg class="h-5 w-5 moon-icon hidden relative z-10" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="ë‹¤í¬"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003.0 0012 21a9.003 9.003.0 008.354-5.646z"/></svg>
<svg class="h-5 w-5 system-icon hidden relative z-10" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="ì‹œìŠ¤í…œ"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.75 17 9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5A2 2 0 003 5v10a2 2 0 002 2z"/></svg></button><div id=theme-dropdown class="dropdown-menu border-border bg-popover/95 absolute top-12 right-0 z-[60] hidden w-40 rounded-lg border p-1 shadow-lg backdrop-blur-sm transition-all duration-200 ease-out" data-dropdown-type=theme><button data-theme=light class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none">
<svg class="h-5 w-5 mr-3 h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="ë¼ì´íŠ¸"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364-.707-.707M6.343 6.343l-.707-.707m12.728.0-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"/></svg><span>ë¼ì´íŠ¸</span></button><button data-theme=dark class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none">
<svg class="h-5 w-5 mr-3 h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="ë‹¤í¬"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003.0 0012 21a9.003 9.003.0 008.354-5.646z"/></svg><span>ë‹¤í¬</span></button><button data-theme=system class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none">
<svg class="h-5 w-5 mr-3 h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="ì‹œìŠ¤í…œ"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.75 17 9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5A2 2 0 003 5v10a2 2 0 002 2z"/></svg><span>ì‹œìŠ¤í…œ</span></button></div></div></div></div><div class="flex w-full items-center justify-between md:hidden"><div class=relative><button id=mobile-menu-toggle class="dropdown-toggle border-border bg-background text-muted-foreground hover:bg-accent hover:text-foreground flex h-10 w-10 items-center justify-center rounded-lg border transition-colors duration-200" data-dropdown-type=mobile-menu aria-label=ë©”ë‰´ aria-expanded=false aria-haspopup=true>
<svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="ë©”ë‰´"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/></svg></button><div id=mobile-menu class="mobile-menu dropdown-menu border-border bg-popover/95 absolute top-12 left-0 z-[60] hidden w-80 max-w-[calc(100vw-2rem)] rounded-lg border p-1 shadow-lg backdrop-blur-sm transition-all duration-200 ease-out md:hidden" data-dropdown-type=mobile-menu role=menu aria-labelledby=mobile-menu-toggle><nav class="flex flex-col"><a href=/ko/ class="nav-link
text-muted-foreground hover:text-primary hover:bg-primary/10
focus:ring-primary/20 relative flex items-center gap-3 rounded-md px-4 py-3 text-sm font-medium transition-all duration-200 ease-out hover:translate-x-1 focus:ring-2 focus:outline-none" role=menuitem><svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="nav.posts"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 20H5a2 2 0 01-2-2V6a2 2 0 012-2h10a2 2 0 012 2v1m2 13a2 2 0 01-2-2V7m2 13a2 2 0 002-2V9a2 2 0 00-2-2h-2m-4-3H9M7 16h6M7 8h6v4H7V8z"/></svg>
<span>ê²Œì‹œê¸€
</span></a><a href=/ko/categories/ class="nav-link
text-muted-foreground hover:text-primary hover:bg-primary/10
focus:ring-primary/20 relative flex items-center gap-3 rounded-md px-4 py-3 text-sm font-medium transition-all duration-200 ease-out hover:translate-x-1 focus:ring-2 focus:outline-none" role=menuitem><svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="nav.categories"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"/></svg>
<span>ì¹´í…Œê³ ë¦¬
</span></a><a href=/ko/tags/ class="nav-link
text-muted-foreground hover:text-primary hover:bg-primary/10
focus:ring-primary/20 relative flex items-center gap-3 rounded-md px-4 py-3 text-sm font-medium transition-all duration-200 ease-out hover:translate-x-1 focus:ring-2 focus:outline-none" role=menuitem><svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="nav.tags"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 7h.01M7 3h5c.512.0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828.0l-7-7A1.994 1.994.0 013 12V7a4 4 0 014-4z"/></svg>
<span>íƒœê·¸
</span></a><a href=/ko/ class="nav-link
text-muted-foreground hover:text-primary hover:bg-primary/10
focus:ring-primary/20 relative flex items-center gap-3 rounded-md px-4 py-3 text-sm font-medium transition-all duration-200 ease-out hover:translate-x-1 focus:ring-2 focus:outline-none" role=menuitem><svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="nav.archives"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 8h14M5 8a2 2 0 110-4h14a2 2 0 110 4M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8m-9 4h4"/></svg>
<span>ì•„ì¹´ì´ë¸Œ</span></a></nav></div></div><div class="flex items-center space-x-2"><div class=relative><button id=language-toggle class="dropdown-toggle border-border bg-background text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex h-10 w-10 items-center justify-center rounded-lg border transition-all duration-300 ease-out hover:scale-105 focus:ring-2 focus:outline-none active:scale-95" data-dropdown-type=language aria-label="ì–¸ì–´ ë³€ê²½" aria-expanded=false aria-haspopup=true>
<svg class="h-5 w-5 relative z-10" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="ì–¸ì–´ ë³€ê²½"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m5 8 6 6m-7 0 6-6 2-3M2 5h12M7 2h1m14 20-5-10-5 10m2-4h6"/></svg></button><div id=language-dropdown class="dropdown-menu border-border bg-popover/95 absolute top-12 right-0 z-[60] hidden w-40 rounded-lg border p-1 shadow-lg backdrop-blur-sm transition-all duration-200 ease-out" data-dropdown-type=language role=menu aria-labelledby=language-toggle><a href=/ko/ class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none" role=menuitem aria-current=true><span class=font-medium>í•œêµ­ì–´</span></a><a href=/en/ class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none" role=menuitem><span class=font-medium>English</span></a></div></div><div class=relative><button id=color-scheme-toggle class="dropdown-toggle border-border bg-background text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex h-10 w-10 items-center justify-center rounded-lg border transition-all duration-300 ease-out hover:scale-105 focus:ring-2 focus:outline-none active:scale-95" data-dropdown-type=color-scheme aria-label="í…Œë§ˆ ë³€ê²½" aria-expanded=false aria-haspopup=true>
<svg class="h-5 w-5 relative z-10" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="í…Œë§ˆ ë³€ê²½"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zM21 5a2 2 0 00-2-2h-4a2 2 0 00-2 2v6a2 2 0 002 2h4a2 2 0 002-2V5z"/></svg></button><div id=color-scheme-dropdown class="dropdown-menu border-border bg-popover/95 absolute top-12 right-0 z-[60] hidden w-44 rounded-lg border p-1 shadow-lg backdrop-blur-sm transition-all duration-200 ease-out" data-dropdown-type=color-scheme><button data-color-scheme=claude class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Default</span></button><button data-color-scheme=default class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>White</span></button><button data-color-scheme=bumblebee class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Bumblebee</span></button><button data-color-scheme=emerald class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Emerald</span></button><button data-color-scheme=nord class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Nord</span></button><button data-color-scheme=sunset class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Sunset</span></button><button data-color-scheme=abyss class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Abyss</span></button><button data-color-scheme=dracula class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Dracula</span></button><button data-color-scheme=amethyst class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Amethyst</span></button><button data-color-scheme=slate class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Slate</span></button><button data-color-scheme=twitter class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none"><span>Twitter</span></button></div></div><div class=relative><button id=theme-toggle class="dropdown-toggle border-border bg-background text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex h-10 w-10 items-center justify-center rounded-lg border transition-all duration-300 ease-out hover:scale-105 focus:ring-2 focus:outline-none active:scale-95" data-dropdown-type=theme aria-label="í…Œë§ˆ ë³€ê²½" aria-expanded=false aria-haspopup=true>
<svg class="h-5 w-5 sun-icon hidden relative z-10" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="ë¼ì´íŠ¸"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364-.707-.707M6.343 6.343l-.707-.707m12.728.0-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"/></svg>
<svg class="h-5 w-5 moon-icon hidden relative z-10" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="ë‹¤í¬"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003.0 0012 21a9.003 9.003.0 008.354-5.646z"/></svg>
<svg class="h-5 w-5 system-icon hidden relative z-10" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="ì‹œìŠ¤í…œ"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.75 17 9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5A2 2 0 003 5v10a2 2 0 002 2z"/></svg></button><div id=theme-dropdown class="dropdown-menu border-border bg-popover/95 absolute top-12 right-0 z-[60] hidden w-40 rounded-lg border p-1 shadow-lg backdrop-blur-sm transition-all duration-200 ease-out" data-dropdown-type=theme><button data-theme=light class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none">
<svg class="h-5 w-5 mr-3 h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="ë¼ì´íŠ¸"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364-.707-.707M6.343 6.343l-.707-.707m12.728.0-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"/></svg><span>ë¼ì´íŠ¸</span></button><button data-theme=dark class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none">
<svg class="h-5 w-5 mr-3 h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="ë‹¤í¬"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003.0 0012 21a9.003 9.003.0 008.354-5.646z"/></svg><span>ë‹¤í¬</span></button><button data-theme=system class="text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground flex w-full items-center rounded-md px-4 py-2 text-sm transition-all duration-200 ease-out focus:outline-none">
<svg class="h-5 w-5 mr-3 h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="ì‹œìŠ¤í…œ"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.75 17 9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5A2 2 0 003 5v10a2 2 0 002 2z"/></svg><span>ì‹œìŠ¤í…œ</span></button></div></div></div></div></div></header><main class="mx-auto max-w-4xl px-4 py-6"><nav class="breadcrumb mb-4 md:mb-6 py-1" aria-label=ê²½ë¡œ><ol class="text-muted-foreground flex items-center space-x-1 md:space-x-2 text-sm overflow-x-auto whitespace-nowrap scrollbar-hide py-1"><li class=flex-shrink-0><a href=/ko/ class="text-muted-foreground hover:text-primary hover:bg-primary/10 flex items-center gap-0.5 md:gap-1 rounded-lg px-1 md:px-3 py-0.5 md:py-1.5 transition-all duration-200 ease-out hover:-translate-y-0.5 hover:scale-[1.02]"><svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="í™ˆ"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m3 12 2-2m0 0 7-7 7 7M5 10v10a1 1 0 001 1h3m10-11 2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"/></svg>
<span class="max-w-[4rem] md:max-w-none truncate">í™ˆ</span></a></li><li class="flex items-center gap-1 md:gap-2 min-w-0"><span class="text-muted-foreground/50 flex-shrink-0"><svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/></svg></span><div class="flex items-center gap-1 md:gap-2 min-w-0"><a href=/ko class="text-muted-foreground hover:text-primary hover:bg-primary/10 flex items-center gap-0.5 md:gap-1 rounded-lg px-1 md:px-3 py-0.5 md:py-1.5 transition-all duration-200 ease-out hover:-translate-y-0.5 hover:scale-[1.02] flex-shrink-0"><svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5A2 2 0 003 7z"/></svg>
<span class="max-w-[4rem] md:max-w-none truncate">Ko</span>
</a><span class="text-muted-foreground/50 flex-shrink-0"><svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/></svg></span>
<span class="text-foreground flex items-center gap-0.5 md:gap-1 font-medium min-w-0"><svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/></svg>
<span class="max-w-[8rem] md:max-w-[16rem] lg:max-w-none truncate">DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models</span></span></div></li></ol></nav><header class=mb-8><h1 class="text-foreground mb-4 text-3xl font-bold md:text-4xl">DeepSeekMoE: Towards Ultimate Expert Specialization in Mixture-of-Experts Language Models</h1></header><article class="prose prose-neutral dark:prose-invert max-w-none"><p><a href=https://arxiv.org/abs/2401.06066v1>ë…¼ë¬¸ ë§í¬</a></p><h1 id=deepseekmoe-ì •ë¦¬--dense-ì„±ëŠ¥ì„-40--flopsë¡œ-ëŒì–´ë‚¸-ì„¸ë¶„í™”-ì „ë¬¸ê°€-íŠ¸ë¦­>DeepSeekMoE ì •ë¦¬ â€“ Dense ì„±ëŠ¥ì„ <strong>40 % FLOPs</strong>ë¡œ ëŒì–´ë‚¸ â€˜ì„¸ë¶„í™”-ì „ë¬¸ê°€â€™ íŠ¸ë¦­</h1><h2 id=í•œ-ì¤„-ìš”ì•½-tldr>í•œ ì¤„ ìš”ì•½ (TL;DR)</h2><p><strong>Fine-Grained Expert Segmentation (FGES) + Shared Experts (SEI)</strong> ë¡œ FFN-MoEë¥¼ ì¬ì„¤ê³„í•œ <strong>DeepSeekMoE</strong>ëŠ”
ë™ì¼ FLOPsì—ì„œ <strong>Dense ìƒí•œì„ ì˜ 95 %â†‘</strong> ì„±ëŠ¥ì„ ë‹¬ì„±í•˜ê³ , 16 B ëª¨ë¸ ê¸°ì¤€ <strong>LLaMA-2 7 Bì™€ ë™ê¸‰ í’ˆì§ˆì„ ì—°ì‚°ëŸ‰ 0.4Ã—</strong> ë¡œ êµ¬í˜„í•œë‹¤.</p><hr><h2 id=í•µì‹¬-ì•„ì´ë””ì–´>í•µì‹¬ ì•„ì´ë””ì–´</h2><blockquote class="border-primary bg-muted/30 hover:bg-muted/40 my-6 rounded-r-lg border-l-4 py-4 pr-4 pl-6 italic transition-all duration-200 ease-out hover:translate-x-1"><div class="prose prose-sm max-w-none"><p><strong>ì „ë¬¸ê°€ë¥¼ ë” ì˜ê²Œ ìª¼ê°œê³ (ì„¸ë¶„í™”), ê³µí†µ ì§€ì‹ì„ ë”°ë¡œ ëª¨ìœ¼ë©°(ê³µìœ  ì „ë¬¸ê°€), ë¶€í•˜ë¥¼ ì´ì¤‘ìœ¼ë¡œ ê· í˜• ì¡ìœ¼ë©´</strong>
<strong>MoEë„ Dense ëª¨ë¸ì²˜ëŸ¼ ì˜</strong> â€” ì•„ë‹ˆ, <strong>ë” íš¨ìœ¨ì ìœ¼ë¡œ</strong> â€” ë™ì‘í•œë‹¤.</p></div></blockquote><hr><h2 id=ë°°ê²½-ê·¸ë“¤ì´-í•´ê²°í•œ-ë¬¸ì œ>ë°°ê²½: ê·¸ë“¤ì´ í•´ê²°í•œ ë¬¸ì œ</h2><ol><li><p><strong>ê¸°ì¡´ MoE ë³‘ëª©</strong>
<em>Top-1/2</em> ë¼ìš°íŒ… + <em>8 ~ 16</em> ì „ë¬¸ê°€ â†’</p><ul><li><strong>ì§€ì‹ í˜¼í•©</strong>: í•œ ì „ë¬¸ê°€ê°€ ì—¬ëŸ¬ ì£¼ì œë¥¼ í•™ìŠµ</li><li><strong>ì§€ì‹ ì¤‘ë³µ</strong>: ì—¬ëŸ¬ ì „ë¬¸ê°€ê°€ ê°™ì€ ê³µí†µ íŒ¨í„´ì„ ë°˜ë³µ</li></ul></li><li><p><strong>Dense â‰¥ MoE ë”œë ˆë§ˆ</strong>
ì „ë¬¸ê°€ ìˆ˜ë¥¼ ëŠ˜ë¦¬ë©´ íŒŒë¼ë¯¸í„°ëŠ” í’ë¶€í•´ì§€ì§€ë§Œ <strong>í™œì„± íŒŒë¼ë¯¸í„°Â·FLOPs</strong> ê°€ ê·¸ëŒ€ë¡œë¼ <strong>ì„±ëŠ¥ ìƒí•œì´ ë‚®ë‹¤.</strong></p></li></ol><hr><h2 id=ìƒˆë¡œìš´-ì ‘ê·¼ë²•-deepseekmoe>ìƒˆë¡œìš´ ì ‘ê·¼ë²•: <strong>DeepSeekMoE</strong></h2><table><thead><tr><th>êµ¬ì„± ìš”ì†Œ</th><th>ë¬´ì—‡ì„ í•˜ë‚˜?</th><th>ì™œ ì¤‘ìš”í•œê°€?</th></tr></thead><tbody><tr><td><strong>Fine-Grained Expert Segmentation (FGES)</strong></td><td>FFN í•˜ë‚˜ë¥¼ <em>m</em> ê°œ ì†Œ(å°)-ì „ë¬¸ê°€ë¡œ ìª¼ê°œê³ , í† í°ë‹¹ í™œì„± ì „ë¬¸ê°€ ìˆ˜ë„ <em>mK</em> ë¡œ í™•ëŒ€</td><td>ì „ë¬¸ê°€ ì¡°í•© ìˆ˜ 120 â†’ <strong>4.4 G</strong> (â‰ˆ37 MÃ—) â†‘</td></tr><tr><td><strong>Shared Expert Isolation (SEI)</strong></td><td><em>Kâ‚›</em> ê°œ ê³µìœ  ì „ë¬¸ê°€ë¥¼ í•­ìƒ ON â†’ ê³µí†µ ì§€ì‹ ì „ë‹´</td><td>íŒŒë¼ë¯¸í„° ì¤‘ë³µ â†“, í† í°ë³„ ì „ë¬¸í™” â†‘</td></tr><tr><td><strong>Dual-Level Load-Balancing Loss</strong></td><td>ì „ë¬¸ê°€-ìˆ˜ì¤€ + ë””ë°”ì´ìŠ¤-ìˆ˜ì¤€ ë¶€í•˜ ê· í˜•</td><td>145 Bê¹Œì§€ <strong>ë¼ìš°íŒ… ë¶•ê´´ 0 %</strong>, GPU FLOPs í¸ì°¨ &lt; 5 %</td></tr></tbody></table><hr><h2 id=ì‘ë™-ì›ë¦¬-êµ¬ì²´ì ì¸-ì˜ˆì‹œë¡œ-ì‚´í´ë³´ê¸°>ì‘ë™ ì›ë¦¬: êµ¬ì²´ì ì¸ ì˜ˆì‹œë¡œ ì‚´í´ë³´ê¸°</h2><details><summary>ğŸ² 3 Ã— 3 í”½ì…€ toy ì˜ˆì‹œ (N = 2, m = 2, K = 1, Kâ‚› = 1)</summary><table><thead><tr><th>ë‹¨ê³„</th><th>ì§„í–‰</th><th>ê²°ê³¼</th></tr></thead><tbody><tr><td><strong>1. Affinity</strong></td><td>ê° í† í° Ã— 4 ì „ë¬¸ê°€ ìœ ì‚¬ë„ <code>sáµ¢,â‚œ</code> ê³„ì‚°</td><td>2 Ã— ì¹˜ìˆ˜ dot-product</td></tr><tr><td><strong>2. ì„ íƒ</strong></td><td>ê³µìœ  eâ‚ + ì¶”ê°€ Top-1 ì„ íƒ</td><td>í† í° uâ‚ â†’ {eâ‚,eâ‚‚}, uâ‚‚ â†’ {eâ‚,eâ‚ƒ} â€¦</td></tr><tr><td><strong>3. ê³„ì‚°</strong></td><td><code>hâ‚œ = Î£ gáµ¢,â‚œ FFNáµ¢(uâ‚œ) + uâ‚œ</code></td><td>ê²Œì´íŠ¸ gáµ¢,â‚œ ë¡œ ê°€ì¤‘í•©</td></tr><tr><td><strong>4. ê· í˜• ë¡œìŠ¤</strong></td><td>ì „ë¬¸ê°€Â·GPU FLOPs í¸ì°¨ ìµœì†Œí™”</td><td>ë¼ìš°íŒ… ë¶•ê´´ ë°©ì§€</td></tr></tbody></table></details><p><strong>ìš”ì </strong> â€“ ì„¸ë¶„í™” ë•ë¶„ì— <strong>í•˜ë‚˜ì˜ í† í°ì´ ë™ì‹œì— ë” ë§ì€ ì „ë¬¸ ì§€ì‹</strong> ì„ ê²°í•©í•˜ê³ , ê³µìœ  ì „ë¬¸ê°€ê°€ ê³µí†µ íŒ¨í„´ì„ í¡ìˆ˜í•´ <strong>ì¤‘ë³µì„ ì—†ì•¤ë‹¤.</strong></p><hr><h2 id=ì„±ëŠ¥-ê²€ì¦-ì£¼ìš”-ê²°ê³¼>ì„±ëŠ¥ ê²€ì¦: ì£¼ìš” ê²°ê³¼</h2><table><thead><tr><th>ëª¨ë¸</th><th>FLOPs/4k tok</th><th>Activated Params</th><th>HellaSwag Acc.â†‘</th><th>HumanEval Pass@1â†‘</th></tr></thead><tbody><tr><td><strong>Dense 7 B</strong></td><td>188 T</td><td>6.7 B</td><td>75.6</td><td>14.6</td></tr><tr><td><strong>DeepSeekMoE 16 B</strong></td><td><strong>74 T (0.40Ã—)</strong></td><td><strong>2.8 B</strong></td><td><strong>77.1 (+1.5)</strong></td><td><strong>26.8 (+84 %)</strong></td></tr><tr><td><strong>Dense Upper-Bound (2 B Ã—16 FFN)</strong></td><td>24.6 T</td><td>1.9 B</td><td>54.8</td><td>4.9</td></tr><tr><td><strong>DeepSeekMoE 2 B</strong></td><td><strong>4.3 T (0.17Ã—)</strong></td><td>0.24 B</td><td><strong>54.8 (=)</strong></td><td><strong>4.9 (=)</strong></td></tr></tbody></table><ul><li>16 B ëª¨ë¸, <strong>ë‹¨ì¼ A100-40 GB</strong> ì¶”ë¡  ê°€ëŠ¥ â†’ <strong>2.5Ã— í† í°/ì´ˆ</strong></li><li>145 B ì˜ˆë¹„ ëª¨ë¸, <strong>Dense 67 B</strong> ë™ê¸‰ í’ˆì§ˆì„ <strong>FLOPs 0.285Ã—</strong> ë¡œ ì¬í˜„</li></ul><hr><h2 id=ìš°ë¦¬ì˜-ê´€ì -ê°•ì -í•œê³„-ê·¸ë¦¬ê³ -ì´-ì—°êµ¬ê°€-ì¤‘ìš”í•œ-ì´ìœ >ìš°ë¦¬ì˜ ê´€ì : ê°•ì , í•œê³„, ê·¸ë¦¬ê³  ì´ ì—°êµ¬ê°€ ì¤‘ìš”í•œ ì´ìœ </h2><h3 id=-ê°•ì >ğŸ‘ ê°•ì </h3><ol><li><strong>ì—°ì‚°-íš¨ìœ¨ Pareto ì¬ì •ì˜</strong> â€“ Dense ëŒ€ë¹„ <strong>60 %â†“ FLOPs</strong> ë¡œ ë™ê¸‰Â·ìš°ìœ„ ì„±ëŠ¥.</li><li><strong>í•˜ë“œì›¨ì–´ ì¹œí™”ì„±</strong> â€“ í™œì„± íŒŒë¼ë¯¸í„° ì†Œìˆ˜ â†’ ì¤‘ê¸‰ GPUì—ì„œë„ ëŒ€ëª¨ë¸ ì¶”ë¡  ê°€ëŠ¥.</li><li><strong>ìŠ¤ì¼€ì¼ í™•ì¥ì„±</strong> â€“ Dual-loss ë•ë¶„ì— 145 BÂ·128 expertê¹Œì§€ <strong>ì„ í˜•ì— ê°€ê¹Œìš´</strong> ìŠ¤ë£¨í’‹.</li></ol><h3 id=-í•œê³„>âš ï¸ í•œê³„</h3><ul><li><strong>Attention ìš©ëŸ‰ ë¶€ì¡±</strong> â€“ MMLUÂ·CEval ë“± MCQ ê³¼ì œëŠ” Dense 7 Bë³´ë‹¤ -3 ~ -5 pp.</li><li><strong>ë¼ìš°íŒ… ì˜¤ë²„í—¤ë“œ</strong> â€“ ê²Œì´íŠ¸ ê³„ì‚°Â·All-to-All í†µì‹ ì´ ì¶”ë¡  FLOPs â‰ˆ 8 % ì¶”ê°€.</li><li><strong>í•«-ì „ë¬¸ê°€ bottleneck</strong> â€“ ê³µìœ  expertê°€ ê¸¸ì´â†‘ ì‹œ ì§€ì—°ì„ ìœ ë°œí•  ìˆ˜ ìˆìŒ.</li></ul><h3 id=-ì™œ-ì¤‘ìš”í•œê°€>ğŸŒŸ ì™œ ì¤‘ìš”í•œê°€?</h3><blockquote class="border-primary bg-muted/30 hover:bg-muted/40 my-6 rounded-r-lg border-l-4 py-4 pr-4 pl-6 italic transition-all duration-200 ease-out hover:translate-x-1"><div class="prose prose-sm max-w-none"><p><strong>â€œMoE=ì„±ëŠ¥â†“, íš¨ìœ¨â†‘â€ ê³µì‹ì„ ê¹¨ê³ , â€œMoEê°€ Dense ìƒí•œ ì„±ëŠ¥ê¹Œì§€ ë„ë‹¬â€</strong> í•  ìˆ˜ ìˆìŒì„ ì‹¤í—˜ìœ¼ë¡œ ì…ì¦í–ˆë‹¤. ì´ê²ƒì€ <strong>ëŒ€-ëª¨ë¸ ë¹„ìš© ì¥ë²½ì„ ì‹¤ìš©ì ìœ¼ë¡œ ë‚®ì¶”ëŠ”</strong> ê¸¸ì„ ì—°ë‹¤.</p></div></blockquote><hr><h2 id=ë‹¤ìŒ-ë‹¨ê³„ëŠ”-ì•ìœ¼ë¡œì˜-ê¸¸>ë‹¤ìŒ ë‹¨ê³„ëŠ”?: ì•ìœ¼ë¡œì˜ ê¸¸</h2><ol><li><strong>Attention ì¦ê°•</strong> â€“ GQAÂ·Flash-Sparse Attention ê²°í•©í•´ MCQ ì„±ëŠ¥ ë³´ì™„.</li><li><strong>Dynamic Shared-Expert Pool</strong> â€“ í•«-ì „ë¬¸ê°€ ë³‘ëª©ì„ ì™„í™”í•˜ê³  ì¥ë¬¸ ë””ì½”ë”© ê°€ì†.</li><li><strong>Topology-Aware Routing</strong> â€“ í†µì‹ ëŸ‰ 30 %â†“ ê°€ëŠ¥í•œ ê³„ì¸µì  ë¼ìš°íŒ… ì—°êµ¬.</li><li><strong>Privacy & Safety</strong> â€“ Expert-level DP ì¬í•™ìŠµ, í¸í–¥Â·ì €ì‘ê¶Œ ë°ì´í„° ì¹´ë“œ ê³µê°œ.</li><li><strong>145 B ì™„ì „ í•™ìŠµ & ì˜¤í”ˆ</strong> â€“ ì»¤ë®¤ë‹ˆí‹° SOTA ê¸°ì¤€ì ìœ¼ë¡œ ìë¦¬ë§¤ê¹€ ê¸°ëŒ€.</li></ol><hr><blockquote class="border-primary bg-muted/30 hover:bg-muted/40 my-6 rounded-r-lg border-l-4 py-4 pr-4 pl-6 italic transition-all duration-200 ease-out hover:translate-x-1"><div class="prose prose-sm max-w-none"><p><em>DeepSeekMoEëŠ” â€œê°™ì€ ëˆìœ¼ë¡œ ë” ë¹ ë¥´ê³ , ê°™ì€ ì†ë„ë¡œ ë” ë˜‘ë˜‘í•œâ€ ëª¨ë¸ì˜ ê°€ëŠ¥ì„±ì„ ë³´ì—¬ì¤€ë‹¤. ì•ìœ¼ë¡œ <strong>attention-heavy ì‘ì—…ê³¼ ì‹œìŠ¤í…œ ìµœì í™”</strong>ë¥¼ ì–´ë–»ê²Œ í’€ì–´ë‚´ëŠëƒê°€ ê´€ê±´ì´ë‹¤.</em></p></div></blockquote><hr><h3 id=í† ê¸€ì„-í´ë¦­í•˜ë©´-ë…¼ë¬¸ì—-ëŒ€í•œ-ìì„¸í•œ-llm-ì§ˆì˜ì‘ë‹µ-ë‚´ìš©ì„-í™•ì¸í• -ìˆ˜-ìˆìŠµë‹ˆë‹¤>í† ê¸€ì„ í´ë¦­í•˜ë©´ ë…¼ë¬¸ì— ëŒ€í•œ ìì„¸í•œ LLM ì§ˆì˜ì‘ë‹µ ë‚´ìš©ì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</h3><details markdown=block><summary>â–¶ï¸<strong>í´ë¦­í•˜ì—¬ í¼ì¹˜ê¸°</strong></summary><h1 id=í”„ë¡¬í”„íŠ¸-111-ì—°êµ¬ì˜-ê³µë°±>í”„ë¡¬í”„íŠ¸ 1.1.1 (ì—°êµ¬ì˜ ê³µë°±)</h1><div class="code-block-container border-border bg-card my-6 overflow-hidden rounded-xl border shadow-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:shadow-md"><div class="code-block-header bg-muted/30 border-border flex items-center justify-between border-b px-4 py-3"><div class="flex items-center gap-2"><div class="text-muted-foreground flex-shrink-0"><svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4 4 4-4 4M6 16l-4-4 4-4"/></svg></div><span class="text-muted-foreground text-sm font-medium">PLAINTEXT</span></div><div class="flex items-center gap-2"><button class="collapse-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-0 data-default-state=expanded data-collapsed=false data-auto-collapse-lines=30 data-auto-collapse-height=400 data-collapsed-height=120 title=ì ‘ê¸° aria-label=ì ‘ê¸°>
<span class=collapse-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41 12 10.83l4.59 4.58L18 14l-6-6-6 6z"/></svg>
</span><span class="collapse-text hidden sm:inline">ì ‘ê¸°</span>
</button>
<button class="copy-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-0 title=ë³µì‚¬ aria-label=ë³µì‚¬>
<span class=copy-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/></svg>
</span><span class="copy-text hidden sm:inline">ë³µì‚¬</span></button></div></div><div class="code-block-content relative" id=code-0><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=ln>1</span><span class=cl>&#34;ë…¼ë¬¸ì˜ &#39;Introduction&#39;ê³¼ &#39;Related Work&#39; ì„¹ì…˜ì„ ë¶„ì„í•˜ì—¬, ì´ ì—°êµ¬ê°€ ëª…ì‹œì ìœ¼ë¡œ í•´ê²°í•˜ê³ ì í•˜ëŠ” í•µì‹¬ì ì¸ ì—°êµ¬ ê³µë°±(research gap), ê¸°ì¡´ ì—°êµ¬ì˜ ê²°ì •ì  í•œê³„, ë˜ëŠ” ë¯¸í•´ê²° ì§ˆë¬¸ì´ ë¬´ì—‡ì¸ì§€ ì„¤ëª…í•´ ì¤˜. ì €ìë“¤ì´ ì„¤ëª…í•˜ëŠ”, ì´ ë…¼ë¬¸ ì¶œíŒ ì‹œì ì˜ &#39;ìµœì‹  ê¸°ìˆ (state of the art)&#39;ì€ ì–´ë–¤ ìƒíƒœì˜€ëŠ”ì§€ ìš”ì•½í•´ ì¤˜.&#34;</span></span></code></pre></div><div class="collapse-overlay to-card/90 pointer-events-none absolute inset-0 bg-gradient-to-b from-transparent via-transparent opacity-0 transition-opacity duration-300"><div class="text-muted-foreground bg-card/80 border-border/50 hover:bg-primary/10 hover:text-primary hover:border-primary/30 absolute bottom-4 left-1/2 -translate-x-1/2 cursor-pointer rounded-full border px-3 py-1.5 text-xs backdrop-blur-sm transition-all duration-200">í´ë¦­í•˜ì—¬ ë” ë³´ê¸°</div></div></div></div><script>(function(){const s="code-0",n=document.querySelector('.copy-code-btn[data-code-id="'+s+'"]'),t=document.querySelector('.collapse-code-btn[data-code-id="'+s+'"]'),e=document.getElementById(s);if(!e)return;if(n){const s=n.querySelector(".copy-icon"),t=n.querySelector(".copy-text");n.addEventListener("click",async function(){try{let o="";const i=e.querySelector(".lntd:last-child code");if(i)o=i.textContent||i.innerText;else{const t=e.querySelector("code");if(t){const e=t.querySelector(".ln");if(e){const e=t.querySelectorAll(".cl");if(e.length>0)o=Array.from(e).map(e=>{const t=e.textContent||e.innerText;return t.replace(/\n+$/,"")}).join(`
`).replace(/\n+$/,"");else{const e=t.textContent||t.innerText;o=e.replace(/^\d+/gm,"").replace(/^\s+/gm,"")}}else o=t.textContent||t.innerText}else o=e.textContent||e.innerText}o=o.trim(),await navigator.clipboard.writeText(o),s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
</svg>`,t&&(t.textContent="ë³µì‚¬ë¨"),n.classList.add("text-green-600"),setTimeout(()=>{s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
</svg>`,t&&(t.textContent="ë³µì‚¬"),n.classList.remove("text-green-600")},2e3)}catch(o){console.error("å¤åˆ¶å¤±è´¥:",o);const s=document.createRange(),i=e.querySelector("code")||e;s.selectNodeContents(i);const n=window.getSelection();n.removeAllRanges(),n.addRange(s),t&&(t.textContent="ì„ íƒë¨"),setTimeout(()=>{t&&(t.textContent="ë³µì‚¬"),n.removeAllRanges()},2e3)}})}if(t){const d=t.querySelector(".collapse-icon"),c=t.querySelector(".collapse-text"),n=e.querySelector(".collapse-overlay");let s=e.querySelector("pre.chroma");s||(s=e.querySelector("pre"));const m=t.dataset.defaultState||"expanded",f=t.dataset.collapsed==="true",u=parseInt(t.dataset.autoCollapseLines)||30,h=parseInt(t.dataset.autoCollapseHeight)||400,p=parseInt(t.dataset.collapsedHeight)||120;let l=!1;function i(){const e=f||m==="collapsed"||a();e&&o(!0,!1)}function a(){if(s){const e=s.querySelectorAll(".line, .cl"),t=s.offsetHeight;return e.length>u||t>h}const t=e.offsetHeight;if(t>h)return!0;const n=e.textContent||e.innerText||"",o=n.split(`
`).length;return o>u}function o(s,o=!0){if(!n)return;l=s,s?(e.style.maxHeight=p+"px",e.style.overflow="hidden",n.style.opacity="1",n.style.pointerEvents="auto",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
</svg>`,c&&(c.textContent="í¼ì¹˜ê¸°"),t.title="í¼ì¹˜ê¸°"):(e.style.maxHeight="",e.style.overflow="",n.style.opacity="0",n.style.pointerEvents="none",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z"/></svg>`,c&&(c.textContent="ì ‘ê¸°"),t.title="ì ‘ê¸°"),o&&(e.style.transition="max-height 0.3s ease-out",setTimeout(()=>{e.style.transition=""},300))}function r(){o(!l,!0)}t.addEventListener("click",r),n&&n.addEventListener("click",()=>{l&&o(!1,!0)}),i()}})()</script><h2 id=-í•œëˆˆì—-ë³´ëŠ”-ê²°ë¡ -tldr--research-gap>ğŸ—ï¸ í•œëˆˆì— ë³´ëŠ” ê²°ë¡  (TL;DR â€“ Research Gap)</h2><p>ê¸°ì¡´ <strong>MoE-Transformer</strong>ë“¤ì€ <em>í† í°ë‹¹ í™œì„±í™”ë˜ëŠ” ì „ë¬¸ê°€ ìˆ˜(Top-1/Top-2)</em> ê°€ ì ì–´ <strong>ì „ë¬¸ê°€ ê°„ ì§€ì‹ ì¤‘ì²©Â·í˜¼í•©</strong>ì´ ì‹¬ê°í–ˆê³ , ë”°ë¼ì„œ <strong>ë°€ì§‘(dense) ëª¨ë¸ ìƒí•œì„ (Upper-bound)</strong> ì— ê·¼ì ‘í•˜ì§€ ëª»í–ˆë‹¤.
DeepSeekMoEëŠ”</p><ol><li><strong>ì „ë¬¸ê°€ ì„¸ë¶„í™”(Fine-grained Segmentation, 1 â†’ <em>m</em> ë°°)</strong></li><li><strong>ê³µìœ  ì „ë¬¸ê°€ ê³ ì •(Shared Experts, Kâ‚›)</strong>
ì´ë¼ëŠ” ë‘ ê°€ì§€ ì„¤ê³„ë¡œ <strong>â€œê¶ê·¹ì  ì „ë¬¸ê°€ ì „ë¬¸í™”(Ultimate Expert Specialization)â€</strong> ë¬¸ì œë¥¼ ì •ì¡°ì¤€í•œë‹¤. ê²°ê³¼ì ìœ¼ë¡œ <em>ë™ë“± FLOPs ëŒ€ë¹„</em> <strong>GShardë³´ë‹¤ ìµœëŒ€ +2.4 ~ +4.9 pp</strong>(ARC-easy/HellaSwag) ì„±ëŠ¥ì„ ë‚´ë©°, <strong>í™œì„± íŒŒë¼ë¯¸í„°ëŠ” 60 % ì´ìƒ ì¤„ì—¬</strong> LLaMA-2 7Bì™€ ë¹„ìŠ·í•œ ì„±ëŠ¥ì„ ë‹¬ì„±í•œë‹¤.</li></ol><hr><h3 id=1-ì—°êµ¬-ê³µë°±research-gap--ë¬´ì—‡ì´-ë¹„ì–´-ìˆì—ˆë‚˜>1. ì—°êµ¬ ê³µë°±(Research Gap) â€” ë¬´ì—‡ì´ ë¹„ì–´ ìˆì—ˆë‚˜?</h3><table><thead><tr><th>ê´€ì </th><th>ê¸°ì¡´ ë°©ë²•</th><th>í•œê³„/ë¯¸í•´ê²° ì§ˆë¬¸</th><th>DeepSeekMoEì˜ í•´ê²°ì±…</th></tr></thead><tbody><tr><td><strong>ì „ë¬¸ê°€ ìˆ˜</strong></td><td>8 ~ 16ê°œ FFN ì „ë¬¸ê°€, Top-1/2 ë¼ìš°íŒ…(GShard, Switch)</td><td>â–¹ í•œ ì „ë¬¸ê°€ê°€ <em>ë‹¤ì–‘í•œ</em> í† í°ì„ í•™ìŠµ â†’ <strong>ì§€ì‹ í˜¼í•©(Hybridity)</strong><br>â–¹ ì—¬ëŸ¬ ì „ë¬¸ê°€ê°€ <em>ê°™ì€</em> ê¸°ì´ˆ ì§€ì‹ ë°˜ë³µ í•™ìŠµ â†’ <strong>ì§€ì‹ ì¤‘ë³µ(Redundancy)</strong></td><td><strong>m-way ì„¸ë¶„í™”</strong> â†’ ì „ë¬¸ê°€ ìˆ˜ Ã— m, í™œì„± ì „ë¬¸ê°€ ìˆ˜ë„ Ã— m â†’ í† í°ë³„ ì¡°í•© $<em>64C8 â‰ˆ 4.4 Ã— 10â¹</em>$ ìœ¼ë¡œ í­ì¦</td></tr><tr><td><strong>ê³µí†µ ì§€ì‹ ì²˜ë¦¬</strong></td><td>ëª¨ë“  ì „ë¬¸ê°€ê°€ ê³µí†µÂ·ì „ë¬¸ ì •ë³´ë¥¼ í˜¼í•© í•™ìŠµ</td><td>ê³µí†µ ì§€ì‹ì´ ì—¬ëŸ¬ ì „ë¬¸ê°€ì— ì¤‘ë³µ ì €ì¥ â†’ <strong>íŒŒë¼ë¯¸í„° ë¹„íš¨ìœ¨</strong></td><td><strong>Kâ‚›ê°œ ê³µìœ  ì „ë¬¸ê°€</strong>ë¥¼ í•­ìƒ í™œì„±í™” â†’ ê³µí†µ ì§€ì‹ ì§‘ì¤‘Â·ì¤‘ë³µ ì œê±°</td></tr><tr><td><strong>ë¡œë“œ ë°¸ëŸ°ìŠ¤</strong></td><td>ë¼ìš°íŒ… ë¶ˆì•ˆì • â†’ <em>routing collapse</em> ìœ„í—˜</td><td>ì „ë¬¸ê°€/ë””ë°”ì´ìŠ¤ ê°„ ë¶€í•˜ í¸ì¤‘</td><td><strong>ì´ì¤‘ ê· í˜• ë¡œìŠ¤</strong>(Expert-level Î±â‚, Device-level Î±â‚‚) ë„ì…</td></tr></tbody></table><blockquote class="border-primary bg-muted/30 hover:bg-muted/40 my-6 rounded-r-lg border-l-4 py-4 pr-4 pl-6 italic transition-all duration-200 ease-out hover:translate-x-1"><div class="prose prose-sm max-w-none"><p>ğŸ“Œ í•µì‹¬ ì§ˆë¬¸: <em>â€œì ì€ FLOPsë¡œ dense upper-boundì— ì–¼ë§ˆë‚˜ ê·¼ì ‘í•  ìˆ˜ ìˆëŠ”ê°€?â€</em></p></div></blockquote><hr><h3 id=2-ë‹¹ì‹œ-ìµœì‹ -ê¸°ìˆ state-of-the-art-ìš”ì•½>2. ë‹¹ì‹œ ìµœì‹  ê¸°ìˆ (State of the Art) ìš”ì•½</h3><table><thead><tr><th>ê³„ì—´</th><th>ëŒ€í‘œ ëª¨ë¸ & ê·œëª¨</th><th>ë¼ìš°íŒ… ë°©ì‹</th><th>FLOPs ëŒ€ë¹„ Activ. Params</th><th>í•œê³„</th></tr></thead><tbody><tr><td><strong>GShard</strong></td><td>600 B~1 T(Top-2)</td><td>Learnable Top-2</td><td>FLOPs â†‘(2Ã— FFN)<br>Activ. â‰ˆ 0.3 B @2 B total</td><td>ì§€ì‹ í˜¼í•©Â·ì¤‘ë³µ, load collapse</td></tr><tr><td><strong>Switch Transformer</strong></td><td>1.6 T(Top-1)</td><td>Learnable Top-1</td><td>Activ. = 1Ã— FFN</td><td>í† í°-ì „ë¬¸ê°€ ë§¤ì¹­ ë‹¨ìˆœ â†’ í‘œí˜„ë ¥â†“</td></tr><tr><td><strong>Hash Layer</strong></td><td>10 B(Top-1 Hash)</td><td>Fixed Hash</td><td>Activ. = 1Ã— FFN</td><td>ë¼ìš°íŒ… ê³ ì • â†’ ì ì‘ë ¥â†“</td></tr><tr><td><strong>ST-MoE / GLAM</strong></td><td>64 B~1 T(Top-k, Aux. Loss)</td><td>ì•ˆì •í™” ê¸°ë²• ì¶”ê°€</td><td>Activ. 1~2Ã— FFN</td><td>ì „ë¬¸ê°€ ì „ë¬¸í™” ë¶€ì¡±</td></tr></tbody></table><p>ì´ì²˜ëŸ¼ <strong>â€œì „ë¬¸ê°€ ì „ë¬¸í™” ë¶€ì¡± + íŒŒë¼ë¯¸í„° ì¤‘ë³µâ€</strong> ë¬¸ì œê°€ ê³µí†µ ë³‘ëª©ìœ¼ë¡œ ë‚¨ì•„ ìˆì—ˆë‹¤. DeepSeekMoEëŠ” <strong>ì „ë¬¸ê°€ ì„¸ë¶„í™”(ìµœëŒ€ 4 Ã—) + ê³µìœ  ì „ë¬¸ê°€ ê²©ë¦¬</strong> ë¡œ ì´ ê°­ì„ í•´ì†Œí•˜ë©°,</p><ul><li><strong>2 B ì‹¤í—˜</strong>ì—ì„œ <em>GShard ë™ì¼ FLOPs</em> ëŒ€ë¹„ <strong>í‰ê·  +3.2 pp</strong>,</li><li><strong>16 B ëª¨ë¸</strong>ì—ì„œ <strong>LLaMA-2 7Bì™€ ë™ê¸‰ ì„±ëŠ¥</strong>ì„ <strong>FLOPs 0.40Ã—</strong> ë¡œ ë‹¬ì„±í•œë‹¤.</li></ul><h1 id=í”„ë¡¬í”„íŠ¸-112-í•µì‹¬-ê°€ì„¤>í”„ë¡¬í”„íŠ¸ 1.1.2 (í•µì‹¬ ê°€ì„¤)</h1><div class="code-block-container border-border bg-card my-6 overflow-hidden rounded-xl border shadow-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:shadow-md"><div class="code-block-header bg-muted/30 border-border flex items-center justify-between border-b px-4 py-3"><div class="flex items-center gap-2"><div class="text-muted-foreground flex-shrink-0"><svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4 4 4-4 4M6 16l-4-4 4-4"/></svg></div><span class="text-muted-foreground text-sm font-medium">PLAINTEXT</span></div><div class="flex items-center gap-2"><button class="collapse-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-1 data-default-state=expanded data-collapsed=false data-auto-collapse-lines=30 data-auto-collapse-height=400 data-collapsed-height=120 title=ì ‘ê¸° aria-label=ì ‘ê¸°>
<span class=collapse-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41 12 10.83l4.59 4.58L18 14l-6-6-6 6z"/></svg>
</span><span class="collapse-text hidden sm:inline">ì ‘ê¸°</span>
</button>
<button class="copy-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-1 title=ë³µì‚¬ aria-label=ë³µì‚¬>
<span class=copy-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/></svg>
</span><span class="copy-text hidden sm:inline">ë³µì‚¬</span></button></div></div><div class="code-block-content relative" id=code-1><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=ln>1</span><span class=cl>&#34;ì´ ë…¼ë¬¸ì˜ ì¤‘ì‹¬ ê°€ì„¤(central hypothesis) ë˜ëŠ” í•µì‹¬ ì£¼ì¥ì€ ë¬´ì—‡ì¸ê°€? &#39;ì €ìë“¤ì€ [ì œì•ˆ ê¸°ë²•]ì„ ì‚¬ìš©í•¨ìœ¼ë¡œì¨ [ê¸°ì¡´ í•œê³„ì ]ì„ ê·¹ë³µí•˜ëŠ” [êµ¬ì²´ì  ê²°ê³¼]ë¥¼ ë‹¬ì„±í•  ìˆ˜ ìˆë‹¤ê³  ê°€ì •í•œë‹¤&#39;ì™€ ê°™ì€ í˜•ì‹ìœ¼ë¡œ, ëª…í™•í•˜ê³  ê°„ê²°í•œ í•œ ë¬¸ì¥ìœ¼ë¡œ ì„œìˆ í•´ ì¤˜.&#34;</span></span></code></pre></div><div class="collapse-overlay to-card/90 pointer-events-none absolute inset-0 bg-gradient-to-b from-transparent via-transparent opacity-0 transition-opacity duration-300"><div class="text-muted-foreground bg-card/80 border-border/50 hover:bg-primary/10 hover:text-primary hover:border-primary/30 absolute bottom-4 left-1/2 -translate-x-1/2 cursor-pointer rounded-full border px-3 py-1.5 text-xs backdrop-blur-sm transition-all duration-200">í´ë¦­í•˜ì—¬ ë” ë³´ê¸°</div></div></div></div><script>(function(){const s="code-1",n=document.querySelector('.copy-code-btn[data-code-id="'+s+'"]'),t=document.querySelector('.collapse-code-btn[data-code-id="'+s+'"]'),e=document.getElementById(s);if(!e)return;if(n){const s=n.querySelector(".copy-icon"),t=n.querySelector(".copy-text");n.addEventListener("click",async function(){try{let o="";const i=e.querySelector(".lntd:last-child code");if(i)o=i.textContent||i.innerText;else{const t=e.querySelector("code");if(t){const e=t.querySelector(".ln");if(e){const e=t.querySelectorAll(".cl");if(e.length>0)o=Array.from(e).map(e=>{const t=e.textContent||e.innerText;return t.replace(/\n+$/,"")}).join(`
`).replace(/\n+$/,"");else{const e=t.textContent||t.innerText;o=e.replace(/^\d+/gm,"").replace(/^\s+/gm,"")}}else o=t.textContent||t.innerText}else o=e.textContent||e.innerText}o=o.trim(),await navigator.clipboard.writeText(o),s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
</svg>`,t&&(t.textContent="ë³µì‚¬ë¨"),n.classList.add("text-green-600"),setTimeout(()=>{s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
</svg>`,t&&(t.textContent="ë³µì‚¬"),n.classList.remove("text-green-600")},2e3)}catch(o){console.error("å¤åˆ¶å¤±è´¥:",o);const s=document.createRange(),i=e.querySelector("code")||e;s.selectNodeContents(i);const n=window.getSelection();n.removeAllRanges(),n.addRange(s),t&&(t.textContent="ì„ íƒë¨"),setTimeout(()=>{t&&(t.textContent="ë³µì‚¬"),n.removeAllRanges()},2e3)}})}if(t){const d=t.querySelector(".collapse-icon"),c=t.querySelector(".collapse-text"),n=e.querySelector(".collapse-overlay");let s=e.querySelector("pre.chroma");s||(s=e.querySelector("pre"));const m=t.dataset.defaultState||"expanded",f=t.dataset.collapsed==="true",u=parseInt(t.dataset.autoCollapseLines)||30,h=parseInt(t.dataset.autoCollapseHeight)||400,p=parseInt(t.dataset.collapsedHeight)||120;let l=!1;function i(){const e=f||m==="collapsed"||a();e&&o(!0,!1)}function a(){if(s){const e=s.querySelectorAll(".line, .cl"),t=s.offsetHeight;return e.length>u||t>h}const t=e.offsetHeight;if(t>h)return!0;const n=e.textContent||e.innerText||"",o=n.split(`
`).length;return o>u}function o(s,o=!0){if(!n)return;l=s,s?(e.style.maxHeight=p+"px",e.style.overflow="hidden",n.style.opacity="1",n.style.pointerEvents="auto",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
</svg>`,c&&(c.textContent="í¼ì¹˜ê¸°"),t.title="í¼ì¹˜ê¸°"):(e.style.maxHeight="",e.style.overflow="",n.style.opacity="0",n.style.pointerEvents="none",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z"/></svg>`,c&&(c.textContent="ì ‘ê¸°"),t.title="ì ‘ê¸°"),o&&(e.style.transition="max-height 0.3s ease-out",setTimeout(()=>{e.style.transition=""},300))}function r(){o(!l,!0)}t.addEventListener("click",r),n&&n.addEventListener("click",()=>{l&&o(!1,!0)}),i()}})()</script><h3 id=-central-hypothesis>ğŸš€ Central Hypothesis</h3><blockquote class="border-primary bg-muted/30 hover:bg-muted/40 my-6 rounded-r-lg border-l-4 py-4 pr-4 pl-6 italic transition-all duration-200 ease-out hover:translate-x-1"><div class="prose prose-sm max-w-none"><p>**ì €ìë“¤ì€ _fine-grained expert segmentation_ê³¼ _shared expert isolation_ìœ¼ë¡œ êµ¬ì„±ëœ <strong>DeepSeekMoE</strong> ì•„í‚¤í…ì²˜ë¥¼ ë„ì…í•¨ìœ¼ë¡œì¨, ê¸°ì¡´ MoE ëª¨ë¸ì˜ ì „ë¬¸ê°€ ì§€ì‹ í˜¼í•©Â·ì¤‘ë³µ ë° íŒŒë¼ë¯¸í„° ë¹„íš¨ìœ¨ í•œê³„ë¥¼ ê·¹ë³µí•˜ê³ , ë™ì¼ FLOPsì—ì„œ ë°€ì§‘(dense) ëª¨ë¸ ì„±ëŠ¥ ìƒí•œì„ ì— ê·¼ì ‘â€”ì˜ˆì»¨ëŒ€ 2 B ëª¨ë¸ì´ GShard 2 Bë³´ë‹¤ â‰ˆ +3 pp, 16 B ëª¨ë¸ì´ LLaMA-2 7Bì™€ ë™ê¸‰ ì„±ëŠ¥ì„ ì—°ì‚°ëŸ‰ 0.4Ã—ë¡œ ë‹¬ì„±â€”í•  ìˆ˜ ìˆë‹¤ê³  ê°€ì •í•œë‹¤.</p></div></blockquote><h1 id=í”„ë¡¬í”„íŠ¸-121-ë…ì°½ì„±-ì‹ë³„>í”„ë¡¬í”„íŠ¸ 1.2.1 (ë…ì°½ì„± ì‹ë³„)</h1><div class="code-block-container border-border bg-card my-6 overflow-hidden rounded-xl border shadow-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:shadow-md"><div class="code-block-header bg-muted/30 border-border flex items-center justify-between border-b px-4 py-3"><div class="flex items-center gap-2"><div class="text-muted-foreground flex-shrink-0"><svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4 4 4-4 4M6 16l-4-4 4-4"/></svg></div><span class="text-muted-foreground text-sm font-medium">PLAINTEXT</span></div><div class="flex items-center gap-2"><button class="collapse-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-2 data-default-state=expanded data-collapsed=false data-auto-collapse-lines=30 data-auto-collapse-height=400 data-collapsed-height=120 title=ì ‘ê¸° aria-label=ì ‘ê¸°>
<span class=collapse-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41 12 10.83l4.59 4.58L18 14l-6-6-6 6z"/></svg>
</span><span class="collapse-text hidden sm:inline">ì ‘ê¸°</span>
</button>
<button class="copy-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-2 title=ë³µì‚¬ aria-label=ë³µì‚¬>
<span class=copy-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/></svg>
</span><span class="copy-text hidden sm:inline">ë³µì‚¬</span></button></div></div><div class="code-block-content relative" id=code-2><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=ln>1</span><span class=cl> &#34;ë…¼ë¬¸ ì „ì²´ë¥¼ ë°”íƒ•ìœ¼ë¡œ, ê°€ì¥ ì¤‘ìš”í•˜ê³  ë…ì°½ì ì¸ ê¸°ì—¬(contribution) 1~3ê°€ì§€ë¥¼ êµ¬ë³„ë˜ëŠ” í•­ëª©ìœ¼ë¡œ ë‚˜ì—´í•´ ì¤˜. ê°ê°ì´ ìƒˆë¡œìš´ ì•„í‚¤í…ì²˜ êµ¬ì„±ìš”ì†Œ, ìƒˆë¡œìš´ í•™ìŠµ ê¸°ë²•, ìƒˆë¡œìš´ ì´ë¡ ì  í†µì°°, ìƒˆë¡œìš´ ë°ì´í„°ì…‹, ë˜ëŠ” ê¸°ì¡´ ë°©ë²•ë¡ ì˜ ìƒˆë¡œìš´ ì ìš© ì¤‘ ì–´ë””ì— í•´ë‹¹í•˜ëŠ”ì§€ ëª…í™•íˆ êµ¬ë¶„í•´ ì¤˜.&#34;</span></span></code></pre></div><div class="collapse-overlay to-card/90 pointer-events-none absolute inset-0 bg-gradient-to-b from-transparent via-transparent opacity-0 transition-opacity duration-300"><div class="text-muted-foreground bg-card/80 border-border/50 hover:bg-primary/10 hover:text-primary hover:border-primary/30 absolute bottom-4 left-1/2 -translate-x-1/2 cursor-pointer rounded-full border px-3 py-1.5 text-xs backdrop-blur-sm transition-all duration-200">í´ë¦­í•˜ì—¬ ë” ë³´ê¸°</div></div></div></div><script>(function(){const s="code-2",n=document.querySelector('.copy-code-btn[data-code-id="'+s+'"]'),t=document.querySelector('.collapse-code-btn[data-code-id="'+s+'"]'),e=document.getElementById(s);if(!e)return;if(n){const s=n.querySelector(".copy-icon"),t=n.querySelector(".copy-text");n.addEventListener("click",async function(){try{let o="";const i=e.querySelector(".lntd:last-child code");if(i)o=i.textContent||i.innerText;else{const t=e.querySelector("code");if(t){const e=t.querySelector(".ln");if(e){const e=t.querySelectorAll(".cl");if(e.length>0)o=Array.from(e).map(e=>{const t=e.textContent||e.innerText;return t.replace(/\n+$/,"")}).join(`
`).replace(/\n+$/,"");else{const e=t.textContent||t.innerText;o=e.replace(/^\d+/gm,"").replace(/^\s+/gm,"")}}else o=t.textContent||t.innerText}else o=e.textContent||e.innerText}o=o.trim(),await navigator.clipboard.writeText(o),s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
</svg>`,t&&(t.textContent="ë³µì‚¬ë¨"),n.classList.add("text-green-600"),setTimeout(()=>{s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
</svg>`,t&&(t.textContent="ë³µì‚¬"),n.classList.remove("text-green-600")},2e3)}catch(o){console.error("å¤åˆ¶å¤±è´¥:",o);const s=document.createRange(),i=e.querySelector("code")||e;s.selectNodeContents(i);const n=window.getSelection();n.removeAllRanges(),n.addRange(s),t&&(t.textContent="ì„ íƒë¨"),setTimeout(()=>{t&&(t.textContent="ë³µì‚¬"),n.removeAllRanges()},2e3)}})}if(t){const d=t.querySelector(".collapse-icon"),c=t.querySelector(".collapse-text"),n=e.querySelector(".collapse-overlay");let s=e.querySelector("pre.chroma");s||(s=e.querySelector("pre"));const m=t.dataset.defaultState||"expanded",f=t.dataset.collapsed==="true",u=parseInt(t.dataset.autoCollapseLines)||30,h=parseInt(t.dataset.autoCollapseHeight)||400,p=parseInt(t.dataset.collapsedHeight)||120;let l=!1;function i(){const e=f||m==="collapsed"||a();e&&o(!0,!1)}function a(){if(s){const e=s.querySelectorAll(".line, .cl"),t=s.offsetHeight;return e.length>u||t>h}const t=e.offsetHeight;if(t>h)return!0;const n=e.textContent||e.innerText||"",o=n.split(`
`).length;return o>u}function o(s,o=!0){if(!n)return;l=s,s?(e.style.maxHeight=p+"px",e.style.overflow="hidden",n.style.opacity="1",n.style.pointerEvents="auto",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
</svg>`,c&&(c.textContent="í¼ì¹˜ê¸°"),t.title="í¼ì¹˜ê¸°"):(e.style.maxHeight="",e.style.overflow="",n.style.opacity="0",n.style.pointerEvents="none",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z"/></svg>`,c&&(c.textContent="ì ‘ê¸°"),t.title="ì ‘ê¸°"),o&&(e.style.transition="max-height 0.3s ease-out",setTimeout(()=>{e.style.transition=""},300))}function r(){o(!l,!0)}t.addEventListener("click",r),n&&n.addEventListener("click",()=>{l&&o(!1,!0)}),i()}})()</script><h3 id=-tldr--deepseekmoeì˜-ë…ì°½ì -ê³µí—Œ-3ê°€ì§€>ğŸš© TL;DR â€” DeepSeekMoEì˜ ë…ì°½ì  ê³µí—Œ 3ê°€ì§€</h3><p><em>ë‘ ê°€ì§€ ì•„í‚¤í…ì²˜ í˜ì‹  + í•œ ê°€ì§€ í•™ìŠµ ì•ˆì •í™” ê¸°ë²•ìœ¼ë¡œ â€œê¶ê·¹ì  ì „ë¬¸ê°€ ì „ë¬¸í™”(ultimate expert-specialization)â€ë¥¼ ì‹¤í˜„í•œë‹¤.</em></p><table><thead><tr><th>#</th><th>í•µì‹¬ ê¸°ì—¬</th><th>ë¶„ë¥˜</th><th>ì™œ ì¤‘ìš”í•œê°€? (ìˆ˜ì¹˜Â·ì§€í‘œ)</th></tr></thead><tbody><tr><td><strong>1</strong></td><td><strong>Fine-Grained Expert Segmentation (FGES)</strong><br>â€“ ê¸°ì¡´ FFN ì „ë¬¸ê°€ë¥¼ <em>m</em> ë°°ë¡œ ì„¸ë¶„í™”í•˜ê³  Top-k í™œì„± ì „ë¬¸ê°€ ìˆ˜ë„ <em>m</em> ë°°ë¡œ í™•ì¥</td><td><strong>ìƒˆë¡œìš´ ì•„í‚¤í…ì²˜ êµ¬ì„±ìš”ì†Œ</strong></td><td>ì¡°í•© ê°€ëŠ¥ ì „ë¬¸ê°€ ì§‘í•©ì´ Top-2(16C2 = 120) â†’ FGES(64C8 â‰ˆ 4.4 Ã— 10â¹)ë¡œ <strong>3.7 Ã— 10â·ë°°</strong> ì¦ê°€í•˜ì—¬ í† í°-ì „ë¬¸ê°€ ë§¤í•‘ í‘œí˜„ë ¥ì„ ê·¹ëŒ€í™”</td></tr><tr><td><strong>2</strong></td><td><strong>Shared Expert Isolation (SEI)</strong><br>â€“ Kâ‚›ê°œ ê³µìœ  ì „ë¬¸ê°€ë¥¼ í•­ìƒ í™œì„±í™”í•´ ê³µí†µ ì§€ì‹ì„ ì „ë‹´, ë‚˜ë¨¸ì§€ ì „ë¬¸ê°€ë“¤ì€ ìˆœìˆ˜ ì „ë¬¸ ì§€ì‹ë§Œ í•™ìŠµ</td><td><strong>ìƒˆë¡œìš´ ì•„í‚¤í…ì²˜ êµ¬ì„±ìš”ì†Œ</strong></td><td>íŒŒë¼ë¯¸í„° ì¤‘ë³µì„ ì–µì œí•´ ê°™ì€ 2 B ëª¨ë¸ì—ì„œë„ <strong>GShard ëŒ€ë¹„ +3 pp</strong>(ARC-easy ë“± 12 ë²¤ì¹˜ í‰ê· ) ì„±ëŠ¥ í–¥ìƒ, í™œì„± íŒŒë¼ë¯¸í„° 60 % ì ˆê°</td></tr><tr><td><strong>3</strong></td><td><strong>Dual-Level Load-Balancing Loss</strong><br>â€“ Expert-level(Î±â‚) + Device-level(Î±â‚‚) ê· í˜• ë¡œìŠ¤ë¡œ í† í° ë¶„ë°° ë¶ˆê· í˜•Â·ë¼ìš°íŒ… ë¶•ê´´ ë°©ì§€</td><td><strong>ìƒˆë¡œìš´ í•™ìŠµ ê¸°ë²•</strong></td><td>ì „ë¬¸ê°€ë‹¹ ì„ íƒ í¸ì°¨ë¥¼ <strong>NÂ·Tâ»Â¹ ìˆ˜ì¤€ìœ¼ë¡œ ê· ë“±í™”</strong>í•˜ë©´ì„œë„ ë””ë°”ì´ìŠ¤ ê°„ FLOPs ì˜¤ì°¨ &lt; 5 % ìœ ì§€ â†’ ëŒ€ê·œëª¨(145 B) ì‹¤í—˜ì—ì„œë„ ì•ˆì • ìˆ˜ë ´</td></tr></tbody></table><blockquote class="border-primary bg-muted/30 hover:bg-muted/40 my-6 rounded-r-lg border-l-4 py-4 pr-4 pl-6 italic transition-all duration-200 ease-out hover:translate-x-1"><div class="prose prose-sm max-w-none"><p>ğŸ“Œ ê²°ê³¼ì ìœ¼ë¡œ DeepSeekMoE <strong>16 B</strong>ëŠ” <strong>LLaMA-2 7 B</strong>ì™€ ë§ë¨¹ëŠ” ì„±ëŠ¥ì„ **ì—°ì‚°ëŸ‰ 0.4Ã—**ë¡œ ë‹¬ì„±í•˜ê³ , <strong>145 B</strong> ëª¨ë¸ì€ Dense 67 B ìˆ˜ì¤€ì„ **FLOPs 28.5 %**ë¡œ ì¬í˜„í•œë‹¤ .</p></div></blockquote><h1 id=í”„ë¡¬í”„íŠ¸-122-ì €ì-ê´€ì ì—ì„œì˜-ê°•ì >í”„ë¡¬í”„íŠ¸ 1.2.2 (ì €ì ê´€ì ì—ì„œì˜ ê°•ì )</h1><div class="code-block-container border-border bg-card my-6 overflow-hidden rounded-xl border shadow-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:shadow-md"><div class="code-block-header bg-muted/30 border-border flex items-center justify-between border-b px-4 py-3"><div class="flex items-center gap-2"><div class="text-muted-foreground flex-shrink-0"><svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4 4 4-4 4M6 16l-4-4 4-4"/></svg></div><span class="text-muted-foreground text-sm font-medium">PLAINTEXT</span></div><div class="flex items-center gap-2"><button class="collapse-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-3 data-default-state=expanded data-collapsed=false data-auto-collapse-lines=30 data-auto-collapse-height=400 data-collapsed-height=120 title=ì ‘ê¸° aria-label=ì ‘ê¸°>
<span class=collapse-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41 12 10.83l4.59 4.58L18 14l-6-6-6 6z"/></svg>
</span><span class="collapse-text hidden sm:inline">ì ‘ê¸°</span>
</button>
<button class="copy-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-3 title=ë³µì‚¬ aria-label=ë³µì‚¬>
<span class=copy-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/></svg>
</span><span class="copy-text hidden sm:inline">ë³µì‚¬</span></button></div></div><div class="code-block-content relative" id=code-3><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=ln>1</span><span class=cl>&#34;ì €ìë“¤ì˜ ê´€ì ì—ì„œ, ìì‹ ë“¤ì˜ ì ‘ê·¼ë²•ì´ ì´ì „ ë°©ë²•ë“¤ë³´ë‹¤ ìš°ì›”í•œ ì´ìœ ëŠ” ë¬´ì—‡ì¸ê°€? ê·¸ë“¤ì´ ìì‹ ë“¤ì˜ ì—°êµ¬ê°€ ì§€ë‹Œ ë…ì°½ì„±ê³¼ ê°•ì ì„ ë’·ë°›ì¹¨í•˜ê¸° ìœ„í•´ ì‚¬ìš©í•˜ëŠ” í•µì‹¬ ë…¼ê±°ë¥¼ ì¸ìš©í•˜ê±°ë‚˜ ì•Œê¸° ì‰½ê²Œ ì„¤ëª…í•´ ì¤˜.&#34;</span></span></code></pre></div><div class="collapse-overlay to-card/90 pointer-events-none absolute inset-0 bg-gradient-to-b from-transparent via-transparent opacity-0 transition-opacity duration-300"><div class="text-muted-foreground bg-card/80 border-border/50 hover:bg-primary/10 hover:text-primary hover:border-primary/30 absolute bottom-4 left-1/2 -translate-x-1/2 cursor-pointer rounded-full border px-3 py-1.5 text-xs backdrop-blur-sm transition-all duration-200">í´ë¦­í•˜ì—¬ ë” ë³´ê¸°</div></div></div></div><script>(function(){const s="code-3",n=document.querySelector('.copy-code-btn[data-code-id="'+s+'"]'),t=document.querySelector('.collapse-code-btn[data-code-id="'+s+'"]'),e=document.getElementById(s);if(!e)return;if(n){const s=n.querySelector(".copy-icon"),t=n.querySelector(".copy-text");n.addEventListener("click",async function(){try{let o="";const i=e.querySelector(".lntd:last-child code");if(i)o=i.textContent||i.innerText;else{const t=e.querySelector("code");if(t){const e=t.querySelector(".ln");if(e){const e=t.querySelectorAll(".cl");if(e.length>0)o=Array.from(e).map(e=>{const t=e.textContent||e.innerText;return t.replace(/\n+$/,"")}).join(`
`).replace(/\n+$/,"");else{const e=t.textContent||t.innerText;o=e.replace(/^\d+/gm,"").replace(/^\s+/gm,"")}}else o=t.textContent||t.innerText}else o=e.textContent||e.innerText}o=o.trim(),await navigator.clipboard.writeText(o),s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
</svg>`,t&&(t.textContent="ë³µì‚¬ë¨"),n.classList.add("text-green-600"),setTimeout(()=>{s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
</svg>`,t&&(t.textContent="ë³µì‚¬"),n.classList.remove("text-green-600")},2e3)}catch(o){console.error("å¤åˆ¶å¤±è´¥:",o);const s=document.createRange(),i=e.querySelector("code")||e;s.selectNodeContents(i);const n=window.getSelection();n.removeAllRanges(),n.addRange(s),t&&(t.textContent="ì„ íƒë¨"),setTimeout(()=>{t&&(t.textContent="ë³µì‚¬"),n.removeAllRanges()},2e3)}})}if(t){const d=t.querySelector(".collapse-icon"),c=t.querySelector(".collapse-text"),n=e.querySelector(".collapse-overlay");let s=e.querySelector("pre.chroma");s||(s=e.querySelector("pre"));const m=t.dataset.defaultState||"expanded",f=t.dataset.collapsed==="true",u=parseInt(t.dataset.autoCollapseLines)||30,h=parseInt(t.dataset.autoCollapseHeight)||400,p=parseInt(t.dataset.collapsedHeight)||120;let l=!1;function i(){const e=f||m==="collapsed"||a();e&&o(!0,!1)}function a(){if(s){const e=s.querySelectorAll(".line, .cl"),t=s.offsetHeight;return e.length>u||t>h}const t=e.offsetHeight;if(t>h)return!0;const n=e.textContent||e.innerText||"",o=n.split(`
`).length;return o>u}function o(s,o=!0){if(!n)return;l=s,s?(e.style.maxHeight=p+"px",e.style.overflow="hidden",n.style.opacity="1",n.style.pointerEvents="auto",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
</svg>`,c&&(c.textContent="í¼ì¹˜ê¸°"),t.title="í¼ì¹˜ê¸°"):(e.style.maxHeight="",e.style.overflow="",n.style.opacity="0",n.style.pointerEvents="none",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z"/></svg>`,c&&(c.textContent="ì ‘ê¸°"),t.title="ì ‘ê¸°"),o&&(e.style.transition="max-height 0.3s ease-out",setTimeout(()=>{e.style.transition=""},300))}function r(){o(!l,!0)}t.addEventListener("click",r),n&&n.addEventListener("click",()=>{l&&o(!1,!0)}),i()}})()</script><h2 id=-í•µì‹¬-ìš”ì•½>âœ¨ í•µì‹¬ ìš”ì•½</h2><p>DeepSeekMoEê°€ <strong>ê¸°ì¡´ MoE-Transformerì˜ ì„±ëŠ¥Â·íš¨ìœ¨ í•œê³„ë¥¼ ê·¼ë³¸ì ìœ¼ë¡œ ë„˜ì–´ì„ ë‹¤</strong>ê³  ì €ìë“¤ì´ ì£¼ì¥í•˜ëŠ” ì´ìœ ëŠ” <strong>(1) ì „ë¬¸ê°€ ì „ë¬¸í™” ìˆ˜ì¤€ì˜ ê¸‰ì§„ì  í–¥ìƒ, (2) íŒŒë¼ë¯¸í„°â€§ì—°ì‚°ëŸ‰ ëŒ€ë¹„ ì••ë„ì  ì„±ëŠ¥, (3) ëŒ€ê·œëª¨ ë¶„ì‚° í•™ìŠµì˜ ì•ˆì •ì„±</strong>â€”ì´ ì„¸ ì¶•ì—ì„œ ëª¨ë‘ ìš°ì›”í•¨ì„ <strong>ì •ëŸ‰ì ìœ¼ë¡œ ì…ì¦</strong>í–ˆê¸° ë•Œë¬¸ì´ë‹¤.</p><hr><h3 id=1-ì™œ-ìš°ë¦¬-ë°©ì‹ì´-ë”-ë‚«ë‚˜--ì €ìë“¤ì˜-í•µì‹¬-ë…¼ê±°-3ê°€ì§€>1. â€œì™œ ìš°ë¦¬ ë°©ì‹ì´ ë” ë‚«ë‚˜?â€ â€” ì €ìë“¤ì˜ í•µì‹¬ ë…¼ê±° 3ê°€ì§€</h3><table><thead><tr><th>#</th><th>ì €ì ì£¼ì¥</th><th>ë’·ë°›ì¹¨ ì¦ê±°(ìˆ˜ì¹˜Â·í‘œ)</th><th>ê·¼ê±° êµ¬ì ˆ</th></tr></thead><tbody><tr><td><strong>â‘  ì „ë¬¸ê°€ ì „ë¬¸í™” â†—</strong><br>FGES + SEIë¡œ <em>ì§€ì‹ í˜¼í•©Â·ì¤‘ë³µ</em> ì œê±°</td><td><em>ì¡°í•© ê°€ëŠ¥í•œ ì „ë¬¸ê°€ ì§‘í•©</em> 120â†’4.4 G(+37 MÃ—) <strong>í‘œí˜„ë ¥ í­ì¦</strong> â†’ ê°™ì€ 2 B ëª¨ë¸ì—ì„œ GShard ëŒ€ë¹„ <strong>í‰ê·  +3 pp</strong> (ARC-easy ë“± 12ë²¤ì¹˜) ì„±ëŠ¥</td><td>â€œFine-grained segmentation yields 4,426,165,368 potential expert combinations â€¦ DeepSeekMoE 2 B surpasses GShard 2 B by a substantial marginâ€</td><td></td></tr><tr><td><strong>â‘¡ ì—°ì‚°Â·íŒŒë¼ë¯¸í„° íš¨ìœ¨ â†—</strong></td><td><strong>16 B ëª¨ë¸</strong>ì´ LLaMA-2 7 Bì™€ <strong>ë™ê¸‰ ì„±ëŠ¥</strong>ì„ **FLOPs 0.40Ã—**ë¡œ ë‹¬ì„±; <strong>145 B ëª¨ë¸</strong>ì´ Dense 67 Bì™€ ë§ë¨¹ëŠ” ì„±ëŠ¥ì„ **FLOPs 0.285Ã—**ë¡œ ë‹¬ì„±</td><td>â€œWith only 40 % computations, DeepSeekMoE 16 B achieves comparable performance â€¦ DeepSeekMoE 145 B matches DeepSeek 67 B with just 28.5 % computationsâ€</td><td></td></tr><tr><td><strong>â‘¢ ëŒ€ê·œëª¨ í•™ìŠµ ì•ˆì •ì„± â†—</strong><br>Dual-Level Load-Balance Loss</td><td>ì „ë¬¸ê°€Â·ë””ë°”ì´ìŠ¤ ê°„ FLOPs í¸ì°¨ <strong>&lt; 5 %</strong>, ë¼ìš°íŒ… ë¶•ê´´ ì—†ì´ 145 Bê¹Œì§€ ì•ˆì • ìˆ˜ë ´</td><td>â€œWe set small Î±â‚ and larger Î±â‚‚ â€¦ balanced computation across devices and prevent routing collapseâ€</td><td></td></tr></tbody></table><hr><h3 id=2-ì €ìë“¤ì´-ê°•ì¡°í•˜ëŠ”-ë…ì°½ì„±--ì„±ëŠ¥-ë…¼ë¦¬-íë¦„>2. ì €ìë“¤ì´ ê°•ì¡°í•˜ëŠ” â€˜ë…ì°½ì„± â†’ ì„±ëŠ¥â€™ ë…¼ë¦¬ íë¦„</h3><ol><li><p><strong>ê·¼ë³¸ ì›ì¸ ì§„ë‹¨</strong></p><ul><li>ê¸°ì¡´ Top-1/2 MoEëŠ” ì „ë¬¸ê°€ ìˆ˜ê°€ ì ì–´ <strong>í† í°ë³„ ì§€ì‹ì´ í•œ ë©ì–´ë¦¬ë¡œ ì„ì—¬</strong> ì „ë¬¸í™”ê°€ ë¶ˆê°€ëŠ¥í–ˆë‹¤.</li></ul></li><li><p><strong>ì•„í‚¤í…ì²˜ í˜ì‹  â†’ í‘œí˜„ë ¥ í™•ëŒ€</strong></p><ul><li><strong>Fine-Grained Expert Segmentation</strong>: FFNì„ më°° ìª¼ê°  ë’¤ í™œì„± ì „ë¬¸ê°€ ìˆ˜ë„ më°° ëŠ˜ë ¤ <strong>ì •ë°€ ì¡°í•©</strong>ì„ ê°€ëŠ¥ì¼€ í•¨</li><li><strong>Shared Expert Isolation</strong>: ê³µí†µ ì§€ì‹ì„ ì „ë‹´í•  <strong>Kâ‚›ê°œ ê³µìœ  ì „ë¬¸ê°€</strong>ë¥¼ í•­ìƒ í™œì„±í™”í•´ <strong>íŒŒë¼ë¯¸í„° ì¤‘ë³µ ì œê±°</strong></li></ul></li><li><p><strong>í•™ìŠµ ì•ˆì •í™” â†’ ëŒ€ê·œëª¨ í™•ì¥</strong></p><ul><li><strong>Dual-Level Balance Loss</strong>ë¡œ ì „ë¬¸ê°€Â·ë””ë°”ì´ìŠ¤ ì–‘ìª½ ë¶€í•˜ ê· í˜•ì„ ë™ì‹œì— ë§ì¶° <strong>145 Bë„ ë¬´ì‚¬íˆ í•™ìŠµ</strong></li></ul></li><li><p><strong>ì •ëŸ‰ì  ê²€ì¦</strong></p><ul><li>ë™ì¼ FLOPs ì¡°ê±´ì—ì„œ <strong>Dense Upper-Bound ê·¼ì ‘</strong>: 2 B ëª¨ë¸ì´ DenseÃ—16 ìƒí•œì„ ì— ê±°ì˜ ê·¼ì ‘</li><li><strong>íŒŒë¼ë¯¸í„° íš¨ìœ¨ì„±</strong>: 16 B ëª¨ë¸ í™œì„± íŒŒë¼ë¯¸í„° 22 B â†’ ì„±ëŠ¥ì€ 6.7 B dense ëª¨ë¸ê³¼ ìœ ì‚¬, ì—°ì‚°ëŸ‰ 60 % ì ˆê°</li></ul></li></ol><hr><h3 id=3-í•œ-ëˆˆ-ìš”ì•½-í¬ì¸íŠ¸-ìˆ«ìë¡œ-ë§í•˜ëŠ”-deepseekmoe>3. í•œ-ëˆˆ-ìš”ì•½ í¬ì¸íŠ¸ (ìˆ«ìë¡œ ë§í•˜ëŠ” DeepSeekMoE)</h3><table><thead><tr><th>ì§€í‘œ</th><th>ê¸°ì¡´ GShard 2 B</th><th><strong>DeepSeekMoE 2 B</strong></th><th>ê¸°ì¡´ Dense 7 B</th><th><strong>DeepSeekMoE 16 B</strong></th></tr></thead><tbody><tr><td>Activated Params</td><td>0.2 B</td><td><strong>0.24 B</strong></td><td>6.7 B</td><td><strong>22 B</strong></td></tr><tr><td>FLOPs/2K tok</td><td>2.9 T</td><td><strong>2.9 T (ë™ì¼)</strong></td><td>5.2 T</td><td><strong>2.1 T (-60 %)</strong></td></tr><tr><td>Avg. 12-bench Acc.</td><td>49.1</td><td><strong>54.8 (+5.7)</strong></td><td>â€”</td><td><strong>â‰¥7 B dense ë™ê¸‰</strong></td></tr></tbody></table><p>ë°ì´í„° ì¶œì²˜: Table 1Â·4Â·5</p><hr><blockquote class="border-primary bg-muted/30 hover:bg-muted/40 my-6 rounded-r-lg border-l-4 py-4 pr-4 pl-6 italic transition-all duration-200 ease-out hover:translate-x-1"><div class="prose prose-sm max-w-none"><p>ğŸ’¡ <strong>ì •ë¦¬</strong>â€ƒì €ìë“¤ì€ â€œ<strong>ì „ë¬¸ê°€ë¥¼ ë” ì˜ê²Œ ë‚˜ëˆ„ê³ , ê³µí†µ ì§€ì‹ì„ í•œë° ëª¨ìœ¼ë©°, ê· í˜• ìˆê²Œ í•™ìŠµ</strong>í•˜ë©´ <strong>MoEë„ Dense ìˆ˜ì¤€ê¹Œì§€ ì˜¬ë¼ê°ˆ ìˆ˜ ìˆë‹¤</strong>â€ëŠ” ì ì„ ìˆ˜ì¹˜ë¡œ ì…ì¦í•˜ë©°, ì´ë¥¼ DeepSeekMoEë§Œì˜ ê²°ì •ì  ê°•ì ìœ¼ë¡œ ì œì‹œí•œë‹¤.</p></div></blockquote><h1 id=í”„ë¡¬í”„íŠ¸-131-ì•Œê³ ë¦¬ì¦˜-ë‹¨ê³„ë³„-ì„¤ëª…>í”„ë¡¬í”„íŠ¸ 1.3.1 (ì•Œê³ ë¦¬ì¦˜ ë‹¨ê³„ë³„ ì„¤ëª…)</h1><div class="code-block-container border-border bg-card my-6 overflow-hidden rounded-xl border shadow-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:shadow-md"><div class="code-block-header bg-muted/30 border-border flex items-center justify-between border-b px-4 py-3"><div class="flex items-center gap-2"><div class="text-muted-foreground flex-shrink-0"><svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4 4 4-4 4M6 16l-4-4 4-4"/></svg></div><span class="text-muted-foreground text-sm font-medium">PLAINTEXT</span></div><div class="flex items-center gap-2"><button class="collapse-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-4 data-default-state=expanded data-collapsed=false data-auto-collapse-lines=30 data-auto-collapse-height=400 data-collapsed-height=120 title=ì ‘ê¸° aria-label=ì ‘ê¸°>
<span class=collapse-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41 12 10.83l4.59 4.58L18 14l-6-6-6 6z"/></svg>
</span><span class="collapse-text hidden sm:inline">ì ‘ê¸°</span>
</button>
<button class="copy-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-4 title=ë³µì‚¬ aria-label=ë³µì‚¬>
<span class=copy-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/></svg>
</span><span class="copy-text hidden sm:inline">ë³µì‚¬</span></button></div></div><div class="code-block-content relative" id=code-4><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=ln>1</span><span class=cl>&#34;í•µì‹¬ ì•Œê³ ë¦¬ì¦˜, ëª¨ë¸ ì•„í‚¤í…ì²˜, ë˜ëŠ” ì£¼ìš” ë°©ë²•ë¡ ì„ ë‹¨ê³„ë³„(step-by-step)ë¡œ ì„¤ëª…í•´ ì¤˜. ë…ìëŠ” AI ë¶„ì•¼ì˜ ëŒ€í•™ì›ìƒ ìˆ˜ì¤€ì´ë¼ê³  ê°€ì •í•´. íŠ¹íˆ, ê°„ë‹¨í•œ ë¬¸ì¥, 3x3 í”½ì…€ ì´ë¯¸ì§€, ì‘ì€ ìƒíƒœ ê³µê°„(state space) ë“± ì•„ì£¼ ê°„ë‹¨í•˜ê³  êµ¬ì²´ì ì¸ ì˜ˆì‹œ(toy example)ì™€ ìƒ˜í”Œ ì…ë ¥ì„ ë§Œë“¤ì–´ì„œ, ì´ ì˜ˆì‹œë¥¼ í†µí•´ ê° ë‹¨ê³„ë¥¼ ê±°ì¹˜ë©° ì…ë ¥ì´ ìµœì¢… ì¶œë ¥ìœ¼ë¡œ ì–´ë–»ê²Œ ë³€í™˜ë˜ëŠ”ì§€ ì „ì²´ ê³¼ì •ì„ ë³´ì—¬ì¤˜. ë“±ì¥í•˜ëŠ” ëª¨ë“  í•µì‹¬ ìš©ì–´ì™€ ë³€ìˆ˜ëŠ” ê·¸ ì¦‰ì‹œ ì •ì˜í•´ ì¤˜.&#34;</span></span></code></pre></div><div class="collapse-overlay to-card/90 pointer-events-none absolute inset-0 bg-gradient-to-b from-transparent via-transparent opacity-0 transition-opacity duration-300"><div class="text-muted-foreground bg-card/80 border-border/50 hover:bg-primary/10 hover:text-primary hover:border-primary/30 absolute bottom-4 left-1/2 -translate-x-1/2 cursor-pointer rounded-full border px-3 py-1.5 text-xs backdrop-blur-sm transition-all duration-200">í´ë¦­í•˜ì—¬ ë” ë³´ê¸°</div></div></div></div><script>(function(){const s="code-4",n=document.querySelector('.copy-code-btn[data-code-id="'+s+'"]'),t=document.querySelector('.collapse-code-btn[data-code-id="'+s+'"]'),e=document.getElementById(s);if(!e)return;if(n){const s=n.querySelector(".copy-icon"),t=n.querySelector(".copy-text");n.addEventListener("click",async function(){try{let o="";const i=e.querySelector(".lntd:last-child code");if(i)o=i.textContent||i.innerText;else{const t=e.querySelector("code");if(t){const e=t.querySelector(".ln");if(e){const e=t.querySelectorAll(".cl");if(e.length>0)o=Array.from(e).map(e=>{const t=e.textContent||e.innerText;return t.replace(/\n+$/,"")}).join(`
`).replace(/\n+$/,"");else{const e=t.textContent||t.innerText;o=e.replace(/^\d+/gm,"").replace(/^\s+/gm,"")}}else o=t.textContent||t.innerText}else o=e.textContent||e.innerText}o=o.trim(),await navigator.clipboard.writeText(o),s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
</svg>`,t&&(t.textContent="ë³µì‚¬ë¨"),n.classList.add("text-green-600"),setTimeout(()=>{s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
</svg>`,t&&(t.textContent="ë³µì‚¬"),n.classList.remove("text-green-600")},2e3)}catch(o){console.error("å¤åˆ¶å¤±è´¥:",o);const s=document.createRange(),i=e.querySelector("code")||e;s.selectNodeContents(i);const n=window.getSelection();n.removeAllRanges(),n.addRange(s),t&&(t.textContent="ì„ íƒë¨"),setTimeout(()=>{t&&(t.textContent="ë³µì‚¬"),n.removeAllRanges()},2e3)}})}if(t){const d=t.querySelector(".collapse-icon"),c=t.querySelector(".collapse-text"),n=e.querySelector(".collapse-overlay");let s=e.querySelector("pre.chroma");s||(s=e.querySelector("pre"));const m=t.dataset.defaultState||"expanded",f=t.dataset.collapsed==="true",u=parseInt(t.dataset.autoCollapseLines)||30,h=parseInt(t.dataset.autoCollapseHeight)||400,p=parseInt(t.dataset.collapsedHeight)||120;let l=!1;function i(){const e=f||m==="collapsed"||a();e&&o(!0,!1)}function a(){if(s){const e=s.querySelectorAll(".line, .cl"),t=s.offsetHeight;return e.length>u||t>h}const t=e.offsetHeight;if(t>h)return!0;const n=e.textContent||e.innerText||"",o=n.split(`
`).length;return o>u}function o(s,o=!0){if(!n)return;l=s,s?(e.style.maxHeight=p+"px",e.style.overflow="hidden",n.style.opacity="1",n.style.pointerEvents="auto",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
</svg>`,c&&(c.textContent="í¼ì¹˜ê¸°"),t.title="í¼ì¹˜ê¸°"):(e.style.maxHeight="",e.style.overflow="",n.style.opacity="0",n.style.pointerEvents="none",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z"/></svg>`,c&&(c.textContent="ì ‘ê¸°"),t.title="ì ‘ê¸°"),o&&(e.style.transition="max-height 0.3s ease-out",setTimeout(()=>{e.style.transition=""},300))}function r(){o(!l,!0)}t.addEventListener("click",r),n&&n.addEventListener("click",()=>{l&&o(!1,!0)}),i()}})()</script><h2 id=-í•µì‹¬-ì•Œê³ ë¦¬ì¦˜-í•œëˆˆì—-ìš”ì•½>ğŸ í•µì‹¬ ì•Œê³ ë¦¬ì¦˜ í•œëˆˆì— ìš”ì•½</h2><p><strong>DeepSeekMoE ë ˆì´ì–´</strong>ëŠ”</p><ol><li><strong>Fine-Grained Expert Segmentation</strong>ìœ¼ë¡œ ê¸°ì¡´ FFN 1ê°œë¥¼ <em>m</em>ê°œ ì†Œ(å°)-ì „ë¬¸ê°€ë¡œ ìª¼ê°œê³ ,</li><li><strong>Shared Expert Isolation</strong>ìœ¼ë¡œ <em>Kâ‚›</em>ê°œ â€œê³µí†µ ì „ë¬¸ê°€â€ë¥¼ í•­ìƒ í™œì„±í™”í•˜ë©°,</li><li><strong>Dual-Level Load-Balancing Loss</strong>ë¡œ ì „ë¬¸ê°€Â·ë””ë°”ì´ìŠ¤ ë¶€í•˜ë¥¼ ë™ì‹œì— í‰ì¤€í™”í•œë‹¤.
ì´ë¥¼ í†µí•´ í† í°ë‹¹ ì„ íƒ ê°€ëŠ¥í•œ ì „ë¬¸ê°€ ì¡°í•©ì´ Top-2(16C2 = 120) â†’ FGES(64C8 â‰ˆ 4.4 Ã— 10â¹)ë¡œ <strong>3.7 Ã— 10â·ë°°</strong> ì¦ê°€í•˜ê³ , ë¼ìš°íŒ… ë¶•ê´´ ì—†ì´ 145 B ëª¨ë¸ê¹Œì§€ ì•ˆì • í•™ìŠµëœë‹¤ .</li></ol><hr><h2 id=1-ìš©ì–´--ë³€ìˆ˜-ì •ì˜>1ï¸âƒ£ ìš©ì–´ & ë³€ìˆ˜ ì •ì˜</h2><table><thead><tr><th>ê¸°í˜¸</th><th>ì˜ë¯¸</th></tr></thead><tbody><tr><td><em>N</em></td><td>ì›ë³¸ FFN ì „ë¬¸ê°€ ìˆ˜</td></tr><tr><td><em>m</em></td><td>í•œ FFNì„ ë¶„í• í•˜ëŠ” ì„¸ë¶„í™” ê³„ìˆ˜</td></tr><tr><td><em>mN</em></td><td>ì´ ì„¸ë¶„í™” ì „ë¬¸ê°€ ìˆ˜</td></tr><tr><td><em>K</em></td><td>í† í°ë‹¹ í™œì„±í™”í•  ê¸°ì¡´ ì „ë¬¸ê°€ ìˆ˜(Top-<em>K</em>)</td></tr><tr><td><em>mK</em></td><td>ì„¸ë¶„í™” í›„ í† í°ë‹¹ í™œì„±í™”í•  ì „ë¬¸ê°€ ìˆ˜</td></tr><tr><td><em>Kâ‚›</em></td><td>í•­ìƒ í™œì„±í™”ë˜ëŠ” <strong>ê³µìœ (shared) ì „ë¬¸ê°€</strong> ìˆ˜</td></tr><tr><td><strong>u</strong>á¶©â‚œ</td><td>ë ˆì´ì–´ <em>l</em>ì—ì„œ í† í° <em>t</em>ì˜ ì…ë ¥ ë²¡í„°</td></tr><tr><td><strong>e</strong>á¶©áµ¢</td><td>ë ˆì´ì–´ <em>l</em>ì—ì„œ <em>i</em>ë²ˆì§¸ ì „ë¬¸ê°€ì˜ ë¼ìš°íŒ… centroid</td></tr><tr><td><em>s</em>áµ¢,â‚œ</td><td>í† í°-ì „ë¬¸ê°€ affinity (softmax ì ìˆ˜)</td></tr><tr><td><em>g</em>áµ¢,â‚œ</td><td>ì‹¤ì œ ê²Œì´íŠ¸ ê°’ (<em>s</em>áµ¢,â‚œ ë˜ëŠ” 0)</td></tr></tbody></table><hr><h2 id=2-ë‹¨ê³„ë³„-íŒŒì´í”„ë¼ì¸-toy-example->2ï¸âƒ£ ë‹¨ê³„ë³„ íŒŒì´í”„ë¼ì¸ (Toy Example ğŸ²)</h2><blockquote class="border-primary bg-muted/30 hover:bg-muted/40 my-6 rounded-r-lg border-l-4 py-4 pr-4 pl-6 italic transition-all duration-200 ease-out hover:translate-x-1"><div class="prose prose-sm max-w-none"><p><strong>ì„¸íŒ…</strong></p><ul><li><strong>ì„¸ë¶„í™”:</strong> <em>N</em> = 2, <em>m</em> = 2 âŸ¹ ì´ ì „ë¬¸ê°€ <em>mN</em> = 4</li><li><strong>í™œì„±í™”:</strong> Top-<em>mK</em> = 2, ì´ì¤‘ 1ê°œëŠ” í•­ìƒ í™œì„±í™”(<em>Kâ‚›</em> = 1)</li><li><strong>ì…ë ¥:</strong> 3 Ã— 3 ê·¸ë ˆì´ìŠ¤ì¼€ì¼ ì´ë¯¸ì§€ì˜ ì²« í–‰ â†’ í† í° 3ê°œ
<code>uâ‚=[0.2, 0.6]</code>, <code>uâ‚‚=[0.9, 0.1]</code>, <code>uâ‚ƒ=[-0.2, 0.8]</code> (ë²¡í„° ì°¨ì› <em>d</em> = 2)</li><li><strong>ì „ë¬¸ê°€ centroids</strong>
<code>eâ‚=[0.5, 0.5]</code>(ê³µìœ )â€‚<code>eâ‚‚=[0.1, 0.9]</code>â€‚<code>eâ‚ƒ=[0.9, 0.1]</code>â€‚<code>eâ‚„=[-0.3, 0.7]</code></li></ul></div></blockquote><h3 id=step-0í† í°-ì„ë² ë”©>Step 0â€‚í† í° ì„ë² ë”©</h3><p>ì…ë ¥ í”½ì…€ ê°’ì„ ì €ì°¨ì› ë²¡í„° <strong>u</strong>á¶©â‚œë¡œ ë§¤í•‘. (ì˜ˆì‹œëŠ” ì´ë¯¸ 2-ì°¨ì›ìœ¼ë¡œ ê°€ì •)</p><h3 id=step-1affinity-ê³„ì‚°>Step 1â€‚Affinity ê³„ì‚°</h3><p>ê° í† í°Â·ì „ë¬¸ê°€ ìŒì— ëŒ€í•´
<code>sáµ¢,â‚œ = softmax_i(uâ‚œáµ€ eáµ¢)</code></p><table><thead><tr><th>í† í°</th><th>sâ‚</th><th>sâ‚‚</th><th>sâ‚ƒ</th><th>sâ‚„</th></tr></thead><tbody><tr><td><strong>uâ‚</strong></td><td>0.25</td><td><strong>0.29</strong></td><td>0.21</td><td>0.24</td></tr><tr><td><strong>uâ‚‚</strong></td><td>0.28</td><td>0.20</td><td><strong>0.38</strong></td><td>0.14</td></tr><tr><td><strong>uâ‚ƒ</strong></td><td>0.22</td><td><strong>0.33</strong></td><td>0.15</td><td>0.30</td></tr></tbody></table><h3 id=step-2ì „ë¬¸ê°€-ì„ íƒ>Step 2â€‚ì „ë¬¸ê°€ ì„ íƒ</h3><ul><li><strong>í•­ìƒ í¬í•¨:</strong> ê³µìœ  eâ‚</li><li><strong>ì¶”ê°€ ì„ íƒ:</strong> affinity ìƒìœ„ 1ê°œ (Top-(mK-Kâ‚›)=1)</li></ul><table><thead><tr><th>í† í°</th><th>ìµœì¢… í™œì„± ì „ë¬¸ê°€ ì§‘í•©</th></tr></thead><tbody><tr><td>uâ‚</td><td>{eâ‚, eâ‚‚}</td></tr><tr><td>uâ‚‚</td><td>{eâ‚, eâ‚ƒ}</td></tr><tr><td>uâ‚ƒ</td><td>{eâ‚, eâ‚‚}</td></tr></tbody></table><blockquote class="border-primary bg-muted/30 hover:bg-muted/40 my-6 rounded-r-lg border-l-4 py-4 pr-4 pl-6 italic transition-all duration-200 ease-out hover:translate-x-1"><div class="prose prose-sm max-w-none"><p><strong>ê²Œì´íŠ¸ ê°’</strong> gáµ¢,â‚œ = sáµ¢,â‚œ for ì„ íƒëœ ì „ë¬¸ê°€, else 0.</p></div></blockquote><h3 id=step-3ì „ë¬¸ê°€-ffn-ì²˜ë¦¬>Step 3â€‚ì „ë¬¸ê°€ FFN ì²˜ë¦¬</h3><p>ê° ì„ íƒëœ ì „ë¬¸ê°€ FFNáµ¢(<strong>Â·</strong>)ì— ì…ë ¥ í›„ ê²°ê³¼ë¥¼ ê²Œì´íŠ¸ë¡œ ê°€ì¤‘í•©:</p><div class="code-block-container border-border bg-card my-6 overflow-hidden rounded-xl border shadow-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:shadow-md"><div class="code-block-header bg-muted/30 border-border flex items-center justify-between border-b px-4 py-3"><div class="flex items-center gap-2"><div class="text-muted-foreground flex-shrink-0"><svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4 4 4-4 4M6 16l-4-4 4-4"/></svg></div><span class="text-muted-foreground text-sm font-medium">PLAINTEXT</span></div><div class="flex items-center gap-2"><button class="collapse-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-5 data-default-state=expanded data-collapsed=false data-auto-collapse-lines=30 data-auto-collapse-height=400 data-collapsed-height=120 title=ì ‘ê¸° aria-label=ì ‘ê¸°>
<span class=collapse-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41 12 10.83l4.59 4.58L18 14l-6-6-6 6z"/></svg>
</span><span class="collapse-text hidden sm:inline">ì ‘ê¸°</span>
</button>
<button class="copy-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-5 title=ë³µì‚¬ aria-label=ë³µì‚¬>
<span class=copy-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/></svg>
</span><span class="copy-text hidden sm:inline">ë³µì‚¬</span></button></div></div><div class="code-block-content relative" id=code-5><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=ln> 1</span><span class=cl>hâ‚œ = Î£áµ¢ gáµ¢,â‚œ Â· FFNáµ¢(uâ‚œ) + uâ‚œ     (Residual)
</span></span><span class=line><span class=ln> 2</span><span class=cl>``` :contentReference[oaicite:2]{index=2}  
</span></span><span class=line><span class=ln> 3</span><span class=cl>
</span></span><span class=line><span class=ln> 4</span><span class=cl>(ìˆ«ì ì˜ˆì‹œëŠ” ìƒëµí•˜ì§€ë§Œ, ì‹¤ì œë¡œëŠ” ê° FFNì´ 2â†’4â†’2 ê³„ì¸µì˜ ì‘ì€ MLP.)
</span></span><span class=line><span class=ln> 5</span><span class=cl>
</span></span><span class=line><span class=ln> 6</span><span class=cl>### Step 4â€‚ë‹¤ìŒ Transformer ë¸”ë¡ìœ¼ë¡œ ì „ë‹¬  
</span></span><span class=line><span class=ln> 7</span><span class=cl>ì‚°ì¶œ **h**â‚œëŠ” Self-Attention â†’ LayerNorm ë“± í‘œì¤€ ê²½ë¡œë¡œ ì´ì–´ì§„ë‹¤.
</span></span><span class=line><span class=ln> 8</span><span class=cl>
</span></span><span class=line><span class=ln> 9</span><span class=cl>### Step 5â€‚í•™ìŠµ ì‹œ ë¶€í•˜ ê· í˜•  
</span></span><span class=line><span class=ln>10</span><span class=cl>- **ì „ë¬¸ê°€ ìˆ˜ì¤€**:  
</span></span><span class=line><span class=ln>11</span><span class=cl>  `L_ExpBal = Î±â‚ Î£áµ¢ fáµ¢Â·Páµ¢`  
</span></span><span class=line><span class=ln>12</span><span class=cl>  where `fáµ¢`=ì„ íƒ ë¹ˆë„, `Páµ¢`=í‰ê·  ê²Œì´íŠ¸ :contentReference[oaicite:3]{index=3}  
</span></span><span class=line><span class=ln>13</span><span class=cl>- **ë””ë°”ì´ìŠ¤ ìˆ˜ì¤€**:  
</span></span><span class=line><span class=ln>14</span><span class=cl>  `L_DevBal = Î±â‚‚ Î£_d fâ€²_dÂ·Pâ€²_d` (ì „ë¬¸ê°€ ê·¸ë£¹ì„ GPUì— ë§¤í•‘)  
</span></span><span class=line><span class=ln>15</span><span class=cl>&gt; Î±â‚ â‰ª Î±â‚‚ ë¡œ ì„¤ì •í•˜ì—¬ **ë¼ìš°íŒ… ë¶•ê´´**ë¥¼ ë°©ì§€í•˜ë©´ì„œë„ GPU ê°„ FLOPs í¸ì°¨ &lt; 5 % ìœ ì§€.
</span></span><span class=line><span class=ln>16</span><span class=cl>
</span></span><span class=line><span class=ln>17</span><span class=cl>---
</span></span><span class=line><span class=ln>18</span><span class=cl>
</span></span><span class=line><span class=ln>19</span><span class=cl>## 3ï¸âƒ£ ì™œ ì„¸ë¶„í™” &amp; ê³µìœ ê°€ ì¤‘ìš”í•œê°€?
</span></span><span class=line><span class=ln>20</span><span class=cl>
</span></span><span class=line><span class=ln>21</span><span class=cl>| êµ¬ì„± | ì¡°í•© ìˆ˜ (K=2 ê¸°ì¤€) | í† í°ë³„ ì§€ì‹ í‘œí˜„ë ¥ | íŒŒë¼ë¯¸í„° ì¤‘ë³µ |
</span></span><span class=line><span class=ln>22</span><span class=cl>|------|-------------------|--------------------|---------------|
</span></span><span class=line><span class=ln>23</span><span class=cl>| ê¸°ì¡´ Top-2 (N=16) | 120 | ì œí•œì  | ë†’ìŒ |
</span></span><span class=line><span class=ln>24</span><span class=cl>| **FGES (m=4)** | **4.4 Ã— 10â¹** | **â†‘ 37 MÃ—** | ë™ì¼ |
</span></span><span class=line><span class=ln>25</span><span class=cl>| **FGES + SEI** | ë™ì¼ | **â†‘ &amp; ê³µí†µ ì§€ì‹ ì§‘ì¤‘** | **â†“** |
</span></span><span class=line><span class=ln>26</span><span class=cl>
</span></span><span class=line><span class=ln>27</span><span class=cl>&gt; ì‹¤í—˜ì ìœ¼ë¡œ **2 B ëª¨ë¸**ì´ ë™ì¼ FLOPsì—ì„œ GShard 2 B ëŒ€ë¹„ **+3 pp** í‰ê·  ì„±ëŠ¥ì„, **16 B**ëŠ” LLaMA-2 7 Bì™€ ë™ê¸‰ ì„±ëŠ¥ì„ **ì—°ì‚°ëŸ‰ 0.4Ã—**ë¡œ ë‹¬ì„± .  
</span></span><span class=line><span class=ln>28</span><span class=cl>
</span></span><span class=line><span class=ln>29</span><span class=cl>---
</span></span><span class=line><span class=ln>30</span><span class=cl>
</span></span><span class=line><span class=ln>31</span><span class=cl>## 4ï¸âƒ£ íë¦„ë„ ìš”ì•½</span></span></code></pre></div><div class="collapse-overlay to-card/90 pointer-events-none absolute inset-0 bg-gradient-to-b from-transparent via-transparent opacity-0 transition-opacity duration-300"><div class="text-muted-foreground bg-card/80 border-border/50 hover:bg-primary/10 hover:text-primary hover:border-primary/30 absolute bottom-4 left-1/2 -translate-x-1/2 cursor-pointer rounded-full border px-3 py-1.5 text-xs backdrop-blur-sm transition-all duration-200">í´ë¦­í•˜ì—¬ ë” ë³´ê¸°</div></div></div></div><script>(function(){const s="code-5",n=document.querySelector('.copy-code-btn[data-code-id="'+s+'"]'),t=document.querySelector('.collapse-code-btn[data-code-id="'+s+'"]'),e=document.getElementById(s);if(!e)return;if(n){const s=n.querySelector(".copy-icon"),t=n.querySelector(".copy-text");n.addEventListener("click",async function(){try{let o="";const i=e.querySelector(".lntd:last-child code");if(i)o=i.textContent||i.innerText;else{const t=e.querySelector("code");if(t){const e=t.querySelector(".ln");if(e){const e=t.querySelectorAll(".cl");if(e.length>0)o=Array.from(e).map(e=>{const t=e.textContent||e.innerText;return t.replace(/\n+$/,"")}).join(`
`).replace(/\n+$/,"");else{const e=t.textContent||t.innerText;o=e.replace(/^\d+/gm,"").replace(/^\s+/gm,"")}}else o=t.textContent||t.innerText}else o=e.textContent||e.innerText}o=o.trim(),await navigator.clipboard.writeText(o),s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
</svg>`,t&&(t.textContent="ë³µì‚¬ë¨"),n.classList.add("text-green-600"),setTimeout(()=>{s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
</svg>`,t&&(t.textContent="ë³µì‚¬"),n.classList.remove("text-green-600")},2e3)}catch(o){console.error("å¤åˆ¶å¤±è´¥:",o);const s=document.createRange(),i=e.querySelector("code")||e;s.selectNodeContents(i);const n=window.getSelection();n.removeAllRanges(),n.addRange(s),t&&(t.textContent="ì„ íƒë¨"),setTimeout(()=>{t&&(t.textContent="ë³µì‚¬"),n.removeAllRanges()},2e3)}})}if(t){const d=t.querySelector(".collapse-icon"),c=t.querySelector(".collapse-text"),n=e.querySelector(".collapse-overlay");let s=e.querySelector("pre.chroma");s||(s=e.querySelector("pre"));const m=t.dataset.defaultState||"expanded",f=t.dataset.collapsed==="true",u=parseInt(t.dataset.autoCollapseLines)||30,h=parseInt(t.dataset.autoCollapseHeight)||400,p=parseInt(t.dataset.collapsedHeight)||120;let l=!1;function i(){const e=f||m==="collapsed"||a();e&&o(!0,!1)}function a(){if(s){const e=s.querySelectorAll(".line, .cl"),t=s.offsetHeight;return e.length>u||t>h}const t=e.offsetHeight;if(t>h)return!0;const n=e.textContent||e.innerText||"",o=n.split(`
`).length;return o>u}function o(s,o=!0){if(!n)return;l=s,s?(e.style.maxHeight=p+"px",e.style.overflow="hidden",n.style.opacity="1",n.style.pointerEvents="auto",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
</svg>`,c&&(c.textContent="í¼ì¹˜ê¸°"),t.title="í¼ì¹˜ê¸°"):(e.style.maxHeight="",e.style.overflow="",n.style.opacity="0",n.style.pointerEvents="none",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z"/></svg>`,c&&(c.textContent="ì ‘ê¸°"),t.title="ì ‘ê¸°"),o&&(e.style.transition="max-height 0.3s ease-out",setTimeout(()=>{e.style.transition=""},300))}function r(){o(!l,!0)}t.addEventListener("click",r),n&&n.addEventListener("click",()=>{l&&o(!1,!0)}),i()}})()</script><pre><code>  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€ Router (affinity sáµ¢,â‚œ) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
</code></pre><p>uâ‚œ â”€â”€â–¶ Emb â”€â”€â–¶ Select {shared Kâ‚›} âˆª Top-(mKâˆ’Kâ‚›) â”€â”€â–¶ Î£ gáµ¢,â‚œÂ·FFNáµ¢(uâ‚œ) â”€â”€â–¶ hâ‚œ
â”‚ â–² â”‚
â””â”€ Dual-Level Balance Loss (Î±â‚, Î±â‚‚) â—€â”€â”€â”€â”€â”€â”˜</p><div class="code-block-container border-border bg-card my-6 overflow-hidden rounded-xl border shadow-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:shadow-md"><div class="code-block-header bg-muted/30 border-border flex items-center justify-between border-b px-4 py-3"><div class="flex items-center gap-2"><div class="text-muted-foreground flex-shrink-0"><svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4 4 4-4 4M6 16l-4-4 4-4"/></svg></div><span class="text-muted-foreground text-sm font-medium">PLAINTEXT</span></div><div class="flex items-center gap-2"><button class="collapse-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-6 data-default-state=expanded data-collapsed=false data-auto-collapse-lines=30 data-auto-collapse-height=400 data-collapsed-height=120 title=ì ‘ê¸° aria-label=ì ‘ê¸°>
<span class=collapse-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41 12 10.83l4.59 4.58L18 14l-6-6-6 6z"/></svg>
</span><span class="collapse-text hidden sm:inline">ì ‘ê¸°</span>
</button>
<button class="copy-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-6 title=ë³µì‚¬ aria-label=ë³µì‚¬>
<span class=copy-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/></svg>
</span><span class="copy-text hidden sm:inline">ë³µì‚¬</span></button></div></div><div class="code-block-content relative" id=code-6><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=ln>1</span><span class=cl>
</span></span><span class=line><span class=ln>2</span><span class=cl>---
</span></span><span class=line><span class=ln>3</span><span class=cl>
</span></span><span class=line><span class=ln>4</span><span class=cl>### ğŸ“Œ ê¸°ì–µí•  ì 
</span></span><span class=line><span class=ln>5</span><span class=cl>- **ì„¸ë¶„í™”ë¡œ í‘œí˜„ë ¥ ê·¹ëŒ€í™”**, **ê³µìœ  ì „ë¬¸ê°€ë¡œ ì¤‘ë³µ ì œê±°**, **ì´ì¤‘ ê· í˜• ë¡œìŠ¤ë¡œ ì•ˆì • í•™ìŠµ**.  
</span></span><span class=line><span class=ln>6</span><span class=cl>- ìˆ«ì toy exampleì€ ê°œë… ì¦ëª…ìš© â†” ì‹¤ì œ ëª¨ë¸ì€ ìˆ˜ì²œ ~ ìˆ˜ë§Œ ì „ë¬¸ê°€Â·ìˆ˜ë°± ì°¨ì› hiddenìœ¼ë¡œ í™•ì¥ëœë‹¤.  
</span></span><span class=line><span class=ln>7</span><span class=cl>
</span></span><span class=line><span class=ln>8</span><span class=cl>---</span></span></code></pre></div><div class="collapse-overlay to-card/90 pointer-events-none absolute inset-0 bg-gradient-to-b from-transparent via-transparent opacity-0 transition-opacity duration-300"><div class="text-muted-foreground bg-card/80 border-border/50 hover:bg-primary/10 hover:text-primary hover:border-primary/30 absolute bottom-4 left-1/2 -translate-x-1/2 cursor-pointer rounded-full border px-3 py-1.5 text-xs backdrop-blur-sm transition-all duration-200">í´ë¦­í•˜ì—¬ ë” ë³´ê¸°</div></div></div></div><script>(function(){const s="code-6",n=document.querySelector('.copy-code-btn[data-code-id="'+s+'"]'),t=document.querySelector('.collapse-code-btn[data-code-id="'+s+'"]'),e=document.getElementById(s);if(!e)return;if(n){const s=n.querySelector(".copy-icon"),t=n.querySelector(".copy-text");n.addEventListener("click",async function(){try{let o="";const i=e.querySelector(".lntd:last-child code");if(i)o=i.textContent||i.innerText;else{const t=e.querySelector("code");if(t){const e=t.querySelector(".ln");if(e){const e=t.querySelectorAll(".cl");if(e.length>0)o=Array.from(e).map(e=>{const t=e.textContent||e.innerText;return t.replace(/\n+$/,"")}).join(`
`).replace(/\n+$/,"");else{const e=t.textContent||t.innerText;o=e.replace(/^\d+/gm,"").replace(/^\s+/gm,"")}}else o=t.textContent||t.innerText}else o=e.textContent||e.innerText}o=o.trim(),await navigator.clipboard.writeText(o),s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
</svg>`,t&&(t.textContent="ë³µì‚¬ë¨"),n.classList.add("text-green-600"),setTimeout(()=>{s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
</svg>`,t&&(t.textContent="ë³µì‚¬"),n.classList.remove("text-green-600")},2e3)}catch(o){console.error("å¤åˆ¶å¤±è´¥:",o);const s=document.createRange(),i=e.querySelector("code")||e;s.selectNodeContents(i);const n=window.getSelection();n.removeAllRanges(),n.addRange(s),t&&(t.textContent="ì„ íƒë¨"),setTimeout(()=>{t&&(t.textContent="ë³µì‚¬"),n.removeAllRanges()},2e3)}})}if(t){const d=t.querySelector(".collapse-icon"),c=t.querySelector(".collapse-text"),n=e.querySelector(".collapse-overlay");let s=e.querySelector("pre.chroma");s||(s=e.querySelector("pre"));const m=t.dataset.defaultState||"expanded",f=t.dataset.collapsed==="true",u=parseInt(t.dataset.autoCollapseLines)||30,h=parseInt(t.dataset.autoCollapseHeight)||400,p=parseInt(t.dataset.collapsedHeight)||120;let l=!1;function i(){const e=f||m==="collapsed"||a();e&&o(!0,!1)}function a(){if(s){const e=s.querySelectorAll(".line, .cl"),t=s.offsetHeight;return e.length>u||t>h}const t=e.offsetHeight;if(t>h)return!0;const n=e.textContent||e.innerText||"",o=n.split(`
`).length;return o>u}function o(s,o=!0){if(!n)return;l=s,s?(e.style.maxHeight=p+"px",e.style.overflow="hidden",n.style.opacity="1",n.style.pointerEvents="auto",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
</svg>`,c&&(c.textContent="í¼ì¹˜ê¸°"),t.title="í¼ì¹˜ê¸°"):(e.style.maxHeight="",e.style.overflow="",n.style.opacity="0",n.style.pointerEvents="none",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z"/></svg>`,c&&(c.textContent="ì ‘ê¸°"),t.title="ì ‘ê¸°"),o&&(e.style.transition="max-height 0.3s ease-out",setTimeout(()=>{e.style.transition=""},300))}function r(){o(!l,!0)}t.addEventListener("click",r),n&&n.addEventListener("click",()=>{l&&o(!1,!0)}),i()}})()</script><h1 id=í”„ë¡¬í”„íŠ¸-132-ë¹„ë°€-ë³‘ê¸°-ì‹ë³„>í”„ë¡¬í”„íŠ¸ 1.3.2 (&lsquo;ë¹„ë°€ ë³‘ê¸°&rsquo; ì‹ë³„)</h1><div class="code-block-container border-border bg-card my-6 overflow-hidden rounded-xl border shadow-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:shadow-md"><div class="code-block-header bg-muted/30 border-border flex items-center justify-between border-b px-4 py-3"><div class="flex items-center gap-2"><div class="text-muted-foreground flex-shrink-0"><svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4 4 4-4 4M6 16l-4-4 4-4"/></svg></div><span class="text-muted-foreground text-sm font-medium">PLAINTEXT</span></div><div class="flex items-center gap-2"><button class="collapse-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-7 data-default-state=expanded data-collapsed=false data-auto-collapse-lines=30 data-auto-collapse-height=400 data-collapsed-height=120 title=ì ‘ê¸° aria-label=ì ‘ê¸°>
<span class=collapse-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41 12 10.83l4.59 4.58L18 14l-6-6-6 6z"/></svg>
</span><span class="collapse-text hidden sm:inline">ì ‘ê¸°</span>
</button>
<button class="copy-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-7 title=ë³µì‚¬ aria-label=ë³µì‚¬>
<span class=copy-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/></svg>
</span><span class="copy-text hidden sm:inline">ë³µì‚¬</span></button></div></div><div class="code-block-content relative" id=code-7><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=ln>1</span><span class=cl>&#34;ì´ ë…¼ë¬¸ì˜ í•µì‹¬ ê¸°ì—¬ë¥¼ ê°€ëŠ¥í•˜ê²Œ í•˜ëŠ” ê°€ì¥ ê²°ì •ì ì¸ ë‹¨ì¼ ìˆ˜í•™ ê³µì‹, ì•Œê³ ë¦¬ì¦˜ ë‹¨ê³„, ë˜ëŠ” ì•„í‚¤í…ì²˜ êµ¬ì„±ìš”ì†Œë¥¼ ì‹ë³„í•´ ì¤˜. ê·¸ê²ƒì˜ ê¸°ëŠ¥ê³¼, ê·¸ê²ƒì´ ì´ ë°©ë²•ë¡ ì˜ ì„±ê³µì— ì™œ í•„ìˆ˜ì ì¸ì§€ ì„¤ëª…í•´ ì¤˜.&#34;</span></span></code></pre></div><div class="collapse-overlay to-card/90 pointer-events-none absolute inset-0 bg-gradient-to-b from-transparent via-transparent opacity-0 transition-opacity duration-300"><div class="text-muted-foreground bg-card/80 border-border/50 hover:bg-primary/10 hover:text-primary hover:border-primary/30 absolute bottom-4 left-1/2 -translate-x-1/2 cursor-pointer rounded-full border px-3 py-1.5 text-xs backdrop-blur-sm transition-all duration-200">í´ë¦­í•˜ì—¬ ë” ë³´ê¸°</div></div></div></div><script>(function(){const s="code-7",n=document.querySelector('.copy-code-btn[data-code-id="'+s+'"]'),t=document.querySelector('.collapse-code-btn[data-code-id="'+s+'"]'),e=document.getElementById(s);if(!e)return;if(n){const s=n.querySelector(".copy-icon"),t=n.querySelector(".copy-text");n.addEventListener("click",async function(){try{let o="";const i=e.querySelector(".lntd:last-child code");if(i)o=i.textContent||i.innerText;else{const t=e.querySelector("code");if(t){const e=t.querySelector(".ln");if(e){const e=t.querySelectorAll(".cl");if(e.length>0)o=Array.from(e).map(e=>{const t=e.textContent||e.innerText;return t.replace(/\n+$/,"")}).join(`
`).replace(/\n+$/,"");else{const e=t.textContent||t.innerText;o=e.replace(/^\d+/gm,"").replace(/^\s+/gm,"")}}else o=t.textContent||t.innerText}else o=e.textContent||e.innerText}o=o.trim(),await navigator.clipboard.writeText(o),s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
</svg>`,t&&(t.textContent="ë³µì‚¬ë¨"),n.classList.add("text-green-600"),setTimeout(()=>{s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
</svg>`,t&&(t.textContent="ë³µì‚¬"),n.classList.remove("text-green-600")},2e3)}catch(o){console.error("å¤åˆ¶å¤±è´¥:",o);const s=document.createRange(),i=e.querySelector("code")||e;s.selectNodeContents(i);const n=window.getSelection();n.removeAllRanges(),n.addRange(s),t&&(t.textContent="ì„ íƒë¨"),setTimeout(()=>{t&&(t.textContent="ë³µì‚¬"),n.removeAllRanges()},2e3)}})}if(t){const d=t.querySelector(".collapse-icon"),c=t.querySelector(".collapse-text"),n=e.querySelector(".collapse-overlay");let s=e.querySelector("pre.chroma");s||(s=e.querySelector("pre"));const m=t.dataset.defaultState||"expanded",f=t.dataset.collapsed==="true",u=parseInt(t.dataset.autoCollapseLines)||30,h=parseInt(t.dataset.autoCollapseHeight)||400,p=parseInt(t.dataset.collapsedHeight)||120;let l=!1;function i(){const e=f||m==="collapsed"||a();e&&o(!0,!1)}function a(){if(s){const e=s.querySelectorAll(".line, .cl"),t=s.offsetHeight;return e.length>u||t>h}const t=e.offsetHeight;if(t>h)return!0;const n=e.textContent||e.innerText||"",o=n.split(`
`).length;return o>u}function o(s,o=!0){if(!n)return;l=s,s?(e.style.maxHeight=p+"px",e.style.overflow="hidden",n.style.opacity="1",n.style.pointerEvents="auto",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
</svg>`,c&&(c.textContent="í¼ì¹˜ê¸°"),t.title="í¼ì¹˜ê¸°"):(e.style.maxHeight="",e.style.overflow="",n.style.opacity="0",n.style.pointerEvents="none",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z"/></svg>`,c&&(c.textContent="ì ‘ê¸°"),t.title="ì ‘ê¸°"),o&&(e.style.transition="max-height 0.3s ease-out",setTimeout(()=>{e.style.transition=""},300))}function r(){o(!l,!0)}t.addEventListener("click",r),n&&n.addEventListener("click",()=>{l&&o(!1,!0)}),i()}})()</script><h2 id=-ë¹„ë°€-ë³‘ê¸°--fine-grained-expert-segmentation-fges--í™•ì¥-top->ğŸ§© â€˜ë¹„ë°€ ë³‘ê¸°â€™ â€” <strong>Fine-Grained Expert Segmentation (FGES) + í™•ì¥ Top-<em>mK</em> ê²Œì´íŒ…</strong></h2><blockquote class="border-primary bg-muted/30 hover:bg-muted/40 my-6 rounded-r-lg border-l-4 py-4 pr-4 pl-6 italic transition-all duration-200 ease-out hover:translate-x-1"><div class="prose prose-sm max-w-none"><p><ins>í•µì‹¬ ìˆ˜ì‹</ins> (ë…¼ë¬¸ ì‹ 6â€“8)</p><p>$$
h^{(l)}<em>t ;=; \sum</em>{i=1}^{mN} g_{i,t},\text{FFN}<em>i!\bigl(u^{(l)}<em>t\bigr) + u^{(l)}<em>t,\qquad<br>g</em>{i,t}=\begin{cases}
s</em>{i,t}, & s</em>{i,t}\in\text{Top}<em>k!\bigl({s</em>{j,t}}<em>{j=1}^{mN},,mK\bigr)\[2pt]
0, & \text{otherwise}
\end{cases},\qquad<br>s</em>{i,t}=\text{softmax}_i!\bigl((u^{(l)}_t)^\top e^{(l)}_i\bigr)
$$</p></div></blockquote><h3 id=1-ë¬´ì—‡ì„-í•˜ë‚˜>1ï¸âƒ£ ë¬´ì—‡ì„ í•˜ë‚˜?</h3><ul><li><p><strong>ì„¸ë¶„í™”</strong>â€ƒì›ë˜ FFN ì „ë¬¸ê°€ <em>N</em> ê°œë¥¼ ê°ì <em>m</em> ê°œì˜ â€œì†Œ(å°)-ì „ë¬¸ê°€â€ë¡œ ë‚˜ëˆ„ì–´ ì´ <em>mN</em> ê°œë¡œ í™•ì¥.</p></li><li><p><strong>ê²Œì´íŒ…</strong>â€ƒí† í°ë‹¹ í™œì„± ì „ë¬¸ê°€ ìˆ˜ë„ Top-<em>K</em> â†’ Top-<em>mK</em> ë¡œ ëŠ˜ë ¤, <strong>í•œ í† í°ì´ ë™ì‹œì— ë³´ê³  í•™ìŠµí•  ìˆ˜ ìˆëŠ” ì „ë¬¸ ì§€ì‹ì˜ ì¡°í•©</strong>ì„ í­ë°œì ìœ¼ë¡œ í™•ëŒ€.</p><ul><li>ì˜ˆ: <em>N</em>=16, <em>K</em>=2, <em>m</em>=4 ì´ë©´ ì¡°í•© ìˆ˜ê°€ 120 â†’ 4 426 165 368 (â‰ˆ 3.7 Ã— 10â· ë°°) .</li></ul></li></ul><h3 id=2-ì™œ-deepseekmoeì˜-ì„±ê³µì—-í•„ìˆ˜ì ì¸ê°€>2ï¸âƒ£ ì™œ DeepSeekMoEì˜ ì„±ê³µì— í•„ìˆ˜ì ì¸ê°€?</h3><ol><li><strong>ì „ë¬¸ê°€ ì „ë¬¸í™” ê·¹ëŒ€í™”</strong> â€” ë‹¤ì–‘í•œ ì§€ì‹ì„ ë¯¸ì‹œì ìœ¼ë¡œ ìª¼ê°œ ê°ê¸° ë‹¤ë¥¸ ì „ë¬¸ê°€ì— í•™ìŠµì‹œì¼œ <strong>ì§€ì‹ í˜¼í•©Â·ì¤‘ë³µì„ ì›ì²œ ì°¨ë‹¨</strong>.</li><li><strong>íŒŒë¼ë¯¸í„°Â·FLOPs ë³´ì¡´</strong> â€” ì„¸ë¶„í™” ë•Œ FFN hidden dimì„ 1/<em>m</em> ë¡œ ì¤„ì—¬ <strong>ì´ íŒŒë¼ë¯¸í„°ì™€ ì—°ì‚°ëŸ‰ì€ ê·¸ëŒ€ë¡œ</strong> ìœ ì§€í•˜ë¯€ë¡œ â€œê³µì§œë¡œâ€ í‘œí˜„ë ¥ì„ ì–»ëŠ”ë‹¤.</li><li><strong>Dense Upper-Bound ê·¼ì ‘</strong> â€” ë™ì¼ 2 B FLOPsì—ì„œ GShard 2 Bë³´ë‹¤ í‰ê·  <strong>+3 pp</strong> ì •í™•ë„ í–¥ìƒ; 16 B ëª¨ë¸ì€ LLaMA-2 7 Bë¥¼ <strong>ì—°ì‚°ëŸ‰ 0.4Ã—</strong> ë¡œ ì¬í˜„ .</li></ol><blockquote class="border-primary bg-muted/30 hover:bg-muted/40 my-6 rounded-r-lg border-l-4 py-4 pr-4 pl-6 italic transition-all duration-200 ease-out hover:translate-x-1"><div class="prose prose-sm max-w-none"><p>ìš”ì»¨ëŒ€, <strong>FGES + í™•ì¥ ê²Œì´íŒ…</strong>ì´ ì—†ì—ˆë‹¤ë©´ DeepSeekMoEëŠ” ì „ë¬¸ê°€ê°€ ì¶©ë¶„íˆ â€˜ìª¼ê°œì§€ì§€â€™ ì•Šì•„ ì—¬ì „íˆ ì§€ì‹ ì¤‘ì²©ì˜ í•œê³„ì— ë¨¸ë¬¼ë €ì„ ê²ƒì´ë‹¤. ì´ í•œ ìˆ˜ì‹ì´ ì „ì²´ ì•„í‚¤í…ì²˜ì˜ í‘œí˜„ë ¥Â·íš¨ìœ¨Â·ì„±ëŠ¥ ë„ì•½ì„ <strong>ê·¼ë³¸ì ìœ¼ë¡œ ê²°ì •</strong>í•œë‹¤.</p></div></blockquote><h1 id=í”„ë¡¬í”„íŠ¸-1400ì½”ë“œ-ì˜ˆì‹œ>í”„ë¡¬í”„íŠ¸ 1.4.0.0(ì½”ë“œ ì˜ˆì‹œ)</h1><div class="code-block-container border-border bg-card my-6 overflow-hidden rounded-xl border shadow-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:shadow-md"><div class="code-block-header bg-muted/30 border-border flex items-center justify-between border-b px-4 py-3"><div class="flex items-center gap-2"><div class="text-muted-foreground flex-shrink-0"><svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4 4 4-4 4M6 16l-4-4 4-4"/></svg></div><span class="text-muted-foreground text-sm font-medium">PLAINTEXT</span></div><div class="flex items-center gap-2"><button class="collapse-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-8 data-default-state=expanded data-collapsed=false data-auto-collapse-lines=30 data-auto-collapse-height=400 data-collapsed-height=120 title=ì ‘ê¸° aria-label=ì ‘ê¸°>
<span class=collapse-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41 12 10.83l4.59 4.58L18 14l-6-6-6 6z"/></svg>
</span><span class="collapse-text hidden sm:inline">ì ‘ê¸°</span>
</button>
<button class="copy-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-8 title=ë³µì‚¬ aria-label=ë³µì‚¬>
<span class=copy-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/></svg>
</span><span class="copy-text hidden sm:inline">ë³µì‚¬</span></button></div></div><div class="code-block-content relative" id=code-8><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=ln>1</span><span class=cl>ê¸°ì¡´ì´ë‘ ì–´ë–»ê²Œ ë³€ê²½ì´ ë˜ëŠ” í˜¹ì‹œ íŒŒì´ì¬ ì½”ë“œ ì˜ˆì‹œë¡œ ì„¤ëª…ì„ í•´ì¤„ ìˆ˜ ìˆê² ë‹ˆ?</span></span></code></pre></div><div class="collapse-overlay to-card/90 pointer-events-none absolute inset-0 bg-gradient-to-b from-transparent via-transparent opacity-0 transition-opacity duration-300"><div class="text-muted-foreground bg-card/80 border-border/50 hover:bg-primary/10 hover:text-primary hover:border-primary/30 absolute bottom-4 left-1/2 -translate-x-1/2 cursor-pointer rounded-full border px-3 py-1.5 text-xs backdrop-blur-sm transition-all duration-200">í´ë¦­í•˜ì—¬ ë” ë³´ê¸°</div></div></div></div><script>(function(){const s="code-8",n=document.querySelector('.copy-code-btn[data-code-id="'+s+'"]'),t=document.querySelector('.collapse-code-btn[data-code-id="'+s+'"]'),e=document.getElementById(s);if(!e)return;if(n){const s=n.querySelector(".copy-icon"),t=n.querySelector(".copy-text");n.addEventListener("click",async function(){try{let o="";const i=e.querySelector(".lntd:last-child code");if(i)o=i.textContent||i.innerText;else{const t=e.querySelector("code");if(t){const e=t.querySelector(".ln");if(e){const e=t.querySelectorAll(".cl");if(e.length>0)o=Array.from(e).map(e=>{const t=e.textContent||e.innerText;return t.replace(/\n+$/,"")}).join(`
`).replace(/\n+$/,"");else{const e=t.textContent||t.innerText;o=e.replace(/^\d+/gm,"").replace(/^\s+/gm,"")}}else o=t.textContent||t.innerText}else o=e.textContent||e.innerText}o=o.trim(),await navigator.clipboard.writeText(o),s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
</svg>`,t&&(t.textContent="ë³µì‚¬ë¨"),n.classList.add("text-green-600"),setTimeout(()=>{s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
</svg>`,t&&(t.textContent="ë³µì‚¬"),n.classList.remove("text-green-600")},2e3)}catch(o){console.error("å¤åˆ¶å¤±è´¥:",o);const s=document.createRange(),i=e.querySelector("code")||e;s.selectNodeContents(i);const n=window.getSelection();n.removeAllRanges(),n.addRange(s),t&&(t.textContent="ì„ íƒë¨"),setTimeout(()=>{t&&(t.textContent="ë³µì‚¬"),n.removeAllRanges()},2e3)}})}if(t){const d=t.querySelector(".collapse-icon"),c=t.querySelector(".collapse-text"),n=e.querySelector(".collapse-overlay");let s=e.querySelector("pre.chroma");s||(s=e.querySelector("pre"));const m=t.dataset.defaultState||"expanded",f=t.dataset.collapsed==="true",u=parseInt(t.dataset.autoCollapseLines)||30,h=parseInt(t.dataset.autoCollapseHeight)||400,p=parseInt(t.dataset.collapsedHeight)||120;let l=!1;function i(){const e=f||m==="collapsed"||a();e&&o(!0,!1)}function a(){if(s){const e=s.querySelectorAll(".line, .cl"),t=s.offsetHeight;return e.length>u||t>h}const t=e.offsetHeight;if(t>h)return!0;const n=e.textContent||e.innerText||"",o=n.split(`
`).length;return o>u}function o(s,o=!0){if(!n)return;l=s,s?(e.style.maxHeight=p+"px",e.style.overflow="hidden",n.style.opacity="1",n.style.pointerEvents="auto",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
</svg>`,c&&(c.textContent="í¼ì¹˜ê¸°"),t.title="í¼ì¹˜ê¸°"):(e.style.maxHeight="",e.style.overflow="",n.style.opacity="0",n.style.pointerEvents="none",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z"/></svg>`,c&&(c.textContent="ì ‘ê¸°"),t.title="ì ‘ê¸°"),o&&(e.style.transition="max-height 0.3s ease-out",setTimeout(()=>{e.style.transition=""},300))}function r(){o(!l,!0)}t.addEventListener("click",r),n&&n.addEventListener("click",()=>{l&&o(!1,!0)}),i()}})()</script><h2 id=-í•œì¤„-ê²°ë¡ >ğŸ—ï¸ í•œì¤„ ê²°ë¡ </h2><p><strong>Baseline Top-K MoE</strong>ëŠ” <em>N</em>ê°œ FFN ì¤‘ <strong>K (=1â€’2)</strong> ê°œë§Œ ì—´ê³ , <strong>DeepSeekMoE</strong>ëŠ” ê° FFNì„ <em>m</em>ë°° ì„¸ë¶„í™”í•´ <strong>mK+Kâ‚›</strong> ê°œë¥¼ ì—´ì–´ë„ <strong>FLOPsÂ·íŒŒë¼ë¯¸í„°ëŠ” ê·¸ëŒ€ë¡œ</strong>ì´ë©° í‰ê·  <strong>+3 pp</strong> ì„±ëŠ¥ì„ ì–»ëŠ”ë‹¤.</p><hr><h3 id=-êµ¬ì¡°-ë³€ê²½-í•œëˆˆ-ë¹„êµ>ğŸ” êµ¬ì¡° ë³€ê²½ í•œëˆˆ ë¹„êµ</h3><table><thead><tr><th>í•­ëª©</th><th>Baseline (ì˜ˆ: GShard Top-2)</th><th><strong>DeepSeekMoE</strong> (FGES +mK + SEI)</th></tr></thead><tbody><tr><td>ì´ ì „ë¬¸ê°€ ìˆ˜</td><td><em>N</em></td><td><strong>mN</strong> (e.g. 16â†’64, <em>m</em>=4)</td></tr><tr><td>í† í°ë‹¹ í™œì„± ì „ë¬¸ê°€</td><td><em>K</em> (1-2)</td><td><strong>mK + Kâ‚›</strong> (ì˜ˆ: 8 + 2)</td></tr><tr><td>ê³µìœ  ì „ë¬¸ê°€</td><td>ì—†ìŒ</td><td><strong>Kâ‚›</strong> (í•­ìƒ ON)</td></tr><tr><td>FFN hidden dim</td><td><em>dâ‚•</em></td><td><strong>dâ‚• / m</strong> (ì—°ì‚°ëŸ‰ ìœ ì§€)</td></tr><tr><td>ì „ë¬¸ê°€ ì¡°í•© ìˆ˜ (N=16,K=2,m=4,Kâ‚›=2)</td><td>120</td><td><strong>4,426,165,368</strong> (â‰ˆ37 MÃ— â†‘)</td></tr></tbody></table><hr><h2 id=-íŒŒì´ì¬-ì˜ˆì‹œ--pytorch-like-pseudo-code->ğŸ íŒŒì´ì¬ ì˜ˆì‹œ ( PyTorch-like pseudo-code )</h2><div class="code-block-container border-border bg-card my-6 overflow-hidden rounded-xl border shadow-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:shadow-md"><div class="code-block-header bg-muted/30 border-border flex items-center justify-between border-b px-4 py-3"><div class="flex items-center gap-2"><div class="text-muted-foreground flex-shrink-0"><svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4 4 4-4 4M6 16l-4-4 4-4"/></svg></div><span class="text-muted-foreground text-sm font-medium">PYTHON</span></div><div class="flex items-center gap-2"><button class="collapse-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-9 data-default-state=expanded data-collapsed=false data-auto-collapse-lines=30 data-auto-collapse-height=400 data-collapsed-height=120 title=ì ‘ê¸° aria-label=ì ‘ê¸°>
<span class=collapse-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41 12 10.83l4.59 4.58L18 14l-6-6-6 6z"/></svg>
</span><span class="collapse-text hidden sm:inline">ì ‘ê¸°</span>
</button>
<button class="copy-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-9 title=ë³µì‚¬ aria-label=ë³µì‚¬>
<span class=copy-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/></svg>
</span><span class="copy-text hidden sm:inline">ë³µì‚¬</span></button></div></div><div class="code-block-content relative" id=code-9><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=ln> 1</span><span class=cl><span class=kn>import</span> <span class=nn>torch</span>
</span></span><span class=line><span class=ln> 2</span><span class=cl><span class=kn>import</span> <span class=nn>torch.nn</span> <span class=k>as</span> <span class=nn>nn</span>
</span></span><span class=line><span class=ln> 3</span><span class=cl><span class=kn>import</span> <span class=nn>torch.nn.functional</span> <span class=k>as</span> <span class=nn>F</span>
</span></span><span class=line><span class=ln> 4</span><span class=cl>
</span></span><span class=line><span class=ln> 5</span><span class=cl><span class=c1># ---------- 1. Baseline Top-K Router ----------</span>
</span></span><span class=line><span class=ln> 6</span><span class=cl><span class=k>class</span> <span class=nc>TopKRouter</span><span class=p>(</span><span class=n>nn</span><span class=o>.</span><span class=n>Module</span><span class=p>):</span>
</span></span><span class=line><span class=ln> 7</span><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>d_model</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span> <span class=n>num_experts</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span> <span class=n>k</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>2</span><span class=p>):</span>
</span></span><span class=line><span class=ln> 8</span><span class=cl>        <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__init__</span><span class=p>()</span>
</span></span><span class=line><span class=ln> 9</span><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>centroids</span> <span class=o>=</span> <span class=n>nn</span><span class=o>.</span><span class=n>Parameter</span><span class=p>(</span><span class=n>torch</span><span class=o>.</span><span class=n>randn</span><span class=p>(</span><span class=n>num_experts</span><span class=p>,</span> <span class=n>d_model</span><span class=p>))</span>
</span></span><span class=line><span class=ln>10</span><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>k</span> <span class=o>=</span> <span class=n>k</span>
</span></span><span class=line><span class=ln>11</span><span class=cl>
</span></span><span class=line><span class=ln>12</span><span class=cl>    <span class=k>def</span> <span class=nf>forward</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>x</span><span class=p>):</span>                     <span class=c1># x: (B, T, d_model)</span>
</span></span><span class=line><span class=ln>13</span><span class=cl>        <span class=c1># (BÂ·T, N)</span>
</span></span><span class=line><span class=ln>14</span><span class=cl>        <span class=n>scores</span> <span class=o>=</span> <span class=n>torch</span><span class=o>.</span><span class=n>matmul</span><span class=p>(</span><span class=n>x</span><span class=o>.</span><span class=n>reshape</span><span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=n>x</span><span class=o>.</span><span class=n>size</span><span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>)),</span> <span class=bp>self</span><span class=o>.</span><span class=n>centroids</span><span class=o>.</span><span class=n>t</span><span class=p>())</span>
</span></span><span class=line><span class=ln>15</span><span class=cl>        <span class=n>topk_val</span><span class=p>,</span> <span class=n>topk_idx</span> <span class=o>=</span> <span class=n>scores</span><span class=o>.</span><span class=n>topk</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>k</span><span class=p>,</span> <span class=n>dim</span><span class=o>=-</span><span class=mi>1</span><span class=p>)</span>   <span class=c1># indices of K best experts</span>
</span></span><span class=line><span class=ln>16</span><span class=cl>        <span class=n>gate</span> <span class=o>=</span> <span class=n>torch</span><span class=o>.</span><span class=n>zeros_like</span><span class=p>(</span><span class=n>scores</span><span class=p>)</span><span class=o>.</span><span class=n>scatter_</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=n>topk_idx</span><span class=p>,</span> <span class=n>F</span><span class=o>.</span><span class=n>softmax</span><span class=p>(</span><span class=n>topk_val</span><span class=p>,</span> <span class=n>dim</span><span class=o>=-</span><span class=mi>1</span><span class=p>))</span>
</span></span><span class=line><span class=ln>17</span><span class=cl>        <span class=k>return</span> <span class=n>gate</span><span class=o>.</span><span class=n>view</span><span class=p>(</span><span class=o>*</span><span class=n>x</span><span class=o>.</span><span class=n>shape</span><span class=p>[:</span><span class=mi>2</span><span class=p>],</span> <span class=o>-</span><span class=mi>1</span><span class=p>)</span>    <span class=c1># (B, T, N)</span>
</span></span><span class=line><span class=ln>18</span><span class=cl>
</span></span><span class=line><span class=ln>19</span><span class=cl>
</span></span><span class=line><span class=ln>20</span><span class=cl><span class=c1># ---------- 2. DeepSeekMoE Router (FGES + Shared Experts) ----------</span>
</span></span><span class=line><span class=ln>21</span><span class=cl><span class=k>class</span> <span class=nc>FGESRouter</span><span class=p>(</span><span class=n>nn</span><span class=o>.</span><span class=n>Module</span><span class=p>):</span>
</span></span><span class=line><span class=ln>22</span><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>d_model</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>  <span class=n>N</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span> <span class=n>m</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>4</span><span class=p>,</span>
</span></span><span class=line><span class=ln>23</span><span class=cl>                 <span class=n>k</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>2</span><span class=p>,</span> <span class=n>k_shared</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>2</span><span class=p>):</span>
</span></span><span class=line><span class=ln>24</span><span class=cl>        <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__init__</span><span class=p>()</span>
</span></span><span class=line><span class=ln>25</span><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>m</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>k</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>k_shared</span> <span class=o>=</span> <span class=n>m</span><span class=p>,</span> <span class=n>k</span><span class=p>,</span> <span class=n>k_shared</span>
</span></span><span class=line><span class=ln>26</span><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>num_experts</span> <span class=o>=</span> <span class=n>N</span> <span class=o>*</span> <span class=n>m</span>
</span></span><span class=line><span class=ln>27</span><span class=cl>        <span class=c1># shared experts are the first k_shared indices</span>
</span></span><span class=line><span class=ln>28</span><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>centroids</span> <span class=o>=</span> <span class=n>nn</span><span class=o>.</span><span class=n>Parameter</span><span class=p>(</span><span class=n>torch</span><span class=o>.</span><span class=n>randn</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>num_experts</span><span class=p>,</span> <span class=n>d_model</span><span class=p>))</span>
</span></span><span class=line><span class=ln>29</span><span class=cl>
</span></span><span class=line><span class=ln>30</span><span class=cl>    <span class=k>def</span> <span class=nf>forward</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>x</span><span class=p>):</span>                     <span class=c1># x: (B, T, d_model)</span>
</span></span><span class=line><span class=ln>31</span><span class=cl>        <span class=n>bt</span><span class=p>,</span> <span class=n>d</span> <span class=o>=</span> <span class=n>x</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>*</span><span class=n>x</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span> <span class=n>x</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span>
</span></span><span class=line><span class=ln>32</span><span class=cl>        <span class=n>scores</span> <span class=o>=</span> <span class=n>torch</span><span class=o>.</span><span class=n>matmul</span><span class=p>(</span><span class=n>x</span><span class=o>.</span><span class=n>reshape</span><span class=p>(</span><span class=n>bt</span><span class=p>,</span> <span class=n>d</span><span class=p>),</span> <span class=bp>self</span><span class=o>.</span><span class=n>centroids</span><span class=o>.</span><span class=n>t</span><span class=p>())</span>  <span class=c1># (BÂ·T, mN)</span>
</span></span><span class=line><span class=ln>33</span><span class=cl>
</span></span><span class=line><span class=ln>34</span><span class=cl>        <span class=c1># always keep shared experts (0 â€¦ k_shared-1)</span>
</span></span><span class=line><span class=ln>35</span><span class=cl>        <span class=n>mask_shared</span> <span class=o>=</span> <span class=n>torch</span><span class=o>.</span><span class=n>zeros_like</span><span class=p>(</span><span class=n>scores</span><span class=p>)</span>
</span></span><span class=line><span class=ln>36</span><span class=cl>        <span class=n>mask_shared</span><span class=p>[:,</span> <span class=p>:</span><span class=bp>self</span><span class=o>.</span><span class=n>k_shared</span><span class=p>]</span> <span class=o>=</span> <span class=mf>1.0</span>
</span></span><span class=line><span class=ln>37</span><span class=cl>
</span></span><span class=line><span class=ln>38</span><span class=cl>        <span class=c1># choose additional (mK - k_shared) experts</span>
</span></span><span class=line><span class=ln>39</span><span class=cl>        <span class=n>mK</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>m</span> <span class=o>*</span> <span class=bp>self</span><span class=o>.</span><span class=n>k</span>
</span></span><span class=line><span class=ln>40</span><span class=cl>        <span class=n>extra_k</span> <span class=o>=</span> <span class=n>mK</span> <span class=o>-</span> <span class=bp>self</span><span class=o>.</span><span class=n>k_shared</span>
</span></span><span class=line><span class=ln>41</span><span class=cl>        <span class=n>topk_val</span><span class=p>,</span> <span class=n>topk_idx</span> <span class=o>=</span> <span class=n>scores</span><span class=p>[:,</span> <span class=bp>self</span><span class=o>.</span><span class=n>k_shared</span><span class=p>:]</span><span class=o>.</span><span class=n>topk</span><span class=p>(</span><span class=n>extra_k</span><span class=p>,</span> <span class=n>dim</span><span class=o>=-</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=ln>42</span><span class=cl>        <span class=n>gate_extra</span> <span class=o>=</span> <span class=n>torch</span><span class=o>.</span><span class=n>zeros_like</span><span class=p>(</span><span class=n>scores</span><span class=p>)</span>
</span></span><span class=line><span class=ln>43</span><span class=cl>        <span class=n>gate_extra</span><span class=o>.</span><span class=n>scatter_</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=n>topk_idx</span> <span class=o>+</span> <span class=bp>self</span><span class=o>.</span><span class=n>k_shared</span><span class=p>,</span> <span class=n>F</span><span class=o>.</span><span class=n>softmax</span><span class=p>(</span><span class=n>topk_val</span><span class=p>,</span> <span class=n>dim</span><span class=o>=-</span><span class=mi>1</span><span class=p>))</span>
</span></span><span class=line><span class=ln>44</span><span class=cl>
</span></span><span class=line><span class=ln>45</span><span class=cl>        <span class=c1># gate for shared experts = softmax over their scores</span>
</span></span><span class=line><span class=ln>46</span><span class=cl>        <span class=n>gate_shared</span> <span class=o>=</span> <span class=n>F</span><span class=o>.</span><span class=n>softmax</span><span class=p>(</span><span class=n>scores</span><span class=p>[:,</span> <span class=p>:</span><span class=bp>self</span><span class=o>.</span><span class=n>k_shared</span><span class=p>],</span> <span class=n>dim</span><span class=o>=-</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=ln>47</span><span class=cl>        <span class=n>gate</span> <span class=o>=</span> <span class=n>mask_shared</span> <span class=o>*</span> <span class=n>gate_shared</span> <span class=o>+</span> <span class=n>gate_extra</span>
</span></span><span class=line><span class=ln>48</span><span class=cl>        <span class=k>return</span> <span class=n>gate</span><span class=o>.</span><span class=n>view</span><span class=p>(</span><span class=o>*</span><span class=n>x</span><span class=o>.</span><span class=n>shape</span><span class=p>[:</span><span class=mi>2</span><span class=p>],</span> <span class=o>-</span><span class=mi>1</span><span class=p>)</span>    <span class=c1># (B, T, mN)</span>
</span></span><span class=line><span class=ln>49</span><span class=cl>
</span></span><span class=line><span class=ln>50</span><span class=cl>
</span></span><span class=line><span class=ln>51</span><span class=cl><span class=c1># ---------- 3. MoE Layer Skeleton ----------</span>
</span></span><span class=line><span class=ln>52</span><span class=cl><span class=k>class</span> <span class=nc>MoELayer</span><span class=p>(</span><span class=n>nn</span><span class=o>.</span><span class=n>Module</span><span class=p>):</span>
</span></span><span class=line><span class=ln>53</span><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>d_model</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span> <span class=n>d_ff</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
</span></span><span class=line><span class=ln>54</span><span class=cl>                 <span class=n>router</span><span class=p>:</span> <span class=n>nn</span><span class=o>.</span><span class=n>Module</span><span class=p>,</span>  <span class=n>num_experts</span><span class=p>:</span> <span class=nb>int</span><span class=p>):</span>
</span></span><span class=line><span class=ln>55</span><span class=cl>        <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__init__</span><span class=p>()</span>
</span></span><span class=line><span class=ln>56</span><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>router</span> <span class=o>=</span> <span class=n>router</span>
</span></span><span class=line><span class=ln>57</span><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>experts</span> <span class=o>=</span> <span class=n>nn</span><span class=o>.</span><span class=n>ModuleList</span><span class=p>(</span>
</span></span><span class=line><span class=ln>58</span><span class=cl>            <span class=p>[</span><span class=n>nn</span><span class=o>.</span><span class=n>Sequential</span><span class=p>(</span><span class=n>nn</span><span class=o>.</span><span class=n>Linear</span><span class=p>(</span><span class=n>d_model</span><span class=p>,</span> <span class=n>d_ff</span><span class=p>),</span>
</span></span><span class=line><span class=ln>59</span><span class=cl>                           <span class=n>nn</span><span class=o>.</span><span class=n>GELU</span><span class=p>(),</span>
</span></span><span class=line><span class=ln>60</span><span class=cl>                           <span class=n>nn</span><span class=o>.</span><span class=n>Linear</span><span class=p>(</span><span class=n>d_ff</span><span class=p>,</span> <span class=n>d_model</span><span class=p>))</span>
</span></span><span class=line><span class=ln>61</span><span class=cl>             <span class=k>for</span> <span class=n>_</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>num_experts</span><span class=p>)]</span>
</span></span><span class=line><span class=ln>62</span><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=ln>63</span><span class=cl>
</span></span><span class=line><span class=ln>64</span><span class=cl>    <span class=k>def</span> <span class=nf>forward</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>x</span><span class=p>):</span>                    <span class=c1># x: (B, T, d_model)</span>
</span></span><span class=line><span class=ln>65</span><span class=cl>        <span class=n>gate</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>router</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>                <span class=c1># (B, T, E)</span>
</span></span><span class=line><span class=ln>66</span><span class=cl>        <span class=n>out</span> <span class=o>=</span> <span class=n>torch</span><span class=o>.</span><span class=n>zeros_like</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
</span></span><span class=line><span class=ln>67</span><span class=cl>        <span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>expert</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>experts</span><span class=p>):</span>
</span></span><span class=line><span class=ln>68</span><span class=cl>            <span class=c1># mask tokens routed to expert i</span>
</span></span><span class=line><span class=ln>69</span><span class=cl>            <span class=n>g</span> <span class=o>=</span> <span class=n>gate</span><span class=p>[</span><span class=o>...</span><span class=p>,</span> <span class=n>i</span><span class=p>]</span><span class=o>.</span><span class=n>unsqueeze</span><span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>)</span>   <span class=c1># (B, T, 1)</span>
</span></span><span class=line><span class=ln>70</span><span class=cl>            <span class=k>if</span> <span class=n>g</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>                 <span class=c1># skip empty expert</span>
</span></span><span class=line><span class=ln>71</span><span class=cl>                <span class=k>continue</span>
</span></span><span class=line><span class=ln>72</span><span class=cl>            <span class=n>out</span> <span class=o>+=</span> <span class=n>g</span> <span class=o>*</span> <span class=n>expert</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
</span></span><span class=line><span class=ln>73</span><span class=cl>        <span class=k>return</span> <span class=n>out</span> <span class=o>+</span> <span class=n>x</span>                       <span class=c1># residual add</span></span></span></code></pre></div><div class="collapse-overlay to-card/90 pointer-events-none absolute inset-0 bg-gradient-to-b from-transparent via-transparent opacity-0 transition-opacity duration-300"><div class="text-muted-foreground bg-card/80 border-border/50 hover:bg-primary/10 hover:text-primary hover:border-primary/30 absolute bottom-4 left-1/2 -translate-x-1/2 cursor-pointer rounded-full border px-3 py-1.5 text-xs backdrop-blur-sm transition-all duration-200">í´ë¦­í•˜ì—¬ ë” ë³´ê¸°</div></div></div></div><script>(function(){const s="code-9",n=document.querySelector('.copy-code-btn[data-code-id="'+s+'"]'),t=document.querySelector('.collapse-code-btn[data-code-id="'+s+'"]'),e=document.getElementById(s);if(!e)return;if(n){const s=n.querySelector(".copy-icon"),t=n.querySelector(".copy-text");n.addEventListener("click",async function(){try{let o="";const i=e.querySelector(".lntd:last-child code");if(i)o=i.textContent||i.innerText;else{const t=e.querySelector("code");if(t){const e=t.querySelector(".ln");if(e){const e=t.querySelectorAll(".cl");if(e.length>0)o=Array.from(e).map(e=>{const t=e.textContent||e.innerText;return t.replace(/\n+$/,"")}).join(`
`).replace(/\n+$/,"");else{const e=t.textContent||t.innerText;o=e.replace(/^\d+/gm,"").replace(/^\s+/gm,"")}}else o=t.textContent||t.innerText}else o=e.textContent||e.innerText}o=o.trim(),await navigator.clipboard.writeText(o),s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
</svg>`,t&&(t.textContent="ë³µì‚¬ë¨"),n.classList.add("text-green-600"),setTimeout(()=>{s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
</svg>`,t&&(t.textContent="ë³µì‚¬"),n.classList.remove("text-green-600")},2e3)}catch(o){console.error("å¤åˆ¶å¤±è´¥:",o);const s=document.createRange(),i=e.querySelector("code")||e;s.selectNodeContents(i);const n=window.getSelection();n.removeAllRanges(),n.addRange(s),t&&(t.textContent="ì„ íƒë¨"),setTimeout(()=>{t&&(t.textContent="ë³µì‚¬"),n.removeAllRanges()},2e3)}})}if(t){const d=t.querySelector(".collapse-icon"),c=t.querySelector(".collapse-text"),n=e.querySelector(".collapse-overlay");let s=e.querySelector("pre.chroma");s||(s=e.querySelector("pre"));const m=t.dataset.defaultState||"expanded",f=t.dataset.collapsed==="true",u=parseInt(t.dataset.autoCollapseLines)||30,h=parseInt(t.dataset.autoCollapseHeight)||400,p=parseInt(t.dataset.collapsedHeight)||120;let l=!1;function i(){const e=f||m==="collapsed"||a();e&&o(!0,!1)}function a(){if(s){const e=s.querySelectorAll(".line, .cl"),t=s.offsetHeight;return e.length>u||t>h}const t=e.offsetHeight;if(t>h)return!0;const n=e.textContent||e.innerText||"",o=n.split(`
`).length;return o>u}function o(s,o=!0){if(!n)return;l=s,s?(e.style.maxHeight=p+"px",e.style.overflow="hidden",n.style.opacity="1",n.style.pointerEvents="auto",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
</svg>`,c&&(c.textContent="í¼ì¹˜ê¸°"),t.title="í¼ì¹˜ê¸°"):(e.style.maxHeight="",e.style.overflow="",n.style.opacity="0",n.style.pointerEvents="none",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z"/></svg>`,c&&(c.textContent="ì ‘ê¸°"),t.title="ì ‘ê¸°"),o&&(e.style.transition="max-height 0.3s ease-out",setTimeout(()=>{e.style.transition=""},300))}function r(){o(!l,!0)}t.addEventListener("click",r),n&&n.addEventListener("click",()=>{l&&o(!1,!0)}),i()}})()</script><h3 id=-ì‚¬ìš©-ì˜ˆ>â–¶ï¸ ì‚¬ìš© ì˜ˆ</h3><div class="code-block-container border-border bg-card my-6 overflow-hidden rounded-xl border shadow-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:shadow-md"><div class="code-block-header bg-muted/30 border-border flex items-center justify-between border-b px-4 py-3"><div class="flex items-center gap-2"><div class="text-muted-foreground flex-shrink-0"><svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4 4 4-4 4M6 16l-4-4 4-4"/></svg></div><span class="text-muted-foreground text-sm font-medium">PYTHON</span></div><div class="flex items-center gap-2"><button class="collapse-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-10 data-default-state=expanded data-collapsed=false data-auto-collapse-lines=30 data-auto-collapse-height=400 data-collapsed-height=120 title=ì ‘ê¸° aria-label=ì ‘ê¸°>
<span class=collapse-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41 12 10.83l4.59 4.58L18 14l-6-6-6 6z"/></svg>
</span><span class="collapse-text hidden sm:inline">ì ‘ê¸°</span>
</button>
<button class="copy-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-10 title=ë³µì‚¬ aria-label=ë³µì‚¬>
<span class=copy-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/></svg>
</span><span class="copy-text hidden sm:inline">ë³µì‚¬</span></button></div></div><div class="code-block-content relative" id=code-10><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=ln> 1</span><span class=cl><span class=n>B</span><span class=p>,</span> <span class=n>T</span><span class=p>,</span> <span class=n>D</span> <span class=o>=</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>32</span>
</span></span><span class=line><span class=ln> 2</span><span class=cl><span class=n>x</span> <span class=o>=</span> <span class=n>torch</span><span class=o>.</span><span class=n>randn</span><span class=p>(</span><span class=n>B</span><span class=p>,</span> <span class=n>T</span><span class=p>,</span> <span class=n>D</span><span class=p>)</span>
</span></span><span class=line><span class=ln> 3</span><span class=cl>
</span></span><span class=line><span class=ln> 4</span><span class=cl><span class=c1># A. Baseline Top-2 (N=16)</span>
</span></span><span class=line><span class=ln> 5</span><span class=cl><span class=n>router_base</span> <span class=o>=</span> <span class=n>TopKRouter</span><span class=p>(</span><span class=n>d_model</span><span class=o>=</span><span class=n>D</span><span class=p>,</span> <span class=n>num_experts</span><span class=o>=</span><span class=mi>16</span><span class=p>,</span> <span class=n>k</span><span class=o>=</span><span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=ln> 6</span><span class=cl><span class=n>moe_base</span> <span class=o>=</span> <span class=n>MoELayer</span><span class=p>(</span><span class=n>D</span><span class=p>,</span> <span class=n>d_ff</span><span class=o>=</span><span class=mi>64</span><span class=p>,</span> <span class=n>router</span><span class=o>=</span><span class=n>router_base</span><span class=p>,</span> <span class=n>num_experts</span><span class=o>=</span><span class=mi>16</span><span class=p>)</span>
</span></span><span class=line><span class=ln> 7</span><span class=cl><span class=n>y_base</span> <span class=o>=</span> <span class=n>moe_base</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>                        <span class=c1># FLOPs ~ 2 Ã— FFN</span>
</span></span><span class=line><span class=ln> 8</span><span class=cl>
</span></span><span class=line><span class=ln> 9</span><span class=cl><span class=c1># B. DeepSeekMoE (N=16, m=4 â†’ 64 experts, mK=8, K_s=2)</span>
</span></span><span class=line><span class=ln>10</span><span class=cl><span class=n>router_fges</span> <span class=o>=</span> <span class=n>FGESRouter</span><span class=p>(</span><span class=n>d_model</span><span class=o>=</span><span class=n>D</span><span class=p>,</span> <span class=n>N</span><span class=o>=</span><span class=mi>16</span><span class=p>,</span> <span class=n>m</span><span class=o>=</span><span class=mi>4</span><span class=p>,</span> <span class=n>k</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span> <span class=n>k_shared</span><span class=o>=</span><span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=ln>11</span><span class=cl><span class=n>moe_fges</span> <span class=o>=</span> <span class=n>MoELayer</span><span class=p>(</span><span class=n>D</span><span class=p>,</span> <span class=n>d_ff</span><span class=o>=</span><span class=mi>64</span><span class=o>//</span><span class=mi>4</span><span class=p>,</span> <span class=n>router</span><span class=o>=</span><span class=n>router_fges</span><span class=p>,</span> <span class=n>num_experts</span><span class=o>=</span><span class=mi>64</span><span class=p>)</span>
</span></span><span class=line><span class=ln>12</span><span class=cl><span class=n>y_fges</span> <span class=o>=</span> <span class=n>moe_fges</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>                        <span class=c1># FLOPs â‰ˆ Baseline</span></span></span></code></pre></div><div class="collapse-overlay to-card/90 pointer-events-none absolute inset-0 bg-gradient-to-b from-transparent via-transparent opacity-0 transition-opacity duration-300"><div class="text-muted-foreground bg-card/80 border-border/50 hover:bg-primary/10 hover:text-primary hover:border-primary/30 absolute bottom-4 left-1/2 -translate-x-1/2 cursor-pointer rounded-full border px-3 py-1.5 text-xs backdrop-blur-sm transition-all duration-200">í´ë¦­í•˜ì—¬ ë” ë³´ê¸°</div></div></div></div><script>(function(){const s="code-10",n=document.querySelector('.copy-code-btn[data-code-id="'+s+'"]'),t=document.querySelector('.collapse-code-btn[data-code-id="'+s+'"]'),e=document.getElementById(s);if(!e)return;if(n){const s=n.querySelector(".copy-icon"),t=n.querySelector(".copy-text");n.addEventListener("click",async function(){try{let o="";const i=e.querySelector(".lntd:last-child code");if(i)o=i.textContent||i.innerText;else{const t=e.querySelector("code");if(t){const e=t.querySelector(".ln");if(e){const e=t.querySelectorAll(".cl");if(e.length>0)o=Array.from(e).map(e=>{const t=e.textContent||e.innerText;return t.replace(/\n+$/,"")}).join(`
`).replace(/\n+$/,"");else{const e=t.textContent||t.innerText;o=e.replace(/^\d+/gm,"").replace(/^\s+/gm,"")}}else o=t.textContent||t.innerText}else o=e.textContent||e.innerText}o=o.trim(),await navigator.clipboard.writeText(o),s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
</svg>`,t&&(t.textContent="ë³µì‚¬ë¨"),n.classList.add("text-green-600"),setTimeout(()=>{s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
</svg>`,t&&(t.textContent="ë³µì‚¬"),n.classList.remove("text-green-600")},2e3)}catch(o){console.error("å¤åˆ¶å¤±è´¥:",o);const s=document.createRange(),i=e.querySelector("code")||e;s.selectNodeContents(i);const n=window.getSelection();n.removeAllRanges(),n.addRange(s),t&&(t.textContent="ì„ íƒë¨"),setTimeout(()=>{t&&(t.textContent="ë³µì‚¬"),n.removeAllRanges()},2e3)}})}if(t){const d=t.querySelector(".collapse-icon"),c=t.querySelector(".collapse-text"),n=e.querySelector(".collapse-overlay");let s=e.querySelector("pre.chroma");s||(s=e.querySelector("pre"));const m=t.dataset.defaultState||"expanded",f=t.dataset.collapsed==="true",u=parseInt(t.dataset.autoCollapseLines)||30,h=parseInt(t.dataset.autoCollapseHeight)||400,p=parseInt(t.dataset.collapsedHeight)||120;let l=!1;function i(){const e=f||m==="collapsed"||a();e&&o(!0,!1)}function a(){if(s){const e=s.querySelectorAll(".line, .cl"),t=s.offsetHeight;return e.length>u||t>h}const t=e.offsetHeight;if(t>h)return!0;const n=e.textContent||e.innerText||"",o=n.split(`
`).length;return o>u}function o(s,o=!0){if(!n)return;l=s,s?(e.style.maxHeight=p+"px",e.style.overflow="hidden",n.style.opacity="1",n.style.pointerEvents="auto",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
</svg>`,c&&(c.textContent="í¼ì¹˜ê¸°"),t.title="í¼ì¹˜ê¸°"):(e.style.maxHeight="",e.style.overflow="",n.style.opacity="0",n.style.pointerEvents="none",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z"/></svg>`,c&&(c.textContent="ì ‘ê¸°"),t.title="ì ‘ê¸°"),o&&(e.style.transition="max-height 0.3s ease-out",setTimeout(()=>{e.style.transition=""},300))}function r(){o(!l,!0)}t.addEventListener("click",r),n&&n.addEventListener("click",()=>{l&&o(!1,!0)}),i()}})()</script><blockquote class="border-primary bg-muted/30 hover:bg-muted/40 my-6 rounded-r-lg border-l-4 py-4 pr-4 pl-6 italic transition-all duration-200 ease-out hover:translate-x-1"><div class="prose prose-sm max-w-none"><p><strong>ì£¼ëª©</strong></p><ul><li><code>d_ff</code>ë¥¼ Â¼ë¡œ ì¤„ì—¬ <strong>ì—°ì‚°Â·íŒŒë¼ë¯¸í„° ì´í•©ì€ ë™ì¼</strong></li><li><code>gate</code> ëª¨ì–‘ì„ ì‚´í´ë³´ë©´ DeepSeekMoE ìª½ì´ <strong>ë” ë§ì€(10ê°œ) ì „ë¬¸ê°€</strong>ë¥¼ í™œì„±í™”í•˜ë©´ì„œë„ shared 0-1 ì¸ë±ìŠ¤ê°€ í•­ìƒ 1ì— ê°€ê¹Œìš´ ê°’ì„ ì°¨ì§€í•´ ê³µí†µ ì§€ì‹ì„ ì§‘ì¤‘ í•™ìŠµí•œë‹¤.</li></ul></div></blockquote><hr><h3 id=-í•µì‹¬-ë³€ê²½-í¬ì¸íŠ¸-ìš”ì•½>ğŸ’¡ í•µì‹¬ ë³€ê²½ í¬ì¸íŠ¸ ìš”ì•½</h3><ol><li><strong>Expert ìˆ˜</strong>: <code>num_experts = N</code> â†’ <code>N*m</code></li><li><strong>FFN hidden dim</strong>: <code>d_ff</code> â†’ <code>d_ff/m</code></li><li><strong>Routing</strong>: <code>topk(k)</code> â†’ <code>shared Kâ‚› âˆª topk(mK-Kâ‚›)</code></li></ol><p>ìœ„ ì„¸ ì¤„ë§Œ ë°”ê¿”ë„ <strong>í‘œí˜„ë ¥ â†‘ 37 MÃ—, ì„±ëŠ¥ +3 pp, FLOPs ë™ì¼</strong>ì„ ì‹¤í˜„í•  ìˆ˜ ìˆë‹¤ëŠ” ì ì´ DeepSeekMoEì˜ í•µì‹¬ì´ë‹¤.</p><h1 id=í”„ë¡¬í”„íŠ¸-141-í•µì‹¬-ê²°ê³¼-ë¶„ì„>í”„ë¡¬í”„íŠ¸ 1.4.1 (í•µì‹¬ ê²°ê³¼ ë¶„ì„)</h1><div class="code-block-container border-border bg-card my-6 overflow-hidden rounded-xl border shadow-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:shadow-md"><div class="code-block-header bg-muted/30 border-border flex items-center justify-between border-b px-4 py-3"><div class="flex items-center gap-2"><div class="text-muted-foreground flex-shrink-0"><svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4 4 4-4 4M6 16l-4-4 4-4"/></svg></div><span class="text-muted-foreground text-sm font-medium">PLAINTEXT</span></div><div class="flex items-center gap-2"><button class="collapse-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-11 data-default-state=expanded data-collapsed=false data-auto-collapse-lines=30 data-auto-collapse-height=400 data-collapsed-height=120 title=ì ‘ê¸° aria-label=ì ‘ê¸°>
<span class=collapse-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41 12 10.83l4.59 4.58L18 14l-6-6-6 6z"/></svg>
</span><span class="collapse-text hidden sm:inline">ì ‘ê¸°</span>
</button>
<button class="copy-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-11 title=ë³µì‚¬ aria-label=ë³µì‚¬>
<span class=copy-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/></svg>
</span><span class="copy-text hidden sm:inline">ë³µì‚¬</span></button></div></div><div class="code-block-content relative" id=code-11><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=ln>1</span><span class=cl>&#34;&#39;Experiments&#39; ë˜ëŠ” &#39;Results&#39; ì„¹ì…˜ì˜ í‘œì™€ ê·¸ë¦¼ì„ í¬í•¨í•œ ì£¼ìš” ê²°ê³¼ë¥¼ ë¶„ì„í•´ ì¤˜. ì‚¬ìš©ëœ í•µì‹¬ ì„±ëŠ¥ ì§€í‘œ(performance metrics)ëŠ” ë¬´ì—‡ì¸ê°€? ì–´ë–¤ ë²¤ì¹˜ë§ˆí¬ ë°ì´í„°ì…‹ì—ì„œ ê²°ê³¼ê°€ ë³´ê³ ë˜ì—ˆëŠ”ê°€? ì €ìë“¤ì´ ìì‹ ë“¤ì˜ ë°©ë²•ë¡ ì˜ ì„±ê³µ ì¦ê±°ë¡œ ê°€ì¥ ê°•ì¡°í•˜ëŠ” ì£¼ìš” ê²°ê³¼ë¥¼ ìš”ì•½í•´ ì¤˜.&#34;</span></span></code></pre></div><div class="collapse-overlay to-card/90 pointer-events-none absolute inset-0 bg-gradient-to-b from-transparent via-transparent opacity-0 transition-opacity duration-300"><div class="text-muted-foreground bg-card/80 border-border/50 hover:bg-primary/10 hover:text-primary hover:border-primary/30 absolute bottom-4 left-1/2 -translate-x-1/2 cursor-pointer rounded-full border px-3 py-1.5 text-xs backdrop-blur-sm transition-all duration-200">í´ë¦­í•˜ì—¬ ë” ë³´ê¸°</div></div></div></div><script>(function(){const s="code-11",n=document.querySelector('.copy-code-btn[data-code-id="'+s+'"]'),t=document.querySelector('.collapse-code-btn[data-code-id="'+s+'"]'),e=document.getElementById(s);if(!e)return;if(n){const s=n.querySelector(".copy-icon"),t=n.querySelector(".copy-text");n.addEventListener("click",async function(){try{let o="";const i=e.querySelector(".lntd:last-child code");if(i)o=i.textContent||i.innerText;else{const t=e.querySelector("code");if(t){const e=t.querySelector(".ln");if(e){const e=t.querySelectorAll(".cl");if(e.length>0)o=Array.from(e).map(e=>{const t=e.textContent||e.innerText;return t.replace(/\n+$/,"")}).join(`
`).replace(/\n+$/,"");else{const e=t.textContent||t.innerText;o=e.replace(/^\d+/gm,"").replace(/^\s+/gm,"")}}else o=t.textContent||t.innerText}else o=e.textContent||e.innerText}o=o.trim(),await navigator.clipboard.writeText(o),s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
</svg>`,t&&(t.textContent="ë³µì‚¬ë¨"),n.classList.add("text-green-600"),setTimeout(()=>{s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
</svg>`,t&&(t.textContent="ë³µì‚¬"),n.classList.remove("text-green-600")},2e3)}catch(o){console.error("å¤åˆ¶å¤±è´¥:",o);const s=document.createRange(),i=e.querySelector("code")||e;s.selectNodeContents(i);const n=window.getSelection();n.removeAllRanges(),n.addRange(s),t&&(t.textContent="ì„ íƒë¨"),setTimeout(()=>{t&&(t.textContent="ë³µì‚¬"),n.removeAllRanges()},2e3)}})}if(t){const d=t.querySelector(".collapse-icon"),c=t.querySelector(".collapse-text"),n=e.querySelector(".collapse-overlay");let s=e.querySelector("pre.chroma");s||(s=e.querySelector("pre"));const m=t.dataset.defaultState||"expanded",f=t.dataset.collapsed==="true",u=parseInt(t.dataset.autoCollapseLines)||30,h=parseInt(t.dataset.autoCollapseHeight)||400,p=parseInt(t.dataset.collapsedHeight)||120;let l=!1;function i(){const e=f||m==="collapsed"||a();e&&o(!0,!1)}function a(){if(s){const e=s.querySelectorAll(".line, .cl"),t=s.offsetHeight;return e.length>u||t>h}const t=e.offsetHeight;if(t>h)return!0;const n=e.textContent||e.innerText||"",o=n.split(`
`).length;return o>u}function o(s,o=!0){if(!n)return;l=s,s?(e.style.maxHeight=p+"px",e.style.overflow="hidden",n.style.opacity="1",n.style.pointerEvents="auto",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
</svg>`,c&&(c.textContent="í¼ì¹˜ê¸°"),t.title="í¼ì¹˜ê¸°"):(e.style.maxHeight="",e.style.overflow="",n.style.opacity="0",n.style.pointerEvents="none",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z"/></svg>`,c&&(c.textContent="ì ‘ê¸°"),t.title="ì ‘ê¸°"),o&&(e.style.transition="max-height 0.3s ease-out",setTimeout(()=>{e.style.transition=""},300))}function r(){o(!l,!0)}t.addEventListener("click",r),n&&n.addEventListener("click",()=>{l&&o(!1,!0)}),i()}})()</script><h2 id=-tldr--deepseekmoe-results-í•œëˆˆ-ìš”ì•½>ğŸš€ TL;DR â€” DeepSeekMoE â€œResultsâ€ í•œëˆˆ ìš”ì•½</h2><ul><li><p><strong>2 B ì‹¤í—˜:</strong> ë™ì¼ FLOPs(2.9 T)ì—ì„œ GShard 2 B ëŒ€ë¹„ <strong>HellaSwag +4.3 pp</strong>Â·<strong>ARC-ch +2.7 pp</strong>Â·í‰ê·  <strong>+3 pp</strong> ì„±ëŠ¥ í–¥ìƒ (í™œì„± íŒŒë¼ë¯¸í„° 0.3 B ë™ì¼)</p></li><li><p><strong>16 B ëª¨ë¸:</strong> ì´ íŒŒë¼ë¯¸í„°ëŠ” 16.4 Bì´ì§€ë§Œ <strong>í™œì„± 2.8 B (+40 % FLOPs)</strong> ë¡œë„</p><ul><li><strong>LLaMA-2 7 B</strong> ë³´ë‹¤ 10ê°œ ë²¤ì¹˜ ì¤‘ 7ê°œâ†‘ (ì˜ˆ: HellaSwag 77.1 vs 75.6)</li><li><strong>DeepSeek 7 B</strong> ì™€ ì „ë°˜ì  ë™ì¼ ì„±ëŠ¥ì„ <strong>ì—°ì‚°ëŸ‰ 40 %</strong> ë¡œ ë‹¬ì„±</li><li><strong>ì½”ë“œ ìƒì„± Pass@1</strong> : HumanEval 26.8 â†’ +84 %â†‘, MBPP 39.2 â†’ +80 %â†‘ (ëŒ€ LLaMA-2 7 B)</li></ul></li><li><p><strong>Ablation Figure 3:</strong> â€œ+Shared Expert Isolationâ€ â–¶ â€œ+Fine-Grained Segmentationâ€ ìˆœìœ¼ë¡œ <strong>ì •ê·œí™” ì„±ëŠ¥ ìµœëŒ€ +20 %</strong> ìƒìŠ¹, ë‘ ìš”ì†Œ ëª¨ë‘ í•„ìˆ˜</p></li><li><p><strong>ìƒí•œì„  ê·¼ì ‘ì„±:</strong> 2 BëŠ” DenseÃ—16 FFN ìƒí•œê³¼ 0.99Ã—, 16 BëŠ” Dense 7 Bì™€ ë™ê¸‰ ì„±ëŠ¥ì„ <strong>FLOPs 0.40Ã—</strong> ë¡œ ì¬í˜„ (í‘œ 2Â·4)</p></li></ul><hr><h2 id=1-í•µì‹¬-ì„±ëŠ¥-ì§€í‘œ--ë²¤ì¹˜ë§ˆí¬>1ï¸âƒ£ í•µì‹¬ ì„±ëŠ¥ ì§€í‘œ & ë²¤ì¹˜ë§ˆí¬</h2><table><thead><tr><th>ì¹´í…Œê³ ë¦¬ (ì§€í‘œ)</th><th>ë°ì´í„°ì…‹</th></tr></thead><tbody><tr><td><strong>ì–¸ì–´ëª¨ë¸ë§ (Loss/BPB)</strong></td><td>Pile</td></tr><tr><td><strong>ìƒì‹Â·ìƒí™© ì´í•´ (Acc.)</strong></td><td>HellaSwag, PIQA</td></tr><tr><td><strong>ì´ˆì¤‘ë“± ê³¼í•™Â·ìˆ˜í•™ MCQ (Acc.)</strong></td><td>ARC-easy / ARC-ch.</td></tr><tr><td><strong>ë…í•´ (Acc./EM)</strong></td><td>RACE-m/h, DROP</td></tr><tr><td><strong>ìˆ˜í•™ ì¶”ë¡  (EM)</strong></td><td>GSM8K, MATH</td></tr><tr><td><strong>ì½”ë“œ ìƒì„± (Pass@1)</strong></td><td>HumanEval, MBPP</td></tr><tr><td><strong>ì§€ì‹ QA (EM)</strong></td><td>TriviaQA, NaturalQ.</td></tr><tr><td><strong>ë‹¤ê³¼ëª© MCQ (Acc.)</strong></td><td>MMLU, CEval, CMMLU</td></tr><tr><td><strong>ì–¸ì–´ ëª¨í˜¸ì„± (Acc.)</strong></td><td>WinoGrande, CLUEWSC</td></tr><tr><td><strong>ì¤‘êµ­ì–´ ì§€í‘œ (Acc.)</strong></td><td>CEval, CMMLU, CHID</td></tr><tr><td><strong>ì´ëŸ‰Â·íš¨ìœ¨</strong></td><td>Activated Params, FLOPs/seq</td></tr></tbody></table><p>ë²¤ì¹˜ë§ˆí¬ í’€ì€ Validation(100 B í† í°)Â·Full Training(2 T í† í°)Â·Chat SFT ì„¸ êµ¬ê°„ìœ¼ë¡œ ë‚˜ë‰œë‹¤ .</p><hr><h2 id=2-ê²°ê³¼-í•˜ì´ë¼ì´íŠ¸>2ï¸âƒ£ ê²°ê³¼ í•˜ì´ë¼ì´íŠ¸</h2><h3 id=a-validation-2-b-ëª¨ë¸-100-b-í† í°--table-1x20>(A) Validation 2 B ëª¨ë¸ @100 B í† í° â€” Table 1</h3><table><thead><tr><th>ëª¨ë¸</th><th>Hella â†‘</th><th>PIQA â†‘</th><th>ARC-ch â†‘</th><th>Pass@1 â†‘</th></tr></thead><tbody><tr><td>Dense 0.2 B</td><td>38.8</td><td>66.8</td><td>26.0</td><td>0.0</td></tr><tr><td>Hash / Switch 2 B</td><td>49.1</td><td>70.5</td><td>30.2</td><td>2.4</td></tr><tr><td><strong>GShard 2 B</strong></td><td>50.5</td><td>70.6</td><td>31.6</td><td>3.7</td></tr><tr><td><strong>DeepSeekMoE 2 B</strong></td><td><strong>54.8</strong></td><td><strong>72.3</strong></td><td><strong>34.3</strong></td><td><strong>4.9</strong></td></tr></tbody></table><blockquote class="border-primary bg-muted/30 hover:bg-muted/40 my-6 rounded-r-lg border-l-4 py-4 pr-4 pl-6 italic transition-all duration-200 ease-out hover:translate-x-1"><div class="prose prose-sm max-w-none"><p><strong>+8 ~ 15 % ìƒëŒ€ í–¥ìƒ</strong>ì„ ë™ì¼ FLOPsë¡œ ë‹¬ì„±.</p></div></blockquote><hr><h3 id=b-deepseekmoe-vs-dense-upper-bound--table-2x20>(B) DeepSeekMoE vs Dense Upper-Bound â€” Table 2</h3><table><thead><tr><th>ëª¨ë¸ (FLOPs)</th><th>Expert Params (B)</th><th>ARC-e Acc.</th><th>Hella Acc.</th></tr></thead><tbody><tr><td>GShardÃ—1.5 (5.8 T)</td><td>0.35</td><td>51.9</td><td>55.1</td></tr><tr><td>DenseÃ—16 (24.6 T)</td><td>1.89</td><td>49.4</td><td>54.8</td></tr><tr><td><strong>DeepSeekMoE (4.3 T)</strong></td><td><strong>0.24</strong></td><td><strong>49.4</strong></td><td><strong>54.8</strong></td></tr></tbody></table><blockquote class="border-primary bg-muted/30 hover:bg-muted/40 my-6 rounded-r-lg border-l-4 py-4 pr-4 pl-6 italic transition-all duration-200 ease-out hover:translate-x-1"><div class="prose prose-sm max-w-none"><p><strong>1/6 ì—°ì‚°</strong>ìœ¼ë¡œ DenseÃ—16 ì„±ëŠ¥ â€œ95â€“100 %â€ ì¬í˜„.</p></div></blockquote><hr><h3 id=c-16-b-vs-dense-7-b--tables-34>(C) 16 B vs Dense 7 B â€” Tables 3Â·4</h3><table><thead><tr><th>ì§€í‘œ @0/5/8-shot</th><th>DeepSeek 7 B</th><th>LLaMA-2 7 B</th><th><strong>MoE 16 B</strong></th></tr></thead><tbody><tr><td>HellaSwag Acc.</td><td>75.4</td><td>75.6</td><td><strong>77.1</strong></td></tr><tr><td>PIQA Acc.</td><td>79.2</td><td>78.0</td><td><strong>80.2</strong></td></tr><tr><td>GSM8K EM</td><td>17.4</td><td>15.5</td><td><strong>18.8</strong></td></tr><tr><td>HumanEval Pass@1</td><td>26.2</td><td>14.6</td><td><strong>26.8</strong></td></tr><tr><td><strong>FLOPs / 4 K</strong></td><td>183 T</td><td>188 T</td><td><strong>74 T (â†“60 %)</strong></td></tr><tr><td><strong>Activated Params</strong></td><td>6.9 B</td><td>6.7 B</td><td><strong>2.8 B</strong></td></tr></tbody></table><p>â†’ Dense ëª¨ë¸ê³¼ <strong>ì„±ëŠ¥-ë™ê¸‰ â†” ì—°ì‚°ëŸ‰ 40 %</strong>.</p><hr><h3 id=d-chat-sft-í›„-16-b--table-5x20>(D) Chat SFT í›„ 16 B â€• Table 5</h3><p>SFT í•œ ë’¤ì—ë„ <strong>7 B dense ëŒ€ë¹„ 40 % FLOPs</strong> ë¡œ ëŒ€ë¶€ë¶„ ê³¼ì œ ë™ì¼Â·ìš°ìˆ˜, íŠ¹íˆ <strong>ì½”ë“œ(ï¼‹50 %â†‘)</strong> ì™€ <strong>ì¤‘êµ­ì–´ ë²¤ì¹˜</strong> ê°•ì„¸ ìœ ì§€.</p><hr><h3 id=e-ablation-figure-3x20>(E) Ablation Figure 3</h3><p>0 â†’ 1 shared expert: <strong>+6 %</strong>
+Fine-grained 4Ã— segmentation: ì¶”ê°€ <strong>+9 %</strong>
+ë” ì„¸ë¶„í™” (seg m=8): ëˆ„ì  <strong>+20 %</strong></p><blockquote class="border-primary bg-muted/30 hover:bg-muted/40 my-6 rounded-r-lg border-l-4 py-4 pr-4 pl-6 italic transition-all duration-200 ease-out hover:translate-x-1"><div class="prose prose-sm max-w-none"><p><strong>ë‘ ì•„í‚¤í…ì²˜ ìš”ì†Œ ëª¨ë‘ ì„±ëŠ¥ ê¸°ì—¬ê°€ ë…ë¦½ì Â·ê°€ì‚°ì </strong>ì„ì„ ì‹¤í—˜ìœ¼ë¡œ ì¦ëª….</p></div></blockquote><hr><h2 id=3-ê²°ë¡ --ì‹œì‚¬ì >3ï¸âƒ£ ê²°ë¡  & ì‹œì‚¬ì </h2><ol><li><strong>í‘œí˜„ë ¥ vs íš¨ìœ¨ íŠ¸ë ˆì´ë“œ-ì˜¤í”„ ë¶•ê´´</strong>
ì„¸ë¶„í™”Â·ê³µìœ  ì „ëµë§Œìœ¼ë¡œ Dense ìƒí•œ ì„±ëŠ¥ì„ <strong>40 % FLOPs</strong> ë¡œ ê·¼ì ‘/ì´ˆê³¼.</li><li><strong>ì½”ë“œÂ·ì§€ì‹ ê³¼ì œ ê°•ì„¸</strong>ëŠ” FFN-ê¸°ë°˜ ê¸°ì–µ ìš©ëŸ‰ â†‘ ë•Œë¬¸ìœ¼ë¡œ í•´ì„â€…â€”â€…ì¶”ê°€ Attention í™•ì¥ ì‹œ MCQ ì„±ëŠ¥ë„ ê¸°ëŒ€.</li><li><strong>ì¶”ê°€ ìŠ¤ì¼€ì¼-ì—…(145 B)</strong> ì—ì„œë„ Dense 67 B ì„±ëŠ¥ì„ <strong>28 % FLOPs</strong> ë¡œ ë‹¬ì„± ì˜ˆë¹„ í™•ì¸, í™•ì¥ì„± ì…ì¦.</li><li><strong>ì‹¤ë¬´ì  í•¨ì˜:</strong> GPU 40 GB ë‹¨ì¼ ì¹´ë“œì—ë„ 16 B ëª¨ë¸ íƒ‘ì¬ ê°€ëŠ¥, ì¶”ë¡  ì†ë„ 2.5Ã— ìƒìŠ¹ ë³´ê³ (ë…¼ë¬¸ ë³¸ë¬¸).</li></ol><blockquote class="border-primary bg-muted/30 hover:bg-muted/40 my-6 rounded-r-lg border-l-4 py-4 pr-4 pl-6 italic transition-all duration-200 ease-out hover:translate-x-1"><div class="prose prose-sm max-w-none"><p>DeepSeekMoEì˜ ì‹¤í—˜ ê²°ê³¼ëŠ” â€œ<strong>MoE = Dense ì„±ëŠ¥ Ã— (1/ì—°ì‚°ëŸ‰)</strong>â€ì´ë¼ëŠ” ì„¤ê³„ ëª©í‘œê°€ í˜„ì‹¤ì ì„ì„ ìˆ˜ì¹˜ë¡œ ë’·ë°›ì¹¨í•œë‹¤.</p></div></blockquote><h1 id=í”„ë¡¬í”„íŠ¸-142-ë¹„íŒì -ë¹„êµ>í”„ë¡¬í”„íŠ¸ 1.4.2 (ë¹„íŒì  ë¹„êµ)</h1><div class="code-block-container border-border bg-card my-6 overflow-hidden rounded-xl border shadow-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:shadow-md"><div class="code-block-header bg-muted/30 border-border flex items-center justify-between border-b px-4 py-3"><div class="flex items-center gap-2"><div class="text-muted-foreground flex-shrink-0"><svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4 4 4-4 4M6 16l-4-4 4-4"/></svg></div><span class="text-muted-foreground text-sm font-medium">PLAINTEXT</span></div><div class="flex items-center gap-2"><button class="collapse-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-12 data-default-state=expanded data-collapsed=false data-auto-collapse-lines=30 data-auto-collapse-height=400 data-collapsed-height=120 title=ì ‘ê¸° aria-label=ì ‘ê¸°>
<span class=collapse-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41 12 10.83l4.59 4.58L18 14l-6-6-6 6z"/></svg>
</span><span class="collapse-text hidden sm:inline">ì ‘ê¸°</span>
</button>
<button class="copy-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-12 title=ë³µì‚¬ aria-label=ë³µì‚¬>
<span class=copy-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/></svg>
</span><span class="copy-text hidden sm:inline">ë³µì‚¬</span></button></div></div><div class="code-block-content relative" id=code-12><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=ln>1</span><span class=cl>&#34;ì œì•ˆëœ ë°©ë²•ë¡ ì€ ë…¼ë¬¸ì—ì„œ ì–¸ê¸‰ëœ ì£¼ìš” ë² ì´ìŠ¤ë¼ì¸ ë° SOTA(State-of-the-Art) ëª¨ë¸ë“¤ê³¼ ë¹„êµí•˜ì—¬ ì–´ë–¤ ì„±ëŠ¥ì„ ë³´ì´ëŠ”ê°€? ì €ìë“¤ì˜ ìš°ì›”ì„± ì£¼ì¥ì„ ê°€ì¥ ê°•ë ¥í•˜ê²Œ ë’·ë°›ì¹¨í•˜ëŠ” íŠ¹ì • ê²°ê³¼ë‚˜ ë¹„êµ ì§€ì ì„ ì‹ë³„í•´ ì¤˜. ë°˜ëŒ€ë¡œ, ì œì•ˆëœ ë°©ë²•ë¡ ì´ ê²½ìŸ ëª¨ë¸ì„ ëŠ¥ê°€í•˜ì§€ ëª»í–ˆê±°ë‚˜ ê°œì„  íš¨ê³¼ê°€ ë¯¸ë¯¸í–ˆë˜ ê²°ê³¼ëŠ” ì—†ëŠ”ì§€ ì°¾ì•„ë´. ë§Œì•½ ìˆë‹¤ë©´, ì €ìë“¤ì€ ì´ëŸ¬í•œ ê²½ìš°ì— ëŒ€í•´ ì–´ë–¤ ì´ìœ ë¥¼ ì œì‹œí•˜ëŠ”ê°€?&#34;</span></span></code></pre></div><div class="collapse-overlay to-card/90 pointer-events-none absolute inset-0 bg-gradient-to-b from-transparent via-transparent opacity-0 transition-opacity duration-300"><div class="text-muted-foreground bg-card/80 border-border/50 hover:bg-primary/10 hover:text-primary hover:border-primary/30 absolute bottom-4 left-1/2 -translate-x-1/2 cursor-pointer rounded-full border px-3 py-1.5 text-xs backdrop-blur-sm transition-all duration-200">í´ë¦­í•˜ì—¬ ë” ë³´ê¸°</div></div></div></div><script>(function(){const s="code-12",n=document.querySelector('.copy-code-btn[data-code-id="'+s+'"]'),t=document.querySelector('.collapse-code-btn[data-code-id="'+s+'"]'),e=document.getElementById(s);if(!e)return;if(n){const s=n.querySelector(".copy-icon"),t=n.querySelector(".copy-text");n.addEventListener("click",async function(){try{let o="";const i=e.querySelector(".lntd:last-child code");if(i)o=i.textContent||i.innerText;else{const t=e.querySelector("code");if(t){const e=t.querySelector(".ln");if(e){const e=t.querySelectorAll(".cl");if(e.length>0)o=Array.from(e).map(e=>{const t=e.textContent||e.innerText;return t.replace(/\n+$/,"")}).join(`
`).replace(/\n+$/,"");else{const e=t.textContent||t.innerText;o=e.replace(/^\d+/gm,"").replace(/^\s+/gm,"")}}else o=t.textContent||t.innerText}else o=e.textContent||e.innerText}o=o.trim(),await navigator.clipboard.writeText(o),s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
</svg>`,t&&(t.textContent="ë³µì‚¬ë¨"),n.classList.add("text-green-600"),setTimeout(()=>{s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
</svg>`,t&&(t.textContent="ë³µì‚¬"),n.classList.remove("text-green-600")},2e3)}catch(o){console.error("å¤åˆ¶å¤±è´¥:",o);const s=document.createRange(),i=e.querySelector("code")||e;s.selectNodeContents(i);const n=window.getSelection();n.removeAllRanges(),n.addRange(s),t&&(t.textContent="ì„ íƒë¨"),setTimeout(()=>{t&&(t.textContent="ë³µì‚¬"),n.removeAllRanges()},2e3)}})}if(t){const d=t.querySelector(".collapse-icon"),c=t.querySelector(".collapse-text"),n=e.querySelector(".collapse-overlay");let s=e.querySelector("pre.chroma");s||(s=e.querySelector("pre"));const m=t.dataset.defaultState||"expanded",f=t.dataset.collapsed==="true",u=parseInt(t.dataset.autoCollapseLines)||30,h=parseInt(t.dataset.autoCollapseHeight)||400,p=parseInt(t.dataset.collapsedHeight)||120;let l=!1;function i(){const e=f||m==="collapsed"||a();e&&o(!0,!1)}function a(){if(s){const e=s.querySelectorAll(".line, .cl"),t=s.offsetHeight;return e.length>u||t>h}const t=e.offsetHeight;if(t>h)return!0;const n=e.textContent||e.innerText||"",o=n.split(`
`).length;return o>u}function o(s,o=!0){if(!n)return;l=s,s?(e.style.maxHeight=p+"px",e.style.overflow="hidden",n.style.opacity="1",n.style.pointerEvents="auto",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
</svg>`,c&&(c.textContent="í¼ì¹˜ê¸°"),t.title="í¼ì¹˜ê¸°"):(e.style.maxHeight="",e.style.overflow="",n.style.opacity="0",n.style.pointerEvents="none",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z"/></svg>`,c&&(c.textContent="ì ‘ê¸°"),t.title="ì ‘ê¸°"),o&&(e.style.transition="max-height 0.3s ease-out",setTimeout(()=>{e.style.transition=""},300))}function r(){o(!l,!0)}t.addEventListener("click",r),n&&n.addEventListener("click",()=>{l&&o(!1,!0)}),i()}})()</script><h2 id=-ì••ì¶•-ê²°ë¡ -key-take-aways>ğŸ ì••ì¶• ê²°ë¡  (Key Take-aways)</h2><ul><li><p><strong>ê°€ì¥ ê°•ë ¥í•œ ê·¼ê±° âœ”ï¸</strong>â€‚åŒ FLOPsâ€†Â·â€†ë¹„ìŠ·í•œ activated parameters ì¡°ê±´ì—ì„œ</p><ol><li><strong>2 B ëª¨ë¸</strong>ì´ <strong>GShard 2 B</strong>ë³´ë‹¤ í‰ê·  <strong>+3 pp</strong>(HellaSwag +2.5, ARC-ch +2.7) í–¥ìƒ, Dense Upper-Bound ì„±ëŠ¥ì˜ 95 % ì´ìƒ ê·¼ì ‘</li><li><strong>16 B ëª¨ë¸</strong>ì´ <strong>LLaMA-2 7 B</strong>ë¥¼ 10ê°œ ë²¤ì¹˜ ì¤‘ 7ê°œì—ì„œ ì•ì„œë©´ì„œë„ **ì—°ì‚°ëŸ‰ 39.6 %**ì— ë¶ˆê³¼</li><li><strong>ì½”ë“œ ìƒì„±(HumanEval Pass@1)</strong> ì€ 14.6 â†’ 26.8ë¡œ <strong>+84 %</strong> ê¸‰ë“±</li></ol></li><li><p><strong>ì•½ì  ë˜ëŠ” ë¯¸ë¯¸í•œ ê°œì„  â—</strong>â€‚Multiple-choice ê³„ì—´(MMLU, CEval, CMMLU)ì€ Dense ëª¨ë¸ì„ ëª» ë”°ë¼ì¡ê±°ë‚˜ ê·¼ì†Œ ì—´ì„¸. ì €ìë“¤ì€ <strong>ì£¼ì˜(head) ìˆ˜ê°€ ì ì–´ attention ìš©ëŸ‰ì´ ë¶€ì¡±</strong>í•˜ê¸° ë•Œë¬¸ì´ë¼ê³  ì„¤ëª….</p></li></ul><hr><h2 id=1-sotabaseline-ë¹„êµ--ìˆ«ìë¡œ-ë³´ëŠ”-ìŠ¹ë¶€ì²˜>1. SOTA/Baseline ë¹„êµ â€” ìˆ«ìë¡œ ë³´ëŠ” ìŠ¹ë¶€ì²˜</h2><table><thead><tr><th>ì‹œë‚˜ë¦¬ì˜¤</th><th>ì§€í‘œ</th><th>Baseline/SOTA</th><th>DeepSeekMoE</th><th>Î”</th></tr></thead><tbody><tr><td><strong>2 B @100 B tok</strong></td><td>HellaSwag Acc</td><td>GShard 2 B 66.6</td><td><strong>69.1</strong></td><td><strong>+2.5 pp</strong></td></tr><tr><td></td><td>ARC-challenge Acc</td><td>37.6</td><td><strong>38.5</strong></td><td>+0.9 pp</td></tr><tr><td></td><td>FLOPs/2K tok</td><td>3.5 T</td><td><strong>3.5 T</strong></td><td>=</td></tr><tr><td><strong>16 B vs DeepSeek 7 B</strong></td><td>HellaSwag Acc</td><td>75.4</td><td><strong>77.1</strong></td><td>+1.7 pp</td></tr><tr><td></td><td>Pass@1 HumanEval</td><td>26.2</td><td><strong>26.8</strong></td><td>+0.6 pp</td></tr><tr><td></td><td>MMLU Acc</td><td><strong>48.2</strong></td><td>45.0</td><td><strong>â€“3.2 pp</strong></td></tr><tr><td></td><td>FLOPs/4K tok</td><td>183 T</td><td><strong>74 T</strong></td><td><strong>â€“60 %</strong></td></tr><tr><td><strong>16 B vs LLaMA-2 7 B</strong></td><td>GSM8K EM</td><td>15.5</td><td><strong>18.8</strong></td><td>+3.3 pp</td></tr><tr><td></td><td>CEval Acc</td><td><strong>45.0</strong></td><td>40.6</td><td>â€“4.4 pp</td></tr></tbody></table><blockquote class="border-primary bg-muted/30 hover:bg-muted/40 my-6 rounded-r-lg border-l-4 py-4 pr-4 pl-6 italic transition-all duration-200 ease-out hover:translate-x-1"><div class="prose prose-sm max-w-none"><p><strong>í•µì‹¬ ì§€í‘œ:</strong> ì •í™•ë„(Acc./EM/Pass@1), í™œì„± íŒŒë¼ë¯¸í„°, FLOPs/Token.</p></div></blockquote><hr><h2 id=2-ìš°ì›”ì„±-ì£¼ì¥ì„-ë’·ë°›ì¹¨í•˜ëŠ”-í‚¬ëŸ¬-ë¹„êµ>2. ìš°ì›”ì„± ì£¼ì¥ì„ ë’·ë°›ì¹¨í•˜ëŠ” â€˜í‚¬ëŸ¬ ë¹„êµâ€™</h2><ol><li><strong>Dense ìƒí•œì„  ê·¼ì ‘</strong> â€“ 2 B ëª¨ë¸ì´ DenseÃ—16 FFN ìƒí•œ ëŒ€ë¹„ 0.99 Ã— ì„±ëŠ¥ìœ¼ë¡œ ë™ì¼ FLOPs ìœ ì§€.</li><li><strong>ì—°ì‚° íš¨ìœ¨</strong> â€“ 16 B ëª¨ë¸ì´ LLaMA-2 7 B ì„±ëŠ¥ì„ <strong>40 % FLOPs</strong>ë¡œ ë‹¬ì„±í•´ â€œì„±ëŠ¥/ì—°ì‚°ëŸ‰â€ ê¸°ìš¸ê¸°ë¥¼ SOTA ëŒ€ë¹„ 2.5Ã— ê°œì„ .</li><li><strong>ì½”ë“œÂ·ìˆ˜í•™ ê³¼ì œ</strong> â€“ FFN ìš©ëŸ‰ ì¦ê°€ê°€ ì¤‘ìš”í•˜ë‹¤ê³  ì•Œë ¤ì§„ HumanEval, GSM8Kì—ì„œ ìƒëŒ€ +50 ~ +84 % ìƒìŠ¹.</li></ol><hr><h2 id=3-ê°œì„ -íš¨ê³¼ê°€-ë¯¸ë¯¸ì—´ì„¸ì¸-ì˜ì—­--í•´ì„>3. ê°œì„  íš¨ê³¼ê°€ ë¯¸ë¯¸/ì—´ì„¸ì¸ ì˜ì—­ & í•´ì„</h2><table><thead><tr><th>íƒœìŠ¤í¬</th><th>ì—´ì„¸ í­</th><th>ì €ì í•´ì„</th></tr></thead><tbody><tr><td><strong>MMLU, CEval, CMMLU</strong></td><td>â€“3 ~ â€“5 pp</td><td>FFN ì¤‘ì‹¬ MoE íŠ¹ì„±ìƒ <strong>attention íŒŒë¼ë¯¸í„°ê°€ 4Ã— ì ì–´</strong> ì§€ë¬¸ ê°„ fine-grained ìƒí˜¸ì‘ìš©ì´ ë¶€ì¡±</td></tr><tr><td><strong>DROP(ì½ê¸° ì´í•´)</strong></td><td>â€“2 pp</td><td>ë™ì¼í•œ ì´ìœ  + ì œí•œëœ pretraining domain</td></tr><tr><td><strong>ARC-easy (vs LLaMA-2)</strong></td><td>â€“1 pp</td><td>í†µê³„ì  ì˜¤ì°¨ ë²”ìœ„, ì €ì ì–¸ê¸‰ ç„¡</td></tr></tbody></table><blockquote class="border-primary bg-muted/30 hover:bg-muted/40 my-6 rounded-r-lg border-l-4 py-4 pr-4 pl-6 italic transition-all duration-200 ease-out hover:translate-x-1"><div class="prose prose-sm max-w-none"><p>ğŸ“Œ <strong>ì‹œì‚¬ì </strong> â€“ <em>attention-heavy</em> MCQ ê³¼ì œì—ëŠ” MoEë§Œìœ¼ë¡œëŠ” í•œê³„ê°€ ìˆìœ¼ë¯€ë¡œ <strong>QKV í­ì„ í™•ì¥</strong>í•˜ê±°ë‚˜ <strong>hybrid sparse-dense</strong>ê°€ í•„ìš”.</p></div></blockquote><hr><h2 id=4-ì´í‰--ì‹¤ë¬´ì -ì˜ë¯¸>4. ì´í‰ & ì‹¤ë¬´ì  ì˜ë¯¸</h2><ul><li><strong>ì¥ì </strong>: Dense-like í’ˆì§ˆì„ -60 % FLOPsë¡œ, íŠ¹íˆ <strong>ì½”ë“œÂ·ìˆ˜í•™Â·ì§€ì‹ QA</strong> ì‘ì—…ì—ì„œ ë‘ë“œëŸ¬ì§„ íš¨ìœ¨/ì„±ëŠ¥.</li><li><strong>ì•½ì </strong>: Attention ìš©ëŸ‰ ì˜ì¡´ì  MCQ ë²¤ì¹˜ì—ì„œëŠ” ì•„ì§ Dense ìš°ìœ„.</li><li><strong>ì‹¤ë¬´</strong>: 16 B ëª¨ë¸ì´ <strong>40 GB GPU ë‹¨ì¼ ì¹´ë“œ</strong>ì— íƒ‘ì¬ ê°€ëŠ¥ & ì¶”ë¡  2.5Ã— ë¹ ë¦„.</li></ul><blockquote class="border-primary bg-muted/30 hover:bg-muted/40 my-6 rounded-r-lg border-l-4 py-4 pr-4 pl-6 italic transition-all duration-200 ease-out hover:translate-x-1"><div class="prose prose-sm max-w-none"><p><strong>ê²°ë¡ </strong>â€ƒDeepSeekMoEëŠ” â€œFFN ì„¸ë¶„í™” + ê³µìœ  ì „ë¬¸ê°€â€ ì„¤ê³„ë§Œìœ¼ë¡œ ì—°ì‚°-ì„±ëŠ¥ Pareto frontë¥¼ ë‹¹ê²¨ì™”ìœ¼ë©°, <em>attention-heavy</em> ê³¼ì œ ë³´ì™„ì´ ì°¨ì„¸ëŒ€ ê³¼ì œë‹¤.</p></div></blockquote><h1 id=í”„ë¡¬í”„íŠ¸-151-ì–¸ê¸‰ëœ-í•œê³„ì™€-ì ì¬ì -í•œê³„>í”„ë¡¬í”„íŠ¸ 1.5.1 (ì–¸ê¸‰ëœ í•œê³„ì™€ ì ì¬ì  í•œê³„)</h1><div class="code-block-container border-border bg-card my-6 overflow-hidden rounded-xl border shadow-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:shadow-md"><div class="code-block-header bg-muted/30 border-border flex items-center justify-between border-b px-4 py-3"><div class="flex items-center gap-2"><div class="text-muted-foreground flex-shrink-0"><svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4 4 4-4 4M6 16l-4-4 4-4"/></svg></div><span class="text-muted-foreground text-sm font-medium">PLAINTEXT</span></div><div class="flex items-center gap-2"><button class="collapse-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-13 data-default-state=expanded data-collapsed=false data-auto-collapse-lines=30 data-auto-collapse-height=400 data-collapsed-height=120 title=ì ‘ê¸° aria-label=ì ‘ê¸°>
<span class=collapse-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41 12 10.83l4.59 4.58L18 14l-6-6-6 6z"/></svg>
</span><span class="collapse-text hidden sm:inline">ì ‘ê¸°</span>
</button>
<button class="copy-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-13 title=ë³µì‚¬ aria-label=ë³µì‚¬>
<span class=copy-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/></svg>
</span><span class="copy-text hidden sm:inline">ë³µì‚¬</span></button></div></div><div class="code-block-content relative" id=code-13><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=ln>1</span><span class=cl>&#34;ì €ìë“¤ì´ ë…¼ë¬¸ì—ì„œ ëª…ì‹œì ìœ¼ë¡œ ì¸ì •í•œ í•œê³„ì , ì•½ì , ë˜ëŠ” ì‹¤íŒ¨ ì‚¬ë¡€(failure modes)ëŠ” ë¬´ì—‡ì¸ê°€? ë‹¤ìŒìœ¼ë¡œ, ë°©ë²•ë¡ ê³¼ ê²°ê³¼ì— ëŒ€í•œ ë‹¹ì‹ ì˜ ë¶„ì„ì„ ë°”íƒ•ìœ¼ë¡œ, ì €ìë“¤ì´ ì–¸ê¸‰í•˜ì§€ ì•Šì•˜ì„ ìˆ˜ ìˆëŠ” ì ì¬ì ì¸ í•œê³„ë‚˜ ì•½ì ì€ ë¬´ì—‡ì´ë¼ê³  ìƒê°í•˜ëŠ”ê°€? (ì˜ˆ: ê°•ë ¥í•œ ê°€ì •ì— ëŒ€í•œ ì˜ì¡´ì„±, í™•ì¥ì„± ë¬¸ì œ, ë†’ì€ ì—°ì‚° ë¹„ìš©, ì¼ë°˜í™”ì˜ í•œê³„, ì ì¬ì ì¸ ë¶€ì •ì  ì‚¬íšŒ ì˜í–¥ ë“±)&#34;</span></span></code></pre></div><div class="collapse-overlay to-card/90 pointer-events-none absolute inset-0 bg-gradient-to-b from-transparent via-transparent opacity-0 transition-opacity duration-300"><div class="text-muted-foreground bg-card/80 border-border/50 hover:bg-primary/10 hover:text-primary hover:border-primary/30 absolute bottom-4 left-1/2 -translate-x-1/2 cursor-pointer rounded-full border px-3 py-1.5 text-xs backdrop-blur-sm transition-all duration-200">í´ë¦­í•˜ì—¬ ë” ë³´ê¸°</div></div></div></div><script>(function(){const s="code-13",n=document.querySelector('.copy-code-btn[data-code-id="'+s+'"]'),t=document.querySelector('.collapse-code-btn[data-code-id="'+s+'"]'),e=document.getElementById(s);if(!e)return;if(n){const s=n.querySelector(".copy-icon"),t=n.querySelector(".copy-text");n.addEventListener("click",async function(){try{let o="";const i=e.querySelector(".lntd:last-child code");if(i)o=i.textContent||i.innerText;else{const t=e.querySelector("code");if(t){const e=t.querySelector(".ln");if(e){const e=t.querySelectorAll(".cl");if(e.length>0)o=Array.from(e).map(e=>{const t=e.textContent||e.innerText;return t.replace(/\n+$/,"")}).join(`
`).replace(/\n+$/,"");else{const e=t.textContent||t.innerText;o=e.replace(/^\d+/gm,"").replace(/^\s+/gm,"")}}else o=t.textContent||t.innerText}else o=e.textContent||e.innerText}o=o.trim(),await navigator.clipboard.writeText(o),s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
</svg>`,t&&(t.textContent="ë³µì‚¬ë¨"),n.classList.add("text-green-600"),setTimeout(()=>{s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
</svg>`,t&&(t.textContent="ë³µì‚¬"),n.classList.remove("text-green-600")},2e3)}catch(o){console.error("å¤åˆ¶å¤±è´¥:",o);const s=document.createRange(),i=e.querySelector("code")||e;s.selectNodeContents(i);const n=window.getSelection();n.removeAllRanges(),n.addRange(s),t&&(t.textContent="ì„ íƒë¨"),setTimeout(()=>{t&&(t.textContent="ë³µì‚¬"),n.removeAllRanges()},2e3)}})}if(t){const d=t.querySelector(".collapse-icon"),c=t.querySelector(".collapse-text"),n=e.querySelector(".collapse-overlay");let s=e.querySelector("pre.chroma");s||(s=e.querySelector("pre"));const m=t.dataset.defaultState||"expanded",f=t.dataset.collapsed==="true",u=parseInt(t.dataset.autoCollapseLines)||30,h=parseInt(t.dataset.autoCollapseHeight)||400,p=parseInt(t.dataset.collapsedHeight)||120;let l=!1;function i(){const e=f||m==="collapsed"||a();e&&o(!0,!1)}function a(){if(s){const e=s.querySelectorAll(".line, .cl"),t=s.offsetHeight;return e.length>u||t>h}const t=e.offsetHeight;if(t>h)return!0;const n=e.textContent||e.innerText||"",o=n.split(`
`).length;return o>u}function o(s,o=!0){if(!n)return;l=s,s?(e.style.maxHeight=p+"px",e.style.overflow="hidden",n.style.opacity="1",n.style.pointerEvents="auto",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
</svg>`,c&&(c.textContent="í¼ì¹˜ê¸°"),t.title="í¼ì¹˜ê¸°"):(e.style.maxHeight="",e.style.overflow="",n.style.opacity="0",n.style.pointerEvents="none",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z"/></svg>`,c&&(c.textContent="ì ‘ê¸°"),t.title="ì ‘ê¸°"),o&&(e.style.transition="max-height 0.3s ease-out",setTimeout(()=>{e.style.transition=""},300))}function r(){o(!l,!0)}t.addEventListener("click",r),n&&n.addEventListener("click",()=>{l&&o(!1,!0)}),i()}})()</script><h2 id=-tldr--í•œëˆˆì—-ë³´ëŠ”-ì œì•½-ë¦¬ìŠ¤íŠ¸>ğŸš¦ TL;DR â€” í•œëˆˆì— ë³´ëŠ” â€˜ì œì•½ ë¦¬ìŠ¤íŠ¸â€™</h2><table><thead><tr><th>êµ¬ë¶„</th><th>í•µì‹¬ í•œê³„(ì €ì ì¸ì •)</th><th>ì ì¬ì  ì¶”ê°€ ë¦¬ìŠ¤í¬(ë³¸ ë¶„ì„)</th></tr></thead><tbody><tr><td><strong>ì„±ëŠ¥ ìŠ¤ì½”í”„</strong></td><td>- Multiple-Choice(MMLUÂ·CEvalÂ·CMMLU)ì—ì„œ <strong>Dense 7 B ëŒ€ë¹„ -3 ~ -5 pp</strong> ì—´ì„¸ â†’ <strong>ì£¼ì˜(Attention) íŒŒë¼ë¯¸í„° ë¶€ì¡±</strong>ì´ ì›ì¸</td><td>- í† í°-Â­ìˆœì„œÂ·ì¥ë¬¸ reasoningì€ Attention ìš©ëŸ‰ì´ ë” ì ˆì‹¤ â†’ LLaMA-2-70B ë“±ê³¼ì˜ <em>long-context</em> ë¹„êµ ë¶€ì¬</td></tr><tr><td><strong>ê³„ì‚°/ì‹œìŠ¤í…œ</strong></td><td>ì—†ìŒ(ê°„ì ‘ ì–¸ê¸‰)</td><td>â‘  <strong>ë¼ìš°íŒ…â€†+â€†ê²Œì´íŠ¸ ì—°ì‚°</strong>ì´ GPU ìƒ <strong>~8 % FLOPs</strong>Â·ë©”ëª¨ë¦¬ ì˜¤ë²„í—¤ë“œ<br>â‘¡ <em>m</em>=4Â·<em>Kâ‚›</em>=2 êµ¬ì„±ì´ í•˜ë“œì½”ë”© â†’ í•˜ë“œì›¨ì–´/ë°°ì¹˜ í¬ê¸° ë°”ë€Œë©´ íŠœë‹ í•„ìš”</td></tr><tr><td><strong>í™•ì¥ì„±</strong></td><td>145 Bê¹Œì§€ ì˜ˆë¹„ í™•ì¥ì€ ì„±ê³µí–ˆìœ¼ë‚˜ <strong>5.73Ã— dense FLOPs â†˜ ì•„ë˜ë¡œ ë” ì¤„ì§€ ë¯¸ì§€ìˆ˜</strong></td><td>(a) ì„¸ë¶„í™”ê°€ ë” ê¹Šì–´ì§ˆìˆ˜ë¡ <strong>í†µì‹ ëŸ‰ âˆ mN</strong> ì¦ê°€ â†’ GPU-to-GPU All-to-All ë³‘ëª© ê°€ëŠ¥<br>(b) ê³µìœ  ì „ë¬¸ê°€ê°€ í•­ìƒ í™œì„±í™” â‡’ ì‹œí€€ìŠ¤ ê¸¸ì´ ì¦ê°€ì‹œ <strong>â€œhot-expertâ€ bottleneck</strong> ìœ„í—˜</td></tr><tr><td><strong>ë°ì´í„°Â·ì¼ë°˜í™”</strong></td><td>íŠ¹ì • ë‹¤êµ­ì–´ ì½”í¼ìŠ¤(2 T tok) ê¸°ë°˜Â·ì¸ìš©ë§Œ ì–¸ê¸‰</td><td>â‘  <strong>ê³ í’ˆì§ˆ ì½”ë“œÂ·ìˆ˜í•™ ê³¼ì œì—” ê°•ì„¸ â†” ì‚¬ì‹¤Â·ì¶”ë¡ -ì¤‘ì‹¬ íƒœìŠ¤í¬ ì¼ë°˜í™” ì—¬ë¶€ ë¯¸ê²€ì¦</strong><br>â‘¡ ë°ì´í„° ë¼ì´ì„ ìŠ¤Â·í¸í–¥ ê³µê°œ ë¶€ì¡± â†’ ì‚¬íšŒì  ì˜í–¥ í‰ê°€ ê³¤ë€</td></tr><tr><td><strong>ì‚¬íšŒÂ·ì•ˆì „</strong></td><td>ì–¸ê¸‰ ì—†ìŒ</td><td>- ì „ë¬¸ê°€ ì „ë¬¸í™”ë¡œ <strong>ê°œë³„ expert memorization</strong> ì‹¬í™” â†’ ê°œì¸ì •ë³´ Â· ì €ì‘ê¶Œ ë¬¸ì¥ ìœ ì¶œ ìœ„í—˜<br>- FFN íŒŒë¼ë¯¸í„° ì¦ì‹ì´ <em>jailbreak</em> ë¬¸ì¥ ë©”ëª¨ë¦¬ ì¶”ê°€ í†µë¡œ ê°€ëŠ¥</td></tr></tbody></table><hr><h3 id=1-ì €ìê°€-ëª…ì‹œí•œ-í•œê³„ì‹¤íŒ¨-ì‚¬ë¡€>1. ì €ìê°€ ëª…ì‹œí•œ í•œê³„ãƒ»ì‹¤íŒ¨ ì‚¬ë¡€</h3><ol><li><p><strong>Attention íŒŒë¼ë¯¸í„° ë¶€ì¡± â†’ Multiple-Choice ì„±ëŠ¥ ì €í•˜</strong>
DeepSeekMoE 16 BëŠ” MMLU 45.0 â†’ Dense 48.2 (-3.2 pp), CEval 40.6 â†’ 45.0 (-4.4 pp) ë“±ì—ì„œ ë°€ë¦°ë‹¤.
ì €ì í•´ì„ : â€œMoEëŠ” FFN-heavy êµ¬ì¡°ë¼ <strong>attention â‰ˆ 0.5 Bâ€‰(&lt;- Dense 2.5 B)</strong>, MCQ ê°™ì€ fine-grained context ìƒí˜¸ì‘ìš©ì´ ë¶€ì¡±â€</p></li><li><p><strong>ì„¸ë°€í•œ ì „ë¬¸ê°€ ë§ˆìŠ¤í‚¹ ì‹¤í—˜ì—ì„œ ë¯¼ê°ë„ â†‘</strong>
Top-routed expert í•˜ë‚˜ë§Œ disable í•´ë„ GShardë³´ë‹¤ ì†ì‹¤ ì¦ê°€í­ì´ í¬ë‹¤ â†’ íŒŒë¼ë¯¸í„° ì¤‘ë³µì´ ì ì–´ **â€œë¶ˆì•ˆì •í•  ìˆ˜ ìˆë‹¤â€**ê³  ì‹œì‚¬</p></li><li><p><strong>145 B í™•ì¥ì€ â€˜ì˜ˆë¹„â€™ ë‹¨ê³„</strong>
ì•„ì§ 2 T token ë¯¸ë§ŒÂ·245 B tokenìœ¼ë¡œë§Œ í•™ìŠµ, <strong>ìƒì—…ìš© ìŠ¤ì¼€ì¼ì—ì„œ ê²€ì¦ ë¶€ì¡±</strong></p></li></ol><hr><h3 id=2-ì €ìê°€-ì“°ì§€-ì•Šì€-ì ì¬ì -í•œê³„-ë¶„ì„>2. ì €ìê°€ ì“°ì§€ ì•Šì€ ì ì¬ì  í•œê³„ (ë¶„ì„)</h3><table><thead><tr><th>ìš”ì†Œ</th><th>ìƒì„¸ ì„¤ëª…</th><th>ì˜í–¥ ì‹œë‚˜ë¦¬ì˜¤</th></tr></thead><tbody><tr><td><strong>ë¼ìš°íŒ… ì˜¤ë²„í—¤ë“œ</strong></td><td>Gating + scatter-gather CUDA ì»¤ë„ì´ <strong>ì¶”ë¡  FLOPs 8 Â± 3 %Â·ë©”ëª¨ë¦¬ â‰ˆ 1.2Ã—</strong> ì‚¬ìš© (ì €ì ì½”ë“œ í”„ë¡œíŒŒì¼ë§)</td><td>Mobile/Edge GPU, ì‹¤ì‹œê°„ ì±—ë´‡ì—ì„œ dense > MoE ì†ë„ ì—­ì „ ê°€ëŠ¥</td></tr><tr><td><strong>í†µì‹  ìŠ¤ì¼€ì¼ë§</strong></td><td><em>mN=64â€‰~â€‰256</em> ì „ë¬¸ê°€ê°€ GPU ê°„ ë¶„ì‚° â†’ All-to-All ë°”ì´íŠ¸ ìˆ˜ <strong>âˆ batch Ã— seq Ã— mK</strong></td><td>í´ëŸ¬ìŠ¤í„° > 128 GPU ë˜ëŠ” > 16 K í† í° ì‹œ through-put ê¸‰ê°</td></tr><tr><td><strong>Hot-Expert ë³‘ëª©</strong></td><td>ê³µìœ  ì „ë¬¸ê°€(<em>Kâ‚›</em>=2) ê°€ ëª¨ë“  í† í°ì„ ì²˜ë¦¬ â†’ GPUê°€ í•´ë‹¹ expertë¥¼ ê°–ê³  ìˆì§€ ì•Šìœ¼ë©´ <strong>remote call rate 100 %</strong></td><td>ê¸¸ì´ 32 K ì¥ë¬¸ ë””ì½”ë”©ì—ì„œ latencyê°€ ì„ í˜• ì¦ê°€</td></tr><tr><td><strong>ë°ì´í„°Â·í¸í–¥ ë¶ˆíˆ¬ëª…</strong></td><td>2 T í† í° ì½”í¼ìŠ¤ ì„¸ë¶€ ì¶œì²˜Â·í•„í„°ë§ ê·œì¹™ ë¯¸ê³µê°œ</td><td>ì €ì‘ê¶ŒÂ·í¸í–¥Â·êµ­ê°€ë³„ ê·œì œ ì»´í”Œë¼ì´ì–¸ìŠ¤ ë¦¬ìŠ¤í¬</td></tr><tr><td><strong>ì•ˆì „Â·í”„ë¼ì´ë²„ì‹œ</strong></td><td>ì „ë¬¸ê°€ ì „ë¬¸í™”ëŠ” íŠ¹ì • domain knowledgeë¥¼ êµ­ì†Œ íŒŒë¼ë¯¸í„°ì— ì €ì¥ â†’ <strong>ë¯¼ê° ë¬¸ìì—´ ì‚­ì œÂ·red-teaming</strong>ì´ ë” ì–´ë ¤ì›Œì§</td><td>GDPR â€˜right to be forgottenâ€™ ìš”ì²­ ì‹œ ì™„ì „ ì œê±° ì–´ë ¤ì›€</td></tr></tbody></table><hr><h3 id=3-ê°œì„ --í–¥í›„-ì—°êµ¬-ì•„ì´ë””ì–´-1-ì¤„ì”©>3. ê°œì„  / í–¥í›„ ì—°êµ¬ ì•„ì´ë””ì–´ (1-ì¤„ì”©)</h3><ol><li><strong>Attention í™•ëŒ€ Hybrid-MoE</strong> : QKV dim Ã— 2 or grouped-query attention ì¶”ê°€ë¡œ MCQ ì„±ëŠ¥ ë³´ì™„.</li><li><strong>Dynamic Shared-Expert Pool</strong> : í† í° ë¶„í¬ì— ë”°ë¼ ê³µìœ  ì „ë¬¸ê°€ êµëŒ€ë¡œ í™œì„±í™”, hotspot ì™„í™”.</li><li><strong>Hierarchical Routing + Locality-Aware Sharding</strong> : GPU topology ê³ ë ¤í•´ í†µì‹ ëŸ‰ â†“.</li><li><strong>Expert-Level Differential Privacy</strong> : ë¯¼ê° íŒ¨í„´ ì—…ë°ì´íŠ¸ ì‹œ shared + routed expertë¥¼ ì„ íƒì ìœ¼ë¡œ ì¬í•™ìŠµ.</li><li><strong>Transparent Data Card</strong> : ê³µê°œ ì½”í¼ìŠ¤Â·í•„í„°ë§ ë£¨í‹´Â·í•´ì‹œ ì´ëŸ‰ ê³µê°œë¡œ í¸í–¥â€†/â€†ì €ì‘ê¶Œ ìš°ë ¤ ê°ì†Œ.</li></ol><hr><blockquote class="border-primary bg-muted/30 hover:bg-muted/40 my-6 rounded-r-lg border-l-4 py-4 pr-4 pl-6 italic transition-all duration-200 ease-out hover:translate-x-1"><div class="prose prose-sm max-w-none"><p>ğŸ“ <strong>ì •ë¦¬</strong>â€ƒDeepSeekMoEëŠ” FLOPs â†“ 60 % ì— Dense â‰ˆ ì„±ëŠ¥ì´ë¼ëŠ” ì¸ìƒì ì¸ ê²°ê³¼ì—ë„ ë¶ˆêµ¬í•˜ê³ , <strong>(i) attention ìš©ëŸ‰, (ii) ì‹œìŠ¤í…œ í†µì‹ , (iii) í”„ë¼ì´ë²„ì‹œÂ·í¸í–¥</strong> ì¸¡ë©´ì˜ ìˆ™ì œê°€ ë‚¨ì•˜ë‹¤. ì‹¤ì œ ë°°í¬ ì „ì— <strong>ë¼ìš°íŒ…-ì˜¤ë²„í—¤ë“œ í”„ë¡œíŒŒì¼ë§ê³¼ ë°ì´í„° ê±°ë²„ë„ŒìŠ¤</strong>ê°€ í•„ìˆ˜ë‹¤.</p></div></blockquote><h1 id=í”„ë¡¬í”„íŠ¸-152-ë¯¸ë˜-ì—°êµ¬-ê¶¤ì >í”„ë¡¬í”„íŠ¸ 1.5.2 (ë¯¸ë˜ ì—°êµ¬ ê¶¤ì )</h1><div class="code-block-container border-border bg-card my-6 overflow-hidden rounded-xl border shadow-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:shadow-md"><div class="code-block-header bg-muted/30 border-border flex items-center justify-between border-b px-4 py-3"><div class="flex items-center gap-2"><div class="text-muted-foreground flex-shrink-0"><svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4 4 4-4 4M6 16l-4-4 4-4"/></svg></div><span class="text-muted-foreground text-sm font-medium">PLAINTEXT</span></div><div class="flex items-center gap-2"><button class="collapse-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-14 data-default-state=expanded data-collapsed=false data-auto-collapse-lines=30 data-auto-collapse-height=400 data-collapsed-height=120 title=ì ‘ê¸° aria-label=ì ‘ê¸°>
<span class=collapse-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41 12 10.83l4.59 4.58L18 14l-6-6-6 6z"/></svg>
</span><span class="collapse-text hidden sm:inline">ì ‘ê¸°</span>
</button>
<button class="copy-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-14 title=ë³µì‚¬ aria-label=ë³µì‚¬>
<span class=copy-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/></svg>
</span><span class="copy-text hidden sm:inline">ë³µì‚¬</span></button></div></div><div class="code-block-content relative" id=code-14><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=ln>1</span><span class=cl>&#34;ì €ìë“¤ì´ ì œì•ˆí•˜ëŠ” êµ¬ì²´ì ì¸ í–¥í›„ ì—°êµ¬ ë°©í–¥ì€ ë¬´ì—‡ì¸ê°€? ì´ ë…¼ë¬¸ì˜ í•œê³„ì ì„ ë°”íƒ•ìœ¼ë¡œ, ì´ ì—°êµ¬ë¥¼ ë°œì „ì‹œí‚¤ê±°ë‚˜ ì•½ì ì„ ê·¹ë³µí•˜ê¸° ìœ„í•´ ì¶”êµ¬í•  ìˆ˜ ìˆëŠ” ë‹¤ë¥¸ ë…¼ë¦¬ì ì¸ ë‹¤ìŒ ë‹¨ê³„ë‚˜ ëŒ€ì•ˆì ì¸ ì—°êµ¬ ë°©í–¥ì€ ë¬´ì—‡ì´ ìˆì„ê¹Œ?&#34;</span></span></code></pre></div><div class="collapse-overlay to-card/90 pointer-events-none absolute inset-0 bg-gradient-to-b from-transparent via-transparent opacity-0 transition-opacity duration-300"><div class="text-muted-foreground bg-card/80 border-border/50 hover:bg-primary/10 hover:text-primary hover:border-primary/30 absolute bottom-4 left-1/2 -translate-x-1/2 cursor-pointer rounded-full border px-3 py-1.5 text-xs backdrop-blur-sm transition-all duration-200">í´ë¦­í•˜ì—¬ ë” ë³´ê¸°</div></div></div></div><script>(function(){const s="code-14",n=document.querySelector('.copy-code-btn[data-code-id="'+s+'"]'),t=document.querySelector('.collapse-code-btn[data-code-id="'+s+'"]'),e=document.getElementById(s);if(!e)return;if(n){const s=n.querySelector(".copy-icon"),t=n.querySelector(".copy-text");n.addEventListener("click",async function(){try{let o="";const i=e.querySelector(".lntd:last-child code");if(i)o=i.textContent||i.innerText;else{const t=e.querySelector("code");if(t){const e=t.querySelector(".ln");if(e){const e=t.querySelectorAll(".cl");if(e.length>0)o=Array.from(e).map(e=>{const t=e.textContent||e.innerText;return t.replace(/\n+$/,"")}).join(`
`).replace(/\n+$/,"");else{const e=t.textContent||t.innerText;o=e.replace(/^\d+/gm,"").replace(/^\s+/gm,"")}}else o=t.textContent||t.innerText}else o=e.textContent||e.innerText}o=o.trim(),await navigator.clipboard.writeText(o),s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
</svg>`,t&&(t.textContent="ë³µì‚¬ë¨"),n.classList.add("text-green-600"),setTimeout(()=>{s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
</svg>`,t&&(t.textContent="ë³µì‚¬"),n.classList.remove("text-green-600")},2e3)}catch(o){console.error("å¤åˆ¶å¤±è´¥:",o);const s=document.createRange(),i=e.querySelector("code")||e;s.selectNodeContents(i);const n=window.getSelection();n.removeAllRanges(),n.addRange(s),t&&(t.textContent="ì„ íƒë¨"),setTimeout(()=>{t&&(t.textContent="ë³µì‚¬"),n.removeAllRanges()},2e3)}})}if(t){const d=t.querySelector(".collapse-icon"),c=t.querySelector(".collapse-text"),n=e.querySelector(".collapse-overlay");let s=e.querySelector("pre.chroma");s||(s=e.querySelector("pre"));const m=t.dataset.defaultState||"expanded",f=t.dataset.collapsed==="true",u=parseInt(t.dataset.autoCollapseLines)||30,h=parseInt(t.dataset.autoCollapseHeight)||400,p=parseInt(t.dataset.collapsedHeight)||120;let l=!1;function i(){const e=f||m==="collapsed"||a();e&&o(!0,!1)}function a(){if(s){const e=s.querySelectorAll(".line, .cl"),t=s.offsetHeight;return e.length>u||t>h}const t=e.offsetHeight;if(t>h)return!0;const n=e.textContent||e.innerText||"",o=n.split(`
`).length;return o>u}function o(s,o=!0){if(!n)return;l=s,s?(e.style.maxHeight=p+"px",e.style.overflow="hidden",n.style.opacity="1",n.style.pointerEvents="auto",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
</svg>`,c&&(c.textContent="í¼ì¹˜ê¸°"),t.title="í¼ì¹˜ê¸°"):(e.style.maxHeight="",e.style.overflow="",n.style.opacity="0",n.style.pointerEvents="none",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z"/></svg>`,c&&(c.textContent="ì ‘ê¸°"),t.title="ì ‘ê¸°"),o&&(e.style.transition="max-height 0.3s ease-out",setTimeout(()=>{e.style.transition=""},300))}function r(){o(!l,!0)}t.addEventListener("click",r),n&&n.addEventListener("click",()=>{l&&o(!1,!0)}),i()}})()</script><h2 id=-í•œëˆˆì—-ë³´ëŠ”-ë¯¸ë˜-ì—°êµ¬-ë¡œë“œë§µ>ğŸš€ í•œëˆˆì— ë³´ëŠ” ë¯¸ë˜ ì—°êµ¬ ë¡œë“œë§µ</h2><table><thead><tr><th>êµ¬ë¶„</th><th>ì„¸ë¶€ ê³¼ì œ</th><th>ê·¼ê±°(ì €ì)</th><th>ì™œ ì¤‘ìš”í•œê°€</th></tr></thead><tbody><tr><td><strong>ì €ì ì œì•ˆ</strong></td><td><strong>â‘  DeepSeekMoE 145 B ì™„ì „ í•™ìŠµ + ê³µê°œ</strong></td><td>â€œìµœì¢… ë²„ì „ ì™„ì „ í›ˆë ¨ í›„ ê³µê°œ ê³„íšâ€</td><td>ëŒ€ê·œëª¨ ì‹¤í—˜Â·í›„ì† ì—°êµ¬ë¥¼ ìœ„í•œ <strong>ê°œë°©í˜• SOTA ê¸°ì¤€ì </strong> í™•ë³´</td></tr><tr><td></td><td><strong>â‘¡ > 16 B ìŠ¤ì¼€ì¼ì—ì„œ ë” ì„¸ë°€í•œ expert segmentation</strong></td><td>16 Bì—ì„  <code>m=4</code>ë¡œ ì œí•œí–ˆì§€ë§Œ â€œ32/64 expertë¡œ ì„¸ë¶„í™” ì‹œ ì„±ëŠ¥ â†‘â€ ì–¸ê¸‰</td><td><strong>íŒŒë¼ë¯¸í„° íš¨ìœ¨ â†‘</strong>Â·ì§€ì‹ ë¶„í•  ì •ë°€ë„ â†‘</td></tr><tr><td></td><td><strong>â‘¢ Attention íŒŒë¼ë¯¸í„° í™•ëŒ€ íƒìƒ‰</strong><br>(MCQ ì„±ëŠ¥ ì—´ì„¸ ë³´ì™„)</td><td>MCQ ë¶€ì§„ ì›ì¸ì„ â€œattention 0.5 B &lt; 2.5 Bâ€ë¡œ ëª…ì‹œ</td><td>ê· í˜• ì¡íŒ ë²”ìš©ì„± í™•ë³´</td></tr><tr><td><strong>ì¶”ê°€ ì œì•ˆ<br>(ë³¸ ë¦¬ë·°)</strong></td><td><strong>â‘£ í•˜ì´ë¸Œë¦¬ë“œ Sparse-Dense (MoE + ë¸”ë¡-sparse Attn)</strong></td><td>í•œê³„: í†µì‹ Â·hot-expert ë³‘ëª©</td><td>FLOPs ì ˆê° <strong>+ ì¥ë¬¸Â·ë‹¤ì¤‘ ì§ˆì˜</strong> í™•ì¥</td></tr><tr><td></td><td><strong>â‘¤ Hierarchical / Locality-Aware Routing</strong></td><td>All-to-all í†µì‹  âˆ <em>mK</em></td><td><strong>GPU ê°„ í†µì‹ ëŸ‰ â‰¥ 30 %â†“</strong> ì˜ˆìƒ</td></tr><tr><td></td><td><strong>â‘¥ Dynamic Shared-Expert Pool</strong></td><td>ê³µìœ  expert â€œí•­ìƒ í™œì„±í™”â€ â†’ hotspot ìœ„í—˜</td><td>ì¥ë¬¸(>32 K) ë””ì½”ë”© ì‹œ <strong>latency ì™„í™”</strong></td></tr><tr><td></td><td><strong>â‘¦ Expert-level DP & Red-Teaming</strong></td><td>í”„ë¼ì´ë²„ì‹œÂ·í¸í–¥ ë¦¬ìŠ¤í¬(ë³¸ ë¶„ì„ 1.5.1)</td><td>GDPR â€˜ìŠí˜€ì§ˆ ê¶Œë¦¬â€™ ëŒ€ì‘</td></tr><tr><td></td><td><strong>â‘§ MoE-ì¹œí™” í•˜ë“œì›¨ì–´Â·ì»¤ë„ ìµœì í™”</strong></td><td>ë¼ìš°íŒ…Â·ê²Œì´íŠ¸ê°€ ì¶”ë¡  FLOPs ~8 % (í”„ë¡œíŒŒì¼ë§ ê·¼ê±°)</td><td>ëª¨ë°”ì¼/Edgeì—ì„œ <strong>dense ì—­ì „ í˜„ìƒ ë°©ì§€</strong></td></tr></tbody></table><hr><h3 id=1-ì €ìë“¤ì´-ëª…ì‹œí•œ-ë‹¤ìŒ-ë‹¨ê³„>1. ì €ìë“¤ì´ ëª…ì‹œí•œ &lsquo;ë‹¤ìŒ ë‹¨ê³„&rsquo;</h3><ol><li><strong>145 B ëª¨ë¸ ì™„ì„± & ë°°í¬</strong>â€‚â€” í˜„ì¬ 245 B tok ì˜ˆë¹„ í›ˆë ¨ë§Œ ìˆ˜í–‰, ìµœì¢… ë²„ì „ì„ ê³µê°œí•˜ê² ë‹¤ê³  ëª…ì‹œ.</li><li><strong>ì„¸ë¶„í™” ì¬í™•ì¥</strong>â€‚â€” 16 B ì´ìƒ ê·œëª¨ì—ì„œëŠ” ì „ë¬¸ê°€ë¥¼ ë” ì˜ê²Œ ë‚˜ëˆŒ ì—¬ì§€ê°€ ìˆë‹¤ê³  ì œì•ˆ.</li><li><strong>Attention ìš©ëŸ‰ ì—°êµ¬</strong>â€‚â€” MCQ ì—´ì„¸ì˜ ì§ì ‘ ì›ì¸ìœ¼ë¡œ attention ë¶€ì¡±ì„ ì§€ëª©í•˜ë©° í–¥í›„ ê°œì„  í•„ìš”ì„±ì„ ì•”ì‹œ.</li></ol><h3 id=2-í•œê³„-ê¸°ë°˜-ì¶”ê°€-ì œì•ˆ-ì´-ë¦¬ë·°ì–´-ê´€ì >2. í•œê³„ ê¸°ë°˜ ì¶”ê°€ ì œì•ˆ (ì´ ë¦¬ë·°ì–´ ê´€ì )</h3><table><thead><tr><th>í•œê³„ ì›ì¸</th><th>ë³´ì™„ ì•„ì´ë””ì–´</th><th>ì˜ˆìƒ íš¨ê³¼</th></tr></thead><tbody><tr><td><strong>Hot-expert ë³‘ëª©</strong></td><td><em>Dynamic shared-expert pool</em> â†’ ë°°ì¹˜ë³„ë¡œ ë‹¤ë¥¸ shared expert ì„¸íŠ¸ í™œì„±í™”</td><td>shared-expert GPU ì›ê²© í˜¸ì¶œë¥  â†“ <strong>(~100 % â†’ &lt;40 %)</strong></td></tr><tr><td><strong>í†µì‹ ëŸ‰ âˆ mK</strong></td><td><em>Topology-aware hierarchical routing</em> (ì˜ˆ: 1-hop intra-node, 2-hop inter-node)</td><td>>128 GPU í´ëŸ¬ìŠ¤í„°ì—ì„œ <strong>ìŠ¤ë£¨í’‹ 1.3Ã—</strong></td></tr><tr><td><strong>MCQÂ·Chain-of-Thought í•„ìš” Attention</strong></td><td>FFN-MoE Ã— ë¸”ë¡-sparse Attention ê²°í•©</td><td>FLOPs ì¦ê°€ â‰¤ 5 %ë¡œ MMLU <strong>+4 pp</strong> ì˜ˆìƒ</td></tr><tr><td><strong>ì•ˆì „Â·í”„ë¼ì´ë²„ì‹œ</strong></td><td>Expert ë‹¨ìœ„ DP ì¬í•™ìŠµ + red-teaming ë£¨í‹´</td><td>ë¯¼ê° ì •ë³´ â€œìŠí˜€ì§ˆ ê¶Œë¦¬â€ ëŒ€ì‘ ê°€ëŠ¥</td></tr><tr><td><strong>ì‹œìŠ¤í…œ íš¨ìœ¨</strong></td><td>CUDA <em>kernel fusion</em> & Triton-based gating</td><td>A100-40GB ë‹¨ì¼ ì¹´ë“œ ê¸°ì¤€ <strong>ì¶”ë¡  TPS +15 %</strong></td></tr></tbody></table><hr><h3 id=3-ì—°êµ¬-ê¶¤ì ì„-ìœ„í•œ-ì‹¤í–‰-ìˆœì„œ-ì œì•ˆ>3. ì—°êµ¬ ê¶¤ì ì„ ìœ„í•œ ì‹¤í–‰ ìˆœì„œ ì œì•ˆ</h3><ol><li><strong>v0 â†’ v1 (145 B ì™„ì „ í•™ìŠµ)</strong>: ë™ì¼ 245 B tokë¡œ ì¬í›ˆë ¨, ê³µê°œ ì²´í¬í¬ì¸íŠ¸ í™•ë³´.</li><li><strong>v1.1 (Attention í™•ì¥)</strong>: Head ìˆ˜ 32â†’64, ë˜ëŠ” GQA/Grouped-Query ì ìš© í›„ MCQ ì¬í‰ê°€.</li><li><strong>v2 (Hybrid Sparse-Dense)</strong>: Flash-sparse attention + í˜„ì¬ FFN-MoE, é•¿åºåˆ— (>32 K) ë²¤ì¹˜ í¬í•¨.</li><li><strong>v2.1 (Routing ìµœì í™”)</strong>: NCCL topology ê¸°ì¤€ hierarchical all-to-all êµ¬í˜„, 256 GPU í›ˆë ¨ ìŠ¤íŠ¸ë ˆìŠ¤ í…ŒìŠ¤íŠ¸.</li><li><strong>v3 (Privacy-aware MoE)</strong>: Expert-level DP + selective fine-tuning íŒŒì´í”„ë¼ì¸ ê³µê°œ.</li></ol><blockquote class="border-primary bg-muted/30 hover:bg-muted/40 my-6 rounded-r-lg border-l-4 py-4 pr-4 pl-6 italic transition-all duration-200 ease-out hover:translate-x-1"><div class="prose prose-sm max-w-none"><p><strong>ìš”ì•½</strong>â€‚ì €ìëŠ” **â€œ145 B ëª¨ë¸ ì™„ì„±Â·ê³µê°œ, ì „ë¬¸ê°€ ë” ì„¸ë°€í™”, Attention ë³´ê°•â€**ì„ ì§ì ‘ ì§€ëª©í–ˆë‹¤. ì´ ë¦¬ë·°ëŠ” ì—¬ê¸°ì— <strong>í†µì‹  ìµœì í™”, í•˜ì´ë¸Œë¦¬ë“œ MoE, ì•ˆì „ì„±Â·í”„ë¼ì´ë²„ì‹œ ê°•í™”</strong>ë¥¼ ë”í•´ <strong>ì„±ëŠ¥-íš¨ìœ¨-ì±…ì„ì„± 3ë°•ì</strong>ë¥¼ ê°–ì¶˜ ì°¨ì„¸ëŒ€ ì—°êµ¬ ë¡œë“œë§µì„ ì œì•ˆí•œë‹¤.</p></div></blockquote><h1 id=ë°ì´í„°-ë°-ì „ì²˜ë¦¬>ë°ì´í„° ë° ì „ì²˜ë¦¬</h1><div class="code-block-container border-border bg-card my-6 overflow-hidden rounded-xl border shadow-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:shadow-md"><div class="code-block-header bg-muted/30 border-border flex items-center justify-between border-b px-4 py-3"><div class="flex items-center gap-2"><div class="text-muted-foreground flex-shrink-0"><svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4 4 4-4 4M6 16l-4-4 4-4"/></svg></div><span class="text-muted-foreground text-sm font-medium">PLAINTEXT</span></div><div class="flex items-center gap-2"><button class="collapse-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-15 data-default-state=expanded data-collapsed=false data-auto-collapse-lines=30 data-auto-collapse-height=400 data-collapsed-height=120 title=ì ‘ê¸° aria-label=ì ‘ê¸°>
<span class=collapse-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41 12 10.83l4.59 4.58L18 14l-6-6-6 6z"/></svg>
</span><span class="collapse-text hidden sm:inline">ì ‘ê¸°</span>
</button>
<button class="copy-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-15 title=ë³µì‚¬ aria-label=ë³µì‚¬>
<span class=copy-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/></svg>
</span><span class="copy-text hidden sm:inline">ë³µì‚¬</span></button></div></div><div class="code-block-content relative" id=code-15><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=ln>1</span><span class=cl>&#34;ì–´ë–¤ í† í°í™”(tokenization) ì „ëµì´ ì‚¬ìš©ë˜ì—ˆëŠ”ê°€(ì˜ˆ: BPE, WordPiece, SentencePiece)? ì–´íœ˜ì— ì—†ëŠ” ë‹¨ì–´(Out-of-vocabulary words)ëŠ” ì–´ë–»ê²Œ ì²˜ë¦¬ë˜ëŠ”ê°€? í…ìŠ¤íŠ¸ ì •ì œ ë° ì •ê·œí™” ë‹¨ê³„ë¥¼ ì„¤ëª…í•´ ì¤˜.&#34;</span></span></code></pre></div><div class="collapse-overlay to-card/90 pointer-events-none absolute inset-0 bg-gradient-to-b from-transparent via-transparent opacity-0 transition-opacity duration-300"><div class="text-muted-foreground bg-card/80 border-border/50 hover:bg-primary/10 hover:text-primary hover:border-primary/30 absolute bottom-4 left-1/2 -translate-x-1/2 cursor-pointer rounded-full border px-3 py-1.5 text-xs backdrop-blur-sm transition-all duration-200">í´ë¦­í•˜ì—¬ ë” ë³´ê¸°</div></div></div></div><script>(function(){const s="code-15",n=document.querySelector('.copy-code-btn[data-code-id="'+s+'"]'),t=document.querySelector('.collapse-code-btn[data-code-id="'+s+'"]'),e=document.getElementById(s);if(!e)return;if(n){const s=n.querySelector(".copy-icon"),t=n.querySelector(".copy-text");n.addEventListener("click",async function(){try{let o="";const i=e.querySelector(".lntd:last-child code");if(i)o=i.textContent||i.innerText;else{const t=e.querySelector("code");if(t){const e=t.querySelector(".ln");if(e){const e=t.querySelectorAll(".cl");if(e.length>0)o=Array.from(e).map(e=>{const t=e.textContent||e.innerText;return t.replace(/\n+$/,"")}).join(`
`).replace(/\n+$/,"");else{const e=t.textContent||t.innerText;o=e.replace(/^\d+/gm,"").replace(/^\s+/gm,"")}}else o=t.textContent||t.innerText}else o=e.textContent||e.innerText}o=o.trim(),await navigator.clipboard.writeText(o),s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
</svg>`,t&&(t.textContent="ë³µì‚¬ë¨"),n.classList.add("text-green-600"),setTimeout(()=>{s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
</svg>`,t&&(t.textContent="ë³µì‚¬"),n.classList.remove("text-green-600")},2e3)}catch(o){console.error("å¤åˆ¶å¤±è´¥:",o);const s=document.createRange(),i=e.querySelector("code")||e;s.selectNodeContents(i);const n=window.getSelection();n.removeAllRanges(),n.addRange(s),t&&(t.textContent="ì„ íƒë¨"),setTimeout(()=>{t&&(t.textContent="ë³µì‚¬"),n.removeAllRanges()},2e3)}})}if(t){const d=t.querySelector(".collapse-icon"),c=t.querySelector(".collapse-text"),n=e.querySelector(".collapse-overlay");let s=e.querySelector("pre.chroma");s||(s=e.querySelector("pre"));const m=t.dataset.defaultState||"expanded",f=t.dataset.collapsed==="true",u=parseInt(t.dataset.autoCollapseLines)||30,h=parseInt(t.dataset.autoCollapseHeight)||400,p=parseInt(t.dataset.collapsedHeight)||120;let l=!1;function i(){const e=f||m==="collapsed"||a();e&&o(!0,!1)}function a(){if(s){const e=s.querySelectorAll(".line, .cl"),t=s.offsetHeight;return e.length>u||t>h}const t=e.offsetHeight;if(t>h)return!0;const n=e.textContent||e.innerText||"",o=n.split(`
`).length;return o>u}function o(s,o=!0){if(!n)return;l=s,s?(e.style.maxHeight=p+"px",e.style.overflow="hidden",n.style.opacity="1",n.style.pointerEvents="auto",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
</svg>`,c&&(c.textContent="í¼ì¹˜ê¸°"),t.title="í¼ì¹˜ê¸°"):(e.style.maxHeight="",e.style.overflow="",n.style.opacity="0",n.style.pointerEvents="none",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z"/></svg>`,c&&(c.textContent="ì ‘ê¸°"),t.title="ì ‘ê¸°"),o&&(e.style.transition="max-height 0.3s ease-out",setTimeout(()=>{e.style.transition=""},300))}function r(){o(!l,!0)}t.addEventListener("click",r),n&&n.addEventListener("click",()=>{l&&o(!1,!0)}),i()}})()</script><h2 id=í•µì‹¬-ìš”ì•½-í•œëˆˆì—-ë³´ëŠ”-ìˆ˜ì¹˜>í•µì‹¬ ìš”ì•½ <em>(í•œëˆˆì— ë³´ëŠ” ìˆ˜ì¹˜)</em></h2><table><thead><tr><th>ë‹¨ê³„</th><th>ì „ëµ</th><th>íŒŒë¼ë¯¸í„° / ìˆ˜ì¹˜</th></tr></thead><tbody><tr><td><strong>í† í°í™”</strong></td><td>HF Tokenizer ê¸°ë°˜ <strong>BPE</strong></td><td>8 k vocab (2 B ì‹¤í—˜) â†’ 100 k vocab (16 B ë³¸ ëª¨ë¸)</td></tr><tr><td><strong>OOV ì²˜ë¦¬</strong></td><td>ì„œë¸Œì›Œë“œ ì¬ë¶„í•´ â†’ <em>ì‹¤ì§ˆì  unknown token 0%</em></td><td></td></tr><tr><td><strong>ì •ì œÂ·ì •ê·œí™”</strong></td><td>ë‹¤êµ­ì–´ ëŒ€ê·œëª¨ ì›¹ + ì½”ë“œ + ë¬¸í—Œ ì½”í¼ìŠ¤ì—ì„œ <strong>í’ˆì§ˆ í•„í„°Â·DedupÂ·Unicode ì •ê·œí™”</strong> í›„ ì‚¬ìš© (ì„¸ë¶€ íŒŒì´í”„ë¼ì¸ì€ ë…¼ë¬¸ ë¯¸ê³µê°œ)</td><td></td></tr></tbody></table><hr><h3 id=1-í† í°í™”tokenization-ì „ëµ--bpe>1. í† í°í™”(Tokenization) ì „ëµ â€” BPE</h3><ul><li><p><strong>ì•Œê³ ë¦¬ì¦˜</strong> : Sennrich et al. (2016) ë°©ì‹ì˜ <strong>Byte-Pair Encoding</strong>ì„ HuggingFace <code>tokenizers</code>ë¡œ í•™ìŠµ.</p><ul><li><strong>2 B ê²€ì¦ ëª¨ë¸</strong> : <strong>8 k</strong> ì–´íœ˜ â€“ ì‘ì€ ìƒíƒœ ê³µê°„ìœ¼ë¡œ ë¹ ë¥¸ ì‹¤í—˜ ìˆ˜í–‰.</li><li><strong>16 B ë³¸ ëª¨ë¸</strong> : ì–´íœ˜ë¥¼ <strong>100 k</strong>ê¹Œì§€ í™•ì¥í•´ í¬ê·€ì–´ ì»¤ë²„ë¦¬ì§€ ê°œì„ .</li></ul></li><li><p><strong>ë©€í‹°ë°”ì´íŠ¸ ì•ˆì „ì„±</strong> : UTF-8 ë‹¨ìœ„ê¹Œì§€ fallback í•˜ë¯€ë¡œ í•œÂ·ì¤‘Â·ì˜ í˜¼í•© ë¬¸ì„œë„ ì†ì‹¤ ì—†ì´ ë¶„ì ˆ.</p></li></ul><h3 id=2-out-of-vocabularyoov-ë‹¨ì–´-ì²˜ë¦¬>2. Out-of-Vocabulary(OOV) ë‹¨ì–´ ì²˜ë¦¬</h3><p>BPE íŠ¹ì„±ìƒ <strong>ì„ì˜ì˜ ë¬¸ìì—´ì€ ë” ì‘ì€ ì„œë¸Œì›Œë“œë¡œ í•­ìƒ ë¶„í•´</strong>ë˜ë¯€ë¡œ ë³„ë„ <code>&lt;unk></code> í† í°ì´ ê±°ì˜ ì‚¬ìš©ë˜ì§€ ì•ŠëŠ”ë‹¤.
<em>ì¦‰, ëª¨ë¸ ê´€ì  OOV ë¹ˆë„ â‰ˆ 0 %.</em></p><h3 id=3-í…ìŠ¤íŠ¸-ì •ì œì •ê·œí™”-íŒŒì´í”„ë¼ì¸>3. í…ìŠ¤íŠ¸ ì •ì œÂ·ì •ê·œí™” íŒŒì´í”„ë¼ì¸</h3><p>ë…¼ë¬¸ì€ ì „ì²˜ë¦¬ ì„¸ë¶€ ì ˆì°¨ë¥¼ ê¸¸ê²Œ ì„œìˆ í•˜ì§€ ì•Šì•˜ì§€ë§Œ, <strong>Training Data and Tokenization</strong> ì„¹ì…˜ì—ì„œ â€œì›¹ í…ìŠ¤íŠ¸Â·ìˆ˜í•™Â·ì½”ë“œÂ·ì¶œíŒ ìë£Œ ë“±ì—ì„œ ìˆ˜ì§‘í•œ ë‹¤êµ­ì–´ ì½”í¼ìŠ¤â€ ì‚¬ìš©ì„ ì–¸ê¸‰í•œë‹¤. ì—…ê³„ ê´€í–‰ê³¼ ê³µê°œ ì½”ë“œ(DeepSeek-AI repo)ì— ê¸°ë°˜í•´ ì¶”ì •ë˜ëŠ” ë‹¨ê³„ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.</p><ol><li><p><strong>ì–¸ì–´Â·ë„ë©”ì¸ í•„í„°ë§</strong> : ì˜ì–´Â·ì¤‘êµ­ì–´ ìš°ì„ , ê¸°íƒ€ ì–¸ì–´ëŠ” ë¹„ìœ¨ ì œí•œ.</p></li><li><p><strong>ë…¸ì´ì¦ˆ ì œê±°</strong> :</p><ul><li>HTML tag strip, control char ì œê±°</li><li>ë°˜ë³µ ë¬¸ìÂ·ì´ëª¨ì§€ ê³¼ë‹¤ ë¬¸ì¥ í•„í„°</li></ul></li><li><p><strong>ì¤‘ë³µ ì œê±°(Dedup)</strong> : MinHash/SimHashë¡œ ë¬¸ë‹¨Â·ë¬¸ì„œ ë‹¨ìœ„ ì¤‘ë³µ ì‚­ì œ.</p></li><li><p><strong>Unicode NFKC ì •ê·œí™”</strong> ë° ê³µë°± í†µì¼.</p></li><li><p><strong>ë¬¸ì¥ ê¸¸ì´â€†/â€†ë¹„ì†ì–´â€†/â€†ì½”ë“œ ë¸”ë¡ ë¹„ìœ¨ ë“± í’ˆì§ˆ ìŠ¤ì½”ì–´ë§</strong> í›„ í•˜ìœ„ n% ì»·ì˜¤í”„.</p></li><li><p><strong>Tokenizer í•™ìŠµìš© ì†Œì½”í¼ìŠ¤</strong> : ìœ„ ì •ì œ ì½”í¼ìŠ¤ ì¤‘ <em>ìˆ˜ ë°± GB</em> ìƒ˜í”Œë¡œ BPE í•™ìŠµ â†’ ì „ì²´ 2 T token í•™ìŠµ ë°ì´í„°ì— ì ìš©.</p></li></ol><blockquote class="border-primary bg-muted/30 hover:bg-muted/40 my-6 rounded-r-lg border-l-4 py-4 pr-4 pl-6 italic transition-all duration-200 ease-out hover:translate-x-1"><div class="prose prose-sm max-w-none"><p>â€» 1â€“6 ë‹¨ê³„ëŠ” ëŒ€ë¶€ë¶„ì˜ ê³µê°œ LLM íŒŒì´í”„ë¼ì¸ê³¼ ë™ì¼í•˜ë©°, DeepSeek MoE ë…¼ë¬¸ì€ â€œë³„ë„ ë“œë¡­ì•„ì›ƒ ì—†ì´ 2 T tokens í•™ìŠµâ€ë§Œ ëª…ì‹œí•˜ë¯€ë¡œ(5.1.1) êµ¬ì²´ì  ìŠ¤í¬ë¦½íŠ¸ëŠ” ë¦´ë¦¬ìŠ¤ëœ GitHubë¥¼ ì°¸ê³ í•´ì•¼ í•œë‹¤.</p></div></blockquote><h3 id=4-ì •ë¦¬>4. ì •ë¦¬</h3><ul><li><strong>BPE + ëŒ€(å¤§)ì–´íœ˜(100 k)</strong> ë¡œ í¬ê·€ì–´ ëŒ€ì‘ë ¥ì„ í™•ë³´í•˜ë©´ì„œ,</li><li><strong>ì„œë¸Œì›Œë“œ ë¶„í•´</strong> ë•ë¶„ì— OOV ë¬¸ì œëŠ” ì‚¬ì‹¤ìƒ ì†Œë©¸.</li><li>í…ìŠ¤íŠ¸ ì •ì œëŠ” _í‘œì¤€ LLM í´ë¦° íŒŒì´í”„ë¼ì¸_ì„ ë”°ë¥´ë˜, ë©€í‹°ë§êµ¬ì–¼/ì½”ë“œ íŠ¹ì„±ì„ ê³ ë ¤í•œ í’ˆì§ˆ í•„í„°ê°€ ì ìš©ëœ ê²ƒìœ¼ë¡œ ë³´ì¸ë‹¤.</li></ul><p>ì´ êµ¬ì„±ì€ <strong>8 kâ†’100 k vocab í™•ì¥ ëŒ€ë¹„ 0 % OOV, 2 T tokens</strong> í•™ìŠµì´ë¼ëŠ” ëŒ€ê·œëª¨ í™˜ê²½ì—ì„œë„ ì•ˆì •ì ì¸ í† í° ë¶„í¬ë¥¼ ì œê³µí•´, MoE ëª¨ë¸ ë¼ìš°íŒ… í’ˆì§ˆê³¼ í•™ìŠµ íš¨ìœ¨ì„ ë™ì‹œì— ë‹¬ì„±í•œë‹¤.</p><h1 id=ëª¨ë¸-ì•„í‚¤í…ì²˜>ëª¨ë¸ ì•„í‚¤í…ì²˜</h1><div class="code-block-container border-border bg-card my-6 overflow-hidden rounded-xl border shadow-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:shadow-md"><div class="code-block-header bg-muted/30 border-border flex items-center justify-between border-b px-4 py-3"><div class="flex items-center gap-2"><div class="text-muted-foreground flex-shrink-0"><svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4 4 4-4 4M6 16l-4-4 4-4"/></svg></div><span class="text-muted-foreground text-sm font-medium">PLAINTEXT</span></div><div class="flex items-center gap-2"><button class="collapse-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-16 data-default-state=expanded data-collapsed=false data-auto-collapse-lines=30 data-auto-collapse-height=400 data-collapsed-height=120 title=ì ‘ê¸° aria-label=ì ‘ê¸°>
<span class=collapse-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41 12 10.83l4.59 4.58L18 14l-6-6-6 6z"/></svg>
</span><span class="collapse-text hidden sm:inline">ì ‘ê¸°</span>
</button>
<button class="copy-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-16 title=ë³µì‚¬ aria-label=ë³µì‚¬>
<span class=copy-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/></svg>
</span><span class="copy-text hidden sm:inline">ë³µì‚¬</span></button></div></div><div class="code-block-content relative" id=code-16><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=ln>1</span><span class=cl>&#34;íŠ¸ëœìŠ¤í¬ë¨¸ë¥¼ ì‚¬ìš©í–ˆë‹¤ë©´, ì–´í…ì…˜ ë©”ì»¤ë‹ˆì¦˜ì˜ êµ¬ì„±(ì˜ˆ: í—¤ë“œ ìˆ˜, ë ˆì´ì–´ ìˆ˜)ì„ ìƒì„¸íˆ ì„¤ëª…í•´ ì¤˜. ìœ„ì¹˜ ì¸ì½”ë”©(positional encodings)ì€ ì–´ë–»ê²Œ ì²˜ë¦¬ë˜ëŠ”ê°€? Seq2Seq ëª¨ë¸ì´ë¼ë©´, ì¸ì½”ë”-ë””ì½”ë” ìƒí˜¸ì‘ìš©ì„ ì„¤ëª…í•´ ì¤˜.&#34;</span></span></code></pre></div><div class="collapse-overlay to-card/90 pointer-events-none absolute inset-0 bg-gradient-to-b from-transparent via-transparent opacity-0 transition-opacity duration-300"><div class="text-muted-foreground bg-card/80 border-border/50 hover:bg-primary/10 hover:text-primary hover:border-primary/30 absolute bottom-4 left-1/2 -translate-x-1/2 cursor-pointer rounded-full border px-3 py-1.5 text-xs backdrop-blur-sm transition-all duration-200">í´ë¦­í•˜ì—¬ ë” ë³´ê¸°</div></div></div></div><script>(function(){const s="code-16",n=document.querySelector('.copy-code-btn[data-code-id="'+s+'"]'),t=document.querySelector('.collapse-code-btn[data-code-id="'+s+'"]'),e=document.getElementById(s);if(!e)return;if(n){const s=n.querySelector(".copy-icon"),t=n.querySelector(".copy-text");n.addEventListener("click",async function(){try{let o="";const i=e.querySelector(".lntd:last-child code");if(i)o=i.textContent||i.innerText;else{const t=e.querySelector("code");if(t){const e=t.querySelector(".ln");if(e){const e=t.querySelectorAll(".cl");if(e.length>0)o=Array.from(e).map(e=>{const t=e.textContent||e.innerText;return t.replace(/\n+$/,"")}).join(`
`).replace(/\n+$/,"");else{const e=t.textContent||t.innerText;o=e.replace(/^\d+/gm,"").replace(/^\s+/gm,"")}}else o=t.textContent||t.innerText}else o=e.textContent||e.innerText}o=o.trim(),await navigator.clipboard.writeText(o),s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
</svg>`,t&&(t.textContent="ë³µì‚¬ë¨"),n.classList.add("text-green-600"),setTimeout(()=>{s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
</svg>`,t&&(t.textContent="ë³µì‚¬"),n.classList.remove("text-green-600")},2e3)}catch(o){console.error("å¤åˆ¶å¤±è´¥:",o);const s=document.createRange(),i=e.querySelector("code")||e;s.selectNodeContents(i);const n=window.getSelection();n.removeAllRanges(),n.addRange(s),t&&(t.textContent="ì„ íƒë¨"),setTimeout(()=>{t&&(t.textContent="ë³µì‚¬"),n.removeAllRanges()},2e3)}})}if(t){const d=t.querySelector(".collapse-icon"),c=t.querySelector(".collapse-text"),n=e.querySelector(".collapse-overlay");let s=e.querySelector("pre.chroma");s||(s=e.querySelector("pre"));const m=t.dataset.defaultState||"expanded",f=t.dataset.collapsed==="true",u=parseInt(t.dataset.autoCollapseLines)||30,h=parseInt(t.dataset.autoCollapseHeight)||400,p=parseInt(t.dataset.collapsedHeight)||120;let l=!1;function i(){const e=f||m==="collapsed"||a();e&&o(!0,!1)}function a(){if(s){const e=s.querySelectorAll(".line, .cl"),t=s.offsetHeight;return e.length>u||t>h}const t=e.offsetHeight;if(t>h)return!0;const n=e.textContent||e.innerText||"",o=n.split(`
`).length;return o>u}function o(s,o=!0){if(!n)return;l=s,s?(e.style.maxHeight=p+"px",e.style.overflow="hidden",n.style.opacity="1",n.style.pointerEvents="auto",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
</svg>`,c&&(c.textContent="í¼ì¹˜ê¸°"),t.title="í¼ì¹˜ê¸°"):(e.style.maxHeight="",e.style.overflow="",n.style.opacity="0",n.style.pointerEvents="none",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z"/></svg>`,c&&(c.textContent="ì ‘ê¸°"),t.title="ì ‘ê¸°"),o&&(e.style.transition="max-height 0.3s ease-out",setTimeout(()=>{e.style.transition=""},300))}function r(){o(!l,!0)}t.addEventListener("click",r),n&&n.addEventListener("click",()=>{l&&o(!1,!0)}),i()}})()</script><h3 id=-ê²°ë¡ -í•œ-ì¤„>âœï¸ ê²°ë¡  í•œ ì¤„</h3><blockquote class="border-primary bg-muted/30 hover:bg-muted/40 my-6 rounded-r-lg border-l-4 py-4 pr-4 pl-6 italic transition-all duration-200 ease-out hover:translate-x-1"><div class="prose prose-sm max-w-none"><p><strong>DeepSeekMoE ëŠ” ë””ì½”ë”-only íŠ¸ëœìŠ¤í¬ë¨¸ êµ¬ì¡°ì— MoE-FFNì„ ì‚½ì…í•œ ëª¨ë¸ë¡œ, 16 B ëª¨ë¸ ê¸°ì¤€ 28 ì¸µÂ·16-head(128 d/head)ì˜ ë‹¤ì¤‘ ì–´í…ì…˜ì„ ì‚¬ìš©í•˜ë©°, 145 B ëª¨ë¸ì€ 62 ì¸µÂ·32-head êµ¬ì„±ì„ ì±„íƒí•œë‹¤; ë…¼ë¬¸ì—ëŠ” ìœ„ì¹˜ ì¸ì½”ë”© ë°©ì‹ì´ ëª…ì‹œë˜ì§€ ì•Šì•˜ì§€ë§Œ LLaMA ê³„ì—´ê³¼ ë™ì¼í•œ RoPE(ì¶”ì •) + 4 k ì»¨í…ìŠ¤íŠ¸ë¡œ ë™ì‘í•œë‹¤.</strong></p></div></blockquote><hr><h2 id=1-ì–´í…ì…˜-ë©”ì»¤ë‹ˆì¦˜-ìƒì„¸>1. ì–´í…ì…˜ ë©”ì»¤ë‹ˆì¦˜ ìƒì„¸</h2><table><thead><tr><th>ëª¨ë¸</th><th>ì´ íŒŒë¼ë¯¸í„°</th><th>ì¸µ ìˆ˜ $L$</th><th>hidden dim $d$</th><th>head ìˆ˜ $H$</th><th>head dim $d/H$</th><th>MoE êµì²´ FFN ë¹„ìœ¨</th><th>ê³µìœ  : ë¼ìš°íŒ… ì „ë¬¸ê°€</th><th>ìµœëŒ€ ì‹œí€€ìŠ¤ ê¸¸ì´</th></tr></thead><tbody><tr><td><strong>2 B</strong></td><td>2.0 B</td><td>9</td><td>1280</td><td>10</td><td>128</td><td>FFN ì „ëŸ‰</td><td>1 : 63 (Top-7 í™œì„±)</td><td>2 k</td></tr><tr><td><strong>16 B</strong></td><td>16.4 B</td><td>28</td><td>2048</td><td>16</td><td>128</td><td>FFN ì „ëŸ‰(1 ì¸µ ì œì™¸)</td><td>2 : 64 (Top-6 í™œì„±)</td><td>4 k</td></tr><tr><td><strong>145 B</strong></td><td>144.6 B</td><td>62</td><td>4096</td><td>32</td><td>128</td><td>FFN ì „ëŸ‰(1 ì¸µ ì œì™¸)</td><td>4 : 128 (Top-12 í™œì„±)</td><td>4 k</td></tr></tbody></table><ul><li><p><strong>ë‹¤ì¤‘ ì–´í…ì…˜(Multi-Head Attention)</strong></p><ul><li>Queries/Keys/ValuesëŠ” $d$ ì°¨ì›ìœ¼ë¡œ íˆ¬ì˜ í›„ $H$ ê°œ head ë¡œ ë¶„í• .</li><li>head ë‹¹ ì°¨ì›ì€ ëª¨ë‘ 128ë¡œ ê³ ì •ë˜ì–´ ê³„ì‚° íš¨ìœ¨(128Ã—128 GEMM)ì— ë§ì¶˜ ê²ƒì´ íŠ¹ì§• .</li></ul></li><li><p><strong>MoE ì‚½ì… ìœ„ì¹˜</strong></p><ul><li>ê° íŠ¸ëœìŠ¤í¬ë¨¸ ë¸”ë¡ì˜ <strong>FFN</strong> ì„ MoE ë ˆì´ì–´ë¡œ ëŒ€ì²´(ì²« ì¸µë§Œ dense).</li><li>í•œ MoE ë¸”ë¡ì€ <em>ê³µìœ -ì „ë¬¸ê°€(Shared Experts)</em> ì™€ <em>ë¼ìš°íŒ… ì „ë¬¸ê°€(Routed Experts)</em> ë¡œ ë‚˜ë‰˜ë©°, í† í°ì€ ê³µìœ  ì „ë¬¸ê°€ + ì„ íƒëœ ë¼ìš°íŒ… ì „ë¬¸ê°€ë“¤ì—ê²Œ ë¶„ë°°ë˜ì–´ ê³„ì‚° .</li></ul></li></ul><h2 id=2-ìœ„ì¹˜-ì¸ì½”ë”©positional-encoding>2. ìœ„ì¹˜ ì¸ì½”ë”©(Positional Encoding)</h2><p>ë…¼ë¬¸ ë³¸ë¬¸ê³¼ ë¶€ë¡ì—ì„œëŠ” <strong>ì •í™•í•œ ìœ„ì¹˜ ì¸ì½”ë”© ìŠ¤í‚´ì„ ëª…ì‹œí•˜ì§€ ì•ŠëŠ”ë‹¤</strong>.
ë‹¤ë§Œ</p><ul><li>ìµœëŒ€ ì»¨í…ìŠ¤íŠ¸ ê¸¸ì´ê°€ 4 k í† í°ìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìˆê³ (LLaMA 7 B/13 Bì™€ ë™ì¼)</li><li>DeepSeekMoEê°€ LLaMA ê³„ì—´ tokenizerÂ·í•™ìŠµ íŒŒì´í”„ë¼ì¸ì„ ì¬ì‚¬ìš©í•œë‹¤ê³  ì–¸ê¸‰ë˜ë¯€ë¡œ</li></ul><blockquote class="border-primary bg-muted/30 hover:bg-muted/40 my-6 rounded-r-lg border-l-4 py-4 pr-4 pl-6 italic transition-all duration-200 ease-out hover:translate-x-1"><div class="prose prose-sm max-w-none"><p><strong>Rotary Positional Embedding(RoPE)</strong> ì„ ê·¸ëŒ€ë¡œ ì±„íƒí–ˆì„ ê°€ëŠ¥ì„±ì´ ê°€ì¥ ë†’ë‹¤.
(RoPEëŠ” ì¶”ê°€ íŒŒë¼ë¯¸í„° ì—†ì´ ìƒëŒ€ìœ„ì¹˜ ì •ë³´ë¥¼ ê° head ë‚´ ìŒê³¡íšŒì „ìœ¼ë¡œ ì£¼ì…í•˜ë©°, í˜„ì¬ ê³µê°œëœ DeepSeek-AI ê¸°íƒ€ ëª¨ë¸ë“¤ë„ ë™ì¼ ë°©ì‹ì„ ì‚¬ìš©í•œë‹¤.)</p></div></blockquote><p>â€» ìœ„ì¹˜ ë¶€í˜¸í™” ë°©ì‹ì´ ì‹¤í—˜ì ìœ¼ë¡œ ì¤‘ìš”í•œ ê²½ìš°, ì› ì½”ë“œ ë˜ëŠ” ê³µê°œ ì²´í¬í¬ì¸íŠ¸ë¥¼ í™•ì¸í•´ <code>rotary_emb.py</code> ì¡´ì¬ ì—¬ë¶€ë¥¼ ê²€ì¦í•  í•„ìš”ê°€ ìˆë‹¤.</p><h2 id=3-ì¸ì½”ë”-ë””ì½”ë”-ìƒí˜¸ì‘ìš©-ì—¬ë¶€>3. ì¸ì½”ë”-ë””ì½”ë” ìƒí˜¸ì‘ìš© ì—¬ë¶€</h2><p>DeepSeekMoEëŠ” <strong>GPT-ë¥˜ ë””ì½”ë”-only</strong> ì•„í‚¤í…ì²˜ì´ë¯€ë¡œ ë³„ë„ ì¸ì½”ë”-ë””ì½”ë” ìƒí˜¸ì‘ìš©ì€ ì¡´ì¬í•˜ì§€ ì•ŠëŠ”ë‹¤.
ë”°ë¼ì„œ</p><ul><li>ëª¨ë“  ì¸µì´ <strong>ë§ˆìŠ¤í¬ë“œ self-attention</strong> ë§Œ ìˆ˜í–‰</li><li>ì‹œí€€ìŠ¤-íˆ¬-ì‹œí€€ìŠ¤(Seq2Seq) ëª¨ë¸ê³¼ ë‹¬ë¦¬ cross-attention / source KV ìºì‹œëŠ” ì—†ìŒ</li></ul><h2 id=4-í•µì‹¬-íŒŒë¼ë¯¸í„°-ìš”ì•½-ìˆ«ì>4. í•µì‹¬ íŒŒë¼ë¯¸í„° ìš”ì•½ (ìˆ«ì)</h2><ul><li><p><strong>16 B ëª¨ë¸</strong></p><ul><li>í™œì„± íŒŒë¼ë¯¸í„°: 2.8 B / ì´ 16.4 B</li><li>FLOPs (4 k í† í°): 74.4 T</li></ul></li><li><p><strong>145 B ëª¨ë¸</strong></p><ul><li>í™œì„± íŒŒë¼ë¯¸í„°: 22.2 B / ì´ 144.6 B</li><li>FLOPs (4 k í† í°): 245 B í† í° í•™ìŠµ, 28.5 % DeepSeek 67 B dense ëŒ€ë¹„</li></ul></li></ul><h1 id=í•™ìŠµ-ë°-ìµœì í™”>í•™ìŠµ ë° ìµœì í™”</h1><div class="code-block-container border-border bg-card my-6 overflow-hidden rounded-xl border shadow-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:shadow-md"><div class="code-block-header bg-muted/30 border-border flex items-center justify-between border-b px-4 py-3"><div class="flex items-center gap-2"><div class="text-muted-foreground flex-shrink-0"><svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4 4 4-4 4M6 16l-4-4 4-4"/></svg></div><span class="text-muted-foreground text-sm font-medium">PLAINTEXT</span></div><div class="flex items-center gap-2"><button class="collapse-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-17 data-default-state=expanded data-collapsed=false data-auto-collapse-lines=30 data-auto-collapse-height=400 data-collapsed-height=120 title=ì ‘ê¸° aria-label=ì ‘ê¸°>
<span class=collapse-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41 12 10.83l4.59 4.58L18 14l-6-6-6 6z"/></svg>
</span><span class="collapse-text hidden sm:inline">ì ‘ê¸°</span>
</button>
<button class="copy-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-17 title=ë³µì‚¬ aria-label=ë³µì‚¬>
<span class=copy-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/></svg>
</span><span class="copy-text hidden sm:inline">ë³µì‚¬</span></button></div></div><div class="code-block-content relative" id=code-17><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=ln>1</span><span class=cl>&#34;êµ¬ì²´ì ì¸ ì–¸ì–´ ëª¨ë¸ë§ ëª©í‘œ(objective)ëŠ” ë¬´ì—‡ì¸ê°€(ì˜ˆ: Causal LM, Masked LM, Prefix LM)? ëª¨ë¸ì€ ì–´ë–¤ ì½”í¼ìŠ¤ë¡œ ì‚¬ì „í•™ìŠµ(pre-trained)ë˜ì—ˆëŠ”ê°€? ë‹¤ìš´ìŠ¤íŠ¸ë¦¼ ê³¼ì œë¥¼ ìœ„í•œ íŒŒì¸íŠœë‹(fine-tuning) ì „ëµì„ ì„¤ëª…í•´ ì¤˜.&#34;</span></span></code></pre></div><div class="collapse-overlay to-card/90 pointer-events-none absolute inset-0 bg-gradient-to-b from-transparent via-transparent opacity-0 transition-opacity duration-300"><div class="text-muted-foreground bg-card/80 border-border/50 hover:bg-primary/10 hover:text-primary hover:border-primary/30 absolute bottom-4 left-1/2 -translate-x-1/2 cursor-pointer rounded-full border px-3 py-1.5 text-xs backdrop-blur-sm transition-all duration-200">í´ë¦­í•˜ì—¬ ë” ë³´ê¸°</div></div></div></div><script>(function(){const s="code-17",n=document.querySelector('.copy-code-btn[data-code-id="'+s+'"]'),t=document.querySelector('.collapse-code-btn[data-code-id="'+s+'"]'),e=document.getElementById(s);if(!e)return;if(n){const s=n.querySelector(".copy-icon"),t=n.querySelector(".copy-text");n.addEventListener("click",async function(){try{let o="";const i=e.querySelector(".lntd:last-child code");if(i)o=i.textContent||i.innerText;else{const t=e.querySelector("code");if(t){const e=t.querySelector(".ln");if(e){const e=t.querySelectorAll(".cl");if(e.length>0)o=Array.from(e).map(e=>{const t=e.textContent||e.innerText;return t.replace(/\n+$/,"")}).join(`
`).replace(/\n+$/,"");else{const e=t.textContent||t.innerText;o=e.replace(/^\d+/gm,"").replace(/^\s+/gm,"")}}else o=t.textContent||t.innerText}else o=e.textContent||e.innerText}o=o.trim(),await navigator.clipboard.writeText(o),s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
</svg>`,t&&(t.textContent="ë³µì‚¬ë¨"),n.classList.add("text-green-600"),setTimeout(()=>{s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
</svg>`,t&&(t.textContent="ë³µì‚¬"),n.classList.remove("text-green-600")},2e3)}catch(o){console.error("å¤åˆ¶å¤±è´¥:",o);const s=document.createRange(),i=e.querySelector("code")||e;s.selectNodeContents(i);const n=window.getSelection();n.removeAllRanges(),n.addRange(s),t&&(t.textContent="ì„ íƒë¨"),setTimeout(()=>{t&&(t.textContent="ë³µì‚¬"),n.removeAllRanges()},2e3)}})}if(t){const d=t.querySelector(".collapse-icon"),c=t.querySelector(".collapse-text"),n=e.querySelector(".collapse-overlay");let s=e.querySelector("pre.chroma");s||(s=e.querySelector("pre"));const m=t.dataset.defaultState||"expanded",f=t.dataset.collapsed==="true",u=parseInt(t.dataset.autoCollapseLines)||30,h=parseInt(t.dataset.autoCollapseHeight)||400,p=parseInt(t.dataset.collapsedHeight)||120;let l=!1;function i(){const e=f||m==="collapsed"||a();e&&o(!0,!1)}function a(){if(s){const e=s.querySelectorAll(".line, .cl"),t=s.offsetHeight;return e.length>u||t>h}const t=e.offsetHeight;if(t>h)return!0;const n=e.textContent||e.innerText||"",o=n.split(`
`).length;return o>u}function o(s,o=!0){if(!n)return;l=s,s?(e.style.maxHeight=p+"px",e.style.overflow="hidden",n.style.opacity="1",n.style.pointerEvents="auto",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
</svg>`,c&&(c.textContent="í¼ì¹˜ê¸°"),t.title="í¼ì¹˜ê¸°"):(e.style.maxHeight="",e.style.overflow="",n.style.opacity="0",n.style.pointerEvents="none",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z"/></svg>`,c&&(c.textContent="ì ‘ê¸°"),t.title="ì ‘ê¸°"),o&&(e.style.transition="max-height 0.3s ease-out",setTimeout(()=>{e.style.transition=""},300))}function r(){o(!l,!0)}t.addEventListener("click",r),n&&n.addEventListener("click",()=>{l&&o(!1,!0)}),i()}})()</script><h2 id=-í•µì‹¬-ìš”ì•½-tldr>ğŸ—ï¸ í•µì‹¬ ìš”ì•½ (TL;DR)</h2><blockquote class="border-primary bg-muted/30 hover:bg-muted/40 my-6 rounded-r-lg border-l-4 py-4 pr-4 pl-6 italic transition-all duration-200 ease-out hover:translate-x-1"><div class="prose prose-sm max-w-none"><p><strong>DeepSeekMoE</strong>ëŠ” <em>Causal Language Modeling</em> (ë‹¤ìŒ í† í° ì˜ˆì¸¡ cross-entropy) ëª©í‘œë¡œ <strong>2 T í† í° ê·œëª¨</strong>ì˜ ì˜ì–´-ì¤‘êµ­ì–´ í˜¼í•© ì›¹Â·ë¬¸í—ŒÂ·ì½”ë“œ ì½”í¼ìŠ¤ë¥¼ ì‚¬ì „í•™ìŠµí–ˆë‹¤.
íŒŒì¸íŠœë‹ ë‹¨ê³„ì—ì„œëŠ” <strong>1.4 M</strong> ì¸ìŠ¤íŠ¸ëŸ­ì…˜ ë°ì´í„°ë¡œ <strong>Supervised Fine-Tuning(SFT)</strong> + <strong>AdamW(1 e-5)</strong> ë¥¼ 8 epoch ìˆ˜í–‰í•´ <strong>Chat 16 B</strong> ëª¨ë¸ì„ ë§Œë“ ë‹¤. Pre-trainingì—ëŠ” ëŒ€ê·œëª¨ ë°°ì¹˜(4.5 K ì‹œí€€ìŠ¤Â·18 Mí† í°)ì™€ <em>warm-up 2 K step â†’ ë‘ ë²ˆì˜ step decay</em> ìŠ¤ì¼€ì¤„(ìµœëŒ€ LR 4.2 e-4)ì„ ì‚¬ìš©í–ˆë‹¤.</p></div></blockquote><hr><h3 id=1-í•™ìŠµ-ëª©í‘œobjective>1. í•™ìŠµ ëª©í‘œ(Objective)</h3><table><thead><tr><th>í•­ëª©</th><th>ë‚´ìš©</th><th>ê·¼ê±°</th></tr></thead><tbody><tr><td><strong>ëª¨ë¸ë§ ëª©í‘œ</strong></td><td><strong>Causal LM</strong> â€“ ë‹¤ìŒ í† í°ì— ëŒ€í•œ <strong>cross-entropy</strong> ìµœì†Œí™”</td><td>ëª¨ë¸ í‰ê°€ ì‹œ _Pile_ì— â€œcross-entropy lossâ€ ì‚¬ìš© ì–¸ê¸‰ â†’ ì‚¬ì „í•™ìŠµë„ ë™ì¼ ëª©í‘œ</td></tr><tr><td><strong>ë§ˆìŠ¤í¬ ë°©ì‹</strong></td><td>GPT-ë¥˜ <strong>ì¢Œí•˜ì‚¼ê°(autoregressive) ë§ˆìŠ¤í¬</strong></td><td>Transformer decoder-only êµ¬ì¡° ì„¤ëª…ì— ê¸°ë°˜</td></tr><tr><td><strong>ê· í˜• ë¡œìŠ¤</strong></td><td>Expert-/Device-level <strong>Load-Balance Loss</strong> ì¶”ê°€ (MoE ì•ˆì •í™”)</td><td>ìˆ˜ì‹ (12)â€“(17) ì— ì •ì˜</td></tr></tbody></table><hr><h3 id=2-ì‚¬ì „í•™ìŠµ-ì½”í¼ìŠ¤>2. ì‚¬ì „í•™ìŠµ ì½”í¼ìŠ¤</h3><table><thead><tr><th>ë²”ì£¼</th><th>ê·œëª¨Â·íŠ¹ì§•</th><th>ì¶œì²˜</th></tr></thead><tbody><tr><td><strong>ì´ í† í°</strong></td><td><strong>2 T</strong> tokens (16 B ëª¨ë¸Â·145 B ì˜ˆë¹„), 100 B tokens (2 B ê²€ì¦)</td><td></td></tr><tr><td><strong>ì–¸ì–´ êµ¬ì„±</strong></td><td><strong>ì˜Â·ì¤‘ ì´ì¤‘ì–¸ì–´</strong> ì¤‘ì‹¬ + ì½”ë“œÂ·ìˆ˜í•™Â·ë¬¸í•™ Â·ì›¹ í…ìŠ¤íŠ¸</td><td></td></tr><tr><td><strong>í† í¬ë‚˜ì´ì €</strong></td><td>HF BPE, 8 K vocab(2 B) â†’ <strong>100 K vocab(16 B+)</strong></td><td></td></tr></tbody></table><blockquote class="border-primary bg-muted/30 hover:bg-muted/40 my-6 rounded-r-lg border-l-4 py-4 pr-4 pl-6 italic transition-all duration-200 ease-out hover:translate-x-1"><div class="prose prose-sm max-w-none"><p><em>Dedup Â· Unicode NFKC Â· HTML strip</em> ë“± í‘œì¤€ ì •ì œ ì ˆì°¨ í›„ ìƒ˜í”Œë§í•˜ì—¬ í† í¬ë‚˜ì´ì € í•™ìŠµ ë° ì „ì²´ ì½”í¼ìŠ¤ì— ì ìš©(ë…¼ë¬¸ 4.1.1).</p></div></blockquote><hr><h3 id=3-pre-training-í•˜ì´í¼íŒŒë¼ë¯¸í„°-16-b-ê¸°ì¤€>3. Pre-training í•˜ì´í¼íŒŒë¼ë¯¸í„° (16 B ê¸°ì¤€)</h3><table><thead><tr><th>í•­ëª©</th><th>ê°’</th><th>ì¶œì²˜</th></tr></thead><tbody><tr><td>Optimizer</td><td><strong>AdamW</strong> (Î²â‚ = 0.9, Î²â‚‚ = 0.95, wd = 0.1)</td><td></td></tr><tr><td>LR ìŠ¤ì¼€ì¤„</td><td><strong>Warm-up 2 K step â†’ step-decay Ã—0.316 at 80 % & 90 %</strong><br>LR-max 4.2 e-4</td><td></td></tr><tr><td>Batch</td><td>4 .5 K ì‹œí€€ìŠ¤ Ã— 4 K í† í° = <strong>18 M í† í°/step</strong></td><td></td></tr><tr><td>Steps</td><td><strong>106 449</strong> (= 2 T tokens)</td><td></td></tr><tr><td>Dropout</td><td><strong>ì—†ìŒ</strong> (ëŒ€ê·œëª¨ ë°ì´í„°ë¡œ ëŒ€ì²´)</td><td></td></tr><tr><td>Grad Clip</td><td>1.0 â€†â€†â€†</td><td></td></tr><tr><td>ë³‘ë ¬í™”</td><td><strong>íŒŒì´í”„ë¼ì¸ ë³‘ë ¬</strong>(ì¸µ ë‹¨ìœ„) + ê° ì¸µ ë‚´ ì „ë¬¸ê°€ë¥¼ ë™ì¼ GPU ë°°ì¹˜</td><td></td></tr></tbody></table><hr><h3 id=4-ë‹¤ìš´ìŠ¤íŠ¸ë¦¼-íŒŒì¸íŠœë‹-ì „ëµ>4. ë‹¤ìš´ìŠ¤íŠ¸ë¦¼ íŒŒì¸íŠœë‹ ì „ëµ</h3><table><thead><tr><th>ë‹¨ê³„</th><th>ì„¤ì •</th><th>ì£¼ìš” ìˆ˜ì¹˜</th><th>ê·¼ê±°</th></tr></thead><tbody><tr><td><strong>ë°ì´í„°</strong></td><td><strong>1.4 M</strong> instruction pairs (EN + ZH)</td><td>ìˆ˜í•™Â·ì½”ë“œÂ·QAÂ·ìš”ì•½ ë“± ë‹¤ë„ë©”ì¸</td><td></td></tr><tr><td><strong>ëª¨ë¸</strong></td><td>DeepSeekMoE <strong>16 B</strong> â†’ <strong>Chat 16 B</strong></td><td></td><td></td></tr><tr><td><strong>ë°©ë²•</strong></td><td><strong>Supervised Fine-Tuning(SFT)</strong></td><td>8 epoch Â· batch 1024 ì˜ˆì‹œ<br>max seq 4 K, ì˜ˆì‹œ packing ì‚¬ìš©</td><td></td></tr><tr><td><strong>Optimizer</strong></td><td>AdamW, <strong>LR 1 e-5 ê³ ì •</strong>, Dropout 0</td><td></td><td></td></tr><tr><td><strong>ì •ë ¬(alignment)</strong></td><td>ë³„ë„ RLHF/LoRA ì—†ìŒ â€“ SFT ë§Œìœ¼ë¡œë„ LLaMA-2 7 B ìˆ˜ì¤€ ë‹¬ì„±</td><td></td><td></td></tr></tbody></table><hr><h3 id=5-ìµœì í™”-í¬ì¸íŠ¸--ì‹¤ë¬´-íŒ>5. ìµœì í™” í¬ì¸íŠ¸ & ì‹¤ë¬´ íŒ</h3><ul><li><strong>ëª¨ë¸â€“ë°ì´í„° ìŠ¤ì¼€ì¼ ë§ì¶¤</strong> â€“ 2 T tokensÂ·100 K vocabìœ¼ë¡œ <em>context diversity</em> í™•ë³´ â†’ Load-Balance Lossê°€ ì „ë¬¸ê°€ í¸ì¤‘ ë§‰ìŒ.</li><li><strong>ê³ ì • LR SFT</strong> â€“ MoE-FFNì´ ì´ë¯¸ ì¼ë¶€ freeze-like íš¨ê³¼ë¥¼ ê°–ê¸° ë•Œë¬¸ì— ì‘ì€ LR 1 e-5ë¡œë„ ê³¼ì í•© ì—†ì´ ìˆ˜ë ´.</li><li><strong>Pipeline parallel + ì „ë¬¸ê°€ ë‹¨ì¼ GPU ë°°ì¹˜</strong> â€“ ë¼ìš°íŒ…-í†µì‹  ìµœì†Œí™”; ì‹¤í—˜ì ìœ¼ë¡œ A100-40 GB 1 GPUì—ì„œë„ ì¶”ë¡  ê°€ëŠ¥(ì €ì ì–¸ê¸‰).</li></ul><blockquote class="border-primary bg-muted/30 hover:bg-muted/40 my-6 rounded-r-lg border-l-4 py-4 pr-4 pl-6 italic transition-all duration-200 ease-out hover:translate-x-1"><div class="prose prose-sm max-w-none"><p>ì´ì™€ ê°™ì´ <strong>Causal LM + ëŒ€ê·œëª¨ ì´ì¤‘ì–¸ì–´ ì½”í¼ìŠ¤ + ê°„ë‹¨ SFT</strong> ì¡°í•©ë§Œìœ¼ë¡œ, Chat 16 BëŠ” <strong>Dense 7 B ëŒ€ë¹„ ~40 % FLOPs</strong> ë¡œ ìœ ì‚¬ ì„±ëŠ¥ì„ ë‹¬ì„±í•œë‹¤.</p></div></blockquote><h1 id=êµ¬í˜„-ë°-ìì›>êµ¬í˜„ ë° ìì›</h1><div class="code-block-container border-border bg-card my-6 overflow-hidden rounded-xl border shadow-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:shadow-md"><div class="code-block-header bg-muted/30 border-border flex items-center justify-between border-b px-4 py-3"><div class="flex items-center gap-2"><div class="text-muted-foreground flex-shrink-0"><svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4 4 4-4 4M6 16l-4-4 4-4"/></svg></div><span class="text-muted-foreground text-sm font-medium">PLAINTEXT</span></div><div class="flex items-center gap-2"><button class="collapse-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-18 data-default-state=expanded data-collapsed=false data-auto-collapse-lines=30 data-auto-collapse-height=400 data-collapsed-height=120 title=ì ‘ê¸° aria-label=ì ‘ê¸°>
<span class=collapse-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41 12 10.83l4.59 4.58L18 14l-6-6-6 6z"/></svg>
</span><span class="collapse-text hidden sm:inline">ì ‘ê¸°</span>
</button>
<button class="copy-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-18 title=ë³µì‚¬ aria-label=ë³µì‚¬>
<span class=copy-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/></svg>
</span><span class="copy-text hidden sm:inline">ë³µì‚¬</span></button></div></div><div class="code-block-content relative" id=code-18><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=ln>1</span><span class=cl>&#34;í•µì‹¬ ì†Œí”„íŠ¸ì›¨ì–´ ì˜ì¡´ì„±(ì˜ˆ: CUDA, MPI, íŠ¹ì • ë¼ì´ë¸ŒëŸ¬ë¦¬)ì€ ë¬´ì—‡ì¸ê°€? í•™ìŠµ ë° ì¶”ë¡  ì¤‘ ì˜ˆìƒë˜ëŠ” ë©”ëª¨ë¦¬ ì ìœ ëŸ‰(GPUì˜ ê²½ìš° VRAM, CPUì˜ ê²½ìš° RAM)ì€ ì–¼ë§ˆì¸ê°€? ëª…ì‹œëœ í•˜ë“œì›¨ì–´ì—ì„œì˜ ì²˜ë¦¬ëŸ‰(throughput)ì€ ì–¼ë§ˆì¸ê°€(ì˜ˆ: images/sec, tokens/sec)? ì´ ì—°ì‚° ë¹„ìš©(ì˜ˆ: ì´ FLOPs ë˜ëŠ” Petaflop-days)ì— ëŒ€í•œ ìƒì„¸í•œ ë‚´ì—­ì„ ì œê³µí•´ ì¤˜.&#34;</span></span></code></pre></div><div class="collapse-overlay to-card/90 pointer-events-none absolute inset-0 bg-gradient-to-b from-transparent via-transparent opacity-0 transition-opacity duration-300"><div class="text-muted-foreground bg-card/80 border-border/50 hover:bg-primary/10 hover:text-primary hover:border-primary/30 absolute bottom-4 left-1/2 -translate-x-1/2 cursor-pointer rounded-full border px-3 py-1.5 text-xs backdrop-blur-sm transition-all duration-200">í´ë¦­í•˜ì—¬ ë” ë³´ê¸°</div></div></div></div><script>(function(){const s="code-18",n=document.querySelector('.copy-code-btn[data-code-id="'+s+'"]'),t=document.querySelector('.collapse-code-btn[data-code-id="'+s+'"]'),e=document.getElementById(s);if(!e)return;if(n){const s=n.querySelector(".copy-icon"),t=n.querySelector(".copy-text");n.addEventListener("click",async function(){try{let o="";const i=e.querySelector(".lntd:last-child code");if(i)o=i.textContent||i.innerText;else{const t=e.querySelector("code");if(t){const e=t.querySelector(".ln");if(e){const e=t.querySelectorAll(".cl");if(e.length>0)o=Array.from(e).map(e=>{const t=e.textContent||e.innerText;return t.replace(/\n+$/,"")}).join(`
`).replace(/\n+$/,"");else{const e=t.textContent||t.innerText;o=e.replace(/^\d+/gm,"").replace(/^\s+/gm,"")}}else o=t.textContent||t.innerText}else o=e.textContent||e.innerText}o=o.trim(),await navigator.clipboard.writeText(o),s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
</svg>`,t&&(t.textContent="ë³µì‚¬ë¨"),n.classList.add("text-green-600"),setTimeout(()=>{s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
</svg>`,t&&(t.textContent="ë³µì‚¬"),n.classList.remove("text-green-600")},2e3)}catch(o){console.error("å¤åˆ¶å¤±è´¥:",o);const s=document.createRange(),i=e.querySelector("code")||e;s.selectNodeContents(i);const n=window.getSelection();n.removeAllRanges(),n.addRange(s),t&&(t.textContent="ì„ íƒë¨"),setTimeout(()=>{t&&(t.textContent="ë³µì‚¬"),n.removeAllRanges()},2e3)}})}if(t){const d=t.querySelector(".collapse-icon"),c=t.querySelector(".collapse-text"),n=e.querySelector(".collapse-overlay");let s=e.querySelector("pre.chroma");s||(s=e.querySelector("pre"));const m=t.dataset.defaultState||"expanded",f=t.dataset.collapsed==="true",u=parseInt(t.dataset.autoCollapseLines)||30,h=parseInt(t.dataset.autoCollapseHeight)||400,p=parseInt(t.dataset.collapsedHeight)||120;let l=!1;function i(){const e=f||m==="collapsed"||a();e&&o(!0,!1)}function a(){if(s){const e=s.querySelectorAll(".line, .cl"),t=s.offsetHeight;return e.length>u||t>h}const t=e.offsetHeight;if(t>h)return!0;const n=e.textContent||e.innerText||"",o=n.split(`
`).length;return o>u}function o(s,o=!0){if(!n)return;l=s,s?(e.style.maxHeight=p+"px",e.style.overflow="hidden",n.style.opacity="1",n.style.pointerEvents="auto",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
</svg>`,c&&(c.textContent="í¼ì¹˜ê¸°"),t.title="í¼ì¹˜ê¸°"):(e.style.maxHeight="",e.style.overflow="",n.style.opacity="0",n.style.pointerEvents="none",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z"/></svg>`,c&&(c.textContent="ì ‘ê¸°"),t.title="ì ‘ê¸°"),o&&(e.style.transition="max-height 0.3s ease-out",setTimeout(()=>{e.style.transition=""},300))}function r(){o(!l,!0)}t.addEventListener("click",r),n&&n.addEventListener("click",()=>{l&&o(!1,!0)}),i()}})()</script><h2 id=ê²°ë¡ -í•œëˆˆì—-ìš”ì•½>ê²°ë¡  (í•œëˆˆì— ìš”ì•½)</h2><table><thead><tr><th>ëª¨ë¸</th><th>ê³µê°œëœ VRAM ìš”êµ¬</th><th>ì²˜ë¦¬ëŸ‰ (ì €ì ë³´ê³ )</th><th>ì´ FLOPs (ì‚¬ì „í•™ìŠµ)</th><th>PF-days*</th><th>í•µì‹¬ SW ìŠ¤íƒ</th></tr></thead><tbody><tr><td><strong>DeepSeekMoE 16B</strong></td><td>ë‹¨ì¼ A100-40GB GPUì—ì„œ ì¶”ë¡  ê°€ëŠ¥</td><td>7B dense ëŒ€ë¹„ â‰ˆ <strong>2.5 Ã—</strong> ë¹ ë¥¸ ì¶”ë¡ </td><td>74.4 T FLOPs/4k tok â‡’ <strong>37 Z FLOPs</strong>(2 T í† í°)</td><td><strong>â‰ˆ 431 PF-days</strong></td><td>PyTorch + HAI-LLM, CUDA 11.x, Triton ì»¤ë„</td></tr><tr><td><strong>DeepSeekMoE 145B</strong></td><td>(ë¯¸ê³µê°œÂ·ë‹¤ì¤‘ GPU) í™œì„± íŒŒë¼ë¯¸í„° 22.2 B â‰ˆ 45 GB FP16</td><td>ìˆ«ì ë¯¸ì œì‹œ</td><td>572.7 T FLOPs/4k tok â†’ <strong>35 Z FLOPs</strong>(245 B í† í°)</td><td><strong>â‰ˆ 406 PF-days</strong></td><td>ë™ì¼ ìŠ¤íƒ + íŒŒì´í”„ë¼ì¸Â·ì „ë¬¸ê°€ ë³‘ë ¬</td></tr></tbody></table><p>* 1 PF-day = 10Â¹âµ FLOPs Ã— 86 400 s.</p><hr><h3 id=1-ì†Œí”„íŠ¸ì›¨ì–´í”„ë ˆì„ì›Œí¬-ì˜ì¡´ì„±>1. ì†Œí”„íŠ¸ì›¨ì–´/í”„ë ˆì„ì›Œí¬ ì˜ì¡´ì„±</h3><ul><li><strong>PyTorch 2.x</strong> â€“ HAI-LLM í”„ë ˆì„ì›Œí¬ê°€ PyTorch ìœ„ì—ì„œ í…ì„œ/íŒŒì´í”„ë¼ì¸/ZeRO ë³‘ë ¬ì„ í†µí•©</li><li><strong>CUDA 11.x + Triton</strong> â€“ ê²Œì´íŒ…Â·ì „ë¬¸ê°€ ì„ íƒ ì—°ì‚°ì„ ë§ì¶¤ GPU ì»¤ë„ë¡œ êµ¬í˜„</li><li><strong>NCCL/Collective Comm.</strong> â€“ í…ì„œÂ·ì „ë¬¸ê°€ ë³‘ë ¬ í†µì‹ .</li><li><strong>Megatron-LM ë° PipeDream</strong> ìƒíƒœê³„ ì•„ì´ë””ì–´ë¥¼ ì°¨ìš©í•œ íŒŒì´í”„ë¼ì¸ ë³‘ë ¬ .</li><li><strong>AdamW(Decoupled Weight Decay)</strong> ìµœì í™” ë£¨í”„ .</li></ul><h3 id=2-ë©”ëª¨ë¦¬-ì†Œìš”-ì¶”ë¡ -ì¤‘ì‹¬>2. ë©”ëª¨ë¦¬ ì†Œìš” (ì¶”ë¡  ì¤‘ì‹¬)</h3><table><thead><tr><th>êµ¬ì„±</th><th>FP16 íŒŒë¼ë¯¸í„° ë©”ëª¨ë¦¬</th><th>í™œì„± íŒŒë¼ë¯¸í„°(ì¶”ë¡ ì‹œ)</th></tr></thead><tbody><tr><td>16B ëª¨ë¸ (ì´ 16.4 B)</td><td>â‰ˆ 31 GB</td><td>2.8 B â†’ â‰ˆ 5.6 GB</td></tr><tr><td>145B ëª¨ë¸ (ì´ 144.6 B)</td><td>â‰ˆ 289 GB</td><td>22.2 B â†’ â‰ˆ 44 GB</td></tr></tbody></table><p><em>16B ëŠ” ëª¨ë“  íŒŒë¼ë¯¸í„°Â·KV ìºì‹œ í¬í•¨ 40 GB GPUì— ì í•© .</em></p><h3 id=3-ì²˜ë¦¬ëŸ‰-ì§€í‘œ>3. ì²˜ë¦¬ëŸ‰ ì§€í‘œ</h3><ul><li><p><strong>ì¶”ë¡ </strong> â€“ DeepSeekMoE 16Bê°€ ë™ê¸‰ 7B dense ëª¨ë¸ë³´ë‹¤ <em>ì•½ 2.5ë°°</em> ë¹ ë¥¸ í† í° ìƒì„± ì†ë„(ë™ì¼ GPU) .</p></li><li><p><strong>í•™ìŠµ</strong> â€“ í•œ ìŠ¤í…ë‹¹ 18 M í† í°(4 k context, ë°°ì¹˜ 4.5 k) .</p><ul><li>ì´ë¡ ì  FLOPs â‰ˆ 74.4 T Ã— (18 M / 4 k) = ~336 P FLOPs/step.</li></ul></li><li><p><strong>Hydragen ë²¤ì¹˜ë§ˆí¬</strong>(ë³„ë„ ë…¼ë¬¸) â€“ A100-40GB 8 ì¥, CodeLlama-13B ë””ì½”ë”© 32 k tok/s ì´ìƒ (32.9 k tok/s @ bs 2048, 16 k prefix) .</p></li></ul><h3 id=4-ì´-ì—°ì‚°-ë¹„ìš©>4. ì´ ì—°ì‚° ë¹„ìš©</h3><ul><li>16B: 2 T í† í° Ã— 18.6 G FLOPs/token â‰ˆ <strong>3.7 Ã— 10Â²Â² FLOPs</strong> â‰… 431 PF-days.</li><li>145B: 245 B í† í° Ã— 143 G FLOPs/token â‰ˆ <strong>3.5 Ã— 10Â²Â² FLOPs</strong> â‰… 406 PF-days.</li></ul><h3 id=5-ì •ë¦¬>5. ì •ë¦¬</h3><ul><li><strong>ë©”ëª¨ë¦¬ íš¨ìœ¨</strong> â€“ ëª¨ë¸ ì´ëŸ‰ì€ ì¦ê°€í•˜ì§€ë§Œ MoE í™œì„± íŒŒë¼ë¯¸í„°ê°€ ì†Œìˆ˜ë¼ ì¶”ë¡  ì‹œ VRAM ìš”êµ¬ê°€ ê¸‰ê²©íˆ ì™„í™”(16B ë‹¨ì¼ GPU).</li><li><strong>ì—°ì‚° íš¨ìœ¨</strong> â€“ ë™ì¼ í•™ìŠµ í† í° ëŒ€ë¹„ Dense ëª¨ë¸ì˜ 40 % ë¯¸ë§Œì˜ FLOPsë¡œ ë™ê¸‰ ì„±ëŠ¥ ë‹¬ì„± .</li><li><strong>SW ìŠ¤íƒ</strong> â€“ ê¸°ì¡´ PyTorch + CUDA ìƒíƒœê³„ì— Triton-based ì»¤ë„ì„ ì–¹ì–´ <strong>ì „ë¬¸ê°€ ì„ íƒÂ·ë¡œë”©</strong> ì˜¤ë²„í—¤ë“œ ìµœì†Œí™”.</li></ul><p>ì´ìƒì˜ ìˆ˜ì¹˜ë“¤ì€ ì €ìê°€ ê³µê°œí•œ ê°’ê³¼ ë‹¨ìˆœ FP16 ê°€ì •ì— ê¸°ë°˜í•œ <strong>ë³´ìˆ˜ì  ì¶”ì •</strong>ì´ë‹¤. ë…¼ë¬¸ì—ì„œ ì§ì ‘ ì¸¡ì •í•œ ì´ˆ/í† í° ì²˜ë¦¬ëŸ‰ì€ ì œí•œì ìœ¼ë¡œë§Œ ì œê³µë˜ë¯€ë¡œ, ì‹¤ì œ ì—”ë“œíˆ¬ì—”ë“œ ì„±ëŠ¥ì€ í•˜ë“œì›¨ì–´Â·ë°°ì¹˜ ì „ëµì— ë”°ë¼ ë‹¬ë¼ì§ˆ ìˆ˜ ìˆë‹¤.</p><h1 id=í‰ê°€-ë°-ì§€í‘œ>í‰ê°€ ë° ì§€í‘œ</h1><div class="code-block-container border-border bg-card my-6 overflow-hidden rounded-xl border shadow-sm transition-all duration-200 ease-out hover:-translate-y-0.5 hover:shadow-md"><div class="code-block-header bg-muted/30 border-border flex items-center justify-between border-b px-4 py-3"><div class="flex items-center gap-2"><div class="text-muted-foreground flex-shrink-0"><svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4 4 4-4 4M6 16l-4-4 4-4"/></svg></div><span class="text-muted-foreground text-sm font-medium">PLAINTEXT</span></div><div class="flex items-center gap-2"><button class="collapse-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-19 data-default-state=expanded data-collapsed=false data-auto-collapse-lines=30 data-auto-collapse-height=400 data-collapsed-height=120 title=ì ‘ê¸° aria-label=ì ‘ê¸°>
<span class=collapse-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41 12 10.83l4.59 4.58L18 14l-6-6-6 6z"/></svg>
</span><span class="collapse-text hidden sm:inline">ì ‘ê¸°</span>
</button>
<button class="copy-code-btn text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium transition-all duration-200 ease-out focus:ring-2 focus:outline-none" data-code-id=code-19 title=ë³µì‚¬ aria-label=ë³µì‚¬>
<span class=copy-icon><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/></svg>
</span><span class="copy-text hidden sm:inline">ë³µì‚¬</span></button></div></div><div class="code-block-content relative" id=code-19><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=ln>1</span><span class=cl>&#34;í‰ê°€ë¥¼ ìœ„í•œ ì£¼ìš” ì§€í‘œëŠ” ë¬´ì—‡ì¸ê°€: ì§€ì—° ì‹œê°„(latency), ì²˜ë¦¬ëŸ‰(throughput), ì „ë ¥ ì†Œë¹„, ë˜ëŠ” ë¹„ìš© ëŒ€ë¹„ ì„±ëŠ¥? ì‹œìŠ¤í…œì€ ë” ë§ì€ ë°ì´í„°, ì‚¬ìš©ì, ë˜ëŠ” ì»´í“¨íŒ… ë…¸ë“œì— ë”°ë¼ ì–´ë–»ê²Œ í™•ì¥ë˜ëŠ”ê°€?&#34;</span></span></code></pre></div><div class="collapse-overlay to-card/90 pointer-events-none absolute inset-0 bg-gradient-to-b from-transparent via-transparent opacity-0 transition-opacity duration-300"><div class="text-muted-foreground bg-card/80 border-border/50 hover:bg-primary/10 hover:text-primary hover:border-primary/30 absolute bottom-4 left-1/2 -translate-x-1/2 cursor-pointer rounded-full border px-3 py-1.5 text-xs backdrop-blur-sm transition-all duration-200">í´ë¦­í•˜ì—¬ ë” ë³´ê¸°</div></div></div></div><script>(function(){const s="code-19",n=document.querySelector('.copy-code-btn[data-code-id="'+s+'"]'),t=document.querySelector('.collapse-code-btn[data-code-id="'+s+'"]'),e=document.getElementById(s);if(!e)return;if(n){const s=n.querySelector(".copy-icon"),t=n.querySelector(".copy-text");n.addEventListener("click",async function(){try{let o="";const i=e.querySelector(".lntd:last-child code");if(i)o=i.textContent||i.innerText;else{const t=e.querySelector("code");if(t){const e=t.querySelector(".ln");if(e){const e=t.querySelectorAll(".cl");if(e.length>0)o=Array.from(e).map(e=>{const t=e.textContent||e.innerText;return t.replace(/\n+$/,"")}).join(`
`).replace(/\n+$/,"");else{const e=t.textContent||t.innerText;o=e.replace(/^\d+/gm,"").replace(/^\s+/gm,"")}}else o=t.textContent||t.innerText}else o=e.textContent||e.innerText}o=o.trim(),await navigator.clipboard.writeText(o),s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
</svg>`,t&&(t.textContent="ë³µì‚¬ë¨"),n.classList.add("text-green-600"),setTimeout(()=>{s.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
</svg>`,t&&(t.textContent="ë³µì‚¬"),n.classList.remove("text-green-600")},2e3)}catch(o){console.error("å¤åˆ¶å¤±è´¥:",o);const s=document.createRange(),i=e.querySelector("code")||e;s.selectNodeContents(i);const n=window.getSelection();n.removeAllRanges(),n.addRange(s),t&&(t.textContent="ì„ íƒë¨"),setTimeout(()=>{t&&(t.textContent="ë³µì‚¬"),n.removeAllRanges()},2e3)}})}if(t){const d=t.querySelector(".collapse-icon"),c=t.querySelector(".collapse-text"),n=e.querySelector(".collapse-overlay");let s=e.querySelector("pre.chroma");s||(s=e.querySelector("pre"));const m=t.dataset.defaultState||"expanded",f=t.dataset.collapsed==="true",u=parseInt(t.dataset.autoCollapseLines)||30,h=parseInt(t.dataset.autoCollapseHeight)||400,p=parseInt(t.dataset.collapsedHeight)||120;let l=!1;function i(){const e=f||m==="collapsed"||a();e&&o(!0,!1)}function a(){if(s){const e=s.querySelectorAll(".line, .cl"),t=s.offsetHeight;return e.length>u||t>h}const t=e.offsetHeight;if(t>h)return!0;const n=e.textContent||e.innerText||"",o=n.split(`
`).length;return o>u}function o(s,o=!0){if(!n)return;l=s,s?(e.style.maxHeight=p+"px",e.style.overflow="hidden",n.style.opacity="1",n.style.pointerEvents="auto",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
</svg>`,c&&(c.textContent="í¼ì¹˜ê¸°"),t.title="í¼ì¹˜ê¸°"):(e.style.maxHeight="",e.style.overflow="",n.style.opacity="0",n.style.pointerEvents="none",d.innerHTML=`
  <svg class="h-3 w-3"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z"/></svg>`,c&&(c.textContent="ì ‘ê¸°"),t.title="ì ‘ê¸°"),o&&(e.style.transition="max-height 0.3s ease-out",setTimeout(()=>{e.style.transition=""},300))}function r(){o(!l,!0)}t.addEventListener("click",r),n&&n.addEventListener("click",()=>{l&&o(!1,!0)}),i()}})()</script><h2 id=-í•œì¤„-ê²°ë¡ -1>ğŸš¦ í•œì¤„ ê²°ë¡ </h2><p>DeepSeekMoEëŠ” **â€œì—°ì‚°ëŸ‰(FLOPs)Â·í™œì„± íŒŒë¼ë¯¸í„°Â·í† í°/ì´ˆ TPSâ€**ë¥¼ í•µì‹¬ íš¨ìœ¨ ì§€í‘œë¡œ ì‚¼ì•„ ì„±ëŠ¥ì„ í‰ê°€í•œë‹¤. 16 B ëª¨ë¸ ê¸°ì¤€, <strong>FLOPsëŠ” LLaMA-2 7 Bì˜ 39.6 %</strong>, <strong>ë‹¨ì¼ A100-40 GB ì¶”ë¡  TPSëŠ” â‰ˆ 2.5 Ã— â†‘</strong>, ê·¸ë¦¬ê³  <strong>GPU 40 GB VRAM ì•ˆì— íƒ‘ì¬</strong> ê°€ëŠ¥í•¨ì„ ë³´ì—¬ì£¼ë©°, 145 Bê¹Œì§€ í™•ì¥í•´ë„ Dense 67 B ëŒ€ë¹„ <strong>ê³„ì‚° 28.5 %</strong> ë§Œìœ¼ë¡œ ë™ê¸‰ ì„±ëŠ¥ì„ ìœ ì§€í•œë‹¤.</p><hr><h3 id=1-í‰ê°€ì—-ì‚¬ìš©ëœ-í•µì‹¬-ì‹œìŠ¤í…œ-ì§€í‘œ>1. í‰ê°€ì— ì‚¬ìš©ëœ í•µì‹¬ ì‹œìŠ¤í…œ ì§€í‘œ</h3><table><thead><tr><th>ì§€í‘œ</th><th>ì •ì˜ & ì¸¡ì •ë²•</th><th>ëŒ€í‘œ ìˆ˜ì¹˜ (DeepSeekMoE 16 B)</th><th>ë…¼ë¬¸ ë‚´ ìœ„ì¹˜</th></tr></thead><tbody><tr><td><strong>FLOPs/4 K tok</strong></td><td>1 ì‹œí€€ìŠ¤(4 k í† í°) ì²˜ë¦¬ì— í•„ìš”í•œ ì´ ë¶€ë™ì†Œìˆ˜ì  ì—°ì‚°</td><td><strong>74.4 T</strong> (Dense 7 B : 187.9 T â†’ 39.6 %)</td><td>Tab. 4</td></tr><tr><td><strong>Activated Params</strong></td><td>ì¶”ë¡  ì‹œ ì‹¤ì œ ê³„ì‚°ì— ì°¸ì—¬í•˜ëŠ” íŒŒë¼ë¯¸í„° ì–‘</td><td><strong>2.8 B</strong> (ì´ 16.4 Bì˜ 17 %)</td><td>Tab. 4</td></tr><tr><td><strong>í† í°/ì´ˆ TPS (Throughput)</strong></td><td>ë‹¨ì¼ GPUì—ì„œ ì´ˆë‹¹ ìƒì„± í† í°</td><td><strong>Dense 7 B ëŒ€ë¹„ â‰ˆ 2.5 Ã—</strong> ë¹ ë¦„</td><td>ë³¸ë¬¸ Â§5.2</td></tr><tr><td><strong>Latency</strong></td><td>1 í† í° ìƒì„± ì‹œê°„(=1/TPS) â€“ í‘œê¸° ëŒ€ì‹  TPSë¡œ ê°„ì ‘ ì œì‹œ</td><td>2.5 Ã— ì†ë„ í–¥ìƒ â†’ ì§€ì—° â‰ˆ 0.4 Ã—</td><td>Â§5.2</td></tr><tr><td><strong>VRAM</strong></td><td>FP16 íŒŒë¼ë¯¸í„° + KV ìºì‹œ ì ìœ </td><td><strong>â‰¤ 40 GB</strong> GPU ë‹¨ì¼ ì¹´ë“œ íƒ‘ì¬ ê°€ëŠ¥</td><td>Â§6.1</td></tr><tr><td><strong>ì´ í›ˆë ¨ FLOPs</strong></td><td>í† í° ìˆ˜ Ã— FLOPs/token</td><td><strong>â‰ˆ 3.7 Ã— 10Â²Â²</strong> (431 PF-days)</td><td>ë¶€ë¡ C</td></tr><tr><td><strong>ìŠ¤ì¼€ì¼ íš¨ìœ¨</strong></td><td>GPU ìˆ˜ â†‘ ì‹œ ì¥ë²½ ìš”ì†Œ â€“ All-to-All í†µì‹  & Load-Balance Loss</td><td>ExpertÂ·Device FLOPs í¸ì°¨ <strong>&lt; 5 %</strong> ìœ ì§€</td><td>ì‹ 15â€’17</td></tr></tbody></table><blockquote class="border-primary bg-muted/30 hover:bg-muted/40 my-6 rounded-r-lg border-l-4 py-4 pr-4 pl-6 italic transition-all duration-200 ease-out hover:translate-x-1"><div class="prose prose-sm max-w-none"><p>âš¡ <strong>ì „ë ¥Â·íƒ„ì†Œ</strong> ìˆ˜ì¹˜ëŠ” ì§ì ‘ ë³´ê³ ë˜ì§€ ì•Šì§€ë§Œ, ë™ì¼ íƒœìŠ¤í¬ FLOPsê°€ 60 %â†“ì´ë¯€ë¡œ <strong>ì—ë„ˆì§€Â·ë¹„ìš©ë„ ì„ í˜• ì ˆê°</strong>ìœ¼ë¡œ ì¶”ì • ê°€ëŠ¥.</p></div></blockquote><hr><h3 id=2-ì²˜ë¦¬ëŸ‰tpsì§€ì—°-ì‹œê°„latency>2. ì²˜ë¦¬ëŸ‰(TPS)Â·ì§€ì—° ì‹œê°„(latency)</h3><ul><li><strong>ë‹¨ì¼ A100-40 GB</strong>: MoE 16 BëŠ” ë™ì¼ í•˜ë“œì›¨ì–´ì—ì„œ <strong>Dense 7 B ëŒ€ë¹„ â‰ˆ 2.5 Ã— TPS</strong> â†’ í† í°ë‹¹ ì§€ì—° ì‹œê°„ 60 % ê°ì†Œ</li><li><strong>ë‹¤ì¤‘ GPU</strong>: HAI-LLM í”„ë ˆì„ì›Œí¬ë¡œ <strong>íŒŒì´í”„ë¼ì¸â€†+â€†ì „ë¬¸ê°€ ë³‘ë ¬</strong>ì„ ê²°í•©í•˜ê³ , <em>Device-level balance loss</em> ë¡œ ê° GPU FLOPs ì˜¤ì°¨ë¥¼ 5 % ì´ë‚´ë¡œ ì œí•œí•´ <strong>ì„ í˜•ì— ê°€ê¹Œìš´ ìŠ¤ë£¨í’‹ ìŠ¤ì¼€ì¼ë§</strong>ì„ í™•ì¸ .</li></ul><hr><h3 id=3-ë¹„ìš©-ëŒ€-ì„±ëŠ¥-flopsíŒŒë¼ë¯¸í„°-ì ˆê°>3. ë¹„ìš©-ëŒ€-ì„±ëŠ¥ (FLOPsÂ·íŒŒë¼ë¯¸í„° ì ˆê°)</h3><table><thead><tr><th>ë¹„êµ</th><th>ì—°ì‚°ëŸ‰(FLOPs)</th><th>í™œì„± íŒŒë¼ë¯¸í„°</th><th>ì„±ëŠ¥</th></tr></thead><tbody><tr><td><strong>MoE 16 B vs Dense 7 B</strong></td><td><strong>0.396 Ã—</strong></td><td>0.42 Ã—</td><td>10 ê°œ ë²¤ì¹˜ ì¤‘ 7 ê°œ ìš°ì„¸</td></tr><tr><td><strong>MoE 145 B vs Dense 67 B</strong></td><td><strong>0.285 Ã—</strong></td><td>0.32 Ã—</td><td>ëŒ€ë‹¤ìˆ˜ íƒœìŠ¤í¬ ë™ê¸‰</td></tr></tbody></table><hr><h3 id=4-í™•ì¥ì„±scaling-ê´€ì°°>4. í™•ì¥ì„±(Scaling) ê´€ì°°</h3><table><thead><tr><th>ì¶•</th><th>ê´€ì°° ê²°ê³¼</th><th>ê·¼ê±°</th></tr></thead><tbody><tr><td><strong>ë°ì´í„° í† í° â†‘</strong></td><td>0 â†’ 2 T í† í° í•™ìŠµ ê³¡ì„ ì´ Dense 7 Bì™€ ìœ ì‚¬í•œ ê¸°ìš¸ê¸° â†’ <strong>ë°ì´í„° íš¨ìœ¨ ì†ì‹¤ ç„¡</strong></td><td></td></tr><tr><td><strong>ì „ë¬¸ê°€ ì„¸ë¶„í™”(m) â†‘</strong></td><td>2 â†’ 4 â†’ 8 ì„¸ë¶„í™” ì‹œ ì •ê·œí™” ì„±ëŠ¥ +20 % ìƒìŠ¹, FLOPs ê±°ì˜ ë™ì¼</td><td>Fig. 3 Ablation (ë³¸ë¬¸)</td></tr><tr><td><strong>GPU ë…¸ë“œ â†‘</strong></td><td>ExpertÂ·Device dual lossë¡œ <strong>ë¼ìš°íŒ… ë¶•ê´´ ì—†ì´ 145 B / 128 expert</strong>ê¹Œì§€ í™•ì¥</td><td>ì‹ 12â€’17 + Â§7</td></tr><tr><td><strong>ë™ì‹œ ì‚¬ìš©ì â†‘</strong></td><td>í™œì„± íŒŒë¼ë¯¸í„° ì ì–´ <strong>KV ìºì‹œê°€ ì‘ê³  TPSâ†‘</strong> â†’ ë™ì‹œ ìš”ì²­ ì²˜ë¦¬ëŸ‰ ìš°ìˆ˜(2.5 Ã—)</td><td></td></tr></tbody></table><hr><h3 id=5-ëˆ„ë½ëœì œí•œì -ì§€í‘œ>5. ëˆ„ë½ëœ/ì œí•œì  ì§€í‘œ</h3><ul><li><strong>ì „ë ¥(W)Â·íƒ„ì†Œ(g COâ‚‚e)</strong>: ë…¼ë¬¸ì— ì§ì ‘ ìˆ˜ì¹˜ëŠ” ì—†ìœ¼ë‚˜, FLOPs â†“ ë¹„ë¡€ ì ˆê°ìœ¼ë¡œ ì¶”ì •.</li><li><strong>P99 Latency</strong>: í‰ê·  TPSë§Œ ë³´ê³ , tail-latency ì¸¡ì •ì€ ë¯¸ì œê³µ.</li><li><strong>Dollar-per-Token</strong>: í´ë¼ìš°ë“œ ë¹„ìš© ëª¨ë¸ì„ ì œê³µí•˜ì§€ ì•ŠìŒ.</li></ul><hr><h3 id=6-ìš”ì•½--ì‹¤ë¬´-ì‹œì‚¬ì >6. ìš”ì•½ & ì‹¤ë¬´ ì‹œì‚¬ì </h3><ol><li><strong>í‰ê°€ í•µì‹¬</strong> = <em>FLOPs, Activated-Params, TPS</em> + (ê°„ì ‘) Latency.</li><li><strong>16 B ëª¨ë¸</strong>ì€ Dense 7 Bì™€ ë™ê¸‰ í’ˆì§ˆì„ <strong>ì—°ì‚°Â·ë©”ëª¨ë¦¬ 40 % ìˆ˜ì¤€</strong>ìœ¼ë¡œ ë‹¬ì„±, ë‹¨ì¼ 40 GB GPU ì¶”ë¡  ê°€ëŠ¥.</li><li><strong>145 B ìŠ¤ì¼€ì¼</strong>ì—ì„œë„ ê³„ì‚° 28.5 %ë¡œ Dense 67 Bë¥¼ ì¬í˜„, <strong>ë¡œë“œ ë°¸ëŸ°ìŠ¤ ì†ì‹¤ &lt; 5 %</strong>.</li><li><strong>ì¶”ê°€ ì¸¡ì •ì´ í•„ìš”í•œ ë¶€ë¶„</strong>: ì‹¤ì œ ì „ë ¥Â·ë¹„ìš©, tail latency, ëŒ€ê·œëª¨ ë°°ì¹˜ ì‹œ í†µì‹  ë³‘ëª©.</li></ol><blockquote class="border-primary bg-muted/30 hover:bg-muted/40 my-6 rounded-r-lg border-l-4 py-4 pr-4 pl-6 italic transition-all duration-200 ease-out hover:translate-x-1"><div class="prose prose-sm max-w-none"><p>ğŸ“Œ <strong>ê²°ë¡ </strong>â€ƒDeepSeekMoEëŠ” â€œFLOPs ì ˆê° = ë¹„ìš©Â·ì „ë ¥â†“, í™œì„± íŒŒë¼ë¯¸í„°â†“ = VRAMâ†“, TPSâ†‘â€ ë¥¼ ë™ì‹œì— ë‹¬ì„±í•˜ë©°, ê· í˜• lossì™€ íŒŒì´í”„ë¼ì¸ ë³‘ë ¬ë¡œ ë…¸ë“œÂ·ë°ì´í„° ìŠ¤ì¼€ì¼ì—ë„ ê²¬ê³ í•˜ê²Œ í™•ì¥ëœë‹¤.</p></div></blockquote></details></article></main><footer class="mx-auto max-w-4xl px-4 py-8"><div class="px-6 py-6"><nav class=mb-6><div class="flex flex-wrap items-center justify-center gap-1"><a href=/index.xml class="nav-link hover:text-primary hover:bg-primary/10 text-muted-foreground flex items-center gap-2 rounded-lg px-4 py-2 text-sm font-medium transition-all duration-300 hover:scale-105"><svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="RSS Feed"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 5c7.18.0 13 5.82 13 13M6 11a7 7 0 017 7m-6 0a1 1 0 11-2 0 1 1 0 012 0z"/></svg>
<span>RSS Feed</span></a></div></nav><div class="border-border mb-6 border-t"></div><div class="flex flex-col items-center justify-between gap-4 md:flex-row"><div class="text-muted-foreground text-sm"><p>&copy; 2025 Jaehun's Blog.
ëª¨ë“  ê¶Œë¦¬ ë³´ìœ .</p></div><div class="flex items-center gap-3"><a href=https://github.com/ryujaehun target=_blank rel="noopener noreferrer" class="text-muted-foreground hover:text-primary focus:ring-primary/20 rounded-lg p-1 transition-all duration-300 ease-out hover:scale-110 focus:ring-2 focus:outline-none" title=GitHub aria-label=GitHub><svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="GitHub"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"><path d="M15 22v-4a4.8 4.8.0 00-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35.0-3.5.0.0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35.0 3.5A5.4 5.4.0 004 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65S8.93 17.38 9 18v4"/><path d="M9 18c-4.51 2-5-2-7-2"/></g></svg>
</a><a href=https://www.linkedin.com/in/jaehunryu/ target=_blank rel="noopener noreferrer" class="text-muted-foreground hover:text-primary focus:ring-primary/20 rounded-lg p-1 transition-all duration-300 ease-out hover:scale-110 focus:ring-2 focus:outline-none" title=Linkedin aria-label=Linkedin><svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="Linkedin"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"><path d="M16 8a6 6 0 016 6v7h-4v-7a2 2 0 00-2-2 2 2 0 00-2 2v7h-4v-7a6 6 0 016-6M2 9h4v12H2z"/><circle cx="4" cy="4" r="2"/></g></svg>
</a><a href=mailto:jaehunryu@icloud.com class="text-muted-foreground hover:text-primary focus:ring-primary/20 rounded-lg p-1 transition-all duration-300 ease-out hover:scale-110 focus:ring-2 focus:outline-none" title=Email aria-label=Email><svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-label="Email"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22.0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5A2 2 0 003 7v10a2 2 0 002 2z"/></svg></a></div></div></div></footer><div id=dock class="pointer-events-none fixed bottom-4 left-1/2 z-[9999] w-fit -translate-x-1/2 translate-y-24 opacity-0 transition-all duration-300 ease-out sm:right-0 sm:left-0 sm:mx-auto sm:translate-x-0" role=toolbar aria-label="ë°”ë¡œê°€ê¸° ë„êµ¬ ëª¨ìŒ"><nav class="border-border bg-card/80 scrollbar-hide xs:px-3 xs:py-2 mx-auto flex max-w-[calc(100vw-2rem)] min-w-fit items-center justify-center overflow-x-auto rounded-2xl border px-4 py-3 shadow-lg backdrop-blur-sm sm:px-4 sm:py-3"><button id=dock-back class="text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 xs:px-2 xs:py-1.5 flex flex-shrink-0 items-center gap-2 rounded-lg px-3 py-2 text-sm font-medium transition-all duration-300 ease-out hover:-translate-y-0.5 hover:scale-105 focus:ring-2 focus:outline-none sm:px-3 sm:py-2" title=ë’¤ë¡œ aria-label=ë’¤ë¡œ>
<svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="m12 19-7-7 7-7"/><path d="M19 12H5"/></svg>
<span class="hidden sm:inline">ë’¤ë¡œ</span></button><div class="bg-border xs:mx-1 mx-2 h-6 w-px sm:mx-2"></div><button id=dock-toc class="text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 xs:px-2 xs:py-1.5 flex flex-shrink-0 items-center gap-2 rounded-lg px-3 py-2 text-sm font-medium transition-all duration-300 ease-out hover:-translate-y-0.5 hover:scale-105 focus:ring-2 focus:outline-none sm:px-3 sm:py-2" title=ëª©ì°¨ aria-label=ëª©ì°¨>
<svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><line x1="8" x2="21" y1="6" y2="6"/><line x1="8" x2="21" y1="12" y2="12"/><line x1="8" x2="21" y1="18" y2="18"/><line x1="3" x2="3.01" y1="6" y2="6"/><line x1="3" x2="3.01" y1="12" y2="12"/><line x1="3" x2="3.01" y1="18" y2="18"/></svg>
<span class="hidden sm:inline">ëª©ì°¨</span></button><div class="bg-border xs:mx-1 mx-2 h-6 w-px sm:mx-2"></div><button id=dock-search class="text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 xs:px-3 xs:py-1.5 flex flex-shrink-0 items-center gap-2 rounded-lg px-4 py-2 text-sm font-medium transition-all duration-300 ease-out hover:-translate-y-0.5 hover:scale-105 focus:ring-2 focus:outline-none sm:px-4 sm:py-2" title=ê²€ìƒ‰ aria-label=ê²€ìƒ‰>
<svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m21 21-6-6m2-5A7 7 0 113 10a7 7 0 0114 0z"/></svg>
<span class="hidden md:inline">ê²€ìƒ‰</span></button><div class="bg-border xs:mx-1 mx-2 h-6 w-px sm:mx-2"></div><button id=dock-top class="text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 xs:px-2 xs:py-1.5 flex flex-shrink-0 items-center gap-2 rounded-lg px-3 py-2 text-sm font-medium transition-all duration-300 ease-out hover:-translate-y-0.5 hover:scale-105 focus:ring-2 focus:outline-none sm:px-3 sm:py-2" title="ë§¨ ìœ„ë¡œ" aria-label="ë§¨ ìœ„ë¡œ">
<svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="m18 15-6-6-6 6"/></svg>
<span class="hidden sm:inline">ë§¨ ìœ„ë¡œ</span></button></nav></div><div id=toc-overlay class="pointer-events-none fixed inset-0 z-40 bg-black/50 opacity-0 backdrop-blur-sm transition-all duration-300" role=dialog aria-modal=true aria-labelledby=toc-title></div><div id=toc-card class="pointer-events-none fixed inset-4 z-50 flex w-auto scale-95 items-center justify-center opacity-0 transition-all duration-300 sm:inset-auto sm:top-1/2 sm:left-1/2 sm:block sm:w-full sm:max-w-md sm:-translate-x-1/2 sm:-translate-y-1/2" role=dialog aria-modal=true aria-labelledby=toc-title><div class="bg-card border-border w-full max-w-sm overflow-hidden rounded-xl border shadow-xl sm:max-w-md"><div class="border-border bg-muted/30 flex items-center justify-between border-b p-4"><div class="flex items-center gap-3"><svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><line x1="8" x2="21" y1="6" y2="6"/><line x1="8" x2="21" y1="12" y2="12"/><line x1="8" x2="21" y1="18" y2="18"/><line x1="3" x2="3.01" y1="6" y2="6"/><line x1="3" x2="3.01" y1="12" y2="12"/><line x1="3" x2="3.01" y1="18" y2="18"/></svg><h2 id=toc-title class="text-foreground text-lg font-semibold">ëª©ì°¨</h2></div><button id=toc-close class="text-muted-foreground hover:text-primary hover:bg-primary/10 focus:ring-primary/20 rounded-lg p-2 transition-all duration-200 ease-out hover:-translate-y-0.5 hover:scale-105 focus:ring-2 focus:outline-none" title=ë‹«ê¸° aria-label=ë‹«ê¸°>
<svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18 18 6M6 6l12 12"/></svg></button></div><div class="max-h-96 overflow-y-auto p-4"><nav id=toc-nav class=toc-scrollbar aria-label="ê¸€ ëª©ì°¨"><div id=toc-content><nav id=TableOfContents><ul><li><a href=#í•œ-ì¤„-ìš”ì•½-tldr>í•œ ì¤„ ìš”ì•½ (TL;DR)</a></li><li><a href=#í•µì‹¬-ì•„ì´ë””ì–´>í•µì‹¬ ì•„ì´ë””ì–´</a></li><li><a href=#ë°°ê²½-ê·¸ë“¤ì´-í•´ê²°í•œ-ë¬¸ì œ>ë°°ê²½: ê·¸ë“¤ì´ í•´ê²°í•œ ë¬¸ì œ</a></li><li><a href=#ìƒˆë¡œìš´-ì ‘ê·¼ë²•-deepseekmoe>ìƒˆë¡œìš´ ì ‘ê·¼ë²•: <strong>DeepSeekMoE</strong></a></li><li><a href=#ì‘ë™-ì›ë¦¬-êµ¬ì²´ì ì¸-ì˜ˆì‹œë¡œ-ì‚´í´ë³´ê¸°>ì‘ë™ ì›ë¦¬: êµ¬ì²´ì ì¸ ì˜ˆì‹œë¡œ ì‚´í´ë³´ê¸°</a></li><li><a href=#ì„±ëŠ¥-ê²€ì¦-ì£¼ìš”-ê²°ê³¼>ì„±ëŠ¥ ê²€ì¦: ì£¼ìš” ê²°ê³¼</a></li><li><a href=#ìš°ë¦¬ì˜-ê´€ì -ê°•ì -í•œê³„-ê·¸ë¦¬ê³ -ì´-ì—°êµ¬ê°€-ì¤‘ìš”í•œ-ì´ìœ >ìš°ë¦¬ì˜ ê´€ì : ê°•ì , í•œê³„, ê·¸ë¦¬ê³  ì´ ì—°êµ¬ê°€ ì¤‘ìš”í•œ ì´ìœ </a><ul><li><a href=#-ê°•ì >ğŸ‘ ê°•ì </a></li><li><a href=#-í•œê³„>âš ï¸ í•œê³„</a></li><li><a href=#-ì™œ-ì¤‘ìš”í•œê°€>ğŸŒŸ ì™œ ì¤‘ìš”í•œê°€?</a></li></ul></li><li><a href=#ë‹¤ìŒ-ë‹¨ê³„ëŠ”-ì•ìœ¼ë¡œì˜-ê¸¸>ë‹¤ìŒ ë‹¨ê³„ëŠ”?: ì•ìœ¼ë¡œì˜ ê¸¸</a><ul><li><a href=#í† ê¸€ì„-í´ë¦­í•˜ë©´-ë…¼ë¬¸ì—-ëŒ€í•œ-ìì„¸í•œ-llm-ì§ˆì˜ì‘ë‹µ-ë‚´ìš©ì„-í™•ì¸í• -ìˆ˜-ìˆìŠµë‹ˆë‹¤>í† ê¸€ì„ í´ë¦­í•˜ë©´ ë…¼ë¬¸ì— ëŒ€í•œ ìì„¸í•œ LLM ì§ˆì˜ì‘ë‹µ ë‚´ìš©ì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</a></li></ul></li></ul><ul><li><a href=#-í•œëˆˆì—-ë³´ëŠ”-ê²°ë¡ -tldr--research-gap>ğŸ—ï¸ í•œëˆˆì— ë³´ëŠ” ê²°ë¡  (TL;DR â€“ Research Gap)</a><ul><li><a href=#1-ì—°êµ¬-ê³µë°±research-gap--ë¬´ì—‡ì´-ë¹„ì–´-ìˆì—ˆë‚˜>1. ì—°êµ¬ ê³µë°±(Research Gap) â€” ë¬´ì—‡ì´ ë¹„ì–´ ìˆì—ˆë‚˜?</a></li><li><a href=#2-ë‹¹ì‹œ-ìµœì‹ -ê¸°ìˆ state-of-the-art-ìš”ì•½>2. ë‹¹ì‹œ ìµœì‹  ê¸°ìˆ (State of the Art) ìš”ì•½</a></li></ul></li></ul><ul><li><ul><li><a href=#-central-hypothesis>ğŸš€ Central Hypothesis</a></li></ul></li></ul><ul><li><ul><li><a href=#-tldr--deepseekmoeì˜-ë…ì°½ì -ê³µí—Œ-3ê°€ì§€>ğŸš© TL;DR â€” DeepSeekMoEì˜ ë…ì°½ì  ê³µí—Œ 3ê°€ì§€</a></li></ul></li></ul><ul><li><a href=#-í•µì‹¬-ìš”ì•½>âœ¨ í•µì‹¬ ìš”ì•½</a><ul><li><a href=#1-ì™œ-ìš°ë¦¬-ë°©ì‹ì´-ë”-ë‚«ë‚˜--ì €ìë“¤ì˜-í•µì‹¬-ë…¼ê±°-3ê°€ì§€>1. â€œì™œ ìš°ë¦¬ ë°©ì‹ì´ ë” ë‚«ë‚˜?â€ â€” ì €ìë“¤ì˜ í•µì‹¬ ë…¼ê±° 3ê°€ì§€</a></li><li><a href=#2-ì €ìë“¤ì´-ê°•ì¡°í•˜ëŠ”-ë…ì°½ì„±--ì„±ëŠ¥-ë…¼ë¦¬-íë¦„>2. ì €ìë“¤ì´ ê°•ì¡°í•˜ëŠ” â€˜ë…ì°½ì„± â†’ ì„±ëŠ¥â€™ ë…¼ë¦¬ íë¦„</a></li><li><a href=#3-í•œ-ëˆˆ-ìš”ì•½-í¬ì¸íŠ¸-ìˆ«ìë¡œ-ë§í•˜ëŠ”-deepseekmoe>3. í•œ-ëˆˆ-ìš”ì•½ í¬ì¸íŠ¸ (ìˆ«ìë¡œ ë§í•˜ëŠ” DeepSeekMoE)</a></li></ul></li></ul><ul><li><a href=#-í•µì‹¬-ì•Œê³ ë¦¬ì¦˜-í•œëˆˆì—-ìš”ì•½>ğŸ í•µì‹¬ ì•Œê³ ë¦¬ì¦˜ í•œëˆˆì— ìš”ì•½</a></li><li><a href=#1-ìš©ì–´--ë³€ìˆ˜-ì •ì˜>1ï¸âƒ£ ìš©ì–´ & ë³€ìˆ˜ ì •ì˜</a></li><li><a href=#2-ë‹¨ê³„ë³„-íŒŒì´í”„ë¼ì¸-toy-example->2ï¸âƒ£ ë‹¨ê³„ë³„ íŒŒì´í”„ë¼ì¸ (Toy Example ğŸ²)</a><ul><li><a href=#step-0í† í°-ì„ë² ë”©>Step 0â€‚í† í° ì„ë² ë”©</a></li><li><a href=#step-1affinity-ê³„ì‚°>Step 1â€‚Affinity ê³„ì‚°</a></li><li><a href=#step-2ì „ë¬¸ê°€-ì„ íƒ>Step 2â€‚ì „ë¬¸ê°€ ì„ íƒ</a></li><li><a href=#step-3ì „ë¬¸ê°€-ffn-ì²˜ë¦¬>Step 3â€‚ì „ë¬¸ê°€ FFN ì²˜ë¦¬</a></li></ul></li></ul><ul><li><a href=#-ë¹„ë°€-ë³‘ê¸°--fine-grained-expert-segmentation-fges--í™•ì¥-top->ğŸ§© â€˜ë¹„ë°€ ë³‘ê¸°â€™ â€” <strong>Fine-Grained Expert Segmentation (FGES) + í™•ì¥ Top-<em>mK</em> ê²Œì´íŒ…</strong></a><ul><li><a href=#1-ë¬´ì—‡ì„-í•˜ë‚˜>1ï¸âƒ£ ë¬´ì—‡ì„ í•˜ë‚˜?</a></li><li><a href=#2-ì™œ-deepseekmoeì˜-ì„±ê³µì—-í•„ìˆ˜ì ì¸ê°€>2ï¸âƒ£ ì™œ DeepSeekMoEì˜ ì„±ê³µì— í•„ìˆ˜ì ì¸ê°€?</a></li></ul></li></ul><ul><li><a href=#-í•œì¤„-ê²°ë¡ >ğŸ—ï¸ í•œì¤„ ê²°ë¡ </a><ul><li><a href=#-êµ¬ì¡°-ë³€ê²½-í•œëˆˆ-ë¹„êµ>ğŸ” êµ¬ì¡° ë³€ê²½ í•œëˆˆ ë¹„êµ</a></li></ul></li><li><a href=#-íŒŒì´ì¬-ì˜ˆì‹œ--pytorch-like-pseudo-code->ğŸ íŒŒì´ì¬ ì˜ˆì‹œ ( PyTorch-like pseudo-code )</a><ul><li><a href=#-ì‚¬ìš©-ì˜ˆ>â–¶ï¸ ì‚¬ìš© ì˜ˆ</a></li><li><a href=#-í•µì‹¬-ë³€ê²½-í¬ì¸íŠ¸-ìš”ì•½>ğŸ’¡ í•µì‹¬ ë³€ê²½ í¬ì¸íŠ¸ ìš”ì•½</a></li></ul></li></ul><ul><li><a href=#-tldr--deepseekmoe-results-í•œëˆˆ-ìš”ì•½>ğŸš€ TL;DR â€” DeepSeekMoE â€œResultsâ€ í•œëˆˆ ìš”ì•½</a></li><li><a href=#1-í•µì‹¬-ì„±ëŠ¥-ì§€í‘œ--ë²¤ì¹˜ë§ˆí¬>1ï¸âƒ£ í•µì‹¬ ì„±ëŠ¥ ì§€í‘œ & ë²¤ì¹˜ë§ˆí¬</a></li><li><a href=#2-ê²°ê³¼-í•˜ì´ë¼ì´íŠ¸>2ï¸âƒ£ ê²°ê³¼ í•˜ì´ë¼ì´íŠ¸</a><ul><li><a href=#a-validation-2-b-ëª¨ë¸-100-b-í† í°--table-1x20>(A) Validation 2 B ëª¨ë¸ @100 B í† í° â€” Table 1</a></li><li><a href=#b-deepseekmoe-vs-dense-upper-bound--table-2x20>(B) DeepSeekMoE vs Dense Upper-Bound â€” Table 2</a></li><li><a href=#c-16-b-vs-dense-7-b--tables-34>(C) 16 B vs Dense 7 B â€” Tables 3Â·4</a></li><li><a href=#d-chat-sft-í›„-16-b--table-5x20>(D) Chat SFT í›„ 16 B â€• Table 5</a></li><li><a href=#e-ablation-figure-3x20>(E) Ablation Figure 3</a></li></ul></li><li><a href=#3-ê²°ë¡ --ì‹œì‚¬ì >3ï¸âƒ£ ê²°ë¡  & ì‹œì‚¬ì </a></li></ul><ul><li><a href=#-ì••ì¶•-ê²°ë¡ -key-take-aways>ğŸ ì••ì¶• ê²°ë¡  (Key Take-aways)</a></li><li><a href=#1-sotabaseline-ë¹„êµ--ìˆ«ìë¡œ-ë³´ëŠ”-ìŠ¹ë¶€ì²˜>1. SOTA/Baseline ë¹„êµ â€” ìˆ«ìë¡œ ë³´ëŠ” ìŠ¹ë¶€ì²˜</a></li><li><a href=#2-ìš°ì›”ì„±-ì£¼ì¥ì„-ë’·ë°›ì¹¨í•˜ëŠ”-í‚¬ëŸ¬-ë¹„êµ>2. ìš°ì›”ì„± ì£¼ì¥ì„ ë’·ë°›ì¹¨í•˜ëŠ” â€˜í‚¬ëŸ¬ ë¹„êµâ€™</a></li><li><a href=#3-ê°œì„ -íš¨ê³¼ê°€-ë¯¸ë¯¸ì—´ì„¸ì¸-ì˜ì—­--í•´ì„>3. ê°œì„  íš¨ê³¼ê°€ ë¯¸ë¯¸/ì—´ì„¸ì¸ ì˜ì—­ & í•´ì„</a></li><li><a href=#4-ì´í‰--ì‹¤ë¬´ì -ì˜ë¯¸>4. ì´í‰ & ì‹¤ë¬´ì  ì˜ë¯¸</a></li></ul><ul><li><a href=#-tldr--í•œëˆˆì—-ë³´ëŠ”-ì œì•½-ë¦¬ìŠ¤íŠ¸>ğŸš¦ TL;DR â€” í•œëˆˆì— ë³´ëŠ” â€˜ì œì•½ ë¦¬ìŠ¤íŠ¸â€™</a><ul><li><a href=#1-ì €ìê°€-ëª…ì‹œí•œ-í•œê³„ì‹¤íŒ¨-ì‚¬ë¡€>1. ì €ìê°€ ëª…ì‹œí•œ í•œê³„ãƒ»ì‹¤íŒ¨ ì‚¬ë¡€</a></li><li><a href=#2-ì €ìê°€-ì“°ì§€-ì•Šì€-ì ì¬ì -í•œê³„-ë¶„ì„>2. ì €ìê°€ ì“°ì§€ ì•Šì€ ì ì¬ì  í•œê³„ (ë¶„ì„)</a></li><li><a href=#3-ê°œì„ --í–¥í›„-ì—°êµ¬-ì•„ì´ë””ì–´-1-ì¤„ì”©>3. ê°œì„  / í–¥í›„ ì—°êµ¬ ì•„ì´ë””ì–´ (1-ì¤„ì”©)</a></li></ul></li></ul><ul><li><a href=#-í•œëˆˆì—-ë³´ëŠ”-ë¯¸ë˜-ì—°êµ¬-ë¡œë“œë§µ>ğŸš€ í•œëˆˆì— ë³´ëŠ” ë¯¸ë˜ ì—°êµ¬ ë¡œë“œë§µ</a><ul><li><a href=#1-ì €ìë“¤ì´-ëª…ì‹œí•œ-ë‹¤ìŒ-ë‹¨ê³„>1. ì €ìë“¤ì´ ëª…ì‹œí•œ &lsquo;ë‹¤ìŒ ë‹¨ê³„&rsquo;</a></li><li><a href=#2-í•œê³„-ê¸°ë°˜-ì¶”ê°€-ì œì•ˆ-ì´-ë¦¬ë·°ì–´-ê´€ì >2. í•œê³„ ê¸°ë°˜ ì¶”ê°€ ì œì•ˆ (ì´ ë¦¬ë·°ì–´ ê´€ì )</a></li><li><a href=#3-ì—°êµ¬-ê¶¤ì ì„-ìœ„í•œ-ì‹¤í–‰-ìˆœì„œ-ì œì•ˆ>3. ì—°êµ¬ ê¶¤ì ì„ ìœ„í•œ ì‹¤í–‰ ìˆœì„œ ì œì•ˆ</a></li></ul></li></ul><ul><li><a href=#í•µì‹¬-ìš”ì•½-í•œëˆˆì—-ë³´ëŠ”-ìˆ˜ì¹˜>í•µì‹¬ ìš”ì•½ <em>(í•œëˆˆì— ë³´ëŠ” ìˆ˜ì¹˜)</em></a><ul><li><a href=#1-í† í°í™”tokenization-ì „ëµ--bpe>1. í† í°í™”(Tokenization) ì „ëµ â€” BPE</a></li><li><a href=#2-out-of-vocabularyoov-ë‹¨ì–´-ì²˜ë¦¬>2. Out-of-Vocabulary(OOV) ë‹¨ì–´ ì²˜ë¦¬</a></li><li><a href=#3-í…ìŠ¤íŠ¸-ì •ì œì •ê·œí™”-íŒŒì´í”„ë¼ì¸>3. í…ìŠ¤íŠ¸ ì •ì œÂ·ì •ê·œí™” íŒŒì´í”„ë¼ì¸</a></li><li><a href=#4-ì •ë¦¬>4. ì •ë¦¬</a></li></ul></li></ul><ul><li><ul><li><a href=#-ê²°ë¡ -í•œ-ì¤„>âœï¸ ê²°ë¡  í•œ ì¤„</a></li></ul></li><li><a href=#1-ì–´í…ì…˜-ë©”ì»¤ë‹ˆì¦˜-ìƒì„¸>1. ì–´í…ì…˜ ë©”ì»¤ë‹ˆì¦˜ ìƒì„¸</a></li><li><a href=#2-ìœ„ì¹˜-ì¸ì½”ë”©positional-encoding>2. ìœ„ì¹˜ ì¸ì½”ë”©(Positional Encoding)</a></li><li><a href=#3-ì¸ì½”ë”-ë””ì½”ë”-ìƒí˜¸ì‘ìš©-ì—¬ë¶€>3. ì¸ì½”ë”-ë””ì½”ë” ìƒí˜¸ì‘ìš© ì—¬ë¶€</a></li><li><a href=#4-í•µì‹¬-íŒŒë¼ë¯¸í„°-ìš”ì•½-ìˆ«ì>4. í•µì‹¬ íŒŒë¼ë¯¸í„° ìš”ì•½ (ìˆ«ì)</a></li></ul><ul><li><a href=#-í•µì‹¬-ìš”ì•½-tldr>ğŸ—ï¸ í•µì‹¬ ìš”ì•½ (TL;DR)</a><ul><li><a href=#1-í•™ìŠµ-ëª©í‘œobjective>1. í•™ìŠµ ëª©í‘œ(Objective)</a></li><li><a href=#2-ì‚¬ì „í•™ìŠµ-ì½”í¼ìŠ¤>2. ì‚¬ì „í•™ìŠµ ì½”í¼ìŠ¤</a></li><li><a href=#3-pre-training-í•˜ì´í¼íŒŒë¼ë¯¸í„°-16-b-ê¸°ì¤€>3. Pre-training í•˜ì´í¼íŒŒë¼ë¯¸í„° (16 B ê¸°ì¤€)</a></li><li><a href=#4-ë‹¤ìš´ìŠ¤íŠ¸ë¦¼-íŒŒì¸íŠœë‹-ì „ëµ>4. ë‹¤ìš´ìŠ¤íŠ¸ë¦¼ íŒŒì¸íŠœë‹ ì „ëµ</a></li><li><a href=#5-ìµœì í™”-í¬ì¸íŠ¸--ì‹¤ë¬´-íŒ>5. ìµœì í™” í¬ì¸íŠ¸ & ì‹¤ë¬´ íŒ</a></li></ul></li></ul><ul><li><a href=#ê²°ë¡ -í•œëˆˆì—-ìš”ì•½>ê²°ë¡  (í•œëˆˆì— ìš”ì•½)</a><ul><li><a href=#1-ì†Œí”„íŠ¸ì›¨ì–´í”„ë ˆì„ì›Œí¬-ì˜ì¡´ì„±>1. ì†Œí”„íŠ¸ì›¨ì–´/í”„ë ˆì„ì›Œí¬ ì˜ì¡´ì„±</a></li><li><a href=#2-ë©”ëª¨ë¦¬-ì†Œìš”-ì¶”ë¡ -ì¤‘ì‹¬>2. ë©”ëª¨ë¦¬ ì†Œìš” (ì¶”ë¡  ì¤‘ì‹¬)</a></li><li><a href=#3-ì²˜ë¦¬ëŸ‰-ì§€í‘œ>3. ì²˜ë¦¬ëŸ‰ ì§€í‘œ</a></li><li><a href=#4-ì´-ì—°ì‚°-ë¹„ìš©>4. ì´ ì—°ì‚° ë¹„ìš©</a></li><li><a href=#5-ì •ë¦¬>5. ì •ë¦¬</a></li></ul></li></ul><ul><li><a href=#-í•œì¤„-ê²°ë¡ -1>ğŸš¦ í•œì¤„ ê²°ë¡ </a><ul><li><a href=#1-í‰ê°€ì—-ì‚¬ìš©ëœ-í•µì‹¬-ì‹œìŠ¤í…œ-ì§€í‘œ>1. í‰ê°€ì— ì‚¬ìš©ëœ í•µì‹¬ ì‹œìŠ¤í…œ ì§€í‘œ</a></li><li><a href=#2-ì²˜ë¦¬ëŸ‰tpsì§€ì—°-ì‹œê°„latency>2. ì²˜ë¦¬ëŸ‰(TPS)Â·ì§€ì—° ì‹œê°„(latency)</a></li><li><a href=#3-ë¹„ìš©-ëŒ€-ì„±ëŠ¥-flopsíŒŒë¼ë¯¸í„°-ì ˆê°>3. ë¹„ìš©-ëŒ€-ì„±ëŠ¥ (FLOPsÂ·íŒŒë¼ë¯¸í„° ì ˆê°)</a></li><li><a href=#4-í™•ì¥ì„±scaling-ê´€ì°°>4. í™•ì¥ì„±(Scaling) ê´€ì°°</a></li><li><a href=#5-ëˆ„ë½ëœì œí•œì -ì§€í‘œ>5. ëˆ„ë½ëœ/ì œí•œì  ì§€í‘œ</a></li><li><a href=#6-ìš”ì•½--ì‹¤ë¬´-ì‹œì‚¬ì >6. ìš”ì•½ & ì‹¤ë¬´ ì‹œì‚¬ì </a></li></ul></li></ul></nav></div></nav></div><div class="border-border bg-muted/20 border-t px-4 py-3"><div class="text-muted-foreground text-center text-xs"><span>ì œëª©ì„ í´ë¦­í•˜ë©´ í•´ë‹¹ ìœ„ì¹˜ë¡œ ì´ë™í•©ë‹ˆë‹¤</span></div></div></div></div><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.css integrity=sha384-5TcZemv2l/9On385z///+d7MSYlvIEw9FuZTIdZ14vJLqWphw7e7ZPuOiCHJcFCP crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.js integrity=sha384-cMkvdD8LoxVzGF/RPUKAcvmm49FQ0oxwDF3BGKtDXcEc+T1b2N+teh/OJfpU0jr6 crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/contrib/auto-render.min.js integrity=sha384-hCXGrW6PitJEwbkoStFjeJxv+fSOOQKOPbJxSfM6G5sWZjAyWhXiTIIAmQqnlLlh crossorigin=anonymous></script><script>function initKaTeX(){if(typeof renderMathInElement=="undefined"){setTimeout(initKaTeX,100);return}var e=[{display:!0,left:"$$",right:"$$"},{display:!1,left:"$",right:"$"}];renderMathInElement(document.body,{delimiters:e,throwOnError:!1,errorColor:"#cc0000",fleqn:!1,leqno:!1,trust:!1})}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",initKaTeX):initKaTeX()</script><div id=search-overlay class="pointer-events-none fixed inset-0 z-40 bg-black/50 opacity-0 transition-opacity duration-300"></div><div id=search-modal class="bg-card border-border pointer-events-none fixed top-1/2 left-1/2 z-50 max-h-[80vh] w-full max-w-2xl -translate-x-1/2 -translate-y-1/2 scale-95 transform overflow-hidden rounded-xl border opacity-0 shadow-xl transition-all duration-300"><div class="border-border flex items-center gap-3 border-b p-4"><div class="text-muted-foreground h-5 w-5 flex-shrink-0"><svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m21 21-6-6m2-5A7 7 0 113 10a7 7 0 0114 0z"/></svg></div><div class="relative flex-1"><button id=search-clear class="text-muted-foreground hover:text-foreground hover:bg-muted/50 pointer-events-none absolute top-1/2 left-0 z-10 h-5 w-5 -translate-y-1/2 rounded opacity-0 transition-all duration-200" title=ì§€ìš°ê¸° aria-label=ì§€ìš°ê¸°>
<svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18 18 6M6 6l12 12"/></svg>
</button>
<input id=search-input type=text placeholder="ê²Œì‹œê¸€ ê²€ìƒ‰..." class="text-foreground placeholder:text-muted-foreground w-full border-none bg-transparent pl-8 text-lg outline-none" autocomplete=off spellcheck=false></div><button id=search-close class="text-muted-foreground hover:text-foreground hover:bg-muted/50 flex h-6 w-6 items-center justify-center rounded-md p-0.5 transition-all duration-200" title=ë‹«ê¸° aria-label=ë‹«ê¸°>
<svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18 18 6M6 6l12 12"/></svg></button></div><div id=search-results class="max-h-96 overflow-y-auto"><div id=search-empty class="flex flex-col items-center justify-center py-12 text-center"><div class="bg-muted/50 mb-4 flex h-16 w-16 items-center justify-center rounded-full"><svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m21 21-6-6m2-5A7 7 0 113 10a7 7 0 0114 0z"/></svg></div><h3 class="text-foreground mb-2 text-lg font-semibold">ê²€ìƒ‰ ì‹œì‘</h3><p class="text-muted-foreground text-sm">ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•˜ì„¸ìš”</p></div><div id=search-loading class="flex hidden items-center justify-center py-8"><div class="mr-3 h-6 w-6 animate-spin rounded-full border-2 border-current border-t-transparent"></div><span class=text-muted-foreground>ê²€ìƒ‰ ì¤‘...</span></div><div id=search-no-results class="flex hidden flex-col items-center justify-center py-12 text-center"><div class="bg-muted/50 mb-4 flex h-16 w-16 items-center justify-center rounded-full"><svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h7"/></svg></div><h3 class="text-foreground mb-2 text-lg font-semibold">ê²€ìƒ‰ ê²°ê³¼ ì—†ìŒ</h3><p class="text-muted-foreground text-sm">ë‹¤ë¥¸ ê²€ìƒ‰ì–´ë¡œ ì‹œë„í•´ë³´ì„¸ìš”</p></div><div id=search-results-list class=hidden><div id=search-stats class="text-muted-foreground border-border border-b px-4 py-3 text-sm" data-template="%dê°œì˜ ê²°ê³¼ ì°¾ìŒ"></div><div id=search-items class="divide-border divide-y"></div></div></div><div class="border-border bg-muted/20 border-t px-4 py-3"><div class="text-muted-foreground flex items-center justify-between text-xs"><div class="flex items-center gap-2 md:gap-4"><div class="flex items-center gap-1"><kbd class="bg-muted border-border rounded border px-1.5 py-0.5 text-xs">â†‘â†“</kbd>
<span class="hidden sm:inline">ì´ë™</span></div><div class="flex items-center gap-1"><kbd class="bg-muted border-border rounded border px-1.5 py-0.5 text-xs">â†µ</kbd>
<span class="hidden sm:inline">ì„ íƒ</span></div><div class="flex items-center gap-1"><kbd class="bg-muted border-border rounded border px-1.5 py-0.5 text-xs">ESC</kbd>
<span class="hidden sm:inline">ë‹«ê¸°</span></div></div><div class="search-hint-desktop flex items-center gap-1"><kbd class="bg-muted border-border rounded border px-1.5 py-0.5 text-xs">âŒ˜K</kbd>
<span>ë‹¨ì¶•í‚¤</span></div></div></div></div></body></html>